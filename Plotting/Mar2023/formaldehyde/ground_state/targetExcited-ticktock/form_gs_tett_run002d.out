Rank =    0  Free Memory = 89312 MB
Rank =    1  Free Memory = 89312 MB
Rank =    2  Free Memory = 89312 MB
Rank =    3  Free Memory = 89312 MB
Rank =    4  Free Memory = 89312 MB
Rank =    5  Free Memory = 89312 MB
Rank =    6  Free Memory = 89312 MB
Rank =    7  Free Memory = 89312 MB
Rank =    8  Free Memory = 89311 MB
Rank =    9  Free Memory = 89311 MB
Rank =   10  Free Memory = 89311 MB
Rank =   11  Free Memory = 89311 MB
Rank =   12  Free Memory = 89311 MB
Rank =   13  Free Memory = 89311 MB
Rank =   14  Free Memory = 89310 MB
Rank =   15  Free Memory = 89296 MB
Rank =   16  Free Memory = 89296 MB
Rank =   17  Free Memory = 89296 MB
Rank =   18  Free Memory = 89296 MB
Rank =   19  Free Memory = 89296 MB
Rank =   20  Free Memory = 89296 MB
Rank =   21  Free Memory = 89296 MB
Rank =   22  Free Memory = 89296 MB
Rank =   23  Free Memory = 89296 MB
Rank =   24  Free Memory = 89296 MB
Rank =   25  Free Memory = 89296 MB
Rank =   26  Free Memory = 89296 MB
Rank =   27  Free Memory = 89296 MB
Rank =   28  Free Memory = 89296 MB
Rank =   29  Free Memory = 89296 MB
Rank =   30  Free Memory = 89296 MB
Rank =   31  Free Memory = 89296 MB
Rank =   32  Free Memory = 90589 MB
Rank =   33  Free Memory = 90589 MB
Rank =   34  Free Memory = 90589 MB
Rank =   35  Free Memory = 90589 MB
Rank =   36  Free Memory = 90589 MB
Rank =   37  Free Memory = 90589 MB
Rank =   38  Free Memory = 90589 MB
Rank =   39  Free Memory = 90589 MB
Rank =   40  Free Memory = 90589 MB
Rank =   41  Free Memory = 90589 MB
Rank =   42  Free Memory = 90589 MB
Rank =   43  Free Memory = 90589 MB
Rank =   44  Free Memory = 90589 MB
Rank =   45  Free Memory = 90589 MB
Rank =   46  Free Memory = 90589 MB
Rank =   47  Free Memory = 90589 MB
Rank =   48  Free Memory = 90589 MB
Rank =   49  Free Memory = 90589 MB
Rank =   50  Free Memory = 90588 MB
Rank =   51  Free Memory = 90588 MB
Rank =   52  Free Memory = 90588 MB
Rank =   53  Free Memory = 90588 MB
Rank =   54  Free Memory = 90588 MB
Rank =   55  Free Memory = 90588 MB
Rank =   56  Free Memory = 90588 MB
Rank =   57  Free Memory = 90588 MB
Rank =   58  Free Memory = 90588 MB
Rank =   59  Free Memory = 90588 MB
Rank =   60  Free Memory = 90588 MB
Rank =   61  Free Memory = 90588 MB
Rank =   62  Free Memory = 90588 MB
Rank =   63  Free Memory = 90588 MB
Rank =   64  Free Memory = 91153 MB
Rank =   65  Free Memory = 91153 MB
Rank =   66  Free Memory = 91153 MB
Rank =   67  Free Memory = 91153 MB
Rank =   68  Free Memory = 91153 MB
Rank =   69  Free Memory = 91153 MB
Rank =   70  Free Memory = 91153 MB
Rank =   71  Free Memory = 91153 MB
Rank =   72  Free Memory = 91153 MB
Rank =   73  Free Memory = 91153 MB
Rank =   74  Free Memory = 91153 MB
Rank =   75  Free Memory = 91153 MB
Rank =   76  Free Memory = 91153 MB
Rank =   77  Free Memory = 91153 MB
Rank =   78  Free Memory = 91153 MB
Rank =   79  Free Memory = 91153 MB
Rank =   80  Free Memory = 91153 MB
Rank =   81  Free Memory = 91153 MB
Rank =   82  Free Memory = 91153 MB
Rank =   83  Free Memory = 91153 MB
Rank =   84  Free Memory = 91153 MB
Rank =   85  Free Memory = 91153 MB
Rank =   86  Free Memory = 91153 MB
Rank =   87  Free Memory = 91153 MB
Rank =   88  Free Memory = 91153 MB
Rank =   89  Free Memory = 91153 MB
Rank =   90  Free Memory = 91153 MB
Rank =   91  Free Memory = 91153 MB
Rank =   92  Free Memory = 91153 MB
Rank =   93  Free Memory = 91153 MB
Rank =   94  Free Memory = 91153 MB
Rank =   95  Free Memory = 91153 MB
Rank =   96  Free Memory = 82765 MB
Rank =   97  Free Memory = 82765 MB
Rank =   98  Free Memory = 82765 MB
Rank =   99  Free Memory = 82765 MB
Rank =  100  Free Memory = 82765 MB
Rank =  101  Free Memory = 82765 MB
Rank =  102  Free Memory = 82765 MB
Rank =  103  Free Memory = 82765 MB
Rank =  104  Free Memory = 82765 MB
Rank =  105  Free Memory = 82765 MB
Rank =  106  Free Memory = 82765 MB
Rank =  107  Free Memory = 82765 MB
Rank =  108  Free Memory = 82765 MB
Rank =  109  Free Memory = 82765 MB
Rank =  110  Free Memory = 82765 MB
Rank =  111  Free Memory = 82765 MB
Rank =  112  Free Memory = 82765 MB
Rank =  113  Free Memory = 82765 MB
Rank =  114  Free Memory = 82765 MB
Rank =  115  Free Memory = 82765 MB
Rank =  116  Free Memory = 82765 MB
Rank =  117  Free Memory = 82765 MB
Rank =  118  Free Memory = 82765 MB
Rank =  119  Free Memory = 82765 MB
Rank =  120  Free Memory = 82765 MB
Rank =  121  Free Memory = 82765 MB
Rank =  122  Free Memory = 82765 MB
Rank =  123  Free Memory = 82765 MB
Rank =  124  Free Memory = 82765 MB
Rank =  125  Free Memory = 82765 MB
Rank =  126  Free Memory = 82765 MB
Rank =  127  Free Memory = 82765 MB
  Input file(s): opt_form_gs_tett_run002d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run002d.xml

  Project = FORM2
  date    = 2023-03-19 12:03:47 PDT
  host    = n0070.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 147

  Range of prime numbers to use as seeds over processors and threads = 859-1787


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.659900e-01    1         1  ON     0
     uu_1                 1.059606e-01    1         1  ON     1
     uu_2                 6.585438e-03    1         1  ON     2
     uu_3                -5.283753e-02    1         1  ON     3
     uu_4                -8.663707e-02    1         1  ON     4
     uu_5                -1.051063e-01    1         1  ON     5
     uu_6                -1.113948e-01    1         1  ON     6
     uu_7                -1.038544e-01    1         1  ON     7
     uu_8                -8.046518e-02    1         1  ON     8
     uu_9                -4.288804e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458918e-01    1         1  ON     0
     ud_1                 1.068885e-01    1         1  ON     1
     ud_2                -9.362422e-03    1         1  ON     2
     ud_3                -6.924529e-02    1         1  ON     3
     ud_4                -1.012960e-01    1         1  ON     4
     ud_5                -1.172753e-01    1         1  ON     5
     ud_6                -1.213691e-01    1         1  ON     6
     ud_7                -1.120298e-01    1         1  ON     7
     ud_8                -8.585231e-02    1         1  ON     8
     ud_9                -4.559135e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.506186e-01    1         1  ON     0
     eC_1                -3.146073e-01    1         1  ON     1
     eC_2                -6.877446e-02    1         1  ON     2
     eC_3                 8.858703e-02    1         1  ON     3
     eC_4                 1.363007e-01    1         1  ON     4
     eC_5                 2.006961e-01    1         1  ON     5
     eC_6                 2.136812e-01    1         1  ON     6
     eC_7                 1.597089e-01    1         1  ON     7
     eC_8                 3.434703e-02    1         1  ON     8
     eC_9                 1.047648e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.235916e-01    1         1  ON     0
     eO_1                -5.244949e-01    1         1  ON     1
     eO_2                -1.331913e-01    1         1  ON     2
     eO_3                 1.329657e-01    1         1  ON     3
     eO_4                 2.611683e-01    1         1  ON     4
     eO_5                 3.461237e-01    1         1  ON     5
     eO_6                 3.302408e-01    1         1  ON     6
     eO_7                 2.658993e-01    1         1  ON     7
     eO_8                 1.071358e-01    1         1  ON     8
     eO_9                 2.449963e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.397717e-01    1         1  ON     0
     eH1_1                -4.653272e-02    1         1  ON     1
     eH1_2                -2.257470e-02    1         1  ON     2
     eH1_3                -3.701495e-02    1         1  ON     3
     eH1_4                -8.233741e-03    1         1  ON     4
     eH1_5                 1.739621e-02    1         1  ON     5
     eH1_6                 4.606475e-02    1         1  ON     6
     eH1_7                 3.927161e-02    1         1  ON     7
     eH1_8                 7.524879e-02    1         1  ON     8
     eH1_9                 6.186013e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.394482e-01    1         1  ON     0
     eH2_1                -4.450287e-02    1         1  ON     1
     eH2_2                -2.173021e-02    1         1  ON     2
     eH2_3                -3.498437e-02    1         1  ON     3
     eH2_4                -6.920902e-03    1         1  ON     4
     eH2_5                 2.004559e-02    1         1  ON     5
     eH2_6                 4.945828e-02    1         1  ON     6
     eH2_7                 4.370990e-02    1         1  ON     7
     eH2_8                 6.697447e-02    1         1  ON     8
     eH2_9                 6.199319e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.711064e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.6599e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8111
    reference variance = 0.269476
====================================================
  Execution time = 4.4131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4801e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4616e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448035498101
                                         uncertainty =       0.003087029645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448035498101
                                         uncertainty =       0.003087029645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473292890
  error estimate for blocks of size 2^( 2) =       0.000498774732
  error estimate for blocks of size 2^( 3) =       0.000522461233
  error estimate for blocks of size 2^( 4) =       0.000540345225
  error estimate for blocks of size 2^( 5) =       0.000550367460
  error estimate for blocks of size 2^( 6) =       0.000555417764
  error estimate for blocks of size 2^( 7) =       0.000559989517

      target function =      -0.746935670466
              le_mean =     -22.814592073775
             les_mean =     520.953623588527
             stat err =       0.000551529992
             autocorr =       1.357932887991
   target nu stat err =       0.000551529992
   target dn stat err =       0.003350338718
      target stat err =       0.002896772238
              std dev =       0.669337224245
             le_variance =       0.448012319760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281459207378e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746945716786       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746969123585       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746990472779       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746997926701       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747001432193       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747005868650       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747008940003       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747010383353       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747012179783       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747013596711       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747015877558       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747017763261       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747017533323       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747019173104       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747022757202       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747025025540       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747026164073       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747026384013       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747026596085       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747026935655       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747028723720       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747029304653       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747029523731       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747029453064       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747030205088       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747030226117       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747030256755       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747030341910       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747030339031       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747030352690       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747030368125       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747030402838       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747030362842       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 2.998849e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746945716786       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746952402268       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746958766855       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746960877983       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746961934425       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746963112662       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746963974809       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746964399237       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746964900251       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746965281442       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746965830125       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746966415095       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746966357345       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746966811855       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746967730094       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746968318127       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746968579246       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746968614559       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746968644727       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746968716921       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746969156620       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746969270274       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746969313741       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746969302872       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746969475483       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746969473210       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746969473914       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746969493782       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746969491888       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746969494449       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746969493211       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746969501978       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 7.838070e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746945716786       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746947449889       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746949121835       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746949667679       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746949946843       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746950244346       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746950465986       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746950575430       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746950711821       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746950805353       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746950941634       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746951093703       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746951079036       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746951196170       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746951426683       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746951574565       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746951637751       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746951645028       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746951651296       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746951668527       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746951777482       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746951803685       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746951813812       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746951811835       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746951853762       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746951852768       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746951852566       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746951857368       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746951856804       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746951857417       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746951856865       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746951858995       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 1.985050e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9099e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
uu_0  2.660462e-01                 1 1 ON  0
uu_1  1.058968e-01                 1 1 ON  1
uu_2  6.525592e-03                 1 1 ON  2
uu_3  -5.286420e-02                1 1 ON  3
uu_4  -8.661078e-02                1 1 ON  4
uu_5  -1.050341e-01                1 1 ON  5
uu_6  -1.113448e-01                1 1 ON  6
uu_7  -1.038802e-01                1 1 ON  7
uu_8  -8.057460e-02                1 1 ON  8
uu_9  -4.291232e-02                1 1 ON  9
ud_0  3.462366e-01                 1 1 ON  10
ud_1  1.070742e-01                 1 1 ON  11
ud_2  -9.284221e-03                1 1 ON  12
ud_3  -6.922232e-02                1 1 ON  13
ud_4  -1.013327e-01                1 1 ON  14
ud_5  -1.173737e-01                1 1 ON  15
ud_6  -1.215381e-01                1 1 ON  16
ud_7  -1.121988e-01                1 1 ON  17
ud_8  -8.605080e-02                1 1 ON  18
ud_9  -4.560639e-02                1 1 ON  19
eC_0  -4.509470e-01                1 1 ON  20
eC_1  -3.148235e-01                1 1 ON  21
eC_2  -6.898888e-02                1 1 ON  22
eC_3  8.840633e-02                 1 1 ON  23
eC_4  1.363161e-01                 1 1 ON  24
eC_5  2.008382e-01                 1 1 ON  25
eC_6  2.138569e-01                 1 1 ON  26
eC_7  1.600768e-01                 1 1 ON  27
eC_8  3.462532e-02                 1 1 ON  28
eC_9  1.029674e-03                 1 1 ON  29
eO_0  -8.243754e-01                1 1 ON  30
eO_1  -5.250287e-01                1 1 ON  31
eO_2  -1.336091e-01                1 1 ON  32
eO_3  1.326005e-01                 1 1 ON  33
eO_4  2.610931e-01                 1 1 ON  34
eO_5  3.463645e-01                 1 1 ON  35
eO_6  3.306637e-01                 1 1 ON  36
eO_7  2.665812e-01                 1 1 ON  37
eO_8  1.077550e-01                 1 1 ON  38
eO_9  2.471821e-02                 1 1 ON  39
eH1_0 -1.397936e-01                1 1 ON  40
eH1_1 -4.650228e-02                1 1 ON  41
eH1_2 -2.265710e-02                1 1 ON  42
eH1_3 -3.694813e-02                1 1 ON  43
eH1_4 -8.186240e-03                1 1 ON  44
eH1_5 1.736750e-02                 1 1 ON  45
eH1_6 4.612044e-02                 1 1 ON  46
eH1_7 3.936285e-02                 1 1 ON  47
eH1_8 7.475866e-02                 1 1 ON  48
eH1_9 6.208548e-02                 1 1 ON  49
eH2_0 -1.394605e-01                1 1 ON  50
eH2_1 -4.458824e-02                1 1 ON  51
eH2_2 -2.181985e-02                1 1 ON  52
eH2_3 -3.502367e-02                1 1 ON  53
eH2_4 -6.901912e-03                1 1 ON  54
eH2_5 2.000208e-02                 1 1 ON  55
eH2_6 4.956619e-02                 1 1 ON  56
eH2_7 4.383433e-02                 1 1 ON  57
eH2_8 6.681906e-02                 1 1 ON  58
eH2_9 6.209765e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6963
    reference variance = 0.379238
====================================================
  Execution time = 4.3661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5186e-01
  Total weights = 2.0000e+06
  Execution time = 3.4871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451922116490
                                         uncertainty =       0.004049144820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451922116490
                                         uncertainty =       0.004049144820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475317754
  error estimate for blocks of size 2^( 2) =       0.000500357307
  error estimate for blocks of size 2^( 3) =       0.000524170596
  error estimate for blocks of size 2^( 4) =       0.000542827236
  error estimate for blocks of size 2^( 5) =       0.000555163253
  error estimate for blocks of size 2^( 6) =       0.000563487918
  error estimate for blocks of size 2^( 7) =       0.000568220495

      target function =      -0.743687885347
              le_mean =     -22.815241451267
             les_mean =     520.987096187886
             stat err =       0.000557424725
             autocorr =       1.375321983492
   target nu stat err =       0.000557424725
   target dn stat err =       0.004061818498
      target stat err =       0.003460693900
              std dev =       0.672200813911
             le_variance =       0.451853934223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451937416450
                                         uncertainty =       0.004053266947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451937416450
                                         uncertainty =       0.004053266947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475325704
  error estimate for blocks of size 2^( 2) =       0.000500236933
  error estimate for blocks of size 2^( 3) =       0.000523923088
  error estimate for blocks of size 2^( 4) =       0.000542484293
  error estimate for blocks of size 2^( 5) =       0.000554753350
  error estimate for blocks of size 2^( 6) =       0.000563026932
  error estimate for blocks of size 2^( 7) =       0.000567736918

      target function =      -0.743675232664
              le_mean =     -22.815239589340
             les_mean =     520.987026342007
             stat err =       0.000557000373
             autocorr =       1.373182856011
   target nu stat err =       0.000557000373
   target dn stat err =       0.004065158119
      target stat err =       0.003463233404
              std dev =       0.672212056539
             le_variance =       0.451869048956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451931683480
                                         uncertainty =       0.004051577499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451931683480
                                         uncertainty =       0.004051577499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475322728
  error estimate for blocks of size 2^( 2) =       0.000500290237
  error estimate for blocks of size 2^( 3) =       0.000524032935
  error estimate for blocks of size 2^( 4) =       0.000542637606
  error estimate for blocks of size 2^( 5) =       0.000554937410
  error estimate for blocks of size 2^( 6) =       0.000563234932
  error estimate for blocks of size 2^( 7) =       0.000567955888

      target function =      -0.743679984473
              le_mean =     -22.815239580983
             les_mean =     520.987020302643
             stat err =       0.000557191459
             autocorr =       1.374142399233
   target nu stat err =       0.000557191459
   target dn stat err =       0.004063790686
      target stat err =       0.003462189145
              std dev =       0.672207848010
             le_variance =       0.451863390926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451923008006
                                         uncertainty =       0.004049462380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451923008006
                                         uncertainty =       0.004049462380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475318215
  error estimate for blocks of size 2^( 2) =       0.000500348444
  error estimate for blocks of size 2^( 3) =       0.000524152627
  error estimate for blocks of size 2^( 4) =       0.000542802599
  error estimate for blocks of size 2^( 5) =       0.000555133980
  error estimate for blocks of size 2^( 6) =       0.000563455193
  error estimate for blocks of size 2^( 7) =       0.000568186307

      target function =      -0.743687155675
              le_mean =     -22.815241097751
             les_mean =     520.987080933844
             stat err =       0.000557394520
             autocorr =       1.375170266467
   target nu stat err =       0.000557394520
   target dn stat err =       0.004062075714
      target stat err =       0.003460891135
              std dev =       0.672201466269
             le_variance =       0.451854811255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743687885347        initial  <--
     2.5000e-01     2.5000e+00             2.9988e-03        -0.743675232664
     1.0000e+00     1.0000e+01             7.8381e-04        -0.743679984473
     4.0000e+00     4.0000e+01             1.9850e-04        -0.743687155675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2516
  </log>
  <optVariables href="FORM2.s000.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2039e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2754e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8716
    reference variance = 0.391192
====================================================
  Execution time = 4.5834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4734e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933325017
                                         uncertainty =       0.004144778428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933325017
                                         uncertainty =       0.004144778428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475334746
  error estimate for blocks of size 2^( 2) =       0.000501032840
  error estimate for blocks of size 2^( 3) =       0.000524984139
  error estimate for blocks of size 2^( 4) =       0.000543262593
  error estimate for blocks of size 2^( 5) =       0.000554927833
  error estimate for blocks of size 2^( 6) =       0.000560555813
  error estimate for blocks of size 2^( 7) =       0.000566125964

      target function =      -0.743659870140
              le_mean =     -22.815251454918
             les_mean =     520.987584965895
             stat err =       0.000556218051
             autocorr =       1.369276123909
   target nu stat err =       0.000556218051
   target dn stat err =       0.004163385019
      target stat err =       0.003543966912
              std dev =       0.672224843862
             le_variance =       0.451886240706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281525145492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743675822157       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743677908198       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743679167025       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743679940877       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743680350241       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743680692052       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743680868324       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743681024398       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743681211761       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743681305894       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743681541146       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743681789713       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743682043138       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743682371410       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743682690744       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743683111700       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743683230093       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743683392762       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743683468558       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743683520220       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743683621971       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743683760114       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743683753353       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743683767482       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743683788163       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743683795007       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743683813420       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743683823058       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743683819929       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743683816615       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743683813109       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743683813045       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 3.681939e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743675822157       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743676351523       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743676671798       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743676868698       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743676972702       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743677059187       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743677104065       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743677143195       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743677190773       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743677214804       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743677274259       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743677334128       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743677402357       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743677484442       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743677566155       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743677669902       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743677699014       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743677739505       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743677757966       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743677770723       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743677795793       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743677829992       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743677828054       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743677831393       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743677836428       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743677838230       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743677842680       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743677845054       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743677844211       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743677843430       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743677842555       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743677842558       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 9.248818e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743675822157       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743675954998       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743676035423       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743676084868       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743676110974       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743676132662       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743676143933       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743676153723       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743676165664       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743676171704       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743676186608       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743676201441       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743676218801       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743676239320       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743676259870       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743676285708       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743676292954       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743676303066       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743676307650       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743676310829       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743676317073       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743676325602       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743676325102       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743676325925       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743676327175       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743676327631       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743676328734       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743676329325       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743676329111       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743676328919       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743676328700       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743676328701       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 2.315008e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0611e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
 uu_0                 2.660048e-01 1 1  ON 0
 uu_1                 1.059692e-01 1 1  ON 1
 uu_2                 6.590951e-03 1 1  ON 2
 uu_3                -5.283454e-02 1 1  ON 3
 uu_4                -8.663617e-02 1 1  ON 4
 uu_5                -1.051039e-01 1 1  ON 5
 uu_6                -1.114006e-01 1 1  ON 6
 uu_7                -1.038712e-01 1 1  ON 7
 uu_8                -8.049598e-02 1 1  ON 8
 uu_9                -4.289204e-02 1 1  ON 9
 ud_0                 3.459208e-01 1 1  ON 10
 ud_1                 1.069036e-01 1 1  ON 11
 ud_2                -9.358516e-03 1 1  ON 12
 ud_3                -6.924846e-02 1 1  ON 13
 ud_4                -1.013054e-01 1 1  ON 14
 ud_5                -1.172861e-01 1 1  ON 15
 ud_6                -1.213786e-01 1 1  ON 16
 ud_7                -1.120334e-01 1 1  ON 17
 ud_8                -8.586533e-02 1 1  ON 18
 ud_9                -4.558661e-02 1 1  ON 19
 eC_0                -4.506612e-01 1 1  ON 20
 eC_1                -3.146377e-01 1 1  ON 21
 eC_2                -6.880096e-02 1 1  ON 22
 eC_3                 8.856445e-02 1 1  ON 23
 eC_4                 1.362802e-01 1 1  ON 24
 eC_5                 2.007131e-01 1 1  ON 25
 eC_6                 2.137222e-01 1 1  ON 26
 eC_7                 1.597594e-01 1 1  ON 27
 eC_8                 3.437835e-02 1 1  ON 28
 eC_9                 1.052686e-03 1 1  ON 29
 eO_0                -8.236841e-01 1 1  ON 30
 eO_1                -5.245603e-01 1 1  ON 31
 eO_2                -1.332347e-01 1 1  ON 32
 eO_3                 1.329244e-01 1 1  ON 33
 eO_4                 2.611638e-01 1 1  ON 34
 eO_5                 3.461461e-01 1 1  ON 35
 eO_6                 3.302980e-01 1 1  ON 36
 eO_7                 2.659533e-01 1 1  ON 37
 eO_8                 1.072272e-01 1 1  ON 38
 eO_9                 2.452375e-02 1 1  ON 39
eH1_0                -1.397733e-01 1 1  ON 40
eH1_1                -4.653252e-02 1 1  ON 41
eH1_2                -2.258954e-02 1 1  ON 42
eH1_3                -3.702480e-02 1 1  ON 43
eH1_4                -8.240441e-03 1 1  ON 44
eH1_5                 1.739868e-02 1 1  ON 45
eH1_6                 4.608700e-02 1 1  ON 46
eH1_7                 3.928513e-02 1 1  ON 47
eH1_8                 7.520003e-02 1 1  ON 48
eH1_9                 6.188537e-02 1 1  ON 49
eH2_0                -1.394597e-01 1 1  ON 50
eH2_1                -4.451809e-02 1 1  ON 51
eH2_2                -2.174461e-02 1 1  ON 52
eH2_3                -3.499875e-02 1 1  ON 53
eH2_4                -6.923439e-03 1 1  ON 54
eH2_5                 2.004715e-02 1 1  ON 55
eH2_6                 4.946470e-02 1 1  ON 56
eH2_7                 4.372407e-02 1 1  ON 57
eH2_8                 6.698422e-02 1 1  ON 58
eH2_9                 6.200202e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.9263
    reference variance = 0.430952
====================================================
  Execution time = 4.3525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5928e-01
  Total weights = 2.0000e+06
  Execution time = 3.4914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459301074738
                                         uncertainty =       0.010193766065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459301074738
                                         uncertainty =       0.010193766065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479202830
  error estimate for blocks of size 2^( 2) =       0.000504133070
  error estimate for blocks of size 2^( 3) =       0.000527856600
  error estimate for blocks of size 2^( 4) =       0.000544435017
  error estimate for blocks of size 2^( 5) =       0.000555168066
  error estimate for blocks of size 2^( 6) =       0.000562473324
  error estimate for blocks of size 2^( 7) =       0.000565896903

      target function =      -0.737435577145
              le_mean =     -22.815310059984
             les_mean =     520.997643608821
             stat err =       0.000556993327
             autocorr =       1.351018313386
   target nu stat err =       0.000556993327
   target dn stat err =       0.010531139922
      target stat err =       0.008700101908
              std dev =       0.677695141808
             le_variance =       0.459270705230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459324034768
                                         uncertainty =       0.010195541530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459324034768
                                         uncertainty =       0.010195541530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479214788
  error estimate for blocks of size 2^( 2) =       0.000504131147
  error estimate for blocks of size 2^( 3) =       0.000527841028
  error estimate for blocks of size 2^( 4) =       0.000544408756
  error estimate for blocks of size 2^( 5) =       0.000555134452
  error estimate for blocks of size 2^( 6) =       0.000562436422
  error estimate for blocks of size 2^( 7) =       0.000565856412

      target function =      -0.737416644603
              le_mean =     -22.815310424269
             les_mean =     520.997683151419
             stat err =       0.000556959010
             autocorr =       1.350784431926
   target nu stat err =       0.000556959010
   target dn stat err =       0.010533222326
      target stat err =       0.008701370262
              std dev =       0.677712051906
             le_variance =       0.459293625298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459312688221
                                         uncertainty =       0.010194671291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459312688221
                                         uncertainty =       0.010194671291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479208878
  error estimate for blocks of size 2^( 2) =       0.000504132092
  error estimate for blocks of size 2^( 3) =       0.000527848721
  error estimate for blocks of size 2^( 4) =       0.000544421743
  error estimate for blocks of size 2^( 5) =       0.000555151088
  error estimate for blocks of size 2^( 6) =       0.000562454693
  error estimate for blocks of size 2^( 7) =       0.000565876467

      target function =      -0.737426000883
              le_mean =     -22.815310234635
             les_mean =     520.997663171468
             stat err =       0.000556975998
             autocorr =       1.350900146252
   target nu stat err =       0.000556975998
   target dn stat err =       0.010532200639
      target stat err =       0.008700749447
              std dev =       0.677703695173
             le_variance =       0.459282298450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459302527637
                                         uncertainty =       0.010193879773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459302527637
                                         uncertainty =       0.010193879773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479203587
  error estimate for blocks of size 2^( 2) =       0.000504132945
  error estimate for blocks of size 2^( 3) =       0.000527855610
  error estimate for blocks of size 2^( 4) =       0.000544433351
  error estimate for blocks of size 2^( 5) =       0.000555165936
  error estimate for blocks of size 2^( 6) =       0.000562470987
  error estimate for blocks of size 2^( 7) =       0.000565894340

      target function =      -0.737434379123
              le_mean =     -22.815310080868
             les_mean =     520.997646012088
             stat err =       0.000556991154
             autocorr =       1.351003501315
   target nu stat err =       0.000556991154
   target dn stat err =       0.010531273130
      target stat err =       0.008700183324
              std dev =       0.677696211873
             le_variance =       0.459272155587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737435577145        initial  <--
     2.5000e+00     2.5000e+01             3.6819e-04        -0.737416644603
     1.0000e+01     1.0000e+02             9.2488e-05        -0.737426000883
     4.0000e+01     4.0000e+02             2.3150e-05        -0.737434379123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1277
  </log>
  <optVariables href="FORM2.s001.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2175e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8931
    reference variance = 0.754802
====================================================
  Execution time = 4.5525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4886e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453803712431
                                         uncertainty =       0.004472713932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453803712431
                                         uncertainty =       0.004472713932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476452771
  error estimate for blocks of size 2^( 2) =       0.000501766227
  error estimate for blocks of size 2^( 3) =       0.000526444017
  error estimate for blocks of size 2^( 4) =       0.000544215463
  error estimate for blocks of size 2^( 5) =       0.000556108295
  error estimate for blocks of size 2^( 6) =       0.000565159939
  error estimate for blocks of size 2^( 7) =       0.000568799741

      target function =      -0.741889301034
              le_mean =     -22.814676750606
             les_mean =     520.963489494310
             stat err =       0.000558570860
             autocorr =       1.374411673145
   target nu stat err =       0.000558570860
   target dn stat err =       0.004788016672
      target stat err =       0.004037938574
              std dev =       0.673805971079
             le_variance =       0.454014486661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467675061e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741909964640       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741910248049       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741910428075       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741910456753       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741910506141       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741910541071       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741910581715       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741910617747       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741910667080       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741910717568       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741910765996       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741910797841       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741910850393       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741910883479       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741910921445       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741910965306       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741910997759       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741911017884       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741911028739       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741911035651       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741911040586       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741911048112       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741911053817       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741911061723       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741911065128       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741911066020       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741911066469       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741911067737       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741911067943       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741911068170       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 4.551643e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741909964640       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741910035611       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741910080692       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741910087871       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741910100241       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741910108979       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741910119149       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741910128165       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741910140475       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741910153148       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741910165271       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741910173226       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741910186183       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741910194656       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741910204140       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741910215109       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741910223225       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741910228247       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741910230962       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741910232688       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741910233913       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741910235789       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741910237214       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741910239188       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741910240035       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741910240257       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741910240368       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741910240683       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741910240737       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741910240789       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 1.137850e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741909964640       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741909982391       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741909993666       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741909995461       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741909998555       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741910000740       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741910003283       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741910005537       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741910008613       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741910011784       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741910014817       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741910016804       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741910020033       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741910022163       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741910024534       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741910027277       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741910029305       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741910030560       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741910031240       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741910031671       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741910031976       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741910032446       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741910032802       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741910033294       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741910033507       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741910033564       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741910033591       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741910033668       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741910033681       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741910033695       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 2.844585e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0446e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
 uu_0                 2.659923e-01 1 1  ON 0
 uu_1                 1.059620e-01 1 1  ON 1
 uu_2                 6.587114e-03 1 1  ON 2
 uu_3                -5.283631e-02 1 1  ON 3
 uu_4                -8.663641e-02 1 1  ON 4
 uu_5                -1.051061e-01 1 1  ON 5
 uu_6                -1.113957e-01 1 1  ON 6
 uu_7                -1.038557e-01 1 1  ON 7
 uu_8                -8.046743e-02 1 1  ON 8
 uu_9                -4.288947e-02 1 1  ON 9
 ud_0                 3.458940e-01 1 1  ON 10
 ud_1                 1.068894e-01 1 1  ON 11
 ud_2                -9.362839e-03 1 1  ON 12
 ud_3                -6.924652e-02 1 1  ON 13
 ud_4                -1.012974e-01 1 1  ON 14
 ud_5                -1.172766e-01 1 1  ON 15
 ud_6                -1.213703e-01 1 1  ON 16
 ud_7                -1.120296e-01 1 1  ON 17
 ud_8                -8.585049e-02 1 1  ON 18
 ud_9                -4.558950e-02 1 1  ON 19
 eC_0                -4.506244e-01 1 1  ON 20
 eC_1                -3.146106e-01 1 1  ON 21
 eC_2                -6.877694e-02 1 1  ON 22
 eC_3                 8.858534e-02 1 1  ON 23
 eC_4                 1.362996e-01 1 1  ON 24
 eC_5                 2.006963e-01 1 1  ON 25
 eC_6                 2.136813e-01 1 1  ON 26
 eC_7                 1.597201e-01 1 1  ON 27
 eC_8                 3.435013e-02 1 1  ON 28
 eC_9                 1.047557e-03 1 1  ON 29
 eO_0                -8.236015e-01 1 1  ON 30
 eO_1                -5.245036e-01 1 1  ON 31
 eO_2                -1.331975e-01 1 1  ON 32
 eO_3                 1.329619e-01 1 1  ON 33
 eO_4                 2.611680e-01 1 1  ON 34
 eO_5                 3.461263e-01 1 1  ON 35
 eO_6                 3.302475e-01 1 1  ON 36
 eO_7                 2.659097e-01 1 1  ON 37
 eO_8                 1.071443e-01 1 1  ON 38
 eO_9                 2.450037e-02 1 1  ON 39
eH1_0                -1.397733e-01 1 1  ON 40
eH1_1                -4.653427e-02 1 1  ON 41
eH1_2                -2.257738e-02 1 1  ON 42
eH1_3                -3.701684e-02 1 1  ON 43
eH1_4                -8.235144e-03 1 1  ON 44
eH1_5                 1.739515e-02 1 1  ON 45
eH1_6                 4.606484e-02 1 1  ON 46
eH1_7                 3.927140e-02 1 1  ON 47
eH1_8                 7.524484e-02 1 1  ON 48
eH1_9                 6.187151e-02 1 1  ON 49
eH2_0                -1.394479e-01 1 1  ON 50
eH2_1                -4.450267e-02 1 1  ON 51
eH2_2                -2.173085e-02 1 1  ON 52
eH2_3                -3.498368e-02 1 1  ON 53
eH2_4                -6.919844e-03 1 1  ON 54
eH2_5                 2.004614e-02 1 1  ON 55
eH2_6                 4.945909e-02 1 1  ON 56
eH2_7                 4.370939e-02 1 1  ON 57
eH2_8                 6.697073e-02 1 1  ON 58
eH2_9                 6.199408e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8829
    reference variance = 0.518386
====================================================
  Execution time = 4.3175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4712e-01
  Total weights = 2.0000e+06
  Execution time = 3.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447182250871
                                         uncertainty =       0.002860240662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447182250871
                                         uncertainty =       0.002860240662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472820667
  error estimate for blocks of size 2^( 2) =       0.000497820487
  error estimate for blocks of size 2^( 3) =       0.000521788767
  error estimate for blocks of size 2^( 4) =       0.000539942440
  error estimate for blocks of size 2^( 5) =       0.000551420080
  error estimate for blocks of size 2^( 6) =       0.000558113912
  error estimate for blocks of size 2^( 7) =       0.000564250820

      target function =      -0.747689215082
              le_mean =     -22.814849412376
             les_mean =     520.964472251603
             stat err =       0.000553431813
             autocorr =       1.370046597252
   target nu stat err =       0.000553431813
   target dn stat err =       0.003009359992
      target stat err =       0.002623005664
              std dev =       0.668669399456
             le_variance =       0.447118765768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447184100365
                                         uncertainty =       0.002860274673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447184100365
                                         uncertainty =       0.002860274673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472821642
  error estimate for blocks of size 2^( 2) =       0.000497820156
  error estimate for blocks of size 2^( 3) =       0.000521787059
  error estimate for blocks of size 2^( 4) =       0.000539939576
  error estimate for blocks of size 2^( 5) =       0.000551416340
  error estimate for blocks of size 2^( 6) =       0.000558109782
  error estimate for blocks of size 2^( 7) =       0.000564246049

      target function =      -0.747687653728
              le_mean =     -22.814849406766
             les_mean =     520.964473840273
             stat err =       0.000553427936
             autocorr =       1.370021751441
   target nu stat err =       0.000553427936
   target dn stat err =       0.003009383979
      target stat err =       0.002623013666
              std dev =       0.668670778800
             le_variance =       0.447120610422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447183176198
                                         uncertainty =       0.002860257686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447183176198
                                         uncertainty =       0.002860257686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472821155
  error estimate for blocks of size 2^( 2) =       0.000497820322
  error estimate for blocks of size 2^( 3) =       0.000521787912
  error estimate for blocks of size 2^( 4) =       0.000539941006
  error estimate for blocks of size 2^( 5) =       0.000551418208
  error estimate for blocks of size 2^( 6) =       0.000558111845
  error estimate for blocks of size 2^( 7) =       0.000564248432

      target function =      -0.747688433917
              le_mean =     -22.814849409445
             les_mean =     520.964473040787
             stat err =       0.000553429873
             autocorr =       1.370034163966
   target nu stat err =       0.000553429873
   target dn stat err =       0.003009372002
      target stat err =       0.002623009674
              std dev =       0.668670089560
             le_variance =       0.447119688672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447182366518
                                         uncertainty =       0.002860242790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447182366518
                                         uncertainty =       0.002860242790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472820728
  error estimate for blocks of size 2^( 2) =       0.000497820467
  error estimate for blocks of size 2^( 3) =       0.000521788660
  error estimate for blocks of size 2^( 4) =       0.000539942261
  error estimate for blocks of size 2^( 5) =       0.000551419846
  error estimate for blocks of size 2^( 6) =       0.000558113654
  error estimate for blocks of size 2^( 7) =       0.000564250522

      target function =      -0.747689117452
              le_mean =     -22.814849411997
             les_mean =     520.964472349642
             stat err =       0.000553431571
             autocorr =       1.370045042732
   target nu stat err =       0.000553431571
   target dn stat err =       0.003009361494
      target stat err =       0.002623006165
              std dev =       0.668669485705
             le_variance =       0.447118881113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747689215082        initial  <--
     2.5000e+01     2.5000e+02             4.5516e-05        -0.747687653728
     1.0000e+02     1.0000e+03             1.1379e-05        -0.747688433917
     4.0000e+02     4.0000e+03             2.8446e-06        -0.747689117452

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6771
  </log>
  <optVariables href="FORM2.s002.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2113e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2847e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7693
    reference variance = 0.751966
====================================================
  Execution time = 4.4173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4935e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448701606036
                                         uncertainty =       0.004405303551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448701606036
                                         uncertainty =       0.004405303551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473659079
  error estimate for blocks of size 2^( 2) =       0.000498644593
  error estimate for blocks of size 2^( 3) =       0.000523042114
  error estimate for blocks of size 2^( 4) =       0.000541207448
  error estimate for blocks of size 2^( 5) =       0.000553079555
  error estimate for blocks of size 2^( 6) =       0.000559101478
  error estimate for blocks of size 2^( 7) =       0.000564901800

      target function =      -0.746331613136
              le_mean =     -22.815243807647
             les_mean =     520.984055623844
             stat err =       0.000554572570
             autocorr =       1.370834540229
   target nu stat err =       0.000554572570
   target dn stat err =       0.004461466461
      target stat err =       0.003816596349
              std dev =       0.669855093162
             le_variance =       0.448705845835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281524380765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746350155668       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746350199285       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746350227935       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746350234200       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746350235252       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746350239015       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746350240492       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746350240996       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746350241410       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746350242128       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746350241933       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746350242182       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746350242604       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746350244474       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746350245619       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746350246924       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746350247243       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746350248365       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746350250011       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746350250873       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746350251246       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746350251605       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746350251735       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746350251856       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746350252148       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746350252270       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746350252299       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746350252317       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746350252327       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746350252329       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 2.696567e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746350155668       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746350166574       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746350173737       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746350175304       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746350175567       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746350176507       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746350176877       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746350177003       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746350177107       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746350177287       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746350177240       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746350177298       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746350177405       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746350177871       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746350178158       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746350178484       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746350178563       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746350178844       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746350179258       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746350179472       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746350179564       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746350179656       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746350179688       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746350179726       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746350179790       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746350179822       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746350179829       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746350179833       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746350179836       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746350179837       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 6.741378e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746350155668       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746350158394       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746350160185       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746350160577       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746350160642       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746350160878       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746350160975       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746350161002       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746350161019       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746350161072       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746350161059       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746350161075       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746350161096       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746350161225       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746350161292       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746350161380       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746350161396       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746350161451       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746350161580       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746350161608       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746350161637       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746350161663       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746350161678       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746350161683       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746350161695       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746350161707       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746350161708       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746350161716       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746350161724       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746350161718       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 1.685342e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9142e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
 uu_0                 2.659901e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585412e-03 1 1  ON 2
 uu_3                -5.283751e-02 1 1  ON 3
 uu_4                -8.663703e-02 1 1  ON 4
 uu_5                -1.051062e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038545e-01 1 1  ON 7
 uu_8                -8.046533e-02 1 1  ON 8
 uu_9                -4.288796e-02 1 1  ON 9
 ud_0                 3.458921e-01 1 1  ON 10
 ud_1                 1.068886e-01 1 1  ON 11
 ud_2                -9.362429e-03 1 1  ON 12
 ud_3                -6.924535e-02 1 1  ON 13
 ud_4                -1.012961e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120299e-01 1 1  ON 17
 ud_8                -8.585245e-02 1 1  ON 18
 ud_9                -4.559126e-02 1 1  ON 19
 eC_0                -4.506187e-01 1 1  ON 20
 eC_1                -3.146075e-01 1 1  ON 21
 eC_2                -6.877481e-02 1 1  ON 22
 eC_3                 8.858670e-02 1 1  ON 23
 eC_4                 1.363005e-01 1 1  ON 24
 eC_5                 2.006962e-01 1 1  ON 25
 eC_6                 2.136813e-01 1 1  ON 26
 eC_7                 1.597094e-01 1 1  ON 27
 eC_8                 3.434738e-02 1 1  ON 28
 eC_9                 1.047621e-03 1 1  ON 29
 eO_0                -8.235922e-01 1 1  ON 30
 eO_1                -5.244952e-01 1 1  ON 31
 eO_2                -1.331915e-01 1 1  ON 32
 eO_3                 1.329654e-01 1 1  ON 33
 eO_4                 2.611682e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302410e-01 1 1  ON 36
 eO_7                 2.658997e-01 1 1  ON 37
 eO_8                 1.071364e-01 1 1  ON 38
 eO_9                 2.449986e-02 1 1  ON 39
eH1_0                -1.397718e-01 1 1  ON 40
eH1_1                -4.653277e-02 1 1  ON 41
eH1_2                -2.257486e-02 1 1  ON 42
eH1_3                -3.701492e-02 1 1  ON 43
eH1_4                -8.233677e-03 1 1  ON 44
eH1_5                 1.739623e-02 1 1  ON 45
eH1_6                 4.606471e-02 1 1  ON 46
eH1_7                 3.927178e-02 1 1  ON 47
eH1_8                 7.524859e-02 1 1  ON 48
eH1_9                 6.186030e-02 1 1  ON 49
eH2_0                -1.394484e-01 1 1  ON 50
eH2_1                -4.450300e-02 1 1  ON 51
eH2_2                -2.173048e-02 1 1  ON 52
eH2_3                -3.498440e-02 1 1  ON 53
eH2_4                -6.920797e-03 1 1  ON 54
eH2_5                 2.004557e-02 1 1  ON 55
eH2_6                 4.945834e-02 1 1  ON 56
eH2_7                 4.371002e-02 1 1  ON 57
eH2_8                 6.697443e-02 1 1  ON 58
eH2_9                 6.199338e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8629
    reference variance = 0.353615
====================================================
  Execution time = 4.4787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5013e-01
  Total weights = 2.0000e+06
  Execution time = 3.4856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001668041
                                         uncertainty =       0.003372871337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001668041
                                         uncertainty =       0.003372871337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474408286
  error estimate for blocks of size 2^( 2) =       0.000499679292
  error estimate for blocks of size 2^( 3) =       0.000523748575
  error estimate for blocks of size 2^( 4) =       0.000542125871
  error estimate for blocks of size 2^( 5) =       0.000552589182
  error estimate for blocks of size 2^( 6) =       0.000559685771
  error estimate for blocks of size 2^( 7) =       0.000564523429

      target function =      -0.745161834617
              le_mean =     -22.814140544540
             les_mean =     520.935135005226
             stat err =       0.000554731063
             autocorr =       1.367289376628
   target nu stat err =       0.000554731063
   target dn stat err =       0.003409247045
      target stat err =       0.002930473670
              std dev =       0.670914632626
             le_variance =       0.450126444272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001779907
                                         uncertainty =       0.003372883272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001779907
                                         uncertainty =       0.003372883272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474408346
  error estimate for blocks of size 2^( 2) =       0.000499679213
  error estimate for blocks of size 2^( 3) =       0.000523748363
  error estimate for blocks of size 2^( 4) =       0.000542125551
  error estimate for blocks of size 2^( 5) =       0.000552588799
  error estimate for blocks of size 2^( 6) =       0.000559685335
  error estimate for blocks of size 2^( 7) =       0.000564522951

      target function =      -0.745161739493
              le_mean =     -22.814140548941
             les_mean =     520.935135319133
             stat err =       0.000554730659
             autocorr =       1.367287039263
   target nu stat err =       0.000554730659
   target dn stat err =       0.003409259280
      target stat err =       0.002930482899
              std dev =       0.670914716907
             le_variance =       0.450126557363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001723981
                                         uncertainty =       0.003372877305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001723981
                                         uncertainty =       0.003372877305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474408316
  error estimate for blocks of size 2^( 2) =       0.000499679252
  error estimate for blocks of size 2^( 3) =       0.000523748469
  error estimate for blocks of size 2^( 4) =       0.000542125711
  error estimate for blocks of size 2^( 5) =       0.000552588990
  error estimate for blocks of size 2^( 6) =       0.000559685553
  error estimate for blocks of size 2^( 7) =       0.000564523190

      target function =      -0.745161787049
              le_mean =     -22.814140546740
             les_mean =     520.935135162151
             stat err =       0.000554730861
             autocorr =       1.367288207809
   target nu stat err =       0.000554730861
   target dn stat err =       0.003409253163
      target stat err =       0.002930478285
              std dev =       0.670914674772
             le_variance =       0.450126500824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001675034
                                         uncertainty =       0.003372872083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450001675034
                                         uncertainty =       0.003372872083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474408290
  error estimate for blocks of size 2^( 2) =       0.000499679287
  error estimate for blocks of size 2^( 3) =       0.000523748561
  error estimate for blocks of size 2^( 4) =       0.000542125851
  error estimate for blocks of size 2^( 5) =       0.000552589158
  error estimate for blocks of size 2^( 6) =       0.000559685744
  error estimate for blocks of size 2^( 7) =       0.000564523400

      target function =      -0.745161828671
              le_mean =     -22.814140544815
             les_mean =     520.935135024836
             stat err =       0.000554731038
             autocorr =       1.367289230526
   target nu stat err =       0.000554731038
   target dn stat err =       0.003409247810
      target stat err =       0.002930474247
              std dev =       0.670914637894
             le_variance =       0.450126451341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745161834617        initial  <--
     2.5000e+02     2.5000e+03             2.6966e-06        -0.745161739493
     1.0000e+03     1.0000e+04             6.7414e-07        -0.745161787049
     4.0000e+03     4.0000e+04             1.6853e-07        -0.745161828671

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.2645
  </log>
  <optVariables href="FORM2.s003.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2141e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2839e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8233
    reference variance = 0.366893
====================================================
  Execution time = 4.4070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4316e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4948e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443068729904
                                         uncertainty =       0.003124071144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443068729904
                                         uncertainty =       0.003124071144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470724223
  error estimate for blocks of size 2^( 2) =       0.000496066217
  error estimate for blocks of size 2^( 3) =       0.000520075023
  error estimate for blocks of size 2^( 4) =       0.000537509157
  error estimate for blocks of size 2^( 5) =       0.000549037923
  error estimate for blocks of size 2^( 6) =       0.000555187813
  error estimate for blocks of size 2^( 7) =       0.000559020640

      target function =      -0.751055794941
              le_mean =     -22.814524793623
             les_mean =     520.945703925723
             stat err =       0.000550188883
             autocorr =       1.366125278148
   target nu stat err =       0.000550188883
   target dn stat err =       0.002954569160
      target stat err =       0.002598410233
              std dev =       0.665704580477
             le_variance =       0.443162588468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281452479362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751063818145       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751063822577       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751063824691       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751063825743       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751063826269       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751063826562       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751063826869       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751063826966       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751063827124       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751063827211       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751063827395       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751063827550       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751063827695       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751063827823       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751063828064       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751063828262       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751063828341       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751063828353       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751063828377       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751063828381       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751063828463       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751063828470       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751063828504       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751063828555       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751063828587       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751063828600       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751063828620       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751063828627       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751063828625       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751063828617       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751063828642       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 3.368617e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751063818145       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751063819253       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751063819781       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751063820044       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751063820180       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751063820261       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751063820329       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751063820345       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751063820379       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751063820410       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751063820447       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751063820480       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751063820525       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751063820562       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751063820596       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751063820680       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751063820698       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751063820654       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751063820726       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751063820682       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751063820733       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751063820734       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751063820772       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751063820759       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751063820744       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751063820753       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751063820765       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751063820745       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751063820772       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751063820735       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751063820771       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 8.421537e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751063818145       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751063818422       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751063818554       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751063818600       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751063818652       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751063818673       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751063818702       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751063818628       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751063818663       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751063818728       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751063818700       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751063818658       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751063818678       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751063818763       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751063818752       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751063818835       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751063818757       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751063818762       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751063818788       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751063818778       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751063818910       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751063818765       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751063818580       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751063818747       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751063818780       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751063818735       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751063818801       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751063818738       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751063818728       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751063818694       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751063818736       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+04 is 2.105384e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.475268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9056e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
 uu_0                 2.659901e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585437e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046520e-02 1 1  ON 8
 uu_9                -4.288806e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924530e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120299e-01 1 1  ON 17
 ud_8                -8.585232e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877448e-02 1 1  ON 22
 eC_3                 8.858702e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434705e-02 1 1  ON 28
 eC_9                 1.047651e-03 1 1  ON 29
 eO_0                -8.235917e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461236e-01 1 1  ON 35
 eO_6                 3.302409e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071359e-01 1 1  ON 38
 eO_9                 2.449965e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257472e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233744e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606476e-02 1 1  ON 46
eH1_7                 3.927165e-02 1 1  ON 47
eH1_8                 7.524875e-02 1 1  ON 48
eH1_9                 6.186014e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450286e-02 1 1  ON 51
eH2_2                -2.173022e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920907e-03 1 1  ON 54
eH2_5                 2.004557e-02 1 1  ON 55
eH2_6                 4.945827e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697445e-02 1 1  ON 58
eH2_9                 6.199320e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7518
    reference variance = 0.337774
====================================================
  Execution time = 4.4986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4673e-01
  Total weights = 2.0000e+06
  Execution time = 3.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716129412
                                         uncertainty =       0.002564152937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716129412
                                         uncertainty =       0.002564152937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472615079
  error estimate for blocks of size 2^( 2) =       0.000497969290
  error estimate for blocks of size 2^( 3) =       0.000522154614
  error estimate for blocks of size 2^( 4) =       0.000539628329
  error estimate for blocks of size 2^( 5) =       0.000552388763
  error estimate for blocks of size 2^( 6) =       0.000559936002
  error estimate for blocks of size 2^( 7) =       0.000566623496

      target function =      -0.748024694699
              le_mean =     -22.814472073979
             les_mean =     520.946865817242
             stat err =       0.000554644148
             autocorr =       1.377252982273
   target nu stat err =       0.000554644148
   target dn stat err =       0.002778800175
      target stat err =       0.002435026802
              std dev =       0.668378654819
             le_variance =       0.446730026217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716133546
                                         uncertainty =       0.002564153890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716133546
                                         uncertainty =       0.002564153890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472615081
  error estimate for blocks of size 2^( 2) =       0.000497969275
  error estimate for blocks of size 2^( 3) =       0.000522154583
  error estimate for blocks of size 2^( 4) =       0.000539628285
  error estimate for blocks of size 2^( 5) =       0.000552388711
  error estimate for blocks of size 2^( 6) =       0.000559935947
  error estimate for blocks of size 2^( 7) =       0.000566623437

      target function =      -0.748024691186
              le_mean =     -22.814472074458
             les_mean =     520.946865843204
             stat err =       0.000554644095
             autocorr =       1.377252708051
   target nu stat err =       0.000554644095
   target dn stat err =       0.002778801037
      target stat err =       0.002435027471
              std dev =       0.668378657914
             le_variance =       0.446730030354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716131479
                                         uncertainty =       0.002564153414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716131479
                                         uncertainty =       0.002564153414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472615080
  error estimate for blocks of size 2^( 2) =       0.000497969282
  error estimate for blocks of size 2^( 3) =       0.000522154598
  error estimate for blocks of size 2^( 4) =       0.000539628307
  error estimate for blocks of size 2^( 5) =       0.000552388737
  error estimate for blocks of size 2^( 6) =       0.000559935974
  error estimate for blocks of size 2^( 7) =       0.000566623466

      target function =      -0.748024692942
              le_mean =     -22.814472074219
             les_mean =     520.946865830222
             stat err =       0.000554644121
             autocorr =       1.377252845164
   target nu stat err =       0.000554644121
   target dn stat err =       0.002778800606
      target stat err =       0.002435027137
              std dev =       0.668378656366
             le_variance =       0.446730028286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716129671
                                         uncertainty =       0.002564152997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446716129671
                                         uncertainty =       0.002564152997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472615079
  error estimate for blocks of size 2^( 2) =       0.000497969289
  error estimate for blocks of size 2^( 3) =       0.000522154612
  error estimate for blocks of size 2^( 4) =       0.000539628327
  error estimate for blocks of size 2^( 5) =       0.000552388760
  error estimate for blocks of size 2^( 6) =       0.000559935999
  error estimate for blocks of size 2^( 7) =       0.000566623492

      target function =      -0.748024694480
              le_mean =     -22.814472074009
             les_mean =     520.946865818864
             stat err =       0.000554644144
             autocorr =       1.377252965144
   target nu stat err =       0.000554644144
   target dn stat err =       0.002778800229
      target stat err =       0.002435026844
              std dev =       0.668378655012
             le_variance =       0.446730026476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748024694699        initial  <--
     2.5000e+03     2.5000e+04             3.3686e-07        -0.748024691186
     1.0000e+04     1.0000e+05             8.4215e-08        -0.748024692942
     4.0000e+04     4.0000e+05             2.1054e-08        -0.748024694480

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6859
  </log>
  <optVariables href="FORM2.s004.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2176e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8007
    reference variance = 0.334154
====================================================
  Execution time = 4.3911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4999e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448787642266
                                         uncertainty =       0.002672886172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448787642266
                                         uncertainty =       0.002672886172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473662619
  error estimate for blocks of size 2^( 2) =       0.000499774394
  error estimate for blocks of size 2^( 3) =       0.000523599705
  error estimate for blocks of size 2^( 4) =       0.000542994714
  error estimate for blocks of size 2^( 5) =       0.000555532389
  error estimate for blocks of size 2^( 6) =       0.000562411127
  error estimate for blocks of size 2^( 7) =       0.000566640121

      target function =      -0.746349414910
              le_mean =     -22.814462093591
             les_mean =     520.948392948815
             stat err =       0.000556894588
             autocorr =       1.382317387501
   target nu stat err =       0.000556894588
   target dn stat err =       0.002910578058
      target stat err =       0.002532552099
              std dev =       0.669860099772
             le_variance =       0.448712553267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281446209359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746356921824       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746356922059       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746356922178       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746356922259       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746356922306       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746356922345       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746356922367       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746356922433       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746356922383       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746356922382       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746356922362       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746356922404       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746356922342       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746356922418       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746356922455       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746356922452       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746356922442       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746356922542       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746356922490       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746356922492       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746356922488       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746356922501       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746356922487       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746356922471       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746356922471       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746356922581       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746356922505       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746356922521       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746356922507       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746356922471       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746356922488       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746356922502       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 3.984973e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746356921824       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746356921883       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746356921913       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746356921859       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746356921830       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746356921955       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746356921967       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746356922048       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746356922106       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746356922083       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746356922159       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746356921898       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746356921982       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746356921794       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746356921821       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746356921881       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746356922050       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746356921972       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746356921752       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746356922193       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746356921985       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746356922251       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746356922143       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746356922011       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746356922054       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746356921899       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746356921786       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746356922100       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746356921815       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746356922144       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746356921648       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746356921877       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 9.962433e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746356921824       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746356921839       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746356921847       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746356921931       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746356921539       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746356921857       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746356921858       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746356921859       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746356921859       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746356922565       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746356921505       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746356921960       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746356921634       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746356922023       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746356922171       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746356921485       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746356921416       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746356922318       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746356922749       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746356921001       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746356922841       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746356921765       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746356922115       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746356921749       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746356922778       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746356923617       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746356921796       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746356921779       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746356921791       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746356922144       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746356920444       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746356922568       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+05 is 2.490609e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.510413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8950e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
 uu_0                 2.659901e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288805e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362423e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434704e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302409e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233742e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697446e-02 1 1  ON 58
eH2_9                 6.199320e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7687
    reference variance = 0.376336
====================================================
  Execution time = 4.3215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5052e-01
  Total weights = 2.0000e+06
  Execution time = 3.4806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531770714
                                         uncertainty =       0.003197430639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531770714
                                         uncertainty =       0.003197430639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474617779
  error estimate for blocks of size 2^( 2) =       0.000500213088
  error estimate for blocks of size 2^( 3) =       0.000524395235
  error estimate for blocks of size 2^( 4) =       0.000542327036
  error estimate for blocks of size 2^( 5) =       0.000553449935
  error estimate for blocks of size 2^( 6) =       0.000559469218
  error estimate for blocks of size 2^( 7) =       0.000564448347

      target function =      -0.744839879169
              le_mean =     -22.813434612937
             les_mean =     520.903322685681
             stat err =       0.000554923634
             autocorr =       1.367031236184
   target nu stat err =       0.000554923634
   target dn stat err =       0.003367110216
      target stat err =       0.002890428659
              std dev =       0.671210899919
             le_variance =       0.450524072170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531772370
                                         uncertainty =       0.003197430733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531772370
                                         uncertainty =       0.003197430733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474617780
  error estimate for blocks of size 2^( 2) =       0.000500213087
  error estimate for blocks of size 2^( 3) =       0.000524395233
  error estimate for blocks of size 2^( 4) =       0.000542327033
  error estimate for blocks of size 2^( 5) =       0.000553449932
  error estimate for blocks of size 2^( 6) =       0.000559469214
  error estimate for blocks of size 2^( 7) =       0.000564448343

      target function =      -0.744839877781
              le_mean =     -22.813434612970
             les_mean =     520.903322688803
             stat err =       0.000554923630
             autocorr =       1.367031212478
   target nu stat err =       0.000554923630
   target dn stat err =       0.003367110297
      target stat err =       0.002890428713
              std dev =       0.671210901152
             le_variance =       0.450524073825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531771542
                                         uncertainty =       0.003197430686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531771542
                                         uncertainty =       0.003197430686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474617779
  error estimate for blocks of size 2^( 2) =       0.000500213087
  error estimate for blocks of size 2^( 3) =       0.000524395234
  error estimate for blocks of size 2^( 4) =       0.000542327034
  error estimate for blocks of size 2^( 5) =       0.000553449934
  error estimate for blocks of size 2^( 6) =       0.000559469216
  error estimate for blocks of size 2^( 7) =       0.000564448345

      target function =      -0.744839878475
              le_mean =     -22.813434612954
             les_mean =     520.903322687242
             stat err =       0.000554923632
             autocorr =       1.367031224330
   target nu stat err =       0.000554923632
   target dn stat err =       0.003367110257
      target stat err =       0.002890428686
              std dev =       0.671210900535
             le_variance =       0.450524072997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531770817
                                         uncertainty =       0.003197430645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450531770817
                                         uncertainty =       0.003197430645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474617779
  error estimate for blocks of size 2^( 2) =       0.000500213088
  error estimate for blocks of size 2^( 3) =       0.000524395235
  error estimate for blocks of size 2^( 4) =       0.000542327036
  error estimate for blocks of size 2^( 5) =       0.000553449935
  error estimate for blocks of size 2^( 6) =       0.000559469217
  error estimate for blocks of size 2^( 7) =       0.000564448347

      target function =      -0.744839879082
              le_mean =     -22.813434612939
             les_mean =     520.903322685876
             stat err =       0.000554923634
             autocorr =       1.367031234710
   target nu stat err =       0.000554923634
   target dn stat err =       0.003367110221
      target stat err =       0.002890428662
              std dev =       0.671210899996
             le_variance =       0.450524072274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744839879169        initial  <--
     2.5000e+04     2.5000e+05             3.9850e-08        -0.744839877781
     1.0000e+05     1.0000e+06             9.9624e-09        -0.744839878475
     4.0000e+05     4.0000e+06             2.4906e-09        -0.744839879082

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6181
  </log>
  <optVariables href="FORM2.s005.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1958e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7343
    reference variance = 0.367951
====================================================
  Execution time = 4.5641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4692e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448490228408
                                         uncertainty =       0.002510079750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448490228408
                                         uncertainty =       0.002510079750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473555628
  error estimate for blocks of size 2^( 2) =       0.000499087498
  error estimate for blocks of size 2^( 3) =       0.000522882552
  error estimate for blocks of size 2^( 4) =       0.000541383230
  error estimate for blocks of size 2^( 5) =       0.000553651999
  error estimate for blocks of size 2^( 6) =       0.000560145751
  error estimate for blocks of size 2^( 7) =       0.000563393230

      target function =      -0.746516330198
              le_mean =     -22.814728948675
             les_mean =     520.960366642366
             stat err =       0.000554643553
             autocorr =       1.371784634511
   target nu stat err =       0.000554643553
   target dn stat err =       0.002865402496
      target stat err =       0.002497135423
              std dev =       0.669708791291
             le_variance =       0.448509865132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472894867e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746523745475       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746523745501       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746523745523       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746523745535       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746523745517       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746523745747       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746523745577       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746523745442       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746523745696       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746523744815       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746523745752       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746523745856       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746523745486       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746523745558       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746523745849       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746523745894       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746523745672       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746523745603       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746523745611       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746523745082       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746523745417       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746523746125       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746523745779       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746523745403       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746523745853       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746523744963       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746523744833       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746523745771       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746523744713       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746523744673       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746523745551       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746523745002       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 3.285879e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746523745475       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746523745481       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746523745487       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746523746724       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746523745467       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746523746212       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746523746029       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746523744923       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746523743240       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746523744785       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746523745340       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746523744969       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746523746107       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746523744859       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746523747126       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746523746419       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746523743533       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746523749112       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746523744871       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746523745788       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746523745253       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746523745238       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746523743276       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746523744019       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746523742647       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746523743193       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746523748280       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746523748747       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746523747371       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746523749057       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746523743731       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746523742738       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+06 is 8.214695e-10

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746523745475       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746523745476       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746523745478       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746523745456       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746523745561       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746523745421       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746523748943       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746523742235       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746523756685       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746523737087       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746523747259       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746523749135       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746523747397       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746523748633       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746523747364       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746523744657       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746523744178       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746523745412       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746523740815       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746523750511       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746523744769       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746523735687       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746523737586       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746523755478       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746523731811       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746523748674       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746523736120       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746523719613       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746523743273       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746523734621       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746523735406       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746523728786       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+06 is 2.053659e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.545547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0374e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697446e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6723
    reference variance = 0.421122
====================================================
  Execution time = 4.3452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4288e-01
  Total weights = 2.0000e+06
  Execution time = 3.4841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861505980
                                         uncertainty =       0.002509325054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861505980
                                         uncertainty =       0.002509325054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470571832
  error estimate for blocks of size 2^( 2) =       0.000495643363
  error estimate for blocks of size 2^( 3) =       0.000519811235
  error estimate for blocks of size 2^( 4) =       0.000538255563
  error estimate for blocks of size 2^( 5) =       0.000549880332
  error estimate for blocks of size 2^( 6) =       0.000556182241
  error estimate for blocks of size 2^( 7) =       0.000560685780

      target function =      -0.751303958434
              le_mean =     -22.814345628694
             les_mean =     520.937241942443
             stat err =       0.000551250979
             autocorr =       1.372293142946
   target nu stat err =       0.000551250979
   target dn stat err =       0.002628840675
      target stat err =       0.002330669224
              std dev =       0.665489067056
             le_variance =       0.442875698371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861506073
                                         uncertainty =       0.002509325060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861506073
                                         uncertainty =       0.002509325060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470571832
  error estimate for blocks of size 2^( 2) =       0.000495643363
  error estimate for blocks of size 2^( 3) =       0.000519811235
  error estimate for blocks of size 2^( 4) =       0.000538255562
  error estimate for blocks of size 2^( 5) =       0.000549880332
  error estimate for blocks of size 2^( 6) =       0.000556182241
  error estimate for blocks of size 2^( 7) =       0.000560685780

      target function =      -0.751303958355
              le_mean =     -22.814345628699
             les_mean =     520.937241942753
             stat err =       0.000551250979
             autocorr =       1.372293140698
   target nu stat err =       0.000551250979
   target dn stat err =       0.002628840681
      target stat err =       0.002330669228
              std dev =       0.665489067126
             le_variance =       0.442875698465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861506026
                                         uncertainty =       0.002509325057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861506026
                                         uncertainty =       0.002509325057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470571832
  error estimate for blocks of size 2^( 2) =       0.000495643363
  error estimate for blocks of size 2^( 3) =       0.000519811235
  error estimate for blocks of size 2^( 4) =       0.000538255563
  error estimate for blocks of size 2^( 5) =       0.000549880332
  error estimate for blocks of size 2^( 6) =       0.000556182241
  error estimate for blocks of size 2^( 7) =       0.000560685780

      target function =      -0.751303958395
              le_mean =     -22.814345628696
             les_mean =     520.937241942598
             stat err =       0.000551250979
             autocorr =       1.372293141821
   target nu stat err =       0.000551250979
   target dn stat err =       0.002628840678
      target stat err =       0.002330669226
              std dev =       0.665489067091
             le_variance =       0.442875698418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861505986
                                         uncertainty =       0.002509325054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861505986
                                         uncertainty =       0.002509325054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470571832
  error estimate for blocks of size 2^( 2) =       0.000495643363
  error estimate for blocks of size 2^( 3) =       0.000519811235
  error estimate for blocks of size 2^( 4) =       0.000538255563
  error estimate for blocks of size 2^( 5) =       0.000549880332
  error estimate for blocks of size 2^( 6) =       0.000556182241
  error estimate for blocks of size 2^( 7) =       0.000560685780

      target function =      -0.751303958429
              le_mean =     -22.814345628694
             les_mean =     520.937241942462
             stat err =       0.000551250979
             autocorr =       1.372293142805
   target nu stat err =       0.000551250979
   target dn stat err =       0.002628840675
      target stat err =       0.002330669224
              std dev =       0.665489067061
             le_variance =       0.442875698377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751303958434        initial  <--
     2.5000e+05     2.5000e+06             3.2859e-09        -0.751303958355
     1.0000e+06     1.0000e+07             8.2147e-10        -0.751303958395
     4.0000e+06     4.0000e+07             2.0537e-10        -0.751303958429

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8341
  </log>
  <optVariables href="FORM2.s006.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2122e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8707
    reference variance = 0.565788
====================================================
  Execution time = 4.5408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5139e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4910e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451412046574
                                         uncertainty =       0.003657206949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451412046574
                                         uncertainty =       0.003657206949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475073581
  error estimate for blocks of size 2^( 2) =       0.000500251843
  error estimate for blocks of size 2^( 3) =       0.000524022672
  error estimate for blocks of size 2^( 4) =       0.000541890871
  error estimate for blocks of size 2^( 5) =       0.000553095086
  error estimate for blocks of size 2^( 6) =       0.000559827942
  error estimate for blocks of size 2^( 7) =       0.000563605208

      target function =      -0.744094453915
              le_mean =     -22.814417697947
             les_mean =     520.949044484750
             stat err =       0.000554604777
             autocorr =       1.362841824124
   target nu stat err =       0.000554604777
   target dn stat err =       0.003853713542
      target stat err =       0.003288194348
              std dev =       0.671855500860
             le_variance =       0.451389814035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281441769795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744107955351       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744107955354       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744107955356       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744107955356       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744107955396       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744107953760       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744107956315       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744107957950       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744107955889       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744107957104       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744107967395       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744107957104       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744107950485       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744107954250       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744107953952       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744107951843       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744107957339       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744107959700       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744107959271       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744107952316       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744107953641       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744107951446       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744107951924       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744107952122       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744107950215       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744107952758       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744107955906       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744107962893       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744107964222       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744107958748       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744107957340       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 3.637748e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744107955351       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744107955352       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744107955352       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744107955352       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744107960368       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744107957952       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744107946859       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744107968949       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744107936084       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744107956276       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744107957042       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744107973714       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744107935789       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744107944484       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744107967899       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744107957392       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744107942381       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744107974903       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744107946649       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744107961993       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744107926535       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744107918742       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744107940945       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744107923807       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744107978179       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744107978173       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744107967373       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744107956722       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744108009405       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744107978760       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744107971109       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 9.094397e-11

solving harmonic davidson linear method for identity shift 4.0000e+07, overlap shift 4.0000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744107955351       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744107955351       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744107955351       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744107953774       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744107955978       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744108000199       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744107954800       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744107977402       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744107930906       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744108052103       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744107918605       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744107895266       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744108114599       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744107922148       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744107971991       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744108031520       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744108025022       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744108022472       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744107927379       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744108003568       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744107891256       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744107968382       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744108077112       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744107921742       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744107969272       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744107992678       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744108101943       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744108002446       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744107906340       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744108000350       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744107981057       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+07 is 2.273724e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.577771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0356e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8786
    reference variance = 0.760065
====================================================
  Execution time = 4.3522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.7184e-01
  Total weights = 2.0000e+06
  Execution time = 3.4598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333368
                                         uncertainty =       0.020197538561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333368
                                         uncertainty =       0.020197538561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485714888
  error estimate for blocks of size 2^( 2) =       0.000510354480
  error estimate for blocks of size 2^( 3) =       0.000534061069
  error estimate for blocks of size 2^( 4) =       0.000551331552
  error estimate for blocks of size 2^( 5) =       0.000561965491
  error estimate for blocks of size 2^( 6) =       0.000568968120
  error estimate for blocks of size 2^( 7) =       0.000572622365

      target function =      -0.727025139078
              le_mean =     -22.814216600441
             les_mean =     520.960316761595
             stat err =       0.000563721882
             autocorr =       1.346998011813
   target nu stat err =       0.000563721882
   target dn stat err =       0.019931933080
      target stat err =       0.015954783021
              std dev =       0.686904582648
             le_variance =       0.471837905663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333371
                                         uncertainty =       0.020197538564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333371
                                         uncertainty =       0.020197538564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485714888
  error estimate for blocks of size 2^( 2) =       0.000510354480
  error estimate for blocks of size 2^( 3) =       0.000534061069
  error estimate for blocks of size 2^( 4) =       0.000551331552
  error estimate for blocks of size 2^( 5) =       0.000561965491
  error estimate for blocks of size 2^( 6) =       0.000568968120
  error estimate for blocks of size 2^( 7) =       0.000572622365

      target function =      -0.727025139075
              le_mean =     -22.814216600441
             les_mean =     520.960316761591
             stat err =       0.000563721882
             autocorr =       1.346998011599
   target nu stat err =       0.000563721882
   target dn stat err =       0.019931933083
      target stat err =       0.015954783023
              std dev =       0.686904582651
             le_variance =       0.471837905667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333370
                                         uncertainty =       0.020197538563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333370
                                         uncertainty =       0.020197538563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485714888
  error estimate for blocks of size 2^( 2) =       0.000510354480
  error estimate for blocks of size 2^( 3) =       0.000534061069
  error estimate for blocks of size 2^( 4) =       0.000551331552
  error estimate for blocks of size 2^( 5) =       0.000561965491
  error estimate for blocks of size 2^( 6) =       0.000568968120
  error estimate for blocks of size 2^( 7) =       0.000572622365

      target function =      -0.727025139076
              le_mean =     -22.814216600441
             les_mean =     520.960316761593
             stat err =       0.000563721882
             autocorr =       1.346998011711
   target nu stat err =       0.000563721882
   target dn stat err =       0.019931933081
      target stat err =       0.015954783022
              std dev =       0.686904582650
             le_variance =       0.471837905665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333368
                                         uncertainty =       0.020197538561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471907333368
                                         uncertainty =       0.020197538561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485714888
  error estimate for blocks of size 2^( 2) =       0.000510354480
  error estimate for blocks of size 2^( 3) =       0.000534061069
  error estimate for blocks of size 2^( 4) =       0.000551331552
  error estimate for blocks of size 2^( 5) =       0.000561965491
  error estimate for blocks of size 2^( 6) =       0.000568968120
  error estimate for blocks of size 2^( 7) =       0.000572622365

      target function =      -0.727025139078
              le_mean =     -22.814216600441
             les_mean =     520.960316761595
             stat err =       0.000563721882
             autocorr =       1.346998011800
   target nu stat err =       0.000563721882
   target dn stat err =       0.019931933080
      target stat err =       0.015954783021
              std dev =       0.686904582649
             le_variance =       0.471837905664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.727025139078        initial  <--
     2.5000e+06     2.5000e+07             3.6377e-10        -0.727025139075
     1.0000e+07     1.0000e+08             9.0944e-11        -0.727025139076
     4.0000e+07     4.0000e+08             2.2737e-11        -0.727025139078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8526
  </log>
  <optVariables href="FORM2.s007.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2124e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9395
    reference variance = 0.508857
====================================================
  Execution time = 4.3749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4897e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455175913352
                                         uncertainty =       0.005966636916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455175913352
                                         uncertainty =       0.005966636916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477103024
  error estimate for blocks of size 2^( 2) =       0.000502641009
  error estimate for blocks of size 2^( 3) =       0.000526327103
  error estimate for blocks of size 2^( 4) =       0.000543987936
  error estimate for blocks of size 2^( 5) =       0.000555053573
  error estimate for blocks of size 2^( 6) =       0.000562115452
  error estimate for blocks of size 2^( 7) =       0.000565072220

      target function =      -0.740867764286
              le_mean =     -22.813641927239
             les_mean =     520.917512347584
             stat err =       0.000556557295
             autocorr =       1.360803511198
   target nu stat err =       0.000556557295
   target dn stat err =       0.006086924270
      target stat err =       0.005087585663
              std dev =       0.674725567123
             le_variance =       0.455254590929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281364192724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740901719742       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740901719742       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740901719743       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740901719743       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740901719641       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740901714735       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740901692197       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740901718180       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740901706169       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740901749069       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740901678741       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740901748544       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740901723482       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740901763902       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740901727451       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740901790307       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740901828378       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740901671100       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740901710054       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740901710152       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740901618429       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740901770469       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740901748711       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740901676152       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740901797033       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740901628594       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740901727845       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740901755215       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740901739924       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740901722999       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740901686294       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740901737403       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740901706057       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 4.224500e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740901719742       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740901719742       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740901719742       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740901719742       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740901719742       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740901724225       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740901804845       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740901770195       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740901497786       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740901743146       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740901716481       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740901657517       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740901594453       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740901742228       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740902063065       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740901450853       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740901696865       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740901755213       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740901410781       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740901637071       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740901984322       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740901705618       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740901508213       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740901386728       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740901828260       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740901656041       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740901562668       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740901980214       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740901692556       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740901793529       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740901510502       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740901757252       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740901663805       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+08 is 1.056197e-11

solving harmonic davidson linear method for identity shift 4.0000e+08, overlap shift 4.0000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740901719742       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740901719742       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740901719742       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740901719742       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740901719742       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740901720831       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740901460425       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740901374998       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740901574583       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740901996107       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740901133612       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740901859901       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740900963972       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740901012379       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740902368323       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740901934894       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740902043987       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740901661197       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740902656434       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740901628516       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740901555014       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740901778330       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740901677450       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740900964992       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740902638528       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740903831043       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740900189869       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740902478639       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740900382430       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740900118530       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740902571360       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740902957366       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740903849251       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+08 is 2.640547e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.615564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8689e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7194
    reference variance = 0.775608
====================================================
  Execution time = 4.4406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6603e-01
  Total weights = 2.0000e+06
  Execution time = 3.4573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391555
                                         uncertainty =       0.017021645560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391555
                                         uncertainty =       0.017021645560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482717120
  error estimate for blocks of size 2^( 2) =       0.000507299916
  error estimate for blocks of size 2^( 3) =       0.000530911156
  error estimate for blocks of size 2^( 4) =       0.000548820524
  error estimate for blocks of size 2^( 5) =       0.000559930315
  error estimate for blocks of size 2^( 6) =       0.000567537986
  error estimate for blocks of size 2^( 7) =       0.000572161210

      target function =      -0.731797520889
              le_mean =     -22.813811366499
             les_mean =     520.936020468264
             stat err =       0.000562112509
             autocorr =       1.356004393581
   target nu stat err =       0.000562112509
   target dn stat err =       0.017153092364
      target stat err =       0.013904569060
              std dev =       0.682665097315
             le_variance =       0.466031635092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391558
                                         uncertainty =       0.017021645561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391558
                                         uncertainty =       0.017021645561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482717120
  error estimate for blocks of size 2^( 2) =       0.000507299916
  error estimate for blocks of size 2^( 3) =       0.000530911156
  error estimate for blocks of size 2^( 4) =       0.000548820524
  error estimate for blocks of size 2^( 5) =       0.000559930315
  error estimate for blocks of size 2^( 6) =       0.000567537986
  error estimate for blocks of size 2^( 7) =       0.000572161210

      target function =      -0.731797520887
              le_mean =     -22.813811366499
             les_mean =     520.936020468267
             stat err =       0.000562112509
             autocorr =       1.356004393562
   target nu stat err =       0.000562112509
   target dn stat err =       0.017153092365
      target stat err =       0.013904569061
              std dev =       0.682665097316
             le_variance =       0.466031635094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391556
                                         uncertainty =       0.017021645560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391556
                                         uncertainty =       0.017021645560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482717120
  error estimate for blocks of size 2^( 2) =       0.000507299916
  error estimate for blocks of size 2^( 3) =       0.000530911156
  error estimate for blocks of size 2^( 4) =       0.000548820524
  error estimate for blocks of size 2^( 5) =       0.000559930315
  error estimate for blocks of size 2^( 6) =       0.000567537986
  error estimate for blocks of size 2^( 7) =       0.000572161210

      target function =      -0.731797520888
              le_mean =     -22.813811366499
             les_mean =     520.936020468266
             stat err =       0.000562112509
             autocorr =       1.356004393574
   target nu stat err =       0.000562112509
   target dn stat err =       0.017153092365
      target stat err =       0.013904569061
              std dev =       0.682665097315
             le_variance =       0.466031635092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391555
                                         uncertainty =       0.017021645560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466038391555
                                         uncertainty =       0.017021645560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482717120
  error estimate for blocks of size 2^( 2) =       0.000507299916
  error estimate for blocks of size 2^( 3) =       0.000530911156
  error estimate for blocks of size 2^( 4) =       0.000548820524
  error estimate for blocks of size 2^( 5) =       0.000559930315
  error estimate for blocks of size 2^( 6) =       0.000567537986
  error estimate for blocks of size 2^( 7) =       0.000572161210

      target function =      -0.731797520889
              le_mean =     -22.813811366499
             les_mean =     520.936020468264
             stat err =       0.000562112509
             autocorr =       1.356004393582
   target nu stat err =       0.000562112509
   target dn stat err =       0.017153092364
      target stat err =       0.013904569060
              std dev =       0.682665097315
             le_variance =       0.466031635092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.731797520889        initial  <--
     2.5000e+07     2.5000e+08             4.2245e-11        -0.731797520887
     1.0000e+08     1.0000e+09             1.0562e-11        -0.731797520888
     4.0000e+08     4.0000e+09             2.6405e-12        -0.731797520889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7229
  </log>
  <optVariables href="FORM2.s008.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2043e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8382
    reference variance = 0.341709
====================================================
  Execution time = 4.5398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4690e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443437082639
                                         uncertainty =       0.002094813576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443437082639
                                         uncertainty =       0.002094813576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470869998
  error estimate for blocks of size 2^( 2) =       0.000496501243
  error estimate for blocks of size 2^( 3) =       0.000520498747
  error estimate for blocks of size 2^( 4) =       0.000539006487
  error estimate for blocks of size 2^( 5) =       0.000550171800
  error estimate for blocks of size 2^( 6) =       0.000556823215
  error estimate for blocks of size 2^( 7) =       0.000559390212

      target function =      -0.750821494483
              le_mean =     -22.814809356259
             les_mean =     520.958962850846
             stat err =       0.000551347929
             autocorr =       1.371037883579
   target nu stat err =       0.000551347929
   target dn stat err =       0.002505098357
      target stat err =       0.002227914699
              std dev =       0.665910737348
             le_variance =       0.443437110116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281480935626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750827008370       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750827008370       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750827008370       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750827008370       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750827008370       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750827008370       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750827008370       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750827008370       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750826628857       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750827008370       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750826892615       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750827008370       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750826561305       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750826812698       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750826597778       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750827036475       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750827567502       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750826789171       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750826759631       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750827020252       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750826253407       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750826231338       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750827111763       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750828115694       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750827250668       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750827645249       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750826914574       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750826192727       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750827588536       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750827298492       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750827116002       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 3.268133e-12

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750827008370       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750827008370       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750827008370       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750826363861       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750826765878       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750826645299       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750826127031       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750827008370       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750827008370       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750827998044       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750826009490       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750826099851       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750822654909       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750824881758       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750826251122       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750826896245       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750827547264       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750829782797       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750827734477       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750829153242       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750825210587       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750826509796       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750826569343       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750821768139       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750827073536       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750826865554       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750824855191       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750828518824       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750828312929       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750825064000       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750825114367       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750825636934       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+09 is 8.180186e-13

solving harmonic davidson linear method for identity shift 4.0000e+09, overlap shift 4.0000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750827008370       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750827008370       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750827008370       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750827008370       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750827008370       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750827008370       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750825626461       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750827008370       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750836118007       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750827008370       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750830110562       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750837853598       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750834058302       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750818755576       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750819705418       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750823813090       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750815656314       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750837117718       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750822193761       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750829679826       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750828372747       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750838865501       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750823680267       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750833727508       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750814065188       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750821083989       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750816228951       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750830465996       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750831262312       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750812033911       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750847678405       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750837175930       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750821657872       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750814195880       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750777930049       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750835419848       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750858875740       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750780744300       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750822986929       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750802884099       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750887525628       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750845281793       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750811061621       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750864905947       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750810740337       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750861239754       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750853942332       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750816376587       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750841467157       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750749110875       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.750529071160       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.750960688407       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.752015693809       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.751835561572       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.751062978396       residual = 1.03e-04           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.751011182394       residual = 7.20e-04           smallest_sin_value = 9.91e-01
davidson iteration   56 stopping due to small subspace S singular value of 7.70e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+09 is 2.066832e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.705500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0183e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7772
    reference variance = 0.476267
====================================================
  Execution time = 4.4669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5398e-01
  Total weights = 2.0000e+06
  Execution time = 3.4670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476436190
  error estimate for blocks of size 2^( 2) =       0.000501863419
  error estimate for blocks of size 2^( 3) =       0.000525645607
  error estimate for blocks of size 2^( 4) =       0.000543488484
  error estimate for blocks of size 2^( 5) =       0.000554957157
  error estimate for blocks of size 2^( 6) =       0.000559472455
  error estimate for blocks of size 2^( 7) =       0.000563019679

      target function =      -0.741913199884
              le_mean =     -22.814631044798
             les_mean =     520.961372369141
             stat err =       0.000555234444
             autocorr =       1.358136163422
   target nu stat err =       0.000555234444
   target dn stat err =       0.005110313871
      target stat err =       0.004302840972
              std dev =       0.673782521193
             le_variance =       0.453982885866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476436190
  error estimate for blocks of size 2^( 2) =       0.000501863419
  error estimate for blocks of size 2^( 3) =       0.000525645607
  error estimate for blocks of size 2^( 4) =       0.000543488484
  error estimate for blocks of size 2^( 5) =       0.000554957157
  error estimate for blocks of size 2^( 6) =       0.000559472455
  error estimate for blocks of size 2^( 7) =       0.000563019679

      target function =      -0.741913199883
              le_mean =     -22.814631044798
             les_mean =     520.961372369141
             stat err =       0.000555234444
             autocorr =       1.358136163414
   target nu stat err =       0.000555234444
   target dn stat err =       0.005110313871
      target stat err =       0.004302840972
              std dev =       0.673782521193
             le_variance =       0.453982885865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476436190
  error estimate for blocks of size 2^( 2) =       0.000501863419
  error estimate for blocks of size 2^( 3) =       0.000525645607
  error estimate for blocks of size 2^( 4) =       0.000543488484
  error estimate for blocks of size 2^( 5) =       0.000554957157
  error estimate for blocks of size 2^( 6) =       0.000559472455
  error estimate for blocks of size 2^( 7) =       0.000563019679

      target function =      -0.741913199883
              le_mean =     -22.814631044798
             les_mean =     520.961372369141
             stat err =       0.000555234444
             autocorr =       1.358136163424
   target nu stat err =       0.000555234444
   target dn stat err =       0.005110313871
      target stat err =       0.004302840972
              std dev =       0.673782521193
             le_variance =       0.453982885865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454082216693
                                         uncertainty =       0.005070832062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476436190
  error estimate for blocks of size 2^( 2) =       0.000501863419
  error estimate for blocks of size 2^( 3) =       0.000525645607
  error estimate for blocks of size 2^( 4) =       0.000543488484
  error estimate for blocks of size 2^( 5) =       0.000554957157
  error estimate for blocks of size 2^( 6) =       0.000559472455
  error estimate for blocks of size 2^( 7) =       0.000563019679

      target function =      -0.741913199884
              le_mean =     -22.814631044798
             les_mean =     520.961372369141
             stat err =       0.000555234444
             autocorr =       1.358136163420
   target nu stat err =       0.000555234444
   target dn stat err =       0.005110313871
      target stat err =       0.004302840972
              std dev =       0.673782521193
             le_variance =       0.453982885865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741913199884        initial  <--
     2.5000e+08     2.5000e+09             3.2681e-12        -0.741913199883
     1.0000e+09     1.0000e+10             8.1802e-13        -0.741913199883
     4.0000e+09     4.0000e+10             2.0668e-13        -0.741913199884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0120
  </log>
  <optVariables href="FORM2.s009.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2220e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8248
    reference variance = 0.341544
====================================================
  Execution time = 4.3549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5181e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4909e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451760716807
                                         uncertainty =       0.004184613266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451760716807
                                         uncertainty =       0.004184613266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475294733
  error estimate for blocks of size 2^( 2) =       0.000499858333
  error estimate for blocks of size 2^( 3) =       0.000523241102
  error estimate for blocks of size 2^( 4) =       0.000540821163
  error estimate for blocks of size 2^( 5) =       0.000551344925
  error estimate for blocks of size 2^( 6) =       0.000557651517
  error estimate for blocks of size 2^( 7) =       0.000561576616

      target function =      -0.743716139217
              le_mean =     -22.815427816434
             les_mean =     520.995556387822
             stat err =       0.000552848555
             autocorr =       1.352964353065
   target nu stat err =       0.000552848555
   target dn stat err =       0.004649800589
      target stat err =       0.003946791155
              std dev =       0.672168257829
             le_variance =       0.451810166833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281542781643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743735938919       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743735938919       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743735938919       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743735938919       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743736332630       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743735938919       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743735938919       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743735938919       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743732778934       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743740969039       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743733425727       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743730692511       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743728830755       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743728495033       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743738186882       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743733943562       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743746237645       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743730771903       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743735054429       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743729733010       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743732439733       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743737995354       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743732536994       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743734189684       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743735205491       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743734666409       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743737869189       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743729915758       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743744895479       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743722389999       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743730925214       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743738478832       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.327230e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743735938919       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743735938919       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743735938919       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743736395557       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743735938919       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743733177971       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743739088080       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743720635134       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743739602056       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743727089074       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743727925816       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743715962790       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743720813712       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743742970586       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743746038053       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743751364414       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743742055831       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743751093442       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743749366228       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743746118725       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743777769708       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743738133873       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743720554490       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743747147336       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743745463406       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743726424839       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743684830885       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743669065613       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743660262997       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743689385472       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743608265374       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743784308028       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743813815432       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743800779789       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743889257302       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743675978482       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743639188286       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743819379970       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743570920908       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743912344287       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743735505587       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743823407987       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743643260566       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743756603061       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743566746094       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744806291971       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744079553248       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744632694799       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743753395625       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749259897343       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.734271077118       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.737530619746       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747969845674       residual = 9.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.743563886500       residual = 2.80e-03           smallest_sin_value = 9.95e-01
davidson iteration   54 stopping due to small subspace S singular value of 8.74e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 8.401009e-14

solving harmonic davidson linear method for identity shift 4.0000e+10, overlap shift 4.0000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743735938919       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743735938919       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743735938919       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743735938919       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743735938919       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743735938919       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743683666887       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743735938919       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743822455017       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743730550281       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743675396959       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743679382371       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743791786374       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743649002688       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743862108674       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743801767216       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743766995496       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743718506126       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743752513492       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743774588305       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743626374293       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743753554831       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743612920081       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743841486006       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743788291144       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743794193134       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743758328709       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743653674405       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743464560215       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743764575324       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743793213204       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743874459744       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743517971502       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743709411721       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744025709534       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743557083675       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743660167983       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744260230259       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743968186648       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743343790818       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744365538804       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743958339131       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743770786688       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744145066423       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743897442229       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743281873927       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743816531973       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742719691684       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746482669915       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.734272515811       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.743186210263       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.750556799038       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.743072947540       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747656310808       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   54 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+10 is 2.098301e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.829564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8587e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7396
    reference variance = 0.561094
====================================================
  Execution time = 4.4477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4890e-01
  Total weights = 2.0000e+06
  Execution time = 3.4526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473762857
  error estimate for blocks of size 2^( 2) =       0.000499284889
  error estimate for blocks of size 2^( 3) =       0.000523536445
  error estimate for blocks of size 2^( 4) =       0.000541350575
  error estimate for blocks of size 2^( 5) =       0.000554119627
  error estimate for blocks of size 2^( 6) =       0.000560935942
  error estimate for blocks of size 2^( 7) =       0.000564512834

      target function =      -0.746189930869
              le_mean =     -22.814384410250
             les_mean =     520.945038284431
             stat err =       0.000555229745
             autocorr =       1.373483445890
   target nu stat err =       0.000555229745
   target dn stat err =       0.002998307120
      target stat err =       0.002602406674
              std dev =       0.670001858357
             le_variance =       0.448902490202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473762857
  error estimate for blocks of size 2^( 2) =       0.000499284889
  error estimate for blocks of size 2^( 3) =       0.000523536445
  error estimate for blocks of size 2^( 4) =       0.000541350575
  error estimate for blocks of size 2^( 5) =       0.000554119627
  error estimate for blocks of size 2^( 6) =       0.000560935942
  error estimate for blocks of size 2^( 7) =       0.000564512834

      target function =      -0.746189930869
              le_mean =     -22.814384410251
             les_mean =     520.945038284431
             stat err =       0.000555229745
             autocorr =       1.373483445884
   target nu stat err =       0.000555229745
   target dn stat err =       0.002998307120
      target stat err =       0.002602406674
              std dev =       0.670001858357
             le_variance =       0.448902490202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473762857
  error estimate for blocks of size 2^( 2) =       0.000499284889
  error estimate for blocks of size 2^( 3) =       0.000523536445
  error estimate for blocks of size 2^( 4) =       0.000541350575
  error estimate for blocks of size 2^( 5) =       0.000554119627
  error estimate for blocks of size 2^( 6) =       0.000560935942
  error estimate for blocks of size 2^( 7) =       0.000564512834

      target function =      -0.746189930869
              le_mean =     -22.814384410250
             les_mean =     520.945038284431
             stat err =       0.000555229745
             autocorr =       1.373483445892
   target nu stat err =       0.000555229745
   target dn stat err =       0.002998307120
      target stat err =       0.002602406674
              std dev =       0.670001858357
             le_variance =       0.448902490202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448875726387
                                         uncertainty =       0.003104919503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473762857
  error estimate for blocks of size 2^( 2) =       0.000499284889
  error estimate for blocks of size 2^( 3) =       0.000523536445
  error estimate for blocks of size 2^( 4) =       0.000541350575
  error estimate for blocks of size 2^( 5) =       0.000554119627
  error estimate for blocks of size 2^( 6) =       0.000560935942
  error estimate for blocks of size 2^( 7) =       0.000564512834

      target function =      -0.746189930869
              le_mean =     -22.814384410250
             les_mean =     520.945038284431
             stat err =       0.000555229745
             autocorr =       1.373483445892
   target nu stat err =       0.000555229745
   target dn stat err =       0.002998307120
      target stat err =       0.002602406674
              std dev =       0.670001858357
             le_variance =       0.448902490202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746189930869        initial
     2.5000e+09     2.5000e+10             3.3272e-13        -0.746189930869  <--
     1.0000e+10     1.0000e+11             8.4010e-14        -0.746189930869
     4.0000e+10     4.0000e+11             2.0983e-14        -0.746189930869

*****************************************************************************
Applying the update for shift_i =   2.5000e+09     and shift_s =   2.5000e+10
*****************************************************************************

  Execution time = 6.1792e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2039e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8538
    reference variance = 0.26583
====================================================
  Execution time = 4.5345e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5217e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4802e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452207954895
                                         uncertainty =       0.005142625293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452207954895
                                         uncertainty =       0.005142625293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475483457
  error estimate for blocks of size 2^( 2) =       0.000501204338
  error estimate for blocks of size 2^( 3) =       0.000524952363
  error estimate for blocks of size 2^( 4) =       0.000542930230
  error estimate for blocks of size 2^( 5) =       0.000554225978
  error estimate for blocks of size 2^( 6) =       0.000558805135
  error estimate for blocks of size 2^( 7) =       0.000564668122

      target function =      -0.743436179976
              le_mean =     -22.814027894657
             les_mean =     520.932037588215
             stat err =       0.000555157366
             autocorr =       1.363205689513
   target nu stat err =       0.000555157366
   target dn stat err =       0.005425938605
      target stat err =       0.004577579154
              std dev =       0.672435153851
             le_variance =       0.452169036134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281402789466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743463168683       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743463168683       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743463168683       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743462716338       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743463151290       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743463243423       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743463676645       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743463263929       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743463796674       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743462765028       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743464309246       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743462275933       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743463954534       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743461882961       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743463464566       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743462714988       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743461986153       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743462323975       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743462619087       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743464302879       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743462009901       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743463237080       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743464041446       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743461855316       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743462546937       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743463185890       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743464165929       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743461542949       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743464288643       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743462760311       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743463499645       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 1.202786e-12

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743463168683       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743463168683       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743463168683       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743463033548       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743463168683       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743461070112       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743463168683       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743466301591       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743465814052       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743458540426       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743465727085       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743460742964       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743464383015       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743466043856       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743462686416       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743463866457       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743466715363       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743465522091       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743458609294       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743457349320       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743464640430       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743464610070       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743457196165       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743456903994       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743471367714       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743464909563       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743458028142       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743465027186       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743462854352       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743464075605       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743478008594       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743451240498       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743461961559       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.020040e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743463168683       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743463168683       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743463168683       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743467147927       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743464701053       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743463272388       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743481021593       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743479664179       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743454005896       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743461031039       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743461890335       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743483430846       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743439124380       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743471017831       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743447322591       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743481623822       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743488410733       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743525047937       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743456046290       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743471416720       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743474053986       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743439974309       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743437660062       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743472925623       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743480536172       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743448172957       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743486046566       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743478344600       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743513372950       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743468209578       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743446365964       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743441452356       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743460302072       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743451941979       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743477282964       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743424253712       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743456275948       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743469792310       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743513954637       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743449031880       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743433059810       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743440454446       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743356658701       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743349269125       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743641131546       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743080687092       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743667950449       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743577042722       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743274792624       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743637438724       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741444863635       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.737583040586       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.740558506271       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.744228056828       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.741603955980       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 7.496379e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.911931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0236e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8405
    reference variance = 0.220599
====================================================
  Execution time = 4.3324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4444e-01
  Total weights = 2.0000e+06
  Execution time = 3.4958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471402902
  error estimate for blocks of size 2^( 2) =       0.000496670141
  error estimate for blocks of size 2^( 3) =       0.000520975185
  error estimate for blocks of size 2^( 4) =       0.000539520392
  error estimate for blocks of size 2^( 5) =       0.000549950260
  error estimate for blocks of size 2^( 6) =       0.000558671404
  error estimate for blocks of size 2^( 7) =       0.000559555857

      target function =      -0.749967078315
              le_mean =     -22.814391366195
             les_mean =     520.940894579038
             stat err =       0.000551924478
             autocorr =       1.370802250451
   target nu stat err =       0.000551924478
   target dn stat err =       0.002965970033
      target stat err =       0.002600467873
              std dev =       0.666664376845
             le_variance =       0.444441391354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471402902
  error estimate for blocks of size 2^( 2) =       0.000496670141
  error estimate for blocks of size 2^( 3) =       0.000520975185
  error estimate for blocks of size 2^( 4) =       0.000539520392
  error estimate for blocks of size 2^( 5) =       0.000549950260
  error estimate for blocks of size 2^( 6) =       0.000558671404
  error estimate for blocks of size 2^( 7) =       0.000559555857

      target function =      -0.749967078315
              le_mean =     -22.814391366195
             les_mean =     520.940894579038
             stat err =       0.000551924478
             autocorr =       1.370802250450
   target nu stat err =       0.000551924478
   target dn stat err =       0.002965970033
      target stat err =       0.002600467873
              std dev =       0.666664376845
             le_variance =       0.444441391354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471402902
  error estimate for blocks of size 2^( 2) =       0.000496670141
  error estimate for blocks of size 2^( 3) =       0.000520975185
  error estimate for blocks of size 2^( 4) =       0.000539520392
  error estimate for blocks of size 2^( 5) =       0.000549950260
  error estimate for blocks of size 2^( 6) =       0.000558671404
  error estimate for blocks of size 2^( 7) =       0.000559555857

      target function =      -0.749967078315
              le_mean =     -22.814391366195
             les_mean =     520.940894579038
             stat err =       0.000551924478
             autocorr =       1.370802250455
   target nu stat err =       0.000551924478
   target dn stat err =       0.002965970033
      target stat err =       0.002600467873
              std dev =       0.666664376845
             le_variance =       0.444441391354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444496986890
                                         uncertainty =       0.003050322957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471402902
  error estimate for blocks of size 2^( 2) =       0.000496670141
  error estimate for blocks of size 2^( 3) =       0.000520975185
  error estimate for blocks of size 2^( 4) =       0.000539520392
  error estimate for blocks of size 2^( 5) =       0.000549950260
  error estimate for blocks of size 2^( 6) =       0.000558671404
  error estimate for blocks of size 2^( 7) =       0.000559555857

      target function =      -0.749967078315
              le_mean =     -22.814391366195
             les_mean =     520.940894579038
             stat err =       0.000551924478
             autocorr =       1.370802250455
   target nu stat err =       0.000551924478
   target dn stat err =       0.002965970033
      target stat err =       0.002600467873
              std dev =       0.666664376845
             le_variance =       0.444441391354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749967078315        initial
     6.2500e+08     6.2500e+09             1.2028e-12        -0.749967078315  <--
     2.5000e+09     2.5000e+10             3.0200e-13        -0.749967078315
     1.0000e+10     1.0000e+11             7.4964e-14        -0.749967078315

*****************************************************************************
Applying the update for shift_i =   6.2500e+08     and shift_s =   6.2500e+09
*****************************************************************************

  Execution time = 6.0688e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2093e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.868
    reference variance = 0.31425
====================================================
  Execution time = 7.6323e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4297e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4938e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442936940092
                                         uncertainty =       0.002754003395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442936940092
                                         uncertainty =       0.002754003395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470620189
  error estimate for blocks of size 2^( 2) =       0.000495951479
  error estimate for blocks of size 2^( 3) =       0.000520225722
  error estimate for blocks of size 2^( 4) =       0.000538259426
  error estimate for blocks of size 2^( 5) =       0.000550985328
  error estimate for blocks of size 2^( 6) =       0.000558691650
  error estimate for blocks of size 2^( 7) =       0.000562260902

      target function =      -0.751222592209
              le_mean =     -22.814707416298
             les_mean =     520.953840994766
             stat err =       0.000552549326
             autocorr =       1.378481682373
   target nu stat err =       0.000552549326
   target dn stat err =       0.002773960613
      target stat err =       0.002451465855
              std dev =       0.665557454300
             le_variance =       0.442966724975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281470741630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751229539344       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751229539344       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751229539344       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751229539566       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751229575839       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751229544297       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751229917983       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751229426048       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751229436762       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751229618644       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751229412722       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751229580786       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751229075112       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751229652366       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751229561959       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751229455011       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751229676392       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751229521501       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751229829230       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751228978453       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751229337361       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751230043667       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751228731485       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751229953639       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751229352109       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751229194534       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751229572813       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751229254630       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751229614893       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751229647306       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751229614872       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751229666824       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+08 is 5.819784e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751229539344       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751229539344       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751229539344       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751229264812       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751229736649       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751229476285       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751229544251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751229310220       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751228238526       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751229649962       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751229710684       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751229440751       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751228757361       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751228510758       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751228640272       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751232905484       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751229355596       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751228872835       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751229599199       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751229644410       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751229153117       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751228344223       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751232056458       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751228797966       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751229670350       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751231220756       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751227914289       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751229027015       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751228835368       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751230575184       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751230505013       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751228328545       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 1.455005e-12

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751229539344       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751229539344       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751229539344       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751229539344       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751229253618       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751229348485       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751227002553       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751228951245       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751228734202       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751222802874       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751228739564       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751233885816       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751226372012       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751228650705       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751227091065       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751229144021       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751231782836       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751237567936       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751230490147       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751230488985       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751228032894       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751221135874       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751232749260       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751222729414       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751222189968       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751236169012       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751227998540       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751219867873       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751239110374       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751219814874       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751227095938       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751234490520       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.751253181547       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.751235503176       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.751227293682       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.629910e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.953478 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 9.1309e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7394
    reference variance = 0.429516
====================================================
  Execution time = 4.2917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4206e-01
  Total weights = 2.0000e+06
  Execution time = 3.4568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427633
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427633
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470137700
  error estimate for blocks of size 2^( 2) =       0.000495574664
  error estimate for blocks of size 2^( 3) =       0.000519086309
  error estimate for blocks of size 2^( 4) =       0.000537445745
  error estimate for blocks of size 2^( 5) =       0.000549873173
  error estimate for blocks of size 2^( 6) =       0.000556500822
  error estimate for blocks of size 2^( 7) =       0.000559534552

      target function =      -0.752002552134
              le_mean =     -22.814193332251
             les_mean =     520.929476094519
             stat err =       0.000550838573
             autocorr =       1.372772378126
   target nu stat err =       0.000550838573
   target dn stat err =       0.002742819753
      target stat err =       0.002428240139
              std dev =       0.664875111751
             le_variance =       0.442058914227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427634
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427634
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470137700
  error estimate for blocks of size 2^( 2) =       0.000495574664
  error estimate for blocks of size 2^( 3) =       0.000519086309
  error estimate for blocks of size 2^( 4) =       0.000537445745
  error estimate for blocks of size 2^( 5) =       0.000549873173
  error estimate for blocks of size 2^( 6) =       0.000556500822
  error estimate for blocks of size 2^( 7) =       0.000559534552

      target function =      -0.752002552134
              le_mean =     -22.814193332251
             les_mean =     520.929476094519
             stat err =       0.000550838573
             autocorr =       1.372772378127
   target nu stat err =       0.000550838573
   target dn stat err =       0.002742819753
      target stat err =       0.002428240139
              std dev =       0.664875111751
             le_variance =       0.442058914227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427633
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427633
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470137700
  error estimate for blocks of size 2^( 2) =       0.000495574664
  error estimate for blocks of size 2^( 3) =       0.000519086309
  error estimate for blocks of size 2^( 4) =       0.000537445745
  error estimate for blocks of size 2^( 5) =       0.000549873173
  error estimate for blocks of size 2^( 6) =       0.000556500822
  error estimate for blocks of size 2^( 7) =       0.000559534552

      target function =      -0.752002552134
              le_mean =     -22.814193332251
             les_mean =     520.929476094519
             stat err =       0.000550838573
             autocorr =       1.372772378119
   target nu stat err =       0.000550838573
   target dn stat err =       0.002742819753
      target stat err =       0.002428240139
              std dev =       0.664875111751
             le_variance =       0.442058914227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427633
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442137427633
                                         uncertainty =       0.002641981150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470137700
  error estimate for blocks of size 2^( 2) =       0.000495574664
  error estimate for blocks of size 2^( 3) =       0.000519086309
  error estimate for blocks of size 2^( 4) =       0.000537445745
  error estimate for blocks of size 2^( 5) =       0.000549873173
  error estimate for blocks of size 2^( 6) =       0.000556500822
  error estimate for blocks of size 2^( 7) =       0.000559534552

      target function =      -0.752002552134
              le_mean =     -22.814193332251
             les_mean =     520.929476094519
             stat err =       0.000550838573
             autocorr =       1.372772378127
   target nu stat err =       0.000550838573
   target dn stat err =       0.002742819753
      target stat err =       0.002428240139
              std dev =       0.664875111751
             le_variance =       0.442058914227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752002552134        initial  <--
     1.5625e+08     1.5625e+09             5.8198e-12        -0.752002552134
     6.2500e+08     6.2500e+09             1.4550e-12        -0.752002552134
     2.5000e+09     2.5000e+10             3.6299e-13        -0.752002552134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2910
  </log>
  <optVariables href="FORM2.s012.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.5266e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8255
    reference variance = 0.425371
====================================================
  Execution time = 4.6315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4668e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448098753840
                                         uncertainty =       0.003715889827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448098753840
                                         uncertainty =       0.003715889827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473359485
  error estimate for blocks of size 2^( 2) =       0.000498644912
  error estimate for blocks of size 2^( 3) =       0.000522293040
  error estimate for blocks of size 2^( 4) =       0.000540203924
  error estimate for blocks of size 2^( 5) =       0.000551252823
  error estimate for blocks of size 2^( 6) =       0.000557501949
  error estimate for blocks of size 2^( 7) =       0.000562614241

      target function =      -0.746841786690
              le_mean =     -22.813353635831
             les_mean =     520.897242294308
             stat err =       0.000552893234
             autocorr =       1.364270168067
   target nu stat err =       0.000552893234
   target dn stat err =       0.003945998206
      target stat err =       0.003382789047
              std dev =       0.669431404161
             le_variance =       0.448138404876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281335363583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746856186246       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746856186246       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746856186246       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746856186246       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746857080390       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746856186246       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746855008196       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746858256239       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746855306853       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746856186246       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746853800727       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746857351881       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746856548037       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746856115480       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746857534444       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746856646271       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746857577817       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746860858230       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746855390514       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746861438585       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746858265133       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746850950880       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746858271519       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746855106013       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746856427732       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746854563454       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746853673133       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746859829030       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746858026613       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746856483479       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746856240874       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746861179387       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746851646072       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746856242723       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+09 is 5.613591e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746856186246       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746856186246       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746856186246       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746852831846       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746856186246       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746857782652       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746866530542       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746858254206       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746857532923       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746846245985       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746867463124       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746850707953       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746857670034       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746855310004       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746864776416       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746862068473       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746841349010       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746834495484       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746872397767       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746847684677       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746863450834       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746826199420       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746850349347       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746854972533       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746853038204       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746831096402       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746858745847       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746823679365       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746856077589       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746838875844       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746870832094       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746891373686       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746857604542       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746841233476       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746829165905       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746829278012       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746828288375       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746897549645       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746865201205       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746819952371       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746843508414       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746879883975       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746833052730       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746829486082       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746713195483       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746607226055       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746764007887       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747136084741       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746773119760       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746817983343       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746288016402       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747186647689       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746476601740       residual = 8.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747473078676       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.746733307763       residual = 2.27e-04           smallest_sin_value = 9.98e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+09 is 1.383166e-13

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746856186246       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746856186246       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746856186246       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746856186246       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871395950       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746856186246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746856186246       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746856186246       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746776307388       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746842459733       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746817206613       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746821777528       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746860123410       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746841270735       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746867019607       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746874480121       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746849070256       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746808886541       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746818192229       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746885406874       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746822938453       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746863991899       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746894117836       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746958745260       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746874828381       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746832987758       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746849563509       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746830374766       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746952315536       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746503500596       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746982006086       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746830889686       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746944456307       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746854165195       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746767180598       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747004159809       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746939491531       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747059352267       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746880292894       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746678141055       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746984025048       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747384789992       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746390754722       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746771116080       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745840338616       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747824503778       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746175684809       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746578960682       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746414809811       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747183450832       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.757874387277       residual = 5.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.749730725769       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741542043817       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.755219823902       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.745436283156       residual = 3.81e-02           smallest_sin_value = 9.95e-01
davidson iteration   55 stopping due to small subspace S singular value of 8.23e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 3.310277e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.086072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1121e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8711
    reference variance = 0.382768
====================================================
  Execution time = 4.3300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4079e-01
  Total weights = 2.0000e+06
  Execution time = 3.4621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469464722
  error estimate for blocks of size 2^( 2) =       0.000495259681
  error estimate for blocks of size 2^( 3) =       0.000519930757
  error estimate for blocks of size 2^( 4) =       0.000537242876
  error estimate for blocks of size 2^( 5) =       0.000549315506
  error estimate for blocks of size 2^( 6) =       0.000555250499
  error estimate for blocks of size 2^( 7) =       0.000559457213

      target function =      -0.753086127040
              le_mean =     -22.814444063963
             les_mean =     520.939651976902
             stat err =       0.000550316523
             autocorr =       1.374102662476
   target nu stat err =       0.000550316523
   target dn stat err =       0.002434872574
      target stat err =       0.002181487314
              std dev =       0.663923376317
             le_variance =       0.440794249620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469464722
  error estimate for blocks of size 2^( 2) =       0.000495259681
  error estimate for blocks of size 2^( 3) =       0.000519930757
  error estimate for blocks of size 2^( 4) =       0.000537242876
  error estimate for blocks of size 2^( 5) =       0.000549315506
  error estimate for blocks of size 2^( 6) =       0.000555250499
  error estimate for blocks of size 2^( 7) =       0.000559457213

      target function =      -0.753086127040
              le_mean =     -22.814444063963
             les_mean =     520.939651976902
             stat err =       0.000550316523
             autocorr =       1.374102662480
   target nu stat err =       0.000550316523
   target dn stat err =       0.002434872574
      target stat err =       0.002181487314
              std dev =       0.663923376317
             le_variance =       0.440794249620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469464722
  error estimate for blocks of size 2^( 2) =       0.000495259681
  error estimate for blocks of size 2^( 3) =       0.000519930757
  error estimate for blocks of size 2^( 4) =       0.000537242876
  error estimate for blocks of size 2^( 5) =       0.000549315506
  error estimate for blocks of size 2^( 6) =       0.000555250499
  error estimate for blocks of size 2^( 7) =       0.000559457213

      target function =      -0.753086127040
              le_mean =     -22.814444063963
             les_mean =     520.939651976902
             stat err =       0.000550316523
             autocorr =       1.374102662473
   target nu stat err =       0.000550316523
   target dn stat err =       0.002434872574
      target stat err =       0.002181487314
              std dev =       0.663923376317
             le_variance =       0.440794249620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440798663132
                                         uncertainty =       0.002492946526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469464722
  error estimate for blocks of size 2^( 2) =       0.000495259681
  error estimate for blocks of size 2^( 3) =       0.000519930757
  error estimate for blocks of size 2^( 4) =       0.000537242876
  error estimate for blocks of size 2^( 5) =       0.000549315506
  error estimate for blocks of size 2^( 6) =       0.000555250499
  error estimate for blocks of size 2^( 7) =       0.000559457213

      target function =      -0.753086127040
              le_mean =     -22.814444063963
             les_mean =     520.939651976902
             stat err =       0.000550316523
             autocorr =       1.374102662471
   target nu stat err =       0.000550316523
   target dn stat err =       0.002434872574
      target stat err =       0.002181487314
              std dev =       0.663923376317
             le_variance =       0.440794249620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.753086127040        initial  <--
     1.5625e+09     1.5625e+10             5.6136e-13        -0.753086127040
     6.2500e+09     6.2500e+10             1.3832e-13        -0.753086127040
     2.5000e+10     2.5000e+11             3.3103e-14        -0.753086127040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7339
  </log>
  <optVariables href="FORM2.s013.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2186e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8483
    reference variance = 0.347143
====================================================
  Execution time = 4.4093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5437e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4794e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454385209331
                                         uncertainty =       0.005030818358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454385209331
                                         uncertainty =       0.005030818358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476637693
  error estimate for blocks of size 2^( 2) =       0.000501835784
  error estimate for blocks of size 2^( 3) =       0.000526099024
  error estimate for blocks of size 2^( 4) =       0.000544188869
  error estimate for blocks of size 2^( 5) =       0.000556048901
  error estimate for blocks of size 2^( 6) =       0.000563818543
  error estimate for blocks of size 2^( 7) =       0.000566112161

      target function =      -0.741599165706
              le_mean =     -22.814381381384
             les_mean =     520.950364568646
             stat err =       0.000557542118
             autocorr =       1.368291390804
   target nu stat err =       0.000557542118
   target dn stat err =       0.005135539711
      target stat err =       0.004318755661
              std dev =       0.674067489631
             le_variance =       0.454366980578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281438138138e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741622983565       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741622983565       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741622983565       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741622983565       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741622983565       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741622983565       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741622983565       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741622983565       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741641691348       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741613992750       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741632767704       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741593400173       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741624759870       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741592371712       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741606955628       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741558069612       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741593357055       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741624006741       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741613682959       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741627757749       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741674932517       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741614200609       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741624253729       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741638777245       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741589525826       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741637134055       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741649395997       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741603418056       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741578729462       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741598671762       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741606975673       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741617281877       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741645320141       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741673839959       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741571563641       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741253918015       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741600374955       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741459700936       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741559233211       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741672872305       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741428995808       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741691666742       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741600992162       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742060189449       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741829603807       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741467351309       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741699491759       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741153257194       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.741502641168       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742810323530       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741511751836       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742089655308       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.738089919099       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742849675810       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.749526879920       residual = 2.95e-02           smallest_sin_value = 9.95e-01
davidson iteration   55 stopping due to small subspace S singular value of 7.08e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+10 is 5.166286e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741622983565       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741622983565       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741622983565       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741622983565       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741660803551       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741622983565       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741735993755       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741598202906       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741622983565       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741748664248       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741580680374       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741622983565       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741660875027       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741632968759       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741518139531       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741697104182       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741750974155       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741711774314       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741692137277       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741428102489       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741607760030       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741647322442       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741678587459       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741511330921       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741661084908       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741665266778       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741348458427       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741584343357       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741652057032       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741628682723       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741587409751       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741706469155       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741731237095       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741417821299       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741886047634       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741540962645       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741055979794       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743091324092       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.740416012987       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740593500724       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742660746072       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741849290394       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741877626166       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741725915368       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741669532697       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741978877446       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742745883478       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743643701571       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.731891097290       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742320821726       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.753276924774       residual = 6.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.726085801868       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.752409834057       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.774599841515       residual = 5.17e-01           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.726697047195       residual = 1.34e-01           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 7.87e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+10 is 1.281887e-14

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741622983565       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741622983565       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741622983565       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741622983565       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741622983565       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741807300893       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741622983565       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741718640324       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741900122090       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741551332756       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740868130375       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741276438586       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742346731074       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741603692398       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741967146322       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740938903642       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741487084084       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741162061907       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740863615750       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742067429795       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741762695187       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741262964466       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741560314177       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741755717203       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742240299917       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740910122948       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740866158972       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742341181817       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737821934483       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740115140651       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740973538597       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743043478462       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741096008305       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742566614405       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.739841182869       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.736271611238       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.740030235025       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742514843477       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742984315313       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750810014684       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.740933849139       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742465275348       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.738882574928       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.738343985206       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746716506249       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748034762026       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.737173321675       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744353491420       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.737888029581       residual = 7.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.709678486313       residual = 4.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.730882518319       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.792858287455       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.893721601168       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.802721340745       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.575930567822       residual = 1.62e+01           smallest_sin_value = 9.91e-01
davidson iteration   55 stopping due to small subspace S singular value of 6.64e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+11 is 2.336091e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.264657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2493e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8657
    reference variance = 0.584115
====================================================
  Execution time = 4.7595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5030e-01
  Total weights = 2.0000e+06
  Execution time = 3.4622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474500506
  error estimate for blocks of size 2^( 2) =       0.000500328766
  error estimate for blocks of size 2^( 3) =       0.000523914930
  error estimate for blocks of size 2^( 4) =       0.000540906235
  error estimate for blocks of size 2^( 5) =       0.000552282850
  error estimate for blocks of size 2^( 6) =       0.000558034790
  error estimate for blocks of size 2^( 7) =       0.000560385242

      target function =      -0.745005237207
              le_mean =     -22.814399336786
             les_mean =     520.947118333838
             stat err =       0.000552902279
             autocorr =       1.357761220908
   target nu stat err =       0.000552902279
   target dn stat err =       0.004144531345
      target stat err =       0.003535771650
              std dev =       0.671045051145
             le_variance =       0.450301460667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474500506
  error estimate for blocks of size 2^( 2) =       0.000500328766
  error estimate for blocks of size 2^( 3) =       0.000523914930
  error estimate for blocks of size 2^( 4) =       0.000540906235
  error estimate for blocks of size 2^( 5) =       0.000552282850
  error estimate for blocks of size 2^( 6) =       0.000558034790
  error estimate for blocks of size 2^( 7) =       0.000560385242

      target function =      -0.745005237207
              le_mean =     -22.814399336786
             les_mean =     520.947118333838
             stat err =       0.000552902279
             autocorr =       1.357761220911
   target nu stat err =       0.000552902279
   target dn stat err =       0.004144531345
      target stat err =       0.003535771650
              std dev =       0.671045051145
             le_variance =       0.450301460667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474500506
  error estimate for blocks of size 2^( 2) =       0.000500328766
  error estimate for blocks of size 2^( 3) =       0.000523914930
  error estimate for blocks of size 2^( 4) =       0.000540906235
  error estimate for blocks of size 2^( 5) =       0.000552282850
  error estimate for blocks of size 2^( 6) =       0.000558034790
  error estimate for blocks of size 2^( 7) =       0.000560385242

      target function =      -0.745005237207
              le_mean =     -22.814399336786
             les_mean =     520.947118333838
             stat err =       0.000552902279
             autocorr =       1.357761220908
   target nu stat err =       0.000552902279
   target dn stat err =       0.004144531345
      target stat err =       0.003535771650
              std dev =       0.671045051145
             le_variance =       0.450301460667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450276464302
                                         uncertainty =       0.004139132050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474500506
  error estimate for blocks of size 2^( 2) =       0.000500328766
  error estimate for blocks of size 2^( 3) =       0.000523914930
  error estimate for blocks of size 2^( 4) =       0.000540906235
  error estimate for blocks of size 2^( 5) =       0.000552282850
  error estimate for blocks of size 2^( 6) =       0.000558034790
  error estimate for blocks of size 2^( 7) =       0.000560385242

      target function =      -0.745005237207
              le_mean =     -22.814399336786
             les_mean =     520.947118333838
             stat err =       0.000552902279
             autocorr =       1.357761220907
   target nu stat err =       0.000552902279
   target dn stat err =       0.004144531345
      target stat err =       0.003535771650
              std dev =       0.671045051145
             le_variance =       0.450301460667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745005237207        initial  <--
     1.5625e+10     1.5625e+11             5.1663e-14        -0.745005237207
     6.2500e+10     6.2500e+11             1.2819e-14        -0.745005237207
     2.5000e+11     2.5000e+12             2.3361e-15        -0.745005237207

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.9343
  </log>
  <optVariables href="FORM2.s014.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2841e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8231
    reference variance = 0.314324
====================================================
  Execution time = 5.5752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4621e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452380462607
                                         uncertainty =       0.005101559153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452380462607
                                         uncertainty =       0.005101559153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475592661
  error estimate for blocks of size 2^( 2) =       0.000500259047
  error estimate for blocks of size 2^( 3) =       0.000523741734
  error estimate for blocks of size 2^( 4) =       0.000540908462
  error estimate for blocks of size 2^( 5) =       0.000551519143
  error estimate for blocks of size 2^( 6) =       0.000559447895
  error estimate for blocks of size 2^( 7) =       0.000565652915

      target function =      -0.743234826893
              le_mean =     -22.815635666891
             les_mean =     521.005607417276
             stat err =       0.000554382104
             autocorr =       1.358776775119
   target nu stat err =       0.000554382104
   target dn stat err =       0.004900960130
      target stat err =       0.004151061426
              std dev =       0.672589591908
             le_variance =       0.452376759143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281563566689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743256845073       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743256845073       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743256845073       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743252401172       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743122566299       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743256845073       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743256845073       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742902570089       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743078474769       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743110160866       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743278601353       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743396246484       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742700159779       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743141084008       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742213684417       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743368114396       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743196209549       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743327484880       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743384351672       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743004202456       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743294480313       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743814972853       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744181256358       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744293730035       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742956838627       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743169960990       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742593809360       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743720316211       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742713622512       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742818285497       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743047927561       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743895309676       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743522411385       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744199287138       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741842138582       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742716290385       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743691351552       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743845389250       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744841314661       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742514022124       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741835646510       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743157934014       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743521882159       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742723105364       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746379450809       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741982999039       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744629218507       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744221280822       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.739316902920       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.731193595246       residual = 6.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746680268219       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.754004555519       residual = 5.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.785475076510       residual = 8.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.799055468823       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.731229607164       residual = 2.89e-01           smallest_sin_value = 9.96e-01
davidson iteration   55 stopping due to small subspace S singular value of 8.17e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+11 is 4.109461e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743256845073       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743256845073       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743256845073       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743256845073       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743256845073       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743297739015       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743256845073       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741554055778       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745000386833       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743025184185       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741303015326       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741570673682       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742842601265       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743113798513       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742657278092       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743809380955       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743778390120       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737643495831       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744014748634       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741495736773       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741408029364       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743900153330       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744309883012       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.737048927786       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738034511249       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740907198697       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743343755144       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746506689691       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743561032885       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744708106145       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742941126092       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.739918037002       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748659148005       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.738974077348       residual = 9.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750730829402       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.733138008565       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743569687639       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.751904475856       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.738931569213       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741791279762       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746139721785       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.722125925912       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745662708792       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.756674891681       residual = 8.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746107692237       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745234827297       residual = 4.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.727888571285       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.691520104758       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.762028386325       residual = 4.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.740646318231       residual = 5.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.988980020763       residual = 4.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.656384745607       residual = 3.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.862253617627       residual = 9.06e+00           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 2.578640e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743256845073       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743256845073       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743256845073       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743257081927       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743094941587       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743389189698       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742326930131       residual = 8.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740124521993       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741321410722       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735027177892       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743884013638       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747035620100       residual = 9.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746839846851       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747284853460       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741075921434       residual = 8.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741624910213       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746856111296       residual = 8.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751175217199       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.732563920526       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739493857220       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742331510070       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749157227555       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750866254230       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744310174775       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737142947565       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736311892854       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.731119284396       residual = 6.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744063143396       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743514975536       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.768485147309       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748103686655       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736422552727       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.754268096345       residual = 9.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742108676849       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742767502986       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.732928447826       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.738900685386       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.714731422724       residual = 3.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.756866429063       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.738427543082       residual = 6.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.692336660823       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.802884964610       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.753302891463       residual = 8.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.766236716181       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.714717863026       residual = 5.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.776500798783       residual = 5.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.651000634622       residual = 4.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.706738379227       residual = 6.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.724584560588       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.802885650735       residual = 3.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.651401181921       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.702124314454       residual = 3.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.191800627382       residual = 2.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.888537955709       residual = 6.95e+02           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.55e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 5.566692e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.435989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 7.0549e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6641
    reference variance = 1.15401
====================================================
  Execution time = 4.4835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4929e-01
  Total weights = 2.0000e+06
  Execution time = 3.4598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473965268
  error estimate for blocks of size 2^( 2) =       0.000499206829
  error estimate for blocks of size 2^( 3) =       0.000522848047
  error estimate for blocks of size 2^( 4) =       0.000540666038
  error estimate for blocks of size 2^( 5) =       0.000553381779
  error estimate for blocks of size 2^( 6) =       0.000559054980
  error estimate for blocks of size 2^( 7) =       0.000562600493

      target function =      -0.745869739518
              le_mean =     -22.814333521478
             les_mean =     520.943099954993
             stat err =       0.000553925822
             autocorr =       1.365872579528
   target nu stat err =       0.000553925822
   target dn stat err =       0.002601118206
      target stat err =       0.002276621182
              std dev =       0.670288110002
             le_variance =       0.449286150410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473965268
  error estimate for blocks of size 2^( 2) =       0.000499206829
  error estimate for blocks of size 2^( 3) =       0.000522848047
  error estimate for blocks of size 2^( 4) =       0.000540666038
  error estimate for blocks of size 2^( 5) =       0.000553381779
  error estimate for blocks of size 2^( 6) =       0.000559054980
  error estimate for blocks of size 2^( 7) =       0.000562600493

      target function =      -0.745869739518
              le_mean =     -22.814333521478
             les_mean =     520.943099954993
             stat err =       0.000553925822
             autocorr =       1.365872579528
   target nu stat err =       0.000553925822
   target dn stat err =       0.002601118206
      target stat err =       0.002276621182
              std dev =       0.670288110002
             le_variance =       0.449286150410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473965268
  error estimate for blocks of size 2^( 2) =       0.000499206829
  error estimate for blocks of size 2^( 3) =       0.000522848047
  error estimate for blocks of size 2^( 4) =       0.000540666038
  error estimate for blocks of size 2^( 5) =       0.000553381779
  error estimate for blocks of size 2^( 6) =       0.000559054980
  error estimate for blocks of size 2^( 7) =       0.000562600493

      target function =      -0.745869739518
              le_mean =     -22.814333521478
             les_mean =     520.943099954993
             stat err =       0.000553925822
             autocorr =       1.365872579528
   target nu stat err =       0.000553925822
   target dn stat err =       0.002601118206
      target stat err =       0.002276621182
              std dev =       0.670288110002
             le_variance =       0.449286150410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448696702648
                                         uncertainty =       0.002510221256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473965268
  error estimate for blocks of size 2^( 2) =       0.000499206829
  error estimate for blocks of size 2^( 3) =       0.000522848047
  error estimate for blocks of size 2^( 4) =       0.000540666038
  error estimate for blocks of size 2^( 5) =       0.000553381779
  error estimate for blocks of size 2^( 6) =       0.000559054980
  error estimate for blocks of size 2^( 7) =       0.000562600493

      target function =      -0.745869739518
              le_mean =     -22.814333521478
             les_mean =     520.943099954993
             stat err =       0.000553925822
             autocorr =       1.365872579530
   target nu stat err =       0.000553925822
   target dn stat err =       0.002601118206
      target stat err =       0.002276621182
              std dev =       0.670288110002
             le_variance =       0.449286150410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745869739518        initial
     1.5625e+11     1.5625e+12             4.1095e-15        -0.745869739518
     6.2500e+11     6.2500e+12             2.5786e-16        -0.745869739518
     2.5000e+12     2.5000e+13             5.5667e-17        -0.745869739518  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+12     and shift_s =   2.5000e+13
*****************************************************************************

  Execution time = 6.2138e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3270e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8313
    reference variance = 0.528949
====================================================
  Execution time = 4.3612e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5091e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4819e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450988321316
                                         uncertainty =       0.005638190247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450988321316
                                         uncertainty =       0.005638190247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474820511
  error estimate for blocks of size 2^( 2) =       0.000500043624
  error estimate for blocks of size 2^( 3) =       0.000523900888
  error estimate for blocks of size 2^( 4) =       0.000540531171
  error estimate for blocks of size 2^( 5) =       0.000551352155
  error estimate for blocks of size 2^( 6) =       0.000556941947
  error estimate for blocks of size 2^( 7) =       0.000559662906

      target function =      -0.744471119334
              le_mean =     -22.814844079140
             les_mean =     520.968019166139
             stat err =       0.000552122045
             autocorr =       1.352107533858
   target nu stat err =       0.000552122045
   target dn stat err =       0.005846162639
      target stat err =       0.004945061574
              std dev =       0.671497606927
             le_variance =       0.450909036108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281484407914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744503172346       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744503172346       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744503172346       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744503172346       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744481173496       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744503172346       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746045757209       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744552764647       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743278486631       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745768092780       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745169438007       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744151595531       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744259209686       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745004809245       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745646785855       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743364368042       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741007404552       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745483989887       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744636384467       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745744117512       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746237299683       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745620435847       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742122382193       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741156490185       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744263707941       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738974186259       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746152535869       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752364204540       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743780603816       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742269947625       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743163378723       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750651262328       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740055581037       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.739417240638       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.758793187162       residual = 9.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.756774281455       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741989971263       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742731867273       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744355223549       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740598028187       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745743127342       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747092914538       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.734448216251       residual = 4.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748382196387       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750389875331       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.751824332642       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.684337305031       residual = 1.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.759113010676       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.709495656143       residual = 6.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.634415220945       residual = 5.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.046386133784       residual = 6.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.724529091779       residual = 3.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.917520809128       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.930838450148       residual = 1.69e+01           smallest_sin_value = 9.98e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 2.864248e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744503172346       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744503172346       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744503172346       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744503172346       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743254336836       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744698942681       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744990170911       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746397525093       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747307837844       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740495937467       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740684117869       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744382892737       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744527062166       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744810810806       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742478774312       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737927399553       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743279145717       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.753204708958       residual = 4.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740830637876       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746371636084       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750218516625       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739068643423       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739490729394       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747758970721       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734789715472       residual = 4.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737483515051       residual = 4.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739834815800       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.737599290781       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.732087613508       residual = 7.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740697733276       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742769577106       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.727213422329       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.725936929523       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.736075756792       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.733415133935       residual = 7.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.754485928130       residual = 8.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747091914515       residual = 7.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.707191864120       residual = 6.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.739305731161       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.718780206019       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.733296874750       residual = 9.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.782867846103       residual = 6.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.805700660661       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.778295403147       residual = 5.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.705533524434       residual = 8.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.666540229317       residual = 3.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749468218595       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.890227809239       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.507498263587       residual = 2.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.795897120534       residual = 4.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.953992656896       residual = 4.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -2.389800821410       residual = 1.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941500402185       residual = 1.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =       3.995470702629       residual = 1.11e+04           smallest_sin_value = 1.00e+00
davidson iteration   54 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 8.618588e-17

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744503172346       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744503172346       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.552373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8553e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.805
    reference variance = 0.462342
====================================================
  Execution time = 4.6186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5700e-01
  Total weights = 2.0000e+06
  Execution time = 3.4636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478016654
  error estimate for blocks of size 2^( 2) =       0.000503531807
  error estimate for blocks of size 2^( 3) =       0.000526997294
  error estimate for blocks of size 2^( 4) =       0.000544596624
  error estimate for blocks of size 2^( 5) =       0.000557299473
  error estimate for blocks of size 2^( 6) =       0.000563560132
  error estimate for blocks of size 2^( 7) =       0.000567688137

      target function =      -0.739341932226
              le_mean =     -22.813614948845
             les_mean =     520.918026649530
             stat err =       0.000558286092
             autocorr =       1.364041429961
   target nu stat err =       0.000558286092
   target dn stat err =       0.011259683219
      target stat err =       0.009323336764
              std dev =       0.676017635779
             le_variance =       0.456999843884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478016654
  error estimate for blocks of size 2^( 2) =       0.000503531807
  error estimate for blocks of size 2^( 3) =       0.000526997294
  error estimate for blocks of size 2^( 4) =       0.000544596624
  error estimate for blocks of size 2^( 5) =       0.000557299473
  error estimate for blocks of size 2^( 6) =       0.000563560132
  error estimate for blocks of size 2^( 7) =       0.000567688137

      target function =      -0.739341932226
              le_mean =     -22.813614948845
             les_mean =     520.918026649530
             stat err =       0.000558286092
             autocorr =       1.364041429961
   target nu stat err =       0.000558286092
   target dn stat err =       0.011259683219
      target stat err =       0.009323336764
              std dev =       0.676017635779
             le_variance =       0.456999843884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478016654
  error estimate for blocks of size 2^( 2) =       0.000503531807
  error estimate for blocks of size 2^( 3) =       0.000526997294
  error estimate for blocks of size 2^( 4) =       0.000544596624
  error estimate for blocks of size 2^( 5) =       0.000557299473
  error estimate for blocks of size 2^( 6) =       0.000563560132
  error estimate for blocks of size 2^( 7) =       0.000567688137

      target function =      -0.739341932226
              le_mean =     -22.813614948845
             les_mean =     520.918026649530
             stat err =       0.000558286092
             autocorr =       1.364041429961
   target nu stat err =       0.000558286092
   target dn stat err =       0.011259683219
      target stat err =       0.009323336764
              std dev =       0.676017635779
             le_variance =       0.456999843884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456964574191
                                         uncertainty =       0.010858730436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478016654
  error estimate for blocks of size 2^( 2) =       0.000503531807
  error estimate for blocks of size 2^( 3) =       0.000526997294
  error estimate for blocks of size 2^( 4) =       0.000544596624
  error estimate for blocks of size 2^( 5) =       0.000557299473
  error estimate for blocks of size 2^( 6) =       0.000563560132
  error estimate for blocks of size 2^( 7) =       0.000567688137

      target function =      -0.739341932226
              le_mean =     -22.813614948845
             les_mean =     520.918026649530
             stat err =       0.000558286092
             autocorr =       1.364041429961
   target nu stat err =       0.000558286092
   target dn stat err =       0.011259683219
      target stat err =       0.009323336764
              std dev =       0.676017635779
             le_variance =       0.456999843884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739341932226        initial  <--
     6.2500e+11     6.2500e+12             2.8642e-16        -0.739341932226
     2.5000e+12     2.5000e+13             8.6186e-17        -0.739341932226
     1.0000e+13     1.0000e+14             0.0000e+00        -0.739341932226

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5215
  </log>
  <optVariables href="FORM2.s016.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.75
    reference variance = 0.347954
====================================================
  Execution time = 6.4522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4878e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453463253661
                                         uncertainty =       0.006443125090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453463253661
                                         uncertainty =       0.006443125090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476120807
  error estimate for blocks of size 2^( 2) =       0.000501228685
  error estimate for blocks of size 2^( 3) =       0.000525214941
  error estimate for blocks of size 2^( 4) =       0.000544389540
  error estimate for blocks of size 2^( 5) =       0.000556779445
  error estimate for blocks of size 2^( 6) =       0.000564195585
  error estimate for blocks of size 2^( 7) =       0.000570051833

      target function =      -0.742416404827
              le_mean =     -22.814065869319
             les_mean =     520.934983308352
             stat err =       0.000558854101
             autocorr =       1.377725072446
   target nu stat err =       0.000558854101
   target dn stat err =       0.006051376471
      target stat err =       0.005082900057
              std dev =       0.673336502358
             le_variance =       0.453382045407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281406586932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742449947738       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742449947738       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.06e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742449947738       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742449947738       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742449947738       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742449947738       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.553448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 7.9407e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8486
    reference variance = 0.42854
====================================================
  Execution time = 4.3062e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4765e-01
  Total weights = 2.0000e+06
  Execution time = 3.9520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473103945
  error estimate for blocks of size 2^( 2) =       0.000498670377
  error estimate for blocks of size 2^( 3) =       0.000522585705
  error estimate for blocks of size 2^( 4) =       0.000539943262
  error estimate for blocks of size 2^( 5) =       0.000551262703
  error estimate for blocks of size 2^( 6) =       0.000558088754
  error estimate for blocks of size 2^( 7) =       0.000562126153

      target function =      -0.747234580744
              le_mean =     -22.814996888686
             les_mean =     520.971737492549
             stat err =       0.000552855218
             autocorr =       1.365556541688
   target nu stat err =       0.000552855218
   target dn stat err =       0.002863932306
      target stat err =       0.002501096115
              std dev =       0.669070015488
             le_variance =       0.447654685625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473103945
  error estimate for blocks of size 2^( 2) =       0.000498670377
  error estimate for blocks of size 2^( 3) =       0.000522585705
  error estimate for blocks of size 2^( 4) =       0.000539943262
  error estimate for blocks of size 2^( 5) =       0.000551262703
  error estimate for blocks of size 2^( 6) =       0.000558088754
  error estimate for blocks of size 2^( 7) =       0.000562126153

      target function =      -0.747234580744
              le_mean =     -22.814996888686
             les_mean =     520.971737492549
             stat err =       0.000552855218
             autocorr =       1.365556541688
   target nu stat err =       0.000552855218
   target dn stat err =       0.002863932306
      target stat err =       0.002501096115
              std dev =       0.669070015488
             le_variance =       0.447654685625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473103945
  error estimate for blocks of size 2^( 2) =       0.000498670377
  error estimate for blocks of size 2^( 3) =       0.000522585705
  error estimate for blocks of size 2^( 4) =       0.000539943262
  error estimate for blocks of size 2^( 5) =       0.000551262703
  error estimate for blocks of size 2^( 6) =       0.000558088754
  error estimate for blocks of size 2^( 7) =       0.000562126153

      target function =      -0.747234580744
              le_mean =     -22.814996888686
             les_mean =     520.971737492549
             stat err =       0.000552855218
             autocorr =       1.365556541688
   target nu stat err =       0.000552855218
   target dn stat err =       0.002863932306
      target stat err =       0.002501096115
              std dev =       0.669070015488
             le_variance =       0.447654685625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447617168050
                                         uncertainty =       0.002806041913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473103945
  error estimate for blocks of size 2^( 2) =       0.000498670377
  error estimate for blocks of size 2^( 3) =       0.000522585705
  error estimate for blocks of size 2^( 4) =       0.000539943262
  error estimate for blocks of size 2^( 5) =       0.000551262703
  error estimate for blocks of size 2^( 6) =       0.000558088754
  error estimate for blocks of size 2^( 7) =       0.000562126153

      target function =      -0.747234580744
              le_mean =     -22.814996888686
             les_mean =     520.971737492549
             stat err =       0.000552855218
             autocorr =       1.365556541688
   target nu stat err =       0.000552855218
   target dn stat err =       0.002863932306
      target stat err =       0.002501096115
              std dev =       0.669070015488
             le_variance =       0.447654685625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747234580744        initial  <--
     6.2500e+12     6.2500e+13             0.0000e+00        -0.747234580744
     2.5000e+13     2.5000e+14             0.0000e+00        -0.747234580744
     1.0000e+14     1.0000e+15             0.0000e+00        -0.747234580744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3617
  </log>
  <optVariables href="FORM2.s017.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4385e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.766
    reference variance = 0.372512
====================================================
  Execution time = 4.3810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5049e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4776e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450541358270
                                         uncertainty =       0.004239017853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450541358270
                                         uncertainty =       0.004239017853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474598330
  error estimate for blocks of size 2^( 2) =       0.000500021224
  error estimate for blocks of size 2^( 3) =       0.000524284866
  error estimate for blocks of size 2^( 4) =       0.000542940373
  error estimate for blocks of size 2^( 5) =       0.000553442810
  error estimate for blocks of size 2^( 6) =       0.000561373323
  error estimate for blocks of size 2^( 7) =       0.000565428866

      target function =      -0.744841005353
              le_mean =     -22.814767777829
             les_mean =     520.964115681207
             stat err =       0.000555796343
             autocorr =       1.371446774221
   target nu stat err =       0.000555796343
   target dn stat err =       0.004369631320
      target stat err =       0.003723005481
              std dev =       0.671183395331
             le_variance =       0.450487150168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476777783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744858751214       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744858751214       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744858751214       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744858751581       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744858748122       residual = 8.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744858751214       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.718802230561       residual = 6.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.758238785845       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.699528662636       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.674393849564       residual = 2.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.608685730021       residual = 8.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.622380802158       residual = 7.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.768721102607       residual = 5.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.783048431310       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.844828464239       residual = 4.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745544285152       residual = 5.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878722740194       residual = 7.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.611237950073       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896610119160       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.562409386750       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.184898174718       residual = 8.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.826551130605       residual = 3.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943643056092       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.867191562527       residual = 7.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.508749132530       residual = 2.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.789934871000       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918807228284       residual = 1.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.423219230337       residual = 5.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.048760392901       residual = 2.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.491939375045       residual = 2.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.965117983713       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.162811917173       residual = 1.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.817264413134       residual = 6.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.202932239960       residual = 9.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922909552449       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.204964875829       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.314141960083       residual = 1.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.366473237924       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.178752033659       residual = 1.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.730494961730       residual = 5.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.167514774753       residual = 3.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.799548438022       residual = 7.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.472048006609       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.218605548843       residual = 4.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.484365363560       residual = 5.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.744686505519       residual = 3.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -7.286195110809       residual = 1.99e+04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       1.696776650177       residual = 3.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =     -10.017743344651       residual = 4.98e+04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -9.809146617866       residual = 4.42e+04           smallest_sin_value = 1.00e+00
davidson iteration   50 stopping due to too large eigenvalue change
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+13 is 2.842933e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744858751214       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744858751214       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744858751214       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744858751238       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744858766428       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744807608863       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.071039495738       residual = 7.84e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.682530538387       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.531112511920       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.589374939767       residual = 8.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.787412407594       residual = 5.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.472492134395       residual = 8.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.955865464752       residual = 7.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.772377710819       residual = 3.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.723238568906       residual = 8.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.892557830899       residual = 4.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.525769480615       residual = 4.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752749028447       residual = 8.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947319415120       residual = 5.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.607983163765       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.054319730658       residual = 5.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.312711737659       residual = 1.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.831163808432       residual = 5.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.658298265317       residual = 1.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.945244193299       residual = 7.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.075379758061       residual = 4.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       1.321624825058       residual = 2.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.838053123199       residual = 8.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -6.061141715050       residual = 1.32e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       1.311904979633       residual = 2.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.472328947312       residual = 2.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.357196781755       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.556562771662       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.749026237682       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.734325547308       residual = 1.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.914672620385       residual = 1.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       1.452341507797       residual = 2.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.030179530366       residual = 6.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -2.587667570015       residual = 2.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -2.377405276746       residual = 1.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.266005609610       residual = 3.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -4.792248507753       residual = 1.05e+04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -2.641616775031       residual = 1.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.278550375934       residual = 3.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.817890101464       residual = 2.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -2.257981893661       residual = 3.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       2.193809462697       residual = 1.55e+04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.716446011776       residual = 2.34e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =       1.497940002537       residual = 1.05e+04           smallest_sin_value = 1.00e+00
davidson iteration   49 stopping due to too large eigenvalue change
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+14 is 6.643799e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744858751214       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744858751214       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744858751214       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744858751214       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744858752110       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.352077128511       residual = 7.23e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.512998389311       residual = 1.24e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.481290720733       residual = 4.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.028998293603       residual = 3.27e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -2.622578207244       residual = 1.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.049841545630       residual = 5.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       1.390545409809       residual = 2.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741703781946       residual = 2.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.321947263177       residual = 5.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       1.216687201149       residual = 2.78e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       0.409462702448       residual = 7.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.811449260657       residual = 6.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.151021239392       residual = 1.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       0.749922091588       residual = 1.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       0.215927657669       residual = 3.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.190854743197       residual = 4.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.677656089851       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       3.661198068118       residual = 1.06e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =     -10.281382522893       residual = 4.37e+04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.138885666102       residual = 1.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.585561544818       residual = 1.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.529328455056       residual = 1.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.530827112729       residual = 5.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -9.634120872545       residual = 3.77e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -6.476291414291       residual = 1.70e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.968866873670       residual = 7.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -3.252325250489       residual = 7.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -6.984370475085       residual = 2.18e+04           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+15 is 1.660599e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.658411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8696e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8189
    reference variance = 0.324353
====================================================
  Execution time = 4.3500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5030e-01
  Total weights = 2.0000e+06
  Execution time = 3.4820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474498746
  error estimate for blocks of size 2^( 2) =       0.000499514718
  error estimate for blocks of size 2^( 3) =       0.000523500552
  error estimate for blocks of size 2^( 4) =       0.000540808523
  error estimate for blocks of size 2^( 5) =       0.000552184062
  error estimate for blocks of size 2^( 6) =       0.000557958086
  error estimate for blocks of size 2^( 7) =       0.000561675910

      target function =      -0.745011736816
              le_mean =     -22.814556777490
             les_mean =     520.954298847331
             stat err =       0.000553156645
             autocorr =       1.359020883928
   target nu stat err =       0.000553156645
   target dn stat err =       0.003230370274
      target stat err =       0.002784156765
              std dev =       0.671042561372
             le_variance =       0.450298119172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474498746
  error estimate for blocks of size 2^( 2) =       0.000499514718
  error estimate for blocks of size 2^( 3) =       0.000523500552
  error estimate for blocks of size 2^( 4) =       0.000540808523
  error estimate for blocks of size 2^( 5) =       0.000552184062
  error estimate for blocks of size 2^( 6) =       0.000557958086
  error estimate for blocks of size 2^( 7) =       0.000561675910

      target function =      -0.745011736816
              le_mean =     -22.814556777490
             les_mean =     520.954298847331
             stat err =       0.000553156645
             autocorr =       1.359020883928
   target nu stat err =       0.000553156645
   target dn stat err =       0.003230370274
      target stat err =       0.002784156765
              std dev =       0.671042561372
             le_variance =       0.450298119172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474498746
  error estimate for blocks of size 2^( 2) =       0.000499514718
  error estimate for blocks of size 2^( 3) =       0.000523500552
  error estimate for blocks of size 2^( 4) =       0.000540808523
  error estimate for blocks of size 2^( 5) =       0.000552184062
  error estimate for blocks of size 2^( 6) =       0.000557958086
  error estimate for blocks of size 2^( 7) =       0.000561675910

      target function =      -0.745011736816
              le_mean =     -22.814556777490
             les_mean =     520.954298847331
             stat err =       0.000553156645
             autocorr =       1.359020883928
   target nu stat err =       0.000553156645
   target dn stat err =       0.003230370274
      target stat err =       0.002784156765
              std dev =       0.671042561372
             le_variance =       0.450298119172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450312092818
                                         uncertainty =       0.003333926309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474498746
  error estimate for blocks of size 2^( 2) =       0.000499514718
  error estimate for blocks of size 2^( 3) =       0.000523500552
  error estimate for blocks of size 2^( 4) =       0.000540808523
  error estimate for blocks of size 2^( 5) =       0.000552184062
  error estimate for blocks of size 2^( 6) =       0.000557958086
  error estimate for blocks of size 2^( 7) =       0.000561675910

      target function =      -0.745011736816
              le_mean =     -22.814556777490
             les_mean =     520.954298847331
             stat err =       0.000553156645
             autocorr =       1.359020883928
   target nu stat err =       0.000553156645
   target dn stat err =       0.003230370274
      target stat err =       0.002784156765
              std dev =       0.671042561372
             le_variance =       0.450298119172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745011736816        initial  <--
     6.2500e+13     6.2500e+14             2.8429e-18        -0.745011736816
     2.5000e+14     2.5000e+15             6.6438e-19        -0.745011736816
     1.0000e+15     1.0000e+16             1.6606e-19        -0.745011736816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9045
  </log>
  <optVariables href="FORM2.s018.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1961e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8677
    reference variance = 0.260146
====================================================
  Execution time = 5.1770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4655e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455170423828
                                         uncertainty =       0.003975926746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455170423828
                                         uncertainty =       0.003975926746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477005384
  error estimate for blocks of size 2^( 2) =       0.000502347301
  error estimate for blocks of size 2^( 3) =       0.000526132124
  error estimate for blocks of size 2^( 4) =       0.000544543247
  error estimate for blocks of size 2^( 5) =       0.000557029520
  error estimate for blocks of size 2^( 6) =       0.000564860301
  error estimate for blocks of size 2^( 7) =       0.000568490779

      target function =      -0.741007417180
              le_mean =     -22.815083757532
             les_mean =     520.983114908421
             stat err =       0.000558730962
             autocorr =       1.372015173070
   target nu stat err =       0.000558730962
   target dn stat err =       0.004174415532
      target stat err =       0.003527760543
              std dev =       0.674587483412
             le_variance =       0.455068272776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281508375753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741023409559       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741023409559       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741023409559       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741023409559       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+16, overlap shift 1.0000e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741023409559       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741023409559       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.659499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.6432e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8665
    reference variance = 0.755857
====================================================
  Execution time = 4.3444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4521e-01
  Total weights = 2.0000e+06
  Execution time = 3.4636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471811141
  error estimate for blocks of size 2^( 2) =       0.000497543606
  error estimate for blocks of size 2^( 3) =       0.000521808809
  error estimate for blocks of size 2^( 4) =       0.000540529806
  error estimate for blocks of size 2^( 5) =       0.000551584204
  error estimate for blocks of size 2^( 6) =       0.000559218789
  error estimate for blocks of size 2^( 7) =       0.000562731702

      target function =      -0.749306169777
              le_mean =     -22.814806639046
             les_mean =     520.960613259577
             stat err =       0.000553516125
             autocorr =       1.376335056633
   target nu stat err =       0.000553516125
   target dn stat err =       0.003230953240
      target stat err =       0.002817177673
              std dev =       0.667241714178
             le_variance =       0.445211505139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471811141
  error estimate for blocks of size 2^( 2) =       0.000497543606
  error estimate for blocks of size 2^( 3) =       0.000521808809
  error estimate for blocks of size 2^( 4) =       0.000540529806
  error estimate for blocks of size 2^( 5) =       0.000551584204
  error estimate for blocks of size 2^( 6) =       0.000559218789
  error estimate for blocks of size 2^( 7) =       0.000562731702

      target function =      -0.749306169777
              le_mean =     -22.814806639046
             les_mean =     520.960613259577
             stat err =       0.000553516125
             autocorr =       1.376335056634
   target nu stat err =       0.000553516125
   target dn stat err =       0.003230953240
      target stat err =       0.002817177673
              std dev =       0.667241714178
             le_variance =       0.445211505139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471811141
  error estimate for blocks of size 2^( 2) =       0.000497543606
  error estimate for blocks of size 2^( 3) =       0.000521808809
  error estimate for blocks of size 2^( 4) =       0.000540529806
  error estimate for blocks of size 2^( 5) =       0.000551584204
  error estimate for blocks of size 2^( 6) =       0.000559218789
  error estimate for blocks of size 2^( 7) =       0.000562731702

      target function =      -0.749306169777
              le_mean =     -22.814806639046
             les_mean =     520.960613259577
             stat err =       0.000553516125
             autocorr =       1.376335056634
   target nu stat err =       0.000553516125
   target dn stat err =       0.003230953240
      target stat err =       0.002817177673
              std dev =       0.667241714178
             le_variance =       0.445211505139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445236914448
                                         uncertainty =       0.003223421048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471811141
  error estimate for blocks of size 2^( 2) =       0.000497543606
  error estimate for blocks of size 2^( 3) =       0.000521808809
  error estimate for blocks of size 2^( 4) =       0.000540529806
  error estimate for blocks of size 2^( 5) =       0.000551584204
  error estimate for blocks of size 2^( 6) =       0.000559218789
  error estimate for blocks of size 2^( 7) =       0.000562731702

      target function =      -0.749306169777
              le_mean =     -22.814806639046
             les_mean =     520.960613259577
             stat err =       0.000553516125
             autocorr =       1.376335056634
   target nu stat err =       0.000553516125
   target dn stat err =       0.003230953240
      target stat err =       0.002817177673
              std dev =       0.667241714178
             le_variance =       0.445211505139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749306169777        initial  <--
     6.2500e+14     6.2500e+15             0.0000e+00        -0.749306169777
     2.5000e+15     2.5000e+16             0.0000e+00        -0.749306169777
     1.0000e+16     1.0000e+17             0.0000e+00        -0.749306169777

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7987
  </log>
  <optVariables href="FORM2.s019.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2724e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8593
    reference variance = 0.375225
====================================================
  Execution time = 4.5789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5398e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4610e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454023268247
                                         uncertainty =       0.005057399727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454023268247
                                         uncertainty =       0.005057399727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476436821
  error estimate for blocks of size 2^( 2) =       0.000501848640
  error estimate for blocks of size 2^( 3) =       0.000525245707
  error estimate for blocks of size 2^( 4) =       0.000543357606
  error estimate for blocks of size 2^( 5) =       0.000555774348
  error estimate for blocks of size 2^( 6) =       0.000563574758
  error estimate for blocks of size 2^( 7) =       0.000568282959

      target function =      -0.741898576314
              le_mean =     -22.815391601585
             les_mean =     520.996077795522
             stat err =       0.000557747418
             autocorr =       1.370454116971
   target nu stat err =       0.000557747418
   target dn stat err =       0.004762438136
      target stat err =       0.004021193977
              std dev =       0.673783413888
             le_variance =       0.453984088830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539160159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741919082251       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741919082251       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741919082251       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741919082251       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741919082261       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741919095805       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.760384061801       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749517969645       residual = 4.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -2.425883956897       residual = 1.75e+04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -6.758248043515       residual = 2.99e+04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.842205375691       residual = 4.19e+04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -9.197743675429       residual = 4.89e+04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       3.508679923392       residual = 2.49e+04           smallest_sin_value = 1.00e+00
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+15 is 2.453105e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741919082251       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741919082251       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741919082251       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741919082251       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.482076746302       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       8.971414129448       residual = 4.40e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.414652464110       residual = 8.91e+05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =     -10.113201360324       residual = 6.46e+04           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+16 is 6.132762e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+17, overlap shift 1.0000e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741919082251       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741919082251       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741919082251       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741919082251       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741919082188       residual = 8.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       2.034337806214       residual = 3.58e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+17 is 1.533190e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.663460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0409e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.9633
    reference variance = 0.646963
====================================================
  Execution time = 4.3499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4756e-01
  Total weights = 2.0000e+06
  Execution time = 3.4620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473056574
  error estimate for blocks of size 2^( 2) =       0.000498538316
  error estimate for blocks of size 2^( 3) =       0.000522166214
  error estimate for blocks of size 2^( 4) =       0.000540505840
  error estimate for blocks of size 2^( 5) =       0.000551790834
  error estimate for blocks of size 2^( 6) =       0.000559503537
  error estimate for blocks of size 2^( 7) =       0.000559791388

      target function =      -0.747319215682
              le_mean =     -22.814122987878
             les_mean =     520.931772526363
             stat err =       0.000552897900
             autocorr =       1.366040942867
   target nu stat err =       0.000552897900
   target dn stat err =       0.003428096904
      target stat err =       0.002962122941
              std dev =       0.669003022495
             le_variance =       0.447565044108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473056574
  error estimate for blocks of size 2^( 2) =       0.000498538316
  error estimate for blocks of size 2^( 3) =       0.000522166214
  error estimate for blocks of size 2^( 4) =       0.000540505840
  error estimate for blocks of size 2^( 5) =       0.000551790834
  error estimate for blocks of size 2^( 6) =       0.000559503537
  error estimate for blocks of size 2^( 7) =       0.000559791388

      target function =      -0.747319215682
              le_mean =     -22.814122987878
             les_mean =     520.931772526363
             stat err =       0.000552897900
             autocorr =       1.366040942865
   target nu stat err =       0.000552897900
   target dn stat err =       0.003428096904
      target stat err =       0.002962122941
              std dev =       0.669003022495
             le_variance =       0.447565044108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473056574
  error estimate for blocks of size 2^( 2) =       0.000498538316
  error estimate for blocks of size 2^( 3) =       0.000522166214
  error estimate for blocks of size 2^( 4) =       0.000540505840
  error estimate for blocks of size 2^( 5) =       0.000551790834
  error estimate for blocks of size 2^( 6) =       0.000559503537
  error estimate for blocks of size 2^( 7) =       0.000559791388

      target function =      -0.747319215682
              le_mean =     -22.814122987878
             les_mean =     520.931772526363
             stat err =       0.000552897900
             autocorr =       1.366040942865
   target nu stat err =       0.000552897900
   target dn stat err =       0.003428096904
      target stat err =       0.002962122941
              std dev =       0.669003022495
             le_variance =       0.447565044108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447594492341
                                         uncertainty =       0.003336180837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473056574
  error estimate for blocks of size 2^( 2) =       0.000498538316
  error estimate for blocks of size 2^( 3) =       0.000522166214
  error estimate for blocks of size 2^( 4) =       0.000540505840
  error estimate for blocks of size 2^( 5) =       0.000551790834
  error estimate for blocks of size 2^( 6) =       0.000559503537
  error estimate for blocks of size 2^( 7) =       0.000559791388

      target function =      -0.747319215682
              le_mean =     -22.814122987878
             les_mean =     520.931772526363
             stat err =       0.000552897900
             autocorr =       1.366040942865
   target nu stat err =       0.000552897900
   target dn stat err =       0.003428096904
      target stat err =       0.002962122941
              std dev =       0.669003022495
             le_variance =       0.447565044108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747319215682        initial  <--
     6.2500e+15     6.2500e+16             2.4531e-20        -0.747319215682
     2.5000e+16     2.5000e+17             6.1328e-21        -0.747319215682
     1.0000e+17     1.0000e+18             1.5332e-21        -0.747319215682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8423
  </log>
  <optVariables href="FORM2.s020.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2126e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8371
    reference variance = 0.910264
====================================================
  Execution time = 4.3695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4701e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466399846681
                                         uncertainty =       0.021110132959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466399846681
                                         uncertainty =       0.021110132959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482867067
  error estimate for blocks of size 2^( 2) =       0.000507818535
  error estimate for blocks of size 2^( 3) =       0.000531828541
  error estimate for blocks of size 2^( 4) =       0.000549432167
  error estimate for blocks of size 2^( 5) =       0.000561027054
  error estimate for blocks of size 2^( 6) =       0.000566471003
  error estimate for blocks of size 2^( 7) =       0.000571780678

      target function =      -0.731400453723
              le_mean =     -22.814243367376
             les_mean =     520.956021401764
             stat err =       0.000562177725
             autocorr =       1.355476820275
   target nu stat err =       0.000562177725
   target dn stat err =       0.021530288644
      target stat err =       0.017442401478
              std dev =       0.682877155173
             le_variance =       0.466321209057


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281424336738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731812339525       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731812339525       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731812339525       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731812339525       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+18, overlap shift 1.0000e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731812339525       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731812339525       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.664558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8403e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7808
    reference variance = 0.388252
====================================================
  Execution time = 4.4771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4992e-01
  Total weights = 2.0000e+06
  Execution time = 3.4692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474300474
  error estimate for blocks of size 2^( 2) =       0.000499820226
  error estimate for blocks of size 2^( 3) =       0.000523883983
  error estimate for blocks of size 2^( 4) =       0.000541955168
  error estimate for blocks of size 2^( 5) =       0.000553829395
  error estimate for blocks of size 2^( 6) =       0.000561825408
  error estimate for blocks of size 2^( 7) =       0.000564165484

      target function =      -0.745330149097
              le_mean =     -22.814148411317
             les_mean =     520.935289387182
             stat err =       0.000555443864
             autocorr =       1.371428687895
   target nu stat err =       0.000555443864
   target dn stat err =       0.003938136927
      target stat err =       0.003367432556
              std dev =       0.670762162425
             le_variance =       0.449921878541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474300474
  error estimate for blocks of size 2^( 2) =       0.000499820226
  error estimate for blocks of size 2^( 3) =       0.000523883983
  error estimate for blocks of size 2^( 4) =       0.000541955168
  error estimate for blocks of size 2^( 5) =       0.000553829395
  error estimate for blocks of size 2^( 6) =       0.000561825408
  error estimate for blocks of size 2^( 7) =       0.000564165484

      target function =      -0.745330149097
              le_mean =     -22.814148411317
             les_mean =     520.935289387182
             stat err =       0.000555443864
             autocorr =       1.371428687896
   target nu stat err =       0.000555443864
   target dn stat err =       0.003938136927
      target stat err =       0.003367432556
              std dev =       0.670762162425
             le_variance =       0.449921878541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474300474
  error estimate for blocks of size 2^( 2) =       0.000499820226
  error estimate for blocks of size 2^( 3) =       0.000523883983
  error estimate for blocks of size 2^( 4) =       0.000541955168
  error estimate for blocks of size 2^( 5) =       0.000553829395
  error estimate for blocks of size 2^( 6) =       0.000561825408
  error estimate for blocks of size 2^( 7) =       0.000564165484

      target function =      -0.745330149097
              le_mean =     -22.814148411317
             les_mean =     520.935289387182
             stat err =       0.000555443864
             autocorr =       1.371428687896
   target nu stat err =       0.000555443864
   target dn stat err =       0.003938136927
      target stat err =       0.003367432556
              std dev =       0.670762162425
             le_variance =       0.449921878541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028453529
                                         uncertainty =       0.003995930602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474300474
  error estimate for blocks of size 2^( 2) =       0.000499820226
  error estimate for blocks of size 2^( 3) =       0.000523883983
  error estimate for blocks of size 2^( 4) =       0.000541955168
  error estimate for blocks of size 2^( 5) =       0.000553829395
  error estimate for blocks of size 2^( 6) =       0.000561825408
  error estimate for blocks of size 2^( 7) =       0.000564165484

      target function =      -0.745330149097
              le_mean =     -22.814148411317
             les_mean =     520.935289387182
             stat err =       0.000555443864
             autocorr =       1.371428687896
   target nu stat err =       0.000555443864
   target dn stat err =       0.003938136927
      target stat err =       0.003367432556
              std dev =       0.670762162425
             le_variance =       0.449921878541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745330149097        initial  <--
     6.2500e+16     6.2500e+17             0.0000e+00        -0.745330149097
     2.5000e+17     2.5000e+18             0.0000e+00        -0.745330149097
     1.0000e+18     1.0000e+19             0.0000e+00        -0.745330149097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1256
  </log>
  <optVariables href="FORM2.s021.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2054e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8232
    reference variance = 0.30416
====================================================
  Execution time = 4.3964e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4741e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450663782073
                                         uncertainty =       0.003004808609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450663782073
                                         uncertainty =       0.003004808609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474634034
  error estimate for blocks of size 2^( 2) =       0.000499558318
  error estimate for blocks of size 2^( 3) =       0.000523424074
  error estimate for blocks of size 2^( 4) =       0.000541481449
  error estimate for blocks of size 2^( 5) =       0.000553671243
  error estimate for blocks of size 2^( 6) =       0.000562509387
  error estimate for blocks of size 2^( 7) =       0.000567450502

      target function =      -0.744793078523
              le_mean =     -22.814813485881
             les_mean =     520.966269103154
             stat err =       0.000556278145
             autocorr =       1.373618851034
   target nu stat err =       0.000556278145
   target dn stat err =       0.002987267050
      target stat err =       0.002585928469
              std dev =       0.671233888361
             le_variance =       0.450554932885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281481348588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744801000490       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744801000490       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744801000490       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744801000490       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+19, overlap shift 1.0000e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744801000490       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744801000490       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.665686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8712e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7646
    reference variance = 0.599901
====================================================
  Execution time = 4.4560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4664e-01
  Total weights = 2.0000e+06
  Execution time = 3.4690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472569153
  error estimate for blocks of size 2^( 2) =       0.000497954017
  error estimate for blocks of size 2^( 3) =       0.000522192342
  error estimate for blocks of size 2^( 4) =       0.000541284417
  error estimate for blocks of size 2^( 5) =       0.000553386222
  error estimate for blocks of size 2^( 6) =       0.000561642598
  error estimate for blocks of size 2^( 7) =       0.000564950717

      target function =      -0.748101865644
              le_mean =     -22.814092480499
             les_mean =     520.929458693962
             stat err =       0.000555315989
             autocorr =       1.380859895916
   target nu stat err =       0.000555315989
   target dn stat err =       0.002984684140
      target stat err =       0.002603049962
              std dev =       0.668313705185
             le_variance =       0.446643208539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472569153
  error estimate for blocks of size 2^( 2) =       0.000497954017
  error estimate for blocks of size 2^( 3) =       0.000522192342
  error estimate for blocks of size 2^( 4) =       0.000541284417
  error estimate for blocks of size 2^( 5) =       0.000553386222
  error estimate for blocks of size 2^( 6) =       0.000561642598
  error estimate for blocks of size 2^( 7) =       0.000564950717

      target function =      -0.748101865644
              le_mean =     -22.814092480499
             les_mean =     520.929458693962
             stat err =       0.000555315989
             autocorr =       1.380859895916
   target nu stat err =       0.000555315989
   target dn stat err =       0.002984684140
      target stat err =       0.002603049962
              std dev =       0.668313705185
             le_variance =       0.446643208539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472569153
  error estimate for blocks of size 2^( 2) =       0.000497954017
  error estimate for blocks of size 2^( 3) =       0.000522192342
  error estimate for blocks of size 2^( 4) =       0.000541284417
  error estimate for blocks of size 2^( 5) =       0.000553386222
  error estimate for blocks of size 2^( 6) =       0.000561642598
  error estimate for blocks of size 2^( 7) =       0.000564950717

      target function =      -0.748101865644
              le_mean =     -22.814092480499
             les_mean =     520.929458693962
             stat err =       0.000555315989
             autocorr =       1.380859895916
   target nu stat err =       0.000555315989
   target dn stat err =       0.002984684140
      target stat err =       0.002603049962
              std dev =       0.668313705185
             le_variance =       0.446643208539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446663468189
                                         uncertainty =       0.002943897470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472569153
  error estimate for blocks of size 2^( 2) =       0.000497954017
  error estimate for blocks of size 2^( 3) =       0.000522192342
  error estimate for blocks of size 2^( 4) =       0.000541284417
  error estimate for blocks of size 2^( 5) =       0.000553386222
  error estimate for blocks of size 2^( 6) =       0.000561642598
  error estimate for blocks of size 2^( 7) =       0.000564950717

      target function =      -0.748101865644
              le_mean =     -22.814092480499
             les_mean =     520.929458693962
             stat err =       0.000555315989
             autocorr =       1.380859895916
   target nu stat err =       0.000555315989
   target dn stat err =       0.002984684140
      target stat err =       0.002603049962
              std dev =       0.668313705185
             le_variance =       0.446643208539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748101865644        initial  <--
     6.2500e+17     6.2500e+18             0.0000e+00        -0.748101865644
     2.5000e+18     2.5000e+19             0.0000e+00        -0.748101865644
     1.0000e+19     1.0000e+20             0.0000e+00        -0.748101865644

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9028
  </log>
  <optVariables href="FORM2.s022.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2062e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8021
    reference variance = 0.429582
====================================================
  Execution time = 4.3818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4824e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5157e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256956290
                                         uncertainty =       0.003082949454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256956290
                                         uncertainty =       0.003082949454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473411254
  error estimate for blocks of size 2^( 2) =       0.000498416421
  error estimate for blocks of size 2^( 3) =       0.000522706397
  error estimate for blocks of size 2^( 4) =       0.000540857900
  error estimate for blocks of size 2^( 5) =       0.000553078376
  error estimate for blocks of size 2^( 6) =       0.000557330736
  error estimate for blocks of size 2^( 7) =       0.000561137015

      target function =      -0.746750576542
              le_mean =     -22.814496547828
             les_mean =     520.949488937525
             stat err =       0.000553101007
             autocorr =       1.364997143557
   target nu stat err =       0.000553101007
   target dn stat err =       0.002873428138
      target stat err =       0.002503895024
              std dev =       0.669504615946
             le_variance =       0.448236430774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281449654783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746757943231       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746757943231       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746757943231       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746757943231       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+20, overlap shift 1.0000e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746757943231       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746757943231       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.666803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8982e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8366
    reference variance = 0.323806
====================================================
  Execution time = 4.3512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4751e-01
  Total weights = 2.0000e+06
  Execution time = 3.4662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473027491
  error estimate for blocks of size 2^( 2) =       0.000498512882
  error estimate for blocks of size 2^( 3) =       0.000522473489
  error estimate for blocks of size 2^( 4) =       0.000540177368
  error estimate for blocks of size 2^( 5) =       0.000550910158
  error estimate for blocks of size 2^( 6) =       0.000556939179
  error estimate for blocks of size 2^( 7) =       0.000559129791

      target function =      -0.747350652608
              le_mean =     -22.814990447927
             les_mean =     520.971298930527
             stat err =       0.000551789124
             autocorr =       1.360734853979
   target nu stat err =       0.000551789124
   target dn stat err =       0.003881479216
      target stat err =       0.003341860091
              std dev =       0.668961893732
             le_variance =       0.447510015266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473027491
  error estimate for blocks of size 2^( 2) =       0.000498512882
  error estimate for blocks of size 2^( 3) =       0.000522473489
  error estimate for blocks of size 2^( 4) =       0.000540177368
  error estimate for blocks of size 2^( 5) =       0.000550910158
  error estimate for blocks of size 2^( 6) =       0.000556939179
  error estimate for blocks of size 2^( 7) =       0.000559129791

      target function =      -0.747350652608
              le_mean =     -22.814990447927
             les_mean =     520.971298930527
             stat err =       0.000551789124
             autocorr =       1.360734853979
   target nu stat err =       0.000551789124
   target dn stat err =       0.003881479216
      target stat err =       0.003341860091
              std dev =       0.668961893732
             le_variance =       0.447510015266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473027491
  error estimate for blocks of size 2^( 2) =       0.000498512882
  error estimate for blocks of size 2^( 3) =       0.000522473489
  error estimate for blocks of size 2^( 4) =       0.000540177368
  error estimate for blocks of size 2^( 5) =       0.000550910158
  error estimate for blocks of size 2^( 6) =       0.000556939179
  error estimate for blocks of size 2^( 7) =       0.000559129791

      target function =      -0.747350652608
              le_mean =     -22.814990447927
             les_mean =     520.971298930527
             stat err =       0.000551789124
             autocorr =       1.360734853979
   target nu stat err =       0.000551789124
   target dn stat err =       0.003881479216
      target stat err =       0.003341860091
              std dev =       0.668961893732
             le_variance =       0.447510015266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447471344834
                                         uncertainty =       0.003642060233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473027491
  error estimate for blocks of size 2^( 2) =       0.000498512882
  error estimate for blocks of size 2^( 3) =       0.000522473489
  error estimate for blocks of size 2^( 4) =       0.000540177368
  error estimate for blocks of size 2^( 5) =       0.000550910158
  error estimate for blocks of size 2^( 6) =       0.000556939179
  error estimate for blocks of size 2^( 7) =       0.000559129791

      target function =      -0.747350652608
              le_mean =     -22.814990447927
             les_mean =     520.971298930527
             stat err =       0.000551789124
             autocorr =       1.360734853979
   target nu stat err =       0.000551789124
   target dn stat err =       0.003881479216
      target stat err =       0.003341860091
              std dev =       0.668961893732
             le_variance =       0.447510015266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747350652608        initial  <--
     6.2500e+18     6.2500e+19             0.0000e+00        -0.747350652608
     2.5000e+19     2.5000e+20             0.0000e+00        -0.747350652608
     1.0000e+20     1.0000e+21             0.0000e+00        -0.747350652608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8382
  </log>
  <optVariables href="FORM2.s023.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1983e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8123
    reference variance = 0.375718
====================================================
  Execution time = 4.5440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.3494e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4749e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535187527243
                                         uncertainty =       0.080982181028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535187527243
                                         uncertainty =       0.080982181028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000517174285
  error estimate for blocks of size 2^( 2) =       0.000540712646
  error estimate for blocks of size 2^( 3) =       0.000562760633
  error estimate for blocks of size 2^( 4) =       0.000580155301
  error estimate for blocks of size 2^( 5) =       0.000590879979
  error estimate for blocks of size 2^( 6) =       0.000597985517
  error estimate for blocks of size 2^( 7) =       0.000602833347

      target function =      -0.675418621376
              le_mean =     -22.814512578372
             les_mean =     521.036922403903
             stat err =       0.000592963536
             autocorr =       1.314565193527
   target nu stat err =       0.000592963536
   target dn stat err =       0.080988087455
      target stat err =       0.056300088239
              std dev =       0.731394888341
             le_variance =       0.534938482692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451257837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.680123289168       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.680123289168       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.680123289174       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+19 is 6.685302e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.680123289168       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.680123289168       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.680123289116       residual = 4.29e+03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+20 is 1.671325e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+21, overlap shift 1.0000e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.680123289168       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.680123289168       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.680123289168       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+21 is 4.178313e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.668157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0195e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.9614
    reference variance = 0.469048
====================================================
  Execution time = 4.2943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4050e-01
  Total weights = 2.0000e+06
  Execution time = 3.4548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469306055
  error estimate for blocks of size 2^( 2) =       0.000495017561
  error estimate for blocks of size 2^( 3) =       0.000519696940
  error estimate for blocks of size 2^( 4) =       0.000537671264
  error estimate for blocks of size 2^( 5) =       0.000548337043
  error estimate for blocks of size 2^( 6) =       0.000553511081
  error estimate for blocks of size 2^( 7) =       0.000557023884

      target function =      -0.753345348031
              le_mean =     -22.813767208480
             les_mean =     520.908470369489
             stat err =       0.000549135818
             autocorr =       1.369138013077
   target nu stat err =       0.000549135818
   target dn stat err =       0.002280184849
      target stat err =       0.002053536799
              std dev =       0.663698988255
             le_variance =       0.440496347011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469306055
  error estimate for blocks of size 2^( 2) =       0.000495017561
  error estimate for blocks of size 2^( 3) =       0.000519696940
  error estimate for blocks of size 2^( 4) =       0.000537671264
  error estimate for blocks of size 2^( 5) =       0.000548337043
  error estimate for blocks of size 2^( 6) =       0.000553511081
  error estimate for blocks of size 2^( 7) =       0.000557023884

      target function =      -0.753345348031
              le_mean =     -22.813767208480
             les_mean =     520.908470369489
             stat err =       0.000549135818
             autocorr =       1.369138013077
   target nu stat err =       0.000549135818
   target dn stat err =       0.002280184849
      target stat err =       0.002053536799
              std dev =       0.663698988255
             le_variance =       0.440496347011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469306055
  error estimate for blocks of size 2^( 2) =       0.000495017561
  error estimate for blocks of size 2^( 3) =       0.000519696940
  error estimate for blocks of size 2^( 4) =       0.000537671264
  error estimate for blocks of size 2^( 5) =       0.000548337043
  error estimate for blocks of size 2^( 6) =       0.000553511081
  error estimate for blocks of size 2^( 7) =       0.000557023884

      target function =      -0.753345348031
              le_mean =     -22.813767208480
             les_mean =     520.908470369489
             stat err =       0.000549135818
             autocorr =       1.369138013077
   target nu stat err =       0.000549135818
   target dn stat err =       0.002280184849
      target stat err =       0.002053536799
              std dev =       0.663698988255
             le_variance =       0.440496347011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440475498138
                                         uncertainty =       0.002439955156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469306055
  error estimate for blocks of size 2^( 2) =       0.000495017561
  error estimate for blocks of size 2^( 3) =       0.000519696940
  error estimate for blocks of size 2^( 4) =       0.000537671264
  error estimate for blocks of size 2^( 5) =       0.000548337043
  error estimate for blocks of size 2^( 6) =       0.000553511081
  error estimate for blocks of size 2^( 7) =       0.000557023884

      target function =      -0.753345348031
              le_mean =     -22.813767208480
             les_mean =     520.908470369489
             stat err =       0.000549135818
             autocorr =       1.369138013077
   target nu stat err =       0.000549135818
   target dn stat err =       0.002280184849
      target stat err =       0.002053536799
              std dev =       0.663698988255
             le_variance =       0.440496347011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.753345348031        initial  <--
     6.2500e+19     6.2500e+20             6.6853e-24        -0.753345348031
     2.5000e+20     2.5000e+21             1.6713e-24        -0.753345348031
     1.0000e+21     1.0000e+22             4.1783e-25        -0.753345348031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2776
  </log>
  <optVariables href="FORM2.s024.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2048e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8161
    reference variance = 0.237398
====================================================
  Execution time = 4.5769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4905e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4736e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448978616536
                                         uncertainty =       0.003418122282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448978616536
                                         uncertainty =       0.003418122282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473838411
  error estimate for blocks of size 2^( 2) =       0.000499039644
  error estimate for blocks of size 2^( 3) =       0.000523628001
  error estimate for blocks of size 2^( 4) =       0.000541451492
  error estimate for blocks of size 2^( 5) =       0.000553678534
  error estimate for blocks of size 2^( 6) =       0.000560525754
  error estimate for blocks of size 2^( 7) =       0.000563579480

      target function =      -0.746063809367
              le_mean =     -22.814564739004
             les_mean =     520.953409685362
             stat err =       0.000554808815
             autocorr =       1.370964403528
   target nu stat err =       0.000554808815
   target dn stat err =       0.003447472653
      target stat err =       0.002970783554
              std dev =       0.670108707353
             le_variance =       0.449045679670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456473900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746074630717       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746074630717       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746074630717       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746074630717       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+22, overlap shift 1.0000e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746074630717       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746074630717       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.669268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0512e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8637
    reference variance = 1.1129
====================================================
  Execution time = 4.3050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5078e-01
  Total weights = 2.0000e+06
  Execution time = 3.4692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474752170
  error estimate for blocks of size 2^( 2) =       0.000499556046
  error estimate for blocks of size 2^( 3) =       0.000523334582
  error estimate for blocks of size 2^( 4) =       0.000541795449
  error estimate for blocks of size 2^( 5) =       0.000552832228
  error estimate for blocks of size 2^( 6) =       0.000558807069
  error estimate for blocks of size 2^( 7) =       0.000561800529

      target function =      -0.744572184597
              le_mean =     -22.815030371671
             les_mean =     520.976389881028
             stat err =       0.000553808819
             autocorr =       1.360773418671
   target nu stat err =       0.000553808819
   target dn stat err =       0.006207908367
      target stat err =       0.005249494221
              std dev =       0.671400957799
             le_variance =       0.450779246133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474752170
  error estimate for blocks of size 2^( 2) =       0.000499556046
  error estimate for blocks of size 2^( 3) =       0.000523334582
  error estimate for blocks of size 2^( 4) =       0.000541795449
  error estimate for blocks of size 2^( 5) =       0.000552832228
  error estimate for blocks of size 2^( 6) =       0.000558807069
  error estimate for blocks of size 2^( 7) =       0.000561800529

      target function =      -0.744572184597
              le_mean =     -22.815030371671
             les_mean =     520.976389881028
             stat err =       0.000553808819
             autocorr =       1.360773418672
   target nu stat err =       0.000553808819
   target dn stat err =       0.006207908367
      target stat err =       0.005249494221
              std dev =       0.671400957799
             le_variance =       0.450779246133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474752170
  error estimate for blocks of size 2^( 2) =       0.000499556046
  error estimate for blocks of size 2^( 3) =       0.000523334582
  error estimate for blocks of size 2^( 4) =       0.000541795449
  error estimate for blocks of size 2^( 5) =       0.000552832228
  error estimate for blocks of size 2^( 6) =       0.000558807069
  error estimate for blocks of size 2^( 7) =       0.000561800529

      target function =      -0.744572184597
              le_mean =     -22.815030371671
             les_mean =     520.976389881028
             stat err =       0.000553808819
             autocorr =       1.360773418672
   target nu stat err =       0.000553808819
   target dn stat err =       0.006207908367
      target stat err =       0.005249494221
              std dev =       0.671400957799
             le_variance =       0.450779246133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450784598046
                                         uncertainty =       0.006430753639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474752170
  error estimate for blocks of size 2^( 2) =       0.000499556046
  error estimate for blocks of size 2^( 3) =       0.000523334582
  error estimate for blocks of size 2^( 4) =       0.000541795449
  error estimate for blocks of size 2^( 5) =       0.000552832228
  error estimate for blocks of size 2^( 6) =       0.000558807069
  error estimate for blocks of size 2^( 7) =       0.000561800529

      target function =      -0.744572184597
              le_mean =     -22.815030371671
             les_mean =     520.976389881028
             stat err =       0.000553808819
             autocorr =       1.360773418672
   target nu stat err =       0.000553808819
   target dn stat err =       0.006207908367
      target stat err =       0.005249494221
              std dev =       0.671400957799
             le_variance =       0.450779246133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744572184597        initial  <--
     6.2500e+20     6.2500e+21             0.0000e+00        -0.744572184597
     2.5000e+21     2.5000e+22             0.0000e+00        -0.744572184597
     1.0000e+22     1.0000e+23             0.0000e+00        -0.744572184597

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4521
  </log>
  <optVariables href="FORM2.s025.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2097e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8906
    reference variance = 0.435391
====================================================
  Execution time = 4.3651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4924e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445769283285
                                         uncertainty =       0.002595907088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445769283285
                                         uncertainty =       0.002595907088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472102131
  error estimate for blocks of size 2^( 2) =       0.000497528149
  error estimate for blocks of size 2^( 3) =       0.000521879250
  error estimate for blocks of size 2^( 4) =       0.000539656069
  error estimate for blocks of size 2^( 5) =       0.000549625444
  error estimate for blocks of size 2^( 6) =       0.000555521063
  error estimate for blocks of size 2^( 7) =       0.000557101380

      target function =      -0.748857752612
              le_mean =     -22.813509676325
             les_mean =     520.901984372204
             stat err =       0.000550475989
             autocorr =       1.359580226708
   target nu stat err =       0.000550475989
   target dn stat err =       0.002504079524
      target stat err =       0.002211277236
              std dev =       0.667653235822
             le_variance =       0.445760843303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281350967633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748863355681       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748863355681       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748863355681       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748863355681       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+23, overlap shift 1.0000e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748863355681       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748863355681       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.670369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8582e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8334
    reference variance = 0.358244
====================================================
  Execution time = 4.5085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4709e-01
  Total weights = 2.0000e+06
  Execution time = 3.4760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472806599
  error estimate for blocks of size 2^( 2) =       0.000498579652
  error estimate for blocks of size 2^( 3) =       0.000522517531
  error estimate for blocks of size 2^( 4) =       0.000540743971
  error estimate for blocks of size 2^( 5) =       0.000552702684
  error estimate for blocks of size 2^( 6) =       0.000560891546
  error estimate for blocks of size 2^( 7) =       0.000564759475

      target function =      -0.747732017161
              le_mean =     -22.813411324177
             les_mean =     520.898828182478
             stat err =       0.000554774419
             autocorr =       1.376783954397
   target nu stat err =       0.000554774419
   target dn stat err =       0.002633629620
      target stat err =       0.002311070352
              std dev =       0.668649504551
             le_variance =       0.447092159936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472806599
  error estimate for blocks of size 2^( 2) =       0.000498579652
  error estimate for blocks of size 2^( 3) =       0.000522517531
  error estimate for blocks of size 2^( 4) =       0.000540743971
  error estimate for blocks of size 2^( 5) =       0.000552702684
  error estimate for blocks of size 2^( 6) =       0.000560891546
  error estimate for blocks of size 2^( 7) =       0.000564759475

      target function =      -0.747732017161
              le_mean =     -22.813411324177
             les_mean =     520.898828182478
             stat err =       0.000554774419
             autocorr =       1.376783954397
   target nu stat err =       0.000554774419
   target dn stat err =       0.002633629620
      target stat err =       0.002311070352
              std dev =       0.668649504551
             le_variance =       0.447092159936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472806599
  error estimate for blocks of size 2^( 2) =       0.000498579652
  error estimate for blocks of size 2^( 3) =       0.000522517531
  error estimate for blocks of size 2^( 4) =       0.000540743971
  error estimate for blocks of size 2^( 5) =       0.000552702684
  error estimate for blocks of size 2^( 6) =       0.000560891546
  error estimate for blocks of size 2^( 7) =       0.000564759475

      target function =      -0.747732017161
              le_mean =     -22.813411324177
             les_mean =     520.898828182478
             stat err =       0.000554774419
             autocorr =       1.376783954397
   target nu stat err =       0.000554774419
   target dn stat err =       0.002633629620
      target stat err =       0.002311070352
              std dev =       0.668649504551
             le_variance =       0.447092159936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447144659547
                                         uncertainty =       0.002137643903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472806599
  error estimate for blocks of size 2^( 2) =       0.000498579652
  error estimate for blocks of size 2^( 3) =       0.000522517531
  error estimate for blocks of size 2^( 4) =       0.000540743971
  error estimate for blocks of size 2^( 5) =       0.000552702684
  error estimate for blocks of size 2^( 6) =       0.000560891546
  error estimate for blocks of size 2^( 7) =       0.000564759475

      target function =      -0.747732017161
              le_mean =     -22.813411324177
             les_mean =     520.898828182478
             stat err =       0.000554774419
             autocorr =       1.376783954397
   target nu stat err =       0.000554774419
   target dn stat err =       0.002633629620
      target stat err =       0.002311070352
              std dev =       0.668649504551
             le_variance =       0.447092159936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747732017161        initial  <--
     6.2500e+21     6.2500e+22             0.0000e+00        -0.747732017161
     2.5000e+22     2.5000e+23             0.0000e+00        -0.747732017161
     1.0000e+23     1.0000e+24             0.0000e+00        -0.747732017161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4770
  </log>
  <optVariables href="FORM2.s026.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2107e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.9021
    reference variance = 0.388243
====================================================
  Execution time = 4.3552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4937e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4813e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449256208264
                                         uncertainty =       0.003739097413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449256208264
                                         uncertainty =       0.003739097413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474011980
  error estimate for blocks of size 2^( 2) =       0.000499083966
  error estimate for blocks of size 2^( 3) =       0.000523045578
  error estimate for blocks of size 2^( 4) =       0.000540878913
  error estimate for blocks of size 2^( 5) =       0.000552805502
  error estimate for blocks of size 2^( 6) =       0.000561537223
  error estimate for blocks of size 2^( 7) =       0.000563692365

      target function =      -0.745781120245
              le_mean =     -22.814782376690
             les_mean =     520.963669384760
             stat err =       0.000554728501
             autocorr =       1.369563973770
   target nu stat err =       0.000554728501
   target dn stat err =       0.003755426954
      target stat err =       0.003223477183
              std dev =       0.670354170371
             le_variance =       0.449374713734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281478237669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745793996180       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745793996180       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745793996181       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+22 is 9.932800e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745793996180       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745793996180       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745793996181       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+23 is 2.483200e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+24, overlap shift 1.0000e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745793996180       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745793996180       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745793996181       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+24 is 6.208000e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.671784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8373e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8624
    reference variance = 0.269601
====================================================
  Execution time = 4.4432e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4595e-01
  Total weights = 2.0000e+06
  Execution time = 3.4741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472201528
  error estimate for blocks of size 2^( 2) =       0.000497504372
  error estimate for blocks of size 2^( 3) =       0.000521647889
  error estimate for blocks of size 2^( 4) =       0.000538736920
  error estimate for blocks of size 2^( 5) =       0.000550441934
  error estimate for blocks of size 2^( 6) =       0.000556395347
  error estimate for blocks of size 2^( 7) =       0.000560877414

      target function =      -0.748688054815
              le_mean =     -22.814303951003
             les_mean =     520.938413112411
             stat err =       0.000551612904
             autocorr =       1.364627306230
   target nu stat err =       0.000551612904
   target dn stat err =       0.002946641204
      target stat err =       0.002575530148
              std dev =       0.667793805471
             le_variance =       0.445948566626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472201528
  error estimate for blocks of size 2^( 2) =       0.000497504372
  error estimate for blocks of size 2^( 3) =       0.000521647889
  error estimate for blocks of size 2^( 4) =       0.000538736920
  error estimate for blocks of size 2^( 5) =       0.000550441934
  error estimate for blocks of size 2^( 6) =       0.000556395347
  error estimate for blocks of size 2^( 7) =       0.000560877414

      target function =      -0.748688054815
              le_mean =     -22.814303951003
             les_mean =     520.938413112411
             stat err =       0.000551612904
             autocorr =       1.364627306230
   target nu stat err =       0.000551612904
   target dn stat err =       0.002946641204
      target stat err =       0.002575530148
              std dev =       0.667793805471
             le_variance =       0.445948566626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472201528
  error estimate for blocks of size 2^( 2) =       0.000497504372
  error estimate for blocks of size 2^( 3) =       0.000521647889
  error estimate for blocks of size 2^( 4) =       0.000538736920
  error estimate for blocks of size 2^( 5) =       0.000550441934
  error estimate for blocks of size 2^( 6) =       0.000556395347
  error estimate for blocks of size 2^( 7) =       0.000560877414

      target function =      -0.748688054815
              le_mean =     -22.814303951003
             les_mean =     520.938413112411
             stat err =       0.000551612904
             autocorr =       1.364627306230
   target nu stat err =       0.000551612904
   target dn stat err =       0.002946641204
      target stat err =       0.002575530148
              std dev =       0.667793805471
             le_variance =       0.445948566626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446061992561
                                         uncertainty =       0.003012375599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472201528
  error estimate for blocks of size 2^( 2) =       0.000497504372
  error estimate for blocks of size 2^( 3) =       0.000521647889
  error estimate for blocks of size 2^( 4) =       0.000538736920
  error estimate for blocks of size 2^( 5) =       0.000550441934
  error estimate for blocks of size 2^( 6) =       0.000556395347
  error estimate for blocks of size 2^( 7) =       0.000560877414

      target function =      -0.748688054815
              le_mean =     -22.814303951003
             les_mean =     520.938413112411
             stat err =       0.000551612904
             autocorr =       1.364627306230
   target nu stat err =       0.000551612904
   target dn stat err =       0.002946641204
      target stat err =       0.002575530148
              std dev =       0.667793805471
             le_variance =       0.445948566626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748688054815        initial  <--
     6.2500e+22     6.2500e+23             9.9328e-28        -0.748688054815
     2.5000e+23     2.5000e+24             2.4832e-28        -0.748688054815
     1.0000e+24     1.0000e+25             6.2080e-29        -0.748688054815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8381
  </log>
  <optVariables href="FORM2.s027.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2022e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.755
    reference variance = 0.506343
====================================================
  Execution time = 4.4733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4736e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457908834370
                                         uncertainty =       0.005245739302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457908834370
                                         uncertainty =       0.005245739302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478534980
  error estimate for blocks of size 2^( 2) =       0.000504099426
  error estimate for blocks of size 2^( 3) =       0.000527572115
  error estimate for blocks of size 2^( 4) =       0.000544534020
  error estimate for blocks of size 2^( 5) =       0.000555068696
  error estimate for blocks of size 2^( 6) =       0.000561381612
  error estimate for blocks of size 2^( 7) =       0.000562634926

      target function =      -0.738558494402
              le_mean =     -22.815527219734
             les_mean =     521.006273539125
             stat err =       0.000555904814
             autocorr =       1.349501870763
   target nu stat err =       0.000555904814
   target dn stat err =       0.005705323004
      target stat err =       0.004757549752
              std dev =       0.676750658430
             le_variance =       0.457991453686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281552721973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738587894658       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738587894658       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738587894658       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738587894658       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738587780534       residual = 4.19e+06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738587734569       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+23 is 3.497529e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738587894658       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738587894658       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738587894658       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738587894658       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+24 is 8.591175e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+25, overlap shift 1.0000e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738587894658       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738587894658       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738587894658       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738587894658       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738587894658       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+25 is 2.209173e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.673720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9478e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7896
    reference variance = 0.30018
====================================================
  Execution time = 4.2984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4606e-01
  Total weights = 2.0000e+06
  Execution time = 3.4782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472260032
  error estimate for blocks of size 2^( 2) =       0.000497794901
  error estimate for blocks of size 2^( 3) =       0.000521633602
  error estimate for blocks of size 2^( 4) =       0.000539687020
  error estimate for blocks of size 2^( 5) =       0.000551342195
  error estimate for blocks of size 2^( 6) =       0.000556320117
  error estimate for blocks of size 2^( 7) =       0.000561137155

      target function =      -0.748585139234
              le_mean =     -22.815145127900
             les_mean =     520.976906059117
             stat err =       0.000552121622
             autocorr =       1.366806785313
   target nu stat err =       0.000552121622
   target dn stat err =       0.002703122364
      target stat err =       0.002378276859
              std dev =       0.667876541731
             le_variance =       0.446059074995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472260032
  error estimate for blocks of size 2^( 2) =       0.000497794901
  error estimate for blocks of size 2^( 3) =       0.000521633602
  error estimate for blocks of size 2^( 4) =       0.000539687020
  error estimate for blocks of size 2^( 5) =       0.000551342195
  error estimate for blocks of size 2^( 6) =       0.000556320117
  error estimate for blocks of size 2^( 7) =       0.000561137155

      target function =      -0.748585139234
              le_mean =     -22.815145127900
             les_mean =     520.976906059117
             stat err =       0.000552121622
             autocorr =       1.366806785315
   target nu stat err =       0.000552121622
   target dn stat err =       0.002703122364
      target stat err =       0.002378276859
              std dev =       0.667876541731
             le_variance =       0.446059074995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472260032
  error estimate for blocks of size 2^( 2) =       0.000497794901
  error estimate for blocks of size 2^( 3) =       0.000521633602
  error estimate for blocks of size 2^( 4) =       0.000539687020
  error estimate for blocks of size 2^( 5) =       0.000551342195
  error estimate for blocks of size 2^( 6) =       0.000556320117
  error estimate for blocks of size 2^( 7) =       0.000561137155

      target function =      -0.748585139234
              le_mean =     -22.815145127900
             les_mean =     520.976906059117
             stat err =       0.000552121622
             autocorr =       1.366806785315
   target nu stat err =       0.000552121622
   target dn stat err =       0.002703122364
      target stat err =       0.002378276859
              std dev =       0.667876541731
             le_variance =       0.446059074995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446066269791
                                         uncertainty =       0.002622829809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472260032
  error estimate for blocks of size 2^( 2) =       0.000497794901
  error estimate for blocks of size 2^( 3) =       0.000521633602
  error estimate for blocks of size 2^( 4) =       0.000539687020
  error estimate for blocks of size 2^( 5) =       0.000551342195
  error estimate for blocks of size 2^( 6) =       0.000556320117
  error estimate for blocks of size 2^( 7) =       0.000561137155

      target function =      -0.748585139234
              le_mean =     -22.815145127900
             les_mean =     520.976906059117
             stat err =       0.000552121622
             autocorr =       1.366806785315
   target nu stat err =       0.000552121622
   target dn stat err =       0.002703122364
      target stat err =       0.002378276859
              std dev =       0.667876541731
             le_variance =       0.446059074995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748585139234        initial  <--
     6.2500e+23     6.2500e+24             3.4975e-28        -0.748585139234
     2.5000e+24     2.5000e+25             8.5912e-29        -0.748585139234
     1.0000e+25     1.0000e+26             2.2092e-29        -0.748585139234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3010
  </log>
  <optVariables href="FORM2.s028.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2279e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8238
    reference variance = 0.524164
====================================================
  Execution time = 4.3784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4773e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447525052775
                                         uncertainty =       0.002621097589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447525052775
                                         uncertainty =       0.002621097589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472981439
  error estimate for blocks of size 2^( 2) =       0.000498000920
  error estimate for blocks of size 2^( 3) =       0.000522426759
  error estimate for blocks of size 2^( 4) =       0.000539539983
  error estimate for blocks of size 2^( 5) =       0.000550380096
  error estimate for blocks of size 2^( 6) =       0.000555686776
  error estimate for blocks of size 2^( 7) =       0.000559342915

      target function =      -0.747451223318
              le_mean =     -22.813417834411
             les_mean =     520.899455947082
             stat err =       0.000551237443
             autocorr =       1.358279737556
   target nu stat err =       0.000551237443
   target dn stat err =       0.002919627989
      target stat err =       0.002541626254
              std dev =       0.668896765843
             le_variance =       0.447422883355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281341783441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747458807991       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747458807991       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747458807991       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747458807991       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+26, overlap shift 1.0000e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747458807991       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747458807991       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.674837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8564e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6965
    reference variance = 0.269668
====================================================
  Execution time = 4.3584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5555e-01
  Total weights = 2.0000e+06
  Execution time = 3.4767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477258002
  error estimate for blocks of size 2^( 2) =       0.000502411894
  error estimate for blocks of size 2^( 3) =       0.000526084823
  error estimate for blocks of size 2^( 4) =       0.000544456491
  error estimate for blocks of size 2^( 5) =       0.000555467126
  error estimate for blocks of size 2^( 6) =       0.000562934026
  error estimate for blocks of size 2^( 7) =       0.000568284639

      target function =      -0.740609483118
              le_mean =     -22.814951309667
             les_mean =     520.977553435949
             stat err =       0.000557785570
             autocorr =       1.365928958820
   target nu stat err =       0.000557785570
   target dn stat err =       0.004289635467
      target stat err =       0.003617357564
              std dev =       0.674944739404
             le_variance =       0.455550401250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477258002
  error estimate for blocks of size 2^( 2) =       0.000502411894
  error estimate for blocks of size 2^( 3) =       0.000526084823
  error estimate for blocks of size 2^( 4) =       0.000544456491
  error estimate for blocks of size 2^( 5) =       0.000555467126
  error estimate for blocks of size 2^( 6) =       0.000562934026
  error estimate for blocks of size 2^( 7) =       0.000568284639

      target function =      -0.740609483118
              le_mean =     -22.814951309667
             les_mean =     520.977553435949
             stat err =       0.000557785570
             autocorr =       1.365928958820
   target nu stat err =       0.000557785570
   target dn stat err =       0.004289635467
      target stat err =       0.003617357564
              std dev =       0.674944739404
             le_variance =       0.455550401250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477258002
  error estimate for blocks of size 2^( 2) =       0.000502411894
  error estimate for blocks of size 2^( 3) =       0.000526084823
  error estimate for blocks of size 2^( 4) =       0.000544456491
  error estimate for blocks of size 2^( 5) =       0.000555467126
  error estimate for blocks of size 2^( 6) =       0.000562934026
  error estimate for blocks of size 2^( 7) =       0.000568284639

      target function =      -0.740609483118
              le_mean =     -22.814951309667
             les_mean =     520.977553435949
             stat err =       0.000557785570
             autocorr =       1.365928958820
   target nu stat err =       0.000557785570
   target dn stat err =       0.004289635467
      target stat err =       0.003617357564
              std dev =       0.674944739404
             le_variance =       0.455550401250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455622167530
                                         uncertainty =       0.004204527154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477258002
  error estimate for blocks of size 2^( 2) =       0.000502411894
  error estimate for blocks of size 2^( 3) =       0.000526084823
  error estimate for blocks of size 2^( 4) =       0.000544456491
  error estimate for blocks of size 2^( 5) =       0.000555467126
  error estimate for blocks of size 2^( 6) =       0.000562934026
  error estimate for blocks of size 2^( 7) =       0.000568284639

      target function =      -0.740609483118
              le_mean =     -22.814951309667
             les_mean =     520.977553435949
             stat err =       0.000557785570
             autocorr =       1.365928958820
   target nu stat err =       0.000557785570
   target dn stat err =       0.004289635467
      target stat err =       0.003617357564
              std dev =       0.674944739404
             le_variance =       0.455550401250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740609483118        initial  <--
     6.2500e+24     6.2500e+25             0.0000e+00        -0.740609483118
     2.5000e+25     2.5000e+26             0.0000e+00        -0.740609483118
     1.0000e+26     1.0000e+27             0.0000e+00        -0.740609483118

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9467
  </log>
  <optVariables href="FORM2.s029.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1952e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8675
    reference variance = 0.418393
====================================================
  Execution time = 4.4970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4941e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4574e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449482997324
                                         uncertainty =       0.002704285387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449482997324
                                         uncertainty =       0.002704285387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474031318
  error estimate for blocks of size 2^( 2) =       0.000499265482
  error estimate for blocks of size 2^( 3) =       0.000523329428
  error estimate for blocks of size 2^( 4) =       0.000540683671
  error estimate for blocks of size 2^( 5) =       0.000552128716
  error estimate for blocks of size 2^( 6) =       0.000559203876
  error estimate for blocks of size 2^( 7) =       0.000562220108

      target function =      -0.745756039811
              le_mean =     -22.814758142353
             les_mean =     520.962600250599
             stat err =       0.000553559093
             autocorr =       1.363684507355
   target nu stat err =       0.000553559093
   target dn stat err =       0.002917477461
      target stat err =       0.002534479779
              std dev =       0.670381519168
             le_variance =       0.449411381242


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281475814235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745763525804       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745763525804       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745763525803       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+25 is 1.083658e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745763525804       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745763525804       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745763525803       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+26 is 2.709146e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+27, overlap shift 1.0000e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745763525804       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745763525804       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745763525803       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+27 is 6.772864e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.676207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9551e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8343
    reference variance = 0.448237
====================================================
  Execution time = 4.3150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4597e-01
  Total weights = 2.0000e+06
  Execution time = 3.4650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472211663
  error estimate for blocks of size 2^( 2) =       0.000497800109
  error estimate for blocks of size 2^( 3) =       0.000521576046
  error estimate for blocks of size 2^( 4) =       0.000539367873
  error estimate for blocks of size 2^( 5) =       0.000551468442
  error estimate for blocks of size 2^( 6) =       0.000557567693
  error estimate for blocks of size 2^( 7) =       0.000557362832

      target function =      -0.748664683157
              le_mean =     -22.814868019800
             les_mean =     520.964170248111
             stat err =       0.000551441710
             autocorr =       1.363721868962
   target nu stat err =       0.000551441710
   target dn stat err =       0.003001927916
      target stat err =       0.002623069438
              std dev =       0.667808138769
             le_variance =       0.445967710206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472211663
  error estimate for blocks of size 2^( 2) =       0.000497800109
  error estimate for blocks of size 2^( 3) =       0.000521576046
  error estimate for blocks of size 2^( 4) =       0.000539367873
  error estimate for blocks of size 2^( 5) =       0.000551468442
  error estimate for blocks of size 2^( 6) =       0.000557567693
  error estimate for blocks of size 2^( 7) =       0.000557362832

      target function =      -0.748664683157
              le_mean =     -22.814868019800
             les_mean =     520.964170248111
             stat err =       0.000551441710
             autocorr =       1.363721868962
   target nu stat err =       0.000551441710
   target dn stat err =       0.003001927916
      target stat err =       0.002623069438
              std dev =       0.667808138769
             le_variance =       0.445967710206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472211663
  error estimate for blocks of size 2^( 2) =       0.000497800109
  error estimate for blocks of size 2^( 3) =       0.000521576046
  error estimate for blocks of size 2^( 4) =       0.000539367873
  error estimate for blocks of size 2^( 5) =       0.000551468442
  error estimate for blocks of size 2^( 6) =       0.000557567693
  error estimate for blocks of size 2^( 7) =       0.000557362832

      target function =      -0.748664683157
              le_mean =     -22.814868019800
             les_mean =     520.964170248111
             stat err =       0.000551441710
             autocorr =       1.363721868962
   target nu stat err =       0.000551441710
   target dn stat err =       0.003001927916
      target stat err =       0.002623069438
              std dev =       0.667808138769
             le_variance =       0.445967710206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445973178503
                                         uncertainty =       0.002973952246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472211663
  error estimate for blocks of size 2^( 2) =       0.000497800109
  error estimate for blocks of size 2^( 3) =       0.000521576046
  error estimate for blocks of size 2^( 4) =       0.000539367873
  error estimate for blocks of size 2^( 5) =       0.000551468442
  error estimate for blocks of size 2^( 6) =       0.000557567693
  error estimate for blocks of size 2^( 7) =       0.000557362832

      target function =      -0.748664683157
              le_mean =     -22.814868019800
             les_mean =     520.964170248111
             stat err =       0.000551441710
             autocorr =       1.363721868962
   target nu stat err =       0.000551441710
   target dn stat err =       0.003001927916
      target stat err =       0.002623069438
              std dev =       0.667808138769
             le_variance =       0.445967710206


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748664683157        initial  <--
     6.2500e+25     6.2500e+26             1.0837e-30        -0.748664683157
     2.5000e+26     2.5000e+27             2.7091e-31        -0.748664683157
     1.0000e+27     1.0000e+28             6.7729e-32        -0.748664683157

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5320
  </log>
  <optVariables href="FORM2.s030.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2009e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8201
    reference variance = 0.340423
====================================================
  Execution time = 4.3578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4720e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4929e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447272148038
                                         uncertainty =       0.004449825552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447272148038
                                         uncertainty =       0.004449825552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472863353
  error estimate for blocks of size 2^( 2) =       0.000498247947
  error estimate for blocks of size 2^( 3) =       0.000522026309
  error estimate for blocks of size 2^( 4) =       0.000539599873
  error estimate for blocks of size 2^( 5) =       0.000551578297
  error estimate for blocks of size 2^( 6) =       0.000558437374
  error estimate for blocks of size 2^( 7) =       0.000562090701

      target function =      -0.747612581612
              le_mean =     -22.814650290357
             les_mean =     520.955467148981
             stat err =       0.000552926561
             autocorr =       1.367299298344
   target nu stat err =       0.000552926561
   target dn stat err =       0.004576179737
      target stat err =       0.003921560407
              std dev =       0.668729767007
             le_variance =       0.447199501281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465029036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747631874251       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747631874251       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747631874226       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+26 is 1.279250e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747631874251       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747631874251       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747631874285       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+27 is 3.198126e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+28, overlap shift 1.0000e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747631874251       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747631874251       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747631874251       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+28 is 7.995314e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.677591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0766e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7634
    reference variance = 0.444172
====================================================
  Execution time = 4.3263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4991e-01
  Total weights = 2.0000e+06
  Execution time = 3.4876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474292745
  error estimate for blocks of size 2^( 2) =       0.000499364798
  error estimate for blocks of size 2^( 3) =       0.000522824813
  error estimate for blocks of size 2^( 4) =       0.000540686711
  error estimate for blocks of size 2^( 5) =       0.000550423713
  error estimate for blocks of size 2^( 6) =       0.000557350071
  error estimate for blocks of size 2^( 7) =       0.000561590749

      target function =      -0.745321067121
              le_mean =     -22.815045989460
             les_mean =     520.976230492019
             stat err =       0.000552512811
             autocorr =       1.357037164677
   target nu stat err =       0.000552512811
   target dn stat err =       0.004655057676
      target stat err =       0.003965649259
              std dev =       0.670751232415
             le_variance =       0.449907215786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474292745
  error estimate for blocks of size 2^( 2) =       0.000499364798
  error estimate for blocks of size 2^( 3) =       0.000522824813
  error estimate for blocks of size 2^( 4) =       0.000540686711
  error estimate for blocks of size 2^( 5) =       0.000550423713
  error estimate for blocks of size 2^( 6) =       0.000557350071
  error estimate for blocks of size 2^( 7) =       0.000561590749

      target function =      -0.745321067121
              le_mean =     -22.815045989460
             les_mean =     520.976230492019
             stat err =       0.000552512811
             autocorr =       1.357037164677
   target nu stat err =       0.000552512811
   target dn stat err =       0.004655057676
      target stat err =       0.003965649259
              std dev =       0.670751232415
             le_variance =       0.449907215786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474292745
  error estimate for blocks of size 2^( 2) =       0.000499364798
  error estimate for blocks of size 2^( 3) =       0.000522824813
  error estimate for blocks of size 2^( 4) =       0.000540686711
  error estimate for blocks of size 2^( 5) =       0.000550423713
  error estimate for blocks of size 2^( 6) =       0.000557350071
  error estimate for blocks of size 2^( 7) =       0.000561590749

      target function =      -0.745321067121
              le_mean =     -22.815045989460
             les_mean =     520.976230492019
             stat err =       0.000552512811
             autocorr =       1.357037164677
   target nu stat err =       0.000552512811
   target dn stat err =       0.004655057676
      target stat err =       0.003965649259
              std dev =       0.670751232415
             le_variance =       0.449907215786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449936962167
                                         uncertainty =       0.005479169240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474292745
  error estimate for blocks of size 2^( 2) =       0.000499364798
  error estimate for blocks of size 2^( 3) =       0.000522824813
  error estimate for blocks of size 2^( 4) =       0.000540686711
  error estimate for blocks of size 2^( 5) =       0.000550423713
  error estimate for blocks of size 2^( 6) =       0.000557350071
  error estimate for blocks of size 2^( 7) =       0.000561590749

      target function =      -0.745321067121
              le_mean =     -22.815045989460
             les_mean =     520.976230492019
             stat err =       0.000552512811
             autocorr =       1.357037164677
   target nu stat err =       0.000552512811
   target dn stat err =       0.004655057676
      target stat err =       0.003965649259
              std dev =       0.670751232415
             le_variance =       0.449907215786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745321067121        initial  <--
     6.2500e+26     6.2500e+27             1.2793e-31        -0.745321067121
     2.5000e+27     2.5000e+28             3.1981e-32        -0.745321067121
     1.0000e+28     1.0000e+29             7.9953e-33        -0.745321067121

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7548
  </log>
  <optVariables href="FORM2.s031.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2153e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8841
    reference variance = 0.443414
====================================================
  Execution time = 4.3832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4776e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450774115450
                                         uncertainty =       0.003340678858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450774115450
                                         uncertainty =       0.003340678858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474711557
  error estimate for blocks of size 2^( 2) =       0.000499953215
  error estimate for blocks of size 2^( 3) =       0.000523695239
  error estimate for blocks of size 2^( 4) =       0.000541767205
  error estimate for blocks of size 2^( 5) =       0.000553212963
  error estimate for blocks of size 2^( 6) =       0.000560220018
  error estimate for blocks of size 2^( 7) =       0.000563715632

      target function =      -0.744655526282
              le_mean =     -22.815239527073
             les_mean =     520.985856576912
             stat err =       0.000554728954
             autocorr =       1.365532559426
   target nu stat err =       0.000554728954
   target dn stat err =       0.003928216551
      target stat err =       0.003358662663
              std dev =       0.671343522008
             le_variance =       0.450702124542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281523952707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744669460528       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744669460528       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744669460528       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744669460528       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+28 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+29, overlap shift 1.0000e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744669460528       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744669460528       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+29 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.678741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8614e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8174
    reference variance = 0.398363
====================================================
  Execution time = 4.7038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4691e-01
  Total weights = 2.0000e+06
  Execution time = 3.4765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472708128
  error estimate for blocks of size 2^( 2) =       0.000498458776
  error estimate for blocks of size 2^( 3) =       0.000522886891
  error estimate for blocks of size 2^( 4) =       0.000540852701
  error estimate for blocks of size 2^( 5) =       0.000552861243
  error estimate for blocks of size 2^( 6) =       0.000562379821
  error estimate for blocks of size 2^( 7) =       0.000566700676

      target function =      -0.747878318790
              le_mean =     -22.814152572697
             les_mean =     520.932463334694
             stat err =       0.000555698610
             autocorr =       1.381950483781
   target nu stat err =       0.000555698610
   target dn stat err =       0.003045217692
      target stat err =       0.002651601543
              std dev =       0.668510245127
             le_variance =       0.446905947840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472708128
  error estimate for blocks of size 2^( 2) =       0.000498458776
  error estimate for blocks of size 2^( 3) =       0.000522886891
  error estimate for blocks of size 2^( 4) =       0.000540852701
  error estimate for blocks of size 2^( 5) =       0.000552861243
  error estimate for blocks of size 2^( 6) =       0.000562379821
  error estimate for blocks of size 2^( 7) =       0.000566700676

      target function =      -0.747878318790
              le_mean =     -22.814152572697
             les_mean =     520.932463334694
             stat err =       0.000555698610
             autocorr =       1.381950483781
   target nu stat err =       0.000555698610
   target dn stat err =       0.003045217692
      target stat err =       0.002651601543
              std dev =       0.668510245127
             le_variance =       0.446905947840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472708128
  error estimate for blocks of size 2^( 2) =       0.000498458776
  error estimate for blocks of size 2^( 3) =       0.000522886891
  error estimate for blocks of size 2^( 4) =       0.000540852701
  error estimate for blocks of size 2^( 5) =       0.000552861243
  error estimate for blocks of size 2^( 6) =       0.000562379821
  error estimate for blocks of size 2^( 7) =       0.000566700676

      target function =      -0.747878318790
              le_mean =     -22.814152572697
             les_mean =     520.932463334694
             stat err =       0.000555698610
             autocorr =       1.381950483781
   target nu stat err =       0.000555698610
   target dn stat err =       0.003045217692
      target stat err =       0.002651601543
              std dev =       0.668510245127
             le_variance =       0.446905947840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446554060136
                                         uncertainty =       0.002849433895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472708128
  error estimate for blocks of size 2^( 2) =       0.000498458776
  error estimate for blocks of size 2^( 3) =       0.000522886891
  error estimate for blocks of size 2^( 4) =       0.000540852701
  error estimate for blocks of size 2^( 5) =       0.000552861243
  error estimate for blocks of size 2^( 6) =       0.000562379821
  error estimate for blocks of size 2^( 7) =       0.000566700676

      target function =      -0.747878318790
              le_mean =     -22.814152572697
             les_mean =     520.932463334694
             stat err =       0.000555698610
             autocorr =       1.381950483781
   target nu stat err =       0.000555698610
   target dn stat err =       0.003045217692
      target stat err =       0.002651601543
              std dev =       0.668510245127
             le_variance =       0.446905947840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747878318790        initial  <--
     6.2500e+27     6.2500e+28             0.0000e+00        -0.747878318790
     2.5000e+28     2.5000e+29             0.0000e+00        -0.747878318790
     1.0000e+29     1.0000e+30             0.0000e+00        -0.747878318790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4905
  </log>
  <optVariables href="FORM2.s032.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2311e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8556
    reference variance = 0.255571
====================================================
  Execution time = 4.3431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4875e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458036288515
                                         uncertainty =       0.010069434214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458036288515
                                         uncertainty =       0.010069434214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478516210
  error estimate for blocks of size 2^( 2) =       0.000503374741
  error estimate for blocks of size 2^( 3) =       0.000527238794
  error estimate for blocks of size 2^( 4) =       0.000545311948
  error estimate for blocks of size 2^( 5) =       0.000557985280
  error estimate for blocks of size 2^( 6) =       0.000566550573
  error estimate for blocks of size 2^( 7) =       0.000570667072

      target function =      -0.738535865611
              le_mean =     -22.814924091235
             les_mean =     520.978716585864
             stat err =       0.000560128718
             autocorr =       1.370194978478
   target nu stat err =       0.000560128718
   target dn stat err =       0.010412794260
      target stat err =       0.008623620657
              std dev =       0.676724113660
             le_variance =       0.457955526008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281492409124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738634350513       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738634350513       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738634350513       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738634350513       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+30, overlap shift 1.0000e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738634350513       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738634350513       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.679849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8312e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8294
    reference variance = 0.556227
====================================================
  Execution time = 4.2745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5778e-01
  Total weights = 2.0000e+06
  Execution time = 3.4713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478422218
  error estimate for blocks of size 2^( 2) =       0.000503455245
  error estimate for blocks of size 2^( 3) =       0.000527071373
  error estimate for blocks of size 2^( 4) =       0.000545642056
  error estimate for blocks of size 2^( 5) =       0.000557397583
  error estimate for blocks of size 2^( 6) =       0.000562295155
  error estimate for blocks of size 2^( 7) =       0.000570552617

      target function =      -0.738766567123
              le_mean =     -22.814650851275
             les_mean =     520.966068874125
             stat err =       0.000558971853
             autocorr =       1.365077154112
   target nu stat err =       0.000558971853
   target dn stat err =       0.005107466830
      target stat err =       0.004265211913
              std dev =       0.676591189283
             le_variance =       0.457775637416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478422218
  error estimate for blocks of size 2^( 2) =       0.000503455245
  error estimate for blocks of size 2^( 3) =       0.000527071373
  error estimate for blocks of size 2^( 4) =       0.000545642056
  error estimate for blocks of size 2^( 5) =       0.000557397583
  error estimate for blocks of size 2^( 6) =       0.000562295155
  error estimate for blocks of size 2^( 7) =       0.000570552617

      target function =      -0.738766567123
              le_mean =     -22.814650851275
             les_mean =     520.966068874125
             stat err =       0.000558971853
             autocorr =       1.365077154112
   target nu stat err =       0.000558971853
   target dn stat err =       0.005107466830
      target stat err =       0.004265211913
              std dev =       0.676591189283
             le_variance =       0.457775637416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478422218
  error estimate for blocks of size 2^( 2) =       0.000503455245
  error estimate for blocks of size 2^( 3) =       0.000527071373
  error estimate for blocks of size 2^( 4) =       0.000545642056
  error estimate for blocks of size 2^( 5) =       0.000557397583
  error estimate for blocks of size 2^( 6) =       0.000562295155
  error estimate for blocks of size 2^( 7) =       0.000570552617

      target function =      -0.738766567123
              le_mean =     -22.814650851275
             les_mean =     520.966068874125
             stat err =       0.000558971853
             autocorr =       1.365077154112
   target nu stat err =       0.000558971853
   target dn stat err =       0.005107466830
      target stat err =       0.004265211913
              std dev =       0.676591189283
             le_variance =       0.457775637416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457624928930
                                         uncertainty =       0.004782630939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478422218
  error estimate for blocks of size 2^( 2) =       0.000503455245
  error estimate for blocks of size 2^( 3) =       0.000527071373
  error estimate for blocks of size 2^( 4) =       0.000545642056
  error estimate for blocks of size 2^( 5) =       0.000557397583
  error estimate for blocks of size 2^( 6) =       0.000562295155
  error estimate for blocks of size 2^( 7) =       0.000570552617

      target function =      -0.738766567123
              le_mean =     -22.814650851275
             les_mean =     520.966068874125
             stat err =       0.000558971853
             autocorr =       1.365077154112
   target nu stat err =       0.000558971853
   target dn stat err =       0.005107466830
      target stat err =       0.004265211913
              std dev =       0.676591189283
             le_variance =       0.457775637416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738766567123        initial  <--
     6.2500e+28     6.2500e+29             0.0000e+00        -0.738766567123
     2.5000e+29     2.5000e+30             0.0000e+00        -0.738766567123
     1.0000e+30     1.0000e+31             0.0000e+00        -0.738766567123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1769
  </log>
  <optVariables href="FORM2.s033.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8382
    reference variance = 0.378255
====================================================
  Execution time = 4.3841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4729e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443366690450
                                         uncertainty =       0.003371796957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443366690450
                                         uncertainty =       0.003371796957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470803166
  error estimate for blocks of size 2^( 2) =       0.000496134474
  error estimate for blocks of size 2^( 3) =       0.000520261297
  error estimate for blocks of size 2^( 4) =       0.000537887498
  error estimate for blocks of size 2^( 5) =       0.000548978143
  error estimate for blocks of size 2^( 6) =       0.000557065468
  error estimate for blocks of size 2^( 7) =       0.000559723830

      target function =      -0.750931276499
              le_mean =     -22.814364556113
             les_mean =     520.938541119895
             stat err =       0.000550913735
             autocorr =       1.369267973128
   target nu stat err =       0.000550913735
   target dn stat err =       0.002806149432
      target stat err =       0.002474439251
              std dev =       0.665816222640
             le_variance =       0.443311242331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281436455611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750938292359       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750938292359       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750938292359       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750938292359       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+31, overlap shift 1.0000e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750938292359       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750938292359       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.680931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8577e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.762
    reference variance = 0.399035
====================================================
  Execution time = 4.3378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4936e-01
  Total weights = 2.0000e+06
  Execution time = 3.4809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474004052
  error estimate for blocks of size 2^( 2) =       0.000499496743
  error estimate for blocks of size 2^( 3) =       0.000522946151
  error estimate for blocks of size 2^( 4) =       0.000540861633
  error estimate for blocks of size 2^( 5) =       0.000551702585
  error estimate for blocks of size 2^( 6) =       0.000559672355
  error estimate for blocks of size 2^( 7) =       0.000562708940

      target function =      -0.745780041920
              le_mean =     -22.814717367348
             les_mean =     520.960688009767
             stat err =       0.000553736378
             autocorr =       1.364715120738
   target nu stat err =       0.000553736378
   target dn stat err =       0.005424176605
      target stat err =       0.004609343273
              std dev =       0.670342958849
             le_variance =       0.449359682478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474004052
  error estimate for blocks of size 2^( 2) =       0.000499496743
  error estimate for blocks of size 2^( 3) =       0.000522946151
  error estimate for blocks of size 2^( 4) =       0.000540861633
  error estimate for blocks of size 2^( 5) =       0.000551702585
  error estimate for blocks of size 2^( 6) =       0.000559672355
  error estimate for blocks of size 2^( 7) =       0.000562708940

      target function =      -0.745780041920
              le_mean =     -22.814717367348
             les_mean =     520.960688009767
             stat err =       0.000553736378
             autocorr =       1.364715120738
   target nu stat err =       0.000553736378
   target dn stat err =       0.005424176605
      target stat err =       0.004609343273
              std dev =       0.670342958849
             le_variance =       0.449359682478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474004052
  error estimate for blocks of size 2^( 2) =       0.000499496743
  error estimate for blocks of size 2^( 3) =       0.000522946151
  error estimate for blocks of size 2^( 4) =       0.000540861633
  error estimate for blocks of size 2^( 5) =       0.000551702585
  error estimate for blocks of size 2^( 6) =       0.000559672355
  error estimate for blocks of size 2^( 7) =       0.000562708940

      target function =      -0.745780041920
              le_mean =     -22.814717367348
             les_mean =     520.960688009767
             stat err =       0.000553736378
             autocorr =       1.364715120738
   target nu stat err =       0.000553736378
   target dn stat err =       0.005424176605
      target stat err =       0.004609343273
              std dev =       0.670342958849
             le_variance =       0.449359682478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449340707817
                                         uncertainty =       0.005578801889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474004052
  error estimate for blocks of size 2^( 2) =       0.000499496743
  error estimate for blocks of size 2^( 3) =       0.000522946151
  error estimate for blocks of size 2^( 4) =       0.000540861633
  error estimate for blocks of size 2^( 5) =       0.000551702585
  error estimate for blocks of size 2^( 6) =       0.000559672355
  error estimate for blocks of size 2^( 7) =       0.000562708940

      target function =      -0.745780041920
              le_mean =     -22.814717367348
             les_mean =     520.960688009767
             stat err =       0.000553736378
             autocorr =       1.364715120738
   target nu stat err =       0.000553736378
   target dn stat err =       0.005424176605
      target stat err =       0.004609343273
              std dev =       0.670342958849
             le_variance =       0.449359682478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745780041920        initial  <--
     6.2500e+29     6.2500e+30             0.0000e+00        -0.745780041920
     2.5000e+30     2.5000e+31             0.0000e+00        -0.745780041920
     1.0000e+31     1.0000e+32             0.0000e+00        -0.745780041920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7849
  </log>
  <optVariables href="FORM2.s034.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1937e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8953
    reference variance = 0.633287
====================================================
  Execution time = 4.5527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4853e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456668849879
                                         uncertainty =       0.007366934316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456668849879
                                         uncertainty =       0.007366934316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477803978
  error estimate for blocks of size 2^( 2) =       0.000503065086
  error estimate for blocks of size 2^( 3) =       0.000527108367
  error estimate for blocks of size 2^( 4) =       0.000545031882
  error estimate for blocks of size 2^( 5) =       0.000557051267
  error estimate for blocks of size 2^( 6) =       0.000563144272
  error estimate for blocks of size 2^( 7) =       0.000569047174

      target function =      -0.739711449292
              le_mean =     -22.814728009934
             les_mean =     520.968407221132
             stat err =       0.000558568649
             autocorr =       1.366638308547
   target nu stat err =       0.000558568649
   target dn stat err =       0.007767312515
      target stat err =       0.006464185052
              std dev =       0.675716865390
             le_variance =       0.456593282173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472800993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739766405478       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739766405478       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739766405478       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739766405478       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+32, overlap shift 1.0000e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739766405478       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739766405478       residual = 4.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.682028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0386e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8072
    reference variance = 0.474988
====================================================
  Execution time = 4.3402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5037e-01
  Total weights = 2.0000e+06
  Execution time = 3.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474536612
  error estimate for blocks of size 2^( 2) =       0.000499461623
  error estimate for blocks of size 2^( 3) =       0.000523554604
  error estimate for blocks of size 2^( 4) =       0.000541115623
  error estimate for blocks of size 2^( 5) =       0.000552831388
  error estimate for blocks of size 2^( 6) =       0.000560201071
  error estimate for blocks of size 2^( 7) =       0.000565877126

      target function =      -0.744944017978
              le_mean =     -22.813984158986
             les_mean =     520.928242973933
             stat err =       0.000555006302
             autocorr =       1.367906389175
   target nu stat err =       0.000555006302
   target dn stat err =       0.005372708202
      target stat err =       0.004551416915
              std dev =       0.671096112813
             le_variance =       0.450369992632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474536612
  error estimate for blocks of size 2^( 2) =       0.000499461623
  error estimate for blocks of size 2^( 3) =       0.000523554604
  error estimate for blocks of size 2^( 4) =       0.000541115623
  error estimate for blocks of size 2^( 5) =       0.000552831388
  error estimate for blocks of size 2^( 6) =       0.000560201071
  error estimate for blocks of size 2^( 7) =       0.000565877126

      target function =      -0.744944017978
              le_mean =     -22.813984158986
             les_mean =     520.928242973933
             stat err =       0.000555006302
             autocorr =       1.367906389175
   target nu stat err =       0.000555006302
   target dn stat err =       0.005372708202
      target stat err =       0.004551416915
              std dev =       0.671096112813
             le_variance =       0.450369992632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474536612
  error estimate for blocks of size 2^( 2) =       0.000499461623
  error estimate for blocks of size 2^( 3) =       0.000523554604
  error estimate for blocks of size 2^( 4) =       0.000541115623
  error estimate for blocks of size 2^( 5) =       0.000552831388
  error estimate for blocks of size 2^( 6) =       0.000560201071
  error estimate for blocks of size 2^( 7) =       0.000565877126

      target function =      -0.744944017978
              le_mean =     -22.813984158986
             les_mean =     520.928242973933
             stat err =       0.000555006302
             autocorr =       1.367906389175
   target nu stat err =       0.000555006302
   target dn stat err =       0.005372708202
      target stat err =       0.004551416915
              std dev =       0.671096112813
             le_variance =       0.450369992632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450359082151
                                         uncertainty =       0.005135409187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474536612
  error estimate for blocks of size 2^( 2) =       0.000499461623
  error estimate for blocks of size 2^( 3) =       0.000523554604
  error estimate for blocks of size 2^( 4) =       0.000541115623
  error estimate for blocks of size 2^( 5) =       0.000552831388
  error estimate for blocks of size 2^( 6) =       0.000560201071
  error estimate for blocks of size 2^( 7) =       0.000565877126

      target function =      -0.744944017978
              le_mean =     -22.813984158986
             les_mean =     520.928242973933
             stat err =       0.000555006302
             autocorr =       1.367906389175
   target nu stat err =       0.000555006302
   target dn stat err =       0.005372708202
      target stat err =       0.004551416915
              std dev =       0.671096112813
             le_variance =       0.450369992632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744944017978        initial  <--
     6.2500e+30     6.2500e+31             0.0000e+00        -0.744944017978
     2.5000e+31     2.5000e+32             0.0000e+00        -0.744944017978
     1.0000e+32     1.0000e+33             0.0000e+00        -0.744944017978

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8618
  </log>
  <optVariables href="FORM2.s035.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2125e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7298
    reference variance = 0.272563
====================================================
  Execution time = 4.3512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4689e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446960021348
                                         uncertainty =       0.003533225619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446960021348
                                         uncertainty =       0.003533225619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472702118
  error estimate for blocks of size 2^( 2) =       0.000497958932
  error estimate for blocks of size 2^( 3) =       0.000522279379
  error estimate for blocks of size 2^( 4) =       0.000540644129
  error estimate for blocks of size 2^( 5) =       0.000552765542
  error estimate for blocks of size 2^( 6) =       0.000558856715
  error estimate for blocks of size 2^( 7) =       0.000563455448

      target function =      -0.747889660065
              le_mean =     -22.813755120325
             les_mean =     520.914317051036
             stat err =       0.000553930459
             autocorr =       1.373205063131
   target nu stat err =       0.000553930459
   target dn stat err =       0.003527388902
      target stat err =       0.003047250034
              std dev =       0.668501745931
             le_variance =       0.446894584312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281375512033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747901115445       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747901115445       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747901115445       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747901115445       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+33, overlap shift 1.0000e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747901115445       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747901115445       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.683139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8440e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7954
    reference variance = 0.34146
====================================================
  Execution time = 4.3366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4347e-01
  Total weights = 2.0000e+06
  Execution time = 3.4601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470889608
  error estimate for blocks of size 2^( 2) =       0.000496443034
  error estimate for blocks of size 2^( 3) =       0.000520962302
  error estimate for blocks of size 2^( 4) =       0.000539876238
  error estimate for blocks of size 2^( 5) =       0.000551463594
  error estimate for blocks of size 2^( 6) =       0.000557879508
  error estimate for blocks of size 2^( 7) =       0.000559704423

      target function =      -0.750795548432
              le_mean =     -22.814068924748
             les_mean =     520.925214728166
             stat err =       0.000552230941
             autocorr =       1.375318416790
   target nu stat err =       0.000552230941
   target dn stat err =       0.002634533310
      target stat err =       0.002331629138
              std dev =       0.665938470702
             le_variance =       0.443474046761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470889608
  error estimate for blocks of size 2^( 2) =       0.000496443034
  error estimate for blocks of size 2^( 3) =       0.000520962302
  error estimate for blocks of size 2^( 4) =       0.000539876238
  error estimate for blocks of size 2^( 5) =       0.000551463594
  error estimate for blocks of size 2^( 6) =       0.000557879508
  error estimate for blocks of size 2^( 7) =       0.000559704423

      target function =      -0.750795548432
              le_mean =     -22.814068924748
             les_mean =     520.925214728166
             stat err =       0.000552230941
             autocorr =       1.375318416790
   target nu stat err =       0.000552230941
   target dn stat err =       0.002634533310
      target stat err =       0.002331629138
              std dev =       0.665938470702
             le_variance =       0.443474046761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470889608
  error estimate for blocks of size 2^( 2) =       0.000496443034
  error estimate for blocks of size 2^( 3) =       0.000520962302
  error estimate for blocks of size 2^( 4) =       0.000539876238
  error estimate for blocks of size 2^( 5) =       0.000551463594
  error estimate for blocks of size 2^( 6) =       0.000557879508
  error estimate for blocks of size 2^( 7) =       0.000559704423

      target function =      -0.750795548432
              le_mean =     -22.814068924748
             les_mean =     520.925214728166
             stat err =       0.000552230941
             autocorr =       1.375318416790
   target nu stat err =       0.000552230941
   target dn stat err =       0.002634533310
      target stat err =       0.002331629138
              std dev =       0.665938470702
             le_variance =       0.443474046761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443561429967
                                         uncertainty =       0.002716589971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470889608
  error estimate for blocks of size 2^( 2) =       0.000496443034
  error estimate for blocks of size 2^( 3) =       0.000520962302
  error estimate for blocks of size 2^( 4) =       0.000539876238
  error estimate for blocks of size 2^( 5) =       0.000551463594
  error estimate for blocks of size 2^( 6) =       0.000557879508
  error estimate for blocks of size 2^( 7) =       0.000559704423

      target function =      -0.750795548432
              le_mean =     -22.814068924748
             les_mean =     520.925214728166
             stat err =       0.000552230941
             autocorr =       1.375318416790
   target nu stat err =       0.000552230941
   target dn stat err =       0.002634533310
      target stat err =       0.002331629138
              std dev =       0.665938470702
             le_variance =       0.443474046761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750795548432        initial  <--
     6.2500e+31     6.2500e+32             0.0000e+00        -0.750795548432
     2.5000e+32     2.5000e+33             0.0000e+00        -0.750795548432
     1.0000e+33     1.0000e+34             0.0000e+00        -0.750795548432

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7824
  </log>
  <optVariables href="FORM2.s036.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1923e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7376
    reference variance = 0.453839
====================================================
  Execution time = 4.3927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4790e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450855667467
                                         uncertainty =       0.005661415672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450855667467
                                         uncertainty =       0.005661415672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474939632
  error estimate for blocks of size 2^( 2) =       0.000500094355
  error estimate for blocks of size 2^( 3) =       0.000523710483
  error estimate for blocks of size 2^( 4) =       0.000541702370
  error estimate for blocks of size 2^( 5) =       0.000554142482
  error estimate for blocks of size 2^( 6) =       0.000561709279
  error estimate for blocks of size 2^( 7) =       0.000565743248

      target function =      -0.744282508924
              le_mean =     -22.815000712627
             les_mean =     520.975392599292
             stat err =       0.000555824345
             autocorr =       1.369614380230
   target nu stat err =       0.000555824345
   target dn stat err =       0.005457092684
      target stat err =       0.004620669454
              std dev =       0.671666068591
             le_variance =       0.451135307697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500071263e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744310362128       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744310362128       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744310362128       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744310349226       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+32 is 2.421237e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744310362128       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744310362128       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744310362128       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744310379028       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744310379028       residual = 4.92e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+33 is 6.053093e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+34, overlap shift 1.0000e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744310362128       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744310362128       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744310362128       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744310379028       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750000000000       residual = 4.25e+08           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+34 is 1.355854e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.684993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8725e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8033
    reference variance = 0.496214
====================================================
  Execution time = 4.4767e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4830e-01
  Total weights = 2.0000e+06
  Execution time = 3.4681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473446167
  error estimate for blocks of size 2^( 2) =       0.000498782419
  error estimate for blocks of size 2^( 3) =       0.000522828383
  error estimate for blocks of size 2^( 4) =       0.000540834327
  error estimate for blocks of size 2^( 5) =       0.000552333230
  error estimate for blocks of size 2^( 6) =       0.000557803527
  error estimate for blocks of size 2^( 7) =       0.000561952695

      target function =      -0.746678459593
              le_mean =     -22.814280516961
             les_mean =     520.939697828916
             stat err =       0.000553230945
             autocorr =       1.365437160431
   target nu stat err =       0.000553230945
   target dn stat err =       0.005395989290
      target stat err =       0.004593664164
              std dev =       0.669553990729
             le_variance =       0.448302546501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473446167
  error estimate for blocks of size 2^( 2) =       0.000498782419
  error estimate for blocks of size 2^( 3) =       0.000522828383
  error estimate for blocks of size 2^( 4) =       0.000540834327
  error estimate for blocks of size 2^( 5) =       0.000552333230
  error estimate for blocks of size 2^( 6) =       0.000557803527
  error estimate for blocks of size 2^( 7) =       0.000561952695

      target function =      -0.746678459593
              le_mean =     -22.814280516961
             les_mean =     520.939697828916
             stat err =       0.000553230945
             autocorr =       1.365437160431
   target nu stat err =       0.000553230945
   target dn stat err =       0.005395989290
      target stat err =       0.004593664164
              std dev =       0.669553990729
             le_variance =       0.448302546501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473446167
  error estimate for blocks of size 2^( 2) =       0.000498782419
  error estimate for blocks of size 2^( 3) =       0.000522828383
  error estimate for blocks of size 2^( 4) =       0.000540834327
  error estimate for blocks of size 2^( 5) =       0.000552333230
  error estimate for blocks of size 2^( 6) =       0.000557803527
  error estimate for blocks of size 2^( 7) =       0.000561952695

      target function =      -0.746678459593
              le_mean =     -22.814280516961
             les_mean =     520.939697828916
             stat err =       0.000553230945
             autocorr =       1.365437160431
   target nu stat err =       0.000553230945
   target dn stat err =       0.005395989290
      target stat err =       0.004593664164
              std dev =       0.669553990729
             le_variance =       0.448302546501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448323736476
                                         uncertainty =       0.005215609475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473446167
  error estimate for blocks of size 2^( 2) =       0.000498782419
  error estimate for blocks of size 2^( 3) =       0.000522828383
  error estimate for blocks of size 2^( 4) =       0.000540834327
  error estimate for blocks of size 2^( 5) =       0.000552333230
  error estimate for blocks of size 2^( 6) =       0.000557803527
  error estimate for blocks of size 2^( 7) =       0.000561952695

      target function =      -0.746678459593
              le_mean =     -22.814280516961
             les_mean =     520.939697828916
             stat err =       0.000553230945
             autocorr =       1.365437160431
   target nu stat err =       0.000553230945
   target dn stat err =       0.005395989290
      target stat err =       0.004593664164
              std dev =       0.669553990729
             le_variance =       0.448302546501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746678459593        initial  <--
     6.2500e+32     6.2500e+33             2.4212e-37        -0.746678459593
     2.5000e+33     2.5000e+34             6.0531e-38        -0.746678459593
     1.0000e+34     1.0000e+35             1.3559e-38        -0.746678459593

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1301
  </log>
  <optVariables href="FORM2.s037.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2086e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8321
    reference variance = 0.432416
====================================================
  Execution time = 4.3690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5699e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4599e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457081840197
                                         uncertainty =       0.006470583827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457081840197
                                         uncertainty =       0.006470583827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478011600
  error estimate for blocks of size 2^( 2) =       0.000503610590
  error estimate for blocks of size 2^( 3) =       0.000527752249
  error estimate for blocks of size 2^( 4) =       0.000545171352
  error estimate for blocks of size 2^( 5) =       0.000556427202
  error estimate for blocks of size 2^( 6) =       0.000564204189
  error estimate for blocks of size 2^( 7) =       0.000567357088

      target function =      -0.739399519672
              le_mean =     -22.814715307955
             les_mean =     520.968224534784
             stat err =       0.000558289958
             autocorr =       1.364089165622
   target nu stat err =       0.000558289958
   target dn stat err =       0.006474877900
      target stat err =       0.005394865661
              std dev =       0.676010488252
             le_variance =       0.456990180227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281471530796e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739438093866       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739438093866       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+34, overlap shift 2.5000e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739438093866       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739438093866       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+35, overlap shift 1.0000e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739438093866       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739438093866       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.686089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8296e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8487
    reference variance = 0.318551
====================================================
  Execution time = 4.3028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4409e-01
  Total weights = 2.0000e+06
  Execution time = 3.4625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471214723
  error estimate for blocks of size 2^( 2) =       0.000496248444
  error estimate for blocks of size 2^( 3) =       0.000520177600
  error estimate for blocks of size 2^( 4) =       0.000536560680
  error estimate for blocks of size 2^( 5) =       0.000548293452
  error estimate for blocks of size 2^( 6) =       0.000554832755
  error estimate for blocks of size 2^( 7) =       0.000558422991

      target function =      -0.750271413727
              le_mean =     -22.814289240412
             les_mean =     520.935879953541
             stat err =       0.000549527470
             autocorr =       1.360006895706
   target nu stat err =       0.000549527470
   target dn stat err =       0.002712763818
      target stat err =       0.002392693196
              std dev =       0.666398252113
             le_variance =       0.444086630419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471214723
  error estimate for blocks of size 2^( 2) =       0.000496248444
  error estimate for blocks of size 2^( 3) =       0.000520177600
  error estimate for blocks of size 2^( 4) =       0.000536560680
  error estimate for blocks of size 2^( 5) =       0.000548293452
  error estimate for blocks of size 2^( 6) =       0.000554832755
  error estimate for blocks of size 2^( 7) =       0.000558422991

      target function =      -0.750271413727
              le_mean =     -22.814289240412
             les_mean =     520.935879953541
             stat err =       0.000549527470
             autocorr =       1.360006895706
   target nu stat err =       0.000549527470
   target dn stat err =       0.002712763818
      target stat err =       0.002392693196
              std dev =       0.666398252113
             le_variance =       0.444086630419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471214723
  error estimate for blocks of size 2^( 2) =       0.000496248444
  error estimate for blocks of size 2^( 3) =       0.000520177600
  error estimate for blocks of size 2^( 4) =       0.000536560680
  error estimate for blocks of size 2^( 5) =       0.000548293452
  error estimate for blocks of size 2^( 6) =       0.000554832755
  error estimate for blocks of size 2^( 7) =       0.000558422991

      target function =      -0.750271413727
              le_mean =     -22.814289240412
             les_mean =     520.935879953541
             stat err =       0.000549527470
             autocorr =       1.360006895706
   target nu stat err =       0.000549527470
   target dn stat err =       0.002712763818
      target stat err =       0.002392693196
              std dev =       0.666398252113
             le_variance =       0.444086630419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444226551887
                                         uncertainty =       0.002740913112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471214723
  error estimate for blocks of size 2^( 2) =       0.000496248444
  error estimate for blocks of size 2^( 3) =       0.000520177600
  error estimate for blocks of size 2^( 4) =       0.000536560680
  error estimate for blocks of size 2^( 5) =       0.000548293452
  error estimate for blocks of size 2^( 6) =       0.000554832755
  error estimate for blocks of size 2^( 7) =       0.000558422991

      target function =      -0.750271413727
              le_mean =     -22.814289240412
             les_mean =     520.935879953541
             stat err =       0.000549527470
             autocorr =       1.360006895706
   target nu stat err =       0.000549527470
   target dn stat err =       0.002712763818
      target stat err =       0.002392693196
              std dev =       0.666398252113
             le_variance =       0.444086630419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750271413727        initial  <--
     6.2500e+33     6.2500e+34             0.0000e+00        -0.750271413727
     2.5000e+34     2.5000e+35             0.0000e+00        -0.750271413727
     1.0000e+35     1.0000e+36             0.0000e+00        -0.750271413727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5068
  </log>
  <optVariables href="FORM2.s038.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8468
    reference variance = 0.449216
====================================================
  Execution time = 4.3799e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4648e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4583e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446583638511
                                         uncertainty =       0.003255039389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446583638511
                                         uncertainty =       0.003255039389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472485252
  error estimate for blocks of size 2^( 2) =       0.000497304286
  error estimate for blocks of size 2^( 3) =       0.000520440715
  error estimate for blocks of size 2^( 4) =       0.000539034010
  error estimate for blocks of size 2^( 5) =       0.000552435646
  error estimate for blocks of size 2^( 6) =       0.000561216876
  error estimate for blocks of size 2^( 7) =       0.000566500129

      target function =      -0.748231330126
              le_mean =     -22.814533418066
             les_mean =     520.949419486600
             stat err =       0.000554796665
             autocorr =       1.378767921284
   target nu stat err =       0.000554796665
   target dn stat err =       0.002865009977
      target stat err =       0.002507239180
              std dev =       0.668195050711
             le_variance =       0.446484625795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281453341807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748238625385       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748238625385       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748238563538       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+34 is 1.021549e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+35, overlap shift 2.5000e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748238625385       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748238625385       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748238563538       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+35 is 2.553873e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+36, overlap shift 1.0000e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748238625385       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748238625385       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748239517212       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+36 is 6.384682e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.687449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8392e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7858
    reference variance = 0.261902
====================================================
  Execution time = 4.3011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4669e-01
  Total weights = 2.0000e+06
  Execution time = 3.4680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472592370
  error estimate for blocks of size 2^( 2) =       0.000497907966
  error estimate for blocks of size 2^( 3) =       0.000521451754
  error estimate for blocks of size 2^( 4) =       0.000538806730
  error estimate for blocks of size 2^( 5) =       0.000549788396
  error estimate for blocks of size 2^( 6) =       0.000556323487
  error estimate for blocks of size 2^( 7) =       0.000560735984

      target function =      -0.748037593195
              le_mean =     -22.816068093141
             les_mean =     521.019650103923
             stat err =       0.000551413649
             autocorr =       1.361387041434
   target nu stat err =       0.000551413649
   target dn stat err =       0.002930136952
      target stat err =       0.002564427209
              std dev =       0.668346539168
             le_variance =       0.446687096418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472592370
  error estimate for blocks of size 2^( 2) =       0.000497907966
  error estimate for blocks of size 2^( 3) =       0.000521451754
  error estimate for blocks of size 2^( 4) =       0.000538806730
  error estimate for blocks of size 2^( 5) =       0.000549788396
  error estimate for blocks of size 2^( 6) =       0.000556323487
  error estimate for blocks of size 2^( 7) =       0.000560735984

      target function =      -0.748037593195
              le_mean =     -22.816068093141
             les_mean =     521.019650103923
             stat err =       0.000551413649
             autocorr =       1.361387041434
   target nu stat err =       0.000551413649
   target dn stat err =       0.002930136952
      target stat err =       0.002564427209
              std dev =       0.668346539168
             le_variance =       0.446687096418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472592370
  error estimate for blocks of size 2^( 2) =       0.000497907966
  error estimate for blocks of size 2^( 3) =       0.000521451754
  error estimate for blocks of size 2^( 4) =       0.000538806730
  error estimate for blocks of size 2^( 5) =       0.000549788396
  error estimate for blocks of size 2^( 6) =       0.000556323487
  error estimate for blocks of size 2^( 7) =       0.000560735984

      target function =      -0.748037593195
              le_mean =     -22.816068093141
             les_mean =     521.019650103923
             stat err =       0.000551413649
             autocorr =       1.361387041434
   target nu stat err =       0.000551413649
   target dn stat err =       0.002930136952
      target stat err =       0.002564427209
              std dev =       0.668346539168
             le_variance =       0.446687096418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446786120481
                                         uncertainty =       0.002854849654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472592370
  error estimate for blocks of size 2^( 2) =       0.000497907966
  error estimate for blocks of size 2^( 3) =       0.000521451754
  error estimate for blocks of size 2^( 4) =       0.000538806730
  error estimate for blocks of size 2^( 5) =       0.000549788396
  error estimate for blocks of size 2^( 6) =       0.000556323487
  error estimate for blocks of size 2^( 7) =       0.000560735984

      target function =      -0.748037593195
              le_mean =     -22.816068093141
             les_mean =     521.019650103923
             stat err =       0.000551413649
             autocorr =       1.361387041434
   target nu stat err =       0.000551413649
   target dn stat err =       0.002930136952
      target stat err =       0.002564427209
              std dev =       0.668346539168
             le_variance =       0.446687096418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748037593195        initial  <--
     6.2500e+34     6.2500e+35             1.0215e-39        -0.748037593195
     2.5000e+35     2.5000e+36             2.5539e-40        -0.748037593195
     1.0000e+36     1.0000e+37             6.3847e-41        -0.748037593195

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4026
  </log>
  <optVariables href="FORM2.s039.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1880e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8231
    reference variance = 0.511507
====================================================
  Execution time = 4.5151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5093e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4829e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450826336858
                                         uncertainty =       0.003987624618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450826336858
                                         uncertainty =       0.003987624618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474831375
  error estimate for blocks of size 2^( 2) =       0.000500109156
  error estimate for blocks of size 2^( 3) =       0.000523283822
  error estimate for blocks of size 2^( 4) =       0.000540981274
  error estimate for blocks of size 2^( 5) =       0.000551403501
  error estimate for blocks of size 2^( 6) =       0.000557554808
  error estimate for blocks of size 2^( 7) =       0.000565232008

      target function =      -0.744443900749
              le_mean =     -22.816255796096
             les_mean =     521.032457997544
             stat err =       0.000553792898
             autocorr =       1.360241269253
   target nu stat err =       0.000553792898
   target dn stat err =       0.003877958630
      target stat err =       0.003320253690
              std dev =       0.671512970929
             le_variance =       0.450929670126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281625579610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744457842705       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744457842705       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+36, overlap shift 2.5000e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744457842705       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744457842705       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+37, overlap shift 1.0000e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744457842705       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744457842705       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.688583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9987e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8172
    reference variance = 0.395638
====================================================
  Execution time = 4.3034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4326e-01
  Total weights = 2.0000e+06
  Execution time = 3.4762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470778708
  error estimate for blocks of size 2^( 2) =       0.000496524898
  error estimate for blocks of size 2^( 3) =       0.000520293710
  error estimate for blocks of size 2^( 4) =       0.000537953036
  error estimate for blocks of size 2^( 5) =       0.000549003511
  error estimate for blocks of size 2^( 6) =       0.000556920642
  error estimate for blocks of size 2^( 7) =       0.000557912159

      target function =      -0.750969758605
              le_mean =     -22.814440388093
             les_mean =     520.941955184169
             stat err =       0.000550447337
             autocorr =       1.367092575000
   target nu stat err =       0.000550447337
   target dn stat err =       0.002832422239
      target stat err =       0.002496532654
              std dev =       0.665781633842
             le_variance =       0.443265183962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470778708
  error estimate for blocks of size 2^( 2) =       0.000496524898
  error estimate for blocks of size 2^( 3) =       0.000520293710
  error estimate for blocks of size 2^( 4) =       0.000537953036
  error estimate for blocks of size 2^( 5) =       0.000549003511
  error estimate for blocks of size 2^( 6) =       0.000556920642
  error estimate for blocks of size 2^( 7) =       0.000557912159

      target function =      -0.750969758605
              le_mean =     -22.814440388093
             les_mean =     520.941955184169
             stat err =       0.000550447337
             autocorr =       1.367092575000
   target nu stat err =       0.000550447337
   target dn stat err =       0.002832422239
      target stat err =       0.002496532654
              std dev =       0.665781633842
             le_variance =       0.443265183962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470778708
  error estimate for blocks of size 2^( 2) =       0.000496524898
  error estimate for blocks of size 2^( 3) =       0.000520293710
  error estimate for blocks of size 2^( 4) =       0.000537953036
  error estimate for blocks of size 2^( 5) =       0.000549003511
  error estimate for blocks of size 2^( 6) =       0.000556920642
  error estimate for blocks of size 2^( 7) =       0.000557912159

      target function =      -0.750969758605
              le_mean =     -22.814440388093
             les_mean =     520.941955184169
             stat err =       0.000550447337
             autocorr =       1.367092575000
   target nu stat err =       0.000550447337
   target dn stat err =       0.002832422239
      target stat err =       0.002496532654
              std dev =       0.665781633842
             le_variance =       0.443265183962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443347177053
                                         uncertainty =       0.002587276076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470778708
  error estimate for blocks of size 2^( 2) =       0.000496524898
  error estimate for blocks of size 2^( 3) =       0.000520293710
  error estimate for blocks of size 2^( 4) =       0.000537953036
  error estimate for blocks of size 2^( 5) =       0.000549003511
  error estimate for blocks of size 2^( 6) =       0.000556920642
  error estimate for blocks of size 2^( 7) =       0.000557912159

      target function =      -0.750969758605
              le_mean =     -22.814440388093
             les_mean =     520.941955184169
             stat err =       0.000550447337
             autocorr =       1.367092575000
   target nu stat err =       0.000550447337
   target dn stat err =       0.002832422239
      target stat err =       0.002496532654
              std dev =       0.665781633842
             le_variance =       0.443265183962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750969758605        initial  <--
     6.2500e+35     6.2500e+36             0.0000e+00        -0.750969758605
     2.5000e+36     2.5000e+37             0.0000e+00        -0.750969758605
     1.0000e+37     1.0000e+38             0.0000e+00        -0.750969758605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4881
  </log>
  <optVariables href="FORM2.s040.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2048e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6912
    reference variance = 0.310828
====================================================
  Execution time = 4.3899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4951e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5080e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449560079579
                                         uncertainty =       0.003191612958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449560079579
                                         uncertainty =       0.003191612958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474084637
  error estimate for blocks of size 2^( 2) =       0.000499326164
  error estimate for blocks of size 2^( 3) =       0.000523330379
  error estimate for blocks of size 2^( 4) =       0.000541672971
  error estimate for blocks of size 2^( 5) =       0.000554176181
  error estimate for blocks of size 2^( 6) =       0.000561774964
  error estimate for blocks of size 2^( 7) =       0.000564206771

      target function =      -0.745674209459
              le_mean =     -22.814486621530
             les_mean =     520.950312065536
             stat err =       0.000555457722
             autocorr =       1.372746208405
   target nu stat err =       0.000555457722
   target dn stat err =       0.003125590886
      target stat err =       0.002703437668
              std dev =       0.670456923535
             le_variance =       0.449512486316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448662153e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+36, overlap shift 6.2500e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745682890778       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745682890778       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+37, overlap shift 2.5000e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745682890778       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745682890778       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+38, overlap shift 1.0000e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745682890778       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745682890778       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.689689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8986e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7453
    reference variance = 0.305161
====================================================
  Execution time = 4.3095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0413e-01
  Total weights = 2.0000e+06
  Execution time = 3.4740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502062451
  error estimate for blocks of size 2^( 2) =       0.000526479289
  error estimate for blocks of size 2^( 3) =       0.000549547284
  error estimate for blocks of size 2^( 4) =       0.000565681375
  error estimate for blocks of size 2^( 5) =       0.000577414306
  error estimate for blocks of size 2^( 6) =       0.000583824457
  error estimate for blocks of size 2^( 7) =       0.000590310371

      target function =      -0.700017753116
              le_mean =     -22.814574995281
             les_mean =     521.008965372257
             stat err =       0.000579307627
             autocorr =       1.331383006484
   target nu stat err =       0.000579307627
   target dn stat err =       0.054638803122
      target stat err =       0.040661117554
              std dev =       0.710023527106
             le_variance =       0.504133409044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502062451
  error estimate for blocks of size 2^( 2) =       0.000526479289
  error estimate for blocks of size 2^( 3) =       0.000549547284
  error estimate for blocks of size 2^( 4) =       0.000565681375
  error estimate for blocks of size 2^( 5) =       0.000577414306
  error estimate for blocks of size 2^( 6) =       0.000583824457
  error estimate for blocks of size 2^( 7) =       0.000590310371

      target function =      -0.700017753116
              le_mean =     -22.814574995281
             les_mean =     521.008965372257
             stat err =       0.000579307627
             autocorr =       1.331383006484
   target nu stat err =       0.000579307627
   target dn stat err =       0.054638803122
      target stat err =       0.040661117554
              std dev =       0.710023527106
             le_variance =       0.504133409044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502062451
  error estimate for blocks of size 2^( 2) =       0.000526479289
  error estimate for blocks of size 2^( 3) =       0.000549547284
  error estimate for blocks of size 2^( 4) =       0.000565681375
  error estimate for blocks of size 2^( 5) =       0.000577414306
  error estimate for blocks of size 2^( 6) =       0.000583824457
  error estimate for blocks of size 2^( 7) =       0.000590310371

      target function =      -0.700017753116
              le_mean =     -22.814574995281
             les_mean =     521.008965372257
             stat err =       0.000579307627
             autocorr =       1.331383006484
   target nu stat err =       0.000579307627
   target dn stat err =       0.054638803122
      target stat err =       0.040661117554
              std dev =       0.710023527106
             le_variance =       0.504133409044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504266892136
                                         uncertainty =       0.054911753240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502062451
  error estimate for blocks of size 2^( 2) =       0.000526479289
  error estimate for blocks of size 2^( 3) =       0.000549547284
  error estimate for blocks of size 2^( 4) =       0.000565681375
  error estimate for blocks of size 2^( 5) =       0.000577414306
  error estimate for blocks of size 2^( 6) =       0.000583824457
  error estimate for blocks of size 2^( 7) =       0.000590310371

      target function =      -0.700017753116
              le_mean =     -22.814574995281
             les_mean =     521.008965372257
             stat err =       0.000579307627
             autocorr =       1.331383006484
   target nu stat err =       0.000579307627
   target dn stat err =       0.054638803122
      target stat err =       0.040661117554
              std dev =       0.710023527106
             le_variance =       0.504133409044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.700017753116        initial  <--
     6.2500e+36     6.2500e+37             0.0000e+00        -0.700017753116
     2.5000e+37     2.5000e+38             0.0000e+00        -0.700017753116
     1.0000e+38     1.0000e+39             0.0000e+00        -0.700017753116

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5164
  </log>
  <optVariables href="FORM2.s041.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1953e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8122
    reference variance = 0.426774
====================================================
  Execution time = 4.3247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5286e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4715e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452872650417
                                         uncertainty =       0.004676590561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452872650417
                                         uncertainty =       0.004676590561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475844973
  error estimate for blocks of size 2^( 2) =       0.000501272543
  error estimate for blocks of size 2^( 3) =       0.000525021682
  error estimate for blocks of size 2^( 4) =       0.000543199608
  error estimate for blocks of size 2^( 5) =       0.000554003781
  error estimate for blocks of size 2^( 6) =       0.000558308324
  error estimate for blocks of size 2^( 7) =       0.000559269027

      target function =      -0.742858000695
              le_mean =     -22.814696717938
             les_mean =     520.963242981184
             stat err =       0.000553695185
             autocorr =       1.353974618201
   target nu stat err =       0.000553695185
   target dn stat err =       0.004366875304
      target stat err =       0.003700420823
              std dev =       0.672946414013
             le_variance =       0.452856876133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281469671794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+37, overlap shift 6.2500e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742875245373       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742875245373       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+38, overlap shift 2.5000e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742875245373       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742875245373       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+39, overlap shift 1.0000e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742875245373       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742875245373       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.690789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7969e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7515
    reference variance = 0.340416
====================================================
  Execution time = 4.5458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4734e-01
  Total weights = 2.0000e+06
  Execution time = 3.4760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472939768
  error estimate for blocks of size 2^( 2) =       0.000498420993
  error estimate for blocks of size 2^( 3) =       0.000522585898
  error estimate for blocks of size 2^( 4) =       0.000540588242
  error estimate for blocks of size 2^( 5) =       0.000553173432
  error estimate for blocks of size 2^( 6) =       0.000560552221
  error estimate for blocks of size 2^( 7) =       0.000562739261

      target function =      -0.747513419858
              le_mean =     -22.813565428977
             les_mean =     520.906111406657
             stat err =       0.000554263289
             autocorr =       1.373474376115
   target nu stat err =       0.000554263289
   target dn stat err =       0.003326254712
      target stat err =       0.002877465218
              std dev =       0.668837833933
             le_variance =       0.447344048100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472939768
  error estimate for blocks of size 2^( 2) =       0.000498420993
  error estimate for blocks of size 2^( 3) =       0.000522585898
  error estimate for blocks of size 2^( 4) =       0.000540588242
  error estimate for blocks of size 2^( 5) =       0.000553173432
  error estimate for blocks of size 2^( 6) =       0.000560552221
  error estimate for blocks of size 2^( 7) =       0.000562739261

      target function =      -0.747513419858
              le_mean =     -22.813565428977
             les_mean =     520.906111406657
             stat err =       0.000554263289
             autocorr =       1.373474376116
   target nu stat err =       0.000554263289
   target dn stat err =       0.003326254712
      target stat err =       0.002877465218
              std dev =       0.668837833933
             le_variance =       0.447344048100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472939768
  error estimate for blocks of size 2^( 2) =       0.000498420993
  error estimate for blocks of size 2^( 3) =       0.000522585898
  error estimate for blocks of size 2^( 4) =       0.000540588242
  error estimate for blocks of size 2^( 5) =       0.000553173432
  error estimate for blocks of size 2^( 6) =       0.000560552221
  error estimate for blocks of size 2^( 7) =       0.000562739261

      target function =      -0.747513419858
              le_mean =     -22.813565428977
             les_mean =     520.906111406657
             stat err =       0.000554263289
             autocorr =       1.373474376116
   target nu stat err =       0.000554263289
   target dn stat err =       0.003326254712
      target stat err =       0.002877465218
              std dev =       0.668837833933
             le_variance =       0.447344048100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447478327799
                                         uncertainty =       0.003196184907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472939768
  error estimate for blocks of size 2^( 2) =       0.000498420993
  error estimate for blocks of size 2^( 3) =       0.000522585898
  error estimate for blocks of size 2^( 4) =       0.000540588242
  error estimate for blocks of size 2^( 5) =       0.000553173432
  error estimate for blocks of size 2^( 6) =       0.000560552221
  error estimate for blocks of size 2^( 7) =       0.000562739261

      target function =      -0.747513419858
              le_mean =     -22.813565428977
             les_mean =     520.906111406657
             stat err =       0.000554263289
             autocorr =       1.373474376116
   target nu stat err =       0.000554263289
   target dn stat err =       0.003326254712
      target stat err =       0.002877465218
              std dev =       0.668837833933
             le_variance =       0.447344048100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747513419858        initial  <--
     6.2500e+37     6.2500e+38             0.0000e+00        -0.747513419858
     2.5000e+38     2.5000e+39             0.0000e+00        -0.747513419858
     1.0000e+39     1.0000e+40             0.0000e+00        -0.747513419858

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8276
  </log>
  <optVariables href="FORM2.s042.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2080e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8032
    reference variance = 0.286603
====================================================
  Execution time = 4.4361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4633e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4758e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446354798150
                                         uncertainty =       0.003335303255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446354798150
                                         uncertainty =       0.003335303255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472406025
  error estimate for blocks of size 2^( 2) =       0.000498070735
  error estimate for blocks of size 2^( 3) =       0.000522386400
  error estimate for blocks of size 2^( 4) =       0.000541418398
  error estimate for blocks of size 2^( 5) =       0.000552376095
  error estimate for blocks of size 2^( 6) =       0.000560163737
  error estimate for blocks of size 2^( 7) =       0.000562133150

      target function =      -0.748353702001
              le_mean =     -22.814740555901
             les_mean =     520.958721315521
             stat err =       0.000554022845
             autocorr =       1.375385653670
   target nu stat err =       0.000554022845
   target dn stat err =       0.003172969719
      target stat err =       0.002762151325
              std dev =       0.668083008033
             le_variance =       0.446334905623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281474055590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+38, overlap shift 6.2500e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748362892086       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748362892086       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+38 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+39, overlap shift 2.5000e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748362892086       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748362892086       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+39 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+40, overlap shift 1.0000e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748362892086       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748362892086       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+40 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.691854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9125e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7174
    reference variance = 0.243006
====================================================
  Execution time = 4.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5141e-01
  Total weights = 2.0000e+06
  Execution time = 3.5834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475086187
  error estimate for blocks of size 2^( 2) =       0.000500600233
  error estimate for blocks of size 2^( 3) =       0.000525026655
  error estimate for blocks of size 2^( 4) =       0.000542925021
  error estimate for blocks of size 2^( 5) =       0.000556367727
  error estimate for blocks of size 2^( 6) =       0.000563446694
  error estimate for blocks of size 2^( 7) =       0.000567050094

      target function =      -0.744065230368
              le_mean =     -22.814833685080
             les_mean =     520.968049621960
             stat err =       0.000557447384
             autocorr =       1.376774953665
   target nu stat err =       0.000557447384
   target dn stat err =       0.004057397488
      target stat err =       0.003458369014
              std dev =       0.671873328693
             le_variance =       0.451413769809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475086187
  error estimate for blocks of size 2^( 2) =       0.000500600233
  error estimate for blocks of size 2^( 3) =       0.000525026655
  error estimate for blocks of size 2^( 4) =       0.000542925021
  error estimate for blocks of size 2^( 5) =       0.000556367727
  error estimate for blocks of size 2^( 6) =       0.000563446694
  error estimate for blocks of size 2^( 7) =       0.000567050094

      target function =      -0.744065230368
              le_mean =     -22.814833685080
             les_mean =     520.968049621960
             stat err =       0.000557447384
             autocorr =       1.376774953665
   target nu stat err =       0.000557447384
   target dn stat err =       0.004057397488
      target stat err =       0.003458369014
              std dev =       0.671873328693
             le_variance =       0.451413769809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475086187
  error estimate for blocks of size 2^( 2) =       0.000500600233
  error estimate for blocks of size 2^( 3) =       0.000525026655
  error estimate for blocks of size 2^( 4) =       0.000542925021
  error estimate for blocks of size 2^( 5) =       0.000556367727
  error estimate for blocks of size 2^( 6) =       0.000563446694
  error estimate for blocks of size 2^( 7) =       0.000567050094

      target function =      -0.744065230368
              le_mean =     -22.814833685080
             les_mean =     520.968049621960
             stat err =       0.000557447384
             autocorr =       1.376774953665
   target nu stat err =       0.000557447384
   target dn stat err =       0.004057397488
      target stat err =       0.003458369014
              std dev =       0.671873328693
             le_variance =       0.451413769809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451457817822
                                         uncertainty =       0.003877054446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475086187
  error estimate for blocks of size 2^( 2) =       0.000500600233
  error estimate for blocks of size 2^( 3) =       0.000525026655
  error estimate for blocks of size 2^( 4) =       0.000542925021
  error estimate for blocks of size 2^( 5) =       0.000556367727
  error estimate for blocks of size 2^( 6) =       0.000563446694
  error estimate for blocks of size 2^( 7) =       0.000567050094

      target function =      -0.744065230368
              le_mean =     -22.814833685080
             les_mean =     520.968049621960
             stat err =       0.000557447384
             autocorr =       1.376774953665
   target nu stat err =       0.000557447384
   target dn stat err =       0.004057397488
      target stat err =       0.003458369014
              std dev =       0.671873328693
             le_variance =       0.451413769809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744065230368        initial  <--
     6.2500e+38     6.2500e+39             0.0000e+00        -0.744065230368
     2.5000e+39     2.5000e+40             0.0000e+00        -0.744065230368
     1.0000e+40     1.0000e+41             0.0000e+00        -0.744065230368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1685
  </log>
  <optVariables href="FORM2.s043.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2130e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8036
    reference variance = 0.444077
====================================================
  Execution time = 4.3858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5165e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5279e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451596854374
                                         uncertainty =       0.004590525112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451596854374
                                         uncertainty =       0.004590525112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475209360
  error estimate for blocks of size 2^( 2) =       0.000500539335
  error estimate for blocks of size 2^( 3) =       0.000524217210
  error estimate for blocks of size 2^( 4) =       0.000542005709
  error estimate for blocks of size 2^( 5) =       0.000554858696
  error estimate for blocks of size 2^( 6) =       0.000561763835
  error estimate for blocks of size 2^( 7) =       0.000563891041

      target function =      -0.743879131081
              le_mean =     -22.814048778895
             les_mean =     520.932469331675
             stat err =       0.000555629820
             autocorr =       1.367102632359
   target nu stat err =       0.000555629820
   target dn stat err =       0.004574890691
      target stat err =       0.003878881974
              std dev =       0.672047521904
             le_variance =       0.451647871697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281404877890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+39, overlap shift 6.2500e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743898635195       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743898635195       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+40, overlap shift 2.5000e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743898635195       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743898635195       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+41, overlap shift 1.0000e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743898635195       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743898635195       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.692987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9143e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7977
    reference variance = 0.316408
====================================================
  Execution time = 4.3352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4243e-01
  Total weights = 2.0000e+06
  Execution time = 3.4771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470334514
  error estimate for blocks of size 2^( 2) =       0.000495545538
  error estimate for blocks of size 2^( 3) =       0.000519906094
  error estimate for blocks of size 2^( 4) =       0.000538322570
  error estimate for blocks of size 2^( 5) =       0.000549175091
  error estimate for blocks of size 2^( 6) =       0.000556195110
  error estimate for blocks of size 2^( 7) =       0.000561356348

      target function =      -0.751682685264
              le_mean =     -22.814794052857
             les_mean =     520.957256562299
             stat err =       0.000551262280
             autocorr =       1.373734659292
   target nu stat err =       0.000551262280
   target dn stat err =       0.002525826931
      target stat err =       0.002249769674
              std dev =       0.665153447899
             le_variance =       0.442429109252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470334514
  error estimate for blocks of size 2^( 2) =       0.000495545538
  error estimate for blocks of size 2^( 3) =       0.000519906094
  error estimate for blocks of size 2^( 4) =       0.000538322570
  error estimate for blocks of size 2^( 5) =       0.000549175091
  error estimate for blocks of size 2^( 6) =       0.000556195110
  error estimate for blocks of size 2^( 7) =       0.000561356348

      target function =      -0.751682685264
              le_mean =     -22.814794052857
             les_mean =     520.957256562299
             stat err =       0.000551262280
             autocorr =       1.373734659292
   target nu stat err =       0.000551262280
   target dn stat err =       0.002525826931
      target stat err =       0.002249769674
              std dev =       0.665153447899
             le_variance =       0.442429109252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470334514
  error estimate for blocks of size 2^( 2) =       0.000495545538
  error estimate for blocks of size 2^( 3) =       0.000519906094
  error estimate for blocks of size 2^( 4) =       0.000538322570
  error estimate for blocks of size 2^( 5) =       0.000549175091
  error estimate for blocks of size 2^( 6) =       0.000556195110
  error estimate for blocks of size 2^( 7) =       0.000561356348

      target function =      -0.751682685264
              le_mean =     -22.814794052857
             les_mean =     520.957256562299
             stat err =       0.000551262280
             autocorr =       1.373734659292
   target nu stat err =       0.000551262280
   target dn stat err =       0.002525826931
      target stat err =       0.002249769674
              std dev =       0.665153447899
             le_variance =       0.442429109252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442462752205
                                         uncertainty =       0.002190272548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470334514
  error estimate for blocks of size 2^( 2) =       0.000495545538
  error estimate for blocks of size 2^( 3) =       0.000519906094
  error estimate for blocks of size 2^( 4) =       0.000538322570
  error estimate for blocks of size 2^( 5) =       0.000549175091
  error estimate for blocks of size 2^( 6) =       0.000556195110
  error estimate for blocks of size 2^( 7) =       0.000561356348

      target function =      -0.751682685264
              le_mean =     -22.814794052857
             les_mean =     520.957256562299
             stat err =       0.000551262280
             autocorr =       1.373734659292
   target nu stat err =       0.000551262280
   target dn stat err =       0.002525826931
      target stat err =       0.002249769674
              std dev =       0.665153447899
             le_variance =       0.442429109252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751682685264        initial  <--
     6.2500e+39     6.2500e+40             0.0000e+00        -0.751682685264
     2.5000e+40     2.5000e+41             0.0000e+00        -0.751682685264
     1.0000e+41     1.0000e+42             0.0000e+00        -0.751682685264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8051
  </log>
  <optVariables href="FORM2.s044.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1995e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8095
    reference variance = 0.556697
====================================================
  Execution time = 4.5761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5488e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4910e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454963370975
                                         uncertainty =       0.007740076224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454963370975
                                         uncertainty =       0.007740076224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476906000
  error estimate for blocks of size 2^( 2) =       0.000502491852
  error estimate for blocks of size 2^( 3) =       0.000526864019
  error estimate for blocks of size 2^( 4) =       0.000545486135
  error estimate for blocks of size 2^( 5) =       0.000557223602
  error estimate for blocks of size 2^( 6) =       0.000564847081
  error estimate for blocks of size 2^( 7) =       0.000567068887

      target function =      -0.741142217701
              le_mean =     -22.814237962905
             les_mean =     520.944332266848
             stat err =       0.000558656426
             autocorr =       1.372220883577
   target nu stat err =       0.000558656426
   target dn stat err =       0.007917645794
      target stat err =       0.006608669285
              std dev =       0.674446933601
             le_variance =       0.454878666243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281423796290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+40, overlap shift 6.2500e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741200674905       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741200674905       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+41, overlap shift 2.5000e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741200674905       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741200674905       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+42, overlap shift 1.0000e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741200674905       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741200674905       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.694106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0677e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7987
    reference variance = 0.324831
====================================================
  Execution time = 4.3670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5120e-01
  Total weights = 2.0000e+06
  Execution time = 3.4660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474975668
  error estimate for blocks of size 2^( 2) =       0.000500709775
  error estimate for blocks of size 2^( 3) =       0.000525128860
  error estimate for blocks of size 2^( 4) =       0.000543349270
  error estimate for blocks of size 2^( 5) =       0.000555103973
  error estimate for blocks of size 2^( 6) =       0.000560504397
  error estimate for blocks of size 2^( 7) =       0.000560806556

      target function =      -0.744238900548
              le_mean =     -22.814785477262
             les_mean =     520.965639918700
             stat err =       0.000554941049
             autocorr =       1.365057599321
   target nu stat err =       0.000554941049
   target dn stat err =       0.004442619031
      target stat err =       0.003777357470
              std dev =       0.671717031814
             le_variance =       0.451203770830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474975668
  error estimate for blocks of size 2^( 2) =       0.000500709775
  error estimate for blocks of size 2^( 3) =       0.000525128860
  error estimate for blocks of size 2^( 4) =       0.000543349270
  error estimate for blocks of size 2^( 5) =       0.000555103973
  error estimate for blocks of size 2^( 6) =       0.000560504397
  error estimate for blocks of size 2^( 7) =       0.000560806556

      target function =      -0.744238900548
              le_mean =     -22.814785477262
             les_mean =     520.965639918700
             stat err =       0.000554941049
             autocorr =       1.365057599321
   target nu stat err =       0.000554941049
   target dn stat err =       0.004442619031
      target stat err =       0.003777357470
              std dev =       0.671717031814
             le_variance =       0.451203770830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474975668
  error estimate for blocks of size 2^( 2) =       0.000500709775
  error estimate for blocks of size 2^( 3) =       0.000525128860
  error estimate for blocks of size 2^( 4) =       0.000543349270
  error estimate for blocks of size 2^( 5) =       0.000555103973
  error estimate for blocks of size 2^( 6) =       0.000560504397
  error estimate for blocks of size 2^( 7) =       0.000560806556

      target function =      -0.744238900548
              le_mean =     -22.814785477262
             les_mean =     520.965639918700
             stat err =       0.000554941049
             autocorr =       1.365057599321
   target nu stat err =       0.000554941049
   target dn stat err =       0.004442619031
      target stat err =       0.003777357470
              std dev =       0.671717031814
             le_variance =       0.451203770830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451222059498
                                         uncertainty =       0.004408730974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474975668
  error estimate for blocks of size 2^( 2) =       0.000500709775
  error estimate for blocks of size 2^( 3) =       0.000525128860
  error estimate for blocks of size 2^( 4) =       0.000543349270
  error estimate for blocks of size 2^( 5) =       0.000555103973
  error estimate for blocks of size 2^( 6) =       0.000560504397
  error estimate for blocks of size 2^( 7) =       0.000560806556

      target function =      -0.744238900548
              le_mean =     -22.814785477262
             les_mean =     520.965639918700
             stat err =       0.000554941049
             autocorr =       1.365057599321
   target nu stat err =       0.000554941049
   target dn stat err =       0.004442619031
      target stat err =       0.003777357470
              std dev =       0.671717031814
             le_variance =       0.451203770830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744238900548        initial  <--
     6.2500e+40     6.2500e+41             0.0000e+00        -0.744238900548
     2.5000e+41     2.5000e+42             0.0000e+00        -0.744238900548
     1.0000e+42     1.0000e+43             0.0000e+00        -0.744238900548

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0413
  </log>
  <optVariables href="FORM2.s045.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2172e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8155
    reference variance = 0.339626
====================================================
  Execution time = 4.4162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5786e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4903e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457958662515
                                         uncertainty =       0.007718123946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457958662515
                                         uncertainty =       0.007718123946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478465885
  error estimate for blocks of size 2^( 2) =       0.000503368270
  error estimate for blocks of size 2^( 3) =       0.000526520825
  error estimate for blocks of size 2^( 4) =       0.000543944273
  error estimate for blocks of size 2^( 5) =       0.000554469968
  error estimate for blocks of size 2^( 6) =       0.000563821889
  error estimate for blocks of size 2^( 7) =       0.000566221534

      target function =      -0.738680093871
              le_mean =     -22.814222932601
             les_mean =     520.946626996668
             stat err =       0.000557114416
             autocorr =       1.355772550359
   target nu stat err =       0.000557114416
   target dn stat err =       0.007548861597
      target stat err =       0.006261715851
              std dev =       0.676652944394
             le_variance =       0.457859207158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281422293260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+41, overlap shift 6.2500e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738732529518       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738732529518       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+42, overlap shift 2.5000e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738732529518       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738732529518       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+43, overlap shift 1.0000e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738732529518       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738732529518       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.695217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9071e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8421
    reference variance = 0.433493
====================================================
  Execution time = 4.3256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5359e-01
  Total weights = 2.0000e+06
  Execution time = 3.4736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476231779
  error estimate for blocks of size 2^( 2) =       0.000501360885
  error estimate for blocks of size 2^( 3) =       0.000524762971
  error estimate for blocks of size 2^( 4) =       0.000543355989
  error estimate for blocks of size 2^( 5) =       0.000554717651
  error estimate for blocks of size 2^( 6) =       0.000561967123
  error estimate for blocks of size 2^( 7) =       0.000562863758

      target function =      -0.742213539044
              le_mean =     -22.814292416599
             les_mean =     520.945531658750
             stat err =       0.000555726130
             autocorr =       1.361710824734
   target nu stat err =       0.000555726130
   target dn stat err =       0.007778118640
      target stat err =       0.006512157196
              std dev =       0.673493441296
             le_variance =       0.453593415469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476231779
  error estimate for blocks of size 2^( 2) =       0.000501360885
  error estimate for blocks of size 2^( 3) =       0.000524762971
  error estimate for blocks of size 2^( 4) =       0.000543355989
  error estimate for blocks of size 2^( 5) =       0.000554717651
  error estimate for blocks of size 2^( 6) =       0.000561967123
  error estimate for blocks of size 2^( 7) =       0.000562863758

      target function =      -0.742213539044
              le_mean =     -22.814292416599
             les_mean =     520.945531658750
             stat err =       0.000555726130
             autocorr =       1.361710824734
   target nu stat err =       0.000555726130
   target dn stat err =       0.007778118640
      target stat err =       0.006512157196
              std dev =       0.673493441296
             le_variance =       0.453593415469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476231779
  error estimate for blocks of size 2^( 2) =       0.000501360885
  error estimate for blocks of size 2^( 3) =       0.000524762971
  error estimate for blocks of size 2^( 4) =       0.000543355989
  error estimate for blocks of size 2^( 5) =       0.000554717651
  error estimate for blocks of size 2^( 6) =       0.000561967123
  error estimate for blocks of size 2^( 7) =       0.000562863758

      target function =      -0.742213539044
              le_mean =     -22.814292416599
             les_mean =     520.945531658750
             stat err =       0.000555726130
             autocorr =       1.361710824734
   target nu stat err =       0.000555726130
   target dn stat err =       0.007778118640
      target stat err =       0.006512157196
              std dev =       0.673493441296
             le_variance =       0.453593415469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453479291000
                                         uncertainty =       0.007733006288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476231779
  error estimate for blocks of size 2^( 2) =       0.000501360885
  error estimate for blocks of size 2^( 3) =       0.000524762971
  error estimate for blocks of size 2^( 4) =       0.000543355989
  error estimate for blocks of size 2^( 5) =       0.000554717651
  error estimate for blocks of size 2^( 6) =       0.000561967123
  error estimate for blocks of size 2^( 7) =       0.000562863758

      target function =      -0.742213539044
              le_mean =     -22.814292416599
             les_mean =     520.945531658750
             stat err =       0.000555726130
             autocorr =       1.361710824734
   target nu stat err =       0.000555726130
   target dn stat err =       0.007778118640
      target stat err =       0.006512157196
              std dev =       0.673493441296
             le_variance =       0.453593415469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742213539044        initial  <--
     6.2500e+41     6.2500e+42             0.0000e+00        -0.742213539044
     2.5000e+42     2.5000e+43             0.0000e+00        -0.742213539044
     1.0000e+43     1.0000e+44             0.0000e+00        -0.742213539044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6305
  </log>
  <optVariables href="FORM2.s046.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1971e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.846
    reference variance = 0.407857
====================================================
  Execution time = 4.4594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4807e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4865e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448091809978
                                         uncertainty =       0.003261721996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448091809978
                                         uncertainty =       0.003261721996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473321569
  error estimate for blocks of size 2^( 2) =       0.000498663545
  error estimate for blocks of size 2^( 3) =       0.000522794307
  error estimate for blocks of size 2^( 4) =       0.000540084509
  error estimate for blocks of size 2^( 5) =       0.000551195844
  error estimate for blocks of size 2^( 6) =       0.000558989921
  error estimate for blocks of size 2^( 7) =       0.000559156149

      target function =      -0.746897191687
              le_mean =     -22.814014186205
             les_mean =     520.927309679096
             stat err =       0.000552356606
             autocorr =       1.361841342087
   target nu stat err =       0.000552356606
   target dn stat err =       0.003458073106
      target stat err =       0.002982959599
              std dev =       0.669377781791
             le_variance =       0.448066614755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281401418621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+42, overlap shift 6.2500e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746908046451       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908046451       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+43, overlap shift 2.5000e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746908046451       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908046451       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+44, overlap shift 1.0000e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746908046451       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908046451       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.696334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9466e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8704
    reference variance = 0.662956
====================================================
  Execution time = 4.5428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5134e-01
  Total weights = 2.0000e+06
  Execution time = 3.4836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475045442
  error estimate for blocks of size 2^( 2) =       0.000500511947
  error estimate for blocks of size 2^( 3) =       0.000524275732
  error estimate for blocks of size 2^( 4) =       0.000542632664
  error estimate for blocks of size 2^( 5) =       0.000555139882
  error estimate for blocks of size 2^( 6) =       0.000564020991
  error estimate for blocks of size 2^( 7) =       0.000567044300

      target function =      -0.744131699745
              le_mean =     -22.814721406422
             les_mean =     520.962848971201
             stat err =       0.000557209460
             autocorr =       1.375835940422
   target nu stat err =       0.000557209460
   target dn stat err =       0.004124321958
      target stat err =       0.003513522109
              std dev =       0.671815707029
             le_variance =       0.451336344211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475045442
  error estimate for blocks of size 2^( 2) =       0.000500511947
  error estimate for blocks of size 2^( 3) =       0.000524275732
  error estimate for blocks of size 2^( 4) =       0.000542632664
  error estimate for blocks of size 2^( 5) =       0.000555139882
  error estimate for blocks of size 2^( 6) =       0.000564020991
  error estimate for blocks of size 2^( 7) =       0.000567044300

      target function =      -0.744131699745
              le_mean =     -22.814721406422
             les_mean =     520.962848971201
             stat err =       0.000557209460
             autocorr =       1.375835940422
   target nu stat err =       0.000557209460
   target dn stat err =       0.004124321958
      target stat err =       0.003513522109
              std dev =       0.671815707029
             le_variance =       0.451336344211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475045442
  error estimate for blocks of size 2^( 2) =       0.000500511947
  error estimate for blocks of size 2^( 3) =       0.000524275732
  error estimate for blocks of size 2^( 4) =       0.000542632664
  error estimate for blocks of size 2^( 5) =       0.000555139882
  error estimate for blocks of size 2^( 6) =       0.000564020991
  error estimate for blocks of size 2^( 7) =       0.000567044300

      target function =      -0.744131699745
              le_mean =     -22.814721406422
             les_mean =     520.962848971201
             stat err =       0.000557209460
             autocorr =       1.375835940422
   target nu stat err =       0.000557209460
   target dn stat err =       0.004124321958
      target stat err =       0.003513522109
              std dev =       0.671815707029
             le_variance =       0.451336344211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451270314180
                                         uncertainty =       0.004002530768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475045442
  error estimate for blocks of size 2^( 2) =       0.000500511947
  error estimate for blocks of size 2^( 3) =       0.000524275732
  error estimate for blocks of size 2^( 4) =       0.000542632664
  error estimate for blocks of size 2^( 5) =       0.000555139882
  error estimate for blocks of size 2^( 6) =       0.000564020991
  error estimate for blocks of size 2^( 7) =       0.000567044300

      target function =      -0.744131699745
              le_mean =     -22.814721406422
             les_mean =     520.962848971201
             stat err =       0.000557209460
             autocorr =       1.375835940422
   target nu stat err =       0.000557209460
   target dn stat err =       0.004124321958
      target stat err =       0.003513522109
              std dev =       0.671815707029
             le_variance =       0.451336344211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744131699745        initial  <--
     6.2500e+42     6.2500e+43             0.0000e+00        -0.744131699745
     2.5000e+43     2.5000e+44             0.0000e+00        -0.744131699745
     1.0000e+44     1.0000e+45             0.0000e+00        -0.744131699745

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.9055
  </log>
  <optVariables href="FORM2.s047.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2238e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8514
    reference variance = 0.727199
====================================================
  Execution time = 4.3805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5013e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4894e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450152898822
                                         uncertainty =       0.003299737891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450152898822
                                         uncertainty =       0.003299737891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474408642
  error estimate for blocks of size 2^( 2) =       0.000499642628
  error estimate for blocks of size 2^( 3) =       0.000523921936
  error estimate for blocks of size 2^( 4) =       0.000542519973
  error estimate for blocks of size 2^( 5) =       0.000554245864
  error estimate for blocks of size 2^( 6) =       0.000562906251
  error estimate for blocks of size 2^( 7) =       0.000564322508

      target function =      -0.745154722702
              le_mean =     -22.814548402749
             les_mean =     520.953745715059
             stat err =       0.000555998649
             autocorr =       1.373543095366
   target nu stat err =       0.000555998649
   target dn stat err =       0.003339681430
      target stat err =       0.002875455948
              std dev =       0.670915135282
             le_variance =       0.450127118750


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454840275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+43, overlap shift 6.2500e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745165054294       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745165054294       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742187500000       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+43 is 7.844746e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+44, overlap shift 2.5000e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745165054294       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745165054294       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+44 is 1.961187e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+45, overlap shift 1.0000e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745165054294       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745165054294       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+45 is 4.902967e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.697650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8706e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.9441
    reference variance = 0.426964
====================================================
  Execution time = 4.4880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5904e-01
  Total weights = 2.0000e+06
  Execution time = 3.9141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479084412
  error estimate for blocks of size 2^( 2) =       0.000504068518
  error estimate for blocks of size 2^( 3) =       0.000527806626
  error estimate for blocks of size 2^( 4) =       0.000545448103
  error estimate for blocks of size 2^( 5) =       0.000556419479
  error estimate for blocks of size 2^( 6) =       0.000561295952
  error estimate for blocks of size 2^( 7) =       0.000563971111

      target function =      -0.737669359503
              le_mean =     -22.814719925350
             les_mean =     520.970488789993
             stat err =       0.000556783661
             autocorr =       1.350668850731
   target nu stat err =       0.000556783661
   target dn stat err =       0.008413098602
      target stat err =       0.006958269160
              std dev =       0.677527672755
             le_variance =       0.459043747348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479084412
  error estimate for blocks of size 2^( 2) =       0.000504068518
  error estimate for blocks of size 2^( 3) =       0.000527806626
  error estimate for blocks of size 2^( 4) =       0.000545448103
  error estimate for blocks of size 2^( 5) =       0.000556419479
  error estimate for blocks of size 2^( 6) =       0.000561295952
  error estimate for blocks of size 2^( 7) =       0.000563971111

      target function =      -0.737669359503
              le_mean =     -22.814719925350
             les_mean =     520.970488789993
             stat err =       0.000556783661
             autocorr =       1.350668850731
   target nu stat err =       0.000556783661
   target dn stat err =       0.008413098602
      target stat err =       0.006958269160
              std dev =       0.677527672755
             le_variance =       0.459043747348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479084412
  error estimate for blocks of size 2^( 2) =       0.000504068518
  error estimate for blocks of size 2^( 3) =       0.000527806626
  error estimate for blocks of size 2^( 4) =       0.000545448103
  error estimate for blocks of size 2^( 5) =       0.000556419479
  error estimate for blocks of size 2^( 6) =       0.000561295952
  error estimate for blocks of size 2^( 7) =       0.000563971111

      target function =      -0.737669359503
              le_mean =     -22.814719925350
             les_mean =     520.970488789993
             stat err =       0.000556783661
             autocorr =       1.350668850731
   target nu stat err =       0.000556783661
   target dn stat err =       0.008413098602
      target stat err =       0.006958269160
              std dev =       0.677527672755
             le_variance =       0.459043747348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459097171731
                                         uncertainty =       0.008594806259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479084412
  error estimate for blocks of size 2^( 2) =       0.000504068518
  error estimate for blocks of size 2^( 3) =       0.000527806626
  error estimate for blocks of size 2^( 4) =       0.000545448103
  error estimate for blocks of size 2^( 5) =       0.000556419479
  error estimate for blocks of size 2^( 6) =       0.000561295952
  error estimate for blocks of size 2^( 7) =       0.000563971111

      target function =      -0.737669359503
              le_mean =     -22.814719925350
             les_mean =     520.970488789993
             stat err =       0.000556783661
             autocorr =       1.350668850731
   target nu stat err =       0.000556783661
   target dn stat err =       0.008413098602
      target stat err =       0.006958269160
              std dev =       0.677527672755
             le_variance =       0.459043747348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737669359503        initial  <--
     6.2500e+43     6.2500e+44             7.8447e-49        -0.737669359503
     2.5000e+44     2.5000e+45             1.9612e-49        -0.737669359503
     1.0000e+45     1.0000e+46             4.9030e-50        -0.737669359503

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7470
  </log>
  <optVariables href="FORM2.s048.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2146e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7916
    reference variance = 0.568881
====================================================
  Execution time = 4.3590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4535e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4674e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445368596773
                                         uncertainty =       0.002534666580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445368596773
                                         uncertainty =       0.002534666580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471883463
  error estimate for blocks of size 2^( 2) =       0.000497363672
  error estimate for blocks of size 2^( 3) =       0.000521256171
  error estimate for blocks of size 2^( 4) =       0.000539788086
  error estimate for blocks of size 2^( 5) =       0.000549430515
  error estimate for blocks of size 2^( 6) =       0.000554864724
  error estimate for blocks of size 2^( 7) =       0.000557933160

      target function =      -0.749203457836
              le_mean =     -22.813894115252
             les_mean =     520.919112484619
             stat err =       0.000550504121
             autocorr =       1.360979654766
   target nu stat err =       0.000550504121
   target dn stat err =       0.002630645091
      target stat err =       0.002317789736
              std dev =       0.667343993265
             le_variance =       0.445348005346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281389411525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+44, overlap shift 6.2500e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749209597862       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749209597862       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749206542969       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+44 is 1.264301e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+45, overlap shift 2.5000e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749209597862       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749209597862       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749209597862       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 3.21e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+45 is 5.474669e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+46, overlap shift 1.0000e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749209597862       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749209597862       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+46 is 7.901882e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.699031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8271e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7976
    reference variance = 0.459818
====================================================
  Execution time = 4.3685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4948e-01
  Total weights = 2.0000e+06
  Execution time = 3.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474069782
  error estimate for blocks of size 2^( 2) =       0.000499455930
  error estimate for blocks of size 2^( 3) =       0.000523398158
  error estimate for blocks of size 2^( 4) =       0.000541107935
  error estimate for blocks of size 2^( 5) =       0.000552541164
  error estimate for blocks of size 2^( 6) =       0.000560273515
  error estimate for blocks of size 2^( 7) =       0.000563337791

      target function =      -0.745699211807
              le_mean =     -22.814341414550
             les_mean =     520.943658270617
             stat err =       0.000554315102
             autocorr =       1.367190004492
   target nu stat err =       0.000554315102
   target dn stat err =       0.003305125940
      target stat err =       0.002849874301
              std dev =       0.670435914676
             le_variance =       0.449484315688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474069782
  error estimate for blocks of size 2^( 2) =       0.000499455930
  error estimate for blocks of size 2^( 3) =       0.000523398158
  error estimate for blocks of size 2^( 4) =       0.000541107935
  error estimate for blocks of size 2^( 5) =       0.000552541164
  error estimate for blocks of size 2^( 6) =       0.000560273515
  error estimate for blocks of size 2^( 7) =       0.000563337791

      target function =      -0.745699211807
              le_mean =     -22.814341414550
             les_mean =     520.943658270617
             stat err =       0.000554315102
             autocorr =       1.367190004492
   target nu stat err =       0.000554315102
   target dn stat err =       0.003305125940
      target stat err =       0.002849874301
              std dev =       0.670435914676
             le_variance =       0.449484315688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474069782
  error estimate for blocks of size 2^( 2) =       0.000499455930
  error estimate for blocks of size 2^( 3) =       0.000523398158
  error estimate for blocks of size 2^( 4) =       0.000541107935
  error estimate for blocks of size 2^( 5) =       0.000552541164
  error estimate for blocks of size 2^( 6) =       0.000560273515
  error estimate for blocks of size 2^( 7) =       0.000563337791

      target function =      -0.745699211807
              le_mean =     -22.814341414550
             les_mean =     520.943658270617
             stat err =       0.000554315102
             autocorr =       1.367190004492
   target nu stat err =       0.000554315102
   target dn stat err =       0.003305125940
      target stat err =       0.002849874301
              std dev =       0.670435914676
             le_variance =       0.449484315688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449601298653
                                         uncertainty =       0.002925737031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474069782
  error estimate for blocks of size 2^( 2) =       0.000499455930
  error estimate for blocks of size 2^( 3) =       0.000523398158
  error estimate for blocks of size 2^( 4) =       0.000541107935
  error estimate for blocks of size 2^( 5) =       0.000552541164
  error estimate for blocks of size 2^( 6) =       0.000560273515
  error estimate for blocks of size 2^( 7) =       0.000563337791

      target function =      -0.745699211807
              le_mean =     -22.814341414550
             les_mean =     520.943658270617
             stat err =       0.000554315102
             autocorr =       1.367190004492
   target nu stat err =       0.000554315102
   target dn stat err =       0.003305125940
      target stat err =       0.002849874301
              std dev =       0.670435914676
             le_variance =       0.449484315688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745699211807        initial  <--
     6.2500e+44     6.2500e+45             1.2643e-49        -0.745699211807
     2.5000e+45     2.5000e+46             5.4747e-50        -0.745699211807
     1.0000e+46     1.0000e+47             7.9019e-51        -0.745699211807

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1122
  </log>
  <optVariables href="FORM2.s049.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1939e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8414
    reference variance = 0.521202
====================================================
  Execution time = 4.5935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4566e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446718852461
                                         uncertainty =       0.002356875568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446718852461
                                         uncertainty =       0.002356875568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472575574
  error estimate for blocks of size 2^( 2) =       0.000498319055
  error estimate for blocks of size 2^( 3) =       0.000522480882
  error estimate for blocks of size 2^( 4) =       0.000540001054
  error estimate for blocks of size 2^( 5) =       0.000552308805
  error estimate for blocks of size 2^( 6) =       0.000558856894
  error estimate for blocks of size 2^( 7) =       0.000560653162

      target function =      -0.748082475733
              le_mean =     -22.814994915963
             les_mean =     520.970648138760
             stat err =       0.000552954979
             autocorr =       1.369105780587
   target nu stat err =       0.000552954979
   target dn stat err =       0.002491036751
      target stat err =       0.002202040300
              std dev =       0.668322786284
             le_variance =       0.446655346666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281499491596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+45, overlap shift 6.2500e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748087934079       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748087934079       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+46, overlap shift 2.5000e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748087934079       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748087934079       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+47, overlap shift 1.0000e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748087934079       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748087934079       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.700143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0508e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8616
    reference variance = 0.39521
====================================================
  Execution time = 4.3241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5486e-01
  Total weights = 2.0000e+06
  Execution time = 3.4725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476897148
  error estimate for blocks of size 2^( 2) =       0.000501935822
  error estimate for blocks of size 2^( 3) =       0.000525910220
  error estimate for blocks of size 2^( 4) =       0.000543564605
  error estimate for blocks of size 2^( 5) =       0.000555732303
  error estimate for blocks of size 2^( 6) =       0.000561609232
  error estimate for blocks of size 2^( 7) =       0.000563485719

      target function =      -0.741187814140
              le_mean =     -22.814597540357
             les_mean =     520.960722479889
             stat err =       0.000556097965
             autocorr =       1.359731508582
   target nu stat err =       0.000556097965
   target dn stat err =       0.004538052324
      target stat err =       0.003824287592
              std dev =       0.674434414035
             le_variance =       0.454861778835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476897148
  error estimate for blocks of size 2^( 2) =       0.000501935822
  error estimate for blocks of size 2^( 3) =       0.000525910220
  error estimate for blocks of size 2^( 4) =       0.000543564605
  error estimate for blocks of size 2^( 5) =       0.000555732303
  error estimate for blocks of size 2^( 6) =       0.000561609232
  error estimate for blocks of size 2^( 7) =       0.000563485719

      target function =      -0.741187814140
              le_mean =     -22.814597540357
             les_mean =     520.960722479889
             stat err =       0.000556097965
             autocorr =       1.359731508582
   target nu stat err =       0.000556097965
   target dn stat err =       0.004538052324
      target stat err =       0.003824287592
              std dev =       0.674434414035
             le_variance =       0.454861778835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476897148
  error estimate for blocks of size 2^( 2) =       0.000501935822
  error estimate for blocks of size 2^( 3) =       0.000525910220
  error estimate for blocks of size 2^( 4) =       0.000543564605
  error estimate for blocks of size 2^( 5) =       0.000555732303
  error estimate for blocks of size 2^( 6) =       0.000561609232
  error estimate for blocks of size 2^( 7) =       0.000563485719

      target function =      -0.741187814140
              le_mean =     -22.814597540357
             les_mean =     520.960722479889
             stat err =       0.000556097965
             autocorr =       1.359731508582
   target nu stat err =       0.000556097965
   target dn stat err =       0.004538052324
      target stat err =       0.003824287592
              std dev =       0.674434414035
             le_variance =       0.454861778835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454958418478
                                         uncertainty =       0.004136515649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476897148
  error estimate for blocks of size 2^( 2) =       0.000501935822
  error estimate for blocks of size 2^( 3) =       0.000525910220
  error estimate for blocks of size 2^( 4) =       0.000543564605
  error estimate for blocks of size 2^( 5) =       0.000555732303
  error estimate for blocks of size 2^( 6) =       0.000561609232
  error estimate for blocks of size 2^( 7) =       0.000563485719

      target function =      -0.741187814140
              le_mean =     -22.814597540357
             les_mean =     520.960722479889
             stat err =       0.000556097965
             autocorr =       1.359731508582
   target nu stat err =       0.000556097965
   target dn stat err =       0.004538052324
      target stat err =       0.003824287592
              std dev =       0.674434414035
             le_variance =       0.454861778835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741187814140        initial  <--
     6.2500e+45     6.2500e+46             0.0000e+00        -0.741187814140
     2.5000e+46     2.5000e+47             0.0000e+00        -0.741187814140
     1.0000e+47     1.0000e+48             0.0000e+00        -0.741187814140

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6461
  </log>
  <optVariables href="FORM2.s050.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2116e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7806
    reference variance = 0.470792
====================================================
  Execution time = 4.5090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4341e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4744e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443417564404
                                         uncertainty =       0.003158726053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443417564404
                                         uncertainty =       0.003158726053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470855081
  error estimate for blocks of size 2^( 2) =       0.000496354515
  error estimate for blocks of size 2^( 3) =       0.000520726068
  error estimate for blocks of size 2^( 4) =       0.000538927024
  error estimate for blocks of size 2^( 5) =       0.000551816540
  error estimate for blocks of size 2^( 6) =       0.000557771182
  error estimate for blocks of size 2^( 7) =       0.000560306161

      target function =      -0.750841018500
              le_mean =     -22.814659046094
             les_mean =     520.952076183001
             stat err =       0.000552205227
             autocorr =       1.375392029163
   target nu stat err =       0.000552205227
   target dn stat err =       0.003519815398
      target stat err =       0.003068312832
              std dev =       0.665889641886
             le_variance =       0.443409015171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465904609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+46, overlap shift 6.2500e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750852343772       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750852343772       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+47, overlap shift 2.5000e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750852343772       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750852343772       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+48, overlap shift 1.0000e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750852343772       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750852343772       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.701236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9840e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8703
    reference variance = 0.354305
====================================================
  Execution time = 4.2907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4818e-01
  Total weights = 2.0000e+06
  Execution time = 3.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473379102
  error estimate for blocks of size 2^( 2) =       0.000499037012
  error estimate for blocks of size 2^( 3) =       0.000523669354
  error estimate for blocks of size 2^( 4) =       0.000541793597
  error estimate for blocks of size 2^( 5) =       0.000553076930
  error estimate for blocks of size 2^( 6) =       0.000559469068
  error estimate for blocks of size 2^( 7) =       0.000565610650

      target function =      -0.746799857106
              le_mean =     -22.814405382311
             les_mean =     520.945268272120
             stat err =       0.000554987561
             autocorr =       1.374511369778
   target nu stat err =       0.000554987561
   target dn stat err =       0.003425631475
      target stat err =       0.002957829107
              std dev =       0.669459145733
             le_variance =       0.448175547806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473379102
  error estimate for blocks of size 2^( 2) =       0.000499037012
  error estimate for blocks of size 2^( 3) =       0.000523669354
  error estimate for blocks of size 2^( 4) =       0.000541793597
  error estimate for blocks of size 2^( 5) =       0.000553076930
  error estimate for blocks of size 2^( 6) =       0.000559469068
  error estimate for blocks of size 2^( 7) =       0.000565610650

      target function =      -0.746799857106
              le_mean =     -22.814405382311
             les_mean =     520.945268272120
             stat err =       0.000554987561
             autocorr =       1.374511369778
   target nu stat err =       0.000554987561
   target dn stat err =       0.003425631475
      target stat err =       0.002957829107
              std dev =       0.669459145733
             le_variance =       0.448175547806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473379102
  error estimate for blocks of size 2^( 2) =       0.000499037012
  error estimate for blocks of size 2^( 3) =       0.000523669354
  error estimate for blocks of size 2^( 4) =       0.000541793597
  error estimate for blocks of size 2^( 5) =       0.000553076930
  error estimate for blocks of size 2^( 6) =       0.000559469068
  error estimate for blocks of size 2^( 7) =       0.000565610650

      target function =      -0.746799857106
              le_mean =     -22.814405382311
             les_mean =     520.945268272120
             stat err =       0.000554987561
             autocorr =       1.374511369778
   target nu stat err =       0.000554987561
   target dn stat err =       0.003425631475
      target stat err =       0.002957829107
              std dev =       0.669459145733
             le_variance =       0.448175547806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448196038703
                                         uncertainty =       0.003157892147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473379102
  error estimate for blocks of size 2^( 2) =       0.000499037012
  error estimate for blocks of size 2^( 3) =       0.000523669354
  error estimate for blocks of size 2^( 4) =       0.000541793597
  error estimate for blocks of size 2^( 5) =       0.000553076930
  error estimate for blocks of size 2^( 6) =       0.000559469068
  error estimate for blocks of size 2^( 7) =       0.000565610650

      target function =      -0.746799857106
              le_mean =     -22.814405382311
             les_mean =     520.945268272120
             stat err =       0.000554987561
             autocorr =       1.374511369778
   target nu stat err =       0.000554987561
   target dn stat err =       0.003425631475
      target stat err =       0.002957829107
              std dev =       0.669459145733
             le_variance =       0.448175547806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746799857106        initial  <--
     6.2500e+46     6.2500e+47             0.0000e+00        -0.746799857106
     2.5000e+47     2.5000e+48             0.0000e+00        -0.746799857106
     1.0000e+48     1.0000e+49             0.0000e+00        -0.746799857106

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3401
  </log>
  <optVariables href="FORM2.s051.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2019e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.9142
    reference variance = 0.549646
====================================================
  Execution time = 4.3371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4860e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4902e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448702246840
                                         uncertainty =       0.003923437167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448702246840
                                         uncertainty =       0.003923437167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473601704
  error estimate for blocks of size 2^( 2) =       0.000498868861
  error estimate for blocks of size 2^( 3) =       0.000522682478
  error estimate for blocks of size 2^( 4) =       0.000540363030
  error estimate for blocks of size 2^( 5) =       0.000550511160
  error estimate for blocks of size 2^( 6) =       0.000556146132
  error estimate for blocks of size 2^( 7) =       0.000560018581

      target function =      -0.746444547610
              le_mean =     -22.813942115063
             les_mean =     520.924551753253
             stat err =       0.000551759726
             autocorr =       1.357292601507
   target nu stat err =       0.000551759726
   target dn stat err =       0.004338614367
      target stat err =       0.003707632332
              std dev =       0.669773952985
             le_variance =       0.448597148097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281394211506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+47, overlap shift 6.2500e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746461811379       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746461811379       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+47 is 1.244172e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+48, overlap shift 2.5000e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746461811379       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746461811379       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746461811379       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746461811379       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 7.46e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 9.75e+06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 3.02e+16           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+48 is 9.031528e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+49, overlap shift 1.0000e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746461811379       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746461811379       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.702883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8280e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.9703
    reference variance = 0.453196
====================================================
  Execution time = 4.5029e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4196e-01
  Total weights = 2.0000e+06
  Execution time = 3.4939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470082987
  error estimate for blocks of size 2^( 2) =       0.000495052788
  error estimate for blocks of size 2^( 3) =       0.000518891082
  error estimate for blocks of size 2^( 4) =       0.000537365586
  error estimate for blocks of size 2^( 5) =       0.000548878908
  error estimate for blocks of size 2^( 6) =       0.000555380752
  error estimate for blocks of size 2^( 7) =       0.000560012433

      target function =      -0.752091882136
              le_mean =     -22.814426880558
             les_mean =     520.940029696298
             stat err =       0.000550409420
             autocorr =       1.370953260460
   target nu stat err =       0.000550409420
   target dn stat err =       0.002138619582
      target stat err =       0.001934503400
              std dev =       0.664797735370
             le_variance =       0.441956028953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470082987
  error estimate for blocks of size 2^( 2) =       0.000495052788
  error estimate for blocks of size 2^( 3) =       0.000518891082
  error estimate for blocks of size 2^( 4) =       0.000537365586
  error estimate for blocks of size 2^( 5) =       0.000548878908
  error estimate for blocks of size 2^( 6) =       0.000555380752
  error estimate for blocks of size 2^( 7) =       0.000560012433

      target function =      -0.752091882136
              le_mean =     -22.814426880558
             les_mean =     520.940029696298
             stat err =       0.000550409420
             autocorr =       1.370953260460
   target nu stat err =       0.000550409420
   target dn stat err =       0.002138619582
      target stat err =       0.001934503400
              std dev =       0.664797735370
             le_variance =       0.441956028953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470082987
  error estimate for blocks of size 2^( 2) =       0.000495052788
  error estimate for blocks of size 2^( 3) =       0.000518891082
  error estimate for blocks of size 2^( 4) =       0.000537365586
  error estimate for blocks of size 2^( 5) =       0.000548878908
  error estimate for blocks of size 2^( 6) =       0.000555380752
  error estimate for blocks of size 2^( 7) =       0.000560012433

      target function =      -0.752091882136
              le_mean =     -22.814426880558
             les_mean =     520.940029696298
             stat err =       0.000550409420
             autocorr =       1.370953260460
   target nu stat err =       0.000550409420
   target dn stat err =       0.002138619582
      target stat err =       0.001934503400
              std dev =       0.664797735370
             le_variance =       0.441956028953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941612335
                                         uncertainty =       0.001934401855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470082987
  error estimate for blocks of size 2^( 2) =       0.000495052788
  error estimate for blocks of size 2^( 3) =       0.000518891082
  error estimate for blocks of size 2^( 4) =       0.000537365586
  error estimate for blocks of size 2^( 5) =       0.000548878908
  error estimate for blocks of size 2^( 6) =       0.000555380752
  error estimate for blocks of size 2^( 7) =       0.000560012433

      target function =      -0.752091882136
              le_mean =     -22.814426880558
             les_mean =     520.940029696298
             stat err =       0.000550409420
             autocorr =       1.370953260460
   target nu stat err =       0.000550409420
   target dn stat err =       0.002138619582
      target stat err =       0.001934503400
              std dev =       0.664797735370
             le_variance =       0.441956028953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752091882136        initial  <--
     6.2500e+47     6.2500e+48             1.2442e-52        -0.752091882136
     2.5000e+48     2.5000e+49             9.0315e-53        -0.752091882136
     1.0000e+49     1.0000e+50             0.0000e+00        -0.752091882136

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4764
  </log>
  <optVariables href="FORM2.s052.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2076e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7732
    reference variance = 0.539147
====================================================
  Execution time = 4.4332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6515e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4814e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465257919253
                                         uncertainty =       0.012655703630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465257919253
                                         uncertainty =       0.012655703630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482258207
  error estimate for blocks of size 2^( 2) =       0.000507273755
  error estimate for blocks of size 2^( 3) =       0.000530624318
  error estimate for blocks of size 2^( 4) =       0.000547901719
  error estimate for blocks of size 2^( 5) =       0.000559377406
  error estimate for blocks of size 2^( 6) =       0.000564020241
  error estimate for blocks of size 2^( 7) =       0.000569434193

      target function =      -0.732609373589
              le_mean =     -22.814375902034
             les_mean =     520.960893523028
             stat err =       0.000560183390
             autocorr =       1.349277257757
   target nu stat err =       0.000560183390
   target dn stat err =       0.012955499507
      target stat err =       0.010540375226
              std dev =       0.682016096782
             le_variance =       0.465145956270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281437590203e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+48, overlap shift 6.2500e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732761034167       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732761034167       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+49, overlap shift 2.5000e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732761034167       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732761034167       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+50, overlap shift 1.0000e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732761034167       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732761034167       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.703992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9152e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8669
    reference variance = 0.242623
====================================================
  Execution time = 4.5317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4904e-01
  Total weights = 2.0000e+06
  Execution time = 3.4857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473833181
  error estimate for blocks of size 2^( 2) =       0.000499255925
  error estimate for blocks of size 2^( 3) =       0.000522874572
  error estimate for blocks of size 2^( 4) =       0.000540787154
  error estimate for blocks of size 2^( 5) =       0.000552784459
  error estimate for blocks of size 2^( 6) =       0.000559698168
  error estimate for blocks of size 2^( 7) =       0.000563797428

      target function =      -0.746068888559
              le_mean =     -22.814593158408
             les_mean =     520.954696526297
             stat err =       0.000554266802
             autocorr =       1.368317227868
   target nu stat err =       0.000554266802
   target dn stat err =       0.003885865262
      target stat err =       0.003332757689
              std dev =       0.670101311108
             le_variance =       0.449035767148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473833181
  error estimate for blocks of size 2^( 2) =       0.000499255925
  error estimate for blocks of size 2^( 3) =       0.000522874572
  error estimate for blocks of size 2^( 4) =       0.000540787154
  error estimate for blocks of size 2^( 5) =       0.000552784459
  error estimate for blocks of size 2^( 6) =       0.000559698168
  error estimate for blocks of size 2^( 7) =       0.000563797428

      target function =      -0.746068888559
              le_mean =     -22.814593158408
             les_mean =     520.954696526297
             stat err =       0.000554266802
             autocorr =       1.368317227868
   target nu stat err =       0.000554266802
   target dn stat err =       0.003885865262
      target stat err =       0.003332757689
              std dev =       0.670101311108
             le_variance =       0.449035767148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473833181
  error estimate for blocks of size 2^( 2) =       0.000499255925
  error estimate for blocks of size 2^( 3) =       0.000522874572
  error estimate for blocks of size 2^( 4) =       0.000540787154
  error estimate for blocks of size 2^( 5) =       0.000552784459
  error estimate for blocks of size 2^( 6) =       0.000559698168
  error estimate for blocks of size 2^( 7) =       0.000563797428

      target function =      -0.746068888559
              le_mean =     -22.814593158408
             les_mean =     520.954696526297
             stat err =       0.000554266802
             autocorr =       1.368317227868
   target nu stat err =       0.000554266802
   target dn stat err =       0.003885865262
      target stat err =       0.003332757689
              std dev =       0.670101311108
             le_variance =       0.449035767148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449110039557
                                         uncertainty =       0.003642992347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473833181
  error estimate for blocks of size 2^( 2) =       0.000499255925
  error estimate for blocks of size 2^( 3) =       0.000522874572
  error estimate for blocks of size 2^( 4) =       0.000540787154
  error estimate for blocks of size 2^( 5) =       0.000552784459
  error estimate for blocks of size 2^( 6) =       0.000559698168
  error estimate for blocks of size 2^( 7) =       0.000563797428

      target function =      -0.746068888559
              le_mean =     -22.814593158408
             les_mean =     520.954696526297
             stat err =       0.000554266802
             autocorr =       1.368317227868
   target nu stat err =       0.000554266802
   target dn stat err =       0.003885865262
      target stat err =       0.003332757689
              std dev =       0.670101311108
             le_variance =       0.449035767148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746068888559        initial  <--
     6.2500e+48     6.2500e+49             0.0000e+00        -0.746068888559
     2.5000e+49     2.5000e+50             0.0000e+00        -0.746068888559
     1.0000e+50     1.0000e+51             0.0000e+00        -0.746068888559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7952
  </log>
  <optVariables href="FORM2.s053.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2195e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7878
    reference variance = 0.227926
====================================================
  Execution time = 4.3854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4086e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4831e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440863355753
                                         uncertainty =       0.002217767515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440863355753
                                         uncertainty =       0.002217767515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469502169
  error estimate for blocks of size 2^( 2) =       0.000494992954
  error estimate for blocks of size 2^( 3) =       0.000519236200
  error estimate for blocks of size 2^( 4) =       0.000537590667
  error estimate for blocks of size 2^( 5) =       0.000548013104
  error estimate for blocks of size 2^( 6) =       0.000556922333
  error estimate for blocks of size 2^( 7) =       0.000561102366

      target function =      -0.753022473798
              le_mean =     -22.815104329857
             les_mean =     520.969849935852
             stat err =       0.000550907118
             autocorr =       1.376833930410
   target nu stat err =       0.000550907118
   target dn stat err =       0.002306339545
      target stat err =       0.002078030372
              std dev =       0.663976335457
             le_variance =       0.440864574047


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281510432986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+49, overlap shift 6.2500e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.753027153892       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.753027153892       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+50, overlap shift 2.5000e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.753027153892       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.753027153892       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+51, overlap shift 1.0000e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.753027153892       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.753027153892       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.705095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8692e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7707
    reference variance = 0.324866
====================================================
  Execution time = 4.3749e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4700e-01
  Total weights = 2.0000e+06
  Execution time = 3.4621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472760472
  error estimate for blocks of size 2^( 2) =       0.000498224088
  error estimate for blocks of size 2^( 3) =       0.000521794684
  error estimate for blocks of size 2^( 4) =       0.000539785730
  error estimate for blocks of size 2^( 5) =       0.000552880239
  error estimate for blocks of size 2^( 6) =       0.000557367501
  error estimate for blocks of size 2^( 7) =       0.000557574340

      target function =      -0.747797690789
              le_mean =     -22.813945390558
             les_mean =     520.923108987518
             stat err =       0.000551901953
             autocorr =       1.362829563413
   target nu stat err =       0.000551901953
   target dn stat err =       0.002963417265
      target stat err =       0.002582036117
              std dev =       0.668584271167
             le_variance =       0.447004927652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472760472
  error estimate for blocks of size 2^( 2) =       0.000498224088
  error estimate for blocks of size 2^( 3) =       0.000521794684
  error estimate for blocks of size 2^( 4) =       0.000539785730
  error estimate for blocks of size 2^( 5) =       0.000552880239
  error estimate for blocks of size 2^( 6) =       0.000557367501
  error estimate for blocks of size 2^( 7) =       0.000557574340

      target function =      -0.747797690789
              le_mean =     -22.813945390558
             les_mean =     520.923108987518
             stat err =       0.000551901953
             autocorr =       1.362829563413
   target nu stat err =       0.000551901953
   target dn stat err =       0.002963417265
      target stat err =       0.002582036117
              std dev =       0.668584271167
             le_variance =       0.447004927652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472760472
  error estimate for blocks of size 2^( 2) =       0.000498224088
  error estimate for blocks of size 2^( 3) =       0.000521794684
  error estimate for blocks of size 2^( 4) =       0.000539785730
  error estimate for blocks of size 2^( 5) =       0.000552880239
  error estimate for blocks of size 2^( 6) =       0.000557367501
  error estimate for blocks of size 2^( 7) =       0.000557574340

      target function =      -0.747797690789
              le_mean =     -22.813945390558
             les_mean =     520.923108987518
             stat err =       0.000551901953
             autocorr =       1.362829563413
   target nu stat err =       0.000551901953
   target dn stat err =       0.002963417265
      target stat err =       0.002582036117
              std dev =       0.668584271167
             le_variance =       0.447004927652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446848617771
                                         uncertainty =       0.002809839587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472760472
  error estimate for blocks of size 2^( 2) =       0.000498224088
  error estimate for blocks of size 2^( 3) =       0.000521794684
  error estimate for blocks of size 2^( 4) =       0.000539785730
  error estimate for blocks of size 2^( 5) =       0.000552880239
  error estimate for blocks of size 2^( 6) =       0.000557367501
  error estimate for blocks of size 2^( 7) =       0.000557574340

      target function =      -0.747797690789
              le_mean =     -22.813945390558
             les_mean =     520.923108987518
             stat err =       0.000551901953
             autocorr =       1.362829563413
   target nu stat err =       0.000551901953
   target dn stat err =       0.002963417265
      target stat err =       0.002582036117
              std dev =       0.668584271167
             le_variance =       0.447004927652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747797690789        initial  <--
     6.2500e+49     6.2500e+50             0.0000e+00        -0.747797690789
     2.5000e+50     2.5000e+51             0.0000e+00        -0.747797690789
     1.0000e+51     1.0000e+52             0.0000e+00        -0.747797690789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0684
  </log>
  <optVariables href="FORM2.s054.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1977e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7017
    reference variance = 0.284545
====================================================
  Execution time = 4.5977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4857e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445948372810
                                         uncertainty =       0.003106685734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445948372810
                                         uncertainty =       0.003106685734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472161831
  error estimate for blocks of size 2^( 2) =       0.000497842197
  error estimate for blocks of size 2^( 3) =       0.000521672374
  error estimate for blocks of size 2^( 4) =       0.000539775795
  error estimate for blocks of size 2^( 5) =       0.000550003760
  error estimate for blocks of size 2^( 6) =       0.000555532869
  error estimate for blocks of size 2^( 7) =       0.000558820520

      target function =      -0.748754016913
              le_mean =     -22.813906784344
             les_mean =     520.920216131673
             stat err =       0.000551033236
             autocorr =       1.361989740185
   target nu stat err =       0.000551033236
   target dn stat err =       0.003256125660
      target stat err =       0.002829485472
              std dev =       0.667737665450
             le_variance =       0.445873589861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281390678434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+50, overlap shift 6.2500e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748763717382       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748763717382       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748763717382       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748763717380       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+50 is 2.487845e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+51, overlap shift 2.5000e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748763717382       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748763717382       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748763717382       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748763717380       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+51 is 6.219613e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+52, overlap shift 1.0000e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748763717382       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748763717382       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748763717382       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748763717380       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.80e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 4.91e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+52 is 1.554903e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.706962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0841e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7382
    reference variance = 0.357074
====================================================
  Execution time = 4.2981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4723e-01
  Total weights = 2.0000e+06
  Execution time = 3.4607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880802
  error estimate for blocks of size 2^( 2) =       0.000498216267
  error estimate for blocks of size 2^( 3) =       0.000522294435
  error estimate for blocks of size 2^( 4) =       0.000539585829
  error estimate for blocks of size 2^( 5) =       0.000550216728
  error estimate for blocks of size 2^( 6) =       0.000556388505
  error estimate for blocks of size 2^( 7) =       0.000561834286

      target function =      -0.747603113325
              le_mean =     -22.813956086024
             les_mean =     520.923824578081
             stat err =       0.000552006337
             autocorr =       1.362651380321
   target nu stat err =       0.000552006337
   target dn stat err =       0.003313270559
      target stat err =       0.002868573987
              std dev =       0.668754444210
             le_variance =       0.447232506651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880802
  error estimate for blocks of size 2^( 2) =       0.000498216267
  error estimate for blocks of size 2^( 3) =       0.000522294435
  error estimate for blocks of size 2^( 4) =       0.000539585829
  error estimate for blocks of size 2^( 5) =       0.000550216728
  error estimate for blocks of size 2^( 6) =       0.000556388505
  error estimate for blocks of size 2^( 7) =       0.000561834286

      target function =      -0.747603113325
              le_mean =     -22.813956086024
             les_mean =     520.923824578081
             stat err =       0.000552006337
             autocorr =       1.362651380321
   target nu stat err =       0.000552006337
   target dn stat err =       0.003313270559
      target stat err =       0.002868573987
              std dev =       0.668754444210
             le_variance =       0.447232506651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880802
  error estimate for blocks of size 2^( 2) =       0.000498216267
  error estimate for blocks of size 2^( 3) =       0.000522294435
  error estimate for blocks of size 2^( 4) =       0.000539585829
  error estimate for blocks of size 2^( 5) =       0.000550216728
  error estimate for blocks of size 2^( 6) =       0.000556388505
  error estimate for blocks of size 2^( 7) =       0.000561834286

      target function =      -0.747603113325
              le_mean =     -22.813956086024
             les_mean =     520.923824578081
             stat err =       0.000552006337
             autocorr =       1.362651380321
   target nu stat err =       0.000552006337
   target dn stat err =       0.003313270559
      target stat err =       0.002868573987
              std dev =       0.668754444210
             le_variance =       0.447232506651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447266420473
                                         uncertainty =       0.003525652222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880802
  error estimate for blocks of size 2^( 2) =       0.000498216267
  error estimate for blocks of size 2^( 3) =       0.000522294435
  error estimate for blocks of size 2^( 4) =       0.000539585829
  error estimate for blocks of size 2^( 5) =       0.000550216728
  error estimate for blocks of size 2^( 6) =       0.000556388505
  error estimate for blocks of size 2^( 7) =       0.000561834286

      target function =      -0.747603113325
              le_mean =     -22.813956086024
             les_mean =     520.923824578081
             stat err =       0.000552006337
             autocorr =       1.362651380321
   target nu stat err =       0.000552006337
   target dn stat err =       0.003313270559
      target stat err =       0.002868573987
              std dev =       0.668754444210
             le_variance =       0.447232506651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747603113325        initial  <--
     6.2500e+50     6.2500e+51             2.4878e-55        -0.747603113325
     2.5000e+51     2.5000e+52             6.2196e-56        -0.747603113325
     1.0000e+52     1.0000e+53             1.5549e-56        -0.747603113325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3206
  </log>
  <optVariables href="FORM2.s055.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8946
    reference variance = 0.647899
====================================================
  Execution time = 4.5553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.6266e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5042e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462500958335
                                         uncertainty =       0.013413495932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462500958335
                                         uncertainty =       0.013413495932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480968825
  error estimate for blocks of size 2^( 2) =       0.000506400589
  error estimate for blocks of size 2^( 3) =       0.000529877042
  error estimate for blocks of size 2^( 4) =       0.000548347671
  error estimate for blocks of size 2^( 5) =       0.000559930488
  error estimate for blocks of size 2^( 6) =       0.000568917376
  error estimate for blocks of size 2^( 7) =       0.000573168581

      target function =      -0.734563953769
              le_mean =     -22.815838818330
             les_mean =     521.025162774425
             stat err =       0.000562591029
             autocorr =       1.368206817176
   target nu stat err =       0.000562591029
   target dn stat err =       0.013708768991
      target stat err =       0.011235963504
              std dev =       0.680192635749
             le_variance =       0.462662021727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281583881833e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+51, overlap shift 6.2500e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734735962666       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734735962666       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+52, overlap shift 2.5000e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734735962666       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734735962666       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+53, overlap shift 1.0000e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734735962666       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734735962666       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.708070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0602e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6561
    reference variance = 2.14585
====================================================
  Execution time = 4.2842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5298e-01
  Total weights = 2.0000e+06
  Execution time = 3.4838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475907752
  error estimate for blocks of size 2^( 2) =       0.000500942546
  error estimate for blocks of size 2^( 3) =       0.000525012781
  error estimate for blocks of size 2^( 4) =       0.000542817102
  error estimate for blocks of size 2^( 5) =       0.000555205520
  error estimate for blocks of size 2^( 6) =       0.000560849030
  error estimate for blocks of size 2^( 7) =       0.000565373801

      target function =      -0.742757417601
              le_mean =     -22.814387327888
             les_mean =     520.949245296515
             stat err =       0.000556061363
             autocorr =       1.365211327086
   target nu stat err =       0.000556061363
   target dn stat err =       0.005114749226
      target stat err =       0.004314745094
              std dev =       0.673035196770
             le_variance =       0.452976376091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475907752
  error estimate for blocks of size 2^( 2) =       0.000500942546
  error estimate for blocks of size 2^( 3) =       0.000525012781
  error estimate for blocks of size 2^( 4) =       0.000542817102
  error estimate for blocks of size 2^( 5) =       0.000555205520
  error estimate for blocks of size 2^( 6) =       0.000560849030
  error estimate for blocks of size 2^( 7) =       0.000565373801

      target function =      -0.742757417601
              le_mean =     -22.814387327888
             les_mean =     520.949245296515
             stat err =       0.000556061363
             autocorr =       1.365211327086
   target nu stat err =       0.000556061363
   target dn stat err =       0.005114749226
      target stat err =       0.004314745094
              std dev =       0.673035196770
             le_variance =       0.452976376091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475907752
  error estimate for blocks of size 2^( 2) =       0.000500942546
  error estimate for blocks of size 2^( 3) =       0.000525012781
  error estimate for blocks of size 2^( 4) =       0.000542817102
  error estimate for blocks of size 2^( 5) =       0.000555205520
  error estimate for blocks of size 2^( 6) =       0.000560849030
  error estimate for blocks of size 2^( 7) =       0.000565373801

      target function =      -0.742757417601
              le_mean =     -22.814387327888
             les_mean =     520.949245296515
             stat err =       0.000556061363
             autocorr =       1.365211327086
   target nu stat err =       0.000556061363
   target dn stat err =       0.005114749226
      target stat err =       0.004314745094
              std dev =       0.673035196770
             le_variance =       0.452976376091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452857610179
                                         uncertainty =       0.004895274298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475907752
  error estimate for blocks of size 2^( 2) =       0.000500942546
  error estimate for blocks of size 2^( 3) =       0.000525012781
  error estimate for blocks of size 2^( 4) =       0.000542817102
  error estimate for blocks of size 2^( 5) =       0.000555205520
  error estimate for blocks of size 2^( 6) =       0.000560849030
  error estimate for blocks of size 2^( 7) =       0.000565373801

      target function =      -0.742757417601
              le_mean =     -22.814387327888
             les_mean =     520.949245296515
             stat err =       0.000556061363
             autocorr =       1.365211327086
   target nu stat err =       0.000556061363
   target dn stat err =       0.005114749226
      target stat err =       0.004314745094
              std dev =       0.673035196770
             le_variance =       0.452976376091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742757417601        initial  <--
     6.2500e+51     6.2500e+52             0.0000e+00        -0.742757417601
     2.5000e+52     2.5000e+53             0.0000e+00        -0.742757417601
     1.0000e+53     1.0000e+54             0.0000e+00        -0.742757417601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3299
  </log>
  <optVariables href="FORM2.s056.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2094e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8409
    reference variance = 0.396942
====================================================
  Execution time = 4.3789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4778e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451381771055
                                         uncertainty =       0.003625373250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451381771055
                                         uncertainty =       0.003625373250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475081143
  error estimate for blocks of size 2^( 2) =       0.000500577288
  error estimate for blocks of size 2^( 3) =       0.000523854044
  error estimate for blocks of size 2^( 4) =       0.000541527071
  error estimate for blocks of size 2^( 5) =       0.000552638114
  error estimate for blocks of size 2^( 6) =       0.000559061704
  error estimate for blocks of size 2^( 7) =       0.000566327854

      target function =      -0.744084673178
              le_mean =     -22.814376385147
             les_mean =     520.947173803011
             stat err =       0.000554888686
             autocorr =       1.364194057099
   target nu stat err =       0.000554888686
   target dn stat err =       0.003642218347
      target stat err =       0.003114207043
              std dev =       0.671866196180
             le_variance =       0.451404185570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281437638515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+52, overlap shift 6.2500e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744096677107       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744096677107       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+52 is 1.038134e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+53, overlap shift 2.5000e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744096677107       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744096677107       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+53 is 2.595334e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+54, overlap shift 1.0000e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744096677107       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744096677107       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744096677107       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+54 is 1.027414e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.709527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8574e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7607
    reference variance = 0.279932
====================================================
  Execution time = 4.5418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5113e-01
  Total weights = 2.0000e+06
  Execution time = 3.4794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474935142
  error estimate for blocks of size 2^( 2) =       0.000500428192
  error estimate for blocks of size 2^( 3) =       0.000524394850
  error estimate for blocks of size 2^( 4) =       0.000541525858
  error estimate for blocks of size 2^( 5) =       0.000553199506
  error estimate for blocks of size 2^( 6) =       0.000560771978
  error estimate for blocks of size 2^( 7) =       0.000562798017

      target function =      -0.744304107948
              le_mean =     -22.814468908401
             les_mean =     520.951118125311
             stat err =       0.000554573840
             autocorr =       1.363484316718
   target nu stat err =       0.000554573840
   target dn stat err =       0.005014962657
      target stat err =       0.004250073491
              std dev =       0.671659719264
             le_variance =       0.451126778481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474935142
  error estimate for blocks of size 2^( 2) =       0.000500428192
  error estimate for blocks of size 2^( 3) =       0.000524394850
  error estimate for blocks of size 2^( 4) =       0.000541525858
  error estimate for blocks of size 2^( 5) =       0.000553199506
  error estimate for blocks of size 2^( 6) =       0.000560771978
  error estimate for blocks of size 2^( 7) =       0.000562798017

      target function =      -0.744304107948
              le_mean =     -22.814468908401
             les_mean =     520.951118125311
             stat err =       0.000554573840
             autocorr =       1.363484316718
   target nu stat err =       0.000554573840
   target dn stat err =       0.005014962657
      target stat err =       0.004250073491
              std dev =       0.671659719264
             le_variance =       0.451126778481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474935142
  error estimate for blocks of size 2^( 2) =       0.000500428192
  error estimate for blocks of size 2^( 3) =       0.000524394850
  error estimate for blocks of size 2^( 4) =       0.000541525858
  error estimate for blocks of size 2^( 5) =       0.000553199506
  error estimate for blocks of size 2^( 6) =       0.000560771978
  error estimate for blocks of size 2^( 7) =       0.000562798017

      target function =      -0.744304107948
              le_mean =     -22.814468908401
             les_mean =     520.951118125311
             stat err =       0.000554573840
             autocorr =       1.363484316718
   target nu stat err =       0.000554573840
   target dn stat err =       0.005014962657
      target stat err =       0.004250073491
              std dev =       0.671659719264
             le_variance =       0.451126778481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451063304971
                                         uncertainty =       0.005168640936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474935142
  error estimate for blocks of size 2^( 2) =       0.000500428192
  error estimate for blocks of size 2^( 3) =       0.000524394850
  error estimate for blocks of size 2^( 4) =       0.000541525858
  error estimate for blocks of size 2^( 5) =       0.000553199506
  error estimate for blocks of size 2^( 6) =       0.000560771978
  error estimate for blocks of size 2^( 7) =       0.000562798017

      target function =      -0.744304107948
              le_mean =     -22.814468908401
             les_mean =     520.951118125311
             stat err =       0.000554573840
             autocorr =       1.363484316718
   target nu stat err =       0.000554573840
   target dn stat err =       0.005014962657
      target stat err =       0.004250073491
              std dev =       0.671659719264
             le_variance =       0.451126778481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744304107948        initial  <--
     6.2500e+52     6.2500e+53             1.0381e-57        -0.744304107948
     2.5000e+53     2.5000e+54             2.5953e-58        -0.744304107948
     1.0000e+54     1.0000e+55             1.0274e-58        -0.744304107948

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8793
  </log>
  <optVariables href="FORM2.s057.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2146e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8033
    reference variance = 0.262851
====================================================
  Execution time = 4.3508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4419e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4727e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444215660737
                                         uncertainty =       0.002547493188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444215660737
                                         uncertainty =       0.002547493188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471270965
  error estimate for blocks of size 2^( 2) =       0.000496912121
  error estimate for blocks of size 2^( 3) =       0.000521150569
  error estimate for blocks of size 2^( 4) =       0.000539057629
  error estimate for blocks of size 2^( 5) =       0.000551206762
  error estimate for blocks of size 2^( 6) =       0.000557819986
  error estimate for blocks of size 2^( 7) =       0.000559380845

      target function =      -0.750180188757
              le_mean =     -22.814341736917
             les_mean =     520.938381311676
             stat err =       0.000551866306
             autocorr =       1.371280783887
   target nu stat err =       0.000551866306
   target dn stat err =       0.002781796722
      target stat err =       0.002449788939
              std dev =       0.666477790294
             le_variance =       0.444192644955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281434173692e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+53, overlap shift 6.2500e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750187310838       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750187310838       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750187310838       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750187310838       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+53 is 3.101469e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+54, overlap shift 2.5000e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750187310838       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750187310838       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750187310838       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750187310838       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 6.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+54 is 7.753673e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+55, overlap shift 1.0000e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750187310838       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750187310838       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750187310838       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750187310838       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750187310838       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 6.16e+08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       1.104720324278       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+55 is 1.938418e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.711651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8243e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8381
    reference variance = 0.596164
====================================================
  Execution time = 4.4481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5735e-01
  Total weights = 2.0000e+06
  Execution time = 3.4891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478199749
  error estimate for blocks of size 2^( 2) =       0.000503717149
  error estimate for blocks of size 2^( 3) =       0.000527046302
  error estimate for blocks of size 2^( 4) =       0.000544329660
  error estimate for blocks of size 2^( 5) =       0.000556248454
  error estimate for blocks of size 2^( 6) =       0.000560609478
  error estimate for blocks of size 2^( 7) =       0.000568508033

      target function =      -0.739090220875
              le_mean =     -22.816003261880
             les_mean =     521.027354617152
             stat err =       0.000557423906
             autocorr =       1.358790474243
   target nu stat err =       0.000557423906
   target dn stat err =       0.004082526590
      target stat err =       0.003439557771
              std dev =       0.676276570429
             le_variance =       0.457349999712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478199749
  error estimate for blocks of size 2^( 2) =       0.000503717149
  error estimate for blocks of size 2^( 3) =       0.000527046302
  error estimate for blocks of size 2^( 4) =       0.000544329660
  error estimate for blocks of size 2^( 5) =       0.000556248454
  error estimate for blocks of size 2^( 6) =       0.000560609478
  error estimate for blocks of size 2^( 7) =       0.000568508033

      target function =      -0.739090220875
              le_mean =     -22.816003261880
             les_mean =     521.027354617152
             stat err =       0.000557423906
             autocorr =       1.358790474239
   target nu stat err =       0.000557423906
   target dn stat err =       0.004082526590
      target stat err =       0.003439557771
              std dev =       0.676276570429
             le_variance =       0.457349999712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478199749
  error estimate for blocks of size 2^( 2) =       0.000503717149
  error estimate for blocks of size 2^( 3) =       0.000527046302
  error estimate for blocks of size 2^( 4) =       0.000544329660
  error estimate for blocks of size 2^( 5) =       0.000556248454
  error estimate for blocks of size 2^( 6) =       0.000560609478
  error estimate for blocks of size 2^( 7) =       0.000568508033

      target function =      -0.739090220875
              le_mean =     -22.816003261880
             les_mean =     521.027354617152
             stat err =       0.000557423906
             autocorr =       1.358790474239
   target nu stat err =       0.000557423906
   target dn stat err =       0.004082526590
      target stat err =       0.003439557771
              std dev =       0.676276570429
             le_variance =       0.457349999712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457365180679
                                         uncertainty =       0.004159250269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478199749
  error estimate for blocks of size 2^( 2) =       0.000503717149
  error estimate for blocks of size 2^( 3) =       0.000527046302
  error estimate for blocks of size 2^( 4) =       0.000544329660
  error estimate for blocks of size 2^( 5) =       0.000556248454
  error estimate for blocks of size 2^( 6) =       0.000560609478
  error estimate for blocks of size 2^( 7) =       0.000568508033

      target function =      -0.739090220875
              le_mean =     -22.816003261880
             les_mean =     521.027354617152
             stat err =       0.000557423906
             autocorr =       1.358790474239
   target nu stat err =       0.000557423906
   target dn stat err =       0.004082526590
      target stat err =       0.003439557771
              std dev =       0.676276570429
             le_variance =       0.457349999712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739090220875        initial  <--
     6.2500e+53     6.2500e+54             3.1015e-58        -0.739090220875
     2.5000e+54     2.5000e+55             7.7537e-59        -0.739090220875
     1.0000e+55     1.0000e+56             1.9384e-59        -0.739090220875

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8844
  </log>
  <optVariables href="FORM2.s058.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2013e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.806
    reference variance = 0.28111
====================================================
  Execution time = 4.3358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4621e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450917674916
                                         uncertainty =       0.003426451321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450917674916
                                         uncertainty =       0.003426451321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474760220
  error estimate for blocks of size 2^( 2) =       0.000500222920
  error estimate for blocks of size 2^( 3) =       0.000523930751
  error estimate for blocks of size 2^( 4) =       0.000541634990
  error estimate for blocks of size 2^( 5) =       0.000553037542
  error estimate for blocks of size 2^( 6) =       0.000558347743
  error estimate for blocks of size 2^( 7) =       0.000559992187

      target function =      -0.744592239008
              le_mean =     -22.814596201946
             les_mean =     520.956594166317
             stat err =       0.000553253116
             autocorr =       1.357997876804
   target nu stat err =       0.000553253116
   target dn stat err =       0.003571084439
      target stat err =       0.003060579314
              std dev =       0.671412342639
             le_variance =       0.450794533848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281459620195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+54, overlap shift 6.2500e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744603792825       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744603792825       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+55, overlap shift 2.5000e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744603792825       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744603792825       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+56, overlap shift 1.0000e+57 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744603792825       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744603792825       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.712761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7985e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8865
    reference variance = 0.30094
====================================================
  Execution time = 4.2825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6126e-01
  Total weights = 2.0000e+06
  Execution time = 3.4682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480239720
  error estimate for blocks of size 2^( 2) =       0.000505242814
  error estimate for blocks of size 2^( 3) =       0.000528919994
  error estimate for blocks of size 2^( 4) =       0.000547139983
  error estimate for blocks of size 2^( 5) =       0.000558649592
  error estimate for blocks of size 2^( 6) =       0.000563207106
  error estimate for blocks of size 2^( 7) =       0.000567012373

      target function =      -0.735860776309
              le_mean =     -22.814220206214
             les_mean =     520.949903763953
             stat err =       0.000559002263
             autocorr =       1.354911655656
   target nu stat err =       0.000559002263
   target dn stat err =       0.009053204595
      target stat err =       0.007441682785
              std dev =       0.679161524930
             le_variance =       0.461260376945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480239720
  error estimate for blocks of size 2^( 2) =       0.000505242814
  error estimate for blocks of size 2^( 3) =       0.000528919994
  error estimate for blocks of size 2^( 4) =       0.000547139983
  error estimate for blocks of size 2^( 5) =       0.000558649592
  error estimate for blocks of size 2^( 6) =       0.000563207106
  error estimate for blocks of size 2^( 7) =       0.000567012373

      target function =      -0.735860776309
              le_mean =     -22.814220206214
             les_mean =     520.949903763953
             stat err =       0.000559002263
             autocorr =       1.354911655656
   target nu stat err =       0.000559002263
   target dn stat err =       0.009053204595
      target stat err =       0.007441682785
              std dev =       0.679161524930
             le_variance =       0.461260376945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480239720
  error estimate for blocks of size 2^( 2) =       0.000505242814
  error estimate for blocks of size 2^( 3) =       0.000528919994
  error estimate for blocks of size 2^( 4) =       0.000547139983
  error estimate for blocks of size 2^( 5) =       0.000558649592
  error estimate for blocks of size 2^( 6) =       0.000563207106
  error estimate for blocks of size 2^( 7) =       0.000567012373

      target function =      -0.735860776309
              le_mean =     -22.814220206214
             les_mean =     520.949903763953
             stat err =       0.000559002263
             autocorr =       1.354911655656
   target nu stat err =       0.000559002263
   target dn stat err =       0.009053204595
      target stat err =       0.007441682785
              std dev =       0.679161524930
             le_variance =       0.461260376945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461242461606
                                         uncertainty =       0.008994814860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480239720
  error estimate for blocks of size 2^( 2) =       0.000505242814
  error estimate for blocks of size 2^( 3) =       0.000528919994
  error estimate for blocks of size 2^( 4) =       0.000547139983
  error estimate for blocks of size 2^( 5) =       0.000558649592
  error estimate for blocks of size 2^( 6) =       0.000563207106
  error estimate for blocks of size 2^( 7) =       0.000567012373

      target function =      -0.735860776309
              le_mean =     -22.814220206214
             les_mean =     520.949903763953
             stat err =       0.000559002263
             autocorr =       1.354911655656
   target nu stat err =       0.000559002263
   target dn stat err =       0.009053204595
      target stat err =       0.007441682785
              std dev =       0.679161524930
             le_variance =       0.461260376945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735860776309        initial  <--
     6.2500e+54     6.2500e+55             0.0000e+00        -0.735860776309
     2.5000e+55     2.5000e+56             0.0000e+00        -0.735860776309
     1.0000e+56     1.0000e+57             0.0000e+00        -0.735860776309

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2850
  </log>
  <optVariables href="FORM2.s059.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1828e+02 secs
  Total Execution time = 7.3313e+03 secs

=========================================================
  A new xml input file : FORM2.s059.cont.xml
