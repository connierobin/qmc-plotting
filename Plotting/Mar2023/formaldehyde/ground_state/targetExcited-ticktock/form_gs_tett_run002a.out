Rank =    0  Free Memory = 78386 MB
Rank =    1  Free Memory = 78386 MB
Rank =    2  Free Memory = 78386 MB
Rank =    3  Free Memory = 78386 MB
Rank =    4  Free Memory = 78386 MB
Rank =    5  Free Memory = 78386 MB
Rank =    6  Free Memory = 78386 MB
Rank =    7  Free Memory = 78386 MB
Rank =    8  Free Memory = 78386 MB
Rank =    9  Free Memory = 78385 MB
Rank =   10  Free Memory = 78385 MB
Rank =   11  Free Memory = 78385 MB
Rank =   12  Free Memory = 78385 MB
Rank =   13  Free Memory = 78385 MB
Rank =   14  Free Memory = 78384 MB
Rank =   15  Free Memory = 78371 MB
Rank =   16  Free Memory = 78371 MB
Rank =   17  Free Memory = 78371 MB
Rank =   18  Free Memory = 78371 MB
Rank =   19  Free Memory = 78371 MB
Rank =   20  Free Memory = 78371 MB
Rank =   21  Free Memory = 78371 MB
Rank =   22  Free Memory = 78371 MB
Rank =   23  Free Memory = 78371 MB
Rank =   24  Free Memory = 78371 MB
Rank =   25  Free Memory = 78371 MB
Rank =   26  Free Memory = 78371 MB
Rank =   27  Free Memory = 78371 MB
Rank =   28  Free Memory = 78371 MB
Rank =   29  Free Memory = 78371 MB
Rank =   30  Free Memory = 78371 MB
Rank =   31  Free Memory = 78371 MB
Rank =   32  Free Memory = 88702 MB
Rank =   33  Free Memory = 88702 MB
Rank =   34  Free Memory = 88702 MB
Rank =   35  Free Memory = 88702 MB
Rank =   36  Free Memory = 88702 MB
Rank =   37  Free Memory = 88702 MB
Rank =   38  Free Memory = 88702 MB
Rank =   39  Free Memory = 88702 MB
Rank =   40  Free Memory = 88702 MB
Rank =   41  Free Memory = 88702 MB
Rank =   42  Free Memory = 88702 MB
Rank =   43  Free Memory = 88702 MB
Rank =   44  Free Memory = 88702 MB
Rank =   45  Free Memory = 88702 MB
Rank =   46  Free Memory = 88702 MB
Rank =   47  Free Memory = 88702 MB
Rank =   48  Free Memory = 88702 MB
Rank =   49  Free Memory = 88701 MB
Rank =   50  Free Memory = 88701 MB
Rank =   51  Free Memory = 88701 MB
Rank =   52  Free Memory = 88701 MB
Rank =   53  Free Memory = 88701 MB
Rank =   54  Free Memory = 88701 MB
Rank =   55  Free Memory = 88701 MB
Rank =   56  Free Memory = 88701 MB
Rank =   57  Free Memory = 88701 MB
Rank =   58  Free Memory = 88701 MB
Rank =   59  Free Memory = 88700 MB
Rank =   60  Free Memory = 88700 MB
Rank =   61  Free Memory = 88700 MB
Rank =   62  Free Memory = 88700 MB
Rank =   63  Free Memory = 88700 MB
Rank =   64  Free Memory = 89363 MB
Rank =   65  Free Memory = 89363 MB
Rank =   66  Free Memory = 89363 MB
Rank =   67  Free Memory = 89363 MB
Rank =   68  Free Memory = 89363 MB
Rank =   69  Free Memory = 89363 MB
Rank =   70  Free Memory = 89363 MB
Rank =   71  Free Memory = 89363 MB
Rank =   72  Free Memory = 89363 MB
Rank =   73  Free Memory = 89363 MB
Rank =   74  Free Memory = 89363 MB
Rank =   75  Free Memory = 89363 MB
Rank =   76  Free Memory = 89363 MB
Rank =   77  Free Memory = 89363 MB
Rank =   78  Free Memory = 89363 MB
Rank =   79  Free Memory = 89363 MB
Rank =   80  Free Memory = 89363 MB
Rank =   81  Free Memory = 89363 MB
Rank =   82  Free Memory = 89363 MB
Rank =   83  Free Memory = 89363 MB
Rank =   84  Free Memory = 89363 MB
Rank =   85  Free Memory = 89363 MB
Rank =   86  Free Memory = 89363 MB
Rank =   87  Free Memory = 89363 MB
Rank =   88  Free Memory = 89363 MB
Rank =   89  Free Memory = 89363 MB
Rank =   90  Free Memory = 89363 MB
Rank =   91  Free Memory = 89363 MB
Rank =   92  Free Memory = 89363 MB
Rank =   93  Free Memory = 89363 MB
Rank =   94  Free Memory = 89363 MB
Rank =   95  Free Memory = 89363 MB
Rank =   96  Free Memory = 88297 MB
Rank =   97  Free Memory = 88297 MB
Rank =   98  Free Memory = 88297 MB
Rank =   99  Free Memory = 88297 MB
Rank =  100  Free Memory = 88297 MB
Rank =  101  Free Memory = 88297 MB
Rank =  102  Free Memory = 88297 MB
Rank =  103  Free Memory = 88297 MB
Rank =  104  Free Memory = 88297 MB
Rank =  105  Free Memory = 88297 MB
Rank =  106  Free Memory = 88297 MB
Rank =  107  Free Memory = 88297 MB
Rank =  108  Free Memory = 88297 MB
Rank =  109  Free Memory = 88297 MB
Rank =  110  Free Memory = 88297 MB
Rank =  111  Free Memory = 88297 MB
Rank =  112  Free Memory = 88297 MB
Rank =  113  Free Memory = 88297 MB
Rank =  114  Free Memory = 88297 MB
Rank =  115  Free Memory = 88297 MB
Rank =  116  Free Memory = 88297 MB
Rank =  117  Free Memory = 88297 MB
Rank =  118  Free Memory = 88297 MB
Rank =  119  Free Memory = 88297 MB
Rank =  120  Free Memory = 88297 MB
Rank =  121  Free Memory = 88297 MB
Rank =  122  Free Memory = 88297 MB
Rank =  123  Free Memory = 88297 MB
Rank =  124  Free Memory = 88297 MB
Rank =  125  Free Memory = 88297 MB
Rank =  126  Free Memory = 88297 MB
Rank =  127  Free Memory = 88297 MB
  Input file(s): opt_form_gs_tett_run002a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run002a.xml

  Project = FORM2
  date    = 2023-03-16 00:07:21 PDT
  host    = n0083.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 41

  Range of prime numbers to use as seeds over processors and threads = 191-1019


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.536032e-01    1         1 OFF
     uu_1                 8.197417e-02    1         1 OFF
     uu_2                -2.279515e-02    1         1 OFF
     uu_3                -7.836857e-02    1         1 OFF
     uu_4                -1.013427e-01    1         1 OFF
     uu_5                -1.044477e-01    1         1 OFF
     uu_6                -9.224414e-02    1         1 OFF
     uu_7                -6.062712e-02    1         1 OFF
     uu_8                -1.023404e-02    1         1 OFF
     uu_9                 4.851606e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.792217e-01    1         1 OFF
     ud_1                 1.041447e-01    1         1 OFF
     ud_2                -2.759756e-02    1         1 OFF
     ud_3                -9.201142e-02    1         1 OFF
     ud_4                -1.207933e-01    1         1 OFF
     ud_5                -1.273508e-01    1         1 OFF
     ud_6                -1.163455e-01    1         1 OFF
     ud_7                -8.399626e-02    1         1 OFF
     ud_8                -3.198393e-02    1         1 OFF
     ud_9                 3.386961e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -3.996214e-01    1         1 OFF
     eC_1                -2.494767e-01    1         1 OFF
     eC_2                 3.700011e-03    1         1 OFF
     eC_3                 1.573024e-01    1         1 OFF
     eC_4                 1.937498e-01    1         1 OFF
     eC_5                 1.904877e-01    1         1 OFF
     eC_6                 7.711846e-02    1         1 OFF
     eC_7                 2.034542e-02    1         1 OFF
     eC_8                 3.700966e-03    1         1 OFF
     eC_9                 1.944711e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.797092e-01    1         1 OFF
     eO_1                -4.355440e-01    1         1 OFF
     eO_2                -2.455303e-02    1         1 OFF
     eO_3                 2.277127e-01    1         1 OFF
     eO_4                 3.261577e-01    1         1 OFF
     eO_5                 3.430617e-01    1         1 OFF
     eO_6                 2.378897e-01    1         1 OFF
     eO_7                 8.612036e-02    1         1 OFF
     eO_8                 2.385595e-03    1         1 OFF
     eO_9                 8.162181e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.737895e-02    1         1 OFF
     eH1_1                -1.599916e-02    1         1 OFF
     eH1_2                 3.445961e-03    1         1 OFF
     eH1_3                -1.247711e-02    1         1 OFF
     eH1_4                 6.338141e-03    1         1 OFF
     eH1_5                 1.464916e-02    1         1 OFF
     eH1_6                 3.536630e-02    1         1 OFF
     eH1_7                 3.910225e-02    1         1 OFF
     eH1_8                 2.028485e-02    1         1 OFF
     eH1_9                 5.094825e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.796051e-02    1         1 OFF
     eH2_1                -1.537428e-02    1         1 OFF
     eH2_2                 4.200477e-03    1         1 OFF
     eH2_3                -1.217164e-02    1         1 OFF
     eH2_4                 6.944154e-03    1         1 OFF
     eH2_5                 1.575404e-02    1         1 OFF
     eH2_6                 3.502549e-02    1         1 OFF
     eH2_7                 3.688055e-02    1         1 OFF
     eH2_8                 2.096512e-02    1         1 OFF
     eH2_9                 4.252178e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999797e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.3870e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7801
    reference variance = 0.40497
====================================================
  Execution time = 4.3285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -2.2809e+01
  VMC Evar = 5.1978e-01
  Total weights = 1.962909878e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503423950162
                                         uncertainty =       0.002674742533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503423950162
                                         uncertainty =       0.002674742533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501666796
  error estimate for blocks of size 2^( 2) =       0.000522969658
  error estimate for blocks of size 2^( 3) =       0.000542058166
  error estimate for blocks of size 2^( 4) =       0.000557253081
  error estimate for blocks of size 2^( 5) =       0.000565812186
  error estimate for blocks of size 2^( 6) =       0.000571235301
  error estimate for blocks of size 2^( 7) =       0.000574817782

      target function =      -0.637938034344
              le_mean =     -22.808790241253
             les_mean =     520.760693893095
             stat err =       0.000567279588
             autocorr =       1.278685084197
   target nu stat err =       0.000567279588
   target dn stat err =       0.003329507498
      target stat err =       0.001285262831
              std dev =       0.709463986478
             le_variance =       0.503339148110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.280879024125e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637940229266       residual = 7.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.639883577466       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.640138323211       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.640213696846       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.640233499835       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.640240790244       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.640242899796       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.640243256996       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.640243213277       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.640243178275       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.640243190907       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.806085e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637940229266       residual = 7.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.638482869708       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.638550934513       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.638571180066       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.638576232335       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.638577930725       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.638578410181       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.638578480732       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.638578469853       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.638578462230       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.638578465054       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.631233e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637940229266       residual = 7.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.638079956210       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.638097256346       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.638102412186       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.638103679522       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.638104094449       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.638104210849       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.638104227249       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.638104224550       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.638104222726       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.638104223408       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.207653e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1107e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_01 1.626392e-01                 3 1 ON  0
ci_02 -5.771268e-02                3 1 ON  1
ci_03 -5.775704e-02                3 1 ON  2
ci_04 5.725127e-02                 3 1 ON  3
ci_05 -4.049833e-02                3 1 ON  4
ci_06 -4.052367e-02                3 1 ON  5
ci_07 3.052141e-02                 3 1 ON  6
ci_08 -1.857246e-02                3 1 ON  7
ci_09 -1.743651e-02                3 1 ON  8
ci_10 -1.734297e-02                3 1 ON  9
ci_11 1.627098e-02                 3 1 ON  10
ci_12 1.337707e-02                 3 1 ON  11
ci_13 1.271017e-02                 3 1 ON  12
ci_14 1.268595e-02                 3 1 ON  13
ci_15 1.240317e-02                 3 1 ON  14
ci_16 1.236696e-02                 3 1 ON  15
ci_17 -1.194072e-02                3 1 ON  16
ci_18 -1.208880e-02                3 1 ON  17
ci_19 1.169603e-02                 3 1 ON  18
ci_20 1.053515e-02                 3 1 ON  19
ci_21 9.892126e-03                 3 1 ON  20
ci_22 9.894600e-03                 3 1 ON  21
ci_23 6.641622e-03                 3 1 ON  22
ci_24 5.397861e-03                 3 1 ON  23
ci_25 5.389850e-03                 3 1 ON  24
ci_26 4.847886e-03                 3 1 ON  25
ci_27 4.863994e-03                 3 1 ON  26
ci_28 4.226843e-03                 3 1 ON  27
ci_29 4.170527e-03                 3 1 ON  28
ci_30 -3.641306e-03                3 1 ON  29
ci_31 -3.624397e-03                3 1 ON  30
ci_32 -3.448096e-03                3 1 ON  31
ci_33 -3.471373e-03                3 1 ON  32
ci_34 2.767493e-03                 3 1 ON  33
ci_35 2.839812e-03                 3 1 ON  34
ci_36 -2.547990e-03                3 1 ON  35
ci_37 -2.575357e-03                3 1 ON  36
ci_38 -2.068805e-03                3 1 ON  37
ci_39 -2.078936e-03                3 1 ON  38
ci_40 -2.080498e-03                3 1 ON  39
ci_41 -2.006938e-03                3 1 ON  40
ci_42 -1.923973e-03                3 1 ON  41
ci_43 -1.995045e-03                3 1 ON  42
ci_44 -1.977846e-03                3 1 ON  43
ci_45 -1.881816e-03                3 1 ON  44
ci_46 -1.862135e-03                3 1 ON  45
ci_47 -1.862883e-03                3 1 ON  46
ci_48 -1.808868e-03                3 1 ON  47
ci_49 -1.748746e-03                3 1 ON  48
ci_50 -1.667138e-03                3 1 ON  49
ci_51 1.660897e-03                 3 1 ON  50
ci_52 1.674264e-03                 3 1 ON  51
ci_53 -1.625425e-03                3 1 ON  52
ci_54 -1.486056e-03                3 1 ON  53
ci_55 -1.504931e-03                3 1 ON  54
ci_56 1.393405e-03                 3 1 ON  55
ci_57 1.456196e-03                 3 1 ON  56
ci_58 -1.253970e-03                3 1 ON  57
ci_59 -1.224248e-03                3 1 ON  58
ci_60 1.174997e-03                 3 1 ON  59
ci_61 1.151245e-03                 3 1 ON  60
ci_62 -1.097745e-03                3 1 ON  61
ci_63 -1.072382e-03                3 1 ON  62
ci_64 -1.033412e-03                3 1 ON  63
ci_65 -1.059047e-03                3 1 ON  64
ci_66 -1.021886e-03                3 1 ON  65
ci_67 -1.024812e-03                3 1 ON  66
ci_68 8.420031e-04                 3 1 ON  67
ci_69 9.471710e-04                 3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7407
    reference variance = 0.433349
====================================================
  Execution time = 4.1976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.2422e-01
  Total weights = 1.9629e+06
  Execution time = 5.9584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511644801387
                                         uncertainty =       0.003217286149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511644801387
                                         uncertainty =       0.003217286149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505748220
  error estimate for blocks of size 2^( 2) =       0.000527283423
  error estimate for blocks of size 2^( 3) =       0.000547295426
  error estimate for blocks of size 2^( 4) =       0.000563191533
  error estimate for blocks of size 2^( 5) =       0.000573635404
  error estimate for blocks of size 2^( 6) =       0.000577071115
  error estimate for blocks of size 2^( 7) =       0.000578728623

      target function =      -0.622454634220
              le_mean =     -22.809650518407
             les_mean =     520.842566029101
             stat err =       0.000573156669
             autocorr =       1.284333985138
   target nu stat err =       0.000573156669
   target dn stat err =       0.027210396088
      target stat err =       0.009676928990
              std dev =       0.715235991339
             le_variance =       0.511562523306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501939864642
                                         uncertainty =       0.003159832008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501939864642
                                         uncertainty =       0.003159832008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500928265
  error estimate for blocks of size 2^( 2) =       0.000522161819
  error estimate for blocks of size 2^( 3) =       0.000542006344
  error estimate for blocks of size 2^( 4) =       0.000557810841
  error estimate for blocks of size 2^( 5) =       0.000568237517
  error estimate for blocks of size 2^( 6) =       0.000571826805
  error estimate for blocks of size 2^( 7) =       0.000573262281

      target function =      -0.635439408755
              le_mean =     -22.809796972786
             les_mean =     520.813944759850
             stat err =       0.000567784361
             autocorr =       1.284741573342
   target nu stat err =       0.000567784361
   target dn stat err =       0.005734938651
      target stat err =       0.002149723283
              std dev =       0.708419545803
             le_variance =       0.501858252876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505642453727
                                         uncertainty =       0.003168440562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505642453727
                                         uncertainty =       0.003168440562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502772709
  error estimate for blocks of size 2^( 2) =       0.000524138501
  error estimate for blocks of size 2^( 3) =       0.000544046556
  error estimate for blocks of size 2^( 4) =       0.000559898988
  error estimate for blocks of size 2^( 5) =       0.000570357795
  error estimate for blocks of size 2^( 6) =       0.000573887153
  error estimate for blocks of size 2^( 7) =       0.000575455237

      target function =      -0.636229335892
              le_mean =     -22.809672194838
             les_mean =     520.806054313212
             stat err =       0.000569899793
             autocorr =       1.284853489371
   target nu stat err =       0.000569899793
   target dn stat err =       0.004376869385
      target stat err =       0.001658616617
              std dev =       0.711027983205
             le_variance =       0.505560792900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510664381635
                                         uncertainty =       0.003198729452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510664381635
                                         uncertainty =       0.003198729452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505263393
  error estimate for blocks of size 2^( 2) =       0.000526778354
  error estimate for blocks of size 2^( 3) =       0.000546777786
  error estimate for blocks of size 2^( 4) =       0.000562676525
  error estimate for blocks of size 2^( 5) =       0.000573135493
  error estimate for blocks of size 2^( 6) =       0.000576588111
  error estimate for blocks of size 2^( 7) =       0.000578246319

      target function =      -0.634598291570
              le_mean =     -22.809635547369
             les_mean =     520.808767362776
             stat err =       0.000572661612
             autocorr =       1.284577981871
   target nu stat err =       0.000572661612
   target dn stat err =       0.003880299947
      target stat err =       0.001471400648
              std dev =       0.714550343637
             le_variance =       0.510582193591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.622454634220        initial
     2.5000e-01     2.5000e+00             5.8061e-03        -0.635439408755
     1.0000e+00     1.0000e+01             1.6312e-03        -0.636229335892  <--
     4.0000e+00     4.0000e+01             4.2077e-04        -0.634598291570

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 7.1878e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_01                 1.626392e-01 3 1  ON 0
ci_02                -5.771268e-02 3 1  ON 1
ci_03                -5.775704e-02 3 1  ON 2
ci_04                 5.725127e-02 3 1  ON 3
ci_05                -4.049833e-02 3 1  ON 4
ci_06                -4.052367e-02 3 1  ON 5
ci_07                 3.052141e-02 3 1  ON 6
ci_08                -1.857246e-02 3 1  ON 7
ci_09                -1.743651e-02 3 1  ON 8
ci_10                -1.734297e-02 3 1  ON 9
ci_11                 1.627098e-02 3 1  ON 10
ci_12                 1.337707e-02 3 1  ON 11
ci_13                 1.271017e-02 3 1  ON 12
ci_14                 1.268595e-02 3 1  ON 13
ci_15                 1.240317e-02 3 1  ON 14
ci_16                 1.236696e-02 3 1  ON 15
ci_17                -1.194072e-02 3 1  ON 16
ci_18                -1.208880e-02 3 1  ON 17
ci_19                 1.169603e-02 3 1  ON 18
ci_20                 1.053515e-02 3 1  ON 19
ci_21                 9.892126e-03 3 1  ON 20
ci_22                 9.894600e-03 3 1  ON 21
ci_23                 6.641622e-03 3 1  ON 22
ci_24                 5.397861e-03 3 1  ON 23
ci_25                 5.389850e-03 3 1  ON 24
ci_26                 4.847886e-03 3 1  ON 25
ci_27                 4.863994e-03 3 1  ON 26
ci_28                 4.226843e-03 3 1  ON 27
ci_29                 4.170527e-03 3 1  ON 28
ci_30                -3.641306e-03 3 1  ON 29
ci_31                -3.624397e-03 3 1  ON 30
ci_32                -3.448096e-03 3 1  ON 31
ci_33                -3.471373e-03 3 1  ON 32
ci_34                 2.767493e-03 3 1  ON 33
ci_35                 2.839812e-03 3 1  ON 34
ci_36                -2.547990e-03 3 1  ON 35
ci_37                -2.575357e-03 3 1  ON 36
ci_38                -2.068805e-03 3 1  ON 37
ci_39                -2.078936e-03 3 1  ON 38
ci_40                -2.080498e-03 3 1  ON 39
ci_41                -2.006938e-03 3 1  ON 40
ci_42                -1.923973e-03 3 1  ON 41
ci_43                -1.995045e-03 3 1  ON 42
ci_44                -1.977846e-03 3 1  ON 43
ci_45                -1.881816e-03 3 1  ON 44
ci_46                -1.862135e-03 3 1  ON 45
ci_47                -1.862883e-03 3 1  ON 46
ci_48                -1.808868e-03 3 1  ON 47
ci_49                -1.748746e-03 3 1  ON 48
ci_50                -1.667138e-03 3 1  ON 49
ci_51                 1.660897e-03 3 1  ON 50
ci_52                 1.674264e-03 3 1  ON 51
ci_53                -1.625425e-03 3 1  ON 52
ci_54                -1.486056e-03 3 1  ON 53
ci_55                -1.504931e-03 3 1  ON 54
ci_56                 1.393405e-03 3 1  ON 55
ci_57                 1.456196e-03 3 1  ON 56
ci_58                -1.253970e-03 3 1  ON 57
ci_59                -1.224248e-03 3 1  ON 58
ci_60                 1.174997e-03 3 1  ON 59
ci_61                 1.151245e-03 3 1  ON 60
ci_62                -1.097745e-03 3 1  ON 61
ci_63                -1.072382e-03 3 1  ON 62
ci_64                -1.033412e-03 3 1  ON 63
ci_65                -1.059047e-03 3 1  ON 64
ci_66                -1.021886e-03 3 1  ON 65
ci_67                -1.024812e-03 3 1  ON 66
ci_68                 8.420031e-04 3 1  ON 67
ci_69                 9.471710e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2299e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2760e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8253
    reference variance = 0.344046
====================================================
  Execution time = 4.3126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2809e+01
  VMC Evar = 5.1748e-01
  Total weights = 1.962890155e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501138956632
                                         uncertainty =       0.002927889742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501138956632
                                         uncertainty =       0.002927889742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500596538
  error estimate for blocks of size 2^( 2) =       0.000521865114
  error estimate for blocks of size 2^( 3) =       0.000541824560
  error estimate for blocks of size 2^( 4) =       0.000558142541
  error estimate for blocks of size 2^( 5) =       0.000567323110
  error estimate for blocks of size 2^( 6) =       0.000573564967
  error estimate for blocks of size 2^( 7) =       0.000577240048

      target function =      -0.638780716413
              le_mean =     -22.808718981129
             les_mean =     520.755141032633
             stat err =       0.000569067667
             autocorr =       1.292266654602
   target nu stat err =       0.000569067667
   target dn stat err =       0.003754954631
      target stat err =       0.001442994414
              std dev =       0.707950412744
             le_variance =       0.501193786904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.280871898113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.638783533944       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.640602095606       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.640886458380       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.640927588727       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.640935589673       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.640938088248       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.640938948220       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.640939031041       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.640939011655       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.640939003565       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.640938998175       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.404871e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.638783533944       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.639291633568       residual = 9.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.639368002572       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.639378544199       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.639380461547       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.639381002048       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.639381176395       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.639381192350       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.639381187414       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.639381185724       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.519596e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.638783533944       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.638914390378       residual = 9.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.638933831195       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.638936478450       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.638936950348       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.638937079547       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.638937120434       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.638937124127       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.638937122898       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.638937122500       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.920614e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0849e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_01                 1.614318e-01 3 1  ON 0
ci_02                -5.642134e-02 3 1  ON 1
ci_03                -5.643029e-02 3 1  ON 2
ci_04                 5.573167e-02 3 1  ON 3
ci_05                -3.959834e-02 3 1  ON 4
ci_06                -3.969105e-02 3 1  ON 5
ci_07                 3.035116e-02 3 1  ON 6
ci_08                -1.794998e-02 3 1  ON 7
ci_09                -1.709623e-02 3 1  ON 8
ci_10                -1.703940e-02 3 1  ON 9
ci_11                 1.613292e-02 3 1  ON 10
ci_12                 1.316043e-02 3 1  ON 11
ci_13                 1.268022e-02 3 1  ON 12
ci_14                 1.272614e-02 3 1  ON 13
ci_15                 1.210978e-02 3 1  ON 14
ci_16                 1.209102e-02 3 1  ON 15
ci_17                -1.180881e-02 3 1  ON 16
ci_18                -1.182494e-02 3 1  ON 17
ci_19                 1.161802e-02 3 1  ON 18
ci_20                 1.039385e-02 3 1  ON 19
ci_21                 9.815354e-03 3 1  ON 20
ci_22                 9.794286e-03 3 1  ON 21
ci_23                 6.580225e-03 3 1  ON 22
ci_24                 5.313074e-03 3 1  ON 23
ci_25                 5.262670e-03 3 1  ON 24
ci_26                 4.795291e-03 3 1  ON 25
ci_27                 4.835277e-03 3 1  ON 26
ci_28                 4.129575e-03 3 1  ON 27
ci_29                 4.119488e-03 3 1  ON 28
ci_30                -3.553377e-03 3 1  ON 29
ci_31                -3.530245e-03 3 1  ON 30
ci_32                -3.288835e-03 3 1  ON 31
ci_33                -3.329423e-03 3 1  ON 32
ci_34                 2.714047e-03 3 1  ON 33
ci_35                 2.743000e-03 3 1  ON 34
ci_36                -2.508468e-03 3 1  ON 35
ci_37                -2.528315e-03 3 1  ON 36
ci_38                -1.982892e-03 3 1  ON 37
ci_39                -1.977942e-03 3 1  ON 38
ci_40                -2.059205e-03 3 1  ON 39
ci_41                -1.934554e-03 3 1  ON 40
ci_42                -1.877788e-03 3 1  ON 41
ci_43                -1.957318e-03 3 1  ON 42
ci_44                -2.048815e-03 3 1  ON 43
ci_45                -1.808734e-03 3 1  ON 44
ci_46                -1.784396e-03 3 1  ON 45
ci_47                -1.769933e-03 3 1  ON 46
ci_48                -1.711511e-03 3 1  ON 47
ci_49                -1.729190e-03 3 1  ON 48
ci_50                -1.615875e-03 3 1  ON 49
ci_51                 1.586059e-03 3 1  ON 50
ci_52                 1.575970e-03 3 1  ON 51
ci_53                -1.593688e-03 3 1  ON 52
ci_54                -1.482896e-03 3 1  ON 53
ci_55                -1.467103e-03 3 1  ON 54
ci_56                 1.420328e-03 3 1  ON 55
ci_57                 1.496085e-03 3 1  ON 56
ci_58                -1.240368e-03 3 1  ON 57
ci_59                -1.205651e-03 3 1  ON 58
ci_60                 1.165474e-03 3 1  ON 59
ci_61                 1.154016e-03 3 1  ON 60
ci_62                -1.043865e-03 3 1  ON 61
ci_63                -1.026060e-03 3 1  ON 62
ci_64                -9.809539e-04 3 1  ON 63
ci_65                -1.065991e-03 3 1  ON 64
ci_66                -9.886367e-04 3 1  ON 65
ci_67                -1.006066e-03 3 1  ON 66
ci_68                 7.903980e-04 3 1  ON 67
ci_69                 7.897659e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.777
    reference variance = 0.404821
====================================================
  Execution time = 4.3159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1720e-01
  Total weights = 1.9630e+06
  Execution time = 6.0021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502370481807
                                         uncertainty =       0.002669608650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502370481807
                                         uncertainty =       0.002669608650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501139158
  error estimate for blocks of size 2^( 2) =       0.000522429750
  error estimate for blocks of size 2^( 3) =       0.000541540062
  error estimate for blocks of size 2^( 4) =       0.000557594836
  error estimate for blocks of size 2^( 5) =       0.000567620272
  error estimate for blocks of size 2^( 6) =       0.000574594472
  error estimate for blocks of size 2^( 7) =       0.000574356290

      target function =      -0.635381841945
              le_mean =     -22.811078058859
             les_mean =     520.873295675031
             stat err =       0.000568541468
             autocorr =       1.287086142447
   target nu stat err =       0.000568541468
   target dn stat err =       0.008624028393
      target stat err =       0.003214540745
              std dev =       0.708717793880
             le_variance =       0.502280911362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495827559577
                                         uncertainty =       0.003608980734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495827559577
                                         uncertainty =       0.003608980734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497859510
  error estimate for blocks of size 2^( 2) =       0.000518884852
  error estimate for blocks of size 2^( 3) =       0.000537819047
  error estimate for blocks of size 2^( 4) =       0.000553702971
  error estimate for blocks of size 2^( 5) =       0.000563666742
  error estimate for blocks of size 2^( 6) =       0.000570675340
  error estimate for blocks of size 2^( 7) =       0.000570065809

      target function =      -0.468615952959
              le_mean =     -22.811207861880
             les_mean =     521.374858686307
             stat err =       0.000564527715
             autocorr =       1.285751154443
   target nu stat err =       0.000564527715
   target dn stat err =       0.502687018526
      target stat err =       0.106634071368
              std dev =       0.704079670626
             le_variance =       0.495728182589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500369992465
                                         uncertainty =       0.004222695622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500369992465
                                         uncertainty =       0.004222695622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500133021
  error estimate for blocks of size 2^( 2) =       0.000521194905
  error estimate for blocks of size 2^( 3) =       0.000540115063
  error estimate for blocks of size 2^( 4) =       0.000556126324
  error estimate for blocks of size 2^( 5) =       0.000565937784
  error estimate for blocks of size 2^( 6) =       0.000572825224
  error estimate for blocks of size 2^( 7) =       0.000572814532

      target function =      -0.072958265756
              le_mean =     -22.811026278318
             les_mean =     528.160481937136
             stat err =       0.000566925966
             autocorr =       1.284936417841
   target nu stat err =       0.000566925966
   target dn stat err =       7.305722135721
      target stat err =       0.059201123736
              std dev =       0.707294901603
             le_variance =       0.500266077834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501927517908
                                         uncertainty =       0.002664344662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501927517908
                                         uncertainty =       0.002664344662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500917928
  error estimate for blocks of size 2^( 2) =       0.000522181681
  error estimate for blocks of size 2^( 3) =       0.000541269558
  error estimate for blocks of size 2^( 4) =       0.000557313938
  error estimate for blocks of size 2^( 5) =       0.000567378726
  error estimate for blocks of size 2^( 6) =       0.000574425388
  error estimate for blocks of size 2^( 7) =       0.000574142169

      target function =      -0.544381908910
              le_mean =     -22.811083222423
             les_mean =     521.126139477757
             stat err =       0.000568315055
             autocorr =       1.287197453046
   target nu stat err =       0.000568315055
   target dn stat err =       0.258358548879
      target stat err =       0.071526437781
              std dev =       0.708404927112
             le_variance =       0.501837540756


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.635381841945        initial  <--
     2.5000e-01     2.5000e+00             5.4049e-03        -0.468615952959
     1.0000e+00     1.0000e+01             1.5196e-03        -0.072958265756
     4.0000e+00     4.0000e+01             3.9206e-04        -0.544381908910

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 77.1142
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_01                 1.626392e-01 3 1  ON 0
ci_02                -5.771268e-02 3 1  ON 1
ci_03                -5.775704e-02 3 1  ON 2
ci_04                 5.725127e-02 3 1  ON 3
ci_05                -4.049833e-02 3 1  ON 4
ci_06                -4.052367e-02 3 1  ON 5
ci_07                 3.052141e-02 3 1  ON 6
ci_08                -1.857246e-02 3 1  ON 7
ci_09                -1.743651e-02 3 1  ON 8
ci_10                -1.734297e-02 3 1  ON 9
ci_11                 1.627098e-02 3 1  ON 10
ci_12                 1.337707e-02 3 1  ON 11
ci_13                 1.271017e-02 3 1  ON 12
ci_14                 1.268595e-02 3 1  ON 13
ci_15                 1.240317e-02 3 1  ON 14
ci_16                 1.236696e-02 3 1  ON 15
ci_17                -1.194072e-02 3 1  ON 16
ci_18                -1.208880e-02 3 1  ON 17
ci_19                 1.169603e-02 3 1  ON 18
ci_20                 1.053515e-02 3 1  ON 19
ci_21                 9.892126e-03 3 1  ON 20
ci_22                 9.894600e-03 3 1  ON 21
ci_23                 6.641622e-03 3 1  ON 22
ci_24                 5.397861e-03 3 1  ON 23
ci_25                 5.389850e-03 3 1  ON 24
ci_26                 4.847886e-03 3 1  ON 25
ci_27                 4.863994e-03 3 1  ON 26
ci_28                 4.226843e-03 3 1  ON 27
ci_29                 4.170527e-03 3 1  ON 28
ci_30                -3.641306e-03 3 1  ON 29
ci_31                -3.624397e-03 3 1  ON 30
ci_32                -3.448096e-03 3 1  ON 31
ci_33                -3.471373e-03 3 1  ON 32
ci_34                 2.767493e-03 3 1  ON 33
ci_35                 2.839812e-03 3 1  ON 34
ci_36                -2.547990e-03 3 1  ON 35
ci_37                -2.575357e-03 3 1  ON 36
ci_38                -2.068805e-03 3 1  ON 37
ci_39                -2.078936e-03 3 1  ON 38
ci_40                -2.080498e-03 3 1  ON 39
ci_41                -2.006938e-03 3 1  ON 40
ci_42                -1.923973e-03 3 1  ON 41
ci_43                -1.995045e-03 3 1  ON 42
ci_44                -1.977846e-03 3 1  ON 43
ci_45                -1.881816e-03 3 1  ON 44
ci_46                -1.862135e-03 3 1  ON 45
ci_47                -1.862883e-03 3 1  ON 46
ci_48                -1.808868e-03 3 1  ON 47
ci_49                -1.748746e-03 3 1  ON 48
ci_50                -1.667138e-03 3 1  ON 49
ci_51                 1.660897e-03 3 1  ON 50
ci_52                 1.674264e-03 3 1  ON 51
ci_53                -1.625425e-03 3 1  ON 52
ci_54                -1.486056e-03 3 1  ON 53
ci_55                -1.504931e-03 3 1  ON 54
ci_56                 1.393405e-03 3 1  ON 55
ci_57                 1.456196e-03 3 1  ON 56
ci_58                -1.253970e-03 3 1  ON 57
ci_59                -1.224248e-03 3 1  ON 58
ci_60                 1.174997e-03 3 1  ON 59
ci_61                 1.151245e-03 3 1  ON 60
ci_62                -1.097745e-03 3 1  ON 61
ci_63                -1.072382e-03 3 1  ON 62
ci_64                -1.033412e-03 3 1  ON 63
ci_65                -1.059047e-03 3 1  ON 64
ci_66                -1.021886e-03 3 1  ON 65
ci_67                -1.024812e-03 3 1  ON 66
ci_68                 8.420031e-04 3 1  ON 67
ci_69                 9.471710e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2804e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2781e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7267
    reference variance = 0.452524
====================================================
  Execution time = 4.2771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1676e-01
  Total weights = 1.962789545e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500498614565
                                         uncertainty =       0.002763191793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500498614565
                                         uncertainty =       0.002763191793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500352534
  error estimate for blocks of size 2^( 2) =       0.000521508931
  error estimate for blocks of size 2^( 3) =       0.000540920162
  error estimate for blocks of size 2^( 4) =       0.000555476794
  error estimate for blocks of size 2^( 5) =       0.000565356970
  error estimate for blocks of size 2^( 6) =       0.000569897350
  error estimate for blocks of size 2^( 7) =       0.000569989038

      target function =      -0.639538905524
              le_mean =     -22.810833912656
             les_mean =     520.850901566003
             stat err =       0.000565180038
             autocorr =       1.275914052440
   target nu stat err =       0.000565180038
   target dn stat err =       0.003935549433
      target stat err =       0.001514709568
              std dev =       0.707605340222
             le_variance =       0.500705317510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281083391266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.639542074208       residual = 7.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.639756893093       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.639788032621       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.639792201191       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.639793118447       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.639793336144       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.639793438853       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.639793426953       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.639793424521       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.639793425293       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 6.564245e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.639542074208       residual = 7.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.639596431318       residual = 9.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.639604273478       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.639605317371       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.639605545168       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.639605598622       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.639605623818       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.639605620845       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.639605620249       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.639605620439       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.662181e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.639542074208       residual = 7.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.639555704860       residual = 9.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.639557668998       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.639557930074       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.639557986926       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.639558000228       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.639558006496       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.639558005754       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.639558005605       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.639558005653       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 4.168857e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0479e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_01                 1.625077e-01 3 1  ON 0
ci_02                -5.757537e-02 3 1  ON 1
ci_03                -5.762321e-02 3 1  ON 2
ci_04                 5.708505e-02 3 1  ON 3
ci_05                -4.040763e-02 3 1  ON 4
ci_06                -4.043635e-02 3 1  ON 5
ci_07                 3.050638e-02 3 1  ON 6
ci_08                -1.851043e-02 3 1  ON 7
ci_09                -1.740396e-02 3 1  ON 8
ci_10                -1.731363e-02 3 1  ON 9
ci_11                 1.625843e-02 3 1  ON 10
ci_12                 1.335327e-02 3 1  ON 11
ci_13                 1.270659e-02 3 1  ON 12
ci_14                 1.268679e-02 3 1  ON 13
ci_15                 1.238291e-02 3 1  ON 14
ci_16                 1.233524e-02 3 1  ON 15
ci_17                -1.192015e-02 3 1  ON 16
ci_18                -1.206914e-02 3 1  ON 17
ci_19                 1.167999e-02 3 1  ON 18
ci_20                 1.052333e-02 3 1  ON 19
ci_21                 9.885750e-03 3 1  ON 20
ci_22                 9.893084e-03 3 1  ON 21
ci_23                 6.630780e-03 3 1  ON 22
ci_24                 5.393948e-03 3 1  ON 23
ci_25                 5.378130e-03 3 1  ON 24
ci_26                 4.840222e-03 3 1  ON 25
ci_27                 4.860190e-03 3 1  ON 26
ci_28                 4.218740e-03 3 1  ON 27
ci_29                 4.163649e-03 3 1  ON 28
ci_30                -3.633315e-03 3 1  ON 29
ci_31                -3.616264e-03 3 1  ON 30
ci_32                -3.430832e-03 3 1  ON 31
ci_33                -3.456755e-03 3 1  ON 32
ci_34                 2.758728e-03 3 1  ON 33
ci_35                 2.826543e-03 3 1  ON 34
ci_36                -2.539656e-03 3 1  ON 35
ci_37                -2.568808e-03 3 1  ON 36
ci_38                -2.060199e-03 3 1  ON 37
ci_39                -2.069193e-03 3 1  ON 38
ci_40                -2.076530e-03 3 1  ON 39
ci_41                -2.001905e-03 3 1  ON 40
ci_42                -1.914462e-03 3 1  ON 41
ci_43                -2.001884e-03 3 1  ON 42
ci_44                -1.980529e-03 3 1  ON 43
ci_45                -1.873685e-03 3 1  ON 44
ci_46                -1.856010e-03 3 1  ON 45
ci_47                -1.860094e-03 3 1  ON 46
ci_48                -1.798328e-03 3 1  ON 47
ci_49                -1.746607e-03 3 1  ON 48
ci_50                -1.661062e-03 3 1  ON 49
ci_51                 1.653527e-03 3 1  ON 50
ci_52                 1.665175e-03 3 1  ON 51
ci_53                -1.623095e-03 3 1  ON 52
ci_54                -1.483445e-03 3 1  ON 53
ci_55                -1.501259e-03 3 1  ON 54
ci_56                 1.391957e-03 3 1  ON 55
ci_57                 1.461414e-03 3 1  ON 56
ci_58                -1.252808e-03 3 1  ON 57
ci_59                -1.221581e-03 3 1  ON 58
ci_60                 1.177769e-03 3 1  ON 59
ci_61                 1.148934e-03 3 1  ON 60
ci_62                -1.091037e-03 3 1  ON 61
ci_63                -1.072525e-03 3 1  ON 62
ci_64                -1.028301e-03 3 1  ON 63
ci_65                -1.057311e-03 3 1  ON 64
ci_66                -1.015763e-03 3 1  ON 65
ci_67                -1.022633e-03 3 1  ON 66
ci_68                 8.341463e-04 3 1  ON 67
ci_69                 9.384312e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7763
    reference variance = 0.419451
====================================================
  Execution time = 4.1607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1861e-01
  Total weights = 1.9627e+06
  Execution time = 6.0140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502410048381
                                         uncertainty =       0.002900507442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502410048381
                                         uncertainty =       0.002900507442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501189844
  error estimate for blocks of size 2^( 2) =       0.000522109606
  error estimate for blocks of size 2^( 3) =       0.000541731545
  error estimate for blocks of size 2^( 4) =       0.000556727281
  error estimate for blocks of size 2^( 5) =       0.000565201228
  error estimate for blocks of size 2^( 6) =       0.000570257208
  error estimate for blocks of size 2^( 7) =       0.000573514882

      target function =      -0.638399951947
              le_mean =     -22.809640073371
             les_mean =     520.798745447556
             stat err =       0.000566425150
             autocorr =       1.277263588572
   target nu stat err =       0.000566425150
   target dn stat err =       0.003718117138
      target stat err =       0.001428784744
              std dev =       0.708789475186
             le_variance =       0.502382520134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501259206173
                                         uncertainty =       0.002897369688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501259206173
                                         uncertainty =       0.002897369688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500615421
  error estimate for blocks of size 2^( 2) =       0.000521501229
  error estimate for blocks of size 2^( 3) =       0.000541102084
  error estimate for blocks of size 2^( 4) =       0.000556084489
  error estimate for blocks of size 2^( 5) =       0.000564551424
  error estimate for blocks of size 2^( 6) =       0.000569613861
  error estimate for blocks of size 2^( 7) =       0.000572858296

      target function =      -0.638910198362
              le_mean =     -22.809647868897
             les_mean =     520.797741769661
             stat err =       0.000565777017
             autocorr =       1.277268366874
   target nu stat err =       0.000565777017
   target dn stat err =       0.003738287589
      target stat err =       0.001438277358
              std dev =       0.707977117967
             le_variance =       0.501231599565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501820714415
                                         uncertainty =       0.002898797311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501820714415
                                         uncertainty =       0.002898797311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500895773
  error estimate for blocks of size 2^( 2) =       0.000521798228
  error estimate for blocks of size 2^( 3) =       0.000541409501
  error estimate for blocks of size 2^( 4) =       0.000556398449
  error estimate for blocks of size 2^( 5) =       0.000564868791
  error estimate for blocks of size 2^( 6) =       0.000569927977
  error estimate for blocks of size 2^( 7) =       0.000573179484

      target function =      -0.638694260004
              le_mean =     -22.809643147681
             les_mean =     520.798100589325
             stat err =       0.000566093675
             autocorr =       1.277267527815
   target nu stat err =       0.000566093675
   target dn stat err =       0.003711844191
      target stat err =       0.001427743087
              std dev =       0.708373596164
             le_variance =       0.501793151743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502335370361
                                         uncertainty =       0.002900278385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502335370361
                                         uncertainty =       0.002900278385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501152591
  error estimate for blocks of size 2^( 2) =       0.000522070160
  error estimate for blocks of size 2^( 3) =       0.000541690752
  error estimate for blocks of size 2^( 4) =       0.000556685637
  error estimate for blocks of size 2^( 5) =       0.000565159092
  error estimate for blocks of size 2^( 6) =       0.000570215553
  error estimate for blocks of size 2^( 7) =       0.000573472570

      target function =      -0.638344358669
              le_mean =     -22.809640324487
             les_mean =     520.798905769813
             stat err =       0.000566383213
             autocorr =       1.277264335875
   target nu stat err =       0.000566383213
   target dn stat err =       0.003725826928
      target stat err =       0.001431340009
              std dev =       0.708736790645
             le_variance =       0.502307838414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.638399951947        initial
     2.5000e+00     2.5000e+01             6.5642e-04        -0.638910198362  <--
     1.0000e+01     1.0000e+02             1.6622e-04        -0.638694260004
     4.0000e+01     4.0000e+02             4.1689e-05        -0.638344358669

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 7.1796e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_01                 1.621170e-01 3 1  ON 0
ci_02                -5.716961e-02 3 1  ON 1
ci_03                -5.722767e-02 3 1  ON 2
ci_04                 5.659484e-02 3 1  ON 3
ci_05                -4.013985e-02 3 1  ON 4
ci_06                -4.017855e-02 3 1  ON 5
ci_07                 3.046189e-02 3 1  ON 6
ci_08                -1.832737e-02 3 1  ON 7
ci_09                -1.730758e-02 3 1  ON 8
ci_10                -1.722677e-02 3 1  ON 9
ci_11                 1.622138e-02 3 1  ON 10
ci_12                 1.328299e-02 3 1  ON 11
ci_13                 1.269602e-02 3 1  ON 12
ci_14                 1.268941e-02 3 1  ON 13
ci_15                 1.232300e-02 3 1  ON 14
ci_16                 1.224147e-02 3 1  ON 15
ci_17                -1.185923e-02 3 1  ON 16
ci_18                -1.201091e-02 3 1  ON 17
ci_19                 1.163277e-02 3 1  ON 18
ci_20                 1.048845e-02 3 1  ON 19
ci_21                 9.866784e-03 3 1  ON 20
ci_22                 9.888603e-03 3 1  ON 21
ci_23                 6.598830e-03 3 1  ON 22
ci_24                 5.382416e-03 3 1  ON 23
ci_25                 5.343571e-03 3 1  ON 24
ci_26                 4.817617e-03 3 1  ON 25
ci_27                 4.848998e-03 3 1  ON 26
ci_28                 4.194685e-03 3 1  ON 27
ci_29                 4.143217e-03 3 1  ON 28
ci_30                -3.609529e-03 3 1  ON 29
ci_31                -3.592109e-03 3 1  ON 30
ci_32                -3.380046e-03 3 1  ON 31
ci_33                -3.413792e-03 3 1  ON 32
ci_34                 2.733002e-03 3 1  ON 33
ci_35                 2.787528e-03 3 1  ON 34
ci_36                -2.515016e-03 3 1  ON 35
ci_37                -2.549444e-03 3 1  ON 36
ci_38                -2.034775e-03 3 1  ON 37
ci_39                -2.040431e-03 3 1  ON 38
ci_40                -2.064833e-03 3 1  ON 39
ci_41                -1.987180e-03 3 1  ON 40
ci_42                -1.886565e-03 3 1  ON 41
ci_43                -2.021970e-03 3 1  ON 42
ci_44                -1.988358e-03 3 1  ON 43
ci_45                -1.849681e-03 3 1  ON 44
ci_46                -1.837934e-03 3 1  ON 45
ci_47                -1.851775e-03 3 1  ON 46
ci_48                -1.766987e-03 3 1  ON 47
ci_49                -1.740280e-03 3 1  ON 48
ci_50                -1.643154e-03 3 1  ON 49
ci_51                 1.631761e-03 3 1  ON 50
ci_52                 1.638351e-03 3 1  ON 51
ci_53                -1.616224e-03 3 1  ON 52
ci_54                -1.475741e-03 3 1  ON 53
ci_55                -1.490419e-03 3 1  ON 54
ci_56                 1.387716e-03 3 1  ON 55
ci_57                 1.476840e-03 3 1  ON 56
ci_58                -1.249376e-03 3 1  ON 57
ci_59                -1.213712e-03 3 1  ON 58
ci_60                 1.186019e-03 3 1  ON 59
ci_61                 1.142074e-03 3 1  ON 60
ci_62                -1.071233e-03 3 1  ON 61
ci_63                -1.072921e-03 3 1  ON 62
ci_64                -1.013203e-03 3 1  ON 63
ci_65                -1.052154e-03 3 1  ON 64
ci_66                -9.976703e-04 3 1  ON 65
ci_67                -1.016176e-03 3 1  ON 66
ci_68                 8.109277e-04 3 1  ON 67
ci_69                 9.126023e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2228e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2771e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8417
    reference variance = 0.433989
====================================================
  Execution time = 4.2708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.2736e-01
  Total weights = 1.962918179e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501373416804
                                         uncertainty =       0.003490595479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501373416804
                                         uncertainty =       0.003490595479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500755633
  error estimate for blocks of size 2^( 2) =       0.000522037181
  error estimate for blocks of size 2^( 3) =       0.000541422703
  error estimate for blocks of size 2^( 4) =       0.000555459837
  error estimate for blocks of size 2^( 5) =       0.000565305908
  error estimate for blocks of size 2^( 6) =       0.000569739043
  error estimate for blocks of size 2^( 7) =       0.000573437098

      target function =      -0.635328044399
              le_mean =     -22.809767434821
             les_mean =     520.812849913379
             stat err =       0.000565985472
             autocorr =       1.277494031077
   target nu stat err =       0.000565985472
   target dn stat err =       0.009176691570
      target stat err =       0.003413595676
              std dev =       0.708175407985
             le_variance =       0.501512408475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.280976743482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.635346049260       residual = 7.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.636122006321       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.636231530101       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.636247792635       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.636252894337       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.636255042005       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.636255223169       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.636255291689       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.636255315525       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.636255312968       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.336063e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.635346049260       residual = 7.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.635549266016       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.635577433897       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.635581528862       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.635582784327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.635583292106       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.635583332584       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.635583348736       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.635583354328       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.635583353689       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 6.135132e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.635346049260       residual = 7.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.635397463783       residual = 9.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.635404555870       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.635405581103       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.635405893508       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.635406018519       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.635406028338       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.635406032312       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.635406033687       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.635406033527       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.553356e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0394e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_01                 1.615840e-01 3 1  ON 0
ci_02                -5.664615e-02 3 1  ON 1
ci_03                -5.670422e-02 3 1  ON 2
ci_04                 5.598133e-02 3 1  ON 3
ci_05                -3.981581e-02 3 1  ON 4
ci_06                -3.983848e-02 3 1  ON 5
ci_07                 3.038019e-02 3 1  ON 6
ci_08                -1.808493e-02 3 1  ON 7
ci_09                -1.716673e-02 3 1  ON 8
ci_10                -1.712253e-02 3 1  ON 9
ci_11                 1.616267e-02 3 1  ON 10
ci_12                 1.317976e-02 3 1  ON 11
ci_13                 1.268439e-02 3 1  ON 12
ci_14                 1.271444e-02 3 1  ON 13
ci_15                 1.223752e-02 3 1  ON 14
ci_16                 1.212261e-02 3 1  ON 15
ci_17                -1.177956e-02 3 1  ON 16
ci_18                -1.194043e-02 3 1  ON 17
ci_19                 1.158185e-02 3 1  ON 18
ci_20                 1.043281e-02 3 1  ON 19
ci_21                 9.850850e-03 3 1  ON 20
ci_22                 9.869864e-03 3 1  ON 21
ci_23                 6.554229e-03 3 1  ON 22
ci_24                 5.329021e-03 3 1  ON 23
ci_25                 5.290672e-03 3 1  ON 24
ci_26                 4.781861e-03 3 1  ON 25
ci_27                 4.831897e-03 3 1  ON 26
ci_28                 4.146352e-03 3 1  ON 27
ci_29                 4.111748e-03 3 1  ON 28
ci_30                -3.566820e-03 3 1  ON 29
ci_31                -3.536900e-03 3 1  ON 30
ci_32                -3.309469e-03 3 1  ON 31
ci_33                -3.377209e-03 3 1  ON 32
ci_34                 2.690820e-03 3 1  ON 33
ci_35                 2.764496e-03 3 1  ON 34
ci_36                -2.498848e-03 3 1  ON 35
ci_37                -2.516316e-03 3 1  ON 36
ci_38                -2.010328e-03 3 1  ON 37
ci_39                -2.045746e-03 3 1  ON 38
ci_40                -2.066907e-03 3 1  ON 39
ci_41                -1.971236e-03 3 1  ON 40
ci_42                -1.857389e-03 3 1  ON 41
ci_43                -2.019164e-03 3 1  ON 42
ci_44                -2.013937e-03 3 1  ON 43
ci_45                -1.823438e-03 3 1  ON 44
ci_46                -1.825074e-03 3 1  ON 45
ci_47                -1.805188e-03 3 1  ON 46
ci_48                -1.733260e-03 3 1  ON 47
ci_49                -1.741165e-03 3 1  ON 48
ci_50                -1.618691e-03 3 1  ON 49
ci_51                 1.604919e-03 3 1  ON 50
ci_52                 1.642489e-03 3 1  ON 51
ci_53                -1.601408e-03 3 1  ON 52
ci_54                -1.467244e-03 3 1  ON 53
ci_55                -1.488118e-03 3 1  ON 54
ci_56                 1.404280e-03 3 1  ON 55
ci_57                 1.495975e-03 3 1  ON 56
ci_58                -1.246577e-03 3 1  ON 57
ci_59                -1.192760e-03 3 1  ON 58
ci_60                 1.179795e-03 3 1  ON 59
ci_61                 1.102916e-03 3 1  ON 60
ci_62                -1.046544e-03 3 1  ON 61
ci_63                -1.066519e-03 3 1  ON 62
ci_64                -1.003205e-03 3 1  ON 63
ci_65                -1.034746e-03 3 1  ON 64
ci_66                -9.955715e-04 3 1  ON 65
ci_67                -9.996056e-04 3 1  ON 66
ci_68                 8.130587e-04 3 1  ON 67
ci_69                 8.811108e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.9003
    reference variance = 0.317819
====================================================
  Execution time = 4.1479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1687e-01
  Total weights = 1.9631e+06
  Execution time = 5.9910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501105260390
                                         uncertainty =       0.002693514254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501105260390
                                         uncertainty =       0.002693514254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500532120
  error estimate for blocks of size 2^( 2) =       0.000521619229
  error estimate for blocks of size 2^( 3) =       0.000541534586
  error estimate for blocks of size 2^( 4) =       0.000556206935
  error estimate for blocks of size 2^( 5) =       0.000564758221
  error estimate for blocks of size 2^( 6) =       0.000570578749
  error estimate for blocks of size 2^( 7) =       0.000572671500

      target function =      -0.638959245902
              le_mean =     -22.810675936664
             les_mean =     520.845144383199
             stat err =       0.000566053851
             autocorr =       1.278944192634
   target nu stat err =       0.000566053851
   target dn stat err =       0.003503799899
      target stat err =       0.001354522437
              std dev =       0.707859313000
             le_variance =       0.501064807001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497053850796
                                         uncertainty =       0.002638143821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497053850796
                                         uncertainty =       0.002638143821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498504036
  error estimate for blocks of size 2^( 2) =       0.000519477469
  error estimate for blocks of size 2^( 3) =       0.000539315323
  error estimate for blocks of size 2^( 4) =       0.000553934376
  error estimate for blocks of size 2^( 5) =       0.000562495987
  error estimate for blocks of size 2^( 6) =       0.000568259750
  error estimate for blocks of size 2^( 7) =       0.000570348556

      target function =      -0.634864601805
              le_mean =     -22.810735051345
             les_mean =     520.858735542055
             stat err =       0.000563759667
             autocorr =       1.278941401939
   target nu stat err =       0.000563759667
   target dn stat err =       0.015729611962
      target stat err =       0.005830071844
              std dev =       0.704991168714
             le_variance =       0.497012547964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498859694084
                                         uncertainty =       0.002665413928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498859694084
                                         uncertainty =       0.002665413928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499409105
  error estimate for blocks of size 2^( 2) =       0.000520435761
  error estimate for blocks of size 2^( 3) =       0.000540308323
  error estimate for blocks of size 2^( 4) =       0.000554954497
  error estimate for blocks of size 2^( 5) =       0.000563510111
  error estimate for blocks of size 2^( 6) =       0.000569306760
  error estimate for blocks of size 2^( 7) =       0.000571415654

      target function =      -0.639304086103
              le_mean =     -22.810693765408
             les_mean =     520.845048130480
             stat err =       0.000564796755
             autocorr =       1.279002736190
   target nu stat err =       0.000564796755
   target dn stat err =       0.003732269572
      target stat err =       0.001439057053
              std dev =       0.706271130111
             le_variance =       0.498818909228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500811010722
                                         uncertainty =       0.002689836989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500811010722
                                         uncertainty =       0.002689836989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500385111
  error estimate for blocks of size 2^( 2) =       0.000521463973
  error estimate for blocks of size 2^( 3) =       0.000541373817
  error estimate for blocks of size 2^( 4) =       0.000556043053
  error estimate for blocks of size 2^( 5) =       0.000564594950
  error estimate for blocks of size 2^( 6) =       0.000570412282
  error estimate for blocks of size 2^( 7) =       0.000572506011

      target function =      -0.638703657837
              le_mean =     -22.810676754749
             les_mean =     520.845862919206
             stat err =       0.000565889074
             autocorr =       1.278950865625
   target nu stat err =       0.000565889074
   target dn stat err =       0.003855107887
      target stat err =       0.001481349065
              std dev =       0.707651410321
             le_variance =       0.500770518530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.638959245902        initial
     6.2500e-01     6.2500e+00             2.3361e-03        -0.634864601805
     2.5000e+00     2.5000e+01             6.1351e-04        -0.639304086103  <--
     1.0000e+01     1.0000e+02             1.5534e-04        -0.638703657837

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 7.2257e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_01                 1.615840e-01 3 1  ON 0
ci_02                -5.664615e-02 3 1  ON 1
ci_03                -5.670422e-02 3 1  ON 2
ci_04                 5.598133e-02 3 1  ON 3
ci_05                -3.981581e-02 3 1  ON 4
ci_06                -3.983848e-02 3 1  ON 5
ci_07                 3.038019e-02 3 1  ON 6
ci_08                -1.808493e-02 3 1  ON 7
ci_09                -1.716673e-02 3 1  ON 8
ci_10                -1.712253e-02 3 1  ON 9
ci_11                 1.616267e-02 3 1  ON 10
ci_12                 1.317976e-02 3 1  ON 11
ci_13                 1.268439e-02 3 1  ON 12
ci_14                 1.271444e-02 3 1  ON 13
ci_15                 1.223752e-02 3 1  ON 14
ci_16                 1.212261e-02 3 1  ON 15
ci_17                -1.177956e-02 3 1  ON 16
ci_18                -1.194043e-02 3 1  ON 17
ci_19                 1.158185e-02 3 1  ON 18
ci_20                 1.043281e-02 3 1  ON 19
ci_21                 9.850850e-03 3 1  ON 20
ci_22                 9.869864e-03 3 1  ON 21
ci_23                 6.554229e-03 3 1  ON 22
ci_24                 5.329021e-03 3 1  ON 23
ci_25                 5.290672e-03 3 1  ON 24
ci_26                 4.781861e-03 3 1  ON 25
ci_27                 4.831897e-03 3 1  ON 26
ci_28                 4.146352e-03 3 1  ON 27
ci_29                 4.111748e-03 3 1  ON 28
ci_30                -3.566820e-03 3 1  ON 29
ci_31                -3.536900e-03 3 1  ON 30
ci_32                -3.309469e-03 3 1  ON 31
ci_33                -3.377209e-03 3 1  ON 32
ci_34                 2.690820e-03 3 1  ON 33
ci_35                 2.764496e-03 3 1  ON 34
ci_36                -2.498848e-03 3 1  ON 35
ci_37                -2.516316e-03 3 1  ON 36
ci_38                -2.010328e-03 3 1  ON 37
ci_39                -2.045746e-03 3 1  ON 38
ci_40                -2.066907e-03 3 1  ON 39
ci_41                -1.971236e-03 3 1  ON 40
ci_42                -1.857389e-03 3 1  ON 41
ci_43                -2.019164e-03 3 1  ON 42
ci_44                -2.013937e-03 3 1  ON 43
ci_45                -1.823438e-03 3 1  ON 44
ci_46                -1.825074e-03 3 1  ON 45
ci_47                -1.805188e-03 3 1  ON 46
ci_48                -1.733260e-03 3 1  ON 47
ci_49                -1.741165e-03 3 1  ON 48
ci_50                -1.618691e-03 3 1  ON 49
ci_51                 1.604919e-03 3 1  ON 50
ci_52                 1.642489e-03 3 1  ON 51
ci_53                -1.601408e-03 3 1  ON 52
ci_54                -1.467244e-03 3 1  ON 53
ci_55                -1.488118e-03 3 1  ON 54
ci_56                 1.404280e-03 3 1  ON 55
ci_57                 1.495975e-03 3 1  ON 56
ci_58                -1.246577e-03 3 1  ON 57
ci_59                -1.192760e-03 3 1  ON 58
ci_60                 1.179795e-03 3 1  ON 59
ci_61                 1.102916e-03 3 1  ON 60
ci_62                -1.046544e-03 3 1  ON 61
ci_63                -1.066519e-03 3 1  ON 62
ci_64                -1.003205e-03 3 1  ON 63
ci_65                -1.034746e-03 3 1  ON 64
ci_66                -9.955715e-04 3 1  ON 65
ci_67                -9.996056e-04 3 1  ON 66
ci_68                 8.130587e-04 3 1  ON 67
ci_69                 8.811108e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2266e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2796e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8006
    reference variance = 0.258782
====================================================
  Execution time = 4.4264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.2220e-01
  Total weights = 1.962704852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504758853839
                                         uncertainty =       0.004445520752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504758853839
                                         uncertainty =       0.004445520752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502319128
  error estimate for blocks of size 2^( 2) =       0.000523490357
  error estimate for blocks of size 2^( 3) =       0.000543184747
  error estimate for blocks of size 2^( 4) =       0.000558890617
  error estimate for blocks of size 2^( 5) =       0.000568604474
  error estimate for blocks of size 2^( 6) =       0.000574145856
  error estimate for blocks of size 2^( 7) =       0.000576761464

      target function =      -0.637202844341
              le_mean =     -22.809526376652
             les_mean =     520.796689240222
             stat err =       0.000569600603
             autocorr =       1.285823764195
   target nu stat err =       0.000569600603
   target dn stat err =       0.005376180688
      target stat err =       0.002029270428
              std dev =       0.710386523427
             le_variance =       0.504649012667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.280952637665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637208844599       residual = 6.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.637959534982       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.638065854000       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.638080893725       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.638084704039       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.638086318859       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.638086389358       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.638086395431       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.638086405134       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.638086403731       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.386725e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637208844599       residual = 6.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.637405487721       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.637432867865       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.637436668289       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.637437607395       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.637437990254       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.637438002353       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.637438003700       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.637438005937       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.637438005553       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 6.268949e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637208844599       residual = 6.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.637258598923       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.637265495132       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.637266447514       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.637266681285       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.637266775607       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.637266778287       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.637266778615       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.637266779162       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.637266779064       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.587291e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1987e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_01                 1.611040e-01 3 1  ON 0
ci_02                -5.611791e-02 3 1  ON 1
ci_03                -5.619273e-02 3 1  ON 2
ci_04                 5.535443e-02 3 1  ON 3
ci_05                -3.946264e-02 3 1  ON 4
ci_06                -3.952988e-02 3 1  ON 5
ci_07                 3.031501e-02 3 1  ON 6
ci_08                -1.785993e-02 3 1  ON 7
ci_09                -1.699900e-02 3 1  ON 8
ci_10                -1.701874e-02 3 1  ON 9
ci_11                 1.610073e-02 3 1  ON 10
ci_12                 1.306251e-02 3 1  ON 11
ci_13                 1.266886e-02 3 1  ON 12
ci_14                 1.272393e-02 3 1  ON 13
ci_15                 1.214201e-02 3 1  ON 14
ci_16                 1.203827e-02 3 1  ON 15
ci_17                -1.171247e-02 3 1  ON 16
ci_18                -1.185159e-02 3 1  ON 17
ci_19                 1.154343e-02 3 1  ON 18
ci_20                 1.035618e-02 3 1  ON 19
ci_21                 9.828458e-03 3 1  ON 20
ci_22                 9.857674e-03 3 1  ON 21
ci_23                 6.507772e-03 3 1  ON 22
ci_24                 5.324286e-03 3 1  ON 23
ci_25                 5.246100e-03 3 1  ON 24
ci_26                 4.727734e-03 3 1  ON 25
ci_27                 4.784429e-03 3 1  ON 26
ci_28                 4.085428e-03 3 1  ON 27
ci_29                 4.073962e-03 3 1  ON 28
ci_30                -3.530104e-03 3 1  ON 29
ci_31                -3.497173e-03 3 1  ON 30
ci_32                -3.260401e-03 3 1  ON 31
ci_33                -3.352350e-03 3 1  ON 32
ci_34                 2.637561e-03 3 1  ON 33
ci_35                 2.721465e-03 3 1  ON 34
ci_36                -2.483513e-03 3 1  ON 35
ci_37                -2.503253e-03 3 1  ON 36
ci_38                -1.984357e-03 3 1  ON 37
ci_39                -2.012407e-03 3 1  ON 38
ci_40                -2.050310e-03 3 1  ON 39
ci_41                -1.925198e-03 3 1  ON 40
ci_42                -1.823770e-03 3 1  ON 41
ci_43                -2.037209e-03 3 1  ON 42
ci_44                -2.016084e-03 3 1  ON 43
ci_45                -1.800994e-03 3 1  ON 44
ci_46                -1.806141e-03 3 1  ON 45
ci_47                -1.771996e-03 3 1  ON 46
ci_48                -1.701009e-03 3 1  ON 47
ci_49                -1.733296e-03 3 1  ON 48
ci_50                -1.586818e-03 3 1  ON 49
ci_51                 1.589950e-03 3 1  ON 50
ci_52                 1.612463e-03 3 1  ON 51
ci_53                -1.585854e-03 3 1  ON 52
ci_54                -1.430707e-03 3 1  ON 53
ci_55                -1.474403e-03 3 1  ON 54
ci_56                 1.445028e-03 3 1  ON 55
ci_57                 1.495906e-03 3 1  ON 56
ci_58                -1.247446e-03 3 1  ON 57
ci_59                -1.174942e-03 3 1  ON 58
ci_60                 1.176578e-03 3 1  ON 59
ci_61                 1.118570e-03 3 1  ON 60
ci_62                -1.045871e-03 3 1  ON 61
ci_63                -1.052874e-03 3 1  ON 62
ci_64                -9.806620e-04 3 1  ON 63
ci_65                -1.015281e-03 3 1  ON 64
ci_66                -9.896193e-04 3 1  ON 65
ci_67                -9.812326e-04 3 1  ON 66
ci_68                 7.837745e-04 3 1  ON 67
ci_69                 8.497616e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.841
    reference variance = 0.376741
====================================================
  Execution time = 4.1605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2810e+01
  VMC Evar = 5.1126e-01
  Total weights = 1.9631e+06
  Execution time = 5.9852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495659993675
                                         uncertainty =       0.002185254041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495659993675
                                         uncertainty =       0.002185254041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497788580
  error estimate for blocks of size 2^( 2) =       0.000519090618
  error estimate for blocks of size 2^( 3) =       0.000539884919
  error estimate for blocks of size 2^( 4) =       0.000553851216
  error estimate for blocks of size 2^( 5) =       0.000563032816
  error estimate for blocks of size 2^( 6) =       0.000566108404
  error estimate for blocks of size 2^( 7) =       0.000567955009

      target function =      -0.635651183297
              le_mean =     -22.810173852565
             les_mean =     520.830700514678
             stat err =       0.000562736861
             autocorr =       1.277970619920
   target nu stat err =       0.000562736861
   target dn stat err =       0.013969306313
      target stat err =       0.005189843302
              std dev =       0.703979361049
             le_variance =       0.495586940783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491588342523
                                         uncertainty =       0.002150092562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491588342523
                                         uncertainty =       0.002150092562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495740087
  error estimate for blocks of size 2^( 2) =       0.000516938859
  error estimate for blocks of size 2^( 3) =       0.000537658733
  error estimate for blocks of size 2^( 4) =       0.000551592404
  error estimate for blocks of size 2^( 5) =       0.000560792847
  error estimate for blocks of size 2^( 6) =       0.000563891651
  error estimate for blocks of size 2^( 7) =       0.000565644584

      target function =      -0.638383327385
              le_mean =     -22.810205024456
             les_mean =     520.824843480656
             stat err =       0.000560480372
             autocorr =       1.278240986269
   target nu stat err =       0.000560480372
   target dn stat err =       0.011271999936
      target stat err =       0.004228158483
              std dev =       0.701082354037
             le_variance =       0.491516467142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493433707000
                                         uncertainty =       0.002164551849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493433707000
                                         uncertainty =       0.002164551849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496669594
  error estimate for blocks of size 2^( 2) =       0.000517917122
  error estimate for blocks of size 2^( 3) =       0.000538671621
  error estimate for blocks of size 2^( 4) =       0.000552619442
  error estimate for blocks of size 2^( 5) =       0.000561805496
  error estimate for blocks of size 2^( 6) =       0.000564891101
  error estimate for blocks of size 2^( 7) =       0.000566682185

      target function =      -0.641694728091
              le_mean =     -22.810182098644
             les_mean =     520.815042355516
             stat err =       0.000561499556
             autocorr =       1.278096623473
   target nu stat err =       0.000561499556
   target dn stat err =       0.003163632480
      target stat err =       0.001240216717
              std dev =       0.702396876090
             le_variance =       0.493361371541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495367032880
                                         uncertainty =       0.002182291890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495367032880
                                         uncertainty =       0.002182291890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497641478
  error estimate for blocks of size 2^( 2) =       0.000518936375
  error estimate for blocks of size 2^( 3) =       0.000539725539
  error estimate for blocks of size 2^( 4) =       0.000553689213
  error estimate for blocks of size 2^( 5) =       0.000562871535
  error estimate for blocks of size 2^( 6) =       0.000565948372
  error estimate for blocks of size 2^( 7) =       0.000567787481

      target function =      -0.640582026520
              le_mean =     -22.810173516145
             les_mean =     520.817595077372
             stat err =       0.000562574150
             autocorr =       1.277986901610
   target nu stat err =       0.000562574150
   target dn stat err =       0.003294596583
      target stat err =       0.001283813642
              std dev =       0.703771327718
             le_variance =       0.495294081718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.635651183297        initial
     6.2500e-01     6.2500e+00             2.3867e-03        -0.638383327385
     2.5000e+00     2.5000e+01             6.2689e-04        -0.641694728091  <--
     1.0000e+01     1.0000e+02             1.5873e-04        -0.640582026520

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 7.1630e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_01                 1.611040e-01 3 1  ON 0
ci_02                -5.611791e-02 3 1  ON 1
ci_03                -5.619273e-02 3 1  ON 2
ci_04                 5.535443e-02 3 1  ON 3
ci_05                -3.946264e-02 3 1  ON 4
ci_06                -3.952988e-02 3 1  ON 5
ci_07                 3.031501e-02 3 1  ON 6
ci_08                -1.785993e-02 3 1  ON 7
ci_09                -1.699900e-02 3 1  ON 8
ci_10                -1.701874e-02 3 1  ON 9
ci_11                 1.610073e-02 3 1  ON 10
ci_12                 1.306251e-02 3 1  ON 11
ci_13                 1.266886e-02 3 1  ON 12
ci_14                 1.272393e-02 3 1  ON 13
ci_15                 1.214201e-02 3 1  ON 14
ci_16                 1.203827e-02 3 1  ON 15
ci_17                -1.171247e-02 3 1  ON 16
ci_18                -1.185159e-02 3 1  ON 17
ci_19                 1.154343e-02 3 1  ON 18
ci_20                 1.035618e-02 3 1  ON 19
ci_21                 9.828458e-03 3 1  ON 20
ci_22                 9.857674e-03 3 1  ON 21
ci_23                 6.507772e-03 3 1  ON 22
ci_24                 5.324286e-03 3 1  ON 23
ci_25                 5.246100e-03 3 1  ON 24
ci_26                 4.727734e-03 3 1  ON 25
ci_27                 4.784429e-03 3 1  ON 26
ci_28                 4.085428e-03 3 1  ON 27
ci_29                 4.073962e-03 3 1  ON 28
ci_30                -3.530104e-03 3 1  ON 29
ci_31                -3.497173e-03 3 1  ON 30
ci_32                -3.260401e-03 3 1  ON 31
ci_33                -3.352350e-03 3 1  ON 32
ci_34                 2.637561e-03 3 1  ON 33
ci_35                 2.721465e-03 3 1  ON 34
ci_36                -2.483513e-03 3 1  ON 35
ci_37                -2.503253e-03 3 1  ON 36
ci_38                -1.984357e-03 3 1  ON 37
ci_39                -2.012407e-03 3 1  ON 38
ci_40                -2.050310e-03 3 1  ON 39
ci_41                -1.925198e-03 3 1  ON 40
ci_42                -1.823770e-03 3 1  ON 41
ci_43                -2.037209e-03 3 1  ON 42
ci_44                -2.016084e-03 3 1  ON 43
ci_45                -1.800994e-03 3 1  ON 44
ci_46                -1.806141e-03 3 1  ON 45
ci_47                -1.771996e-03 3 1  ON 46
ci_48                -1.701009e-03 3 1  ON 47
ci_49                -1.733296e-03 3 1  ON 48
ci_50                -1.586818e-03 3 1  ON 49
ci_51                 1.589950e-03 3 1  ON 50
ci_52                 1.612463e-03 3 1  ON 51
ci_53                -1.585854e-03 3 1  ON 52
ci_54                -1.430707e-03 3 1  ON 53
ci_55                -1.474403e-03 3 1  ON 54
ci_56                 1.445028e-03 3 1  ON 55
ci_57                 1.495906e-03 3 1  ON 56
ci_58                -1.247446e-03 3 1  ON 57
ci_59                -1.174942e-03 3 1  ON 58
ci_60                 1.176578e-03 3 1  ON 59
ci_61                 1.118570e-03 3 1  ON 60
ci_62                -1.045871e-03 3 1  ON 61
ci_63                -1.052874e-03 3 1  ON 62
ci_64                -9.806620e-04 3 1  ON 63
ci_65                -1.015281e-03 3 1  ON 64
ci_66                -9.896193e-04 3 1  ON 65
ci_67                -9.812326e-04 3 1  ON 66
ci_68                 7.837745e-04 3 1  ON 67
ci_69                 8.497616e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2362e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2801e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7798
    reference variance = 0.608719
====================================================
  Execution time = 4.2639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.2101e-01
  Total weights = 1.962943617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501027228144
                                         uncertainty =       0.003267721480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501027228144
                                         uncertainty =       0.003267721480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500478169
  error estimate for blocks of size 2^( 2) =       0.000521776410
  error estimate for blocks of size 2^( 3) =       0.000542302512
  error estimate for blocks of size 2^( 4) =       0.000557574227
  error estimate for blocks of size 2^( 5) =       0.000567091115
  error estimate for blocks of size 2^( 6) =       0.000569929196
  error estimate for blocks of size 2^( 7) =       0.000570930216

      target function =      -0.637909275796
              le_mean =     -22.810687194479
             les_mean =     520.848460929764
             stat err =       0.000566381189
             autocorr =       1.280699865781
   target nu stat err =       0.000566381189
   target dn stat err =       0.005446246425
      target stat err =       0.002061400562
              std dev =       0.707783014838
             le_variance =       0.500956796093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281068719448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637915485254       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.638610635228       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.638718953106       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.638735244233       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.638739861731       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.638741465036       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.638741871299       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.638741857234       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.638741855557       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.638741855229       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.268501e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637915485254       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.638097637937       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.638125536694       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.638129655470       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.638130794431       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.638131171789       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.638131265006       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.638131261163       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.638131260782       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.638131260688       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.958954e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.637915485254       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.637961577216       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.637968604308       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.637969636619       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.637969920204       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.637970012986       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.637970035754       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.637970034775       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.637970034683       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.637970034658       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.508838e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0347e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_01                 1.605984e-01 3 1  ON 0
ci_02                -5.563104e-02 3 1  ON 1
ci_03                -5.569596e-02 3 1  ON 2
ci_04                 5.475854e-02 3 1  ON 3
ci_05                -3.912965e-02 3 1  ON 4
ci_06                -3.918123e-02 3 1  ON 5
ci_07                 3.025504e-02 3 1  ON 6
ci_08                -1.762619e-02 3 1  ON 7
ci_09                -1.684142e-02 3 1  ON 8
ci_10                -1.691290e-02 3 1  ON 9
ci_11                 1.603962e-02 3 1  ON 10
ci_12                 1.297184e-02 3 1  ON 11
ci_13                 1.265298e-02 3 1  ON 12
ci_14                 1.272969e-02 3 1  ON 13
ci_15                 1.207645e-02 3 1  ON 14
ci_16                 1.195838e-02 3 1  ON 15
ci_17                -1.163351e-02 3 1  ON 16
ci_18                -1.177275e-02 3 1  ON 17
ci_19                 1.150090e-02 3 1  ON 18
ci_20                 1.027248e-02 3 1  ON 19
ci_21                 9.813276e-03 3 1  ON 20
ci_22                 9.850019e-03 3 1  ON 21
ci_23                 6.464001e-03 3 1  ON 22
ci_24                 5.332534e-03 3 1  ON 23
ci_25                 5.200504e-03 3 1  ON 24
ci_26                 4.689452e-03 3 1  ON 25
ci_27                 4.744276e-03 3 1  ON 26
ci_28                 4.059172e-03 3 1  ON 27
ci_29                 4.053257e-03 3 1  ON 28
ci_30                -3.497731e-03 3 1  ON 29
ci_31                -3.453830e-03 3 1  ON 30
ci_32                -3.207531e-03 3 1  ON 31
ci_33                -3.310260e-03 3 1  ON 32
ci_34                 2.597980e-03 3 1  ON 33
ci_35                 2.674953e-03 3 1  ON 34
ci_36                -2.440979e-03 3 1  ON 35
ci_37                -2.477287e-03 3 1  ON 36
ci_38                -1.952945e-03 3 1  ON 37
ci_39                -1.993944e-03 3 1  ON 38
ci_40                -2.043237e-03 3 1  ON 39
ci_41                -1.913157e-03 3 1  ON 40
ci_42                -1.809885e-03 3 1  ON 41
ci_43                -2.038771e-03 3 1  ON 42
ci_44                -2.005059e-03 3 1  ON 43
ci_45                -1.781635e-03 3 1  ON 44
ci_46                -1.784625e-03 3 1  ON 45
ci_47                -1.736390e-03 3 1  ON 46
ci_48                -1.685952e-03 3 1  ON 47
ci_49                -1.717044e-03 3 1  ON 48
ci_50                -1.564102e-03 3 1  ON 49
ci_51                 1.574489e-03 3 1  ON 50
ci_52                 1.596239e-03 3 1  ON 51
ci_53                -1.568789e-03 3 1  ON 52
ci_54                -1.408974e-03 3 1  ON 53
ci_55                -1.458155e-03 3 1  ON 54
ci_56                 1.447147e-03 3 1  ON 55
ci_57                 1.502592e-03 3 1  ON 56
ci_58                -1.254396e-03 3 1  ON 57
ci_59                -1.190059e-03 3 1  ON 58
ci_60                 1.152435e-03 3 1  ON 59
ci_61                 1.140404e-03 3 1  ON 60
ci_62                -1.025331e-03 3 1  ON 61
ci_63                -1.048567e-03 3 1  ON 62
ci_64                -9.833637e-04 3 1  ON 63
ci_65                -1.008816e-03 3 1  ON 64
ci_66                -9.915308e-04 3 1  ON 65
ci_67                -9.739051e-04 3 1  ON 66
ci_68                 7.478198e-04 3 1  ON 67
ci_69                 8.467508e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8599
    reference variance = 0.589196
====================================================
  Execution time = 4.1582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1372e-01
  Total weights = 1.9630e+06
  Execution time = 6.0044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00018101
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499503382285
                                         uncertainty =       0.002331053999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499503382285
                                         uncertainty =       0.002331053999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499680434
  error estimate for blocks of size 2^( 2) =       0.000521038100
  error estimate for blocks of size 2^( 3) =       0.000540692340
  error estimate for blocks of size 2^( 4) =       0.000555926916
  error estimate for blocks of size 2^( 5) =       0.000565629960
  error estimate for blocks of size 2^( 6) =       0.000571781323
  error estimate for blocks of size 2^( 7) =       0.000573462947

      target function =      -0.640273353104
              le_mean =     -22.810977469055
             les_mean =     520.855590030178
             stat err =       0.000566700287
             autocorr =       1.286240490169
   target nu stat err =       0.000566700287
   target dn stat err =       0.002872440100
      target stat err =       0.001131467788
              std dev =       0.706654846206
             le_variance =       0.499361071666

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.49073e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495738097109
                                         uncertainty =       0.002318334152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495738097109
                                         uncertainty =       0.002318334152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497793632
  error estimate for blocks of size 2^( 2) =       0.000519029280
  error estimate for blocks of size 2^( 3) =       0.000538615564
  error estimate for blocks of size 2^( 4) =       0.000553817741
  error estimate for blocks of size 2^( 5) =       0.000563492698
  error estimate for blocks of size 2^( 6) =       0.000569647438
  error estimate for blocks of size 2^( 7) =       0.000571440901

      target function =      -0.641195376708
              le_mean =     -22.811000990426
             les_mean =     520.854231248854
             stat err =       0.000564599694
             autocorr =       1.286419468734
   target nu stat err =       0.000564599694
   target dn stat err =       0.003048297339
      target stat err =       0.001197883619
              std dev =       0.703986505764
             le_variance =       0.495597000298

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000180479
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497460938639
                                         uncertainty =       0.002323667650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497460938639
                                         uncertainty =       0.002323667650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498657852
  error estimate for blocks of size 2^( 2) =       0.000519951215
  error estimate for blocks of size 2^( 3) =       0.000539567642
  error estimate for blocks of size 2^( 4) =       0.000554784782
  error estimate for blocks of size 2^( 5) =       0.000564472511
  error estimate for blocks of size 2^( 6) =       0.000570627075
  error estimate for blocks of size 2^( 7) =       0.000572366534

      target function =      -0.640739814020
              le_mean =     -22.810980939354
             les_mean =     520.854512039811
             stat err =       0.000565562726
             autocorr =       1.286341358116
   target nu stat err =       0.000565562726
   target dn stat err =       0.002936175086
      target stat err =       0.001155841519
              std dev =       0.705208697778
             le_variance =       0.497319307422

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000314991
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499238823091
                                         uncertainty =       0.002330166502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499238823091
                                         uncertainty =       0.002330166502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499548092
  error estimate for blocks of size 2^( 2) =       0.000520896543
  error estimate for blocks of size 2^( 3) =       0.000540546031
  error estimate for blocks of size 2^( 4) =       0.000555779471
  error estimate for blocks of size 2^( 5) =       0.000565481923
  error estimate for blocks of size 2^( 6) =       0.000571635959
  error estimate for blocks of size 2^( 7) =       0.000573339092

      target function =      -0.634514778617
              le_mean =     -22.810977769591
             les_mean =     520.870897316114
             stat err =       0.000566559111
             autocorr =       1.286280979156
   target nu stat err =       0.000566559111
   target dn stat err =       0.015929190932
      target stat err =       0.005898734015
              std dev =       0.706467686365
             le_variance =       0.499096591878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.640273353104        initial
     6.2500e-01     6.2500e+00             2.2685e-03        -0.641195376708  <--
     2.5000e+00     2.5000e+01             5.9590e-04        -0.640739814020
     1.0000e+01     1.0000e+02             1.5088e-04        -0.634514778617

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.1748e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_01                 1.591410e-01 3 1  ON 0
ci_02                -5.425434e-02 3 1  ON 1
ci_03                -5.429011e-02 3 1  ON 2
ci_04                 5.308593e-02 3 1  ON 3
ci_05                -3.819057e-02 3 1  ON 4
ci_06                -3.819826e-02 3 1  ON 5
ci_07                 3.008447e-02 3 1  ON 6
ci_08                -1.696890e-02 3 1  ON 7
ci_09                -1.639235e-02 3 1  ON 8
ci_10                -1.661129e-02 3 1  ON 9
ci_11                 1.586699e-02 3 1  ON 10
ci_12                 1.271612e-02 3 1  ON 11
ci_13                 1.260802e-02 3 1  ON 12
ci_14                 1.274763e-02 3 1  ON 13
ci_15                 1.189138e-02 3 1  ON 14
ci_16                 1.173229e-02 3 1  ON 15
ci_17                -1.140821e-02 3 1  ON 16
ci_18                -1.154809e-02 3 1  ON 17
ci_19                 1.138298e-02 3 1  ON 18
ci_20                 1.003663e-02 3 1  ON 19
ci_21                 9.769782e-03 3 1  ON 20
ci_22                 9.827170e-03 3 1  ON 21
ci_23                 6.341746e-03 3 1  ON 22
ci_24                 5.357520e-03 3 1  ON 23
ci_25                 5.072286e-03 3 1  ON 24
ci_26                 4.581398e-03 3 1  ON 25
ci_27                 4.631085e-03 3 1  ON 26
ci_28                 3.983363e-03 3 1  ON 27
ci_29                 3.992955e-03 3 1  ON 28
ci_30                -3.404537e-03 3 1  ON 29
ci_31                -3.329471e-03 3 1  ON 30
ci_32                -3.060883e-03 3 1  ON 31
ci_33                -3.193867e-03 3 1  ON 32
ci_34                 2.488502e-03 3 1  ON 33
ci_35                 2.545671e-03 3 1  ON 34
ci_36                -2.321138e-03 3 1  ON 35
ci_37                -2.403855e-03 3 1  ON 36
ci_38                -1.864240e-03 3 1  ON 37
ci_39                -1.941408e-03 3 1  ON 38
ci_40                -2.023302e-03 3 1  ON 39
ci_41                -1.880941e-03 3 1  ON 40
ci_42                -1.772551e-03 3 1  ON 41
ci_43                -2.041849e-03 3 1  ON 42
ci_44                -1.972290e-03 3 1  ON 43
ci_45                -1.726518e-03 3 1  ON 44
ci_46                -1.723720e-03 3 1  ON 45
ci_47                -1.633481e-03 3 1  ON 46
ci_48                -1.641678e-03 3 1  ON 47
ci_49                -1.671045e-03 3 1  ON 48
ci_50                -1.500484e-03 3 1  ON 49
ci_51                 1.530176e-03 3 1  ON 50
ci_52                 1.549752e-03 3 1  ON 51
ci_53                -1.520953e-03 3 1  ON 52
ci_54                -1.347931e-03 3 1  ON 53
ci_55                -1.412377e-03 3 1  ON 54
ci_56                 1.453642e-03 3 1  ON 55
ci_57                 1.521795e-03 3 1  ON 56
ci_58                -1.273978e-03 3 1  ON 57
ci_59                -1.232992e-03 3 1  ON 58
ci_60                 1.081302e-03 3 1  ON 59
ci_61                 1.203914e-03 3 1  ON 60
ci_62                -9.672902e-04 3 1  ON 61
ci_63                -1.036234e-03 3 1  ON 62
ci_64                -9.907169e-04 3 1  ON 63
ci_65                -9.897497e-04 3 1  ON 64
ci_66                -9.963895e-04 3 1  ON 65
ci_67                -9.529638e-04 3 1  ON 66
ci_68                 6.461423e-04 3 1  ON 67
ci_69                 8.379549e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2210e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7707
    reference variance = 0.373595
====================================================
  Execution time = 4.3971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.1163e-01
  Total weights = 1.962685391e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494155597996
                                         uncertainty =       0.002297804032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494155597996
                                         uncertainty =       0.002297804032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497077695
  error estimate for blocks of size 2^( 2) =       0.000518323690
  error estimate for blocks of size 2^( 3) =       0.000538570427
  error estimate for blocks of size 2^( 4) =       0.000554252185
  error estimate for blocks of size 2^( 5) =       0.000564958176
  error estimate for blocks of size 2^( 6) =       0.000568788638
  error estimate for blocks of size 2^( 7) =       0.000571163654

      target function =      -0.641643370907
              le_mean =     -22.811562167353
             les_mean =     520.878994528396
             stat err =       0.000564790663
             autocorr =       1.291000662666
   target nu stat err =       0.000564790663
   target dn stat err =       0.003187443800
      target stat err =       0.001250795816
              std dev =       0.702974017839
             le_variance =       0.494172469756


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281156216735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.641645412185       residual = 5.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.643779969415       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644123749156       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644171740822       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644186118619       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644193072425       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644193268161       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644193225915       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644193241274       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644193231567       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.644193226114       residual = 9.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.929000e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.641645412185       residual = 5.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642278213718       residual = 8.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.642374489562       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.642387079288       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.642390570050       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.642392061363       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.642392046585       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.642392035294       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.642392038038       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.642392035827       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.069225e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.641645412185       residual = 5.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.641811284007       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.641836065197       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.641839239319       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.641840098039       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.641840450668       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.641840442983       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.641840440196       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.641840440815       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.641840440286       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.436159e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1622e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_01                 1.572965e-01 3 1  ON 0
ci_02                -5.245918e-02 3 1  ON 1
ci_03                -5.240542e-02 3 1  ON 2
ci_04                 5.101671e-02 3 1  ON 3
ci_05                -3.694486e-02 3 1  ON 4
ci_06                -3.702904e-02 3 1  ON 5
ci_07                 2.980922e-02 3 1  ON 6
ci_08                -1.612290e-02 3 1  ON 7
ci_09                -1.597944e-02 3 1  ON 8
ci_10                -1.611611e-02 3 1  ON 9
ci_11                 1.569314e-02 3 1  ON 10
ci_12                 1.239249e-02 3 1  ON 11
ci_13                 1.254858e-02 3 1  ON 12
ci_14                 1.274224e-02 3 1  ON 13
ci_15                 1.150934e-02 3 1  ON 14
ci_16                 1.139356e-02 3 1  ON 15
ci_17                -1.115726e-02 3 1  ON 16
ci_18                -1.131377e-02 3 1  ON 17
ci_19                 1.118324e-02 3 1  ON 18
ci_20                 9.935299e-03 3 1  ON 19
ci_21                 9.630506e-03 3 1  ON 20
ci_22                 9.725698e-03 3 1  ON 21
ci_23                 6.156657e-03 3 1  ON 22
ci_24                 5.304466e-03 3 1  ON 23
ci_25                 4.853856e-03 3 1  ON 24
ci_26                 4.479084e-03 3 1  ON 25
ci_27                 4.506777e-03 3 1  ON 26
ci_28                 3.899363e-03 3 1  ON 27
ci_29                 3.862350e-03 3 1  ON 28
ci_30                -3.362736e-03 3 1  ON 29
ci_31                -3.197926e-03 3 1  ON 30
ci_32                -2.857504e-03 3 1  ON 31
ci_33                -3.033399e-03 3 1  ON 32
ci_34                 2.326430e-03 3 1  ON 33
ci_35                 2.437001e-03 3 1  ON 34
ci_36                -2.191888e-03 3 1  ON 35
ci_37                -2.305145e-03 3 1  ON 36
ci_38                -1.781341e-03 3 1  ON 37
ci_39                -1.828405e-03 3 1  ON 38
ci_40                -2.015817e-03 3 1  ON 39
ci_41                -1.910319e-03 3 1  ON 40
ci_42                -1.741904e-03 3 1  ON 41
ci_43                -2.053431e-03 3 1  ON 42
ci_44                -2.046153e-03 3 1  ON 43
ci_45                -1.637910e-03 3 1  ON 44
ci_46                -1.558990e-03 3 1  ON 45
ci_47                -1.523273e-03 3 1  ON 46
ci_48                -1.508054e-03 3 1  ON 47
ci_49                -1.623464e-03 3 1  ON 48
ci_50                -1.435932e-03 3 1  ON 49
ci_51                 1.432657e-03 3 1  ON 50
ci_52                 1.535486e-03 3 1  ON 51
ci_53                -1.493415e-03 3 1  ON 52
ci_54                -1.260703e-03 3 1  ON 53
ci_55                -1.310488e-03 3 1  ON 54
ci_56                 1.496293e-03 3 1  ON 55
ci_57                 1.514625e-03 3 1  ON 56
ci_58                -1.276183e-03 3 1  ON 57
ci_59                -1.213581e-03 3 1  ON 58
ci_60                 9.235083e-04 3 1  ON 59
ci_61                 1.211846e-03 3 1  ON 60
ci_62                -9.523977e-04 3 1  ON 61
ci_63                -9.923996e-04 3 1  ON 62
ci_64                -9.402070e-04 3 1  ON 63
ci_65                -9.465091e-04 3 1  ON 64
ci_66                -9.523518e-04 3 1  ON 65
ci_67                -9.383100e-04 3 1  ON 66
ci_68                 5.177056e-04 3 1  ON 67
ci_69                 6.589417e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6594
    reference variance = 3.08396
====================================================
  Execution time = 4.1694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.0632e-01
  Total weights = 1.9632e+06
  Execution time = 6.0281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492744766092
                                         uncertainty =       0.002667764032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492744766092
                                         uncertainty =       0.002667764032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496382587
  error estimate for blocks of size 2^( 2) =       0.000517647574
  error estimate for blocks of size 2^( 3) =       0.000538124619
  error estimate for blocks of size 2^( 4) =       0.000553162568
  error estimate for blocks of size 2^( 5) =       0.000563841726
  error estimate for blocks of size 2^( 6) =       0.000569816236
  error estimate for blocks of size 2^( 7) =       0.000573109063

      target function =      -0.634702738295
              le_mean =     -22.812755271987
             les_mean =     520.952522890451
             stat err =       0.000564982398
             autocorr =       1.295498037198
   target nu stat err =       0.000564982398
   target dn stat err =       0.017473482516
      target stat err =       0.006483366670
              std dev =       0.701990986658
             le_variance =       0.492791345349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483687956101
                                         uncertainty =       0.002727964594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483687956101
                                         uncertainty =       0.002727964594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491800834
  error estimate for blocks of size 2^( 2) =       0.000512832647
  error estimate for blocks of size 2^( 3) =       0.000533041822
  error estimate for blocks of size 2^( 4) =       0.000548100579
  error estimate for blocks of size 2^( 5) =       0.000558702331
  error estimate for blocks of size 2^( 6) =       0.000564751355
  error estimate for blocks of size 2^( 7) =       0.000567992258

      target function =      -0.583006732384
              le_mean =     -22.812884940768
             les_mean =     521.105910418930
             stat err =       0.000559886630
             autocorr =       1.296049749579
   target nu stat err =       0.000559886630
   target dn stat err =       0.093156052775
      target stat err =       0.029200633368
              std dev =       0.695511409389
             le_variance =       0.483736120591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486217535204
                                         uncertainty =       0.002645881466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486217535204
                                         uncertainty =       0.002645881466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493084890
  error estimate for blocks of size 2^( 2) =       0.000514196996
  error estimate for blocks of size 2^( 3) =       0.000534531669
  error estimate for blocks of size 2^( 4) =       0.000549569041
  error estimate for blocks of size 2^( 5) =       0.000560235272
  error estimate for blocks of size 2^( 6) =       0.000566268349
  error estimate for blocks of size 2^( 7) =       0.000569519334

      target function =      -0.644327171455
              le_mean =     -22.812737020515
             les_mean =     520.926260585766
             stat err =       0.000561397999
             autocorr =       1.296278540138
   target nu stat err =       0.000561397999
   target dn stat err =       0.003883743857
      target stat err =       0.001519825761
              std dev =       0.697327339258
             le_variance =       0.486265418076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491809376164
                                         uncertainty =       0.002666673907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491809376164
                                         uncertainty =       0.002666673907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495911393
  error estimate for blocks of size 2^( 2) =       0.000517144078
  error estimate for blocks of size 2^( 3) =       0.000537599195
  error estimate for blocks of size 2^( 4) =       0.000552638168
  error estimate for blocks of size 2^( 5) =       0.000563310471
  error estimate for blocks of size 2^( 6) =       0.000569287117
  error estimate for blocks of size 2^( 7) =       0.000572567711

      target function =      -0.636457703900
              le_mean =     -22.812737095030
             les_mean =     520.947032184805
             stat err =       0.000564450867
             autocorr =       1.295519984112
   target nu stat err =       0.000564450867
   target dn stat err =       0.013403102041
      target stat err =       0.005004779360
              std dev =       0.701324617881
             le_variance =       0.491856219646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.634702738295        initial
     1.5625e-01     1.5625e+00             6.9290e-03        -0.583006732384
     6.2500e-01     6.2500e+00             2.0692e-03        -0.644327171455  <--
     2.5000e+00     2.5000e+01             5.4362e-04        -0.636457703900

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.1492e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_01                 1.572965e-01 3 1  ON 0
ci_02                -5.245918e-02 3 1  ON 1
ci_03                -5.240542e-02 3 1  ON 2
ci_04                 5.101671e-02 3 1  ON 3
ci_05                -3.694486e-02 3 1  ON 4
ci_06                -3.702904e-02 3 1  ON 5
ci_07                 2.980922e-02 3 1  ON 6
ci_08                -1.612290e-02 3 1  ON 7
ci_09                -1.597944e-02 3 1  ON 8
ci_10                -1.611611e-02 3 1  ON 9
ci_11                 1.569314e-02 3 1  ON 10
ci_12                 1.239249e-02 3 1  ON 11
ci_13                 1.254858e-02 3 1  ON 12
ci_14                 1.274224e-02 3 1  ON 13
ci_15                 1.150934e-02 3 1  ON 14
ci_16                 1.139356e-02 3 1  ON 15
ci_17                -1.115726e-02 3 1  ON 16
ci_18                -1.131377e-02 3 1  ON 17
ci_19                 1.118324e-02 3 1  ON 18
ci_20                 9.935299e-03 3 1  ON 19
ci_21                 9.630506e-03 3 1  ON 20
ci_22                 9.725698e-03 3 1  ON 21
ci_23                 6.156657e-03 3 1  ON 22
ci_24                 5.304466e-03 3 1  ON 23
ci_25                 4.853856e-03 3 1  ON 24
ci_26                 4.479084e-03 3 1  ON 25
ci_27                 4.506777e-03 3 1  ON 26
ci_28                 3.899363e-03 3 1  ON 27
ci_29                 3.862350e-03 3 1  ON 28
ci_30                -3.362736e-03 3 1  ON 29
ci_31                -3.197926e-03 3 1  ON 30
ci_32                -2.857504e-03 3 1  ON 31
ci_33                -3.033399e-03 3 1  ON 32
ci_34                 2.326430e-03 3 1  ON 33
ci_35                 2.437001e-03 3 1  ON 34
ci_36                -2.191888e-03 3 1  ON 35
ci_37                -2.305145e-03 3 1  ON 36
ci_38                -1.781341e-03 3 1  ON 37
ci_39                -1.828405e-03 3 1  ON 38
ci_40                -2.015817e-03 3 1  ON 39
ci_41                -1.910319e-03 3 1  ON 40
ci_42                -1.741904e-03 3 1  ON 41
ci_43                -2.053431e-03 3 1  ON 42
ci_44                -2.046153e-03 3 1  ON 43
ci_45                -1.637910e-03 3 1  ON 44
ci_46                -1.558990e-03 3 1  ON 45
ci_47                -1.523273e-03 3 1  ON 46
ci_48                -1.508054e-03 3 1  ON 47
ci_49                -1.623464e-03 3 1  ON 48
ci_50                -1.435932e-03 3 1  ON 49
ci_51                 1.432657e-03 3 1  ON 50
ci_52                 1.535486e-03 3 1  ON 51
ci_53                -1.493415e-03 3 1  ON 52
ci_54                -1.260703e-03 3 1  ON 53
ci_55                -1.310488e-03 3 1  ON 54
ci_56                 1.496293e-03 3 1  ON 55
ci_57                 1.514625e-03 3 1  ON 56
ci_58                -1.276183e-03 3 1  ON 57
ci_59                -1.213581e-03 3 1  ON 58
ci_60                 9.235083e-04 3 1  ON 59
ci_61                 1.211846e-03 3 1  ON 60
ci_62                -9.523977e-04 3 1  ON 61
ci_63                -9.923996e-04 3 1  ON 62
ci_64                -9.402070e-04 3 1  ON 63
ci_65                -9.465091e-04 3 1  ON 64
ci_66                -9.523518e-04 3 1  ON 65
ci_67                -9.383100e-04 3 1  ON 66
ci_68                 5.177056e-04 3 1  ON 67
ci_69                 6.589417e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2313e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2791e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7973
    reference variance = 0.387177
====================================================
  Execution time = 4.2622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.0647e-01
  Total weights = 1.962910642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492116064019
                                         uncertainty =       0.003073395511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492116064019
                                         uncertainty =       0.003073395511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496031047
  error estimate for blocks of size 2^( 2) =       0.000516893128
  error estimate for blocks of size 2^( 3) =       0.000536437060
  error estimate for blocks of size 2^( 4) =       0.000551762078
  error estimate for blocks of size 2^( 5) =       0.000561947337
  error estimate for blocks of size 2^( 6) =       0.000566554382
  error estimate for blocks of size 2^( 7) =       0.000568109289

      target function =      -0.643776975247
              le_mean =     -22.812305546380
             les_mean =     520.907750690073
             stat err =       0.000562093271
             autocorr =       1.284100609432
   target nu stat err =       0.000562093271
   target dn stat err =       0.003352497339
      target stat err =       0.001320032196
              std dev =       0.701493834223
             le_variance =       0.492093599453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281230554638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.643779288484       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645655109693       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645956016059       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645998696214       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.646014568150       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.646018188196       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.646018677176       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.646018672039       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.646018646600       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.646018647891       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.646018650570       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.471617e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.643779288484       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644335809146       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644420224182       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644431399578       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644435210817       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644435960388       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644436047550       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644436045082       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644436038395       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644436038613       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.922031e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.643779288484       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.643925203676       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.643946945478       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.643949761939       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.643950696785       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.643950872377       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.643950891798       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.643950891118       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.643950889456       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.643950889506       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.050777e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0233e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_01                 1.554864e-01 3 1  ON 0
ci_02                -5.076282e-02 3 1  ON 1
ci_03                -5.068201e-02 3 1  ON 2
ci_04                 4.909468e-02 3 1  ON 3
ci_05                -3.580340e-02 3 1  ON 4
ci_06                -3.587451e-02 3 1  ON 5
ci_07                 2.956146e-02 3 1  ON 6
ci_08                -1.540889e-02 3 1  ON 7
ci_09                -1.560329e-02 3 1  ON 8
ci_10                -1.569230e-02 3 1  ON 9
ci_11                 1.554170e-02 3 1  ON 10
ci_12                 1.208712e-02 3 1  ON 11
ci_13                 1.248359e-02 3 1  ON 12
ci_14                 1.280487e-02 3 1  ON 13
ci_15                 1.119344e-02 3 1  ON 14
ci_16                 1.116329e-02 3 1  ON 15
ci_17                -1.095649e-02 3 1  ON 16
ci_18                -1.101584e-02 3 1  ON 17
ci_19                 1.096130e-02 3 1  ON 18
ci_20                 9.767246e-03 3 1  ON 19
ci_21                 9.504787e-03 3 1  ON 20
ci_22                 9.659136e-03 3 1  ON 21
ci_23                 6.039218e-03 3 1  ON 22
ci_24                 5.225742e-03 3 1  ON 23
ci_25                 4.681818e-03 3 1  ON 24
ci_26                 4.288573e-03 3 1  ON 25
ci_27                 4.377104e-03 3 1  ON 26
ci_28                 3.686944e-03 3 1  ON 27
ci_29                 3.794678e-03 3 1  ON 28
ci_30                -3.270320e-03 3 1  ON 29
ci_31                -3.056343e-03 3 1  ON 30
ci_32                -2.618896e-03 3 1  ON 31
ci_33                -2.882389e-03 3 1  ON 32
ci_34                 2.193445e-03 3 1  ON 33
ci_35                 2.318326e-03 3 1  ON 34
ci_36                -2.082970e-03 3 1  ON 35
ci_37                -2.213517e-03 3 1  ON 36
ci_38                -1.711757e-03 3 1  ON 37
ci_39                -1.698153e-03 3 1  ON 38
ci_40                -1.942399e-03 3 1  ON 39
ci_41                -1.774020e-03 3 1  ON 40
ci_42                -1.648612e-03 3 1  ON 41
ci_43                -2.037878e-03 3 1  ON 42
ci_44                -2.016404e-03 3 1  ON 43
ci_45                -1.518365e-03 3 1  ON 44
ci_46                -1.468597e-03 3 1  ON 45
ci_47                -1.491008e-03 3 1  ON 46
ci_48                -1.478256e-03 3 1  ON 47
ci_49                -1.589353e-03 3 1  ON 48
ci_50                -1.431136e-03 3 1  ON 49
ci_51                 1.360642e-03 3 1  ON 50
ci_52                 1.411202e-03 3 1  ON 51
ci_53                -1.427820e-03 3 1  ON 52
ci_54                -1.184354e-03 3 1  ON 53
ci_55                -1.262636e-03 3 1  ON 54
ci_56                 1.536339e-03 3 1  ON 55
ci_57                 1.566603e-03 3 1  ON 56
ci_58                -1.214867e-03 3 1  ON 57
ci_59                -1.163544e-03 3 1  ON 58
ci_60                 9.362665e-04 3 1  ON 59
ci_61                 1.183251e-03 3 1  ON 60
ci_62                -8.954815e-04 3 1  ON 61
ci_63                -9.516917e-04 3 1  ON 62
ci_64                -8.872953e-04 3 1  ON 63
ci_65                -9.674329e-04 3 1  ON 64
ci_66                -8.737987e-04 3 1  ON 65
ci_67                -9.578017e-04 3 1  ON 66
ci_68                 3.706034e-04 3 1  ON 67
ci_69                 5.460299e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7929
    reference variance = 0.591529
====================================================
  Execution time = 4.1322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.2748e-01
  Total weights = 1.9630e+06
  Execution time = 5.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502100981634
                                         uncertainty =       0.006691732280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502100981634
                                         uncertainty =       0.006691732280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501050920
  error estimate for blocks of size 2^( 2) =       0.000522054246
  error estimate for blocks of size 2^( 3) =       0.000541580763
  error estimate for blocks of size 2^( 4) =       0.000556027963
  error estimate for blocks of size 2^( 5) =       0.000565348901
  error estimate for blocks of size 2^( 6) =       0.000570796800
  error estimate for blocks of size 2^( 7) =       0.000572966575

      target function =      -0.240882824317
              le_mean =     -22.813116145818
             les_mean =     522.817202711366
             stat err =       0.000566285060
             autocorr =       1.277339906103
   target nu stat err =       0.000566285060
   target dn stat err =       1.841746577020
      target stat err =       0.124610694438
              std dev =       0.708593006092
             le_variance =       0.502104048282

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0355905
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493562455292
                                         uncertainty =       0.005452519222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493562455292
                                         uncertainty =       0.005452519222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496772611
  error estimate for blocks of size 2^( 2) =       0.000517550580
  error estimate for blocks of size 2^( 3) =       0.000536913605
  error estimate for blocks of size 2^( 4) =       0.000551298334
  error estimate for blocks of size 2^( 5) =       0.000560522617
  error estimate for blocks of size 2^( 6) =       0.000565874327
  error estimate for blocks of size 2^( 7) =       0.000568068499

      target function =      -0.563297990501
              le_mean =     -22.813352794036
             les_mean =     521.188048954803
             stat err =       0.000561440944
             autocorr =       1.277299892574
   target nu stat err =       0.000561440944
   target dn stat err =       0.133614267508
      target stat err =       0.039205799922
              std dev =       0.702542564048
             le_variance =       0.493566054298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492968402183
                                         uncertainty =       0.005509706569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492968402183
                                         uncertainty =       0.005509706569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496478515
  error estimate for blocks of size 2^( 2) =       0.000517420559
  error estimate for blocks of size 2^( 3) =       0.000536914730
  error estimate for blocks of size 2^( 4) =       0.000551342248
  error estimate for blocks of size 2^( 5) =       0.000560549730
  error estimate for blocks of size 2^( 6) =       0.000565999408
  error estimate for blocks of size 2^( 7) =       0.000568180540

      target function =      -0.635491043522
              le_mean =     -22.813175892635
             les_mean =     520.969781777217
             stat err =       0.000561517981
             autocorr =       1.279164558496
   target nu stat err =       0.000561517981
   target dn stat err =       0.020147799276
      target stat err =       0.007494879300
              std dev =       0.702126649324
             le_variance =       0.492981831691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498600653408
                                         uncertainty =       0.006163655438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498600653408
                                         uncertainty =       0.006163655438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499305327
  error estimate for blocks of size 2^( 2) =       0.000520350781
  error estimate for blocks of size 2^( 3) =       0.000539924779
  error estimate for blocks of size 2^( 4) =       0.000554386520
  error estimate for blocks of size 2^( 5) =       0.000563576497
  error estimate for blocks of size 2^( 6) =       0.000569067619
  error estimate for blocks of size 2^( 7) =       0.000571185915

      target function =      -0.633713049900
              le_mean =     -22.813142129754
             les_mean =     520.972951095722
             stat err =       0.000564554138
             autocorr =       1.278435408827
   target nu stat err =       0.000564554138
   target dn stat err =       0.022895225066
      target stat err =       0.008467658056
              std dev =       0.706124365162
             le_variance =       0.498611619075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.240882824317        initial
     1.5625e-01     1.5625e+00             6.4716e-03        -0.563297990501
     6.2500e-01     6.2500e+00             1.9220e-03        -0.635491043522  <--
     2.5000e+00     2.5000e+01             5.0508e-04        -0.633713049900

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.0862e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_01                 1.554864e-01 3 1  ON 0
ci_02                -5.076282e-02 3 1  ON 1
ci_03                -5.068201e-02 3 1  ON 2
ci_04                 4.909468e-02 3 1  ON 3
ci_05                -3.580340e-02 3 1  ON 4
ci_06                -3.587451e-02 3 1  ON 5
ci_07                 2.956146e-02 3 1  ON 6
ci_08                -1.540889e-02 3 1  ON 7
ci_09                -1.560329e-02 3 1  ON 8
ci_10                -1.569230e-02 3 1  ON 9
ci_11                 1.554170e-02 3 1  ON 10
ci_12                 1.208712e-02 3 1  ON 11
ci_13                 1.248359e-02 3 1  ON 12
ci_14                 1.280487e-02 3 1  ON 13
ci_15                 1.119344e-02 3 1  ON 14
ci_16                 1.116329e-02 3 1  ON 15
ci_17                -1.095649e-02 3 1  ON 16
ci_18                -1.101584e-02 3 1  ON 17
ci_19                 1.096130e-02 3 1  ON 18
ci_20                 9.767246e-03 3 1  ON 19
ci_21                 9.504787e-03 3 1  ON 20
ci_22                 9.659136e-03 3 1  ON 21
ci_23                 6.039218e-03 3 1  ON 22
ci_24                 5.225742e-03 3 1  ON 23
ci_25                 4.681818e-03 3 1  ON 24
ci_26                 4.288573e-03 3 1  ON 25
ci_27                 4.377104e-03 3 1  ON 26
ci_28                 3.686944e-03 3 1  ON 27
ci_29                 3.794678e-03 3 1  ON 28
ci_30                -3.270320e-03 3 1  ON 29
ci_31                -3.056343e-03 3 1  ON 30
ci_32                -2.618896e-03 3 1  ON 31
ci_33                -2.882389e-03 3 1  ON 32
ci_34                 2.193445e-03 3 1  ON 33
ci_35                 2.318326e-03 3 1  ON 34
ci_36                -2.082970e-03 3 1  ON 35
ci_37                -2.213517e-03 3 1  ON 36
ci_38                -1.711757e-03 3 1  ON 37
ci_39                -1.698153e-03 3 1  ON 38
ci_40                -1.942399e-03 3 1  ON 39
ci_41                -1.774020e-03 3 1  ON 40
ci_42                -1.648612e-03 3 1  ON 41
ci_43                -2.037878e-03 3 1  ON 42
ci_44                -2.016404e-03 3 1  ON 43
ci_45                -1.518365e-03 3 1  ON 44
ci_46                -1.468597e-03 3 1  ON 45
ci_47                -1.491008e-03 3 1  ON 46
ci_48                -1.478256e-03 3 1  ON 47
ci_49                -1.589353e-03 3 1  ON 48
ci_50                -1.431136e-03 3 1  ON 49
ci_51                 1.360642e-03 3 1  ON 50
ci_52                 1.411202e-03 3 1  ON 51
ci_53                -1.427820e-03 3 1  ON 52
ci_54                -1.184354e-03 3 1  ON 53
ci_55                -1.262636e-03 3 1  ON 54
ci_56                 1.536339e-03 3 1  ON 55
ci_57                 1.566603e-03 3 1  ON 56
ci_58                -1.214867e-03 3 1  ON 57
ci_59                -1.163544e-03 3 1  ON 58
ci_60                 9.362665e-04 3 1  ON 59
ci_61                 1.183251e-03 3 1  ON 60
ci_62                -8.954815e-04 3 1  ON 61
ci_63                -9.516917e-04 3 1  ON 62
ci_64                -8.872953e-04 3 1  ON 63
ci_65                -9.674329e-04 3 1  ON 64
ci_66                -8.737987e-04 3 1  ON 65
ci_67                -9.578017e-04 3 1  ON 66
ci_68                 3.706034e-04 3 1  ON 67
ci_69                 5.460299e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2111e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2792e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7794
    reference variance = 0.434154
====================================================
  Execution time = 4.2537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 5.1717e-01
  Total weights = 1.963296509e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493230655600
                                         uncertainty =       0.003461196675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493230655600
                                         uncertainty =       0.003461196675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496593543
  error estimate for blocks of size 2^( 2) =       0.000517371111
  error estimate for blocks of size 2^( 3) =       0.000537616183
  error estimate for blocks of size 2^( 4) =       0.000552366254
  error estimate for blocks of size 2^( 5) =       0.000562835546
  error estimate for blocks of size 2^( 6) =       0.000567419560
  error estimate for blocks of size 2^( 7) =       0.000569919477

      target function =      -0.639784788457
              le_mean =     -22.812673239392
             les_mean =     520.935233512511
             stat err =       0.000563135209
             autocorr =       1.285947466425
   target nu stat err =       0.000563135209
   target dn stat err =       0.010729887383
      target stat err =       0.004052996523
              std dev =       0.702289323342
             le_variance =       0.493210293681


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281267323939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.639809963708       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.641385048475       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.641615954289       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.641661155432       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.641676609473       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.641681421558       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.641682798962       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.641683106855       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.641683044406       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.641683076132       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.641683052310       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.506495e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.639809963708       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.640276140739       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.640340902157       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.640352798194       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.640356566831       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.640357563554       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.640357838004       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.640357903564       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.640357888773       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.640357894774       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.640357890205       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.813110e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.639809963708       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.639932104065       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.639948784570       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.639951788160       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.639952717172       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.639952950335       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.639953014013       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.639953029557       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.639953025959       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.639953027326       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.758679e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0150e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_01                 1.536732e-01 3 1  ON 0
ci_02                -4.913097e-02 3 1  ON 1
ci_03                -4.922776e-02 3 1  ON 2
ci_04                 4.728246e-02 3 1  ON 3
ci_05                -3.480524e-02 3 1  ON 4
ci_06                -3.494743e-02 3 1  ON 5
ci_07                 2.925307e-02 3 1  ON 6
ci_08                -1.473881e-02 3 1  ON 7
ci_09                -1.515576e-02 3 1  ON 8
ci_10                -1.536090e-02 3 1  ON 9
ci_11                 1.537547e-02 3 1  ON 10
ci_12                 1.187943e-02 3 1  ON 11
ci_13                 1.247574e-02 3 1  ON 12
ci_14                 1.293596e-02 3 1  ON 13
ci_15                 1.091361e-02 3 1  ON 14
ci_16                 1.085428e-02 3 1  ON 15
ci_17                -1.074781e-02 3 1  ON 16
ci_18                -1.075598e-02 3 1  ON 17
ci_19                 1.083886e-02 3 1  ON 18
ci_20                 9.678626e-03 3 1  ON 19
ci_21                 9.372182e-03 3 1  ON 20
ci_22                 9.599587e-03 3 1  ON 21
ci_23                 5.916009e-03 3 1  ON 22
ci_24                 5.189879e-03 3 1  ON 23
ci_25                 4.577511e-03 3 1  ON 24
ci_26                 4.055434e-03 3 1  ON 25
ci_27                 4.188636e-03 3 1  ON 26
ci_28                 3.555324e-03 3 1  ON 27
ci_29                 3.788538e-03 3 1  ON 28
ci_30                -3.141343e-03 3 1  ON 29
ci_31                -2.967515e-03 3 1  ON 30
ci_32                -2.562178e-03 3 1  ON 31
ci_33                -2.791136e-03 3 1  ON 32
ci_34                 2.178871e-03 3 1  ON 33
ci_35                 2.245707e-03 3 1  ON 34
ci_36                -2.025959e-03 3 1  ON 35
ci_37                -2.136609e-03 3 1  ON 36
ci_38                -1.569873e-03 3 1  ON 37
ci_39                -1.669530e-03 3 1  ON 38
ci_40                -1.908945e-03 3 1  ON 39
ci_41                -1.804899e-03 3 1  ON 40
ci_42                -1.622280e-03 3 1  ON 41
ci_43                -2.276302e-03 3 1  ON 42
ci_44                -2.011459e-03 3 1  ON 43
ci_45                -1.425338e-03 3 1  ON 44
ci_46                -1.404325e-03 3 1  ON 45
ci_47                -1.400749e-03 3 1  ON 46
ci_48                -1.350928e-03 3 1  ON 47
ci_49                -1.636589e-03 3 1  ON 48
ci_50                -1.456238e-03 3 1  ON 49
ci_51                 1.306700e-03 3 1  ON 50
ci_52                 1.353317e-03 3 1  ON 51
ci_53                -1.377693e-03 3 1  ON 52
ci_54                -1.166080e-03 3 1  ON 53
ci_55                -1.220087e-03 3 1  ON 54
ci_56                 1.554994e-03 3 1  ON 55
ci_57                 1.595837e-03 3 1  ON 56
ci_58                -1.193112e-03 3 1  ON 57
ci_59                -1.103700e-03 3 1  ON 58
ci_60                 9.033093e-04 3 1  ON 59
ci_61                 1.330405e-03 3 1  ON 60
ci_62                -8.919800e-04 3 1  ON 61
ci_63                -8.801513e-04 3 1  ON 62
ci_64                -9.143580e-04 3 1  ON 63
ci_65                -8.714536e-04 3 1  ON 64
ci_66                -8.744096e-04 3 1  ON 65
ci_67                -8.710407e-04 3 1  ON 66
ci_68                 2.921747e-04 3 1  ON 67
ci_69                 2.342653e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7811
    reference variance = 0.432688
====================================================
  Execution time = 4.1356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.0391e-01
  Total weights = 1.9633e+06
  Execution time = 6.1127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492281171762
                                         uncertainty =       0.002523182646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492281171762
                                         uncertainty =       0.002523182646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496149345
  error estimate for blocks of size 2^( 2) =       0.000517253778
  error estimate for blocks of size 2^( 3) =       0.000537333744
  error estimate for blocks of size 2^( 4) =       0.000552063506
  error estimate for blocks of size 2^( 5) =       0.000561502069
  error estimate for blocks of size 2^( 6) =       0.000567254779
  error estimate for blocks of size 2^( 7) =       0.000566050386

      target function =      -0.624490389762
              le_mean =     -22.813854717797
             les_mean =     521.030656895048
             stat err =       0.000561717685
             autocorr =       1.281773682504
   target nu stat err =       0.000561717685
   target dn stat err =       0.038472988548
      target stat err =       0.013824523428
              std dev =       0.701661132332
             le_variance =       0.492328344625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485480511509
                                         uncertainty =       0.002710004621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485480511509
                                         uncertainty =       0.002710004621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492709632
  error estimate for blocks of size 2^( 2) =       0.000513649656
  error estimate for blocks of size 2^( 3) =       0.000533635915
  error estimate for blocks of size 2^( 4) =       0.000548324778
  error estimate for blocks of size 2^( 5) =       0.000557697975
  error estimate for blocks of size 2^( 6) =       0.000563354518
  error estimate for blocks of size 2^( 7) =       0.000562154411

      target function =      -0.556189177437
              le_mean =     -22.813950750014
             les_mean =     521.222852393935
             stat err =       0.000557882921
             autocorr =       1.282047235699
   target nu stat err =       0.000557882921
   target dn stat err =       0.226696199122
      target stat err =       0.065465599635
              std dev =       0.696796644128
             le_variance =       0.485525563267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487499594978
                                         uncertainty =       0.002541412947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487499594978
                                         uncertainty =       0.002541412947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493733966
  error estimate for blocks of size 2^( 2) =       0.000514738059
  error estimate for blocks of size 2^( 3) =       0.000534757745
  error estimate for blocks of size 2^( 4) =       0.000549472407
  error estimate for blocks of size 2^( 5) =       0.000558858178
  error estimate for blocks of size 2^( 6) =       0.000564518155
  error estimate for blocks of size 2^( 7) =       0.000563260617

      target function =      -0.644710579325
              le_mean =     -22.813849501379
             les_mean =     520.976709350608
             stat err =       0.000559027339
             autocorr =       1.281976561350
   target nu stat err =       0.000559027339
   target dn stat err =       0.003603940189
      target stat err =       0.001418529997
              std dev =       0.698245270857
             le_variance =       0.487546458274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491552699763
                                         uncertainty =       0.002519917724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491552699763
                                         uncertainty =       0.002519917724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495782170
  error estimate for blocks of size 2^( 2) =       0.000516872175
  error estimate for blocks of size 2^( 3) =       0.000536942956
  error estimate for blocks of size 2^( 4) =       0.000551672385
  error estimate for blocks of size 2^( 5) =       0.000561095234
  error estimate for blocks of size 2^( 6) =       0.000566839972
  error estimate for blocks of size 2^( 7) =       0.000565621677

      target function =      -0.625480872281
              le_mean =     -22.813841728296
             les_mean =     521.026807616858
             stat err =       0.000561307317
             autocorr =       1.281798026348
   target nu stat err =       0.000561307317
   target dn stat err =       0.048328338971
      target stat err =       0.017424000051
              std dev =       0.701141869432
             le_variance =       0.491599921071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.624490389762        initial
     1.5625e-01     1.5625e+00             6.5065e-03        -0.556189177437
     6.2500e-01     6.2500e+00             1.8131e-03        -0.644710579325  <--
     2.5000e+00     2.5000e+01             4.7587e-04        -0.625480872281

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.1237e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_01                 1.536732e-01 3 1  ON 0
ci_02                -4.913097e-02 3 1  ON 1
ci_03                -4.922776e-02 3 1  ON 2
ci_04                 4.728246e-02 3 1  ON 3
ci_05                -3.480524e-02 3 1  ON 4
ci_06                -3.494743e-02 3 1  ON 5
ci_07                 2.925307e-02 3 1  ON 6
ci_08                -1.473881e-02 3 1  ON 7
ci_09                -1.515576e-02 3 1  ON 8
ci_10                -1.536090e-02 3 1  ON 9
ci_11                 1.537547e-02 3 1  ON 10
ci_12                 1.187943e-02 3 1  ON 11
ci_13                 1.247574e-02 3 1  ON 12
ci_14                 1.293596e-02 3 1  ON 13
ci_15                 1.091361e-02 3 1  ON 14
ci_16                 1.085428e-02 3 1  ON 15
ci_17                -1.074781e-02 3 1  ON 16
ci_18                -1.075598e-02 3 1  ON 17
ci_19                 1.083886e-02 3 1  ON 18
ci_20                 9.678626e-03 3 1  ON 19
ci_21                 9.372182e-03 3 1  ON 20
ci_22                 9.599587e-03 3 1  ON 21
ci_23                 5.916009e-03 3 1  ON 22
ci_24                 5.189879e-03 3 1  ON 23
ci_25                 4.577511e-03 3 1  ON 24
ci_26                 4.055434e-03 3 1  ON 25
ci_27                 4.188636e-03 3 1  ON 26
ci_28                 3.555324e-03 3 1  ON 27
ci_29                 3.788538e-03 3 1  ON 28
ci_30                -3.141343e-03 3 1  ON 29
ci_31                -2.967515e-03 3 1  ON 30
ci_32                -2.562178e-03 3 1  ON 31
ci_33                -2.791136e-03 3 1  ON 32
ci_34                 2.178871e-03 3 1  ON 33
ci_35                 2.245707e-03 3 1  ON 34
ci_36                -2.025959e-03 3 1  ON 35
ci_37                -2.136609e-03 3 1  ON 36
ci_38                -1.569873e-03 3 1  ON 37
ci_39                -1.669530e-03 3 1  ON 38
ci_40                -1.908945e-03 3 1  ON 39
ci_41                -1.804899e-03 3 1  ON 40
ci_42                -1.622280e-03 3 1  ON 41
ci_43                -2.276302e-03 3 1  ON 42
ci_44                -2.011459e-03 3 1  ON 43
ci_45                -1.425338e-03 3 1  ON 44
ci_46                -1.404325e-03 3 1  ON 45
ci_47                -1.400749e-03 3 1  ON 46
ci_48                -1.350928e-03 3 1  ON 47
ci_49                -1.636589e-03 3 1  ON 48
ci_50                -1.456238e-03 3 1  ON 49
ci_51                 1.306700e-03 3 1  ON 50
ci_52                 1.353317e-03 3 1  ON 51
ci_53                -1.377693e-03 3 1  ON 52
ci_54                -1.166080e-03 3 1  ON 53
ci_55                -1.220087e-03 3 1  ON 54
ci_56                 1.554994e-03 3 1  ON 55
ci_57                 1.595837e-03 3 1  ON 56
ci_58                -1.193112e-03 3 1  ON 57
ci_59                -1.103700e-03 3 1  ON 58
ci_60                 9.033093e-04 3 1  ON 59
ci_61                 1.330405e-03 3 1  ON 60
ci_62                -8.919800e-04 3 1  ON 61
ci_63                -8.801513e-04 3 1  ON 62
ci_64                -9.143580e-04 3 1  ON 63
ci_65                -8.714536e-04 3 1  ON 64
ci_66                -8.744096e-04 3 1  ON 65
ci_67                -8.710407e-04 3 1  ON 66
ci_68                 2.921747e-04 3 1  ON 67
ci_69                 2.342653e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2139e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2791e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8699
    reference variance = 0.491511
====================================================
  Execution time = 4.4053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.1301e-01
  Total weights = 1.963611712e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492401544996
                                         uncertainty =       0.002938676628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492401544996
                                         uncertainty =       0.002938676628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496169569
  error estimate for blocks of size 2^( 2) =       0.000517177519
  error estimate for blocks of size 2^( 3) =       0.000536937378
  error estimate for blocks of size 2^( 4) =       0.000551944104
  error estimate for blocks of size 2^( 5) =       0.000560780441
  error estimate for blocks of size 2^( 6) =       0.000566741633
  error estimate for blocks of size 2^( 7) =       0.000570368786

      target function =      -0.641836594978
              le_mean =     -22.814671555352
             les_mean =     521.022250384669
             stat err =       0.000562458741
             autocorr =       1.285053154471
   target nu stat err =       0.000562458741
   target dn stat err =       0.006340745031
      target stat err =       0.002429642924
              std dev =       0.701689733062
             le_variance =       0.492368481485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467155535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.641845359741       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.643454302696       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.643704668586       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.643752234160       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.643772407559       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.643779377438       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.643780193163       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.643780253476       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.643780278355       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.643780240886       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 5.824693e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.641845359741       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642324110777       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.642394807067       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.642407326978       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.642412313495       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.642413824309       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.642413958010       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.642413971439       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.642413974130       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.642413966417       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.741540e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.641845359741       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.641971003138       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.641989247528       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.641992407010       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.641993640032       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.641993998452       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.641994027106       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.641994030389       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.641994030827       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.641994029038       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.577268e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1679e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_01                 1.520582e-01 3 1  ON 0
ci_02                -4.762025e-02 3 1  ON 1
ci_03                -4.763193e-02 3 1  ON 2
ci_04                 4.554092e-02 3 1  ON 3
ci_05                -3.378290e-02 3 1  ON 4
ci_06                -3.403370e-02 3 1  ON 5
ci_07                 2.909097e-02 3 1  ON 6
ci_08                -1.407416e-02 3 1  ON 7
ci_09                -1.478072e-02 3 1  ON 8
ci_10                -1.494327e-02 3 1  ON 9
ci_11                 1.519413e-02 3 1  ON 10
ci_12                 1.160353e-02 3 1  ON 11
ci_13                 1.253109e-02 3 1  ON 12
ci_14                 1.301563e-02 3 1  ON 13
ci_15                 1.064338e-02 3 1  ON 14
ci_16                 1.059634e-02 3 1  ON 15
ci_17                -1.046329e-02 3 1  ON 16
ci_18                -1.049662e-02 3 1  ON 17
ci_19                 1.072462e-02 3 1  ON 18
ci_20                 9.529249e-03 3 1  ON 19
ci_21                 9.339449e-03 3 1  ON 20
ci_22                 9.619479e-03 3 1  ON 21
ci_23                 5.871501e-03 3 1  ON 22
ci_24                 5.082334e-03 3 1  ON 23
ci_25                 4.423647e-03 3 1  ON 24
ci_26                 4.008514e-03 3 1  ON 25
ci_27                 4.109474e-03 3 1  ON 26
ci_28                 3.593301e-03 3 1  ON 27
ci_29                 3.725300e-03 3 1  ON 28
ci_30                -2.994686e-03 3 1  ON 29
ci_31                -2.817630e-03 3 1  ON 30
ci_32                -2.359929e-03 3 1  ON 31
ci_33                -2.589048e-03 3 1  ON 32
ci_34                 1.945616e-03 3 1  ON 33
ci_35                 2.060256e-03 3 1  ON 34
ci_36                -1.918941e-03 3 1  ON 35
ci_37                -1.993346e-03 3 1  ON 36
ci_38                -1.446150e-03 3 1  ON 37
ci_39                -1.531608e-03 3 1  ON 38
ci_40                -1.870766e-03 3 1  ON 39
ci_41                -1.635217e-03 3 1  ON 40
ci_42                -1.477170e-03 3 1  ON 41
ci_43                -2.183221e-03 3 1  ON 42
ci_44                -1.936087e-03 3 1  ON 43
ci_45                -1.400123e-03 3 1  ON 44
ci_46                -1.344064e-03 3 1  ON 45
ci_47                -1.268397e-03 3 1  ON 46
ci_48                -1.109914e-03 3 1  ON 47
ci_49                -1.667321e-03 3 1  ON 48
ci_50                -1.358544e-03 3 1  ON 49
ci_51                 1.259422e-03 3 1  ON 50
ci_52                 1.227763e-03 3 1  ON 51
ci_53                -1.291175e-03 3 1  ON 52
ci_54                -1.171867e-03 3 1  ON 53
ci_55                -1.314964e-03 3 1  ON 54
ci_56                 1.611480e-03 3 1  ON 55
ci_57                 1.582839e-03 3 1  ON 56
ci_58                -1.136771e-03 3 1  ON 57
ci_59                -1.044284e-03 3 1  ON 58
ci_60                 7.709473e-04 3 1  ON 59
ci_61                 1.191021e-03 3 1  ON 60
ci_62                -9.538303e-04 3 1  ON 61
ci_63                -8.254771e-04 3 1  ON 62
ci_64                -8.940109e-04 3 1  ON 63
ci_65                -7.961699e-04 3 1  ON 64
ci_66                -8.272914e-04 3 1  ON 65
ci_67                -8.678021e-04 3 1  ON 66
ci_68                 2.365887e-04 3 1  ON 67
ci_69                 1.651078e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8514
    reference variance = 0.501261
====================================================
  Execution time = 4.1345e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9896e-01
  Total weights = 1.9633e+06
  Execution time = 5.9106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484894646567
                                         uncertainty =       0.002245335327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484894646567
                                         uncertainty =       0.002245335327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492390765
  error estimate for blocks of size 2^( 2) =       0.000513316047
  error estimate for blocks of size 2^( 3) =       0.000532994294
  error estimate for blocks of size 2^( 4) =       0.000548366299
  error estimate for blocks of size 2^( 5) =       0.000558136498
  error estimate for blocks of size 2^( 6) =       0.000564226495
  error estimate for blocks of size 2^( 7) =       0.000568018230

      target function =      -0.644782942573
              le_mean =     -22.814619724348
             les_mean =     521.012140636194
             stat err =       0.000559686880
             autocorr =       1.292023625233
   target nu stat err =       0.000559686880
   target dn stat err =       0.003984330666
      target stat err =       0.001561967435
              std dev =       0.696345698288
             le_variance =       0.484897331524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478867129675
                                         uncertainty =       0.002428129271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478867129675
                                         uncertainty =       0.002428129271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489320225
  error estimate for blocks of size 2^( 2) =       0.000510108178
  error estimate for blocks of size 2^( 3) =       0.000529749037
  error estimate for blocks of size 2^( 4) =       0.000545071394
  error estimate for blocks of size 2^( 5) =       0.000554917106
  error estimate for blocks of size 2^( 6) =       0.000560968311
  error estimate for blocks of size 2^( 7) =       0.000564834691

      target function =      -0.603202556899
              le_mean =     -22.814642076584
             les_mean =     521.123336078273
             stat err =       0.000556447875
             autocorr =       1.293190911010
   target nu stat err =       0.000556447875
   target dn stat err =       0.102748706497
      target stat err =       0.034559615910
              std dev =       0.692003298418
             le_variance =       0.478868565021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480491257781
                                         uncertainty =       0.002277838401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480491257781
                                         uncertainty =       0.002277838401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490149909
  error estimate for blocks of size 2^( 2) =       0.000510991804
  error estimate for blocks of size 2^( 3) =       0.000530637975
  error estimate for blocks of size 2^( 4) =       0.000545977421
  error estimate for blocks of size 2^( 5) =       0.000555781829
  error estimate for blocks of size 2^( 6) =       0.000561835317
  error estimate for blocks of size 2^( 7) =       0.000565699939

      target function =      -0.645470067705
              le_mean =     -22.814573109744
             les_mean =     521.008180262935
             stat err =       0.000557323627
             autocorr =       1.292876543704
   target nu stat err =       0.000557323627
   target dn stat err =       0.006080134616
      target stat err =       0.002357250823
              std dev =       0.693176649081
             le_variance =       0.480493866831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484231313572
                                         uncertainty =       0.002246317573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484231313572
                                         uncertainty =       0.002246317573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492053879
  error estimate for blocks of size 2^( 2) =       0.000512971782
  error estimate for blocks of size 2^( 3) =       0.000532641116
  error estimate for blocks of size 2^( 4) =       0.000548007211
  error estimate for blocks of size 2^( 5) =       0.000557766025
  error estimate for blocks of size 2^( 6) =       0.000563852872
  error estimate for blocks of size 2^( 7) =       0.000567667008

      target function =      -0.557999862543
              le_mean =     -22.814596371554
             les_mean =     521.244291115325
             stat err =       0.000559323279
             autocorr =       1.292112925254
   target nu stat err =       0.000559323279
   target dn stat err =       0.234169306091
      target stat err =       0.068177322227
              std dev =       0.695869268461
             le_variance =       0.484234038788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.644782942573        initial
     1.5625e-01     1.5625e+00             5.8247e-03        -0.603202556899
     6.2500e-01     6.2500e+00             1.7415e-03        -0.645470067705  <--
     2.5000e+00     2.5000e+01             4.5773e-04        -0.557999862543

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 7.1017e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_01                 1.520582e-01 3 1  ON 0
ci_02                -4.762025e-02 3 1  ON 1
ci_03                -4.763193e-02 3 1  ON 2
ci_04                 4.554092e-02 3 1  ON 3
ci_05                -3.378290e-02 3 1  ON 4
ci_06                -3.403370e-02 3 1  ON 5
ci_07                 2.909097e-02 3 1  ON 6
ci_08                -1.407416e-02 3 1  ON 7
ci_09                -1.478072e-02 3 1  ON 8
ci_10                -1.494327e-02 3 1  ON 9
ci_11                 1.519413e-02 3 1  ON 10
ci_12                 1.160353e-02 3 1  ON 11
ci_13                 1.253109e-02 3 1  ON 12
ci_14                 1.301563e-02 3 1  ON 13
ci_15                 1.064338e-02 3 1  ON 14
ci_16                 1.059634e-02 3 1  ON 15
ci_17                -1.046329e-02 3 1  ON 16
ci_18                -1.049662e-02 3 1  ON 17
ci_19                 1.072462e-02 3 1  ON 18
ci_20                 9.529249e-03 3 1  ON 19
ci_21                 9.339449e-03 3 1  ON 20
ci_22                 9.619479e-03 3 1  ON 21
ci_23                 5.871501e-03 3 1  ON 22
ci_24                 5.082334e-03 3 1  ON 23
ci_25                 4.423647e-03 3 1  ON 24
ci_26                 4.008514e-03 3 1  ON 25
ci_27                 4.109474e-03 3 1  ON 26
ci_28                 3.593301e-03 3 1  ON 27
ci_29                 3.725300e-03 3 1  ON 28
ci_30                -2.994686e-03 3 1  ON 29
ci_31                -2.817630e-03 3 1  ON 30
ci_32                -2.359929e-03 3 1  ON 31
ci_33                -2.589048e-03 3 1  ON 32
ci_34                 1.945616e-03 3 1  ON 33
ci_35                 2.060256e-03 3 1  ON 34
ci_36                -1.918941e-03 3 1  ON 35
ci_37                -1.993346e-03 3 1  ON 36
ci_38                -1.446150e-03 3 1  ON 37
ci_39                -1.531608e-03 3 1  ON 38
ci_40                -1.870766e-03 3 1  ON 39
ci_41                -1.635217e-03 3 1  ON 40
ci_42                -1.477170e-03 3 1  ON 41
ci_43                -2.183221e-03 3 1  ON 42
ci_44                -1.936087e-03 3 1  ON 43
ci_45                -1.400123e-03 3 1  ON 44
ci_46                -1.344064e-03 3 1  ON 45
ci_47                -1.268397e-03 3 1  ON 46
ci_48                -1.109914e-03 3 1  ON 47
ci_49                -1.667321e-03 3 1  ON 48
ci_50                -1.358544e-03 3 1  ON 49
ci_51                 1.259422e-03 3 1  ON 50
ci_52                 1.227763e-03 3 1  ON 51
ci_53                -1.291175e-03 3 1  ON 52
ci_54                -1.171867e-03 3 1  ON 53
ci_55                -1.314964e-03 3 1  ON 54
ci_56                 1.611480e-03 3 1  ON 55
ci_57                 1.582839e-03 3 1  ON 56
ci_58                -1.136771e-03 3 1  ON 57
ci_59                -1.044284e-03 3 1  ON 58
ci_60                 7.709473e-04 3 1  ON 59
ci_61                 1.191021e-03 3 1  ON 60
ci_62                -9.538303e-04 3 1  ON 61
ci_63                -8.254771e-04 3 1  ON 62
ci_64                -8.940109e-04 3 1  ON 63
ci_65                -7.961699e-04 3 1  ON 64
ci_66                -8.272914e-04 3 1  ON 65
ci_67                -8.678021e-04 3 1  ON 66
ci_68                 2.365887e-04 3 1  ON 67
ci_69                 1.651078e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2270e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2798e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8805
    reference variance = 0.377584
====================================================
  Execution time = 4.2547e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9983e-01
  Total weights = 1.963275497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483323254953
                                         uncertainty =       0.002478736540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483323254953
                                         uncertainty =       0.002478736540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491582471
  error estimate for blocks of size 2^( 2) =       0.000513159203
  error estimate for blocks of size 2^( 3) =       0.000532412162
  error estimate for blocks of size 2^( 4) =       0.000547029542
  error estimate for blocks of size 2^( 5) =       0.000556372127
  error estimate for blocks of size 2^( 6) =       0.000559984684
  error estimate for blocks of size 2^( 7) =       0.000562879705

      target function =      -0.647050239762
              le_mean =     -22.815346381738
             les_mean =     521.039855592793
             stat err =       0.000556566515
             autocorr =       1.281862287598
   target nu stat err =       0.000556566515
   target dn stat err =       0.003450371537
      target stat err =       0.001372602841
              std dev =       0.695202597615
             le_variance =       0.483306651731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281534638174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647052766145       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648422642243       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648659334685       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648695353944       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648708651470       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648711109816       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648711672389       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648711671515       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648711680046       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648711702018       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648711703984       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 5.992717e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647052766145       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647460231333       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647526836931       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647536194571       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647539399712       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647539867024       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647539961910       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647539960053       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647539961842       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647539965892       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.669812e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647052766145       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647159691580       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647176863906       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647179216395       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647180003529       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647180109439       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647180130145       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647180129638       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647180130067       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647180130979       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.298042e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0161e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_01                 1.503884e-01 3 1  ON 0
ci_02                -4.619117e-02 3 1  ON 1
ci_03                -4.619477e-02 3 1  ON 2
ci_04                 4.392233e-02 3 1  ON 3
ci_05                -3.288780e-02 3 1  ON 4
ci_06                -3.322402e-02 3 1  ON 5
ci_07                 2.891160e-02 3 1  ON 6
ci_08                -1.337433e-02 3 1  ON 7
ci_09                -1.435651e-02 3 1  ON 8
ci_10                -1.457516e-02 3 1  ON 9
ci_11                 1.507704e-02 3 1  ON 10
ci_12                 1.122803e-02 3 1  ON 11
ci_13                 1.254028e-02 3 1  ON 12
ci_14                 1.316110e-02 3 1  ON 13
ci_15                 1.038598e-02 3 1  ON 14
ci_16                 1.035684e-02 3 1  ON 15
ci_17                -1.033848e-02 3 1  ON 16
ci_18                -1.032034e-02 3 1  ON 17
ci_19                 1.054341e-02 3 1  ON 18
ci_20                 9.431081e-03 3 1  ON 19
ci_21                 9.263361e-03 3 1  ON 20
ci_22                 9.529368e-03 3 1  ON 21
ci_23                 5.830194e-03 3 1  ON 22
ci_24                 5.110731e-03 3 1  ON 23
ci_25                 4.325533e-03 3 1  ON 24
ci_26                 3.955434e-03 3 1  ON 25
ci_27                 4.072810e-03 3 1  ON 26
ci_28                 3.489531e-03 3 1  ON 27
ci_29                 3.574208e-03 3 1  ON 28
ci_30                -2.811283e-03 3 1  ON 29
ci_31                -2.622973e-03 3 1  ON 30
ci_32                -2.136039e-03 3 1  ON 31
ci_33                -2.452533e-03 3 1  ON 32
ci_34                 1.742756e-03 3 1  ON 33
ci_35                 1.989182e-03 3 1  ON 34
ci_36                -1.860199e-03 3 1  ON 35
ci_37                -1.910799e-03 3 1  ON 36
ci_38                -1.378001e-03 3 1  ON 37
ci_39                -1.428106e-03 3 1  ON 38
ci_40                -1.861497e-03 3 1  ON 39
ci_41                -1.525652e-03 3 1  ON 40
ci_42                -1.411144e-03 3 1  ON 41
ci_43                -2.125109e-03 3 1  ON 42
ci_44                -2.009620e-03 3 1  ON 43
ci_45                -1.361933e-03 3 1  ON 44
ci_46                -1.310967e-03 3 1  ON 45
ci_47                -1.223758e-03 3 1  ON 46
ci_48                -9.889105e-04 3 1  ON 47
ci_49                -1.669969e-03 3 1  ON 48
ci_50                -1.344321e-03 3 1  ON 49
ci_51                 1.149370e-03 3 1  ON 50
ci_52                 1.196530e-03 3 1  ON 51
ci_53                -1.242219e-03 3 1  ON 52
ci_54                -1.118265e-03 3 1  ON 53
ci_55                -1.315792e-03 3 1  ON 54
ci_56                 1.610585e-03 3 1  ON 55
ci_57                 1.631469e-03 3 1  ON 56
ci_58                -1.157175e-03 3 1  ON 57
ci_59                -1.018868e-03 3 1  ON 58
ci_60                 7.719826e-04 3 1  ON 59
ci_61                 1.162513e-03 3 1  ON 60
ci_62                -9.468561e-04 3 1  ON 61
ci_63                -7.487378e-04 3 1  ON 62
ci_64                -8.252221e-04 3 1  ON 63
ci_65                -8.240642e-04 3 1  ON 64
ci_66                -8.105785e-04 3 1  ON 65
ci_67                -8.487385e-04 3 1  ON 66
ci_68                 1.994443e-04 3 1  ON 67
ci_69                -2.342655e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8091
    reference variance = 0.343816
====================================================
  Execution time = 4.1401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0586e-01
  Total weights = 1.9632e+06
  Execution time = 5.9094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0664166
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491967911090
                                         uncertainty =       0.003161923834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491967911090
                                         uncertainty =       0.003161923834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495926441
  error estimate for blocks of size 2^( 2) =       0.000517242379
  error estimate for blocks of size 2^( 3) =       0.000536347915
  error estimate for blocks of size 2^( 4) =       0.000552048427
  error estimate for blocks of size 2^( 5) =       0.000560909068
  error estimate for blocks of size 2^( 6) =       0.000565106139
  error estimate for blocks of size 2^( 7) =       0.000568923545

      target function =      -0.580638724386
              le_mean =     -22.816062328413
             les_mean =     521.249647199183
             stat err =       0.000561746795
             autocorr =       1.283059153699
   target nu stat err =       0.000561746795
   target dn stat err =       0.166386111009
      target stat err =       0.052169934106
              std dev =       0.701345898120
             le_variance =       0.491886068809

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00309633
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485477066487
                                         uncertainty =       0.003267676904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485477066487
                                         uncertainty =       0.003267676904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492646601
  error estimate for blocks of size 2^( 2) =       0.000513874971
  error estimate for blocks of size 2^( 3) =       0.000532965621
  error estimate for blocks of size 2^( 4) =       0.000548617498
  error estimate for blocks of size 2^( 5) =       0.000557508033
  error estimate for blocks of size 2^( 6) =       0.000561747925
  error estimate for blocks of size 2^( 7) =       0.000565417422

      target function =      -0.630132152600
              le_mean =     -22.816115965285
             les_mean =     521.120040547497
             stat err =       0.000558322720
             autocorr =       1.284397997191
   target nu stat err =       0.000558322720
   target dn stat err =       0.026019010783
      target stat err =       0.009539419297
              std dev =       0.696707505081
             le_variance =       0.485401347636

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0680146
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487544153836
                                         uncertainty =       0.003143176127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487544153836
                                         uncertainty =       0.003143176127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493693426
  error estimate for blocks of size 2^( 2) =       0.000514940027
  error estimate for blocks of size 2^( 3) =       0.000534035523
  error estimate for blocks of size 2^( 4) =       0.000549711140
  error estimate for blocks of size 2^( 5) =       0.000558588853
  error estimate for blocks of size 2^( 6) =       0.000562826545
  error estimate for blocks of size 2^( 7) =       0.000566604598

      target function =      -0.640670113241
              le_mean =     -22.816044648975
             les_mean =     521.088779418056
             stat err =       0.000559432784
             autocorr =       1.284047644219
   target nu stat err =       0.000559432784
   target dn stat err =       0.010424721988
      target stat err =       0.003961470488
              std dev =       0.698187938776
             le_variance =       0.487466397853

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.21793
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491240130800
                                         uncertainty =       0.003158099277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491240130800
                                         uncertainty =       0.003158099277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495559810
  error estimate for blocks of size 2^( 2) =       0.000516865458
  error estimate for blocks of size 2^( 3) =       0.000535963007
  error estimate for blocks of size 2^( 4) =       0.000551662660
  error estimate for blocks of size 2^( 5) =       0.000560512913
  error estimate for blocks of size 2^( 6) =       0.000564715052
  error estimate for blocks of size 2^( 7) =       0.000568545723

      target function =      -0.643930007987
              le_mean =     -22.816057076202
             les_mean =     521.080840775931
             stat err =       0.000561359087
             autocorr =       1.283185252371
   target nu stat err =       0.000561359087
   target dn stat err =       0.004551244767
      target stat err =       0.001772671977
              std dev =       0.700827403643
             le_variance =       0.491159049697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.580638724386        initial
     1.5625e-01     1.5625e+00             5.9927e-03        -0.630132152600
     6.2500e-01     6.2500e+00             1.6698e-03        -0.640670113241
     2.5000e+00     2.5000e+01             4.2980e-04        -0.643930007987  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 7.1052e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_01                 1.516284e-01 3 1  ON 0
ci_02                -4.724664e-02 3 1  ON 1
ci_03                -4.725645e-02 3 1  ON 2
ci_04                 4.511547e-02 3 1  ON 3
ci_05                -3.354825e-02 3 1  ON 4
ci_06                -3.382128e-02 3 1  ON 5
ci_07                 2.904434e-02 3 1  ON 6
ci_08                -1.389033e-02 3 1  ON 7
ci_09                -1.467041e-02 3 1  ON 8
ci_10                -1.484758e-02 3 1  ON 9
ci_11                 1.516331e-02 3 1  ON 10
ci_12                 1.150521e-02 3 1  ON 11
ci_13                 1.253318e-02 3 1  ON 12
ci_14                 1.305267e-02 3 1  ON 13
ci_15                 1.057611e-02 3 1  ON 14
ci_16                 1.053377e-02 3 1  ON 15
ci_17                -1.043102e-02 3 1  ON 16
ci_18                -1.045081e-02 3 1  ON 17
ci_19                 1.067673e-02 3 1  ON 18
ci_20                 9.503474e-03 3 1  ON 19
ci_21                 9.319864e-03 3 1  ON 20
ci_22                 9.596257e-03 3 1  ON 21
ci_23                 5.860552e-03 3 1  ON 22
ci_24                 5.089585e-03 3 1  ON 23
ci_25                 4.397912e-03 3 1  ON 24
ci_26                 3.994518e-03 3 1  ON 25
ci_27                 4.099780e-03 3 1  ON 26
ci_28                 3.566498e-03 3 1  ON 27
ci_29                 3.685947e-03 3 1  ON 28
ci_30                -2.947534e-03 3 1  ON 29
ci_31                -2.767548e-03 3 1  ON 30
ci_32                -2.300732e-03 3 1  ON 31
ci_33                -2.552758e-03 3 1  ON 32
ci_34                 1.892195e-03 3 1  ON 33
ci_35                 2.041070e-03 3 1  ON 34
ci_36                -1.903536e-03 3 1  ON 35
ci_37                -1.971779e-03 3 1  ON 36
ci_38                -1.428340e-03 3 1  ON 37
ci_39                -1.504485e-03 3 1  ON 38
ci_40                -1.868335e-03 3 1  ON 39
ci_41                -1.606036e-03 3 1  ON 40
ci_42                -1.459495e-03 3 1  ON 41
ci_43                -2.168462e-03 3 1  ON 42
ci_44                -1.955559e-03 3 1  ON 43
ci_45                -1.390136e-03 3 1  ON 44
ci_46                -1.335456e-03 3 1  ON 45
ci_47                -1.257124e-03 3 1  ON 46
ci_48                -1.078765e-03 3 1  ON 47
ci_49                -1.668089e-03 3 1  ON 48
ci_50                -1.354793e-03 3 1  ON 49
ci_51                 1.230615e-03 3 1  ON 50
ci_52                 1.219564e-03 3 1  ON 51
ci_53                -1.278243e-03 3 1  ON 52
ci_54                -1.157900e-03 3 1  ON 53
ci_55                -1.315188e-03 3 1  ON 54
ci_56                 1.611146e-03 3 1  ON 55
ci_57                 1.595521e-03 3 1  ON 56
ci_58                -1.142106e-03 3 1  ON 57
ci_59                -1.037556e-03 3 1  ON 58
ci_60                 7.712327e-04 3 1  ON 59
ci_61                 1.183844e-03 3 1  ON 60
ci_62                -9.520243e-04 3 1  ON 61
ci_63                -8.053029e-04 3 1  ON 62
ci_64                -8.760177e-04 3 1  ON 63
ci_65                -8.036073e-04 3 1  ON 64
ci_66                -8.229595e-04 3 1  ON 65
ci_67                -8.630038e-04 3 1  ON 66
ci_68                 2.268730e-04 3 1  ON 67
ci_69                 1.158209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2122e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2802e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8614
    reference variance = 0.824713
====================================================
  Execution time = 4.4723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9688e-01
  Total weights = 1.963306408e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482972117820
                                         uncertainty =       0.002348253456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482972117820
                                         uncertainty =       0.002348253456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491418649
  error estimate for blocks of size 2^( 2) =       0.000512690176
  error estimate for blocks of size 2^( 3) =       0.000532076937
  error estimate for blocks of size 2^( 4) =       0.000546720617
  error estimate for blocks of size 2^( 5) =       0.000556190190
  error estimate for blocks of size 2^( 6) =       0.000560904257
  error estimate for blocks of size 2^( 7) =       0.000562340425

      target function =      -0.648124206537
              le_mean =     -22.815078877613
             les_mean =     521.024706032126
             stat err =       0.000556538872
             autocorr =       1.282589675423
   target nu stat err =       0.000556538872
   target dn stat err =       0.002910360963
      target stat err =       0.001174874509
              std dev =       0.694970918837
             le_variance =       0.482984578030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281507887761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648125927066       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648508971592       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648564216469       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648572311947       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648574268678       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648575118848       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648575303228       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648575289578       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648575285781       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648575285721       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.630968e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648125927066       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648226421341       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648240677686       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648242716157       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648243195958       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648243398423       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648243440566       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648243437058       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648243436137       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648243436126       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.286756e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648125927066       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648151364696       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648154957436       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648155467796       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648155587077       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648155637024       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648155647305       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648155646423       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648155646195       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648155646192       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.085609e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160562 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2357e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_01                 1.512320e-01 3 1  ON 0
ci_02                -4.691317e-02 3 1  ON 1
ci_03                -4.688873e-02 3 1  ON 2
ci_04                 4.468679e-02 3 1  ON 3
ci_05                -3.328353e-02 3 1  ON 4
ci_06                -3.360220e-02 3 1  ON 5
ci_07                 2.898762e-02 3 1  ON 6
ci_08                -1.372131e-02 3 1  ON 7
ci_09                -1.457003e-02 3 1  ON 8
ci_10                -1.472853e-02 3 1  ON 9
ci_11                 1.512220e-02 3 1  ON 10
ci_12                 1.143317e-02 3 1  ON 11
ci_13                 1.252929e-02 3 1  ON 12
ci_14                 1.306501e-02 3 1  ON 13
ci_15                 1.051948e-02 3 1  ON 14
ci_16                 1.048058e-02 3 1  ON 15
ci_17                -1.037840e-02 3 1  ON 16
ci_18                -1.042272e-02 3 1  ON 17
ci_19                 1.064533e-02 3 1  ON 18
ci_20                 9.468941e-03 3 1  ON 19
ci_21                 9.322690e-03 3 1  ON 20
ci_22                 9.572129e-03 3 1  ON 21
ci_23                 5.832877e-03 3 1  ON 22
ci_24                 5.084681e-03 3 1  ON 23
ci_25                 4.374286e-03 3 1  ON 24
ci_26                 3.993457e-03 3 1  ON 25
ci_27                 4.071049e-03 3 1  ON 26
ci_28                 3.545618e-03 3 1  ON 27
ci_29                 3.677045e-03 3 1  ON 28
ci_30                -2.923060e-03 3 1  ON 29
ci_31                -2.742105e-03 3 1  ON 30
ci_32                -2.265758e-03 3 1  ON 31
ci_33                -2.546521e-03 3 1  ON 32
ci_34                 1.849423e-03 3 1  ON 33
ci_35                 2.018659e-03 3 1  ON 34
ci_36                -1.892835e-03 3 1  ON 35
ci_37                -1.950529e-03 3 1  ON 36
ci_38                -1.404981e-03 3 1  ON 37
ci_39                -1.493127e-03 3 1  ON 38
ci_40                -1.870718e-03 3 1  ON 39
ci_41                -1.589719e-03 3 1  ON 40
ci_42                -1.438933e-03 3 1  ON 41
ci_43                -2.155035e-03 3 1  ON 42
ci_44                -1.947727e-03 3 1  ON 43
ci_45                -1.375348e-03 3 1  ON 44
ci_46                -1.324381e-03 3 1  ON 45
ci_47                -1.210212e-03 3 1  ON 46
ci_48                -1.069919e-03 3 1  ON 47
ci_49                -1.676855e-03 3 1  ON 48
ci_50                -1.340592e-03 3 1  ON 49
ci_51                 1.201210e-03 3 1  ON 50
ci_52                 1.207165e-03 3 1  ON 51
ci_53                -1.265658e-03 3 1  ON 52
ci_54                -1.166591e-03 3 1  ON 53
ci_55                -1.314194e-03 3 1  ON 54
ci_56                 1.607309e-03 3 1  ON 55
ci_57                 1.610596e-03 3 1  ON 56
ci_58                -1.139425e-03 3 1  ON 57
ci_59                -1.034832e-03 3 1  ON 58
ci_60                 7.730600e-04 3 1  ON 59
ci_61                 1.163016e-03 3 1  ON 60
ci_62                -9.416532e-04 3 1  ON 61
ci_63                -7.936609e-04 3 1  ON 62
ci_64                -8.544580e-04 3 1  ON 63
ci_65                -7.593243e-04 3 1  ON 64
ci_66                -8.324376e-04 3 1  ON 65
ci_67                -8.591821e-04 3 1  ON 66
ci_68                 1.836160e-04 3 1  ON 67
ci_69                 9.382257e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8151
    reference variance = 0.366644
====================================================
  Execution time = 4.3826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0098e-01
  Total weights = 1.9631e+06
  Execution time = 5.9020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486049138785
                                         uncertainty =       0.002239902724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486049138785
                                         uncertainty =       0.002239902724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493042025
  error estimate for blocks of size 2^( 2) =       0.000513981002
  error estimate for blocks of size 2^( 3) =       0.000533162876
  error estimate for blocks of size 2^( 4) =       0.000548117674
  error estimate for blocks of size 2^( 5) =       0.000557426110
  error estimate for blocks of size 2^( 6) =       0.000564038360
  error estimate for blocks of size 2^( 7) =       0.000565623741

      target function =      -0.642835169962
              le_mean =     -22.815690935092
             les_mean =     521.066731722555
             stat err =       0.000558801471
             autocorr =       1.284538735467
   target nu stat err =       0.000558801471
   target dn stat err =       0.009743438855
      target stat err =       0.003728157098
              std dev =       0.697266718485
             le_variance =       0.486180876707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484023713326
                                         uncertainty =       0.002227060009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484023713326
                                         uncertainty =       0.002227060009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492011993
  error estimate for blocks of size 2^( 2) =       0.000512915268
  error estimate for blocks of size 2^( 3) =       0.000532079491
  error estimate for blocks of size 2^( 4) =       0.000547037119
  error estimate for blocks of size 2^( 5) =       0.000556353983
  error estimate for blocks of size 2^( 6) =       0.000562994205
  error estimate for blocks of size 2^( 7) =       0.000564527756

      target function =      -0.638162510651
              le_mean =     -22.815710654593
             les_mean =     521.079917147090
             stat err =       0.000557728266
             autocorr =       1.284972792608
   target nu stat err =       0.000557728266
   target dn stat err =       0.015031791951
      target stat err =       0.005655808220
              std dev =       0.695810033326
             le_variance =       0.484151602477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484949196636
                                         uncertainty =       0.002231702680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484949196636
                                         uncertainty =       0.002231702680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492482963
  error estimate for blocks of size 2^( 2) =       0.000513403431
  error estimate for blocks of size 2^( 3) =       0.000532572158
  error estimate for blocks of size 2^( 4) =       0.000547530907
  error estimate for blocks of size 2^( 5) =       0.000556839961
  error estimate for blocks of size 2^( 6) =       0.000563466092
  error estimate for blocks of size 2^( 7) =       0.000565036038

      target function =      -0.645430195459
              le_mean =     -22.815696991308
             les_mean =     521.060272404123
             stat err =       0.000558218249
             autocorr =       1.284770743761
   target nu stat err =       0.000558218249
   target dn stat err =       0.004814424780
      target stat err =       0.001879284825
              std dev =       0.696476085621
             le_variance =       0.485078937842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485902909629
                                         uncertainty =       0.002238494394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485902909629
                                         uncertainty =       0.002238494394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492967751
  error estimate for blocks of size 2^( 2) =       0.000513904575
  error estimate for blocks of size 2^( 3) =       0.000533084937
  error estimate for blocks of size 2^( 4) =       0.000548040563
  error estimate for blocks of size 2^( 5) =       0.000557350301
  error estimate for blocks of size 2^( 6) =       0.000563965139
  error estimate for blocks of size 2^( 7) =       0.000565545335

      target function =      -0.646460989912
              le_mean =     -22.815690736101
             les_mean =     521.057311985878
             stat err =       0.000558725334
             autocorr =       1.284575720339
   target nu stat err =       0.000558725334
   target dn stat err =       0.003210136452
      target stat err =       0.001281304950
              std dev =       0.697161679314
             le_variance =       0.486034407104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.642835169962        initial
     6.2500e-01     6.2500e+00             1.6310e-03        -0.638162510651
     2.5000e+00     2.5000e+01             4.2868e-04        -0.645430195459
     1.0000e+01     1.0000e+02             1.0856e-04        -0.646460989912  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 7.3428e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_01                 1.515285e-01 3 1  ON 0
ci_02                -4.716231e-02 3 1  ON 1
ci_03                -4.716346e-02 3 1  ON 2
ci_04                 4.500691e-02 3 1  ON 3
ci_05                -3.348127e-02 3 1  ON 4
ci_06                -3.376582e-02 3 1  ON 5
ci_07                 2.903002e-02 3 1  ON 6
ci_08                -1.384754e-02 3 1  ON 7
ci_09                -1.464506e-02 3 1  ON 8
ci_10                -1.481752e-02 3 1  ON 9
ci_11                 1.515291e-02 3 1  ON 10
ci_12                 1.148698e-02 3 1  ON 11
ci_13                 1.253218e-02 3 1  ON 12
ci_14                 1.305575e-02 3 1  ON 13
ci_15                 1.056179e-02 3 1  ON 14
ci_16                 1.052032e-02 3 1  ON 15
ci_17                -1.041774e-02 3 1  ON 16
ci_18                -1.044373e-02 3 1  ON 17
ci_19                 1.066877e-02 3 1  ON 18
ci_20                 9.494734e-03 3 1  ON 19
ci_21                 9.320574e-03 3 1  ON 20
ci_22                 9.590181e-03 3 1  ON 21
ci_23                 5.853537e-03 3 1  ON 22
ci_24                 5.088335e-03 3 1  ON 23
ci_25                 4.391927e-03 3 1  ON 24
ci_26                 3.994238e-03 3 1  ON 25
ci_27                 4.092507e-03 3 1  ON 26
ci_28                 3.561241e-03 3 1  ON 27
ci_29                 3.683716e-03 3 1  ON 28
ci_30                -2.941365e-03 3 1  ON 29
ci_31                -2.761149e-03 3 1  ON 30
ci_32                -2.291857e-03 3 1  ON 31
ci_33                -2.551156e-03 3 1  ON 32
ci_34                 1.881342e-03 3 1  ON 33
ci_35                 2.035375e-03 3 1  ON 34
ci_36                -1.900829e-03 3 1  ON 35
ci_37                -1.966404e-03 3 1  ON 36
ci_38                -1.422431e-03 3 1  ON 37
ci_39                -1.501611e-03 3 1  ON 38
ci_40                -1.868945e-03 3 1  ON 39
ci_41                -1.601880e-03 3 1  ON 40
ci_42                -1.454268e-03 3 1  ON 41
ci_43                -2.165091e-03 3 1  ON 42
ci_44                -1.953600e-03 3 1  ON 43
ci_45                -1.386397e-03 3 1  ON 44
ci_46                -1.332660e-03 3 1  ON 45
ci_47                -1.245305e-03 3 1  ON 46
ci_48                -1.076542e-03 3 1  ON 47
ci_49                -1.670309e-03 3 1  ON 48
ci_50                -1.351193e-03 3 1  ON 49
ci_51                 1.223178e-03 3 1  ON 50
ci_52                 1.216431e-03 3 1  ON 51
ci_53                -1.275056e-03 3 1  ON 52
ci_54                -1.160096e-03 3 1  ON 53
ci_55                -1.314936e-03 3 1  ON 54
ci_56                 1.610167e-03 3 1  ON 55
ci_57                 1.599338e-03 3 1  ON 56
ci_58                -1.141422e-03 3 1  ON 57
ci_59                -1.036866e-03 3 1  ON 58
ci_60                 7.716747e-04 3 1  ON 59
ci_61                 1.178603e-03 3 1  ON 60
ci_62                -9.494022e-04 3 1  ON 61
ci_63                -8.023530e-04 3 1  ON 62
ci_64                -8.705616e-04 3 1  ON 63
ci_65                -7.924024e-04 3 1  ON 64
ci_66                -8.253633e-04 3 1  ON 65
ci_67                -8.620427e-04 3 1  ON 66
ci_68                 2.159241e-04 3 1  ON 67
ci_69                 1.102526e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2580e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8467
    reference variance = 0.472995
====================================================
  Execution time = 4.2609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9902e-01
  Total weights = 1.963060926e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484475197101
                                         uncertainty =       0.002393308747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484475197101
                                         uncertainty =       0.002393308747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492174831
  error estimate for blocks of size 2^( 2) =       0.000513267091
  error estimate for blocks of size 2^( 3) =       0.000533395466
  error estimate for blocks of size 2^( 4) =       0.000548281161
  error estimate for blocks of size 2^( 5) =       0.000558764792
  error estimate for blocks of size 2^( 6) =       0.000563988866
  error estimate for blocks of size 2^( 7) =       0.000571284281

      target function =      -0.647198646247
              le_mean =     -22.814672648216
             les_mean =     521.008308049962
             stat err =       0.000560579775
             autocorr =       1.297286944749
   target nu stat err =       0.000560579775
   target dn stat err =       0.003405936217
      target stat err =       0.001356315465
              std dev =       0.696040321162
             le_variance =       0.484472128683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467264822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647201054249       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647301880613       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647316833305       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647319046134       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647319619126       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647319745076       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647319776067       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647319774642       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647319774609       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.165688e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647201054249       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647226577275       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647230344235       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647230898748       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647231041178       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647231072148       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647231079679       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647231079316       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647231079306       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.055052e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647201054249       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647207455089       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647208398640       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647208537347       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647208572902       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647208580612       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647208582481       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647208582390       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647208582387       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.646287e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0267e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_01                 1.514344e-01 3 1  ON 0
ci_02                -4.706735e-02 3 1  ON 1
ci_03                -4.707214e-02 3 1  ON 2
ci_04                 4.490140e-02 3 1  ON 3
ci_05                -3.341975e-02 3 1  ON 4
ci_06                -3.370528e-02 3 1  ON 5
ci_07                 2.901925e-02 3 1  ON 6
ci_08                -1.380601e-02 3 1  ON 7
ci_09                -1.461944e-02 3 1  ON 8
ci_10                -1.479451e-02 3 1  ON 9
ci_11                 1.514125e-02 3 1  ON 10
ci_12                 1.146853e-02 3 1  ON 11
ci_13                 1.253649e-02 3 1  ON 12
ci_14                 1.306127e-02 3 1  ON 13
ci_15                 1.054625e-02 3 1  ON 14
ci_16                 1.051217e-02 3 1  ON 15
ci_17                -1.040838e-02 3 1  ON 16
ci_18                -1.042905e-02 3 1  ON 17
ci_19                 1.065836e-02 3 1  ON 18
ci_20                 9.485381e-03 3 1  ON 19
ci_21                 9.319806e-03 3 1  ON 20
ci_22                 9.590239e-03 3 1  ON 21
ci_23                 5.848270e-03 3 1  ON 22
ci_24                 5.083347e-03 3 1  ON 23
ci_25                 4.387725e-03 3 1  ON 24
ci_26                 3.990397e-03 3 1  ON 25
ci_27                 4.090577e-03 3 1  ON 26
ci_28                 3.551186e-03 3 1  ON 27
ci_29                 3.671939e-03 3 1  ON 28
ci_30                -2.935844e-03 3 1  ON 29
ci_31                -2.757328e-03 3 1  ON 30
ci_32                -2.285969e-03 3 1  ON 31
ci_33                -2.542436e-03 3 1  ON 32
ci_34                 1.877796e-03 3 1  ON 33
ci_35                 2.031552e-03 3 1  ON 34
ci_36                -1.895039e-03 3 1  ON 35
ci_37                -1.959025e-03 3 1  ON 36
ci_38                -1.418508e-03 3 1  ON 37
ci_39                -1.495872e-03 3 1  ON 38
ci_40                -1.866096e-03 3 1  ON 39
ci_41                -1.596492e-03 3 1  ON 40
ci_42                -1.451261e-03 3 1  ON 41
ci_43                -2.161716e-03 3 1  ON 42
ci_44                -1.956625e-03 3 1  ON 43
ci_45                -1.384156e-03 3 1  ON 44
ci_46                -1.327548e-03 3 1  ON 45
ci_47                -1.236653e-03 3 1  ON 46
ci_48                -1.069839e-03 3 1  ON 47
ci_49                -1.668511e-03 3 1  ON 48
ci_50                -1.348570e-03 3 1  ON 49
ci_51                 1.223190e-03 3 1  ON 50
ci_52                 1.213305e-03 3 1  ON 51
ci_53                -1.269043e-03 3 1  ON 52
ci_54                -1.155073e-03 3 1  ON 53
ci_55                -1.315286e-03 3 1  ON 54
ci_56                 1.607105e-03 3 1  ON 55
ci_57                 1.597076e-03 3 1  ON 56
ci_58                -1.142895e-03 3 1  ON 57
ci_59                -1.037432e-03 3 1  ON 58
ci_60                 7.729766e-04 3 1  ON 59
ci_61                 1.172372e-03 3 1  ON 60
ci_62                -9.492833e-04 3 1  ON 61
ci_63                -8.020529e-04 3 1  ON 62
ci_64                -8.714072e-04 3 1  ON 63
ci_65                -7.909992e-04 3 1  ON 64
ci_66                -8.212304e-04 3 1  ON 65
ci_67                -8.641630e-04 3 1  ON 66
ci_68                 2.116097e-04 3 1  ON 67
ci_69                 1.059880e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7895
    reference variance = 0.317206
====================================================
  Execution time = 4.1261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0786e-01
  Total weights = 1.9631e+06
  Execution time = 5.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489542369225
                                         uncertainty =       0.002574900267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489542369225
                                         uncertainty =       0.002574900267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494696034
  error estimate for blocks of size 2^( 2) =       0.000515584376
  error estimate for blocks of size 2^( 3) =       0.000535434055
  error estimate for blocks of size 2^( 4) =       0.000549717826
  error estimate for blocks of size 2^( 5) =       0.000559293531
  error estimate for blocks of size 2^( 6) =       0.000563530635
  error estimate for blocks of size 2^( 7) =       0.000567941249

      target function =      -0.644010054389
              le_mean =     -22.815533043845
             les_mean =     521.056398526088
             stat err =       0.000560120810
             autocorr =       1.281995673969
   target nu stat err =       0.000560120810
   target dn stat err =       0.004145022935
      target stat err =       0.001619773353
              std dev =       0.699605840461
             le_variance =       0.489448332007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489038290383
                                         uncertainty =       0.002568870626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489038290383
                                         uncertainty =       0.002568870626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494441352
  error estimate for blocks of size 2^( 2) =       0.000515320911
  error estimate for blocks of size 2^( 3) =       0.000535164717
  error estimate for blocks of size 2^( 4) =       0.000549448540
  error estimate for blocks of size 2^( 5) =       0.000559022394
  error estimate for blocks of size 2^( 6) =       0.000563267326
  error estimate for blocks of size 2^( 7) =       0.000567669492

      target function =      -0.631162543142
              le_mean =     -22.815535586181
             les_mean =     521.090131332554
             stat err =       0.000559851938
             autocorr =       1.282084949378
   target nu stat err =       0.000559851938
   target dn stat err =       0.033981868044
      target stat err =       0.012491996184
              std dev =       0.699245665256
             le_variance =       0.488944500380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489283993551
                                         uncertainty =       0.002571820257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489283993551
                                         uncertainty =       0.002571820257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494565508
  error estimate for blocks of size 2^( 2) =       0.000515448871
  error estimate for blocks of size 2^( 3) =       0.000535295675
  error estimate for blocks of size 2^( 4) =       0.000549580162
  error estimate for blocks of size 2^( 5) =       0.000559154950
  error estimate for blocks of size 2^( 6) =       0.000563395380
  error estimate for blocks of size 2^( 7) =       0.000567801428

      target function =      -0.644001664570
              le_mean =     -22.815533640341
             les_mean =     521.056447892196
             stat err =       0.000559982980
             autocorr =       1.282041267984
   target nu stat err =       0.000559982980
   target dn stat err =       0.004176940112
      target stat err =       0.001631664491
              std dev =       0.699421249200
             le_variance =       0.489190083833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489509680468
                                         uncertainty =       0.002574506245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489509680468
                                         uncertainty =       0.002574506245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494679522
  error estimate for blocks of size 2^( 2) =       0.000515567286
  error estimate for blocks of size 2^( 3) =       0.000535416626
  error estimate for blocks of size 2^( 4) =       0.000549700505
  error estimate for blocks of size 2^( 5) =       0.000559275950
  error estimate for blocks of size 2^( 6) =       0.000563513520
  error estimate for blocks of size 2^( 7) =       0.000567923790

      target function =      -0.642585974332
              le_mean =     -22.815533139868
             les_mean =     521.060126551313
             stat err =       0.000560103441
             autocorr =       1.282001745420
   target nu stat err =       0.000560103441
   target dn stat err =       0.005585929812
      target stat err =       0.002152633819
              std dev =       0.699582489429
             le_variance =       0.489415659516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.644010054389        initial  <--
     2.5000e+00     2.5000e+01             4.1657e-04        -0.631162543142
     1.0000e+01     1.0000e+02             1.0551e-04        -0.644001664570
     4.0000e+01     4.0000e+02             2.6463e-05        -0.642585974332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.7682
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_01                 1.515285e-01 3 1  ON 0
ci_02                -4.716231e-02 3 1  ON 1
ci_03                -4.716346e-02 3 1  ON 2
ci_04                 4.500691e-02 3 1  ON 3
ci_05                -3.348127e-02 3 1  ON 4
ci_06                -3.376582e-02 3 1  ON 5
ci_07                 2.903002e-02 3 1  ON 6
ci_08                -1.384754e-02 3 1  ON 7
ci_09                -1.464506e-02 3 1  ON 8
ci_10                -1.481752e-02 3 1  ON 9
ci_11                 1.515291e-02 3 1  ON 10
ci_12                 1.148698e-02 3 1  ON 11
ci_13                 1.253218e-02 3 1  ON 12
ci_14                 1.305575e-02 3 1  ON 13
ci_15                 1.056179e-02 3 1  ON 14
ci_16                 1.052032e-02 3 1  ON 15
ci_17                -1.041774e-02 3 1  ON 16
ci_18                -1.044373e-02 3 1  ON 17
ci_19                 1.066877e-02 3 1  ON 18
ci_20                 9.494734e-03 3 1  ON 19
ci_21                 9.320574e-03 3 1  ON 20
ci_22                 9.590181e-03 3 1  ON 21
ci_23                 5.853537e-03 3 1  ON 22
ci_24                 5.088335e-03 3 1  ON 23
ci_25                 4.391927e-03 3 1  ON 24
ci_26                 3.994238e-03 3 1  ON 25
ci_27                 4.092507e-03 3 1  ON 26
ci_28                 3.561241e-03 3 1  ON 27
ci_29                 3.683716e-03 3 1  ON 28
ci_30                -2.941365e-03 3 1  ON 29
ci_31                -2.761149e-03 3 1  ON 30
ci_32                -2.291857e-03 3 1  ON 31
ci_33                -2.551156e-03 3 1  ON 32
ci_34                 1.881342e-03 3 1  ON 33
ci_35                 2.035375e-03 3 1  ON 34
ci_36                -1.900829e-03 3 1  ON 35
ci_37                -1.966404e-03 3 1  ON 36
ci_38                -1.422431e-03 3 1  ON 37
ci_39                -1.501611e-03 3 1  ON 38
ci_40                -1.868945e-03 3 1  ON 39
ci_41                -1.601880e-03 3 1  ON 40
ci_42                -1.454268e-03 3 1  ON 41
ci_43                -2.165091e-03 3 1  ON 42
ci_44                -1.953600e-03 3 1  ON 43
ci_45                -1.386397e-03 3 1  ON 44
ci_46                -1.332660e-03 3 1  ON 45
ci_47                -1.245305e-03 3 1  ON 46
ci_48                -1.076542e-03 3 1  ON 47
ci_49                -1.670309e-03 3 1  ON 48
ci_50                -1.351193e-03 3 1  ON 49
ci_51                 1.223178e-03 3 1  ON 50
ci_52                 1.216431e-03 3 1  ON 51
ci_53                -1.275056e-03 3 1  ON 52
ci_54                -1.160096e-03 3 1  ON 53
ci_55                -1.314936e-03 3 1  ON 54
ci_56                 1.610167e-03 3 1  ON 55
ci_57                 1.599338e-03 3 1  ON 56
ci_58                -1.141422e-03 3 1  ON 57
ci_59                -1.036866e-03 3 1  ON 58
ci_60                 7.716747e-04 3 1  ON 59
ci_61                 1.178603e-03 3 1  ON 60
ci_62                -9.494022e-04 3 1  ON 61
ci_63                -8.023530e-04 3 1  ON 62
ci_64                -8.705616e-04 3 1  ON 63
ci_65                -7.924024e-04 3 1  ON 64
ci_66                -8.253633e-04 3 1  ON 65
ci_67                -8.620427e-04 3 1  ON 66
ci_68                 2.159241e-04 3 1  ON 67
ci_69                 1.102526e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2105e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8317
    reference variance = 0.348255
====================================================
  Execution time = 4.2590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.9808e-01
  Total weights = 1.963332889e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483338858841
                                         uncertainty =       0.002031594208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483338858841
                                         uncertainty =       0.002031594208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491595273
  error estimate for blocks of size 2^( 2) =       0.000512741311
  error estimate for blocks of size 2^( 3) =       0.000532678741
  error estimate for blocks of size 2^( 4) =       0.000547328901
  error estimate for blocks of size 2^( 5) =       0.000555976815
  error estimate for blocks of size 2^( 6) =       0.000562281344
  error estimate for blocks of size 2^( 7) =       0.000562679377

      target function =      -0.647324028092
              le_mean =     -22.813694601667
             les_mean =     520.962745839014
             stat err =       0.000557066609
             autocorr =       1.284100036984
   target nu stat err =       0.000557066609
   target dn stat err =       0.002769403518
      target stat err =       0.001118651815
              std dev =       0.695220702119
             le_variance =       0.483331824655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281369460167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647325539185       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647335331711       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647336795626       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647336997213       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647337061175       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647337091387       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647337094436       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647337094679       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647337094617       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.058490e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647325539185       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647327990390       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647328356662       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647328407071       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647328423054       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647328430597       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647328431357       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647328431418       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647328431402       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.015947e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647325539185       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647326152179       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647326243765       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647326256368       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647326260363       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647326262249       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647326262438       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647326262453       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647326262450       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 2.540697e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0331e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_01                 1.515187e-01 3 1  ON 0
ci_02                -4.715327e-02 3 1  ON 1
ci_03                -4.715438e-02 3 1  ON 2
ci_04                 4.499675e-02 3 1  ON 3
ci_05                -3.347581e-02 3 1  ON 4
ci_06                -3.375983e-02 3 1  ON 5
ci_07                 2.902896e-02 3 1  ON 6
ci_08                -1.384334e-02 3 1  ON 7
ci_09                -1.464297e-02 3 1  ON 8
ci_10                -1.481458e-02 3 1  ON 9
ci_11                 1.515210e-02 3 1  ON 10
ci_12                 1.148528e-02 3 1  ON 11
ci_13                 1.253171e-02 3 1  ON 12
ci_14                 1.305603e-02 3 1  ON 13
ci_15                 1.056022e-02 3 1  ON 14
ci_16                 1.051860e-02 3 1  ON 15
ci_17                -1.041683e-02 3 1  ON 16
ci_18                -1.044222e-02 3 1  ON 17
ci_19                 1.066808e-02 3 1  ON 18
ci_20                 9.493867e-03 3 1  ON 19
ci_21                 9.320354e-03 3 1  ON 20
ci_22                 9.589986e-03 3 1  ON 21
ci_23                 5.853342e-03 3 1  ON 22
ci_24                 5.088077e-03 3 1  ON 23
ci_25                 4.391320e-03 3 1  ON 24
ci_26                 3.994068e-03 3 1  ON 25
ci_27                 4.092288e-03 3 1  ON 26
ci_28                 3.560342e-03 3 1  ON 27
ci_29                 3.682777e-03 3 1  ON 28
ci_30                -2.940766e-03 3 1  ON 29
ci_31                -2.760445e-03 3 1  ON 30
ci_32                -2.290993e-03 3 1  ON 31
ci_33                -2.550534e-03 3 1  ON 32
ci_34                 1.880423e-03 3 1  ON 33
ci_35                 2.034512e-03 3 1  ON 34
ci_36                -1.900735e-03 3 1  ON 35
ci_37                -1.966099e-03 3 1  ON 36
ci_38                -1.422415e-03 3 1  ON 37
ci_39                -1.501153e-03 3 1  ON 38
ci_40                -1.868219e-03 3 1  ON 39
ci_41                -1.601731e-03 3 1  ON 40
ci_42                -1.453628e-03 3 1  ON 41
ci_43                -2.165226e-03 3 1  ON 42
ci_44                -1.953620e-03 3 1  ON 43
ci_45                -1.385754e-03 3 1  ON 44
ci_46                -1.332173e-03 3 1  ON 45
ci_47                -1.244772e-03 3 1  ON 46
ci_48                -1.075972e-03 3 1  ON 47
ci_49                -1.670202e-03 3 1  ON 48
ci_50                -1.350763e-03 3 1  ON 49
ci_51                 1.222619e-03 3 1  ON 50
ci_52                 1.216099e-03 3 1  ON 51
ci_53                -1.274718e-03 3 1  ON 52
ci_54                -1.160094e-03 3 1  ON 53
ci_55                -1.315236e-03 3 1  ON 54
ci_56                 1.610172e-03 3 1  ON 55
ci_57                 1.599285e-03 3 1  ON 56
ci_58                -1.141344e-03 3 1  ON 57
ci_59                -1.036928e-03 3 1  ON 58
ci_60                 7.716553e-04 3 1  ON 59
ci_61                 1.178757e-03 3 1  ON 60
ci_62                -9.492205e-04 3 1  ON 61
ci_63                -8.022649e-04 3 1  ON 62
ci_64                -8.705761e-04 3 1  ON 63
ci_65                -7.922562e-04 3 1  ON 64
ci_66                -8.255230e-04 3 1  ON 65
ci_67                -8.620607e-04 3 1  ON 66
ci_68                 2.152754e-04 3 1  ON 67
ci_69                 1.098531e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7232
    reference variance = 1.83864
====================================================
  Execution time = 4.3340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0145e-01
  Total weights = 1.9630e+06
  Execution time = 5.9519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483785846933
                                         uncertainty =       0.002090389228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483785846933
                                         uncertainty =       0.002090389228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491894721
  error estimate for blocks of size 2^( 2) =       0.000512988629
  error estimate for blocks of size 2^( 3) =       0.000532893035
  error estimate for blocks of size 2^( 4) =       0.000547016087
  error estimate for blocks of size 2^( 5) =       0.000557499198
  error estimate for blocks of size 2^( 6) =       0.000563557894
  error estimate for blocks of size 2^( 7) =       0.000566894537

      target function =      -0.646314389569
              le_mean =     -22.814920842203
             les_mean =     521.022082488973
             stat err =       0.000558741929
             autocorr =       1.290262879034
   target nu stat err =       0.000558741929
   target dn stat err =       0.003287637722
      target stat err =       0.001308669840
              std dev =       0.695644184994
             le_variance =       0.483920832115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483736564868
                                         uncertainty =       0.002090764115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483736564868
                                         uncertainty =       0.002090764115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491869687
  error estimate for blocks of size 2^( 2) =       0.000512962450
  error estimate for blocks of size 2^( 3) =       0.000532865894
  error estimate for blocks of size 2^( 4) =       0.000546988859
  error estimate for blocks of size 2^( 5) =       0.000557472634
  error estimate for blocks of size 2^( 6) =       0.000563530719
  error estimate for blocks of size 2^( 7) =       0.000566870427

      target function =      -0.646325059640
              le_mean =     -22.814920686586
             les_mean =     521.022047563089
             stat err =       0.000558715660
             autocorr =       1.290272887413
   target nu stat err =       0.000558715660
   target dn stat err =       0.003290703017
      target stat err =       0.001309848824
              std dev =       0.695608781744
             le_variance =       0.483871577239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483761152108
                                         uncertainty =       0.002090576361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483761152108
                                         uncertainty =       0.002090576361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491882176
  error estimate for blocks of size 2^( 2) =       0.000512975511
  error estimate for blocks of size 2^( 3) =       0.000532879435
  error estimate for blocks of size 2^( 4) =       0.000547002443
  error estimate for blocks of size 2^( 5) =       0.000557485888
  error estimate for blocks of size 2^( 6) =       0.000563544279
  error estimate for blocks of size 2^( 7) =       0.000566882448

      target function =      -0.646325045109
              le_mean =     -22.814920761683
             les_mean =     521.022051081119
             stat err =       0.000558728765
             autocorr =       1.290267888187
   target nu stat err =       0.000558728765
   target dn stat err =       0.003288891377
      target stat err =       0.001309176284
              std dev =       0.695626444951
             le_variance =       0.483896150915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483782756678
                                         uncertainty =       0.002090412602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483782756678
                                         uncertainty =       0.002090412602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491893151
  error estimate for blocks of size 2^( 2) =       0.000512986990
  error estimate for blocks of size 2^( 3) =       0.000532891339
  error estimate for blocks of size 2^( 4) =       0.000547014390
  error estimate for blocks of size 2^( 5) =       0.000557497572
  error estimate for blocks of size 2^( 6) =       0.000563556249
  error estimate for blocks of size 2^( 7) =       0.000566893142

      target function =      -0.634014657977
              le_mean =     -22.814920822883
             les_mean =     521.054052974851
             stat err =       0.000558740338
             autocorr =       1.290263766628
   target nu stat err =       0.000558740338
   target dn stat err =       0.032192539883
      target stat err =       0.011934611811
              std dev =       0.695641965060
             le_variance =       0.483917743552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.646314389569        initial
     2.5000e+01     2.5000e+02             4.0585e-05        -0.646325059640  <--
     1.0000e+02     1.0000e+03             1.0159e-05        -0.646325045109
     4.0000e+02     4.0000e+03             2.5407e-06        -0.634014657977

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 7.3227e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_01                 1.514892e-01 3 1  ON 0
ci_02                -4.712622e-02 3 1  ON 1
ci_03                -4.712718e-02 3 1  ON 2
ci_04                 4.496632e-02 3 1  ON 3
ci_05                -3.345945e-02 3 1  ON 4
ci_06                -3.374190e-02 3 1  ON 5
ci_07                 2.902580e-02 3 1  ON 6
ci_08                -1.383074e-02 3 1  ON 7
ci_09                -1.463670e-02 3 1  ON 8
ci_10                -1.480577e-02 3 1  ON 9
ci_11                 1.514966e-02 3 1  ON 10
ci_12                 1.148019e-02 3 1  ON 11
ci_13                 1.253028e-02 3 1  ON 12
ci_14                 1.305685e-02 3 1  ON 13
ci_15                 1.055551e-02 3 1  ON 14
ci_16                 1.051343e-02 3 1  ON 15
ci_17                -1.041413e-02 3 1  ON 16
ci_18                -1.043770e-02 3 1  ON 17
ci_19                 1.066602e-02 3 1  ON 18
ci_20                 9.491270e-03 3 1  ON 19
ci_21                 9.319696e-03 3 1  ON 20
ci_22                 9.589399e-03 3 1  ON 21
ci_23                 5.852760e-03 3 1  ON 22
ci_24                 5.087305e-03 3 1  ON 23
ci_25                 4.389501e-03 3 1  ON 24
ci_26                 3.993561e-03 3 1  ON 25
ci_27                 4.091632e-03 3 1  ON 26
ci_28                 3.557647e-03 3 1  ON 27
ci_29                 3.679966e-03 3 1  ON 28
ci_30                -2.938973e-03 3 1  ON 29
ci_31                -2.758337e-03 3 1  ON 30
ci_32                -2.288406e-03 3 1  ON 31
ci_33                -2.548674e-03 3 1  ON 32
ci_34                 1.877670e-03 3 1  ON 33
ci_35                 2.031928e-03 3 1  ON 34
ci_36                -1.900455e-03 3 1  ON 35
ci_37                -1.965186e-03 3 1  ON 36
ci_38                -1.422366e-03 3 1  ON 37
ci_39                -1.499780e-03 3 1  ON 38
ci_40                -1.866044e-03 3 1  ON 39
ci_41                -1.601285e-03 3 1  ON 40
ci_42                -1.451712e-03 3 1  ON 41
ci_43                -2.165632e-03 3 1  ON 42
ci_44                -1.953680e-03 3 1  ON 43
ci_45                -1.383826e-03 3 1  ON 44
ci_46                -1.330713e-03 3 1  ON 45
ci_47                -1.243173e-03 3 1  ON 46
ci_48                -1.074262e-03 3 1  ON 47
ci_49                -1.669880e-03 3 1  ON 48
ci_50                -1.349474e-03 3 1  ON 49
ci_51                 1.220943e-03 3 1  ON 50
ci_52                 1.215105e-03 3 1  ON 51
ci_53                -1.273705e-03 3 1  ON 52
ci_54                -1.160090e-03 3 1  ON 53
ci_55                -1.316132e-03 3 1  ON 54
ci_56                 1.610189e-03 3 1  ON 55
ci_57                 1.599125e-03 3 1  ON 56
ci_58                -1.141111e-03 3 1  ON 57
ci_59                -1.037114e-03 3 1  ON 58
ci_60                 7.715967e-04 3 1  ON 59
ci_61                 1.179218e-03 3 1  ON 60
ci_62                -9.486762e-04 3 1  ON 61
ci_63                -8.020008e-04 3 1  ON 62
ci_64                -8.706197e-04 3 1  ON 63
ci_65                -7.918187e-04 3 1  ON 64
ci_66                -8.260011e-04 3 1  ON 65
ci_67                -8.621146e-04 3 1  ON 66
ci_68                 2.133322e-04 3 1  ON 67
ci_69                 1.086567e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2357e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.864
    reference variance = 0.516708
====================================================
  Execution time = 4.4644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0243e-01
  Total weights = 1.963041526e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486663833273
                                         uncertainty =       0.002612718996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486663833273
                                         uncertainty =       0.002612718996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493307847
  error estimate for blocks of size 2^( 2) =       0.000514334169
  error estimate for blocks of size 2^( 3) =       0.000533737246
  error estimate for blocks of size 2^( 4) =       0.000549505049
  error estimate for blocks of size 2^( 5) =       0.000559753042
  error estimate for blocks of size 2^( 6) =       0.000564247908
  error estimate for blocks of size 2^( 7) =       0.000567104247

      target function =      -0.645916232925
              le_mean =     -22.814802720359
             les_mean =     521.017652939335
             stat err =       0.000560152562
             autocorr =       1.289367163285
   target nu stat err =       0.000560152562
   target dn stat err =       0.003562496883
      target stat err =       0.001409616178
              std dev =       0.697642647402
             le_variance =       0.486705263474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281480272036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645918882060       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645957790522       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645963637409       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645964406967       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645964613333       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645964669828       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645964685187       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645964684216       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645964684155       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645964684501       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.620612e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645918882060       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645928658006       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645930124185       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645930316673       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645930368132       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645930382171       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645930385984       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645930385742       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645930385726       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645930385812       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.072614e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645918882060       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645921329117       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645921695941       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645921744069       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645921756926       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645921760430       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645921761382       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645921761321       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645921761317       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645921761339       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.019480e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2339e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_01                 1.514505e-01 3 1  ON 0
ci_02                -4.708911e-02 3 1  ON 1
ci_03                -4.709115e-02 3 1  ON 2
ci_04                 4.492560e-02 3 1  ON 3
ci_05                -3.343527e-02 3 1  ON 4
ci_06                -3.372147e-02 3 1  ON 5
ci_07                 2.902011e-02 3 1  ON 6
ci_08                -1.381408e-02 3 1  ON 7
ci_09                -1.462592e-02 3 1  ON 8
ci_10                -1.479515e-02 3 1  ON 9
ci_11                 1.514538e-02 3 1  ON 10
ci_12                 1.147337e-02 3 1  ON 11
ci_13                 1.253067e-02 3 1  ON 12
ci_14                 1.305899e-02 3 1  ON 13
ci_15                 1.054935e-02 3 1  ON 14
ci_16                 1.050660e-02 3 1  ON 15
ci_17                -1.040965e-02 3 1  ON 16
ci_18                -1.043311e-02 3 1  ON 17
ci_19                 1.066238e-02 3 1  ON 18
ci_20                 9.488424e-03 3 1  ON 19
ci_21                 9.317039e-03 3 1  ON 20
ci_22                 9.587154e-03 3 1  ON 21
ci_23                 5.851755e-03 3 1  ON 22
ci_24                 5.085737e-03 3 1  ON 23
ci_25                 4.388262e-03 3 1  ON 24
ci_26                 3.989424e-03 3 1  ON 25
ci_27                 4.089286e-03 3 1  ON 26
ci_28                 3.555177e-03 3 1  ON 27
ci_29                 3.676799e-03 3 1  ON 28
ci_30                -2.937309e-03 3 1  ON 29
ci_31                -2.754449e-03 3 1  ON 30
ci_32                -2.280672e-03 3 1  ON 31
ci_33                -2.547750e-03 3 1  ON 32
ci_34                 1.875923e-03 3 1  ON 33
ci_35                 2.030988e-03 3 1  ON 34
ci_36                -1.898222e-03 3 1  ON 35
ci_37                -1.963681e-03 3 1  ON 36
ci_38                -1.419604e-03 3 1  ON 37
ci_39                -1.498386e-03 3 1  ON 38
ci_40                -1.865094e-03 3 1  ON 39
ci_41                -1.599563e-03 3 1  ON 40
ci_42                -1.450401e-03 3 1  ON 41
ci_43                -2.165269e-03 3 1  ON 42
ci_44                -1.953511e-03 3 1  ON 43
ci_45                -1.381581e-03 3 1  ON 44
ci_46                -1.329464e-03 3 1  ON 45
ci_47                -1.239843e-03 3 1  ON 46
ci_48                -1.072121e-03 3 1  ON 47
ci_49                -1.670059e-03 3 1  ON 48
ci_50                -1.347640e-03 3 1  ON 49
ci_51                 1.218576e-03 3 1  ON 50
ci_52                 1.213225e-03 3 1  ON 51
ci_53                -1.271196e-03 3 1  ON 52
ci_54                -1.159631e-03 3 1  ON 53
ci_55                -1.315478e-03 3 1  ON 54
ci_56                 1.609092e-03 3 1  ON 55
ci_57                 1.601838e-03 3 1  ON 56
ci_58                -1.143561e-03 3 1  ON 57
ci_59                -1.035178e-03 3 1  ON 58
ci_60                 7.692583e-04 3 1  ON 59
ci_61                 1.178503e-03 3 1  ON 60
ci_62                -9.481202e-04 3 1  ON 61
ci_63                -8.011380e-04 3 1  ON 62
ci_64                -8.680265e-04 3 1  ON 63
ci_65                -7.923912e-04 3 1  ON 64
ci_66                -8.251913e-04 3 1  ON 65
ci_67                -8.630897e-04 3 1  ON 66
ci_68                 2.126222e-04 3 1  ON 67
ci_69                 1.055116e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7791
    reference variance = 0.354093
====================================================
  Execution time = 4.1338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0401e-01
  Total weights = 1.9632e+06
  Execution time = 5.9622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489560056502
                                         uncertainty =       0.003614934027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489560056502
                                         uncertainty =       0.003614934027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494757078
  error estimate for blocks of size 2^( 2) =       0.000515851244
  error estimate for blocks of size 2^( 3) =       0.000535629232
  error estimate for blocks of size 2^( 4) =       0.000550316825
  error estimate for blocks of size 2^( 5) =       0.000559088133
  error estimate for blocks of size 2^( 6) =       0.000565623606
  error estimate for blocks of size 2^( 7) =       0.000567468924

      target function =      -0.645279176894
              le_mean =     -22.815276895659
             les_mean =     521.041237420249
             stat err =       0.000560624372
             autocorr =       1.283984899926
   target nu stat err =       0.000560624372
   target dn stat err =       0.004557018033
      target stat err =       0.001780791333
              std dev =       0.699692169330
             le_variance =       0.489569131821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489319875793
                                         uncertainty =       0.003590748541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489319875793
                                         uncertainty =       0.003590748541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494635743
  error estimate for blocks of size 2^( 2) =       0.000515727016
  error estimate for blocks of size 2^( 3) =       0.000535502221
  error estimate for blocks of size 2^( 4) =       0.000550191337
  error estimate for blocks of size 2^( 5) =       0.000558966148
  error estimate for blocks of size 2^( 6) =       0.000565501170
  error estimate for blocks of size 2^( 7) =       0.000567344239

      target function =      -0.644045047660
              le_mean =     -22.815277718260
             les_mean =     521.044488483085
             stat err =       0.000560500724
             autocorr =       1.284048309262
   target nu stat err =       0.000560500724
   target dn stat err =       0.005876797536
      target stat err =       0.002271800956
              std dev =       0.699520576329
             le_variance =       0.489329036708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489438877479
                                         uncertainty =       0.003602638559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489438877479
                                         uncertainty =       0.003602638559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494695864
  error estimate for blocks of size 2^( 2) =       0.000515788572
  error estimate for blocks of size 2^( 3) =       0.000535565176
  error estimate for blocks of size 2^( 4) =       0.000550253563
  error estimate for blocks of size 2^( 5) =       0.000559026675
  error estimate for blocks of size 2^( 6) =       0.000565561963
  error estimate for blocks of size 2^( 7) =       0.000567406036

      target function =      -0.645447247615
              le_mean =     -22.815277287379
             les_mean =     521.040817953371
             stat err =       0.000560562059
             autocorr =       1.284017198672
   target nu stat err =       0.000560562059
   target dn stat err =       0.004530233461
      target stat err =       0.001771592283
              std dev =       0.699605600520
             le_variance =       0.489447996278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489544834752
                                         uncertainty =       0.003613379647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489544834752
                                         uncertainty =       0.003613379647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494749389
  error estimate for blocks of size 2^( 2) =       0.000515843376
  error estimate for blocks of size 2^( 3) =       0.000535621181
  error estimate for blocks of size 2^( 4) =       0.000550308882
  error estimate for blocks of size 2^( 5) =       0.000559080417
  error estimate for blocks of size 2^( 6) =       0.000565615878
  error estimate for blocks of size 2^( 7) =       0.000567461035

      target function =      -0.645375273038
              le_mean =     -22.815276942596
             les_mean =     521.040989353937
             stat err =       0.000560616553
             autocorr =       1.283988992864
   target nu stat err =       0.000560616553
   target dn stat err =       0.004544554992
      target stat err =       0.001776610918
              std dev =       0.699681295709
             le_variance =       0.489553915565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.645279176894        initial
     6.2500e+00     6.2500e+01             1.6206e-04        -0.644045047660
     2.5000e+01     2.5000e+02             4.0726e-05        -0.645447247615  <--
     1.0000e+02     1.0000e+03             1.0195e-05        -0.645375273038

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 7.1236e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_01                 1.514505e-01 3 1  ON 0
ci_02                -4.708911e-02 3 1  ON 1
ci_03                -4.709115e-02 3 1  ON 2
ci_04                 4.492560e-02 3 1  ON 3
ci_05                -3.343527e-02 3 1  ON 4
ci_06                -3.372147e-02 3 1  ON 5
ci_07                 2.902011e-02 3 1  ON 6
ci_08                -1.381408e-02 3 1  ON 7
ci_09                -1.462592e-02 3 1  ON 8
ci_10                -1.479515e-02 3 1  ON 9
ci_11                 1.514538e-02 3 1  ON 10
ci_12                 1.147337e-02 3 1  ON 11
ci_13                 1.253067e-02 3 1  ON 12
ci_14                 1.305899e-02 3 1  ON 13
ci_15                 1.054935e-02 3 1  ON 14
ci_16                 1.050660e-02 3 1  ON 15
ci_17                -1.040965e-02 3 1  ON 16
ci_18                -1.043311e-02 3 1  ON 17
ci_19                 1.066238e-02 3 1  ON 18
ci_20                 9.488424e-03 3 1  ON 19
ci_21                 9.317039e-03 3 1  ON 20
ci_22                 9.587154e-03 3 1  ON 21
ci_23                 5.851755e-03 3 1  ON 22
ci_24                 5.085737e-03 3 1  ON 23
ci_25                 4.388262e-03 3 1  ON 24
ci_26                 3.989424e-03 3 1  ON 25
ci_27                 4.089286e-03 3 1  ON 26
ci_28                 3.555177e-03 3 1  ON 27
ci_29                 3.676799e-03 3 1  ON 28
ci_30                -2.937309e-03 3 1  ON 29
ci_31                -2.754449e-03 3 1  ON 30
ci_32                -2.280672e-03 3 1  ON 31
ci_33                -2.547750e-03 3 1  ON 32
ci_34                 1.875923e-03 3 1  ON 33
ci_35                 2.030988e-03 3 1  ON 34
ci_36                -1.898222e-03 3 1  ON 35
ci_37                -1.963681e-03 3 1  ON 36
ci_38                -1.419604e-03 3 1  ON 37
ci_39                -1.498386e-03 3 1  ON 38
ci_40                -1.865094e-03 3 1  ON 39
ci_41                -1.599563e-03 3 1  ON 40
ci_42                -1.450401e-03 3 1  ON 41
ci_43                -2.165269e-03 3 1  ON 42
ci_44                -1.953511e-03 3 1  ON 43
ci_45                -1.381581e-03 3 1  ON 44
ci_46                -1.329464e-03 3 1  ON 45
ci_47                -1.239843e-03 3 1  ON 46
ci_48                -1.072121e-03 3 1  ON 47
ci_49                -1.670059e-03 3 1  ON 48
ci_50                -1.347640e-03 3 1  ON 49
ci_51                 1.218576e-03 3 1  ON 50
ci_52                 1.213225e-03 3 1  ON 51
ci_53                -1.271196e-03 3 1  ON 52
ci_54                -1.159631e-03 3 1  ON 53
ci_55                -1.315478e-03 3 1  ON 54
ci_56                 1.609092e-03 3 1  ON 55
ci_57                 1.601838e-03 3 1  ON 56
ci_58                -1.143561e-03 3 1  ON 57
ci_59                -1.035178e-03 3 1  ON 58
ci_60                 7.692583e-04 3 1  ON 59
ci_61                 1.178503e-03 3 1  ON 60
ci_62                -9.481202e-04 3 1  ON 61
ci_63                -8.011380e-04 3 1  ON 62
ci_64                -8.680265e-04 3 1  ON 63
ci_65                -7.923912e-04 3 1  ON 64
ci_66                -8.251913e-04 3 1  ON 65
ci_67                -8.630897e-04 3 1  ON 66
ci_68                 2.126222e-04 3 1  ON 67
ci_69                 1.055116e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2358e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7912
    reference variance = 0.58341
====================================================
  Execution time = 4.2605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9733e-01
  Total weights = 1.963126162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481429459998
                                         uncertainty =       0.002453671497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481429459998
                                         uncertainty =       0.002453671497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490952887
  error estimate for blocks of size 2^( 2) =       0.000511905987
  error estimate for blocks of size 2^( 3) =       0.000531650315
  error estimate for blocks of size 2^( 4) =       0.000546525903
  error estimate for blocks of size 2^( 5) =       0.000557108697
  error estimate for blocks of size 2^( 6) =       0.000561951464
  error estimate for blocks of size 2^( 7) =       0.000562614127

      target function =      -0.647945427911
              le_mean =     -22.815058825897
             les_mean =     521.024238492567
             stat err =       0.000557050048
             autocorr =       1.287386037171
   target nu stat err =       0.000557050048
   target dn stat err =       0.003408574035
      target stat err =       0.001360308362
              std dev =       0.694312231582
             le_variance =       0.482069474925


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281505882590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647947875182       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647988788351       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647994440824       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647995155449       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647995328311       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647995392811       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647995402265       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647995400629       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647995401789       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647995401847       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.640493e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647947875182       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647958154920       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647959572446       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647959751229       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647959794334       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647959810363       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647959812700       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647959812290       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647959812579       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647959812593       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.122658e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647947875182       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647950448352       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647950803009       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647950847713       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647950858482       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647950862484       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647950863066       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647950862964       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647950863036       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647950863039       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.032012e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182759 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0292e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_01                 1.514143e-01 3 1  ON 0
ci_02                -4.705300e-02 3 1  ON 1
ci_03                -4.705081e-02 3 1  ON 2
ci_04                 4.488437e-02 3 1  ON 3
ci_05                -3.341194e-02 3 1  ON 4
ci_06                -3.370040e-02 3 1  ON 5
ci_07                 2.901519e-02 3 1  ON 6
ci_08                -1.379814e-02 3 1  ON 7
ci_09                -1.461664e-02 3 1  ON 8
ci_10                -1.478397e-02 3 1  ON 9
ci_11                 1.514164e-02 3 1  ON 10
ci_12                 1.146582e-02 3 1  ON 11
ci_13                 1.252884e-02 3 1  ON 12
ci_14                 1.305997e-02 3 1  ON 13
ci_15                 1.054245e-02 3 1  ON 14
ci_16                 1.049925e-02 3 1  ON 15
ci_17                -1.040830e-02 3 1  ON 16
ci_18                -1.042701e-02 3 1  ON 17
ci_19                 1.065877e-02 3 1  ON 18
ci_20                 9.482032e-03 3 1  ON 19
ci_21                 9.315267e-03 3 1  ON 20
ci_22                 9.585114e-03 3 1  ON 21
ci_23                 5.846827e-03 3 1  ON 22
ci_24                 5.086659e-03 3 1  ON 23
ci_25                 4.384467e-03 3 1  ON 24
ci_26                 3.988777e-03 3 1  ON 25
ci_27                 4.086460e-03 3 1  ON 26
ci_28                 3.551452e-03 3 1  ON 27
ci_29                 3.675200e-03 3 1  ON 28
ci_30                -2.935913e-03 3 1  ON 29
ci_31                -2.751610e-03 3 1  ON 30
ci_32                -2.279022e-03 3 1  ON 31
ci_33                -2.543585e-03 3 1  ON 32
ci_34                 1.874665e-03 3 1  ON 33
ci_35                 2.027943e-03 3 1  ON 34
ci_36                -1.897658e-03 3 1  ON 35
ci_37                -1.963669e-03 3 1  ON 36
ci_38                -1.418440e-03 3 1  ON 37
ci_39                -1.497658e-03 3 1  ON 38
ci_40                -1.863808e-03 3 1  ON 39
ci_41                -1.596406e-03 3 1  ON 40
ci_42                -1.447324e-03 3 1  ON 41
ci_43                -2.165924e-03 3 1  ON 42
ci_44                -1.954948e-03 3 1  ON 43
ci_45                -1.378431e-03 3 1  ON 44
ci_46                -1.328008e-03 3 1  ON 45
ci_47                -1.236038e-03 3 1  ON 46
ci_48                -1.070778e-03 3 1  ON 47
ci_49                -1.665534e-03 3 1  ON 48
ci_50                -1.346915e-03 3 1  ON 49
ci_51                 1.217748e-03 3 1  ON 50
ci_52                 1.211371e-03 3 1  ON 51
ci_53                -1.270286e-03 3 1  ON 52
ci_54                -1.158488e-03 3 1  ON 53
ci_55                -1.316125e-03 3 1  ON 54
ci_56                 1.610835e-03 3 1  ON 55
ci_57                 1.602970e-03 3 1  ON 56
ci_58                -1.142599e-03 3 1  ON 57
ci_59                -1.033024e-03 3 1  ON 58
ci_60                 7.703174e-04 3 1  ON 59
ci_61                 1.176313e-03 3 1  ON 60
ci_62                -9.481196e-04 3 1  ON 61
ci_63                -7.998454e-04 3 1  ON 62
ci_64                -8.654015e-04 3 1  ON 63
ci_65                -7.957377e-04 3 1  ON 64
ci_66                -8.249953e-04 3 1  ON 65
ci_67                -8.630206e-04 3 1  ON 66
ci_68                 2.098339e-04 3 1  ON 67
ci_69                 1.016733e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7328
    reference variance = 0.282939
====================================================
  Execution time = 4.1439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.1024e-01
  Total weights = 1.9632e+06
  Execution time = 5.9982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491993979946
                                         uncertainty =       0.004385684025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491993979946
                                         uncertainty =       0.004385684025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496021472
  error estimate for blocks of size 2^( 2) =       0.000516814387
  error estimate for blocks of size 2^( 3) =       0.000536590786
  error estimate for blocks of size 2^( 4) =       0.000551445938
  error estimate for blocks of size 2^( 5) =       0.000561488546
  error estimate for blocks of size 2^( 6) =       0.000565499820
  error estimate for blocks of size 2^( 7) =       0.000570093573

      target function =      -0.642937776224
              le_mean =     -22.814938432560
             les_mean =     521.031701457940
             stat err =       0.000562131969
             autocorr =       1.284327009826
   target nu stat err =       0.000562131969
   target dn stat err =       0.005501353849
      target stat err =       0.002122140165
              std dev =       0.701480293236
             le_variance =       0.492074601799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491772703076
                                         uncertainty =       0.004379570739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491772703076
                                         uncertainty =       0.004379570739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495909700
  error estimate for blocks of size 2^( 2) =       0.000516699617
  error estimate for blocks of size 2^( 3) =       0.000536474786
  error estimate for blocks of size 2^( 4) =       0.000551329722
  error estimate for blocks of size 2^( 5) =       0.000561374612
  error estimate for blocks of size 2^( 6) =       0.000565387183
  error estimate for blocks of size 2^( 7) =       0.000569982526

      target function =      -0.642991151594
              le_mean =     -22.814938804378
             les_mean =     521.031578597104
             stat err =       0.000562018511
             autocorr =       1.284387388822
   target nu stat err =       0.000562018511
   target dn stat err =       0.005495408037
      target stat err =       0.002120240877
              std dev =       0.701322224132
             le_variance =       0.491852862062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491882408916
                                         uncertainty =       0.004382594060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491882408916
                                         uncertainty =       0.004382594060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495965119
  error estimate for blocks of size 2^( 2) =       0.000516756516
  error estimate for blocks of size 2^( 3) =       0.000536532290
  error estimate for blocks of size 2^( 4) =       0.000551387330
  error estimate for blocks of size 2^( 5) =       0.000561431085
  error estimate for blocks of size 2^( 6) =       0.000565443002
  error estimate for blocks of size 2^( 7) =       0.000570037559

      target function =      -0.642972273516
              le_mean =     -22.814938566180
             les_mean =     521.031617110094
             stat err =       0.000562074744
             autocorr =       1.284357349574
   target nu stat err =       0.000562074744
   target dn stat err =       0.005498153908
      target stat err =       0.002121155921
              std dev =       0.701400597321
             le_variance =       0.491962797922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491979972488
                                         uncertainty =       0.004385295175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491979972488
                                         uncertainty =       0.004385295175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496014398
  error estimate for blocks of size 2^( 2) =       0.000516807121
  error estimate for blocks of size 2^( 3) =       0.000536583441
  error estimate for blocks of size 2^( 4) =       0.000551438579
  error estimate for blocks of size 2^( 5) =       0.000561481330
  error estimate for blocks of size 2^( 6) =       0.000565492684
  error estimate for blocks of size 2^( 7) =       0.000570086539

      target function =      -0.642942492547
              le_mean =     -22.814938443233
             les_mean =     521.031689574307
             stat err =       0.000562124783
             autocorr =       1.284330808310
   target nu stat err =       0.000562124783
   target dn stat err =       0.005500941185
      target stat err =       0.002122015000
              std dev =       0.701470288174
             le_variance =       0.492060565191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.642937776224        initial
     6.2500e+00     6.2500e+01             1.6405e-04        -0.642991151594  <--
     2.5000e+01     2.5000e+02             4.1227e-05        -0.642972273516
     1.0000e+02     1.0000e+03             1.0320e-05        -0.642942492547

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.1547e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_01                 1.513064e-01 3 1  ON 0
ci_02                -4.694533e-02 3 1  ON 1
ci_03                -4.693054e-02 3 1  ON 2
ci_04                 4.476155e-02 3 1  ON 3
ci_05                -3.334240e-02 3 1  ON 4
ci_06                -3.363759e-02 3 1  ON 5
ci_07                 2.900050e-02 3 1  ON 6
ci_08                -1.375066e-02 3 1  ON 7
ci_09                -1.458894e-02 3 1  ON 8
ci_10                -1.475061e-02 3 1  ON 9
ci_11                 1.513049e-02 3 1  ON 10
ci_12                 1.144329e-02 3 1  ON 11
ci_13                 1.252338e-02 3 1  ON 12
ci_14                 1.306292e-02 3 1  ON 13
ci_15                 1.052186e-02 3 1  ON 14
ci_16                 1.047733e-02 3 1  ON 15
ci_17                -1.040426e-02 3 1  ON 16
ci_18                -1.040881e-02 3 1  ON 17
ci_19                 1.064805e-02 3 1  ON 18
ci_20                 9.462987e-03 3 1  ON 19
ci_21                 9.309975e-03 3 1  ON 20
ci_22                 9.579020e-03 3 1  ON 21
ci_23                 5.832152e-03 3 1  ON 22
ci_24                 5.089419e-03 3 1  ON 23
ci_25                 4.373158e-03 3 1  ON 24
ci_26                 3.986852e-03 3 1  ON 25
ci_27                 4.078038e-03 3 1  ON 26
ci_28                 3.540336e-03 3 1  ON 27
ci_29                 3.670422e-03 3 1  ON 28
ci_30                -2.931745e-03 3 1  ON 29
ci_31                -2.743127e-03 3 1  ON 30
ci_32                -2.274121e-03 3 1  ON 31
ci_33                -2.531194e-03 3 1  ON 32
ci_34                 1.870933e-03 3 1  ON 33
ci_35                 2.018885e-03 3 1  ON 34
ci_36                -1.895972e-03 3 1  ON 35
ci_37                -1.963628e-03 3 1  ON 36
ci_38                -1.414968e-03 3 1  ON 37
ci_39                -1.495487e-03 3 1  ON 38
ci_40                -1.859972e-03 3 1  ON 39
ci_41                -1.587013e-03 3 1  ON 40
ci_42                -1.438171e-03 3 1  ON 41
ci_43                -2.167859e-03 3 1  ON 42
ci_44                -1.959222e-03 3 1  ON 43
ci_45                -1.369041e-03 3 1  ON 44
ci_46                -1.323667e-03 3 1  ON 45
ci_47                -1.224672e-03 3 1  ON 46
ci_48                -1.066762e-03 3 1  ON 47
ci_49                -1.652061e-03 3 1  ON 48
ci_50                -1.344756e-03 3 1  ON 49
ci_51                 1.215277e-03 3 1  ON 50
ci_52                 1.205846e-03 3 1  ON 51
ci_53                -1.267574e-03 3 1  ON 52
ci_54                -1.155077e-03 3 1  ON 53
ci_55                -1.318056e-03 3 1  ON 54
ci_56                 1.616029e-03 3 1  ON 55
ci_57                 1.606349e-03 3 1  ON 56
ci_58                -1.139730e-03 3 1  ON 57
ci_59                -1.026606e-03 3 1  ON 58
ci_60                 7.734826e-04 3 1  ON 59
ci_61                 1.169756e-03 3 1  ON 60
ci_62                -9.481125e-04 3 1  ON 61
ci_63                -7.959938e-04 3 1  ON 62
ci_64                -8.575830e-04 3 1  ON 63
ci_65                -8.056939e-04 3 1  ON 64
ci_66                -8.244115e-04 3 1  ON 65
ci_67                -8.628116e-04 3 1  ON 66
ci_68                 2.015166e-04 3 1  ON 67
ci_69                 9.023230e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2185e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2802e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8411
    reference variance = 0.280922
====================================================
  Execution time = 4.3969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0036e-01
  Total weights = 1.963258767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487466094923
                                         uncertainty =       0.002432753621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487466094923
                                         uncertainty =       0.002432753621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493670929
  error estimate for blocks of size 2^( 2) =       0.000514388993
  error estimate for blocks of size 2^( 3) =       0.000533672357
  error estimate for blocks of size 2^( 4) =       0.000548548683
  error estimate for blocks of size 2^( 5) =       0.000557656455
  error estimate for blocks of size 2^( 6) =       0.000563455281
  error estimate for blocks of size 2^( 7) =       0.000562117014

      target function =      -0.647069311800
              le_mean =     -22.816283379643
             les_mean =     521.083148783009
             stat err =       0.000557944358
             autocorr =       1.277340476867
   target nu stat err =       0.000557944358
   target dn stat err =       0.002901259580
      target stat err =       0.001169374872
              std dev =       0.698156122546
             le_variance =       0.487421971448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281628337964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647071005588       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647220893197       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647245177261       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647248786885       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647249638058       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647249891315       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647249980419       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647249968870       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647249970128       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647249968653       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.362540e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647071005588       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647109229612       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647115377752       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647116283576       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647116493737       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647116555047       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647116576755       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647116573889       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647116574195       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647116573836       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.609763e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647071005588       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647080609771       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647082151680       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647082378339       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647082430707       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647082445907       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647082451298       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647082450583       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647082450659       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647082450570       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.036550e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1678e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_01                 1.511454e-01 3 1  ON 0
ci_02                -4.679916e-02 3 1  ON 1
ci_03                -4.679903e-02 3 1  ON 2
ci_04                 4.460167e-02 3 1  ON 3
ci_05                -3.325163e-02 3 1  ON 4
ci_06                -3.353419e-02 3 1  ON 5
ci_07                 2.898386e-02 3 1  ON 6
ci_08                -1.368120e-02 3 1  ON 7
ci_09                -1.455763e-02 3 1  ON 8
ci_10                -1.470418e-02 3 1  ON 9
ci_11                 1.511363e-02 3 1  ON 10
ci_12                 1.141314e-02 3 1  ON 11
ci_13                 1.252252e-02 3 1  ON 12
ci_14                 1.306652e-02 3 1  ON 13
ci_15                 1.049274e-02 3 1  ON 14
ci_16                 1.045089e-02 3 1  ON 15
ci_17                -1.038485e-02 3 1  ON 16
ci_18                -1.040060e-02 3 1  ON 17
ci_19                 1.063568e-02 3 1  ON 18
ci_20                 9.444671e-03 3 1  ON 19
ci_21                 9.306167e-03 3 1  ON 20
ci_22                 9.572508e-03 3 1  ON 21
ci_23                 5.821295e-03 3 1  ON 22
ci_24                 5.087344e-03 3 1  ON 23
ci_25                 4.364094e-03 3 1  ON 24
ci_26                 3.979041e-03 3 1  ON 25
ci_27                 4.065547e-03 3 1  ON 26
ci_28                 3.528473e-03 3 1  ON 27
ci_29                 3.661101e-03 3 1  ON 28
ci_30                -2.925667e-03 3 1  ON 29
ci_31                -2.733622e-03 3 1  ON 30
ci_32                -2.261024e-03 3 1  ON 31
ci_33                -2.514818e-03 3 1  ON 32
ci_34                 1.858854e-03 3 1  ON 33
ci_35                 2.003804e-03 3 1  ON 34
ci_36                -1.897271e-03 3 1  ON 35
ci_37                -1.956434e-03 3 1  ON 36
ci_38                -1.407068e-03 3 1  ON 37
ci_39                -1.488140e-03 3 1  ON 38
ci_40                -1.862038e-03 3 1  ON 39
ci_41                -1.576838e-03 3 1  ON 40
ci_42                -1.428432e-03 3 1  ON 41
ci_43                -2.162390e-03 3 1  ON 42
ci_44                -1.954617e-03 3 1  ON 43
ci_45                -1.364820e-03 3 1  ON 44
ci_46                -1.317058e-03 3 1  ON 45
ci_47                -1.214955e-03 3 1  ON 46
ci_48                -1.058543e-03 3 1  ON 47
ci_49                -1.645010e-03 3 1  ON 48
ci_50                -1.334433e-03 3 1  ON 49
ci_51                 1.215433e-03 3 1  ON 50
ci_52                 1.197334e-03 3 1  ON 51
ci_53                -1.272508e-03 3 1  ON 52
ci_54                -1.154604e-03 3 1  ON 53
ci_55                -1.313539e-03 3 1  ON 54
ci_56                 1.614090e-03 3 1  ON 55
ci_57                 1.601317e-03 3 1  ON 56
ci_58                -1.136589e-03 3 1  ON 57
ci_59                -1.029211e-03 3 1  ON 58
ci_60                 7.742332e-04 3 1  ON 59
ci_61                 1.160426e-03 3 1  ON 60
ci_62                -9.497408e-04 3 1  ON 61
ci_63                -7.848872e-04 3 1  ON 62
ci_64                -8.559646e-04 3 1  ON 63
ci_65                -7.972011e-04 3 1  ON 64
ci_66                -8.257058e-04 3 1  ON 65
ci_67                -8.650253e-04 3 1  ON 66
ci_68                 1.956091e-04 3 1  ON 67
ci_69                 8.097888e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.759
    reference variance = 0.393951
====================================================
  Execution time = 4.3006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0264e-01
  Total weights = 1.9631e+06
  Execution time = 5.9503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484658972160
                                         uncertainty =       0.002286646379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484658972160
                                         uncertainty =       0.002286646379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492268392
  error estimate for blocks of size 2^( 2) =       0.000513188734
  error estimate for blocks of size 2^( 3) =       0.000532991570
  error estimate for blocks of size 2^( 4) =       0.000546952677
  error estimate for blocks of size 2^( 5) =       0.000556114332
  error estimate for blocks of size 2^( 6) =       0.000561418968
  error estimate for blocks of size 2^( 7) =       0.000564326459

      target function =      -0.645691358315
              le_mean =     -22.814920335438
             les_mean =     521.023678163447
             stat err =       0.000557203109
             autocorr =       1.281218381038
   target nu stat err =       0.000557203109
   target dn stat err =       0.003504454315
      target stat err =       0.001386735690
              std dev =       0.696172635601
             le_variance =       0.484656338559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483893980362
                                         uncertainty =       0.002285339832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483893980362
                                         uncertainty =       0.002285339832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491879406
  error estimate for blocks of size 2^( 2) =       0.000512786980
  error estimate for blocks of size 2^( 3) =       0.000532584894
  error estimate for blocks of size 2^( 4) =       0.000546547851
  error estimate for blocks of size 2^( 5) =       0.000555704717
  error estimate for blocks of size 2^( 6) =       0.000560999215
  error estimate for blocks of size 2^( 7) =       0.000563900747

      target function =      -0.644110204815
              le_mean =     -22.814920763810
             les_mean =     521.027814153032
             stat err =       0.000556788133
             autocorr =       1.281334917223
   target nu stat err =       0.000556788133
   target dn stat err =       0.005258808561
      target stat err =       0.002037697247
              std dev =       0.695622526645
             le_variance =       0.483890699577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484262655254
                                         uncertainty =       0.002285682607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484262655254
                                         uncertainty =       0.002285682607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492066914
  error estimate for blocks of size 2^( 2) =       0.000512980792
  error estimate for blocks of size 2^( 3) =       0.000532781031
  error estimate for blocks of size 2^( 4) =       0.000546742834
  error estimate for blocks of size 2^( 5) =       0.000555902464
  error estimate for blocks of size 2^( 6) =       0.000561201270
  error estimate for blocks of size 2^( 7) =       0.000564107114

      target function =      -0.645913180113
              le_mean =     -22.814919533058
             les_mean =     521.023063766334
             stat err =       0.000556988421
             autocorr =       1.281279874207
   target nu stat err =       0.000556988421
   target dn stat err =       0.003544166946
      target stat err =       0.001402461667
              std dev =       0.695887703084
             le_variance =       0.484259695304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484608464600
                                         uncertainty =       0.002286493891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484608464600
                                         uncertainty =       0.002286493891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492242720
  error estimate for blocks of size 2^( 2) =       0.000513162243
  error estimate for blocks of size 2^( 3) =       0.000532964740
  error estimate for blocks of size 2^( 4) =       0.000546925904
  error estimate for blocks of size 2^( 5) =       0.000556087272
  error estimate for blocks of size 2^( 6) =       0.000561391197
  error estimate for blocks of size 2^( 7) =       0.000564298376

      target function =      -0.645797394184
              le_mean =     -22.814920113688
             les_mean =     521.023391991500
             stat err =       0.000557175687
             autocorr =       1.281225905916
   target nu stat err =       0.000557175687
   target dn stat err =       0.003502005960
      target stat err =       0.001386260241
              std dev =       0.696136330266
             le_variance =       0.484605790317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.645691358315        initial
     1.5625e+00     1.5625e+01             6.3625e-04        -0.644110204815
     6.2500e+00     6.2500e+01             1.6098e-04        -0.645913180113  <--
     2.5000e+01     2.5000e+02             4.0366e-05        -0.645797394184

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.2871e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_01                 1.511454e-01 3 1  ON 0
ci_02                -4.679916e-02 3 1  ON 1
ci_03                -4.679903e-02 3 1  ON 2
ci_04                 4.460167e-02 3 1  ON 3
ci_05                -3.325163e-02 3 1  ON 4
ci_06                -3.353419e-02 3 1  ON 5
ci_07                 2.898386e-02 3 1  ON 6
ci_08                -1.368120e-02 3 1  ON 7
ci_09                -1.455763e-02 3 1  ON 8
ci_10                -1.470418e-02 3 1  ON 9
ci_11                 1.511363e-02 3 1  ON 10
ci_12                 1.141314e-02 3 1  ON 11
ci_13                 1.252252e-02 3 1  ON 12
ci_14                 1.306652e-02 3 1  ON 13
ci_15                 1.049274e-02 3 1  ON 14
ci_16                 1.045089e-02 3 1  ON 15
ci_17                -1.038485e-02 3 1  ON 16
ci_18                -1.040060e-02 3 1  ON 17
ci_19                 1.063568e-02 3 1  ON 18
ci_20                 9.444671e-03 3 1  ON 19
ci_21                 9.306167e-03 3 1  ON 20
ci_22                 9.572508e-03 3 1  ON 21
ci_23                 5.821295e-03 3 1  ON 22
ci_24                 5.087344e-03 3 1  ON 23
ci_25                 4.364094e-03 3 1  ON 24
ci_26                 3.979041e-03 3 1  ON 25
ci_27                 4.065547e-03 3 1  ON 26
ci_28                 3.528473e-03 3 1  ON 27
ci_29                 3.661101e-03 3 1  ON 28
ci_30                -2.925667e-03 3 1  ON 29
ci_31                -2.733622e-03 3 1  ON 30
ci_32                -2.261024e-03 3 1  ON 31
ci_33                -2.514818e-03 3 1  ON 32
ci_34                 1.858854e-03 3 1  ON 33
ci_35                 2.003804e-03 3 1  ON 34
ci_36                -1.897271e-03 3 1  ON 35
ci_37                -1.956434e-03 3 1  ON 36
ci_38                -1.407068e-03 3 1  ON 37
ci_39                -1.488140e-03 3 1  ON 38
ci_40                -1.862038e-03 3 1  ON 39
ci_41                -1.576838e-03 3 1  ON 40
ci_42                -1.428432e-03 3 1  ON 41
ci_43                -2.162390e-03 3 1  ON 42
ci_44                -1.954617e-03 3 1  ON 43
ci_45                -1.364820e-03 3 1  ON 44
ci_46                -1.317058e-03 3 1  ON 45
ci_47                -1.214955e-03 3 1  ON 46
ci_48                -1.058543e-03 3 1  ON 47
ci_49                -1.645010e-03 3 1  ON 48
ci_50                -1.334433e-03 3 1  ON 49
ci_51                 1.215433e-03 3 1  ON 50
ci_52                 1.197334e-03 3 1  ON 51
ci_53                -1.272508e-03 3 1  ON 52
ci_54                -1.154604e-03 3 1  ON 53
ci_55                -1.313539e-03 3 1  ON 54
ci_56                 1.614090e-03 3 1  ON 55
ci_57                 1.601317e-03 3 1  ON 56
ci_58                -1.136589e-03 3 1  ON 57
ci_59                -1.029211e-03 3 1  ON 58
ci_60                 7.742332e-04 3 1  ON 59
ci_61                 1.160426e-03 3 1  ON 60
ci_62                -9.497408e-04 3 1  ON 61
ci_63                -7.848872e-04 3 1  ON 62
ci_64                -8.559646e-04 3 1  ON 63
ci_65                -7.972011e-04 3 1  ON 64
ci_66                -8.257058e-04 3 1  ON 65
ci_67                -8.650253e-04 3 1  ON 66
ci_68                 1.956091e-04 3 1  ON 67
ci_69                 8.097888e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2456e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2802e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8186
    reference variance = 0.262925
====================================================
  Execution time = 4.2553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9397e-01
  Total weights = 1.963198426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479261273015
                                         uncertainty =       0.002027879896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479261273015
                                         uncertainty =       0.002027879896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489467915
  error estimate for blocks of size 2^( 2) =       0.000510195076
  error estimate for blocks of size 2^( 3) =       0.000529236634
  error estimate for blocks of size 2^( 4) =       0.000544428517
  error estimate for blocks of size 2^( 5) =       0.000554312341
  error estimate for blocks of size 2^( 6) =       0.000558459468
  error estimate for blocks of size 2^( 7) =       0.000564256532

      target function =      -0.649439276729
              le_mean =     -22.815836844597
             les_mean =     521.056379446913
             stat err =       0.000555364214
             autocorr =       1.287381683102
   target nu stat err =       0.000555364214
   target dn stat err =       0.003119006524
      target stat err =       0.001258167916
              std dev =       0.692212164346
             le_variance =       0.479157680468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281583684460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649441270849       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649586121729       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649607852484       residual = 9.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649611297467       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649612718240       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649613366059       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649613525372       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649613512237       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649613515558       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649613518940       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.118668e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649441270849       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649478213666       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649483716882       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649484583053       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649484936945       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649485096822       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649485135329       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649485131905       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649485132717       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649485133538       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.548585e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649441270849       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649450553325       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649451933589       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649452150433       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649452238815       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649452278650       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649452288193       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649452287328       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649452287530       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649452287733       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 3.883477e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0245e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_01                 1.509906e-01 3 1  ON 0
ci_02                -4.665788e-02 3 1  ON 1
ci_03                -4.665742e-02 3 1  ON 2
ci_04                 4.444728e-02 3 1  ON 3
ci_05                -3.315938e-02 3 1  ON 4
ci_06                -3.345337e-02 3 1  ON 5
ci_07                 2.896547e-02 3 1  ON 6
ci_08                -1.361400e-02 3 1  ON 7
ci_09                -1.451815e-02 3 1  ON 8
ci_10                -1.467488e-02 3 1  ON 9
ci_11                 1.510108e-02 3 1  ON 10
ci_12                 1.138097e-02 3 1  ON 11
ci_13                 1.251332e-02 3 1  ON 12
ci_14                 1.306343e-02 3 1  ON 13
ci_15                 1.046979e-02 3 1  ON 14
ci_16                 1.042539e-02 3 1  ON 15
ci_17                -1.035745e-02 3 1  ON 16
ci_18                -1.038216e-02 3 1  ON 17
ci_19                 1.062087e-02 3 1  ON 18
ci_20                 9.429660e-03 3 1  ON 19
ci_21                 9.300959e-03 3 1  ON 20
ci_22                 9.568933e-03 3 1  ON 21
ci_23                 5.812548e-03 3 1  ON 22
ci_24                 5.081460e-03 3 1  ON 23
ci_25                 4.355839e-03 3 1  ON 24
ci_26                 3.967252e-03 3 1  ON 25
ci_27                 4.060381e-03 3 1  ON 26
ci_28                 3.516332e-03 3 1  ON 27
ci_29                 3.658883e-03 3 1  ON 28
ci_30                -2.919918e-03 3 1  ON 29
ci_31                -2.722097e-03 3 1  ON 30
ci_32                -2.251474e-03 3 1  ON 31
ci_33                -2.500519e-03 3 1  ON 32
ci_34                 1.848674e-03 3 1  ON 33
ci_35                 1.986210e-03 3 1  ON 34
ci_36                -1.888622e-03 3 1  ON 35
ci_37                -1.952204e-03 3 1  ON 36
ci_38                -1.403247e-03 3 1  ON 37
ci_39                -1.476574e-03 3 1  ON 38
ci_40                -1.850224e-03 3 1  ON 39
ci_41                -1.564252e-03 3 1  ON 40
ci_42                -1.412229e-03 3 1  ON 41
ci_43                -2.157763e-03 3 1  ON 42
ci_44                -1.955109e-03 3 1  ON 43
ci_45                -1.363797e-03 3 1  ON 44
ci_46                -1.312795e-03 3 1  ON 45
ci_47                -1.211000e-03 3 1  ON 46
ci_48                -1.046675e-03 3 1  ON 47
ci_49                -1.639010e-03 3 1  ON 48
ci_50                -1.325331e-03 3 1  ON 49
ci_51                 1.212056e-03 3 1  ON 50
ci_52                 1.194389e-03 3 1  ON 51
ci_53                -1.273876e-03 3 1  ON 52
ci_54                -1.148446e-03 3 1  ON 53
ci_55                -1.309419e-03 3 1  ON 54
ci_56                 1.615423e-03 3 1  ON 55
ci_57                 1.600226e-03 3 1  ON 56
ci_58                -1.133795e-03 3 1  ON 57
ci_59                -1.027218e-03 3 1  ON 58
ci_60                 7.668782e-04 3 1  ON 59
ci_61                 1.153411e-03 3 1  ON 60
ci_62                -9.499886e-04 3 1  ON 61
ci_63                -7.855206e-04 3 1  ON 62
ci_64                -8.488000e-04 3 1  ON 63
ci_65                -7.978031e-04 3 1  ON 64
ci_66                -8.276133e-04 3 1  ON 65
ci_67                -8.621862e-04 3 1  ON 66
ci_68                 1.913097e-04 3 1  ON 67
ci_69                 7.144136e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7046
    reference variance = 1.5696
====================================================
  Execution time = 4.1346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.0078e-01
  Total weights = 1.9631e+06
  Execution time = 5.9006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486451037435
                                         uncertainty =       0.002979421139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486451037435
                                         uncertainty =       0.002979421139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493199853
  error estimate for blocks of size 2^( 2) =       0.000514069178
  error estimate for blocks of size 2^( 3) =       0.000533595219
  error estimate for blocks of size 2^( 4) =       0.000549403160
  error estimate for blocks of size 2^( 5) =       0.000559310523
  error estimate for blocks of size 2^( 6) =       0.000563845875
  error estimate for blocks of size 2^( 7) =       0.000569571432

      target function =      -0.646239705830
              le_mean =     -22.813937142417
             les_mean =     520.976776529774
             stat err =       0.000560532748
             autocorr =       1.291683475948
   target nu stat err =       0.000560532748
   target dn stat err =       0.003592466947
      target stat err =       0.001421118030
              std dev =       0.697489920643
             le_variance =       0.486492189399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485654092251
                                         uncertainty =       0.002957962020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485654092251
                                         uncertainty =       0.002957962020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492794325
  error estimate for blocks of size 2^( 2) =       0.000513656316
  error estimate for blocks of size 2^( 3) =       0.000533175344
  error estimate for blocks of size 2^( 4) =       0.000548976569
  error estimate for blocks of size 2^( 5) =       0.000558891554
  error estimate for blocks of size 2^( 6) =       0.000563426577
  error estimate for blocks of size 2^( 7) =       0.000569148211

      target function =      -0.645965556963
              le_mean =     -22.813939462834
             les_mean =     520.977596629793
             stat err =       0.000560110728
             autocorr =       1.291862777497
   target nu stat err =       0.000560110728
   target dn stat err =       0.003700834688
      target stat err =       0.001460396465
              std dev =       0.696916418491
             le_variance =       0.485692494363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486039136293
                                         uncertainty =       0.002968218303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486039136293
                                         uncertainty =       0.002968218303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492990299
  error estimate for blocks of size 2^( 2) =       0.000513855731
  error estimate for blocks of size 2^( 3) =       0.000533378249
  error estimate for blocks of size 2^( 4) =       0.000549182561
  error estimate for blocks of size 2^( 5) =       0.000559093627
  error estimate for blocks of size 2^( 6) =       0.000563628818
  error estimate for blocks of size 2^( 7) =       0.000569352467

      target function =      -0.646416640079
              le_mean =     -22.813937469172
             les_mean =     520.976331651711
             stat err =       0.000560314368
             autocorr =       1.291774692230
   target nu stat err =       0.000560314368
   target dn stat err =       0.003589639554
      target stat err =       0.001420787352
              std dev =       0.697193567241
             le_variance =       0.486078870202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486398644371
                                         uncertainty =       0.002977984343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486398644371
                                         uncertainty =       0.002977984343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493173203
  error estimate for blocks of size 2^( 2) =       0.000514042028
  error estimate for blocks of size 2^( 3) =       0.000533567625
  error estimate for blocks of size 2^( 4) =       0.000549375107
  error estimate for blocks of size 2^( 5) =       0.000559282919
  error estimate for blocks of size 2^( 6) =       0.000563818235
  error estimate for blocks of size 2^( 7) =       0.000569543583

      target function =      -0.646250700215
              le_mean =     -22.813937101422
             les_mean =     520.976746042578
             stat err =       0.000560504961
             autocorr =       1.291695006900
   target nu stat err =       0.000560504961
   target dn stat err =       0.003592444487
      target stat err =       0.001421152723
              std dev =       0.697452232047
             le_variance =       0.486439615988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.646239705830        initial
     1.5625e+00     1.5625e+01             6.1187e-04        -0.645965556963
     6.2500e+00     6.2500e+01             1.5486e-04        -0.646416640079  <--
     2.5000e+01     2.5000e+02             3.8835e-05        -0.646250700215

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.0908e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_01                 1.509906e-01 3 1  ON 0
ci_02                -4.665788e-02 3 1  ON 1
ci_03                -4.665742e-02 3 1  ON 2
ci_04                 4.444728e-02 3 1  ON 3
ci_05                -3.315938e-02 3 1  ON 4
ci_06                -3.345337e-02 3 1  ON 5
ci_07                 2.896547e-02 3 1  ON 6
ci_08                -1.361400e-02 3 1  ON 7
ci_09                -1.451815e-02 3 1  ON 8
ci_10                -1.467488e-02 3 1  ON 9
ci_11                 1.510108e-02 3 1  ON 10
ci_12                 1.138097e-02 3 1  ON 11
ci_13                 1.251332e-02 3 1  ON 12
ci_14                 1.306343e-02 3 1  ON 13
ci_15                 1.046979e-02 3 1  ON 14
ci_16                 1.042539e-02 3 1  ON 15
ci_17                -1.035745e-02 3 1  ON 16
ci_18                -1.038216e-02 3 1  ON 17
ci_19                 1.062087e-02 3 1  ON 18
ci_20                 9.429660e-03 3 1  ON 19
ci_21                 9.300959e-03 3 1  ON 20
ci_22                 9.568933e-03 3 1  ON 21
ci_23                 5.812548e-03 3 1  ON 22
ci_24                 5.081460e-03 3 1  ON 23
ci_25                 4.355839e-03 3 1  ON 24
ci_26                 3.967252e-03 3 1  ON 25
ci_27                 4.060381e-03 3 1  ON 26
ci_28                 3.516332e-03 3 1  ON 27
ci_29                 3.658883e-03 3 1  ON 28
ci_30                -2.919918e-03 3 1  ON 29
ci_31                -2.722097e-03 3 1  ON 30
ci_32                -2.251474e-03 3 1  ON 31
ci_33                -2.500519e-03 3 1  ON 32
ci_34                 1.848674e-03 3 1  ON 33
ci_35                 1.986210e-03 3 1  ON 34
ci_36                -1.888622e-03 3 1  ON 35
ci_37                -1.952204e-03 3 1  ON 36
ci_38                -1.403247e-03 3 1  ON 37
ci_39                -1.476574e-03 3 1  ON 38
ci_40                -1.850224e-03 3 1  ON 39
ci_41                -1.564252e-03 3 1  ON 40
ci_42                -1.412229e-03 3 1  ON 41
ci_43                -2.157763e-03 3 1  ON 42
ci_44                -1.955109e-03 3 1  ON 43
ci_45                -1.363797e-03 3 1  ON 44
ci_46                -1.312795e-03 3 1  ON 45
ci_47                -1.211000e-03 3 1  ON 46
ci_48                -1.046675e-03 3 1  ON 47
ci_49                -1.639010e-03 3 1  ON 48
ci_50                -1.325331e-03 3 1  ON 49
ci_51                 1.212056e-03 3 1  ON 50
ci_52                 1.194389e-03 3 1  ON 51
ci_53                -1.273876e-03 3 1  ON 52
ci_54                -1.148446e-03 3 1  ON 53
ci_55                -1.309419e-03 3 1  ON 54
ci_56                 1.615423e-03 3 1  ON 55
ci_57                 1.600226e-03 3 1  ON 56
ci_58                -1.133795e-03 3 1  ON 57
ci_59                -1.027218e-03 3 1  ON 58
ci_60                 7.668782e-04 3 1  ON 59
ci_61                 1.153411e-03 3 1  ON 60
ci_62                -9.499886e-04 3 1  ON 61
ci_63                -7.855206e-04 3 1  ON 62
ci_64                -8.488000e-04 3 1  ON 63
ci_65                -7.978031e-04 3 1  ON 64
ci_66                -8.276133e-04 3 1  ON 65
ci_67                -8.621862e-04 3 1  ON 66
ci_68                 1.913097e-04 3 1  ON 67
ci_69                 7.144136e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2116e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2800e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8177
    reference variance = 0.277097
====================================================
  Execution time = 4.2605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0580e-01
  Total weights = 1.963455764e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483452057462
                                         uncertainty =       0.002205732490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483452057462
                                         uncertainty =       0.002205732490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491722525
  error estimate for blocks of size 2^( 2) =       0.000512164698
  error estimate for blocks of size 2^( 3) =       0.000532357053
  error estimate for blocks of size 2^( 4) =       0.000547501381
  error estimate for blocks of size 2^( 5) =       0.000557153261
  error estimate for blocks of size 2^( 6) =       0.000561587064
  error estimate for blocks of size 2^( 7) =       0.000564248519

      target function =      -0.644662152917
              le_mean =     -22.814980550209
             les_mean =     521.029140938879
             stat err =       0.000557622556
             autocorr =       1.285998492250
   target nu stat err =       0.000557622556
   target dn stat err =       0.004537476979
      target stat err =       0.001769274974
              std dev =       0.695400664207
             le_variance =       0.483582083779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281498055021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.644666608473       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644808653006       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644828515900       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644831560486       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644832880788       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644833364261       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644833444267       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644833447476       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644833448870       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644833448705       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.110493e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.644666608473       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644702829671       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644707860667       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644708622908       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644708950182       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644709068629       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644709087973       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644709088708       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644709089042       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644709089002       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.546492e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.644666608473       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644675709252       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644676971129       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644677161746       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644677243378       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644677272834       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644677277628       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644677277807       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644677277890       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644677277880       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 3.878219e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0271e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_01                 1.508359e-01 3 1  ON 0
ci_02                -4.651521e-02 3 1  ON 1
ci_03                -4.651328e-02 3 1  ON 2
ci_04                 4.429458e-02 3 1  ON 3
ci_05                -3.306767e-02 3 1  ON 4
ci_06                -3.335887e-02 3 1  ON 5
ci_07                 2.894995e-02 3 1  ON 6
ci_08                -1.355393e-02 3 1  ON 7
ci_09                -1.448281e-02 3 1  ON 8
ci_10                -1.463170e-02 3 1  ON 9
ci_11                 1.509112e-02 3 1  ON 10
ci_12                 1.134431e-02 3 1  ON 11
ci_13                 1.250930e-02 3 1  ON 12
ci_14                 1.307031e-02 3 1  ON 13
ci_15                 1.044402e-02 3 1  ON 14
ci_16                 1.040993e-02 3 1  ON 15
ci_17                -1.034222e-02 3 1  ON 16
ci_18                -1.036315e-02 3 1  ON 17
ci_19                 1.061192e-02 3 1  ON 18
ci_20                 9.417234e-03 3 1  ON 19
ci_21                 9.285964e-03 3 1  ON 20
ci_22                 9.561822e-03 3 1  ON 21
ci_23                 5.810855e-03 3 1  ON 22
ci_24                 5.079073e-03 3 1  ON 23
ci_25                 4.345581e-03 3 1  ON 24
ci_26                 3.959388e-03 3 1  ON 25
ci_27                 4.053777e-03 3 1  ON 26
ci_28                 3.510629e-03 3 1  ON 27
ci_29                 3.645491e-03 3 1  ON 28
ci_30                -2.908503e-03 3 1  ON 29
ci_31                -2.711595e-03 3 1  ON 30
ci_32                -2.237846e-03 3 1  ON 31
ci_33                -2.481474e-03 3 1  ON 32
ci_34                 1.833013e-03 3 1  ON 33
ci_35                 1.979100e-03 3 1  ON 34
ci_36                -1.886523e-03 3 1  ON 35
ci_37                -1.954306e-03 3 1  ON 36
ci_38                -1.397413e-03 3 1  ON 37
ci_39                -1.467986e-03 3 1  ON 38
ci_40                -1.850021e-03 3 1  ON 39
ci_41                -1.555516e-03 3 1  ON 40
ci_42                -1.406679e-03 3 1  ON 41
ci_43                -2.154476e-03 3 1  ON 42
ci_44                -1.954732e-03 3 1  ON 43
ci_45                -1.355805e-03 3 1  ON 44
ci_46                -1.306950e-03 3 1  ON 45
ci_47                -1.202516e-03 3 1  ON 46
ci_48                -1.042886e-03 3 1  ON 47
ci_49                -1.634911e-03 3 1  ON 48
ci_50                -1.323296e-03 3 1  ON 49
ci_51                 1.205471e-03 3 1  ON 50
ci_52                 1.190772e-03 3 1  ON 51
ci_53                -1.272787e-03 3 1  ON 52
ci_54                -1.147942e-03 3 1  ON 53
ci_55                -1.314688e-03 3 1  ON 54
ci_56                 1.614086e-03 3 1  ON 55
ci_57                 1.599990e-03 3 1  ON 56
ci_58                -1.128199e-03 3 1  ON 57
ci_59                -1.029649e-03 3 1  ON 58
ci_60                 7.538424e-04 3 1  ON 59
ci_61                 1.156479e-03 3 1  ON 60
ci_62                -9.532430e-04 3 1  ON 61
ci_63                -7.825838e-04 3 1  ON 62
ci_64                -8.441579e-04 3 1  ON 63
ci_65                -7.892447e-04 3 1  ON 64
ci_66                -8.304194e-04 3 1  ON 65
ci_67                -8.536137e-04 3 1  ON 66
ci_68                 1.835392e-04 3 1  ON 67
ci_69                 6.495006e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8992
    reference variance = 0.445313
====================================================
  Execution time = 4.2985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9940e-01
  Total weights = 1.9634e+06
  Execution time = 5.9133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484864168986
                                         uncertainty =       0.002376535441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484864168986
                                         uncertainty =       0.002376535441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492327979
  error estimate for blocks of size 2^( 2) =       0.000513264810
  error estimate for blocks of size 2^( 3) =       0.000533422384
  error estimate for blocks of size 2^( 4) =       0.000548422743
  error estimate for blocks of size 2^( 5) =       0.000557930982
  error estimate for blocks of size 2^( 6) =       0.000563415129
  error estimate for blocks of size 2^( 7) =       0.000569107113

      target function =      -0.645977177191
              le_mean =     -22.814695648432
             les_mean =     521.012541001282
             stat err =       0.000559718992
             autocorr =       1.292501489436
   target nu stat err =       0.000559718992
   target dn stat err =       0.003815432968
      target stat err =       0.001504347671
              std dev =       0.696256904583
             le_variance =       0.484773677179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484115962264
                                         uncertainty =       0.002370001714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484115962264
                                         uncertainty =       0.002370001714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491947926
  error estimate for blocks of size 2^( 2) =       0.000512874726
  error estimate for blocks of size 2^( 3) =       0.000533021637
  error estimate for blocks of size 2^( 4) =       0.000548021507
  error estimate for blocks of size 2^( 5) =       0.000557529805
  error estimate for blocks of size 2^( 6) =       0.000563025213
  error estimate for blocks of size 2^( 7) =       0.000568713954

      target function =      -0.647310694265
              le_mean =     -22.814699102101
             les_mean =     521.009243321352
             stat err =       0.000559322620
             autocorr =       1.292666512173
   target nu stat err =       0.000559322620
   target dn stat err =       0.002877390455
      target stat err =       0.001159909158
              std dev =       0.695719429299
             le_variance =       0.484025524304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477688494
                                         uncertainty =       0.002373068177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477688494
                                         uncertainty =       0.002373068177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492131704
  error estimate for blocks of size 2^( 2) =       0.000513063330
  error estimate for blocks of size 2^( 3) =       0.000533215380
  error estimate for blocks of size 2^( 4) =       0.000548215383
  error estimate for blocks of size 2^( 5) =       0.000557723648
  error estimate for blocks of size 2^( 6) =       0.000563213492
  error estimate for blocks of size 2^( 7) =       0.000568903827

      target function =      -0.647153380628
              le_mean =     -22.814696590938
             les_mean =     521.009534726586
             stat err =       0.000559514087
             autocorr =       1.292585748036
   target nu stat err =       0.000559514087
   target dn stat err =       0.002879281420
      target stat err =       0.001160097793
              std dev =       0.695979330403
             le_variance =       0.484387228349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484815018537
                                         uncertainty =       0.002376083805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484815018537
                                         uncertainty =       0.002376083805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492303022
  error estimate for blocks of size 2^( 2) =       0.000513239186
  error estimate for blocks of size 2^( 3) =       0.000533396071
  error estimate for blocks of size 2^( 4) =       0.000548396308
  error estimate for blocks of size 2^( 5) =       0.000557904567
  error estimate for blocks of size 2^( 6) =       0.000563389445
  error estimate for blocks of size 2^( 7) =       0.000569081245

      target function =      -0.646963029050
              le_mean =     -22.814695675564
             les_mean =     521.009985794742
             stat err =       0.000559692891
             autocorr =       1.292511983118
   target nu stat err =       0.000559692891
   target dn stat err =       0.002884442558
      target stat err =       0.001161379771
              std dev =       0.696221610677
             le_variance =       0.484724531174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.645977177191        initial
     1.5625e+00     1.5625e+01             6.1105e-04        -0.647310694265  <--
     6.2500e+00     6.2500e+01             1.5465e-04        -0.647153380628
     2.5000e+01     2.5000e+02             3.8782e-05        -0.646963029050

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 7.6500e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_01                 1.503795e-01 3 1  ON 0
ci_02                -4.609745e-02 3 1  ON 1
ci_03                -4.609118e-02 3 1  ON 2
ci_04                 4.384902e-02 3 1  ON 3
ci_05                -3.279979e-02 3 1  ON 4
ci_06                -3.308263e-02 3 1  ON 5
ci_07                 2.890446e-02 3 1  ON 6
ci_08                -1.337815e-02 3 1  ON 7
ci_09                -1.437902e-02 3 1  ON 8
ci_10                -1.450489e-02 3 1  ON 9
ci_11                 1.506204e-02 3 1  ON 10
ci_12                 1.123710e-02 3 1  ON 11
ci_13                 1.249751e-02 3 1  ON 12
ci_14                 1.309100e-02 3 1  ON 13
ci_15                 1.036854e-02 3 1  ON 14
ci_16                 1.036467e-02 3 1  ON 15
ci_17                -1.029740e-02 3 1  ON 16
ci_18                -1.030725e-02 3 1  ON 17
ci_19                 1.058590e-02 3 1  ON 18
ci_20                 9.380894e-03 3 1  ON 19
ci_21                 9.241852e-03 3 1  ON 20
ci_22                 9.540858e-03 3 1  ON 21
ci_23                 5.805944e-03 3 1  ON 22
ci_24                 5.072095e-03 3 1  ON 23
ci_25                 4.315640e-03 3 1  ON 24
ci_26                 3.936520e-03 3 1  ON 25
ci_27                 4.034566e-03 3 1  ON 26
ci_28                 3.493539e-03 3 1  ON 27
ci_29                 3.605993e-03 3 1  ON 28
ci_30                -2.874764e-03 3 1  ON 29
ci_31                -2.680567e-03 3 1  ON 30
ci_32                -2.198268e-03 3 1  ON 31
ci_33                -2.426082e-03 3 1  ON 32
ci_34                 1.787484e-03 3 1  ON 33
ci_35                 1.958616e-03 3 1  ON 34
ci_36                -1.880231e-03 3 1  ON 35
ci_37                -1.960194e-03 3 1  ON 36
ci_38                -1.380305e-03 3 1  ON 37
ci_39                -1.442773e-03 3 1  ON 38
ci_40                -1.849404e-03 3 1  ON 39
ci_41                -1.530223e-03 3 1  ON 40
ci_42                -1.390709e-03 3 1  ON 41
ci_43                -2.144638e-03 3 1  ON 42
ci_44                -1.953376e-03 3 1  ON 43
ci_45                -1.332334e-03 3 1  ON 44
ci_46                -1.289824e-03 3 1  ON 45
ci_47                -1.177437e-03 3 1  ON 46
ci_48                -1.031565e-03 3 1  ON 47
ci_49                -1.622967e-03 3 1  ON 48
ci_50                -1.317072e-03 3 1  ON 49
ci_51                 1.186214e-03 3 1  ON 50
ci_52                 1.180208e-03 3 1  ON 51
ci_53                -1.269557e-03 3 1  ON 52
ci_54                -1.146429e-03 3 1  ON 53
ci_55                -1.330076e-03 3 1  ON 54
ci_56                 1.610233e-03 3 1  ON 55
ci_57                 1.599351e-03 3 1  ON 56
ci_58                -1.111819e-03 3 1  ON 57
ci_59                -1.036767e-03 3 1  ON 58
ci_60                 7.152936e-04 3 1  ON 59
ci_61                 1.165520e-03 3 1  ON 60
ci_62                -9.626860e-04 3 1  ON 61
ci_63                -7.739684e-04 3 1  ON 62
ci_64                -8.306406e-04 3 1  ON 63
ci_65                -7.642233e-04 3 1  ON 64
ci_66                -8.385722e-04 3 1  ON 65
ci_67                -8.285912e-04 3 1  ON 66
ci_68                 1.608161e-04 3 1  ON 67
ci_69                 4.595120e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2678e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2803e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8046
    reference variance = 0.411667
====================================================
  Execution time = 4.3230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.1262e-01
  Total weights = 1.963193963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488467170268
                                         uncertainty =       0.002659394468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488467170268
                                         uncertainty =       0.002659394468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494204096
  error estimate for blocks of size 2^( 2) =       0.000514824373
  error estimate for blocks of size 2^( 3) =       0.000534079654
  error estimate for blocks of size 2^( 4) =       0.000548852253
  error estimate for blocks of size 2^( 5) =       0.000557880704
  error estimate for blocks of size 2^( 6) =       0.000562525236
  error estimate for blocks of size 2^( 7) =       0.000566391449

      target function =      -0.642190801459
              le_mean =     -22.815574717099
             les_mean =     521.063067712584
             stat err =       0.000558912410
             autocorr =       1.279012607178
   target nu stat err =       0.000558912410
   target dn stat err =       0.008063784433
      target stat err =       0.003084550952
              std dev =       0.698910134740
             le_variance =       0.488475376442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281557471710e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.642205194135       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642726527093       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.642808489408       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.642819729612       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.642823301315       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.642824090252       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.642824460151       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.642824499873       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.642824493785       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.642824496686       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.324014e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.642205194135       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642345681845       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.642367170775       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.642370013920       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.642370881384       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.642371055550       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.642371140372       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.642371149034       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.642371147575       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.642371148242       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.263969e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.642205194135       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642241012951       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.642246450245       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.642247162536       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.642247377423       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.642247419431       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.642247440131       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.642247442214       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.642247441854       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.642247442017       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.598078e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0975e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_01                 1.497710e-01 3 1  ON 0
ci_02                -4.555204e-02 3 1  ON 1
ci_03                -4.554969e-02 3 1  ON 2
ci_04                 4.322263e-02 3 1  ON 3
ci_05                -3.247047e-02 3 1  ON 4
ci_06                -3.275423e-02 3 1  ON 5
ci_07                 2.882548e-02 3 1  ON 6
ci_08                -1.313010e-02 3 1  ON 7
ci_09                -1.425795e-02 3 1  ON 8
ci_10                -1.439307e-02 3 1  ON 9
ci_11                 1.501467e-02 3 1  ON 10
ci_12                 1.113615e-02 3 1  ON 11
ci_13                 1.249113e-02 3 1  ON 12
ci_14                 1.311154e-02 3 1  ON 13
ci_15                 1.021082e-02 3 1  ON 14
ci_16                 1.027239e-02 3 1  ON 15
ci_17                -1.021417e-02 3 1  ON 16
ci_18                -1.021880e-02 3 1  ON 17
ci_19                 1.049571e-02 3 1  ON 18
ci_20                 9.328340e-03 3 1  ON 19
ci_21                 9.229790e-03 3 1  ON 20
ci_22                 9.523826e-03 3 1  ON 21
ci_23                 5.734308e-03 3 1  ON 22
ci_24                 5.056084e-03 3 1  ON 23
ci_25                 4.293328e-03 3 1  ON 24
ci_26                 3.920555e-03 3 1  ON 25
ci_27                 4.030775e-03 3 1  ON 26
ci_28                 3.460041e-03 3 1  ON 27
ci_29                 3.596575e-03 3 1  ON 28
ci_30                -2.825987e-03 3 1  ON 29
ci_31                -2.649570e-03 3 1  ON 30
ci_32                -2.141898e-03 3 1  ON 31
ci_33                -2.380908e-03 3 1  ON 32
ci_34                 1.746025e-03 3 1  ON 33
ci_35                 1.887114e-03 3 1  ON 34
ci_36                -1.862330e-03 3 1  ON 35
ci_37                -1.941533e-03 3 1  ON 36
ci_38                -1.370075e-03 3 1  ON 37
ci_39                -1.416818e-03 3 1  ON 38
ci_40                -1.836263e-03 3 1  ON 39
ci_41                -1.525910e-03 3 1  ON 40
ci_42                -1.359188e-03 3 1  ON 41
ci_43                -2.091072e-03 3 1  ON 42
ci_44                -1.893568e-03 3 1  ON 43
ci_45                -1.319636e-03 3 1  ON 44
ci_46                -1.278498e-03 3 1  ON 45
ci_47                -1.169665e-03 3 1  ON 46
ci_48                -9.699024e-04 3 1  ON 47
ci_49                -1.618790e-03 3 1  ON 48
ci_50                -1.290468e-03 3 1  ON 49
ci_51                 1.173911e-03 3 1  ON 50
ci_52                 1.171303e-03 3 1  ON 51
ci_53                -1.251273e-03 3 1  ON 52
ci_54                -1.138897e-03 3 1  ON 53
ci_55                -1.310211e-03 3 1  ON 54
ci_56                 1.567119e-03 3 1  ON 55
ci_57                 1.613358e-03 3 1  ON 56
ci_58                -1.104254e-03 3 1  ON 57
ci_59                -1.018109e-03 3 1  ON 58
ci_60                 7.019164e-04 3 1  ON 59
ci_61                 1.131460e-03 3 1  ON 60
ci_62                -9.297834e-04 3 1  ON 61
ci_63                -7.720313e-04 3 1  ON 62
ci_64                -7.890599e-04 3 1  ON 63
ci_65                -7.476906e-04 3 1  ON 64
ci_66                -8.298371e-04 3 1  ON 65
ci_67                -8.282490e-04 3 1  ON 66
ci_68                 1.369988e-04 3 1  ON 67
ci_69                 4.557506e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8232
    reference variance = 0.481636
====================================================
  Execution time = 4.1926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9586e-01
  Total weights = 1.9635e+06
  Execution time = 5.9706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482291254356
                                         uncertainty =       0.002272290513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482291254356
                                         uncertainty =       0.002272290513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491129803
  error estimate for blocks of size 2^( 2) =       0.000512066603
  error estimate for blocks of size 2^( 3) =       0.000531309186
  error estimate for blocks of size 2^( 4) =       0.000546268512
  error estimate for blocks of size 2^( 5) =       0.000555692959
  error estimate for blocks of size 2^( 6) =       0.000561212964
  error estimate for blocks of size 2^( 7) =       0.000564012050

      target function =      -0.647403627854
              le_mean =     -22.815682595552
             les_mean =     521.054491063019
             stat err =       0.000556796621
             autocorr =       1.285288450968
   target nu stat err =       0.000556796621
   target dn stat err =       0.003734456619
      target stat err =       0.001481307441
              std dev =       0.694562427644
             le_variance =       0.482416965895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479539853109
                                         uncertainty =       0.002199531528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479539853109
                                         uncertainty =       0.002199531528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489728034
  error estimate for blocks of size 2^( 2) =       0.000510624808
  error estimate for blocks of size 2^( 3) =       0.000529867057
  error estimate for blocks of size 2^( 4) =       0.000544843659
  error estimate for blocks of size 2^( 5) =       0.000554271118
  error estimate for blocks of size 2^( 6) =       0.000559814487
  error estimate for blocks of size 2^( 7) =       0.000562646436

      target function =      -0.633478605206
              le_mean =     -22.815714303545
             les_mean =     521.092494790495
             stat err =       0.000555393925
             autocorr =       1.286152063622
   target nu stat err =       0.000555393925
   target dn stat err =       0.022167260239
      target stat err =       0.008211909569
              std dev =       0.692580027693
             le_variance =       0.479667094760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480711399248
                                         uncertainty =       0.002228699339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480711399248
                                         uncertainty =       0.002228699339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490325433
  error estimate for blocks of size 2^( 2) =       0.000511238850
  error estimate for blocks of size 2^( 3) =       0.000530480685
  error estimate for blocks of size 2^( 4) =       0.000545443486
  error estimate for blocks of size 2^( 5) =       0.000554871590
  error estimate for blocks of size 2^( 6) =       0.000560408553
  error estimate for blocks of size 2^( 7) =       0.000563230319

      target function =      -0.637272487333
              le_mean =     -22.815684119629
             les_mean =     521.080654240507
             stat err =       0.000555988487
             autocorr =       1.285768426439
   target nu stat err =       0.000555988487
   target dn stat err =       0.030381926504
      target stat err =       0.011387462433
              std dev =       0.693424876940
             le_variance =       0.480838059959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482074740310
                                         uncertainty =       0.002266082488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482074740310
                                         uncertainty =       0.002266082488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491019648
  error estimate for blocks of size 2^( 2) =       0.000511952844
  error estimate for blocks of size 2^( 3) =       0.000531194942
  error estimate for blocks of size 2^( 4) =       0.000546154546
  error estimate for blocks of size 2^( 5) =       0.000555580310
  error estimate for blocks of size 2^( 6) =       0.000561102941
  error estimate for blocks of size 2^( 7) =       0.000563903699

      target function =      -0.648414686491
              le_mean =     -22.815682117342
             les_mean =     521.051859010832
             stat err =       0.000556685374
             autocorr =       1.285351417455
   target nu stat err =       0.000556685374
   target dn stat err =       0.003338339256
      target stat err =       0.001336557951
              std dev =       0.694406645870
             le_variance =       0.482200589829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647403627854        initial
     3.9062e-01     3.9062e+00             2.3240e-03        -0.633478605206
     1.5625e+00     1.5625e+01             6.2640e-04        -0.637272487333
     6.2500e+00     6.2500e+01             1.5981e-04        -0.648414686491  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.1901e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_01                 1.502256e-01 3 1  ON 0
ci_02                -4.595865e-02 3 1  ON 1
ci_03                -4.595338e-02 3 1  ON 2
ci_04                 4.368921e-02 3 1  ON 3
ci_05                -3.271584e-02 3 1  ON 4
ci_06                -3.299892e-02 3 1  ON 5
ci_07                 2.888439e-02 3 1  ON 6
ci_08                -1.331491e-02 3 1  ON 7
ci_09                -1.434826e-02 3 1  ON 8
ci_10                -1.447650e-02 3 1  ON 9
ci_11                 1.504997e-02 3 1  ON 10
ci_12                 1.121138e-02 3 1  ON 11
ci_13                 1.249586e-02 3 1  ON 12
ci_14                 1.309612e-02 3 1  ON 13
ci_15                 1.032840e-02 3 1  ON 14
ci_16                 1.034119e-02 3 1  ON 15
ci_17                -1.027627e-02 3 1  ON 16
ci_18                -1.028478e-02 3 1  ON 17
ci_19                 1.056285e-02 3 1  ON 18
ci_20                 9.367506e-03 3 1  ON 19
ci_21                 9.238820e-03 3 1  ON 20
ci_22                 9.536537e-03 3 1  ON 21
ci_23                 5.787654e-03 3 1  ON 22
ci_24                 5.068003e-03 3 1  ON 23
ci_25                 4.309945e-03 3 1  ON 24
ci_26                 3.932425e-03 3 1  ON 25
ci_27                 4.033584e-03 3 1  ON 26
ci_28                 3.485060e-03 3 1  ON 27
ci_29                 3.603651e-03 3 1  ON 28
ci_30                -2.862440e-03 3 1  ON 29
ci_31                -2.672726e-03 3 1  ON 30
ci_32                -2.183838e-03 3 1  ON 31
ci_33                -2.414495e-03 3 1  ON 32
ci_34                 1.776861e-03 3 1  ON 33
ci_35                 1.940355e-03 3 1  ON 34
ci_36                -1.875687e-03 3 1  ON 35
ci_37                -1.955445e-03 3 1  ON 36
ci_38                -1.377704e-03 3 1  ON 37
ci_39                -1.436160e-03 3 1  ON 38
ci_40                -1.846052e-03 3 1  ON 39
ci_41                -1.529072e-03 3 1  ON 40
ci_42                -1.382604e-03 3 1  ON 41
ci_43                -2.131055e-03 3 1  ON 42
ci_44                -1.938217e-03 3 1  ON 43
ci_45                -1.329101e-03 3 1  ON 44
ci_46                -1.286944e-03 3 1  ON 45
ci_47                -1.175497e-03 3 1  ON 46
ci_48                -1.015953e-03 3 1  ON 47
ci_49                -1.621909e-03 3 1  ON 48
ci_50                -1.310279e-03 3 1  ON 49
ci_51                 1.183085e-03 3 1  ON 50
ci_52                 1.177947e-03 3 1  ON 51
ci_53                -1.264890e-03 3 1  ON 52
ci_54                -1.144503e-03 3 1  ON 53
ci_55                -1.325015e-03 3 1  ON 54
ci_56                 1.599209e-03 3 1  ON 55
ci_57                 1.602912e-03 3 1  ON 56
ci_58                -1.109874e-03 3 1  ON 57
ci_59                -1.031998e-03 3 1  ON 58
ci_60                 7.118941e-04 3 1  ON 59
ci_61                 1.156913e-03 3 1  ON 60
ci_62                -9.542948e-04 3 1  ON 61
ci_63                -7.734873e-04 3 1  ON 62
ci_64                -8.200439e-04 3 1  ON 63
ci_65                -7.600178e-04 3 1  ON 64
ci_66                -8.363439e-04 3 1  ON 65
ci_67                -8.285113e-04 3 1  ON 66
ci_68                 1.547596e-04 3 1  ON 67
ci_69                 4.586591e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2288e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8416
    reference variance = 0.567184
====================================================
  Execution time = 4.3052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0211e-01
  Total weights = 1.963326500e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485926881892
                                         uncertainty =       0.002656953014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485926881892
                                         uncertainty =       0.002656953014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492868974
  error estimate for blocks of size 2^( 2) =       0.000513743457
  error estimate for blocks of size 2^( 3) =       0.000533554763
  error estimate for blocks of size 2^( 4) =       0.000549269109
  error estimate for blocks of size 2^( 5) =       0.000559606420
  error estimate for blocks of size 2^( 6) =       0.000564843147
  error estimate for blocks of size 2^( 7) =       0.000567887202

      target function =      -0.646265637015
              le_mean =     -22.815747155877
             les_mean =     521.060428082379
             stat err =       0.000560401469
             autocorr =       1.292812579163
   target nu stat err =       0.000560401469
   target dn stat err =       0.003328342766
      target stat err =       0.001324895471
              std dev =       0.697021988114
             le_variance =       0.485839651915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281574715588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.646267967310       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.646415259777       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.646436393416       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.646440023170       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.646440727513       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.646440939964       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.646440993693       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.646441014356       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.646441014972       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.646441014621       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.475534e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.646267967310       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.646305525723       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.646310876139       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.646311786598       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.646311959726       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.646312011978       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.646312025069       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.646312030117       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.646312030263       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.652426e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.646267967310       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.646277404007       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.646278745847       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.646278973639       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.646279016730       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.646279029738       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.646279032989       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.646279034244       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.646279034280       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.152705e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0791e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_01                 1.500726e-01 3 1  ON 0
ci_02                -4.582319e-02 3 1  ON 1
ci_03                -4.581403e-02 3 1  ON 2
ci_04                 4.352397e-02 3 1  ON 3
ci_05                -3.263340e-02 3 1  ON 4
ci_06                -3.290667e-02 3 1  ON 5
ci_07                 2.887118e-02 3 1  ON 6
ci_08                -1.325471e-02 3 1  ON 7
ci_09                -1.431972e-02 3 1  ON 8
ci_10                -1.443873e-02 3 1  ON 9
ci_11                 1.504146e-02 3 1  ON 10
ci_12                 1.117882e-02 3 1  ON 11
ci_13                 1.249390e-02 3 1  ON 12
ci_14                 1.310024e-02 3 1  ON 13
ci_15                 1.030323e-02 3 1  ON 14
ci_16                 1.032357e-02 3 1  ON 15
ci_17                -1.025682e-02 3 1  ON 16
ci_18                -1.026509e-02 3 1  ON 17
ci_19                 1.056184e-02 3 1  ON 18
ci_20                 9.358884e-03 3 1  ON 19
ci_21                 9.239887e-03 3 1  ON 20
ci_22                 9.532333e-03 3 1  ON 21
ci_23                 5.779155e-03 3 1  ON 22
ci_24                 5.066062e-03 3 1  ON 23
ci_25                 4.298754e-03 3 1  ON 24
ci_26                 3.926485e-03 3 1  ON 25
ci_27                 4.023402e-03 3 1  ON 26
ci_28                 3.469864e-03 3 1  ON 27
ci_29                 3.596227e-03 3 1  ON 28
ci_30                -2.847122e-03 3 1  ON 29
ci_31                -2.660189e-03 3 1  ON 30
ci_32                -2.174638e-03 3 1  ON 31
ci_33                -2.400284e-03 3 1  ON 32
ci_34                 1.766418e-03 3 1  ON 33
ci_35                 1.924675e-03 3 1  ON 34
ci_36                -1.868325e-03 3 1  ON 35
ci_37                -1.947245e-03 3 1  ON 36
ci_38                -1.366156e-03 3 1  ON 37
ci_39                -1.429715e-03 3 1  ON 38
ci_40                -1.841046e-03 3 1  ON 39
ci_41                -1.518529e-03 3 1  ON 40
ci_42                -1.381939e-03 3 1  ON 41
ci_43                -2.133699e-03 3 1  ON 42
ci_44                -1.944426e-03 3 1  ON 43
ci_45                -1.319307e-03 3 1  ON 44
ci_46                -1.271172e-03 3 1  ON 45
ci_47                -1.164918e-03 3 1  ON 46
ci_48                -1.007010e-03 3 1  ON 47
ci_49                -1.609870e-03 3 1  ON 48
ci_50                -1.307460e-03 3 1  ON 49
ci_51                 1.177611e-03 3 1  ON 50
ci_52                 1.174042e-03 3 1  ON 51
ci_53                -1.261704e-03 3 1  ON 52
ci_54                -1.141589e-03 3 1  ON 53
ci_55                -1.326125e-03 3 1  ON 54
ci_56                 1.598492e-03 3 1  ON 55
ci_57                 1.611390e-03 3 1  ON 56
ci_58                -1.108619e-03 3 1  ON 57
ci_59                -1.036628e-03 3 1  ON 58
ci_60                 7.033165e-04 3 1  ON 59
ci_61                 1.167774e-03 3 1  ON 60
ci_62                -9.572097e-04 3 1  ON 61
ci_63                -7.754562e-04 3 1  ON 62
ci_64                -8.184277e-04 3 1  ON 63
ci_65                -7.591458e-04 3 1  ON 64
ci_66                -8.396702e-04 3 1  ON 65
ci_67                -8.240916e-04 3 1  ON 66
ci_68                 1.487398e-04 3 1  ON 67
ci_69                 3.437655e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7989
    reference variance = 0.37799
====================================================
  Execution time = 4.2081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9966e-01
  Total weights = 1.9633e+06
  Execution time = 5.9664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485712439613
                                         uncertainty =       0.003131349278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485712439613
                                         uncertainty =       0.003131349278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492755923
  error estimate for blocks of size 2^( 2) =       0.000513425017
  error estimate for blocks of size 2^( 3) =       0.000533281543
  error estimate for blocks of size 2^( 4) =       0.000548798743
  error estimate for blocks of size 2^( 5) =       0.000558525249
  error estimate for blocks of size 2^( 6) =       0.000562848155
  error estimate for blocks of size 2^( 7) =       0.000563761826

      target function =      -0.622023011473
              le_mean =     -22.816223053193
             les_mean =     521.145456157133
             stat err =       0.000558483493
             autocorr =       1.284567638227
   target nu stat err =       0.000558483493
   target dn stat err =       0.063951219110
      target stat err =       0.022863891880
              std dev =       0.696862108885
             le_variance =       0.485616798800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485039545677
                                         uncertainty =       0.003130178811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485039545677
                                         uncertainty =       0.003130178811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492414200
  error estimate for blocks of size 2^( 2) =       0.000513073694
  error estimate for blocks of size 2^( 3) =       0.000532927456
  error estimate for blocks of size 2^( 4) =       0.000548439178
  error estimate for blocks of size 2^( 5) =       0.000558164751
  error estimate for blocks of size 2^( 6) =       0.000562504047
  error estimate for blocks of size 2^( 7) =       0.000563420377

      target function =      -0.645190089937
              le_mean =     -22.816223824377
             les_mean =     521.085252010141
             stat err =       0.000558132088
             autocorr =       1.284732902008
   target nu stat err =       0.000558132088
   target dn stat err =       0.006551962972
      target stat err =       0.002538436496
              std dev =       0.696378839789
             le_variance =       0.484943488506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485353508297
                                         uncertainty =       0.003130496254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485353508297
                                         uncertainty =       0.003130496254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492573686
  error estimate for blocks of size 2^( 2) =       0.000513237657
  error estimate for blocks of size 2^( 3) =       0.000533094344
  error estimate for blocks of size 2^( 4) =       0.000548609655
  error estimate for blocks of size 2^( 5) =       0.000558334404
  error estimate for blocks of size 2^( 6) =       0.000562666254
  error estimate for blocks of size 2^( 7) =       0.000563573004

      target function =      -0.647340497054
              le_mean =     -22.816224328247
             les_mean =     521.079715173954
             stat err =       0.000558295829
             autocorr =       1.284654526212
   target nu stat err =       0.000558295829
   target dn stat err =       0.003052819616
      target stat err =       0.001226598123
              std dev =       0.696604387726
             le_variance =       0.485257672999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485662297600
                                         uncertainty =       0.003131605303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485662297600
                                         uncertainty =       0.003131605303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492730471
  error estimate for blocks of size 2^( 2) =       0.000513399049
  error estimate for blocks of size 2^( 3) =       0.000533258113
  error estimate for blocks of size 2^( 4) =       0.000548774555
  error estimate for blocks of size 2^( 5) =       0.000558499264
  error estimate for blocks of size 2^( 6) =       0.000562829687
  error estimate for blocks of size 2^( 7) =       0.000563740504

      target function =      -0.647161696346
              le_mean =     -22.816224394201
             les_mean =     521.080180781295
             stat err =       0.000558461002
             autocorr =       1.284596881174
   target nu stat err =       0.000558461002
   target dn stat err =       0.003052422240
      target stat err =       0.001225824785
              std dev =       0.696826114018
             le_variance =       0.485566633177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.622023011473        initial
     1.5625e+00     1.5625e+01             6.4755e-04        -0.645190089937
     6.2500e+00     6.2500e+01             1.6524e-04        -0.647340497054  <--
     2.5000e+01     2.5000e+02             4.1527e-05        -0.647161696346

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.5365e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_01                 1.500726e-01 3 1  ON 0
ci_02                -4.582319e-02 3 1  ON 1
ci_03                -4.581403e-02 3 1  ON 2
ci_04                 4.352397e-02 3 1  ON 3
ci_05                -3.263340e-02 3 1  ON 4
ci_06                -3.290667e-02 3 1  ON 5
ci_07                 2.887118e-02 3 1  ON 6
ci_08                -1.325471e-02 3 1  ON 7
ci_09                -1.431972e-02 3 1  ON 8
ci_10                -1.443873e-02 3 1  ON 9
ci_11                 1.504146e-02 3 1  ON 10
ci_12                 1.117882e-02 3 1  ON 11
ci_13                 1.249390e-02 3 1  ON 12
ci_14                 1.310024e-02 3 1  ON 13
ci_15                 1.030323e-02 3 1  ON 14
ci_16                 1.032357e-02 3 1  ON 15
ci_17                -1.025682e-02 3 1  ON 16
ci_18                -1.026509e-02 3 1  ON 17
ci_19                 1.056184e-02 3 1  ON 18
ci_20                 9.358884e-03 3 1  ON 19
ci_21                 9.239887e-03 3 1  ON 20
ci_22                 9.532333e-03 3 1  ON 21
ci_23                 5.779155e-03 3 1  ON 22
ci_24                 5.066062e-03 3 1  ON 23
ci_25                 4.298754e-03 3 1  ON 24
ci_26                 3.926485e-03 3 1  ON 25
ci_27                 4.023402e-03 3 1  ON 26
ci_28                 3.469864e-03 3 1  ON 27
ci_29                 3.596227e-03 3 1  ON 28
ci_30                -2.847122e-03 3 1  ON 29
ci_31                -2.660189e-03 3 1  ON 30
ci_32                -2.174638e-03 3 1  ON 31
ci_33                -2.400284e-03 3 1  ON 32
ci_34                 1.766418e-03 3 1  ON 33
ci_35                 1.924675e-03 3 1  ON 34
ci_36                -1.868325e-03 3 1  ON 35
ci_37                -1.947245e-03 3 1  ON 36
ci_38                -1.366156e-03 3 1  ON 37
ci_39                -1.429715e-03 3 1  ON 38
ci_40                -1.841046e-03 3 1  ON 39
ci_41                -1.518529e-03 3 1  ON 40
ci_42                -1.381939e-03 3 1  ON 41
ci_43                -2.133699e-03 3 1  ON 42
ci_44                -1.944426e-03 3 1  ON 43
ci_45                -1.319307e-03 3 1  ON 44
ci_46                -1.271172e-03 3 1  ON 45
ci_47                -1.164918e-03 3 1  ON 46
ci_48                -1.007010e-03 3 1  ON 47
ci_49                -1.609870e-03 3 1  ON 48
ci_50                -1.307460e-03 3 1  ON 49
ci_51                 1.177611e-03 3 1  ON 50
ci_52                 1.174042e-03 3 1  ON 51
ci_53                -1.261704e-03 3 1  ON 52
ci_54                -1.141589e-03 3 1  ON 53
ci_55                -1.326125e-03 3 1  ON 54
ci_56                 1.598492e-03 3 1  ON 55
ci_57                 1.611390e-03 3 1  ON 56
ci_58                -1.108619e-03 3 1  ON 57
ci_59                -1.036628e-03 3 1  ON 58
ci_60                 7.033165e-04 3 1  ON 59
ci_61                 1.167774e-03 3 1  ON 60
ci_62                -9.572097e-04 3 1  ON 61
ci_63                -7.754562e-04 3 1  ON 62
ci_64                -8.184277e-04 3 1  ON 63
ci_65                -7.591458e-04 3 1  ON 64
ci_66                -8.396702e-04 3 1  ON 65
ci_67                -8.240916e-04 3 1  ON 66
ci_68                 1.487398e-04 3 1  ON 67
ci_69                 3.437655e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2616e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8707
    reference variance = 0.771676
====================================================
  Execution time = 4.3327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0496e-01
  Total weights = 1.963263373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488172730610
                                         uncertainty =       0.004547351663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488172730610
                                         uncertainty =       0.004547351663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494069284
  error estimate for blocks of size 2^( 2) =       0.000514757328
  error estimate for blocks of size 2^( 3) =       0.000534916662
  error estimate for blocks of size 2^( 4) =       0.000549944836
  error estimate for blocks of size 2^( 5) =       0.000559132789
  error estimate for blocks of size 2^( 6) =       0.000564789189
  error estimate for blocks of size 2^( 7) =       0.000566922077

      target function =      -0.645143170092
              le_mean =     -22.815649645433
             les_mean =     521.058823942250
             stat err =       0.000560197223
             autocorr =       1.285600975365
   target nu stat err =       0.000560197223
   target dn stat err =       0.005825309304
      target stat err =       0.002260677021
              std dev =       0.698719481898
             le_variance =       0.488208914383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281564964543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645150599177       residual = 3.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645294541403       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645316746601       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645320568490       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645321629101       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645321738071       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645321714207       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645321719713       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645321717725       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645321717713       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.536995e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645150599177       residual = 3.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645187302944       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645192921036       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645193879938       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645194141856       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645194167732       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645194161710       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645194163111       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645194162626       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645194162616       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.653780e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645150599177       residual = 3.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645159821118       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645161229855       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645161469786       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645161535054       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645161541437       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645161539928       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645161540280       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645161540159       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645161540156       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.146847e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3055e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_01                 1.499072e-01 3 1  ON 0
ci_02                -4.569608e-02 3 1  ON 1
ci_03                -4.568168e-02 3 1  ON 2
ci_04                 4.337193e-02 3 1  ON 3
ci_05                -3.254881e-02 3 1  ON 4
ci_06                -3.280596e-02 3 1  ON 5
ci_07                 2.886164e-02 3 1  ON 6
ci_08                -1.319119e-02 3 1  ON 7
ci_09                -1.426199e-02 3 1  ON 8
ci_10                -1.439695e-02 3 1  ON 9
ci_11                 1.502554e-02 3 1  ON 10
ci_12                 1.115126e-02 3 1  ON 11
ci_13                 1.248311e-02 3 1  ON 12
ci_14                 1.309834e-02 3 1  ON 13
ci_15                 1.027605e-02 3 1  ON 14
ci_16                 1.030039e-02 3 1  ON 15
ci_17                -1.024504e-02 3 1  ON 16
ci_18                -1.025459e-02 3 1  ON 17
ci_19                 1.054561e-02 3 1  ON 18
ci_20                 9.331495e-03 3 1  ON 19
ci_21                 9.236975e-03 3 1  ON 20
ci_22                 9.531035e-03 3 1  ON 21
ci_23                 5.763814e-03 3 1  ON 22
ci_24                 5.063140e-03 3 1  ON 23
ci_25                 4.288310e-03 3 1  ON 24
ci_26                 3.918763e-03 3 1  ON 25
ci_27                 4.023634e-03 3 1  ON 26
ci_28                 3.454626e-03 3 1  ON 27
ci_29                 3.591605e-03 3 1  ON 28
ci_30                -2.835675e-03 3 1  ON 29
ci_31                -2.655010e-03 3 1  ON 30
ci_32                -2.158051e-03 3 1  ON 31
ci_33                -2.385571e-03 3 1  ON 32
ci_34                 1.753949e-03 3 1  ON 33
ci_35                 1.909010e-03 3 1  ON 34
ci_36                -1.857290e-03 3 1  ON 35
ci_37                -1.933411e-03 3 1  ON 36
ci_38                -1.361191e-03 3 1  ON 37
ci_39                -1.423066e-03 3 1  ON 38
ci_40                -1.842216e-03 3 1  ON 39
ci_41                -1.512756e-03 3 1  ON 40
ci_42                -1.363084e-03 3 1  ON 41
ci_43                -2.129360e-03 3 1  ON 42
ci_44                -1.944803e-03 3 1  ON 43
ci_45                -1.312266e-03 3 1  ON 44
ci_46                -1.267289e-03 3 1  ON 45
ci_47                -1.153326e-03 3 1  ON 46
ci_48                -9.970529e-04 3 1  ON 47
ci_49                -1.592041e-03 3 1  ON 48
ci_50                -1.304642e-03 3 1  ON 49
ci_51                 1.173170e-03 3 1  ON 50
ci_52                 1.172944e-03 3 1  ON 51
ci_53                -1.259109e-03 3 1  ON 52
ci_54                -1.128060e-03 3 1  ON 53
ci_55                -1.324507e-03 3 1  ON 54
ci_56                 1.606172e-03 3 1  ON 55
ci_57                 1.615669e-03 3 1  ON 56
ci_58                -1.095590e-03 3 1  ON 57
ci_59                -1.047232e-03 3 1  ON 58
ci_60                 7.071810e-04 3 1  ON 59
ci_61                 1.160375e-03 3 1  ON 60
ci_62                -9.623909e-04 3 1  ON 61
ci_63                -7.711863e-04 3 1  ON 62
ci_64                -8.313626e-04 3 1  ON 63
ci_65                -7.465480e-04 3 1  ON 64
ci_66                -8.395251e-04 3 1  ON 65
ci_67                -8.239908e-04 3 1  ON 66
ci_68                 1.431312e-04 3 1  ON 67
ci_69                 2.029339e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.9038
    reference variance = 0.66303
====================================================
  Execution time = 4.1930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9468e-01
  Total weights = 1.9632e+06
  Execution time = 5.9180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480760789240
                                         uncertainty =       0.002115273177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480760789240
                                         uncertainty =       0.002115273177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490322888
  error estimate for blocks of size 2^( 2) =       0.000511561555
  error estimate for blocks of size 2^( 3) =       0.000532086394
  error estimate for blocks of size 2^( 4) =       0.000547749026
  error estimate for blocks of size 2^( 5) =       0.000556839630
  error estimate for blocks of size 2^( 6) =       0.000562310919
  error estimate for blocks of size 2^( 7) =       0.000562626352

      target function =      -0.648536196484
              le_mean =     -22.814545697472
             les_mean =     520.998978303775
             stat err =       0.000557381481
             autocorr =       1.292232736259
   target nu stat err =       0.000557381481
   target dn stat err =       0.003048952155
      target stat err =       0.001227471674
              std dev =       0.693421277815
             le_variance =       0.480833068526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480005877128
                                         uncertainty =       0.002111944779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480005877128
                                         uncertainty =       0.002111944779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489937850
  error estimate for blocks of size 2^( 2) =       0.000511166995
  error estimate for blocks of size 2^( 3) =       0.000531687556
  error estimate for blocks of size 2^( 4) =       0.000547352397
  error estimate for blocks of size 2^( 5) =       0.000556446646
  error estimate for blocks of size 2^( 6) =       0.000561911668
  error estimate for blocks of size 2^( 7) =       0.000562239459

      target function =      -0.649175792955
              le_mean =     -22.814547485045
             les_mean =     520.997412911665
             stat err =       0.000556987542
             autocorr =       1.292435802604
   target nu stat err =       0.000556987542
   target dn stat err =       0.002785838023
      target stat err =       0.001131745232
              std dev =       0.692876751723
             le_variance =       0.480078193079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480370852559
                                         uncertainty =       0.002113461238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480370852559
                                         uncertainty =       0.002113461238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490124043
  error estimate for blocks of size 2^( 2) =       0.000511357784
  error estimate for blocks of size 2^( 3) =       0.000531880411
  error estimate for blocks of size 2^( 4) =       0.000547544010
  error estimate for blocks of size 2^( 5) =       0.000556636310
  error estimate for blocks of size 2^( 6) =       0.000562104349
  error estimate for blocks of size 2^( 7) =       0.000562426213

      target function =      -0.648955011182
              le_mean =     -22.814545837757
             les_mean =     520.997905489949
             stat err =       0.000557177720
             autocorr =       1.292336080250
   target nu stat err =       0.000557177720
   target dn stat err =       0.002806358687
      target stat err =       0.001138651753
              std dev =       0.693140069096
             le_variance =       0.480443155387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480711200281
                                         uncertainty =       0.002115031834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480711200281
                                         uncertainty =       0.002115031834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490297605
  error estimate for blocks of size 2^( 2) =       0.000511535640
  error estimate for blocks of size 2^( 3) =       0.000532060191
  error estimate for blocks of size 2^( 4) =       0.000547722946
  error estimate for blocks of size 2^( 5) =       0.000556813774
  error estimate for blocks of size 2^( 6) =       0.000562284644
  error estimate for blocks of size 2^( 7) =       0.000562600875

      target function =      -0.648638727994
              le_mean =     -22.814545632415
             les_mean =     520.998711019862
             stat err =       0.000557355560
             autocorr =       1.292245806819
   target nu stat err =       0.000557355560
   target dn stat err =       0.002968147634
      target stat err =       0.001197724839
              std dev =       0.693385522525
             le_variance =       0.480783482848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.648536196484        initial
     1.5625e+00     1.5625e+01             6.5370e-04        -0.649175792955  <--
     6.2500e+00     6.2500e+01             1.6538e-04        -0.648955011182
     2.5000e+01     2.5000e+02             4.1468e-05        -0.648638727994

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 7.1671e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_01                 1.494189e-01 3 1  ON 0
ci_02                -4.532389e-02 3 1  ON 1
ci_03                -4.529423e-02 3 1  ON 2
ci_04                 4.292818e-02 3 1  ON 3
ci_05                -3.230159e-02 3 1  ON 4
ci_06                -3.251142e-02 3 1  ON 5
ci_07                 2.883362e-02 3 1  ON 6
ci_08                -1.300560e-02 3 1  ON 7
ci_09                -1.409246e-02 3 1  ON 8
ci_10                -1.427420e-02 3 1  ON 9
ci_11                 1.497894e-02 3 1  ON 10
ci_12                 1.107067e-02 3 1  ON 11
ci_13                 1.245141e-02 3 1  ON 12
ci_14                 1.309288e-02 3 1  ON 13
ci_15                 1.019650e-02 3 1  ON 14
ci_16                 1.023242e-02 3 1  ON 15
ci_17                -1.021031e-02 3 1  ON 16
ci_18                -1.022344e-02 3 1  ON 17
ci_19                 1.049841e-02 3 1  ON 18
ci_20                 9.251466e-03 3 1  ON 19
ci_21                 9.228353e-03 3 1  ON 20
ci_22                 9.527140e-03 3 1  ON 21
ci_23                 5.719177e-03 3 1  ON 22
ci_24                 5.054595e-03 3 1  ON 23
ci_25                 4.257840e-03 3 1  ON 24
ci_26                 3.896275e-03 3 1  ON 25
ci_27                 4.024499e-03 3 1  ON 26
ci_28                 3.409864e-03 3 1  ON 27
ci_29                 3.577885e-03 3 1  ON 28
ci_30                -2.801928e-03 3 1  ON 29
ci_31                -2.639683e-03 3 1  ON 30
ci_32                -2.109808e-03 3 1  ON 31
ci_33                -2.342886e-03 3 1  ON 32
ci_34                 1.717730e-03 3 1  ON 33
ci_35                 1.863502e-03 3 1  ON 34
ci_36                -1.825041e-03 3 1  ON 35
ci_37                -1.893008e-03 3 1  ON 36
ci_38                -1.346658e-03 3 1  ON 37
ci_39                -1.403571e-03 3 1  ON 38
ci_40                -1.845558e-03 3 1  ON 39
ci_41                -1.496088e-03 3 1  ON 40
ci_42                -1.308101e-03 3 1  ON 41
ci_43                -2.116453e-03 3 1  ON 42
ci_44                -1.945717e-03 3 1  ON 43
ci_45                -1.291702e-03 3 1  ON 44
ci_46                -1.255933e-03 3 1  ON 45
ci_47                -1.119060e-03 3 1  ON 46
ci_48                -9.676423e-04 3 1  ON 47
ci_49                -1.540023e-03 3 1  ON 48
ci_50                -1.296430e-03 3 1  ON 49
ci_51                 1.160128e-03 3 1  ON 50
ci_52                 1.169664e-03 3 1  ON 51
ci_53                -1.251538e-03 3 1  ON 52
ci_54                -1.088448e-03 3 1  ON 53
ci_55                -1.319820e-03 3 1  ON 54
ci_56                 1.628612e-03 3 1  ON 55
ci_57                 1.628313e-03 3 1  ON 56
ci_58                -1.057428e-03 3 1  ON 57
ci_59                -1.078232e-03 3 1  ON 58
ci_60                 7.186496e-04 3 1  ON 59
ci_61                 1.138401e-03 3 1  ON 60
ci_62                -9.774555e-04 3 1  ON 61
ci_63                -7.586803e-04 3 1  ON 62
ci_64                -8.690852e-04 3 1  ON 63
ci_65                -7.097499e-04 3 1  ON 64
ci_66                -8.390274e-04 3 1  ON 65
ci_67                -8.236619e-04 3 1  ON 66
ci_68                 1.266690e-04 3 1  ON 67
ci_69                -2.096364e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2473e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7671
    reference variance = 0.307436
====================================================
  Execution time = 4.3357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0404e-01
  Total weights = 1.963247913e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485850007588
                                         uncertainty =       0.003013037349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485850007588
                                         uncertainty =       0.003013037349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492830131
  error estimate for blocks of size 2^( 2) =       0.000513721512
  error estimate for blocks of size 2^( 3) =       0.000533341674
  error estimate for blocks of size 2^( 4) =       0.000548363440
  error estimate for blocks of size 2^( 5) =       0.000556672373
  error estimate for blocks of size 2^( 6) =       0.000561195558
  error estimate for blocks of size 2^( 7) =       0.000563401128

      target function =      -0.645323192184
              le_mean =     -22.814914550118
             les_mean =     521.024367050592
             stat err =       0.000557408125
             autocorr =       1.279240162329
   target nu stat err =       0.000557408125
   target dn stat err =       0.003999018946
      target stat err =       0.001570173914
              std dev =       0.696967054657
             le_variance =       0.485763075277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281491455012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645326616009       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645790201599       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645860942548       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645871114208       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645873829782       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645874531336       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645874651119       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645874629003       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645874614978       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645874611633       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.166083e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645326616009       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645451600185       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645470183655       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645472760264       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645473414479       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645473576733       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645473601719       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645473595982       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645473592656       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.854119e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645326616009       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645358486190       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645363190904       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645363836672       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645363998380       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645364038053       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645364043980       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645364042536       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645364041718       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.493780e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1008e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_01                 1.488656e-01 3 1  ON 0
ci_02                -4.482543e-02 3 1  ON 1
ci_03                -4.476961e-02 3 1  ON 2
ci_04                 4.234277e-02 3 1  ON 3
ci_05                -3.197374e-02 3 1  ON 4
ci_06                -3.217799e-02 3 1  ON 5
ci_07                 2.876114e-02 3 1  ON 6
ci_08                -1.276952e-02 3 1  ON 7
ci_09                -1.396482e-02 3 1  ON 8
ci_10                -1.414187e-02 3 1  ON 9
ci_11                 1.494205e-02 3 1  ON 10
ci_12                 1.098885e-02 3 1  ON 11
ci_13                 1.244441e-02 3 1  ON 12
ci_14                 1.303539e-02 3 1  ON 13
ci_15                 1.006020e-02 3 1  ON 14
ci_16                 1.014988e-02 3 1  ON 15
ci_17                -1.011492e-02 3 1  ON 16
ci_18                -1.015029e-02 3 1  ON 17
ci_19                 1.044919e-02 3 1  ON 18
ci_20                 9.226524e-03 3 1  ON 19
ci_21                 9.228762e-03 3 1  ON 20
ci_22                 9.498118e-03 3 1  ON 21
ci_23                 5.714561e-03 3 1  ON 22
ci_24                 5.086568e-03 3 1  ON 23
ci_25                 4.200270e-03 3 1  ON 24
ci_26                 3.861826e-03 3 1  ON 25
ci_27                 3.965101e-03 3 1  ON 26
ci_28                 3.384728e-03 3 1  ON 27
ci_29                 3.583754e-03 3 1  ON 28
ci_30                -2.744447e-03 3 1  ON 29
ci_31                -2.622724e-03 3 1  ON 30
ci_32                -2.052286e-03 3 1  ON 31
ci_33                -2.297826e-03 3 1  ON 32
ci_34                 1.659630e-03 3 1  ON 33
ci_35                 1.842285e-03 3 1  ON 34
ci_36                -1.828044e-03 3 1  ON 35
ci_37                -1.873676e-03 3 1  ON 36
ci_38                -1.367496e-03 3 1  ON 37
ci_39                -1.408888e-03 3 1  ON 38
ci_40                -1.812649e-03 3 1  ON 39
ci_41                -1.460484e-03 3 1  ON 40
ci_42                -1.265792e-03 3 1  ON 41
ci_43                -2.105447e-03 3 1  ON 42
ci_44                -1.966327e-03 3 1  ON 43
ci_45                -1.306080e-03 3 1  ON 44
ci_46                -1.226663e-03 3 1  ON 45
ci_47                -1.084276e-03 3 1  ON 46
ci_48                -9.744012e-04 3 1  ON 47
ci_49                -1.523916e-03 3 1  ON 48
ci_50                -1.284977e-03 3 1  ON 49
ci_51                 1.123010e-03 3 1  ON 50
ci_52                 1.136939e-03 3 1  ON 51
ci_53                -1.243329e-03 3 1  ON 52
ci_54                -1.092664e-03 3 1  ON 53
ci_55                -1.269468e-03 3 1  ON 54
ci_56                 1.653330e-03 3 1  ON 55
ci_57                 1.636864e-03 3 1  ON 56
ci_58                -1.040465e-03 3 1  ON 57
ci_59                -1.087134e-03 3 1  ON 58
ci_60                 7.304017e-04 3 1  ON 59
ci_61                 1.152131e-03 3 1  ON 60
ci_62                -9.591317e-04 3 1  ON 61
ci_63                -7.553754e-04 3 1  ON 62
ci_64                -8.501357e-04 3 1  ON 63
ci_65                -6.949537e-04 3 1  ON 64
ci_66                -8.586470e-04 3 1  ON 65
ci_67                -8.204205e-04 3 1  ON 66
ci_68                 1.107426e-04 3 1  ON 67
ci_69                -4.997705e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8243
    reference variance = 0.270271
====================================================
  Execution time = 4.1342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9901e-01
  Total weights = 1.9632e+06
  Execution time = 5.9592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484313745934
                                         uncertainty =       0.002362371259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484313745934
                                         uncertainty =       0.002362371259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492098669
  error estimate for blocks of size 2^( 2) =       0.000512745830
  error estimate for blocks of size 2^( 3) =       0.000532256098
  error estimate for blocks of size 2^( 4) =       0.000546517249
  error estimate for blocks of size 2^( 5) =       0.000556672787
  error estimate for blocks of size 2^( 6) =       0.000561572702
  error estimate for blocks of size 2^( 7) =       0.000565254331

      target function =      -0.647058848848
              le_mean =     -22.816015336071
             les_mean =     521.070776773635
             stat err =       0.000557504267
             autocorr =       1.283488585607
   target nu stat err =       0.000557504267
   target dn stat err =       0.003148043579
      target stat err =       0.001260642789
              std dev =       0.695932612203
             le_variance =       0.484322200728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481876829958
                                         uncertainty =       0.002340741847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481876829958
                                         uncertainty =       0.002340741847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490859418
  error estimate for blocks of size 2^( 2) =       0.000511485959
  error estimate for blocks of size 2^( 3) =       0.000530988757
  error estimate for blocks of size 2^( 4) =       0.000545282391
  error estimate for blocks of size 2^( 5) =       0.000555454168
  error estimate for blocks of size 2^( 6) =       0.000560343765
  error estimate for blocks of size 2^( 7) =       0.000564063168

      target function =      -0.614587175378
              le_mean =     -22.816049212188
             les_mean =     521.156864804203
             stat err =       0.000556285873
             autocorr =       1.284345313821
   target nu stat err =       0.000556285873
   target dn stat err =       0.083869531142
      target stat err =       0.029293493956
              std dev =       0.694180046335
             le_variance =       0.481885936729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482935135882
                                         uncertainty =       0.002349509252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482935135882
                                         uncertainty =       0.002349509252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491398000
  error estimate for blocks of size 2^( 2) =       0.000512031661
  error estimate for blocks of size 2^( 3) =       0.000531536387
  error estimate for blocks of size 2^( 4) =       0.000545813876
  error estimate for blocks of size 2^( 5) =       0.000555978011
  error estimate for blocks of size 2^( 6) =       0.000560873226
  error estimate for blocks of size 2^( 7) =       0.000564569846

      target function =      -0.647594501285
              le_mean =     -22.816025225622
             les_mean =     521.069848448150
             stat err =       0.000556808740
             autocorr =       1.283941742110
   target nu stat err =       0.000556808740
   target dn stat err =       0.003173992942
      target stat err =       0.001272247725
              std dev =       0.694941715794
             le_variance =       0.482943988350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484129983777
                                         uncertainty =       0.002360526809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484129983777
                                         uncertainty =       0.002360526809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492005331
  error estimate for blocks of size 2^( 2) =       0.000512650697
  error estimate for blocks of size 2^( 3) =       0.000532160981
  error estimate for blocks of size 2^( 4) =       0.000546423913
  error estimate for blocks of size 2^( 5) =       0.000556580562
  error estimate for blocks of size 2^( 6) =       0.000561479546
  error estimate for blocks of size 2^( 7) =       0.000565162532

      target function =      -0.647049612999
              le_mean =     -22.816015674737
             les_mean =     521.070816193412
             stat err =       0.000557411638
             autocorr =       1.283548983233
   target nu stat err =       0.000557411638
   target dn stat err =       0.003189043285
      target stat err =       0.001275874831
              std dev =       0.695800612135
             le_variance =       0.484138491848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647058848848        initial
     3.9062e-01     3.9062e+00             2.1661e-03        -0.614587175378
     1.5625e+00     1.5625e+01             5.8541e-04        -0.647594501285  <--
     6.2500e+00     6.2500e+01             1.4938e-04        -0.647049612999

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 7.1323e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_01                 1.488656e-01 3 1  ON 0
ci_02                -4.482543e-02 3 1  ON 1
ci_03                -4.476961e-02 3 1  ON 2
ci_04                 4.234277e-02 3 1  ON 3
ci_05                -3.197374e-02 3 1  ON 4
ci_06                -3.217799e-02 3 1  ON 5
ci_07                 2.876114e-02 3 1  ON 6
ci_08                -1.276952e-02 3 1  ON 7
ci_09                -1.396482e-02 3 1  ON 8
ci_10                -1.414187e-02 3 1  ON 9
ci_11                 1.494205e-02 3 1  ON 10
ci_12                 1.098885e-02 3 1  ON 11
ci_13                 1.244441e-02 3 1  ON 12
ci_14                 1.303539e-02 3 1  ON 13
ci_15                 1.006020e-02 3 1  ON 14
ci_16                 1.014988e-02 3 1  ON 15
ci_17                -1.011492e-02 3 1  ON 16
ci_18                -1.015029e-02 3 1  ON 17
ci_19                 1.044919e-02 3 1  ON 18
ci_20                 9.226524e-03 3 1  ON 19
ci_21                 9.228762e-03 3 1  ON 20
ci_22                 9.498118e-03 3 1  ON 21
ci_23                 5.714561e-03 3 1  ON 22
ci_24                 5.086568e-03 3 1  ON 23
ci_25                 4.200270e-03 3 1  ON 24
ci_26                 3.861826e-03 3 1  ON 25
ci_27                 3.965101e-03 3 1  ON 26
ci_28                 3.384728e-03 3 1  ON 27
ci_29                 3.583754e-03 3 1  ON 28
ci_30                -2.744447e-03 3 1  ON 29
ci_31                -2.622724e-03 3 1  ON 30
ci_32                -2.052286e-03 3 1  ON 31
ci_33                -2.297826e-03 3 1  ON 32
ci_34                 1.659630e-03 3 1  ON 33
ci_35                 1.842285e-03 3 1  ON 34
ci_36                -1.828044e-03 3 1  ON 35
ci_37                -1.873676e-03 3 1  ON 36
ci_38                -1.367496e-03 3 1  ON 37
ci_39                -1.408888e-03 3 1  ON 38
ci_40                -1.812649e-03 3 1  ON 39
ci_41                -1.460484e-03 3 1  ON 40
ci_42                -1.265792e-03 3 1  ON 41
ci_43                -2.105447e-03 3 1  ON 42
ci_44                -1.966327e-03 3 1  ON 43
ci_45                -1.306080e-03 3 1  ON 44
ci_46                -1.226663e-03 3 1  ON 45
ci_47                -1.084276e-03 3 1  ON 46
ci_48                -9.744012e-04 3 1  ON 47
ci_49                -1.523916e-03 3 1  ON 48
ci_50                -1.284977e-03 3 1  ON 49
ci_51                 1.123010e-03 3 1  ON 50
ci_52                 1.136939e-03 3 1  ON 51
ci_53                -1.243329e-03 3 1  ON 52
ci_54                -1.092664e-03 3 1  ON 53
ci_55                -1.269468e-03 3 1  ON 54
ci_56                 1.653330e-03 3 1  ON 55
ci_57                 1.636864e-03 3 1  ON 56
ci_58                -1.040465e-03 3 1  ON 57
ci_59                -1.087134e-03 3 1  ON 58
ci_60                 7.304017e-04 3 1  ON 59
ci_61                 1.152131e-03 3 1  ON 60
ci_62                -9.591317e-04 3 1  ON 61
ci_63                -7.553754e-04 3 1  ON 62
ci_64                -8.501357e-04 3 1  ON 63
ci_65                -6.949537e-04 3 1  ON 64
ci_66                -8.586470e-04 3 1  ON 65
ci_67                -8.204205e-04 3 1  ON 66
ci_68                 1.107426e-04 3 1  ON 67
ci_69                -4.997705e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2234e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7695
    reference variance = 0.618298
====================================================
  Execution time = 4.2755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.0459e-01
  Total weights = 1.962920192e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485094740518
                                         uncertainty =       0.002654024764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485094740518
                                         uncertainty =       0.002654024764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492425497
  error estimate for blocks of size 2^( 2) =       0.000513392740
  error estimate for blocks of size 2^( 3) =       0.000532476085
  error estimate for blocks of size 2^( 4) =       0.000546712167
  error estimate for blocks of size 2^( 5) =       0.000556570742
  error estimate for blocks of size 2^( 6) =       0.000562441865
  error estimate for blocks of size 2^( 7) =       0.000565135155

      target function =      -0.645197901879
              le_mean =     -22.815275839788
             les_mean =     521.041400116570
             stat err =       0.000557714982
             autocorr =       1.282754537075
   target nu stat err =       0.000557714982
   target dn stat err =       0.004619599448
      target stat err =       0.001803627413
              std dev =       0.696394816006
             le_variance =       0.484965739759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281527583979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645202528007       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645691724875       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645769265135       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645780184874       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645783324529       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645784375757       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645784560790       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645784589677       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645784580164       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645784574535       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.237513e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645202528007       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645334278171       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645354610734       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645357372886       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645358135914       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645358379347       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645358417507       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645358423982       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645358421661       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645358420320       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.857860e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.645202528007       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.645236113708       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.645241258649       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.645241950660       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.645242139733       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.645242199266       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.645242208286       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.645242209855       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.645242209281       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.645242208950       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.482000e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0421e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_01                 1.482799e-01 3 1  ON 0
ci_02                -4.430692e-02 3 1  ON 1
ci_03                -4.419367e-02 3 1  ON 2
ci_04                 4.179801e-02 3 1  ON 3
ci_05                -3.162312e-02 3 1  ON 4
ci_06                -3.183243e-02 3 1  ON 5
ci_07                 2.872297e-02 3 1  ON 6
ci_08                -1.254170e-02 3 1  ON 7
ci_09                -1.375785e-02 3 1  ON 8
ci_10                -1.400866e-02 3 1  ON 9
ci_11                 1.491140e-02 3 1  ON 10
ci_12                 1.089554e-02 3 1  ON 11
ci_13                 1.239845e-02 3 1  ON 12
ci_14                 1.310799e-02 3 1  ON 13
ci_15                 9.963079e-03 3 1  ON 14
ci_16                 1.001736e-02 3 1  ON 15
ci_17                -1.006314e-02 3 1  ON 16
ci_18                -1.002127e-02 3 1  ON 17
ci_19                 1.041090e-02 3 1  ON 18
ci_20                 9.157922e-03 3 1  ON 19
ci_21                 9.224082e-03 3 1  ON 20
ci_22                 9.489642e-03 3 1  ON 21
ci_23                 5.704379e-03 3 1  ON 22
ci_24                 5.043475e-03 3 1  ON 23
ci_25                 4.171531e-03 3 1  ON 24
ci_26                 3.831278e-03 3 1  ON 25
ci_27                 3.943208e-03 3 1  ON 26
ci_28                 3.356672e-03 3 1  ON 27
ci_29                 3.566896e-03 3 1  ON 28
ci_30                -2.697249e-03 3 1  ON 29
ci_31                -2.600272e-03 3 1  ON 30
ci_32                -2.025241e-03 3 1  ON 31
ci_33                -2.243485e-03 3 1  ON 32
ci_34                 1.614277e-03 3 1  ON 33
ci_35                 1.834111e-03 3 1  ON 34
ci_36                -1.821871e-03 3 1  ON 35
ci_37                -1.863387e-03 3 1  ON 36
ci_38                -1.326252e-03 3 1  ON 37
ci_39                -1.372404e-03 3 1  ON 38
ci_40                -1.800379e-03 3 1  ON 39
ci_41                -1.452780e-03 3 1  ON 40
ci_42                -1.250022e-03 3 1  ON 41
ci_43                -2.115808e-03 3 1  ON 42
ci_44                -1.934311e-03 3 1  ON 43
ci_45                -1.257708e-03 3 1  ON 44
ci_46                -1.206156e-03 3 1  ON 45
ci_47                -1.022629e-03 3 1  ON 46
ci_48                -9.411167e-04 3 1  ON 47
ci_49                -1.538767e-03 3 1  ON 48
ci_50                -1.261355e-03 3 1  ON 49
ci_51                 1.114423e-03 3 1  ON 50
ci_52                 1.164701e-03 3 1  ON 51
ci_53                -1.203825e-03 3 1  ON 52
ci_54                -1.099752e-03 3 1  ON 53
ci_55                -1.224801e-03 3 1  ON 54
ci_56                 1.652946e-03 3 1  ON 55
ci_57                 1.652553e-03 3 1  ON 56
ci_58                -1.033466e-03 3 1  ON 57
ci_59                -1.072713e-03 3 1  ON 58
ci_60                 7.411554e-04 3 1  ON 59
ci_61                 1.147292e-03 3 1  ON 60
ci_62                -9.529590e-04 3 1  ON 61
ci_63                -7.620726e-04 3 1  ON 62
ci_64                -8.256657e-04 3 1  ON 63
ci_65                -7.058211e-04 3 1  ON 64
ci_66                -8.487462e-04 3 1  ON 65
ci_67                -8.110042e-04 3 1  ON 66
ci_68                 7.767121e-05 3 1  ON 67
ci_69                -9.551370e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7593
    reference variance = 0.252181
====================================================
  Execution time = 4.1295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9720e-01
  Total weights = 1.9635e+06
  Execution time = 5.9619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481423261511
                                         uncertainty =       0.003441331136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481423261511
                                         uncertainty =       0.003441331136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490685064
  error estimate for blocks of size 2^( 2) =       0.000511181219
  error estimate for blocks of size 2^( 3) =       0.000531167926
  error estimate for blocks of size 2^( 4) =       0.000546196836
  error estimate for blocks of size 2^( 5) =       0.000555552143
  error estimate for blocks of size 2^( 6) =       0.000560963191
  error estimate for blocks of size 2^( 7) =       0.000562419670

      target function =      -0.646610437449
              le_mean =     -22.816351029742
             les_mean =     521.087454299830
             stat err =       0.000556282960
             autocorr =       1.285244742864
   target nu stat err =       0.000556282960
   target dn stat err =       0.005359833696
      target stat err =       0.002094478365
              std dev =       0.693933472751
             le_variance =       0.481543664604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478976132965
                                         uncertainty =       0.003455730583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478976132965
                                         uncertainty =       0.003455730583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489434316
  error estimate for blocks of size 2^( 2) =       0.000509912207
  error estimate for blocks of size 2^( 3) =       0.000529891146
  error estimate for blocks of size 2^( 4) =       0.000544953945
  error estimate for blocks of size 2^( 5) =       0.000554313212
  error estimate for blocks of size 2^( 6) =       0.000559741569
  error estimate for blocks of size 2^( 7) =       0.000561229991

      target function =      -0.648609079391
              le_mean =     -22.816373167920
             les_mean =     521.083320432596
             stat err =       0.000555059679
             autocorr =       1.286146763021
   target nu stat err =       0.000555059679
   target dn stat err =       0.004278687450
      target stat err =       0.001694012919
              std dev =       0.692164647144
             le_variance =       0.479091898757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480019345997
                                         uncertainty =       0.003445550400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480019345997
                                         uncertainty =       0.003445550400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489968001
  error estimate for blocks of size 2^( 2) =       0.000510453284
  error estimate for blocks of size 2^( 3) =       0.000530435583
  error estimate for blocks of size 2^( 4) =       0.000545482632
  error estimate for blocks of size 2^( 5) =       0.000554841016
  error estimate for blocks of size 2^( 6) =       0.000560263498
  error estimate for blocks of size 2^( 7) =       0.000561740175

      target function =      -0.648402926219
              le_mean =     -22.816352754170
             les_mean =     521.082907110209
             stat err =       0.000555581830
             autocorr =       1.285762137808
   target nu stat err =       0.000555581830
   target dn stat err =       0.004319051418
      target stat err =       0.001708344718
              std dev =       0.692919392104
             le_variance =       0.480137283954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481229668519
                                         uncertainty =       0.003441015914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481229668519
                                         uncertainty =       0.003441015914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490586265
  error estimate for blocks of size 2^( 2) =       0.000511080870
  error estimate for blocks of size 2^( 3) =       0.000531067073
  error estimate for blocks of size 2^( 4) =       0.000546098357
  error estimate for blocks of size 2^( 5) =       0.000555454778
  error estimate for blocks of size 2^( 6) =       0.000560868587
  error estimate for blocks of size 2^( 7) =       0.000562326546

      target function =      -0.644505251801
              le_mean =     -22.816349731108
             les_mean =     521.092831421753
             stat err =       0.000556187067
             autocorr =       1.285319222327
   target nu stat err =       0.000556187067
   target dn stat err =       0.009526469721
      target stat err =       0.003666773224
              std dev =       0.693793749099
             le_variance =       0.481349766288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.646610437449        initial
     3.9062e-01     3.9062e+00             2.2375e-03        -0.648609079391  <--
     1.5625e+00     1.5625e+01             5.8579e-04        -0.648402926219
     6.2500e+00     6.2500e+01             1.4820e-04        -0.644505251801

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 7.2230e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_01                 1.466281e-01 3 1  ON 0
ci_02                -4.288985e-02 3 1  ON 1
ci_03                -4.261979e-02 3 1  ON 2
ci_04                 4.032619e-02 3 1  ON 3
ci_05                -3.067064e-02 3 1  ON 4
ci_06                -3.089424e-02 3 1  ON 5
ci_07                 2.861782e-02 3 1  ON 6
ci_08                -1.192367e-02 3 1  ON 7
ci_09                -1.318762e-02 3 1  ON 8
ci_10                -1.364060e-02 3 1  ON 9
ci_11                 1.482889e-02 3 1  ON 10
ci_12                 1.064246e-02 3 1  ON 11
ci_13                 1.226993e-02 3 1  ON 12
ci_14                 1.331643e-02 3 1  ON 13
ci_15                 9.698512e-03 3 1  ON 14
ci_16                 9.655171e-03 3 1  ON 15
ci_17                -9.919130e-03 3 1  ON 16
ci_18                -9.665017e-03 3 1  ON 17
ci_19                 1.030881e-02 3 1  ON 18
ci_20                 8.971848e-03 3 1  ON 19
ci_21                 9.210213e-03 3 1  ON 20
ci_22                 9.465086e-03 3 1  ON 21
ci_23                 5.676715e-03 3 1  ON 22
ci_24                 4.924576e-03 3 1  ON 23
ci_25                 4.093951e-03 3 1  ON 24
ci_26                 3.749178e-03 3 1  ON 25
ci_27                 3.884483e-03 3 1  ON 26
ci_28                 3.277247e-03 3 1  ON 27
ci_29                 3.517909e-03 3 1  ON 28
ci_30                -2.565836e-03 3 1  ON 29
ci_31                -2.536473e-03 3 1  ON 30
ci_32                -1.955016e-03 3 1  ON 31
ci_33                -2.099722e-03 3 1  ON 32
ci_34                 1.494910e-03 3 1  ON 33
ci_35                 1.816382e-03 3 1  ON 34
ci_36                -1.804369e-03 3 1  ON 35
ci_37                -1.835597e-03 3 1  ON 36
ci_38                -1.214186e-03 3 1  ON 37
ci_39                -1.273369e-03 3 1  ON 38
ci_40                -1.766668e-03 3 1  ON 39
ci_41                -1.434387e-03 3 1  ON 40
ci_42                -1.209565e-03 3 1  ON 41
ci_43                -2.140613e-03 3 1  ON 42
ci_44                -1.844670e-03 3 1  ON 43
ci_45                -1.126898e-03 3 1  ON 44
ci_46                -1.150406e-03 3 1  ON 45
ci_47                -8.507051e-04 3 1  ON 46
ci_48                -8.473543e-04 3 1  ON 47
ci_49                -1.578115e-03 3 1  ON 48
ci_50                -1.197668e-03 3 1  ON 49
ci_51                 1.090391e-03 3 1  ON 50
ci_52                 1.238737e-03 3 1  ON 51
ci_53                -1.097852e-03 3 1  ON 52
ci_54                -1.120158e-03 3 1  ON 53
ci_55                -1.103856e-03 3 1  ON 54
ci_56                 1.652355e-03 3 1  ON 55
ci_57                 1.695466e-03 3 1  ON 56
ci_58                -1.014854e-03 3 1  ON 57
ci_59                -1.034063e-03 3 1  ON 58
ci_60                 7.717577e-04 3 1  ON 59
ci_61                 1.133733e-03 3 1  ON 60
ci_62                -9.350794e-04 3 1  ON 61
ci_63                -7.791559e-04 3 1  ON 62
ci_64                -7.588505e-04 3 1  ON 63
ci_65                -7.343283e-04 3 1  ON 64
ci_66                -8.215001e-04 3 1  ON 65
ci_67                -7.847831e-04 3 1  ON 66
ci_68                -1.231331e-05 3 1  ON 67
ci_69                -2.195464e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2266e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8087
    reference variance = 0.384961
====================================================
  Execution time = 4.2409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9140e-01
  Total weights = 1.963512660e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477720589037
                                         uncertainty =       0.002345523979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477720589037
                                         uncertainty =       0.002345523979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488692730
  error estimate for blocks of size 2^( 2) =       0.000510365714
  error estimate for blocks of size 2^( 3) =       0.000530233797
  error estimate for blocks of size 2^( 4) =       0.000545504280
  error estimate for blocks of size 2^( 5) =       0.000555437346
  error estimate for blocks of size 2^( 6) =       0.000562050307
  error estimate for blocks of size 2^( 7) =       0.000565739215

      target function =      -0.650716654215
              le_mean =     -22.816961837260
             les_mean =     521.105148532004
             stat err =       0.000557182787
             autocorr =       1.299940953917
   target nu stat err =       0.000557182787
   target dn stat err =       0.003007900547
      target stat err =       0.001222714437
              std dev =       0.691115886549
             le_variance =       0.477641168641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281696183726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650718525451       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652005751026       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652218196207       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652254701757       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652268505538       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652271884019       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652272498725       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652272549394       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652272542255       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652272516264       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652272509770       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 7.613042e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650718525451       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651135182132       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651198787519       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651208552710       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651211784380       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651212475238       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651212594009       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651212602165       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651212599294       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651212593799       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.243320e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650718525451       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650830953492       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650847644102       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650850106144       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650850884918       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650851044329       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650851071227       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650851073064       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650851072233       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650851070973       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.872656e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219148 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0071e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_01                 1.443848e-01 3 1  ON 0
ci_02                -4.109539e-02 3 1  ON 1
ci_03                -4.096643e-02 3 1  ON 2
ci_04                 3.839034e-02 3 1  ON 3
ci_05                -2.949265e-02 3 1  ON 4
ci_06                -2.985801e-02 3 1  ON 5
ci_07                 2.835486e-02 3 1  ON 6
ci_08                -1.108808e-02 3 1  ON 7
ci_09                -1.270520e-02 3 1  ON 8
ci_10                -1.314672e-02 3 1  ON 9
ci_11                 1.468672e-02 3 1  ON 10
ci_12                 1.022724e-02 3 1  ON 11
ci_13                 1.220908e-02 3 1  ON 12
ci_14                 1.337885e-02 3 1  ON 13
ci_15                 9.433091e-03 3 1  ON 14
ci_16                 9.358067e-03 3 1  ON 15
ci_17                -9.585416e-03 3 1  ON 16
ci_18                -9.398415e-03 3 1  ON 17
ci_19                 1.014881e-02 3 1  ON 18
ci_20                 8.643847e-03 3 1  ON 19
ci_21                 9.170691e-03 3 1  ON 20
ci_22                 9.382360e-03 3 1  ON 21
ci_23                 5.480407e-03 3 1  ON 22
ci_24                 4.788273e-03 3 1  ON 23
ci_25                 4.001251e-03 3 1  ON 24
ci_26                 3.622623e-03 3 1  ON 25
ci_27                 3.749409e-03 3 1  ON 26
ci_28                 3.188628e-03 3 1  ON 27
ci_29                 3.373681e-03 3 1  ON 28
ci_30                -2.413309e-03 3 1  ON 29
ci_31                -2.416698e-03 3 1  ON 30
ci_32                -1.914636e-03 3 1  ON 31
ci_33                -1.951770e-03 3 1  ON 32
ci_34                 1.436750e-03 3 1  ON 33
ci_35                 1.580409e-03 3 1  ON 34
ci_36                -1.758929e-03 3 1  ON 35
ci_37                -1.673392e-03 3 1  ON 36
ci_38                -1.138079e-03 3 1  ON 37
ci_39                -1.110158e-03 3 1  ON 38
ci_40                -1.836108e-03 3 1  ON 39
ci_41                -1.262271e-03 3 1  ON 40
ci_42                -1.023789e-03 3 1  ON 41
ci_43                -2.085948e-03 3 1  ON 42
ci_44                -1.784951e-03 3 1  ON 43
ci_45                -1.007135e-03 3 1  ON 44
ci_46                -1.056371e-03 3 1  ON 45
ci_47                -7.181767e-04 3 1  ON 46
ci_48                -6.241568e-04 3 1  ON 47
ci_49                -1.524229e-03 3 1  ON 48
ci_50                -1.171905e-03 3 1  ON 49
ci_51                 1.058887e-03 3 1  ON 50
ci_52                 1.180398e-03 3 1  ON 51
ci_53                -1.039643e-03 3 1  ON 52
ci_54                -1.064808e-03 3 1  ON 53
ci_55                -9.934352e-04 3 1  ON 54
ci_56                 1.596356e-03 3 1  ON 55
ci_57                 1.758664e-03 3 1  ON 56
ci_58                -1.020996e-03 3 1  ON 57
ci_59                -8.796293e-04 3 1  ON 58
ci_60                 8.697691e-04 3 1  ON 59
ci_61                 1.079904e-03 3 1  ON 60
ci_62                -9.171485e-04 3 1  ON 61
ci_63                -6.544840e-04 3 1  ON 62
ci_64                -7.640774e-04 3 1  ON 63
ci_65                -6.892405e-04 3 1  ON 64
ci_66                -8.290802e-04 3 1  ON 65
ci_67                -8.231953e-04 3 1  ON 66
ci_68                -2.026135e-04 3 1  ON 67
ci_69                -5.269397e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8339
    reference variance = 0.333042
====================================================
  Execution time = 4.1307e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9450e-01
  Total weights = 1.9634e+06
  Execution time = 5.9588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481185577121
                                         uncertainty =       0.002920227797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481185577121
                                         uncertainty =       0.002920227797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490503026
  error estimate for blocks of size 2^( 2) =       0.000511389690
  error estimate for blocks of size 2^( 3) =       0.000531107086
  error estimate for blocks of size 2^( 4) =       0.000545636633
  error estimate for blocks of size 2^( 5) =       0.000555691135
  error estimate for blocks of size 2^( 6) =       0.000561137239
  error estimate for blocks of size 2^( 7) =       0.000568873059

      target function =      -0.645714586628
              le_mean =     -22.818256315728
             les_mean =     521.177890077949
             stat err =       0.000557834517
             autocorr =       1.293383703122
   target nu stat err =       0.000557834517
   target dn stat err =       0.006917571730
      target stat err =       0.002687064886
              std dev =       0.693676031688
             le_variance =       0.481186436939

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.152354
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486622304497
                                         uncertainty =       0.008776862240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486622304497
                                         uncertainty =       0.008776862240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493253720
  error estimate for blocks of size 2^( 2) =       0.000513972435
  error estimate for blocks of size 2^( 3) =       0.000533586939
  error estimate for blocks of size 2^( 4) =       0.000548165723
  error estimate for blocks of size 2^( 5) =       0.000558393242
  error estimate for blocks of size 2^( 6) =       0.000563665136
  error estimate for blocks of size 2^( 7) =       0.000571583309

      target function =      -0.467130831672
              le_mean =     -22.818264072309
             les_mean =     521.729993667497
             stat err =       0.000560451852
             autocorr =       1.291028644633
   target nu stat err =       0.000560451852
   target dn stat err =       0.444786594062
      target stat err =       0.093299027976
              std dev =       0.697566101216
             le_variance =       0.486598465566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477614375868
                                         uncertainty =       0.002951263808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477614375868
                                         uncertainty =       0.002951263808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488679474
  error estimate for blocks of size 2^( 2) =       0.000509578212
  error estimate for blocks of size 2^( 3) =       0.000529319366
  error estimate for blocks of size 2^( 4) =       0.000543916232
  error estimate for blocks of size 2^( 5) =       0.000554051103
  error estimate for blocks of size 2^( 6) =       0.000559479003
  error estimate for blocks of size 2^( 7) =       0.000567209050

      target function =      -0.616340274759
              le_mean =     -22.818242268072
             les_mean =     521.255613140918
             stat err =       0.000556163847
             autocorr =       1.295261071515
   target nu stat err =       0.000556163847
   target dn stat err =       0.051283505954
      target stat err =       0.018027135306
              std dev =       0.691097140101
             le_variance =       0.477615257056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480591837673
                                         uncertainty =       0.002919671178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480591837673
                                         uncertainty =       0.002919671178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490200352
  error estimate for blocks of size 2^( 2) =       0.000511086914
  error estimate for blocks of size 2^( 3) =       0.000530806157
  error estimate for blocks of size 2^( 4) =       0.000545334515
  error estimate for blocks of size 2^( 5) =       0.000555401770
  error estimate for blocks of size 2^( 6) =       0.000560843844
  error estimate for blocks of size 2^( 7) =       0.000568580996

      target function =      -0.649162686012
              le_mean =     -22.818241718000
             les_mean =     521.168337791620
             stat err =       0.000557540281
             autocorr =       1.293615650989
   target nu stat err =       0.000557540281
   target dn stat err =       0.003449685634
      target stat err =       0.001384895977
              std dev =       0.693247986486
             le_variance =       0.480592770767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.645714586628        initial
     9.7656e-02     9.7656e-01             7.6130e-03        -0.467130831672
     3.9062e-01     3.9062e+00             2.2433e-03        -0.616340274759
     1.5625e+00     1.5625e+01             5.8727e-04        -0.649162686012  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 7.1261e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_01                 1.460409e-01 3 1  ON 0
ci_02                -4.240860e-02 3 1  ON 1
ci_03                -4.217645e-02 3 1  ON 2
ci_04                 3.980233e-02 3 1  ON 3
ci_05                -3.035331e-02 3 1  ON 4
ci_06                -3.061491e-02 3 1  ON 5
ci_07                 2.854782e-02 3 1  ON 6
ci_08                -1.169838e-02 3 1  ON 7
ci_09                -1.305909e-02 3 1  ON 8
ci_10                -1.350917e-02 3 1  ON 9
ci_11                 1.479053e-02 3 1  ON 10
ci_12                 1.053059e-02 3 1  ON 11
ci_13                 1.225374e-02 3 1  ON 12
ci_14                 1.333203e-02 3 1  ON 13
ci_15                 9.627386e-03 3 1  ON 14
ci_16                 9.575699e-03 3 1  ON 15
ci_17                -9.830571e-03 3 1  ON 16
ci_18                -9.594282e-03 3 1  ON 17
ci_19                 1.026514e-02 3 1  ON 18
ci_20                 8.883418e-03 3 1  ON 19
ci_21                 9.200040e-03 3 1  ON 20
ci_22                 9.443330e-03 3 1  ON 21
ci_23                 5.623237e-03 3 1  ON 22
ci_24                 4.888266e-03 3 1  ON 23
ci_25                 4.068862e-03 3 1  ON 24
ci_26                 3.714965e-03 3 1  ON 25
ci_27                 3.848234e-03 3 1  ON 26
ci_28                 3.254420e-03 3 1  ON 27
ci_29                 3.479929e-03 3 1  ON 28
ci_30                -2.525839e-03 3 1  ON 29
ci_31                -2.504965e-03 3 1  ON 30
ci_32                -1.943618e-03 3 1  ON 31
ci_33                -2.059077e-03 3 1  ON 32
ci_34                 1.478271e-03 3 1  ON 33
ci_35                 1.752212e-03 3 1  ON 34
ci_36                -1.792136e-03 3 1  ON 35
ci_37                -1.791935e-03 3 1  ON 36
ci_38                -1.193608e-03 3 1  ON 37
ci_39                -1.229280e-03 3 1  ON 38
ci_40                -1.785724e-03 3 1  ON 39
ci_41                -1.387075e-03 3 1  ON 40
ci_42                -1.158733e-03 3 1  ON 41
ci_43                -2.126755e-03 3 1  ON 42
ci_44                -1.829258e-03 3 1  ON 43
ci_45                -1.094567e-03 3 1  ON 44
ci_46                -1.125103e-03 3 1  ON 45
ci_47                -8.160296e-04 3 1  ON 46
ci_48                -7.886465e-04 3 1  ON 47
ci_49                -1.563612e-03 3 1  ON 48
ci_50                -1.190679e-03 3 1  ON 49
ci_51                 1.082058e-03 3 1  ON 50
ci_52                 1.223120e-03 3 1  ON 51
ci_53                -1.082142e-03 3 1  ON 52
ci_54                -1.105432e-03 3 1  ON 53
ci_55                -1.073977e-03 3 1  ON 54
ci_56                 1.637071e-03 3 1  ON 55
ci_57                 1.712458e-03 3 1  ON 56
ci_58                -1.016378e-03 3 1  ON 57
ci_59                -9.923381e-04 3 1  ON 58
ci_60                 7.970662e-04 3 1  ON 59
ci_61                 1.119916e-03 3 1  ON 60
ci_62                -9.305139e-04 3 1  ON 61
ci_63                -7.454026e-04 3 1  ON 62
ci_64                -7.605427e-04 3 1  ON 63
ci_65                -7.221853e-04 3 1  ON 64
ci_66                -8.237393e-04 3 1  ON 65
ci_67                -7.951930e-04 3 1  ON 66
ci_68                -6.343952e-05 3 1  ON 67
ci_69                -3.022633e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2135e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8176
    reference variance = 0.59886
====================================================
  Execution time = 4.2484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9812e-01
  Total weights = 1.963778472e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481632881399
                                         uncertainty =       0.002341869074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481632881399
                                         uncertainty =       0.002341869074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490715230
  error estimate for blocks of size 2^( 2) =       0.000511580627
  error estimate for blocks of size 2^( 3) =       0.000531672421
  error estimate for blocks of size 2^( 4) =       0.000546016035
  error estimate for blocks of size 2^( 5) =       0.000556251208
  error estimate for blocks of size 2^( 6) =       0.000560178792
  error estimate for blocks of size 2^( 7) =       0.000562949032

      target function =      -0.648017710600
              le_mean =     -22.816625496519
             les_mean =     521.096521111967
             stat err =       0.000556348767
             autocorr =       1.285390794843
   target nu stat err =       0.000556348767
   target dn stat err =       0.003359966711
      target stat err =       0.001344205482
              std dev =       0.693976133376
             le_variance =       0.481602873695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281662549652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648020094820       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648413714017       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648480103114       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648488694062       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648490724633       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648491154707       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648491204926       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648491195188       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648491191548       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.124835e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648020094820       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648126354224       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648143796109       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648145956841       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648146440513       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648146537227       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648146546150       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648146543645       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648146542764       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.562753e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648020094820       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648047200103       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648051615869       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648052156319       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648052275494       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648052298951       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648052300955       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648052300326       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648052300108       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.407333e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0150e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_01                 1.454846e-01 3 1  ON 0
ci_02                -4.191791e-02 3 1  ON 1
ci_03                -4.177896e-02 3 1  ON 2
ci_04                 3.928521e-02 3 1  ON 3
ci_05                -3.007010e-02 3 1  ON 4
ci_06                -3.029679e-02 3 1  ON 5
ci_07                 2.848831e-02 3 1  ON 6
ci_08                -1.145221e-02 3 1  ON 7
ci_09                -1.290059e-02 3 1  ON 8
ci_10                -1.340387e-02 3 1  ON 9
ci_11                 1.476312e-02 3 1  ON 10
ci_12                 1.041142e-02 3 1  ON 11
ci_13                 1.223324e-02 3 1  ON 12
ci_14                 1.332130e-02 3 1  ON 13
ci_15                 9.550822e-03 3 1  ON 14
ci_16                 9.482017e-03 3 1  ON 15
ci_17                -9.735073e-03 3 1  ON 16
ci_18                -9.551969e-03 3 1  ON 17
ci_19                 1.020799e-02 3 1  ON 18
ci_20                 8.856613e-03 3 1  ON 19
ci_21                 9.170504e-03 3 1  ON 20
ci_22                 9.415482e-03 3 1  ON 21
ci_23                 5.602174e-03 3 1  ON 22
ci_24                 4.868018e-03 3 1  ON 23
ci_25                 4.034228e-03 3 1  ON 24
ci_26                 3.689038e-03 3 1  ON 25
ci_27                 3.845874e-03 3 1  ON 26
ci_28                 3.242420e-03 3 1  ON 27
ci_29                 3.374504e-03 3 1  ON 28
ci_30                -2.476101e-03 3 1  ON 29
ci_31                -2.469504e-03 3 1  ON 30
ci_32                -1.933347e-03 3 1  ON 31
ci_33                -2.024568e-03 3 1  ON 32
ci_34                 1.434246e-03 3 1  ON 33
ci_35                 1.740328e-03 3 1  ON 34
ci_36                -1.780009e-03 3 1  ON 35
ci_37                -1.781855e-03 3 1  ON 36
ci_38                -1.183231e-03 3 1  ON 37
ci_39                -1.207524e-03 3 1  ON 38
ci_40                -1.784611e-03 3 1  ON 39
ci_41                -1.375872e-03 3 1  ON 40
ci_42                -1.147563e-03 3 1  ON 41
ci_43                -2.134523e-03 3 1  ON 42
ci_44                -1.838732e-03 3 1  ON 43
ci_45                -1.076490e-03 3 1  ON 44
ci_46                -1.095489e-03 3 1  ON 45
ci_47                -7.950267e-04 3 1  ON 46
ci_48                -7.986801e-04 3 1  ON 47
ci_49                -1.546984e-03 3 1  ON 48
ci_50                -1.180130e-03 3 1  ON 49
ci_51                 1.072613e-03 3 1  ON 50
ci_52                 1.198256e-03 3 1  ON 51
ci_53                -1.086971e-03 3 1  ON 52
ci_54                -1.101262e-03 3 1  ON 53
ci_55                -1.079364e-03 3 1  ON 54
ci_56                 1.624796e-03 3 1  ON 55
ci_57                 1.721141e-03 3 1  ON 56
ci_58                -1.021195e-03 3 1  ON 57
ci_59                -9.843193e-04 3 1  ON 58
ci_60                 7.711262e-04 3 1  ON 59
ci_61                 1.123989e-03 3 1  ON 60
ci_62                -8.988905e-04 3 1  ON 61
ci_63                -7.325118e-04 3 1  ON 62
ci_64                -7.455894e-04 3 1  ON 63
ci_65                -7.180999e-04 3 1  ON 64
ci_66                -8.402616e-04 3 1  ON 65
ci_67                -7.750319e-04 3 1  ON 66
ci_68                -1.084928e-04 3 1  ON 67
ci_69                -3.011660e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.9404
    reference variance = 0.876413
====================================================
  Execution time = 4.1308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.0026e-01
  Total weights = 1.9631e+06
  Execution time = 5.9448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483479199238
                                         uncertainty =       0.002643773890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483479199238
                                         uncertainty =       0.002643773890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491668088
  error estimate for blocks of size 2^( 2) =       0.000512747965
  error estimate for blocks of size 2^( 3) =       0.000532890909
  error estimate for blocks of size 2^( 4) =       0.000547614596
  error estimate for blocks of size 2^( 5) =       0.000557108145
  error estimate for blocks of size 2^( 6) =       0.000564262373
  error estimate for blocks of size 2^( 7) =       0.000567565675

      target function =      -0.647426896460
              le_mean =     -22.818022619766
             les_mean =     521.162670956058
             stat err =       0.000559137697
             autocorr =       1.293282808793
   target nu stat err =       0.000559137697
   target dn stat err =       0.003436240406
      target stat err =       0.001372616218
              std dev =       0.695323678149
             le_variance =       0.483475017394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481533275429
                                         uncertainty =       0.002628326495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481533275429
                                         uncertainty =       0.002628326495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490677685
  error estimate for blocks of size 2^( 2) =       0.000511751127
  error estimate for blocks of size 2^( 3) =       0.000531893863
  error estimate for blocks of size 2^( 4) =       0.000546642270
  error estimate for blocks of size 2^( 5) =       0.000556133635
  error estimate for blocks of size 2^( 6) =       0.000563261625
  error estimate for blocks of size 2^( 7) =       0.000566494626

      target function =      -0.644884569026
              le_mean =     -22.818040284806
             les_mean =     521.170049768191
             stat err =       0.000558133039
             autocorr =       1.293846775213
   target nu stat err =       0.000558133039
   target dn stat err =       0.007515900306
      target stat err =       0.002908056333
              std dev =       0.693923036819
             le_variance =       0.481529181028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482355491453
                                         uncertainty =       0.002634339598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482355491453
                                         uncertainty =       0.002634339598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491096433
  error estimate for blocks of size 2^( 2) =       0.000512170237
  error estimate for blocks of size 2^( 3) =       0.000532314923
  error estimate for blocks of size 2^( 4) =       0.000547052572
  error estimate for blocks of size 2^( 5) =       0.000556552514
  error estimate for blocks of size 2^( 6) =       0.000563695993
  error estimate for blocks of size 2^( 7) =       0.000566965644

      target function =      -0.646243109107
              le_mean =     -22.818024413401
             les_mean =     521.165809460540
             stat err =       0.000558566681
             autocorr =       1.293649106353
   target nu stat err =       0.000558566681
   target dn stat err =       0.004637530778
      target stat err =       0.001820870758
              std dev =       0.694515235409
             le_variance =       0.482351412215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483327409559
                                         uncertainty =       0.002642438174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483327409559
                                         uncertainty =       0.002642438174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491590911
  error estimate for blocks of size 2^( 2) =       0.000512669873
  error estimate for blocks of size 2^( 3) =       0.000532813042
  error estimate for blocks of size 2^( 4) =       0.000547538460
  error estimate for blocks of size 2^( 5) =       0.000557032437
  error estimate for blocks of size 2^( 6) =       0.000564185297
  error estimate for blocks of size 2^( 7) =       0.000567484476

      target function =      -0.647492708559
              le_mean =     -22.818021895531
             les_mean =     521.162467523232
             stat err =       0.000559060167
             autocorr =       1.293330180370
   target nu stat err =       0.000559060167
   target dn stat err =       0.003453608666
      target stat err =       0.001379402822
              std dev =       0.695214532818
             le_variance =       0.483323246642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647426896460        initial
     3.9062e-01     3.9062e+00             2.1248e-03        -0.644884569026
     1.5625e+00     1.5625e+01             5.5628e-04        -0.646243109107
     6.2500e+00     6.2500e+01             1.4073e-04        -0.647492708559  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.1718e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_01                 1.459001e-01 3 1  ON 0
ci_02                -4.228369e-02 3 1  ON 1
ci_03                -4.207525e-02 3 1  ON 2
ci_04                 3.967034e-02 3 1  ON 3
ci_05                -3.028111e-02 3 1  ON 4
ci_06                -3.053384e-02 3 1  ON 5
ci_07                 2.853268e-02 3 1  ON 6
ci_08                -1.163555e-02 3 1  ON 7
ci_09                -1.301877e-02 3 1  ON 8
ci_10                -1.348243e-02 3 1  ON 9
ci_11                 1.478353e-02 3 1  ON 10
ci_12                 1.050021e-02 3 1  ON 11
ci_13                 1.224853e-02 3 1  ON 12
ci_14                 1.332927e-02 3 1  ON 13
ci_15                 9.607912e-03 3 1  ON 14
ci_16                 9.551837e-03 3 1  ON 15
ci_17                -9.806302e-03 3 1  ON 16
ci_18                -9.583561e-03 3 1  ON 17
ci_19                 1.025052e-02 3 1  ON 18
ci_20                 8.876588e-03 3 1  ON 19
ci_21                 9.192562e-03 3 1  ON 20
ci_22                 9.436279e-03 3 1  ON 21
ci_23                 5.617837e-03 3 1  ON 22
ci_24                 4.883123e-03 3 1  ON 23
ci_25                 4.060021e-03 3 1  ON 24
ci_26                 3.708356e-03 3 1  ON 25
ci_27                 3.847622e-03 3 1  ON 26
ci_28                 3.251406e-03 3 1  ON 27
ci_29                 3.453121e-03 3 1  ON 28
ci_30                -2.513238e-03 3 1  ON 29
ci_31                -2.495996e-03 3 1  ON 30
ci_32                -1.940968e-03 3 1  ON 31
ci_33                -2.050222e-03 3 1  ON 32
ci_34                 1.466997e-03 3 1  ON 33
ci_35                 1.749112e-03 3 1  ON 34
ci_36                -1.789052e-03 3 1  ON 35
ci_37                -1.789379e-03 3 1  ON 36
ci_38                -1.190966e-03 3 1  ON 37
ci_39                -1.223736e-03 3 1  ON 38
ci_40                -1.785447e-03 3 1  ON 39
ci_41                -1.384174e-03 3 1  ON 40
ci_42                -1.155836e-03 3 1  ON 41
ci_43                -2.128761e-03 3 1  ON 42
ci_44                -1.831712e-03 3 1  ON 43
ci_45                -1.089965e-03 3 1  ON 44
ci_46                -1.117554e-03 3 1  ON 45
ci_47                -8.107375e-04 3 1  ON 46
ci_48                -7.912307e-04 3 1  ON 47
ci_49                -1.559387e-03 3 1  ON 48
ci_50                -1.187987e-03 3 1  ON 49
ci_51                 1.079656e-03 3 1  ON 50
ci_52                 1.216783e-03 3 1  ON 51
ci_53                -1.083384e-03 3 1  ON 52
ci_54                -1.104377e-03 3 1  ON 53
ci_55                -1.075360e-03 3 1  ON 54
ci_56                 1.633927e-03 3 1  ON 55
ci_57                 1.714678e-03 3 1  ON 56
ci_58                -1.017618e-03 3 1  ON 57
ci_59                -9.902991e-04 3 1  ON 58
ci_60                 7.905030e-04 3 1  ON 59
ci_61                 1.120951e-03 3 1  ON 60
ci_62                -9.224434e-04 3 1  ON 61
ci_63                -7.421203e-04 3 1  ON 62
ci_64                -7.567111e-04 3 1  ON 63
ci_65                -7.211636e-04 3 1  ON 64
ci_66                -8.279642e-04 3 1  ON 65
ci_67                -7.900518e-04 3 1  ON 66
ci_68                -7.489968e-05 3 1  ON 67
ci_69                -3.019894e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2188e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8785
    reference variance = 0.655294
====================================================
  Execution time = 4.4025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9648e-01
  Total weights = 1.963113172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481360239312
                                         uncertainty =       0.003846322577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481360239312
                                         uncertainty =       0.003846322577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490565188
  error estimate for blocks of size 2^( 2) =       0.000511233153
  error estimate for blocks of size 2^( 3) =       0.000530513156
  error estimate for blocks of size 2^( 4) =       0.000544974805
  error estimate for blocks of size 2^( 5) =       0.000554384827
  error estimate for blocks of size 2^( 6) =       0.000560182664
  error estimate for blocks of size 2^( 7) =       0.000561183495

      target function =      -0.648392041968
              le_mean =     -22.815556282043
             les_mean =     521.046087655132
             stat err =       0.000555181448
             autocorr =       1.280785604803
   target nu stat err =       0.000555181448
   target dn stat err =       0.005117229640
      target stat err =       0.002011421722
              std dev =       0.693763942104
             le_variance =       0.481308407363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281555628204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648397855939       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648493050871       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648507754241       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648510143670       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648510605587       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648510713345       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648510737539       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648510739312       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648510740583       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648510740739       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.232350e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648397855939       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648422133355       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648425855304       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648426454381       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648426568158       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648426594129       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648426599885       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648426600309       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648426600616       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.323726e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648397855939       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648403955960       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648404889362       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648405039231       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648405067565       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648405073996       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648405075417       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648405075521       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648405075597       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 3.319325e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1658e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_01                 1.457678e-01 3 1  ON 0
ci_02                -4.217802e-02 3 1  ON 1
ci_03                -4.196321e-02 3 1  ON 2
ci_04                 3.954564e-02 3 1  ON 3
ci_05                -3.020464e-02 3 1  ON 4
ci_06                -3.046401e-02 3 1  ON 5
ci_07                 2.851439e-02 3 1  ON 6
ci_08                -1.158577e-02 3 1  ON 7
ci_09                -1.298588e-02 3 1  ON 8
ci_10                -1.345416e-02 3 1  ON 9
ci_11                 1.476806e-02 3 1  ON 10
ci_12                 1.047735e-02 3 1  ON 11
ci_13                 1.224696e-02 3 1  ON 12
ci_14                 1.333706e-02 3 1  ON 13
ci_15                 9.588622e-03 3 1  ON 14
ci_16                 9.531536e-03 3 1  ON 15
ci_17                -9.793127e-03 3 1  ON 16
ci_18                -9.571827e-03 3 1  ON 17
ci_19                 1.024871e-02 3 1  ON 18
ci_20                 8.856847e-03 3 1  ON 19
ci_21                 9.186421e-03 3 1  ON 20
ci_22                 9.437416e-03 3 1  ON 21
ci_23                 5.611222e-03 3 1  ON 22
ci_24                 4.881011e-03 3 1  ON 23
ci_25                 4.053081e-03 3 1  ON 24
ci_26                 3.700931e-03 3 1  ON 25
ci_27                 3.839999e-03 3 1  ON 26
ci_28                 3.246711e-03 3 1  ON 27
ci_29                 3.439052e-03 3 1  ON 28
ci_30                -2.504722e-03 3 1  ON 29
ci_31                -2.484699e-03 3 1  ON 30
ci_32                -1.926626e-03 3 1  ON 31
ci_33                -2.031333e-03 3 1  ON 32
ci_34                 1.456322e-03 3 1  ON 33
ci_35                 1.740117e-03 3 1  ON 34
ci_36                -1.779608e-03 3 1  ON 35
ci_37                -1.783145e-03 3 1  ON 36
ci_38                -1.182655e-03 3 1  ON 37
ci_39                -1.218165e-03 3 1  ON 38
ci_40                -1.777663e-03 3 1  ON 39
ci_41                -1.388286e-03 3 1  ON 40
ci_42                -1.146366e-03 3 1  ON 41
ci_43                -2.136418e-03 3 1  ON 42
ci_44                -1.847840e-03 3 1  ON 43
ci_45                -1.081411e-03 3 1  ON 44
ci_46                -1.119795e-03 3 1  ON 45
ci_47                -7.935727e-04 3 1  ON 46
ci_48                -7.765587e-04 3 1  ON 47
ci_49                -1.553441e-03 3 1  ON 48
ci_50                -1.184800e-03 3 1  ON 49
ci_51                 1.074947e-03 3 1  ON 50
ci_52                 1.210179e-03 3 1  ON 51
ci_53                -1.084289e-03 3 1  ON 52
ci_54                -1.107632e-03 3 1  ON 53
ci_55                -1.080852e-03 3 1  ON 54
ci_56                 1.632498e-03 3 1  ON 55
ci_57                 1.715159e-03 3 1  ON 56
ci_58                -1.021824e-03 3 1  ON 57
ci_59                -9.935373e-04 3 1  ON 58
ci_60                 7.930528e-04 3 1  ON 59
ci_61                 1.113049e-03 3 1  ON 60
ci_62                -9.116009e-04 3 1  ON 61
ci_63                -7.392558e-04 3 1  ON 62
ci_64                -7.604431e-04 3 1  ON 63
ci_65                -7.268628e-04 3 1  ON 64
ci_66                -8.310367e-04 3 1  ON 65
ci_67                -7.909493e-04 3 1  ON 66
ci_68                -8.126955e-05 3 1  ON 67
ci_69                -3.124785e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8007
    reference variance = 0.475505
====================================================
  Execution time = 4.1229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9825e-01
  Total weights = 1.9632e+06
  Execution time = 5.9482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480391389122
                                         uncertainty =       0.003024313252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480391389122
                                         uncertainty =       0.003024313252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490059303
  error estimate for blocks of size 2^( 2) =       0.000510515044
  error estimate for blocks of size 2^( 3) =       0.000530433800
  error estimate for blocks of size 2^( 4) =       0.000545729650
  error estimate for blocks of size 2^( 5) =       0.000554469380
  error estimate for blocks of size 2^( 6) =       0.000559363633
  error estimate for blocks of size 2^( 7) =       0.000560732440

      target function =      -0.647601553482
              le_mean =     -22.816394038684
             les_mean =     521.086886106033
             stat err =       0.000555073776
             autocorr =       1.282933495613
   target nu stat err =       0.000555073776
   target dn stat err =       0.004041237706
      target stat err =       0.001598879969
              std dev =       0.693048512070
             le_variance =       0.480316240083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479850854968
                                         uncertainty =       0.003013943417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479850854968
                                         uncertainty =       0.003013943417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489783543
  error estimate for blocks of size 2^( 2) =       0.000510239453
  error estimate for blocks of size 2^( 3) =       0.000530159933
  error estimate for blocks of size 2^( 4) =       0.000545462069
  error estimate for blocks of size 2^( 5) =       0.000554204498
  error estimate for blocks of size 2^( 6) =       0.000559098550
  error estimate for blocks of size 2^( 7) =       0.000560475274

      target function =      -0.647727602298
              le_mean =     -22.816395646141
             les_mean =     521.086634810325
             stat err =       0.000554810098
             autocorr =       1.283158591488
   target nu stat err =       0.000554810098
   target dn stat err =       0.004047239821
      target stat err =       0.001601732244
              std dev =       0.692658529536
             le_variance =       0.479775838539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480112111266
                                         uncertainty =       0.003018978070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480112111266
                                         uncertainty =       0.003018978070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489916846
  error estimate for blocks of size 2^( 2) =       0.000510372678
  error estimate for blocks of size 2^( 3) =       0.000530292332
  error estimate for blocks of size 2^( 4) =       0.000545591339
  error estimate for blocks of size 2^( 5) =       0.000554332444
  error estimate for blocks of size 2^( 6) =       0.000559226536
  error estimate for blocks of size 2^( 7) =       0.000560599183

      target function =      -0.647978860369
              le_mean =     -22.816394412707
             les_mean =     521.085929448357
             stat err =       0.000554937376
             autocorr =       1.283048892485
   target nu stat err =       0.000554937376
   target dn stat err =       0.003966679868
      target stat err =       0.001572435958
              std dev =       0.692847047755
             le_variance =       0.480037031583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480355861311
                                         uncertainty =       0.003023638282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480355861311
                                         uncertainty =       0.003023638282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490041183
  error estimate for blocks of size 2^( 2) =       0.000510496929
  error estimate for blocks of size 2^( 3) =       0.000530415793
  error estimate for blocks of size 2^( 4) =       0.000545712036
  error estimate for blocks of size 2^( 5) =       0.000554451954
  error estimate for blocks of size 2^( 6) =       0.000559346179
  error estimate for blocks of size 2^( 7) =       0.000560715459

      target function =      -0.647771754329
              le_mean =     -22.816394023427
             les_mean =     521.086446021997
             stat err =       0.000555056407
             autocorr =       1.282948081482
   target nu stat err =       0.000555056407
   target dn stat err =       0.003984907992
      target stat err =       0.001578368009
              std dev =       0.693022886498
             le_variance =       0.480280721210


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647601553482        initial
     1.5625e+00     1.5625e+01             5.2323e-04        -0.647727602298
     6.2500e+00     6.2500e+01             1.3237e-04        -0.647978860369  <--
     2.5000e+01     2.5000e+02             3.3193e-05        -0.647771754329

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.1027e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_01                 1.457678e-01 3 1  ON 0
ci_02                -4.217802e-02 3 1  ON 1
ci_03                -4.196321e-02 3 1  ON 2
ci_04                 3.954564e-02 3 1  ON 3
ci_05                -3.020464e-02 3 1  ON 4
ci_06                -3.046401e-02 3 1  ON 5
ci_07                 2.851439e-02 3 1  ON 6
ci_08                -1.158577e-02 3 1  ON 7
ci_09                -1.298588e-02 3 1  ON 8
ci_10                -1.345416e-02 3 1  ON 9
ci_11                 1.476806e-02 3 1  ON 10
ci_12                 1.047735e-02 3 1  ON 11
ci_13                 1.224696e-02 3 1  ON 12
ci_14                 1.333706e-02 3 1  ON 13
ci_15                 9.588622e-03 3 1  ON 14
ci_16                 9.531536e-03 3 1  ON 15
ci_17                -9.793127e-03 3 1  ON 16
ci_18                -9.571827e-03 3 1  ON 17
ci_19                 1.024871e-02 3 1  ON 18
ci_20                 8.856847e-03 3 1  ON 19
ci_21                 9.186421e-03 3 1  ON 20
ci_22                 9.437416e-03 3 1  ON 21
ci_23                 5.611222e-03 3 1  ON 22
ci_24                 4.881011e-03 3 1  ON 23
ci_25                 4.053081e-03 3 1  ON 24
ci_26                 3.700931e-03 3 1  ON 25
ci_27                 3.839999e-03 3 1  ON 26
ci_28                 3.246711e-03 3 1  ON 27
ci_29                 3.439052e-03 3 1  ON 28
ci_30                -2.504722e-03 3 1  ON 29
ci_31                -2.484699e-03 3 1  ON 30
ci_32                -1.926626e-03 3 1  ON 31
ci_33                -2.031333e-03 3 1  ON 32
ci_34                 1.456322e-03 3 1  ON 33
ci_35                 1.740117e-03 3 1  ON 34
ci_36                -1.779608e-03 3 1  ON 35
ci_37                -1.783145e-03 3 1  ON 36
ci_38                -1.182655e-03 3 1  ON 37
ci_39                -1.218165e-03 3 1  ON 38
ci_40                -1.777663e-03 3 1  ON 39
ci_41                -1.388286e-03 3 1  ON 40
ci_42                -1.146366e-03 3 1  ON 41
ci_43                -2.136418e-03 3 1  ON 42
ci_44                -1.847840e-03 3 1  ON 43
ci_45                -1.081411e-03 3 1  ON 44
ci_46                -1.119795e-03 3 1  ON 45
ci_47                -7.935727e-04 3 1  ON 46
ci_48                -7.765587e-04 3 1  ON 47
ci_49                -1.553441e-03 3 1  ON 48
ci_50                -1.184800e-03 3 1  ON 49
ci_51                 1.074947e-03 3 1  ON 50
ci_52                 1.210179e-03 3 1  ON 51
ci_53                -1.084289e-03 3 1  ON 52
ci_54                -1.107632e-03 3 1  ON 53
ci_55                -1.080852e-03 3 1  ON 54
ci_56                 1.632498e-03 3 1  ON 55
ci_57                 1.715159e-03 3 1  ON 56
ci_58                -1.021824e-03 3 1  ON 57
ci_59                -9.935373e-04 3 1  ON 58
ci_60                 7.930528e-04 3 1  ON 59
ci_61                 1.113049e-03 3 1  ON 60
ci_62                -9.116009e-04 3 1  ON 61
ci_63                -7.392558e-04 3 1  ON 62
ci_64                -7.604431e-04 3 1  ON 63
ci_65                -7.268628e-04 3 1  ON 64
ci_66                -8.310367e-04 3 1  ON 65
ci_67                -7.909493e-04 3 1  ON 66
ci_68                -8.126955e-05 3 1  ON 67
ci_69                -3.124785e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2269e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7331
    reference variance = 0.99046
====================================================
  Execution time = 4.2437e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 5.0648e-01
  Total weights = 1.963568751e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483964395937
                                         uncertainty =       0.004504470967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483964395937
                                         uncertainty =       0.004504470967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491889759
  error estimate for blocks of size 2^( 2) =       0.000512749913
  error estimate for blocks of size 2^( 3) =       0.000532077325
  error estimate for blocks of size 2^( 4) =       0.000547167879
  error estimate for blocks of size 2^( 5) =       0.000555856997
  error estimate for blocks of size 2^( 6) =       0.000562371331
  error estimate for blocks of size 2^( 7) =       0.000568391224

      target function =      -0.644846002300
              le_mean =     -22.816879931711
             les_mean =     521.116494126035
             stat err =       0.000558446858
             autocorr =       1.288926468996
   target nu stat err =       0.000558446858
   target dn stat err =       0.006359673531
      target stat err =       0.002464143106
              std dev =       0.695637167721
             le_variance =       0.483911069115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281687993171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.644855041139       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644947270266       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644962514042       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644964713257       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644965512608       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644965779054       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644965815862       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644965812198       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644965808643       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644965807841       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 5.606703e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.644855041139       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644878560578       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644882417715       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644882968821       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644883166960       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644883231770       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644883240612       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644883239685       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644883238810       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644883238617       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.418055e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.644855041139       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.644860950605       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.644861917806       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.644862055656       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.644862105079       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644862121166       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.644862123354       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.644862123122       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.644862122904       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.644862122856       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 3.555532e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0066e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_01                 1.456260e-01 3 1  ON 0
ci_02                -4.207002e-02 3 1  ON 1
ci_03                -4.184690e-02 3 1  ON 2
ci_04                 3.942652e-02 3 1  ON 3
ci_05                -3.014006e-02 3 1  ON 4
ci_06                -3.039299e-02 3 1  ON 5
ci_07                 2.849772e-02 3 1  ON 6
ci_08                -1.153353e-02 3 1  ON 7
ci_09                -1.295611e-02 3 1  ON 8
ci_10                -1.342555e-02 3 1  ON 9
ci_11                 1.476712e-02 3 1  ON 10
ci_12                 1.045736e-02 3 1  ON 11
ci_13                 1.225298e-02 3 1  ON 12
ci_14                 1.335388e-02 3 1  ON 13
ci_15                 9.560641e-03 3 1  ON 14
ci_16                 9.520682e-03 3 1  ON 15
ci_17                -9.771140e-03 3 1  ON 16
ci_18                -9.555558e-03 3 1  ON 17
ci_19                 1.023207e-02 3 1  ON 18
ci_20                 8.839473e-03 3 1  ON 19
ci_21                 9.182161e-03 3 1  ON 20
ci_22                 9.436113e-03 3 1  ON 21
ci_23                 5.603371e-03 3 1  ON 22
ci_24                 4.878591e-03 3 1  ON 23
ci_25                 4.038618e-03 3 1  ON 24
ci_26                 3.703089e-03 3 1  ON 25
ci_27                 3.836480e-03 3 1  ON 26
ci_28                 3.241579e-03 3 1  ON 27
ci_29                 3.426617e-03 3 1  ON 28
ci_30                -2.497050e-03 3 1  ON 29
ci_31                -2.480371e-03 3 1  ON 30
ci_32                -1.900866e-03 3 1  ON 31
ci_33                -2.019355e-03 3 1  ON 32
ci_34                 1.455881e-03 3 1  ON 33
ci_35                 1.739394e-03 3 1  ON 34
ci_36                -1.762481e-03 3 1  ON 35
ci_37                -1.781390e-03 3 1  ON 36
ci_38                -1.186756e-03 3 1  ON 37
ci_39                -1.220965e-03 3 1  ON 38
ci_40                -1.775970e-03 3 1  ON 39
ci_41                -1.386725e-03 3 1  ON 40
ci_42                -1.139803e-03 3 1  ON 41
ci_43                -2.143771e-03 3 1  ON 42
ci_44                -1.853767e-03 3 1  ON 43
ci_45                -1.076420e-03 3 1  ON 44
ci_46                -1.117950e-03 3 1  ON 45
ci_47                -7.852951e-04 3 1  ON 46
ci_48                -7.654979e-04 3 1  ON 47
ci_49                -1.547179e-03 3 1  ON 48
ci_50                -1.177535e-03 3 1  ON 49
ci_51                 1.070687e-03 3 1  ON 50
ci_52                 1.199381e-03 3 1  ON 51
ci_53                -1.089005e-03 3 1  ON 52
ci_54                -1.113409e-03 3 1  ON 53
ci_55                -1.072961e-03 3 1  ON 54
ci_56                 1.631719e-03 3 1  ON 55
ci_57                 1.713056e-03 3 1  ON 56
ci_58                -1.013434e-03 3 1  ON 57
ci_59                -9.898317e-04 3 1  ON 58
ci_60                 7.944455e-04 3 1  ON 59
ci_61                 1.119438e-03 3 1  ON 60
ci_62                -9.147402e-04 3 1  ON 61
ci_63                -7.351514e-04 3 1  ON 62
ci_64                -7.619828e-04 3 1  ON 63
ci_65                -7.239320e-04 3 1  ON 64
ci_66                -8.244457e-04 3 1  ON 65
ci_67                -7.893566e-04 3 1  ON 66
ci_68                -9.441872e-05 3 1  ON 67
ci_69                -3.198542e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8558
    reference variance = 0.383993
====================================================
  Execution time = 4.1269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0056e-01
  Total weights = 1.9630e+06
  Execution time = 5.9225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478787082881
                                         uncertainty =       0.002493941700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478787082881
                                         uncertainty =       0.002493941700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489369426
  error estimate for blocks of size 2^( 2) =       0.000510120831
  error estimate for blocks of size 2^( 3) =       0.000530423338
  error estimate for blocks of size 2^( 4) =       0.000545148108
  error estimate for blocks of size 2^( 5) =       0.000554752403
  error estimate for blocks of size 2^( 6) =       0.000559645792
  error estimate for blocks of size 2^( 7) =       0.000562698269

      target function =      -0.647083477081
              le_mean =     -22.815766574303
             les_mean =     521.059200855186
             stat err =       0.000555561143
             autocorr =       1.288813451182
   target nu stat err =       0.000555561143
   target dn stat err =       0.004410857615
      target stat err =       0.001735396763
              std dev =       0.692072879052
             le_variance =       0.478964869919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478300839341
                                         uncertainty =       0.002492565055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478300839341
                                         uncertainty =       0.002492565055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489121059
  error estimate for blocks of size 2^( 2) =       0.000509869677
  error estimate for blocks of size 2^( 3) =       0.000530173518
  error estimate for blocks of size 2^( 4) =       0.000544896166
  error estimate for blocks of size 2^( 5) =       0.000554497677
  error estimate for blocks of size 2^( 6) =       0.000559402297
  error estimate for blocks of size 2^( 7) =       0.000562455206

      target function =      -0.643444250900
              le_mean =     -22.815768450708
             les_mean =     521.068687661994
             stat err =       0.000555312836
             autocorr =       1.288969679610
   target nu stat err =       0.000555312836
   target dn stat err =       0.012208152673
      target stat err =       0.004673634713
              std dev =       0.691721635319
             le_variance =       0.478478820769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478534600548
                                         uncertainty =       0.002493079863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478534600548
                                         uncertainty =       0.002493079863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489240478
  error estimate for blocks of size 2^( 2) =       0.000509990421
  error estimate for blocks of size 2^( 3) =       0.000530293741
  error estimate for blocks of size 2^( 4) =       0.000545017599
  error estimate for blocks of size 2^( 5) =       0.000554620966
  error estimate for blocks of size 2^( 6) =       0.000559519623
  error estimate for blocks of size 2^( 7) =       0.000562571626

      target function =      -0.646423779713
              le_mean =     -22.815766871948
             les_mean =     521.060917941547
             stat err =       0.000555432453
             autocorr =       1.288895593684
   target nu stat err =       0.000555432453
   target dn stat err =       0.005537288690
      target stat err =       0.002159634649
              std dev =       0.691890519734
             le_variance =       0.478712491298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478754897644
                                         uncertainty =       0.002493818040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478754897644
                                         uncertainty =       0.002493818040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489352990
  error estimate for blocks of size 2^( 2) =       0.000510104205
  error estimate for blocks of size 2^( 3) =       0.000530406822
  error estimate for blocks of size 2^( 4) =       0.000545131481
  error estimate for blocks of size 2^( 5) =       0.000554735680
  error estimate for blocks of size 2^( 6) =       0.000559629715
  error estimate for blocks of size 2^( 7) =       0.000562682089

      target function =      -0.647042132816
              le_mean =     -22.815766546274
             les_mean =     521.059306284602
             stat err =       0.000555544741
             autocorr =       1.288823923000
   target nu stat err =       0.000555544741
   target dn stat err =       0.004475003621
      target stat err =       0.001759496886
              std dev =       0.692049635674
             le_variance =       0.478932698237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647083477081        initial  <--
     1.5625e+00     1.5625e+01             5.6067e-04        -0.643444250900
     6.2500e+00     6.2500e+01             1.4181e-04        -0.646423779713
     2.5000e+01     2.5000e+02             3.5555e-05        -0.647042132816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.9570
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_01                 1.457678e-01 3 1  ON 0
ci_02                -4.217802e-02 3 1  ON 1
ci_03                -4.196321e-02 3 1  ON 2
ci_04                 3.954564e-02 3 1  ON 3
ci_05                -3.020464e-02 3 1  ON 4
ci_06                -3.046401e-02 3 1  ON 5
ci_07                 2.851439e-02 3 1  ON 6
ci_08                -1.158577e-02 3 1  ON 7
ci_09                -1.298588e-02 3 1  ON 8
ci_10                -1.345416e-02 3 1  ON 9
ci_11                 1.476806e-02 3 1  ON 10
ci_12                 1.047735e-02 3 1  ON 11
ci_13                 1.224696e-02 3 1  ON 12
ci_14                 1.333706e-02 3 1  ON 13
ci_15                 9.588622e-03 3 1  ON 14
ci_16                 9.531536e-03 3 1  ON 15
ci_17                -9.793127e-03 3 1  ON 16
ci_18                -9.571827e-03 3 1  ON 17
ci_19                 1.024871e-02 3 1  ON 18
ci_20                 8.856847e-03 3 1  ON 19
ci_21                 9.186421e-03 3 1  ON 20
ci_22                 9.437416e-03 3 1  ON 21
ci_23                 5.611222e-03 3 1  ON 22
ci_24                 4.881011e-03 3 1  ON 23
ci_25                 4.053081e-03 3 1  ON 24
ci_26                 3.700931e-03 3 1  ON 25
ci_27                 3.839999e-03 3 1  ON 26
ci_28                 3.246711e-03 3 1  ON 27
ci_29                 3.439052e-03 3 1  ON 28
ci_30                -2.504722e-03 3 1  ON 29
ci_31                -2.484699e-03 3 1  ON 30
ci_32                -1.926626e-03 3 1  ON 31
ci_33                -2.031333e-03 3 1  ON 32
ci_34                 1.456322e-03 3 1  ON 33
ci_35                 1.740117e-03 3 1  ON 34
ci_36                -1.779608e-03 3 1  ON 35
ci_37                -1.783145e-03 3 1  ON 36
ci_38                -1.182655e-03 3 1  ON 37
ci_39                -1.218165e-03 3 1  ON 38
ci_40                -1.777663e-03 3 1  ON 39
ci_41                -1.388286e-03 3 1  ON 40
ci_42                -1.146366e-03 3 1  ON 41
ci_43                -2.136418e-03 3 1  ON 42
ci_44                -1.847840e-03 3 1  ON 43
ci_45                -1.081411e-03 3 1  ON 44
ci_46                -1.119795e-03 3 1  ON 45
ci_47                -7.935727e-04 3 1  ON 46
ci_48                -7.765587e-04 3 1  ON 47
ci_49                -1.553441e-03 3 1  ON 48
ci_50                -1.184800e-03 3 1  ON 49
ci_51                 1.074947e-03 3 1  ON 50
ci_52                 1.210179e-03 3 1  ON 51
ci_53                -1.084289e-03 3 1  ON 52
ci_54                -1.107632e-03 3 1  ON 53
ci_55                -1.080852e-03 3 1  ON 54
ci_56                 1.632498e-03 3 1  ON 55
ci_57                 1.715159e-03 3 1  ON 56
ci_58                -1.021824e-03 3 1  ON 57
ci_59                -9.935373e-04 3 1  ON 58
ci_60                 7.930528e-04 3 1  ON 59
ci_61                 1.113049e-03 3 1  ON 60
ci_62                -9.116009e-04 3 1  ON 61
ci_63                -7.392558e-04 3 1  ON 62
ci_64                -7.604431e-04 3 1  ON 63
ci_65                -7.268628e-04 3 1  ON 64
ci_66                -8.310367e-04 3 1  ON 65
ci_67                -7.909493e-04 3 1  ON 66
ci_68                -8.126955e-05 3 1  ON 67
ci_69                -3.124785e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2103e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8045
    reference variance = 0.410278
====================================================
  Execution time = 4.4296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9908e-01
  Total weights = 1.963577892e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482101647397
                                         uncertainty =       0.002619752653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482101647397
                                         uncertainty =       0.002619752653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491009844
  error estimate for blocks of size 2^( 2) =       0.000512334422
  error estimate for blocks of size 2^( 3) =       0.000532381566
  error estimate for blocks of size 2^( 4) =       0.000547070996
  error estimate for blocks of size 2^( 5) =       0.000556238121
  error estimate for blocks of size 2^( 6) =       0.000560843334
  error estimate for blocks of size 2^( 7) =       0.000563534319

      target function =      -0.647419121000
              le_mean =     -22.815685858931
             les_mean =     521.054599704848
             stat err =       0.000556921692
             autocorr =       1.286494310469
   target nu stat err =       0.000556921692
   target dn stat err =       0.004212116449
      target stat err =       0.001661849610
              std dev =       0.694392780611
             le_variance =       0.482181333764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281568585893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647422977523       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647432000896       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647433408053       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647433598838       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647433658032       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647433677845       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647433681631       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647433681815       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647433681485       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647433681455       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.334501e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647422977523       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647425237896       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647425590131       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647425637830       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647425652613       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647425657556       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647425658499       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647425658545       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647425658462       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647425658455       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.335219e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647422977523       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647423542900       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647423630987       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647423642912       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647423646607       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647423647842       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647423648077       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647423648088       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647423648068       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647423648066       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 3.339046e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1935e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_01                 1.457544e-01 3 1  ON 0
ci_02                -4.216703e-02 3 1  ON 1
ci_03                -4.195226e-02 3 1  ON 2
ci_04                 3.953312e-02 3 1  ON 3
ci_05                -3.019782e-02 3 1  ON 4
ci_06                -3.045781e-02 3 1  ON 5
ci_07                 2.851300e-02 3 1  ON 6
ci_08                -1.158054e-02 3 1  ON 7
ci_09                -1.298241e-02 3 1  ON 8
ci_10                -1.345152e-02 3 1  ON 9
ci_11                 1.476773e-02 3 1  ON 10
ci_12                 1.047617e-02 3 1  ON 11
ci_13                 1.224670e-02 3 1  ON 12
ci_14                 1.333762e-02 3 1  ON 13
ci_15                 9.586421e-03 3 1  ON 14
ci_16                 9.529430e-03 3 1  ON 15
ci_17                -9.790316e-03 3 1  ON 16
ci_18                -9.570406e-03 3 1  ON 17
ci_19                 1.024722e-02 3 1  ON 18
ci_20                 8.855327e-03 3 1  ON 19
ci_21                 9.186428e-03 3 1  ON 20
ci_22                 9.437416e-03 3 1  ON 21
ci_23                 5.610856e-03 3 1  ON 22
ci_24                 4.881747e-03 3 1  ON 23
ci_25                 4.052992e-03 3 1  ON 24
ci_26                 3.699703e-03 3 1  ON 25
ci_27                 3.839587e-03 3 1  ON 26
ci_28                 3.245922e-03 3 1  ON 27
ci_29                 3.437901e-03 3 1  ON 28
ci_30                -2.503724e-03 3 1  ON 29
ci_31                -2.484318e-03 3 1  ON 30
ci_32                -1.926434e-03 3 1  ON 31
ci_33                -2.030787e-03 3 1  ON 32
ci_34                 1.455422e-03 3 1  ON 33
ci_35                 1.739416e-03 3 1  ON 34
ci_36                -1.779345e-03 3 1  ON 35
ci_37                -1.782822e-03 3 1  ON 36
ci_38                -1.182175e-03 3 1  ON 37
ci_39                -1.217828e-03 3 1  ON 38
ci_40                -1.777348e-03 3 1  ON 39
ci_41                -1.388294e-03 3 1  ON 40
ci_42                -1.145709e-03 3 1  ON 41
ci_43                -2.136087e-03 3 1  ON 42
ci_44                -1.847809e-03 3 1  ON 43
ci_45                -1.081243e-03 3 1  ON 44
ci_46                -1.118688e-03 3 1  ON 45
ci_47                -7.928894e-04 3 1  ON 46
ci_48                -7.757549e-04 3 1  ON 47
ci_49                -1.553720e-03 3 1  ON 48
ci_50                -1.184810e-03 3 1  ON 49
ci_51                 1.073856e-03 3 1  ON 50
ci_52                 1.209619e-03 3 1  ON 51
ci_53                -1.084595e-03 3 1  ON 52
ci_54                -1.107826e-03 3 1  ON 53
ci_55                -1.081033e-03 3 1  ON 54
ci_56                 1.633105e-03 3 1  ON 55
ci_57                 1.715333e-03 3 1  ON 56
ci_58                -1.021970e-03 3 1  ON 57
ci_59                -9.937685e-04 3 1  ON 58
ci_60                 7.941178e-04 3 1  ON 59
ci_61                 1.113623e-03 3 1  ON 60
ci_62                -9.113611e-04 3 1  ON 61
ci_63                -7.388039e-04 3 1  ON 62
ci_64                -7.595261e-04 3 1  ON 63
ci_65                -7.262060e-04 3 1  ON 64
ci_66                -8.312915e-04 3 1  ON 65
ci_67                -7.901417e-04 3 1  ON 66
ci_68                -8.203090e-05 3 1  ON 67
ci_69                -3.127062e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7523
    reference variance = 1.28949
====================================================
  Execution time = 4.2763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9508e-01
  Total weights = 1.9633e+06
  Execution time = 5.9064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478420503828
                                         uncertainty =       0.002137551791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478420503828
                                         uncertainty =       0.002137551791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489111556
  error estimate for blocks of size 2^( 2) =       0.000510123981
  error estimate for blocks of size 2^( 3) =       0.000529721318
  error estimate for blocks of size 2^( 4) =       0.000544474453
  error estimate for blocks of size 2^( 5) =       0.000554680977
  error estimate for blocks of size 2^( 6) =       0.000559434804
  error estimate for blocks of size 2^( 7) =       0.000564115883

      target function =      -0.649188300445
              le_mean =     -22.816576711701
             les_mean =     521.091251411650
             stat err =       0.000555676529
             autocorr =       1.290708763683
   target nu stat err =       0.000555676529
   target dn stat err =       0.002925873635
      target stat err =       0.001185854840
              std dev =       0.691708196145
             le_variance =       0.478460228615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478372411522
                                         uncertainty =       0.002138144672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478372411522
                                         uncertainty =       0.002138144672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489086983
  error estimate for blocks of size 2^( 2) =       0.000510098837
  error estimate for blocks of size 2^( 3) =       0.000529696381
  error estimate for blocks of size 2^( 4) =       0.000544449804
  error estimate for blocks of size 2^( 5) =       0.000554656679
  error estimate for blocks of size 2^( 6) =       0.000559411455
  error estimate for blocks of size 2^( 7) =       0.000564092602

      target function =      -0.641753656588
              le_mean =     -22.816576619134
             les_mean =     521.110363872090
             stat err =       0.000555652635
             autocorr =       1.290727454646
   target nu stat err =       0.000555652635
   target dn stat err =       0.019377048055
      target stat err =       0.007374221184
              std dev =       0.691673444223
             le_variance =       0.478412153443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478396375555
                                         uncertainty =       0.002137848466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478396375555
                                         uncertainty =       0.002137848466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489099228
  error estimate for blocks of size 2^( 2) =       0.000510111363
  error estimate for blocks of size 2^( 3) =       0.000529708795
  error estimate for blocks of size 2^( 4) =       0.000544462057
  error estimate for blocks of size 2^( 5) =       0.000554668738
  error estimate for blocks of size 2^( 6) =       0.000559423103
  error estimate for blocks of size 2^( 7) =       0.000564104219

      target function =      -0.649179204675
              le_mean =     -22.816576643042
             les_mean =     521.091271610386
             stat err =       0.000555664529
             autocorr =       1.290718083168
   target nu stat err =       0.000555664529
   target dn stat err =       0.002928216233
      target stat err =       0.001186695437
              std dev =       0.691690761085
             le_variance =       0.478436108970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478417482461
                                         uncertainty =       0.002137588841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478417482461
                                         uncertainty =       0.002137588841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489110012
  error estimate for blocks of size 2^( 2) =       0.000510122401
  error estimate for blocks of size 2^( 3) =       0.000529719750
  error estimate for blocks of size 2^( 4) =       0.000544472900
  error estimate for blocks of size 2^( 5) =       0.000554679445
  error estimate for blocks of size 2^( 6) =       0.000559433338
  error estimate for blocks of size 2^( 7) =       0.000564114422

      target function =      -0.649188280855
              le_mean =     -22.816576702676
             les_mean =     521.091251043607
             stat err =       0.000555675026
             autocorr =       1.290709930101
   target nu stat err =       0.000555675026
   target dn stat err =       0.002926129933
      target stat err =       0.001185950198
              std dev =       0.691706012935
             le_variance =       0.478457208330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.649188300445        initial  <--
     1.5625e+01     1.5625e+02             5.3345e-05        -0.641753656588
     6.2500e+01     6.2500e+02             1.3352e-05        -0.649179204675
     2.5000e+02     2.5000e+03             3.3390e-06        -0.649188280855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.3685
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_01                 1.457678e-01 3 1  ON 0
ci_02                -4.217802e-02 3 1  ON 1
ci_03                -4.196321e-02 3 1  ON 2
ci_04                 3.954564e-02 3 1  ON 3
ci_05                -3.020464e-02 3 1  ON 4
ci_06                -3.046401e-02 3 1  ON 5
ci_07                 2.851439e-02 3 1  ON 6
ci_08                -1.158577e-02 3 1  ON 7
ci_09                -1.298588e-02 3 1  ON 8
ci_10                -1.345416e-02 3 1  ON 9
ci_11                 1.476806e-02 3 1  ON 10
ci_12                 1.047735e-02 3 1  ON 11
ci_13                 1.224696e-02 3 1  ON 12
ci_14                 1.333706e-02 3 1  ON 13
ci_15                 9.588622e-03 3 1  ON 14
ci_16                 9.531536e-03 3 1  ON 15
ci_17                -9.793127e-03 3 1  ON 16
ci_18                -9.571827e-03 3 1  ON 17
ci_19                 1.024871e-02 3 1  ON 18
ci_20                 8.856847e-03 3 1  ON 19
ci_21                 9.186421e-03 3 1  ON 20
ci_22                 9.437416e-03 3 1  ON 21
ci_23                 5.611222e-03 3 1  ON 22
ci_24                 4.881011e-03 3 1  ON 23
ci_25                 4.053081e-03 3 1  ON 24
ci_26                 3.700931e-03 3 1  ON 25
ci_27                 3.839999e-03 3 1  ON 26
ci_28                 3.246711e-03 3 1  ON 27
ci_29                 3.439052e-03 3 1  ON 28
ci_30                -2.504722e-03 3 1  ON 29
ci_31                -2.484699e-03 3 1  ON 30
ci_32                -1.926626e-03 3 1  ON 31
ci_33                -2.031333e-03 3 1  ON 32
ci_34                 1.456322e-03 3 1  ON 33
ci_35                 1.740117e-03 3 1  ON 34
ci_36                -1.779608e-03 3 1  ON 35
ci_37                -1.783145e-03 3 1  ON 36
ci_38                -1.182655e-03 3 1  ON 37
ci_39                -1.218165e-03 3 1  ON 38
ci_40                -1.777663e-03 3 1  ON 39
ci_41                -1.388286e-03 3 1  ON 40
ci_42                -1.146366e-03 3 1  ON 41
ci_43                -2.136418e-03 3 1  ON 42
ci_44                -1.847840e-03 3 1  ON 43
ci_45                -1.081411e-03 3 1  ON 44
ci_46                -1.119795e-03 3 1  ON 45
ci_47                -7.935727e-04 3 1  ON 46
ci_48                -7.765587e-04 3 1  ON 47
ci_49                -1.553441e-03 3 1  ON 48
ci_50                -1.184800e-03 3 1  ON 49
ci_51                 1.074947e-03 3 1  ON 50
ci_52                 1.210179e-03 3 1  ON 51
ci_53                -1.084289e-03 3 1  ON 52
ci_54                -1.107632e-03 3 1  ON 53
ci_55                -1.080852e-03 3 1  ON 54
ci_56                 1.632498e-03 3 1  ON 55
ci_57                 1.715159e-03 3 1  ON 56
ci_58                -1.021824e-03 3 1  ON 57
ci_59                -9.935373e-04 3 1  ON 58
ci_60                 7.930528e-04 3 1  ON 59
ci_61                 1.113049e-03 3 1  ON 60
ci_62                -9.116009e-04 3 1  ON 61
ci_63                -7.392558e-04 3 1  ON 62
ci_64                -7.604431e-04 3 1  ON 63
ci_65                -7.268628e-04 3 1  ON 64
ci_66                -8.310367e-04 3 1  ON 65
ci_67                -7.909493e-04 3 1  ON 66
ci_68                -8.126955e-05 3 1  ON 67
ci_69                -3.124785e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2431e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8184
    reference variance = 0.292319
====================================================
  Execution time = 4.2733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9541e-01
  Total weights = 1.963426333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478715997489
                                         uncertainty =       0.002227245594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478715997489
                                         uncertainty =       0.002227245594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489313229
  error estimate for blocks of size 2^( 2) =       0.000510060780
  error estimate for blocks of size 2^( 3) =       0.000529810270
  error estimate for blocks of size 2^( 4) =       0.000544542341
  error estimate for blocks of size 2^( 5) =       0.000554360076
  error estimate for blocks of size 2^( 6) =       0.000561137874
  error estimate for blocks of size 2^( 7) =       0.000564163652

      target function =      -0.649220414602
              le_mean =     -22.817235697662
             les_mean =     521.121652982778
             stat err =       0.000556050986
             autocorr =       1.291383743103
   target nu stat err =       0.000556050986
   target dn stat err =       0.003040212690
      target stat err =       0.001229532492
              std dev =       0.691993404961
             le_variance =       0.478854872510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281723569766e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649222312091       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649223359335       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649223522196       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649223550405       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649223559418       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649223561170       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649223561615       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649223561605       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649223561632       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649223561621       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 6.090398e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649222312091       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649222573955       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649222614675       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649222621728       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649222623981       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649222624418       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649222624529       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649222624526       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649222624535       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649222624531       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 1.522785e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649222312091       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649222377560       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649222387741       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649222389504       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649222390070       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649222390175       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649222390206       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649222390204       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649222390209       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649222390203       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 3.807077e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0346e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_01                 1.457662e-01 3 1  ON 0
ci_02                -4.217689e-02 3 1  ON 1
ci_03                -4.196206e-02 3 1  ON 2
ci_04                 3.954432e-02 3 1  ON 3
ci_05                -3.020392e-02 3 1  ON 4
ci_06                -3.046335e-02 3 1  ON 5
ci_07                 2.851424e-02 3 1  ON 6
ci_08                -1.158528e-02 3 1  ON 7
ci_09                -1.298550e-02 3 1  ON 8
ci_10                -1.345388e-02 3 1  ON 9
ci_11                 1.476792e-02 3 1  ON 10
ci_12                 1.047705e-02 3 1  ON 11
ci_13                 1.224699e-02 3 1  ON 12
ci_14                 1.333708e-02 3 1  ON 13
ci_15                 9.588483e-03 3 1  ON 14
ci_16                 9.531239e-03 3 1  ON 15
ci_17                -9.792928e-03 3 1  ON 16
ci_18                -9.571622e-03 3 1  ON 17
ci_19                 1.024862e-02 3 1  ON 18
ci_20                 8.856650e-03 3 1  ON 19
ci_21                 9.186321e-03 3 1  ON 20
ci_22                 9.437324e-03 3 1  ON 21
ci_23                 5.611197e-03 3 1  ON 22
ci_24                 4.880951e-03 3 1  ON 23
ci_25                 4.053043e-03 3 1  ON 24
ci_26                 3.700818e-03 3 1  ON 25
ci_27                 3.839981e-03 3 1  ON 26
ci_28                 3.246649e-03 3 1  ON 27
ci_29                 3.439009e-03 3 1  ON 28
ci_30                -2.504629e-03 3 1  ON 29
ci_31                -2.484500e-03 3 1  ON 30
ci_32                -1.926467e-03 3 1  ON 31
ci_33                -2.031263e-03 3 1  ON 32
ci_34                 1.456301e-03 3 1  ON 33
ci_35                 1.740039e-03 3 1  ON 34
ci_36                -1.779563e-03 3 1  ON 35
ci_37                -1.783076e-03 3 1  ON 36
ci_38                -1.182531e-03 3 1  ON 37
ci_39                -1.218107e-03 3 1  ON 38
ci_40                -1.777612e-03 3 1  ON 39
ci_41                -1.388237e-03 3 1  ON 40
ci_42                -1.146303e-03 3 1  ON 41
ci_43                -2.136354e-03 3 1  ON 42
ci_44                -1.847861e-03 3 1  ON 43
ci_45                -1.081349e-03 3 1  ON 44
ci_46                -1.119836e-03 3 1  ON 45
ci_47                -7.934919e-04 3 1  ON 46
ci_48                -7.765096e-04 3 1  ON 47
ci_49                -1.553388e-03 3 1  ON 48
ci_50                -1.184709e-03 3 1  ON 49
ci_51                 1.074822e-03 3 1  ON 50
ci_52                 1.210076e-03 3 1  ON 51
ci_53                -1.084245e-03 3 1  ON 52
ci_54                -1.107634e-03 3 1  ON 53
ci_55                -1.080865e-03 3 1  ON 54
ci_56                 1.632541e-03 3 1  ON 55
ci_57                 1.715246e-03 3 1  ON 56
ci_58                -1.021742e-03 3 1  ON 57
ci_59                -9.936290e-04 3 1  ON 58
ci_60                 7.931106e-04 3 1  ON 59
ci_61                 1.113047e-03 3 1  ON 60
ci_62                -9.115881e-04 3 1  ON 61
ci_63                -7.392041e-04 3 1  ON 62
ci_64                -7.603935e-04 3 1  ON 63
ci_65                -7.268948e-04 3 1  ON 64
ci_66                -8.309915e-04 3 1  ON 65
ci_67                -7.909690e-04 3 1  ON 66
ci_68                -8.138930e-05 3 1  ON 67
ci_69                -3.125092e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8585
    reference variance = 0.432053
====================================================
  Execution time = 4.1525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9614e-01
  Total weights = 1.9633e+06
  Execution time = 5.9001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480618065180
                                         uncertainty =       0.002809360843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480618065180
                                         uncertainty =       0.002809360843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490183320
  error estimate for blocks of size 2^( 2) =       0.000510924152
  error estimate for blocks of size 2^( 3) =       0.000530180402
  error estimate for blocks of size 2^( 4) =       0.000544393929
  error estimate for blocks of size 2^( 5) =       0.000554557665
  error estimate for blocks of size 2^( 6) =       0.000557923425
  error estimate for blocks of size 2^( 7) =       0.000561189619

      target function =      -0.648799410553
              le_mean =     -22.816679931284
             les_mean =     521.097024542586
             stat err =       0.000554516159
             autocorr =       1.279709386750
   target nu stat err =       0.000554516159
   target dn stat err =       0.003465163371
      target stat err =       0.001386799027
              std dev =       0.693223899057
             le_variance =       0.480559374224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480612511741
                                         uncertainty =       0.002809267420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480612511741
                                         uncertainty =       0.002809267420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490180489
  error estimate for blocks of size 2^( 2) =       0.000510921323
  error estimate for blocks of size 2^( 3) =       0.000530177617
  error estimate for blocks of size 2^( 4) =       0.000544391263
  error estimate for blocks of size 2^( 5) =       0.000554555029
  error estimate for blocks of size 2^( 6) =       0.000557920747
  error estimate for blocks of size 2^( 7) =       0.000561186855

      target function =      -0.648805531575
              le_mean =     -22.816679950040
             les_mean =     521.097009659797
             stat err =       0.000554513474
             autocorr =       1.279711774267
   target nu stat err =       0.000554513474
   target dn stat err =       0.003464589416
      target stat err =       0.001386607547
              std dev =       0.693219894886
             le_variance =       0.480553822666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480615287491
                                         uncertainty =       0.002809314114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480615287491
                                         uncertainty =       0.002809314114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490181904
  error estimate for blocks of size 2^( 2) =       0.000510922737
  error estimate for blocks of size 2^( 3) =       0.000530179009
  error estimate for blocks of size 2^( 4) =       0.000544392596
  error estimate for blocks of size 2^( 5) =       0.000554556346
  error estimate for blocks of size 2^( 6) =       0.000557922086
  error estimate for blocks of size 2^( 7) =       0.000561188237

      target function =      -0.648802493986
              le_mean =     -22.816679940602
             les_mean =     521.097017039384
             stat err =       0.000554514816
             autocorr =       1.279710580808
   target nu stat err =       0.000554514816
   target dn stat err =       0.003464874233
      target stat err =       0.001386702568
              std dev =       0.693221896276
             le_variance =       0.480556597476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480617717904
                                         uncertainty =       0.002809355000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480617717904
                                         uncertainty =       0.002809355000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490183143
  error estimate for blocks of size 2^( 2) =       0.000510923975
  error estimate for blocks of size 2^( 3) =       0.000530180228
  error estimate for blocks of size 2^( 4) =       0.000544393762
  error estimate for blocks of size 2^( 5) =       0.000554557500
  error estimate for blocks of size 2^( 6) =       0.000557923257
  error estimate for blocks of size 2^( 7) =       0.000561189446

      target function =      -0.648799798724
              le_mean =     -22.816679932442
             les_mean =     521.097023597316
             stat err =       0.000554515991
             autocorr =       1.279709536026
   target nu stat err =       0.000554515991
   target dn stat err =       0.003465126991
      target stat err =       0.001386786891
              std dev =       0.693223648663
             le_variance =       0.480559027065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.648799410553        initial
     1.5625e+02     1.5625e+03             6.0904e-06        -0.648805531575  <--
     6.2500e+02     6.2500e+03             1.5228e-06        -0.648802493986
     2.5000e+03     2.5000e+04             3.8071e-07        -0.648799798724

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 7.1112e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_01                 1.457617e-01 3 1  ON 0
ci_02                -4.217347e-02 3 1  ON 1
ci_03                -4.195863e-02 3 1  ON 2
ci_04                 3.954034e-02 3 1  ON 3
ci_05                -3.020176e-02 3 1  ON 4
ci_06                -3.046137e-02 3 1  ON 5
ci_07                 2.851379e-02 3 1  ON 6
ci_08                -1.158382e-02 3 1  ON 7
ci_09                -1.298435e-02 3 1  ON 8
ci_10                -1.345302e-02 3 1  ON 9
ci_11                 1.476750e-02 3 1  ON 10
ci_12                 1.047616e-02 3 1  ON 11
ci_13                 1.224710e-02 3 1  ON 12
ci_14                 1.333715e-02 3 1  ON 13
ci_15                 9.588065e-03 3 1  ON 14
ci_16                 9.530349e-03 3 1  ON 15
ci_17                -9.792331e-03 3 1  ON 16
ci_18                -9.571009e-03 3 1  ON 17
ci_19                 1.024832e-02 3 1  ON 18
ci_20                 8.856059e-03 3 1  ON 19
ci_21                 9.186022e-03 3 1  ON 20
ci_22                 9.437050e-03 3 1  ON 21
ci_23                 5.611122e-03 3 1  ON 22
ci_24                 4.880771e-03 3 1  ON 23
ci_25                 4.052930e-03 3 1  ON 24
ci_26                 3.700479e-03 3 1  ON 25
ci_27                 3.839926e-03 3 1  ON 26
ci_28                 3.246465e-03 3 1  ON 27
ci_29                 3.438880e-03 3 1  ON 28
ci_30                -2.504349e-03 3 1  ON 29
ci_31                -2.483904e-03 3 1  ON 30
ci_32                -1.925992e-03 3 1  ON 31
ci_33                -2.031052e-03 3 1  ON 32
ci_34                 1.456240e-03 3 1  ON 33
ci_35                 1.739805e-03 3 1  ON 34
ci_36                -1.779426e-03 3 1  ON 35
ci_37                -1.782870e-03 3 1  ON 36
ci_38                -1.182158e-03 3 1  ON 37
ci_39                -1.217933e-03 3 1  ON 38
ci_40                -1.777460e-03 3 1  ON 39
ci_41                -1.388092e-03 3 1  ON 40
ci_42                -1.146116e-03 3 1  ON 41
ci_43                -2.136164e-03 3 1  ON 42
ci_44                -1.847926e-03 3 1  ON 43
ci_45                -1.081165e-03 3 1  ON 44
ci_46                -1.119961e-03 3 1  ON 45
ci_47                -7.932496e-04 3 1  ON 46
ci_48                -7.763625e-04 3 1  ON 47
ci_49                -1.553226e-03 3 1  ON 48
ci_50                -1.184436e-03 3 1  ON 49
ci_51                 1.074445e-03 3 1  ON 50
ci_52                 1.209766e-03 3 1  ON 51
ci_53                -1.084110e-03 3 1  ON 52
ci_54                -1.107641e-03 3 1  ON 53
ci_55                -1.080902e-03 3 1  ON 54
ci_56                 1.632672e-03 3 1  ON 55
ci_57                 1.715506e-03 3 1  ON 56
ci_58                -1.021497e-03 3 1  ON 57
ci_59                -9.939041e-04 3 1  ON 58
ci_60                 7.932838e-04 3 1  ON 59
ci_61                 1.113044e-03 3 1  ON 60
ci_62                -9.115497e-04 3 1  ON 61
ci_63                -7.390489e-04 3 1  ON 62
ci_64                -7.602446e-04 3 1  ON 63
ci_65                -7.269908e-04 3 1  ON 64
ci_66                -8.308559e-04 3 1  ON 65
ci_67                -7.910283e-04 3 1  ON 66
ci_68                -8.174845e-05 3 1  ON 67
ci_69                -3.126012e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2146e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7931
    reference variance = 0.520838
====================================================
  Execution time = 4.2611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9907e-01
  Total weights = 1.963337103e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482857777109
                                         uncertainty =       0.004413692631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482857777109
                                         uncertainty =       0.004413692631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491296423
  error estimate for blocks of size 2^( 2) =       0.000512397125
  error estimate for blocks of size 2^( 3) =       0.000532709337
  error estimate for blocks of size 2^( 4) =       0.000546792728
  error estimate for blocks of size 2^( 5) =       0.000554898684
  error estimate for blocks of size 2^( 6) =       0.000560856625
  error estimate for blocks of size 2^( 7) =       0.000564021513

      target function =      -0.647732436978
              le_mean =     -22.816986611614
             les_mean =     521.113952555083
             stat err =       0.000556642388
             autocorr =       1.283705329893
   target nu stat err =       0.000556642388
   target dn stat err =       0.005052977697
      target stat err =       0.001985639265
              std dev =       0.694798064327
             le_variance =       0.482744350193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281698661161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647738173567       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647742249870       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647742913486       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647743032982       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647743073542       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647743081997       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647743084727       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647743085002       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647743085049       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 2.393978e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647738173567       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647739193465       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647739359452       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647739389331       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647739399467       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647739401578       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647739402260       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647739402329       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647739402341       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 5.987852e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647738173567       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647738428593       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647738470095       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647738477565       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647738480099       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647738480626       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647738480796       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647738480815       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647738480817       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 1.497145e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243638 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0258e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_01                 1.457557e-01 3 1  ON 0
ci_02                -4.216880e-02 3 1  ON 1
ci_03                -4.195426e-02 3 1  ON 2
ci_04                 3.953523e-02 3 1  ON 3
ci_05                -3.019910e-02 3 1  ON 4
ci_06                -3.045837e-02 3 1  ON 5
ci_07                 2.851293e-02 3 1  ON 6
ci_08                -1.158188e-02 3 1  ON 7
ci_09                -1.298292e-02 3 1  ON 8
ci_10                -1.345163e-02 3 1  ON 9
ci_11                 1.476690e-02 3 1  ON 10
ci_12                 1.047507e-02 3 1  ON 11
ci_13                 1.224703e-02 3 1  ON 12
ci_14                 1.333726e-02 3 1  ON 13
ci_15                 9.587349e-03 3 1  ON 14
ci_16                 9.529642e-03 3 1  ON 15
ci_17                -9.791443e-03 3 1  ON 16
ci_18                -9.570513e-03 3 1  ON 17
ci_19                 1.024795e-02 3 1  ON 18
ci_20                 8.855218e-03 3 1  ON 19
ci_21                 9.185812e-03 3 1  ON 20
ci_22                 9.437041e-03 3 1  ON 21
ci_23                 5.610648e-03 3 1  ON 22
ci_24                 4.880774e-03 3 1  ON 23
ci_25                 4.052655e-03 3 1  ON 24
ci_26                 3.699520e-03 3 1  ON 25
ci_27                 3.839904e-03 3 1  ON 26
ci_28                 3.246014e-03 3 1  ON 27
ci_29                 3.438433e-03 3 1  ON 28
ci_30                -2.503685e-03 3 1  ON 29
ci_31                -2.483601e-03 3 1  ON 30
ci_32                -1.925570e-03 3 1  ON 31
ci_33                -2.030491e-03 3 1  ON 32
ci_34                 1.455543e-03 3 1  ON 33
ci_35                 1.739961e-03 3 1  ON 34
ci_36                -1.779026e-03 3 1  ON 35
ci_37                -1.782644e-03 3 1  ON 36
ci_38                -1.182076e-03 3 1  ON 37
ci_39                -1.217662e-03 3 1  ON 38
ci_40                -1.777599e-03 3 1  ON 39
ci_41                -1.387556e-03 3 1  ON 40
ci_42                -1.145802e-03 3 1  ON 41
ci_43                -2.136267e-03 3 1  ON 42
ci_44                -1.848037e-03 3 1  ON 43
ci_45                -1.081050e-03 3 1  ON 44
ci_46                -1.119934e-03 3 1  ON 45
ci_47                -7.931187e-04 3 1  ON 46
ci_48                -7.758285e-04 3 1  ON 47
ci_49                -1.553085e-03 3 1  ON 48
ci_50                -1.184206e-03 3 1  ON 49
ci_51                 1.074173e-03 3 1  ON 50
ci_52                 1.209832e-03 3 1  ON 51
ci_53                -1.084060e-03 3 1  ON 52
ci_54                -1.107607e-03 3 1  ON 53
ci_55                -1.080627e-03 3 1  ON 54
ci_56                 1.632874e-03 3 1  ON 55
ci_57                 1.715516e-03 3 1  ON 56
ci_58                -1.021390e-03 3 1  ON 57
ci_59                -9.938369e-04 3 1  ON 58
ci_60                 7.936445e-04 3 1  ON 59
ci_61                 1.113140e-03 3 1  ON 60
ci_62                -9.112005e-04 3 1  ON 61
ci_63                -7.385825e-04 3 1  ON 62
ci_64                -7.599994e-04 3 1  ON 63
ci_65                -7.269701e-04 3 1  ON 64
ci_66                -8.306291e-04 3 1  ON 65
ci_67                -7.909482e-04 3 1  ON 66
ci_68                -8.166849e-05 3 1  ON 67
ci_69                -3.126779e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7612
    reference variance = 0.353212
====================================================
  Execution time = 4.2953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9630e-01
  Total weights = 1.9635e+06
  Execution time = 5.9229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481103419926
                                         uncertainty =       0.004088526877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481103419926
                                         uncertainty =       0.004088526877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490415165
  error estimate for blocks of size 2^( 2) =       0.000511022412
  error estimate for blocks of size 2^( 3) =       0.000530831209
  error estimate for blocks of size 2^( 4) =       0.000546071234
  error estimate for blocks of size 2^( 5) =       0.000555374108
  error estimate for blocks of size 2^( 6) =       0.000560933900
  error estimate for blocks of size 2^( 7) =       0.000564841830

      target function =      -0.648411785173
              le_mean =     -22.815364543247
             les_mean =     521.037161718932
             stat err =       0.000556805268
             autocorr =       1.289077083908
   target nu stat err =       0.000556805268
   target dn stat err =       0.005955268605
      target stat err =       0.002332347662
              std dev =       0.693551777734
             le_variance =       0.481014068397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481073332413
                                         uncertainty =       0.004080728248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481073332413
                                         uncertainty =       0.004080728248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490399825
  error estimate for blocks of size 2^( 2) =       0.000511007177
  error estimate for blocks of size 2^( 3) =       0.000530816288
  error estimate for blocks of size 2^( 4) =       0.000546056709
  error estimate for blocks of size 2^( 5) =       0.000555359909
  error estimate for blocks of size 2^( 6) =       0.000560919621
  error estimate for blocks of size 2^( 7) =       0.000564828296

      target function =      -0.648420802479
              le_mean =     -22.815364577778
             les_mean =     521.037140132433
             stat err =       0.000556791134
             autocorr =       1.289092283925
   target nu stat err =       0.000556791134
   target dn stat err =       0.005944267882
      target stat err =       0.002328189976
              std dev =       0.693530083949
             le_variance =       0.480983977342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481088354493
                                         uncertainty =       0.004084620365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481088354493
                                         uncertainty =       0.004084620365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490407484
  error estimate for blocks of size 2^( 2) =       0.000511014784
  error estimate for blocks of size 2^( 3) =       0.000530823737
  error estimate for blocks of size 2^( 4) =       0.000546063960
  error estimate for blocks of size 2^( 5) =       0.000555366997
  error estimate for blocks of size 2^( 6) =       0.000560926748
  error estimate for blocks of size 2^( 7) =       0.000564835051

      target function =      -0.648416466488
              le_mean =     -22.815364559826
             les_mean =     521.037150448544
             stat err =       0.000556798189
             autocorr =       1.289084686536
   target nu stat err =       0.000556798189
   target dn stat err =       0.005949749393
      target stat err =       0.002330262822
              std dev =       0.693540915297
             le_variance =       0.480999001191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481101535259
                                         uncertainty =       0.004088037996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481101535259
                                         uncertainty =       0.004088037996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490414204
  error estimate for blocks of size 2^( 2) =       0.000511021458
  error estimate for blocks of size 2^( 3) =       0.000530830274
  error estimate for blocks of size 2^( 4) =       0.000546070324
  error estimate for blocks of size 2^( 5) =       0.000555373218
  error estimate for blocks of size 2^( 6) =       0.000560933005
  error estimate for blocks of size 2^( 7) =       0.000564840981

      target function =      -0.648412388823
              le_mean =     -22.815364545242
             les_mean =     521.037160258846
             stat err =       0.000556804382
             autocorr =       1.289078034093
   target nu stat err =       0.000556804382
   target dn stat err =       0.005954577015
      target stat err =       0.002332086542
              std dev =       0.693550418866
             le_variance =       0.481012183509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.648411785173        initial
     3.9062e+01     3.9062e+02             2.3940e-05        -0.648420802479  <--
     1.5625e+02     1.5625e+03             5.9879e-06        -0.648416466488
     6.2500e+02     6.2500e+03             1.4971e-06        -0.648412388823

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 7.2654e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_01                 1.457377e-01 3 1  ON 0
ci_02                -4.215480e-02 3 1  ON 1
ci_03                -4.194115e-02 3 1  ON 2
ci_04                 3.951992e-02 3 1  ON 3
ci_05                -3.019113e-02 3 1  ON 4
ci_06                -3.044937e-02 3 1  ON 5
ci_07                 2.851036e-02 3 1  ON 6
ci_08                -1.157608e-02 3 1  ON 7
ci_09                -1.297864e-02 3 1  ON 8
ci_10                -1.344748e-02 3 1  ON 9
ci_11                 1.476509e-02 3 1  ON 10
ci_12                 1.047181e-02 3 1  ON 11
ci_13                 1.224680e-02 3 1  ON 12
ci_14                 1.333759e-02 3 1  ON 13
ci_15                 9.585202e-03 3 1  ON 14
ci_16                 9.527524e-03 3 1  ON 15
ci_17                -9.788778e-03 3 1  ON 16
ci_18                -9.569024e-03 3 1  ON 17
ci_19                 1.024684e-02 3 1  ON 18
ci_20                 8.852700e-03 3 1  ON 19
ci_21                 9.185183e-03 3 1  ON 20
ci_22                 9.437014e-03 3 1  ON 21
ci_23                 5.609229e-03 3 1  ON 22
ci_24                 4.880781e-03 3 1  ON 23
ci_25                 4.051830e-03 3 1  ON 24
ci_26                 3.696644e-03 3 1  ON 25
ci_27                 3.839837e-03 3 1  ON 26
ci_28                 3.244661e-03 3 1  ON 27
ci_29                 3.437094e-03 3 1  ON 28
ci_30                -2.501692e-03 3 1  ON 29
ci_31                -2.482692e-03 3 1  ON 30
ci_32                -1.924308e-03 3 1  ON 31
ci_33                -2.028811e-03 3 1  ON 32
ci_34                 1.453455e-03 3 1  ON 33
ci_35                 1.740428e-03 3 1  ON 34
ci_36                -1.777827e-03 3 1  ON 35
ci_37                -1.781968e-03 3 1  ON 36
ci_38                -1.181829e-03 3 1  ON 37
ci_39                -1.216848e-03 3 1  ON 38
ci_40                -1.778017e-03 3 1  ON 39
ci_41                -1.385948e-03 3 1  ON 40
ci_42                -1.144860e-03 3 1  ON 41
ci_43                -2.136576e-03 3 1  ON 42
ci_44                -1.848369e-03 3 1  ON 43
ci_45                -1.080706e-03 3 1  ON 44
ci_46                -1.119854e-03 3 1  ON 45
ci_47                -7.927261e-04 3 1  ON 46
ci_48                -7.742274e-04 3 1  ON 47
ci_49                -1.552665e-03 3 1  ON 48
ci_50                -1.183519e-03 3 1  ON 49
ci_51                 1.073357e-03 3 1  ON 50
ci_52                 1.210031e-03 3 1  ON 51
ci_53                -1.083908e-03 3 1  ON 52
ci_54                -1.107506e-03 3 1  ON 53
ci_55                -1.079804e-03 3 1  ON 54
ci_56                 1.633481e-03 3 1  ON 55
ci_57                 1.715544e-03 3 1  ON 56
ci_58                -1.021071e-03 3 1  ON 57
ci_59                -9.936354e-04 3 1  ON 58
ci_60                 7.947259e-04 3 1  ON 59
ci_61                 1.113428e-03 3 1  ON 60
ci_62                -9.101541e-04 3 1  ON 61
ci_63                -7.371847e-04 3 1  ON 62
ci_64                -7.592648e-04 3 1  ON 63
ci_65                -7.269079e-04 3 1  ON 64
ci_66                -8.299495e-04 3 1  ON 65
ci_67                -7.907084e-04 3 1  ON 66
ci_68                -8.142917e-05 3 1  ON 67
ci_69                -3.129078e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2292e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8591
    reference variance = 0.337501
====================================================
  Execution time = 4.4041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9561e-01
  Total weights = 1.963466025e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479809737553
                                         uncertainty =       0.002096904666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479809737553
                                         uncertainty =       0.002096904666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489771908
  error estimate for blocks of size 2^( 2) =       0.000510355101
  error estimate for blocks of size 2^( 3) =       0.000530097341
  error estimate for blocks of size 2^( 4) =       0.000545778428
  error estimate for blocks of size 2^( 5) =       0.000557056527
  error estimate for blocks of size 2^( 6) =       0.000562593913
  error estimate for blocks of size 2^( 7) =       0.000565572493

      target function =      -0.648949273466
              le_mean =     -22.816448188107
             les_mean =     521.085919220278
             stat err =       0.000557750340
             autocorr =       1.296856563583
   target nu stat err =       0.000557750340
   target dn stat err =       0.003333153400
      target stat err =       0.001337847813
              std dev =       0.692642075280
             le_variance =       0.479753044448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281644818811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648951615065       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648967619559       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648969909457       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648970303472       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648970376090       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648970398291       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648970403351       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648970402950       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648970403083       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 8.525212e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648951615065       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648955629151       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648956202839       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648956301404       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648956319513       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648956325031       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648956326289       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648956326189       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648956326222       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 2.138451e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648951615065       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648952619400       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648952762898       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648952787543       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648952792067       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648952793445       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648952793759       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648952793734       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648952793742       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 5.350613e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1686e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_01                 1.457170e-01 3 1  ON 0
ci_02                -4.213680e-02 3 1  ON 1
ci_03                -4.192305e-02 3 1  ON 2
ci_04                 3.949854e-02 3 1  ON 3
ci_05                -3.017902e-02 3 1  ON 4
ci_06                -3.043687e-02 3 1  ON 5
ci_07                 2.850872e-02 3 1  ON 6
ci_08                -1.156819e-02 3 1  ON 7
ci_09                -1.297456e-02 3 1  ON 8
ci_10                -1.344346e-02 3 1  ON 9
ci_11                 1.476360e-02 3 1  ON 10
ci_12                 1.046857e-02 3 1  ON 11
ci_13                 1.224715e-02 3 1  ON 12
ci_14                 1.333927e-02 3 1  ON 13
ci_15                 9.581644e-03 3 1  ON 14
ci_16                 9.524627e-03 3 1  ON 15
ci_17                -9.785396e-03 3 1  ON 16
ci_18                -9.566786e-03 3 1  ON 17
ci_19                 1.024482e-02 3 1  ON 18
ci_20                 8.849081e-03 3 1  ON 19
ci_21                 9.184322e-03 3 1  ON 20
ci_22                 9.435883e-03 3 1  ON 21
ci_23                 5.608527e-03 3 1  ON 22
ci_24                 4.880482e-03 3 1  ON 23
ci_25                 4.048735e-03 3 1  ON 24
ci_26                 3.695246e-03 3 1  ON 25
ci_27                 3.839398e-03 3 1  ON 26
ci_28                 3.244054e-03 3 1  ON 27
ci_29                 3.435004e-03 3 1  ON 28
ci_30                -2.500470e-03 3 1  ON 29
ci_31                -2.481052e-03 3 1  ON 30
ci_32                -1.923609e-03 3 1  ON 31
ci_33                -2.028003e-03 3 1  ON 32
ci_34                 1.451470e-03 3 1  ON 33
ci_35                 1.739219e-03 3 1  ON 34
ci_36                -1.777652e-03 3 1  ON 35
ci_37                -1.780364e-03 3 1  ON 36
ci_38                -1.180874e-03 3 1  ON 37
ci_39                -1.216536e-03 3 1  ON 38
ci_40                -1.776269e-03 3 1  ON 39
ci_41                -1.384405e-03 3 1  ON 40
ci_42                -1.143284e-03 3 1  ON 41
ci_43                -2.135541e-03 3 1  ON 42
ci_44                -1.848107e-03 3 1  ON 43
ci_45                -1.080111e-03 3 1  ON 44
ci_46                -1.118911e-03 3 1  ON 45
ci_47                -7.910242e-04 3 1  ON 46
ci_48                -7.728758e-04 3 1  ON 47
ci_49                -1.552568e-03 3 1  ON 48
ci_50                -1.181924e-03 3 1  ON 49
ci_51                 1.072628e-03 3 1  ON 50
ci_52                 1.208321e-03 3 1  ON 51
ci_53                -1.083852e-03 3 1  ON 52
ci_54                -1.107261e-03 3 1  ON 53
ci_55                -1.080881e-03 3 1  ON 54
ci_56                 1.634346e-03 3 1  ON 55
ci_57                 1.714839e-03 3 1  ON 56
ci_58                -1.021139e-03 3 1  ON 57
ci_59                -9.940204e-04 3 1  ON 58
ci_60                 7.942387e-04 3 1  ON 59
ci_61                 1.113601e-03 3 1  ON 60
ci_62                -9.104746e-04 3 1  ON 61
ci_63                -7.368416e-04 3 1  ON 62
ci_64                -7.573035e-04 3 1  ON 63
ci_65                -7.263149e-04 3 1  ON 64
ci_66                -8.286701e-04 3 1  ON 65
ci_67                -7.901992e-04 3 1  ON 66
ci_68                -8.258313e-05 3 1  ON 67
ci_69                -3.125793e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8636
    reference variance = 0.494788
====================================================
  Execution time = 4.1324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9493e-01
  Total weights = 1.9635e+06
  Execution time = 5.8945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480839244046
                                         uncertainty =       0.003648768946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480839244046
                                         uncertainty =       0.003648768946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490275367
  error estimate for blocks of size 2^( 2) =       0.000511768400
  error estimate for blocks of size 2^( 3) =       0.000531774436
  error estimate for blocks of size 2^( 4) =       0.000546826798
  error estimate for blocks of size 2^( 5) =       0.000556059085
  error estimate for blocks of size 2^( 6) =       0.000562133770
  error estimate for blocks of size 2^( 7) =       0.000561049235

      target function =      -0.649019027588
              le_mean =     -22.815702076410
             les_mean =     521.051222433807
             stat err =       0.000556517222
             autocorr =       1.288478184879
   target nu stat err =       0.000556517222
   target dn stat err =       0.003989496103
      target stat err =       0.001585232769
              std dev =       0.693354073315
             le_variance =       0.480739870983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480741458809
                                         uncertainty =       0.003645020256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480741458809
                                         uncertainty =       0.003645020256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490225496
  error estimate for blocks of size 2^( 2) =       0.000511718277
  error estimate for blocks of size 2^( 3) =       0.000531724373
  error estimate for blocks of size 2^( 4) =       0.000546778444
  error estimate for blocks of size 2^( 5) =       0.000556011238
  error estimate for blocks of size 2^( 6) =       0.000562083765
  error estimate for blocks of size 2^( 7) =       0.000560998311

      target function =      -0.649067142488
              le_mean =     -22.815702312139
             les_mean =     521.051109516923
             stat err =       0.000556467939
             autocorr =       1.288512113224
   target nu stat err =       0.000556467939
   target dn stat err =       0.003984200976
      target stat err =       0.001583445378
              std dev =       0.693283545540
             le_variance =       0.480642074517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480790094919
                                         uncertainty =       0.003646887994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480790094919
                                         uncertainty =       0.003646887994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490250302
  error estimate for blocks of size 2^( 2) =       0.000511743206
  error estimate for blocks of size 2^( 3) =       0.000531749272
  error estimate for blocks of size 2^( 4) =       0.000546802488
  error estimate for blocks of size 2^( 5) =       0.000556035030
  error estimate for blocks of size 2^( 6) =       0.000562108630
  error estimate for blocks of size 2^( 7) =       0.000561023628

      target function =      -0.649044720564
              le_mean =     -22.815702181189
             les_mean =     521.051161158206
             stat err =       0.000556492444
             autocorr =       1.288495199493
   target nu stat err =       0.000556492444
   target dn stat err =       0.003986791823
      target stat err =       0.001584325364
              std dev =       0.693318625345
             le_variance =       0.480690716250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480833084051
                                         uncertainty =       0.003648533478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480833084051
                                         uncertainty =       0.003648533478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490272226
  error estimate for blocks of size 2^( 2) =       0.000511765242
  error estimate for blocks of size 2^( 3) =       0.000531771282
  error estimate for blocks of size 2^( 4) =       0.000546823750
  error estimate for blocks of size 2^( 5) =       0.000556056069
  error estimate for blocks of size 2^( 6) =       0.000562130618
  error estimate for blocks of size 2^( 7) =       0.000561046024

      target function =      -0.649022392558
              le_mean =     -22.815702088011
             les_mean =     521.051214310129
             stat err =       0.000556514116
             autocorr =       1.288480313431
   target nu stat err =       0.000556514116
   target dn stat err =       0.003989152370
      target stat err =       0.001585117915
              std dev =       0.693349630626
             le_variance =       0.480733710290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.649019027588        initial
     9.7656e+00     9.7656e+01             8.5252e-05        -0.649067142488  <--
     3.9062e+01     3.9062e+02             2.1385e-05        -0.649044720564
     1.5625e+02     1.5625e+03             5.3506e-06        -0.649022392558

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 7.0895e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_01                 1.456551e-01 3 1  ON 0
ci_02                -4.208302e-02 3 1  ON 1
ci_03                -4.186897e-02 3 1  ON 2
ci_04                 3.943467e-02 3 1  ON 3
ci_05                -3.014286e-02 3 1  ON 4
ci_06                -3.039955e-02 3 1  ON 5
ci_07                 2.850381e-02 3 1  ON 6
ci_08                -1.154460e-02 3 1  ON 7
ci_09                -1.296239e-02 3 1  ON 8
ci_10                -1.343144e-02 3 1  ON 9
ci_11                 1.475914e-02 3 1  ON 10
ci_12                 1.045886e-02 3 1  ON 11
ci_13                 1.224819e-02 3 1  ON 12
ci_14                 1.334430e-02 3 1  ON 13
ci_15                 9.571011e-03 3 1  ON 14
ci_16                 9.515970e-03 3 1  ON 15
ci_17                -9.775284e-03 3 1  ON 16
ci_18                -9.560093e-03 3 1  ON 17
ci_19                 1.023877e-02 3 1  ON 18
ci_20                 8.838269e-03 3 1  ON 19
ci_21                 9.181747e-03 3 1  ON 20
ci_22                 9.432501e-03 3 1  ON 21
ci_23                 5.606434e-03 3 1  ON 22
ci_24                 4.879589e-03 3 1  ON 23
ci_25                 4.039493e-03 3 1  ON 24
ci_26                 3.691069e-03 3 1  ON 25
ci_27                 3.838084e-03 3 1  ON 26
ci_28                 3.242235e-03 3 1  ON 27
ci_29                 3.428755e-03 3 1  ON 28
ci_30                -2.496812e-03 3 1  ON 29
ci_31                -2.476142e-03 3 1  ON 30
ci_32                -1.921527e-03 3 1  ON 31
ci_33                -2.025594e-03 3 1  ON 32
ci_34                 1.445544e-03 3 1  ON 33
ci_35                 1.735611e-03 3 1  ON 34
ci_36                -1.777128e-03 3 1  ON 35
ci_37                -1.775574e-03 3 1  ON 36
ci_38                -1.178019e-03 3 1  ON 37
ci_39                -1.215604e-03 3 1  ON 38
ci_40                -1.771050e-03 3 1  ON 39
ci_41                -1.379799e-03 3 1  ON 40
ci_42                -1.138581e-03 3 1  ON 41
ci_43                -2.132444e-03 3 1  ON 42
ci_44                -1.847317e-03 3 1  ON 43
ci_45                -1.078332e-03 3 1  ON 44
ci_46                -1.116094e-03 3 1  ON 45
ci_47                -7.859326e-04 3 1  ON 46
ci_48                -7.688322e-04 3 1  ON 47
ci_49                -1.552279e-03 3 1  ON 48
ci_50                -1.177163e-03 3 1  ON 49
ci_51                 1.070449e-03 3 1  ON 50
ci_52                 1.203211e-03 3 1  ON 51
ci_53                -1.083683e-03 3 1  ON 52
ci_54                -1.106528e-03 3 1  ON 53
ci_55                -1.084101e-03 3 1  ON 54
ci_56                 1.636928e-03 3 1  ON 55
ci_57                 1.712735e-03 3 1  ON 56
ci_58                -1.021339e-03 3 1  ON 57
ci_59                -9.951708e-04 3 1  ON 58
ci_60                 7.927808e-04 3 1  ON 59
ci_61                 1.114119e-03 3 1  ON 60
ci_62                -9.114311e-04 3 1  ON 61
ci_63                -7.358166e-04 3 1  ON 62
ci_64                -7.514442e-04 3 1  ON 63
ci_65                -7.245420e-04 3 1  ON 64
ci_66                -8.248477e-04 3 1  ON 65
ci_67                -7.886773e-04 3 1  ON 66
ci_68                -8.603007e-05 3 1  ON 67
ci_69                -3.115985e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2259e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7726
    reference variance = 0.271489
====================================================
  Execution time = 4.2563e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9318e-01
  Total weights = 1.963371210e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477463603406
                                         uncertainty =       0.002729986622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477463603406
                                         uncertainty =       0.002729986622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488600358
  error estimate for blocks of size 2^( 2) =       0.000509697700
  error estimate for blocks of size 2^( 3) =       0.000529599485
  error estimate for blocks of size 2^( 4) =       0.000544391831
  error estimate for blocks of size 2^( 5) =       0.000554568867
  error estimate for blocks of size 2^( 6) =       0.000560699966
  error estimate for blocks of size 2^( 7) =       0.000560747592

      target function =      -0.650112796259
              le_mean =     -22.817343099485
             les_mean =     521.124330600903
             stat err =       0.000555102064
             autocorr =       1.290738080008
   target nu stat err =       0.000555102064
   target dn stat err =       0.003472508564
      target stat err =       0.001395979530
              std dev =       0.690985252481
             le_variance =       0.477460619147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281734309948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650115354770       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650181374416       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650191062326       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650192639696       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650193416369       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650193630142       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650193610128       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650193619215       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650193620060       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.306700e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650115354770       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650132074257       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650134517635       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650134912897       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650135106402       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650135159053       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650135153967       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650135156207       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650135156413       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 8.377751e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650115354770       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650119548269       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650120160463       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650120259334       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650120307666       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650120320779       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650120319502       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650120320060       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650120320111       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 2.101491e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0197e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_01                 1.455723e-01 3 1  ON 0
ci_02                -4.200813e-02 3 1  ON 1
ci_03                -4.179607e-02 3 1  ON 2
ci_04                 3.935089e-02 3 1  ON 3
ci_05                -3.010271e-02 3 1  ON 4
ci_06                -3.035017e-02 3 1  ON 5
ci_07                 2.849307e-02 3 1  ON 6
ci_08                -1.150983e-02 3 1  ON 7
ci_09                -1.294095e-02 3 1  ON 8
ci_10                -1.341175e-02 3 1  ON 9
ci_11                 1.474986e-02 3 1  ON 10
ci_12                 1.043926e-02 3 1  ON 11
ci_13                 1.224249e-02 3 1  ON 12
ci_14                 1.334608e-02 3 1  ON 13
ci_15                 9.553113e-03 3 1  ON 14
ci_16                 9.504519e-03 3 1  ON 15
ci_17                -9.768152e-03 3 1  ON 16
ci_18                -9.550138e-03 3 1  ON 17
ci_19                 1.023165e-02 3 1  ON 18
ci_20                 8.828963e-03 3 1  ON 19
ci_21                 9.179058e-03 3 1  ON 20
ci_22                 9.430993e-03 3 1  ON 21
ci_23                 5.602563e-03 3 1  ON 22
ci_24                 4.887668e-03 3 1  ON 23
ci_25                 4.033244e-03 3 1  ON 24
ci_26                 3.685620e-03 3 1  ON 25
ci_27                 3.830224e-03 3 1  ON 26
ci_28                 3.230281e-03 3 1  ON 27
ci_29                 3.426463e-03 3 1  ON 28
ci_30                -2.493627e-03 3 1  ON 29
ci_31                -2.468609e-03 3 1  ON 30
ci_32                -1.915650e-03 3 1  ON 31
ci_33                -2.018610e-03 3 1  ON 32
ci_34                 1.443885e-03 3 1  ON 33
ci_35                 1.727896e-03 3 1  ON 34
ci_36                -1.772298e-03 3 1  ON 35
ci_37                -1.769190e-03 3 1  ON 36
ci_38                -1.174871e-03 3 1  ON 37
ci_39                -1.212377e-03 3 1  ON 38
ci_40                -1.774272e-03 3 1  ON 39
ci_41                -1.374298e-03 3 1  ON 40
ci_42                -1.137453e-03 3 1  ON 41
ci_43                -2.127634e-03 3 1  ON 42
ci_44                -1.850014e-03 3 1  ON 43
ci_45                -1.073325e-03 3 1  ON 44
ci_46                -1.112498e-03 3 1  ON 45
ci_47                -7.815179e-04 3 1  ON 46
ci_48                -7.662196e-04 3 1  ON 47
ci_49                -1.550384e-03 3 1  ON 48
ci_50                -1.177165e-03 3 1  ON 49
ci_51                 1.064454e-03 3 1  ON 50
ci_52                 1.202774e-03 3 1  ON 51
ci_53                -1.082083e-03 3 1  ON 52
ci_54                -1.105919e-03 3 1  ON 53
ci_55                -1.080873e-03 3 1  ON 54
ci_56                 1.634256e-03 3 1  ON 55
ci_57                 1.710224e-03 3 1  ON 56
ci_58                -1.018940e-03 3 1  ON 57
ci_59                -9.985477e-04 3 1  ON 58
ci_60                 7.944533e-04 3 1  ON 59
ci_61                 1.112468e-03 3 1  ON 60
ci_62                -9.105924e-04 3 1  ON 61
ci_63                -7.326120e-04 3 1  ON 62
ci_64                -7.505532e-04 3 1  ON 63
ci_65                -7.171562e-04 3 1  ON 64
ci_66                -8.213697e-04 3 1  ON 65
ci_67                -7.901720e-04 3 1  ON 66
ci_68                -9.147699e-05 3 1  ON 67
ci_69                -3.206906e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.709
    reference variance = 0.617408
====================================================
  Execution time = 4.1384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9831e-01
  Total weights = 1.9634e+06
  Execution time = 5.9560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483336828771
                                         uncertainty =       0.003368400679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483336828771
                                         uncertainty =       0.003368400679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491569509
  error estimate for blocks of size 2^( 2) =       0.000512910639
  error estimate for blocks of size 2^( 3) =       0.000532981842
  error estimate for blocks of size 2^( 4) =       0.000548078571
  error estimate for blocks of size 2^( 5) =       0.000556457269
  error estimate for blocks of size 2^( 6) =       0.000562002570
  error estimate for blocks of size 2^( 7) =       0.000565496007

      target function =      -0.647990257436
              le_mean =     -22.816959787813
             les_mean =     521.112052524620
             stat err =       0.000558008604
             autocorr =       1.288581577103
   target nu stat err =       0.000558008604
   target dn stat err =       0.003963021900
      target stat err =       0.001572313797
              std dev =       0.695184266237
             le_variance =       0.483281164024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482988608809
                                         uncertainty =       0.003359402339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482988608809
                                         uncertainty =       0.003359402339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491392432
  error estimate for blocks of size 2^( 2) =       0.000512729333
  error estimate for blocks of size 2^( 3) =       0.000532801675
  error estimate for blocks of size 2^( 4) =       0.000547902650
  error estimate for blocks of size 2^( 5) =       0.000556283593
  error estimate for blocks of size 2^( 6) =       0.000561827514
  error estimate for blocks of size 2^( 7) =       0.000565323110

      target function =      -0.648048936858
              le_mean =     -22.816957518470
             les_mean =     521.111796125267
             stat err =       0.000557834217
             autocorr =       1.288704581785
   target nu stat err =       0.000557834217
   target dn stat err =       0.003981111831
      target stat err =       0.001579422357
              std dev =       0.694933841773
             le_variance =       0.482933044442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483159149032
                                         uncertainty =       0.003363800312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483159149032
                                         uncertainty =       0.003363800312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491479164
  error estimate for blocks of size 2^( 2) =       0.000512818117
  error estimate for blocks of size 2^( 3) =       0.000532889881
  error estimate for blocks of size 2^( 4) =       0.000547988766
  error estimate for blocks of size 2^( 5) =       0.000556368628
  error estimate for blocks of size 2^( 6) =       0.000561913142
  error estimate for blocks of size 2^( 7) =       0.000565407715

      target function =      -0.648044100367
              le_mean =     -22.816958420392
             les_mean =     521.111850387200
             stat err =       0.000557919563
             autocorr =       1.288644007335
   target nu stat err =       0.000557919563
   target dn stat err =       0.003966554607
      target stat err =       0.001573894588
              std dev =       0.695056498709
             le_variance =       0.483103536398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483314392211
                                         uncertainty =       0.003367819625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483314392211
                                         uncertainty =       0.003367819625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491558101
  error estimate for blocks of size 2^( 2) =       0.000512898954
  error estimate for blocks of size 2^( 3) =       0.000532970225
  error estimate for blocks of size 2^( 4) =       0.000548067226
  error estimate for blocks of size 2^( 5) =       0.000556446072
  error estimate for blocks of size 2^( 6) =       0.000561991269
  error estimate for blocks of size 2^( 7) =       0.000565484853

      target function =      -0.647999542500
              le_mean =     -22.816959589409
             les_mean =     521.112019397957
             stat err =       0.000557997355
             autocorr =       1.288589429129
   target nu stat err =       0.000557997355
   target dn stat err =       0.003963041351
      target stat err =       0.001572363494
              std dev =       0.695168133712
             le_variance =       0.483258734128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647990257436        initial
     2.4414e+00     2.4414e+01             3.3067e-04        -0.648048936858  <--
     9.7656e+00     9.7656e+01             8.3778e-05        -0.648044100367
     3.9062e+01     3.9062e+02             2.1015e-05        -0.647999542500

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 7.1286e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_01                 1.453262e-01 3 1  ON 0
ci_02                -4.178695e-02 3 1  ON 1
ci_03                -4.158075e-02 3 1  ON 2
ci_04                 3.910400e-02 3 1  ON 3
ci_05                -2.998429e-02 3 1  ON 4
ci_06                -3.020452e-02 3 1  ON 5
ci_07                 2.846131e-02 3 1  ON 6
ci_08                -1.140733e-02 3 1  ON 7
ci_09                -1.287754e-02 3 1  ON 8
ci_10                -1.335349e-02 3 1  ON 9
ci_11                 1.472246e-02 3 1  ON 10
ci_12                 1.038144e-02 3 1  ON 11
ci_13                 1.222564e-02 3 1  ON 12
ci_14                 1.335145e-02 3 1  ON 13
ci_15                 9.500252e-03 3 1  ON 14
ci_16                 9.470695e-03 3 1  ON 15
ci_17                -9.747041e-03 3 1  ON 16
ci_18                -9.520662e-03 3 1  ON 17
ci_19                 1.021070e-02 3 1  ON 18
ci_20                 8.801530e-03 3 1  ON 19
ci_21                 9.171067e-03 3 1  ON 20
ci_22                 9.426496e-03 3 1  ON 21
ci_23                 5.591178e-03 3 1  ON 22
ci_24                 4.911665e-03 3 1  ON 23
ci_25                 4.014833e-03 3 1  ON 24
ci_26                 3.669548e-03 3 1  ON 25
ci_27                 3.807034e-03 3 1  ON 26
ci_28                 3.194940e-03 3 1  ON 27
ci_29                 3.419626e-03 3 1  ON 28
ci_30                -2.484197e-03 3 1  ON 29
ci_31                -2.446284e-03 3 1  ON 30
ci_32                -1.898385e-03 3 1  ON 31
ci_33                -1.998094e-03 3 1  ON 32
ci_34                 1.439103e-03 3 1  ON 33
ci_35                 1.705223e-03 3 1  ON 34
ci_36                -1.758041e-03 3 1  ON 35
ci_37                -1.750349e-03 3 1  ON 36
ci_38                -1.165585e-03 3 1  ON 37
ci_39                -1.202840e-03 3 1  ON 38
ci_40                -1.783730e-03 3 1  ON 39
ci_41                -1.358164e-03 3 1  ON 40
ci_42                -1.134200e-03 3 1  ON 41
ci_43                -2.113383e-03 3 1  ON 42
ci_44                -1.857934e-03 3 1  ON 43
ci_45                -1.058550e-03 3 1  ON 44
ci_46                -1.101885e-03 3 1  ON 45
ci_47                -7.683746e-04 3 1  ON 46
ci_48                -7.584325e-04 3 1  ON 47
ci_49                -1.544804e-03 3 1  ON 48
ci_50                -1.177148e-03 3 1  ON 49
ci_51                 1.046760e-03 3 1  ON 50
ci_52                 1.201460e-03 3 1  ON 51
ci_53                -1.077341e-03 3 1  ON 52
ci_54                -1.104138e-03 3 1  ON 53
ci_55                -1.071347e-03 3 1  ON 54
ci_56                 1.626391e-03 3 1  ON 55
ci_57                 1.702834e-03 3 1  ON 56
ci_58                -1.011869e-03 3 1  ON 57
ci_59                -1.008493e-03 3 1  ON 58
ci_60                 7.994123e-04 3 1  ON 59
ci_61                 1.107553e-03 3 1  ON 60
ci_62                -9.081071e-04 3 1  ON 61
ci_63                -7.231614e-04 3 1  ON 62
ci_64                -7.479103e-04 3 1  ON 63
ci_65                -6.953680e-04 3 1  ON 64
ci_66                -8.110753e-04 3 1  ON 65
ci_67                -7.945707e-04 3 1  ON 66
ci_68                -1.075574e-04 3 1  ON 67
ci_69                -3.475519e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2149e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7342
    reference variance = 0.366261
====================================================
  Execution time = 4.4523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9555e-01
  Total weights = 1.963439155e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481116677890
                                         uncertainty =       0.002965555393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481116677890
                                         uncertainty =       0.002965555393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490466351
  error estimate for blocks of size 2^( 2) =       0.000511509619
  error estimate for blocks of size 2^( 3) =       0.000530895163
  error estimate for blocks of size 2^( 4) =       0.000547402012
  error estimate for blocks of size 2^( 5) =       0.000556513757
  error estimate for blocks of size 2^( 6) =       0.000561730338
  error estimate for blocks of size 2^( 7) =       0.000560992664

      target function =      -0.649135981354
              le_mean =     -22.817126603145
             les_mean =     521.116821180606
             stat err =       0.000556659693
             autocorr =       1.288134215459
   target nu stat err =       0.000556659693
   target dn stat err =       0.003557510751
      target stat err =       0.001423987115
              std dev =       0.693624165412
             le_variance =       0.481114482844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281712660315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649138686174       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649355977831       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649393504065       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649399554111       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649401286385       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649402066364       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649402013397       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649401990645       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649401981545       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.390085e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649138686174       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649195781317       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649205466288       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649206991978       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649207413813       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649207598304       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649207583576       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649207578152       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649207576000       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.581626e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649138686174       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649153144332       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649155585105       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649155967228       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649156071895       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649156117321       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649156113550       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649156112212       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649156111682       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 9.023270e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2285e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_01                 1.449681e-01 3 1  ON 0
ci_02                -4.151979e-02 3 1  ON 1
ci_03                -4.131821e-02 3 1  ON 2
ci_04                 3.880099e-02 3 1  ON 3
ci_05                -2.977921e-02 3 1  ON 4
ci_06                -3.002772e-02 3 1  ON 5
ci_07                 2.841999e-02 3 1  ON 6
ci_08                -1.128511e-02 3 1  ON 7
ci_09                -1.281491e-02 3 1  ON 8
ci_10                -1.325993e-02 3 1  ON 9
ci_11                 1.468523e-02 3 1  ON 10
ci_12                 1.033346e-02 3 1  ON 11
ci_13                 1.223086e-02 3 1  ON 12
ci_14                 1.335912e-02 3 1  ON 13
ci_15                 9.461763e-03 3 1  ON 14
ci_16                 9.416596e-03 3 1  ON 15
ci_17                -9.682226e-03 3 1  ON 16
ci_18                -9.486770e-03 3 1  ON 17
ci_19                 1.018883e-02 3 1  ON 18
ci_20                 8.758790e-03 3 1  ON 19
ci_21                 9.171761e-03 3 1  ON 20
ci_22                 9.401466e-03 3 1  ON 21
ci_23                 5.561625e-03 3 1  ON 22
ci_24                 4.891333e-03 3 1  ON 23
ci_25                 3.985620e-03 3 1  ON 24
ci_26                 3.661128e-03 3 1  ON 25
ci_27                 3.783994e-03 3 1  ON 26
ci_28                 3.181866e-03 3 1  ON 27
ci_29                 3.408375e-03 3 1  ON 28
ci_30                -2.478122e-03 3 1  ON 29
ci_31                -2.428407e-03 3 1  ON 30
ci_32                -1.878060e-03 3 1  ON 31
ci_33                -1.967275e-03 3 1  ON 32
ci_34                 1.428602e-03 3 1  ON 33
ci_35                 1.702610e-03 3 1  ON 34
ci_36                -1.751301e-03 3 1  ON 35
ci_37                -1.750779e-03 3 1  ON 36
ci_38                -1.143882e-03 3 1  ON 37
ci_39                -1.197863e-03 3 1  ON 38
ci_40                -1.775047e-03 3 1  ON 39
ci_41                -1.353543e-03 3 1  ON 40
ci_42                -1.115275e-03 3 1  ON 41
ci_43                -2.119041e-03 3 1  ON 42
ci_44                -1.848015e-03 3 1  ON 43
ci_45                -1.046351e-03 3 1  ON 44
ci_46                -1.074922e-03 3 1  ON 45
ci_47                -7.438450e-04 3 1  ON 46
ci_48                -7.284348e-04 3 1  ON 47
ci_49                -1.523501e-03 3 1  ON 48
ci_50                -1.161417e-03 3 1  ON 49
ci_51                 1.024275e-03 3 1  ON 50
ci_52                 1.183136e-03 3 1  ON 51
ci_53                -1.075115e-03 3 1  ON 52
ci_54                -1.105308e-03 3 1  ON 53
ci_55                -1.061007e-03 3 1  ON 54
ci_56                 1.623259e-03 3 1  ON 55
ci_57                 1.703546e-03 3 1  ON 56
ci_58                -1.010680e-03 3 1  ON 57
ci_59                -9.969567e-04 3 1  ON 58
ci_60                 7.949249e-04 3 1  ON 59
ci_61                 1.104663e-03 3 1  ON 60
ci_62                -8.947781e-04 3 1  ON 61
ci_63                -7.277262e-04 3 1  ON 62
ci_64                -7.344760e-04 3 1  ON 63
ci_65                -6.852160e-04 3 1  ON 64
ci_66                -7.981947e-04 3 1  ON 65
ci_67                -7.861900e-04 3 1  ON 66
ci_68                -1.479354e-04 3 1  ON 67
ci_69                -3.558654e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7887
    reference variance = 0.5234
====================================================
  Execution time = 4.3292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9700e-01
  Total weights = 1.9632e+06
  Execution time = 5.9477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482285611912
                                         uncertainty =       0.003003995550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482285611912
                                         uncertainty =       0.003003995550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491042279
  error estimate for blocks of size 2^( 2) =       0.000511710415
  error estimate for blocks of size 2^( 3) =       0.000532081454
  error estimate for blocks of size 2^( 4) =       0.000547304055
  error estimate for blocks of size 2^( 5) =       0.000557190558
  error estimate for blocks of size 2^( 6) =       0.000560975662
  error estimate for blocks of size 2^( 7) =       0.000566107577

      target function =      -0.584955470960
              le_mean =     -22.816598382489
             les_mean =     521.260518456723
             stat err =       0.000557894463
             autocorr =       1.290821908847
   target nu stat err =       0.000557894463
   target dn stat err =       0.166048609687
      target stat err =       0.052872345019
              std dev =       0.694438651341
             le_variance =       0.482245040477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481048567567
                                         uncertainty =       0.002991831686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481048567567
                                         uncertainty =       0.002991831686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490411418
  error estimate for blocks of size 2^( 2) =       0.000511078594
  error estimate for blocks of size 2^( 3) =       0.000531457002
  error estimate for blocks of size 2^( 4) =       0.000546696662
  error estimate for blocks of size 2^( 5) =       0.000556583859
  error estimate for blocks of size 2^( 6) =       0.000560404087
  error estimate for blocks of size 2^( 7) =       0.000565578834

      target function =      -0.635258514544
              le_mean =     -22.816609470028
             les_mean =     521.128690434140
             stat err =       0.000557315861
             autocorr =       1.291462078946
   target nu stat err =       0.000557315861
   target dn stat err =       0.033942438252
      target stat err =       0.012652482868
              std dev =       0.693546479077
             le_variance =       0.481006718640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481611993476
                                         uncertainty =       0.002998143615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481611993476
                                         uncertainty =       0.002998143615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490698863
  error estimate for blocks of size 2^( 2) =       0.000511366384
  error estimate for blocks of size 2^( 3) =       0.000531740009
  error estimate for blocks of size 2^( 4) =       0.000546972346
  error estimate for blocks of size 2^( 5) =       0.000556856321
  error estimate for blocks of size 2^( 6) =       0.000560653818
  error estimate for blocks of size 2^( 7) =       0.000565811529

      target function =      -0.648553588984
              le_mean =     -22.816601726509
             les_mean =     521.094038292591
             stat err =       0.000557573504
             autocorr =       1.291142424692
   target nu stat err =       0.000557573504
   target dn stat err =       0.003797521000
      target stat err =       0.001511677746
              std dev =       0.693952987193
             le_variance =       0.481570748434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482188687623
                                         uncertainty =       0.003004706558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482188687623
                                         uncertainty =       0.003004706558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490992876
  error estimate for blocks of size 2^( 2) =       0.000511661280
  error estimate for blocks of size 2^( 3) =       0.000532030744
  error estimate for blocks of size 2^( 4) =       0.000547256421
  error estimate for blocks of size 2^( 5) =       0.000557137410
  error estimate for blocks of size 2^( 6) =       0.000560916714
  error estimate for blocks of size 2^( 7) =       0.000566059635

      target function =      -0.648329664205
              le_mean =     -22.816600464299
             les_mean =     521.094556872979
             stat err =       0.000557842545
             autocorr =       1.290841399824
   target nu stat err =       0.000557842545
   target dn stat err =       0.003797368670
      target stat err =       0.001510635664
              std dev =       0.694368784018
             le_variance =       0.482148008218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.584955470960        initial
     6.1035e-01     6.1035e+00             1.3901e-03        -0.635258514544
     2.4414e+00     2.4414e+01             3.5816e-04        -0.648553588984  <--
     9.7656e+00     9.7656e+01             9.0233e-05        -0.648329664205

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 7.3328e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_01                 1.449681e-01 3 1  ON 0
ci_02                -4.151979e-02 3 1  ON 1
ci_03                -4.131821e-02 3 1  ON 2
ci_04                 3.880099e-02 3 1  ON 3
ci_05                -2.977921e-02 3 1  ON 4
ci_06                -3.002772e-02 3 1  ON 5
ci_07                 2.841999e-02 3 1  ON 6
ci_08                -1.128511e-02 3 1  ON 7
ci_09                -1.281491e-02 3 1  ON 8
ci_10                -1.325993e-02 3 1  ON 9
ci_11                 1.468523e-02 3 1  ON 10
ci_12                 1.033346e-02 3 1  ON 11
ci_13                 1.223086e-02 3 1  ON 12
ci_14                 1.335912e-02 3 1  ON 13
ci_15                 9.461763e-03 3 1  ON 14
ci_16                 9.416596e-03 3 1  ON 15
ci_17                -9.682226e-03 3 1  ON 16
ci_18                -9.486770e-03 3 1  ON 17
ci_19                 1.018883e-02 3 1  ON 18
ci_20                 8.758790e-03 3 1  ON 19
ci_21                 9.171761e-03 3 1  ON 20
ci_22                 9.401466e-03 3 1  ON 21
ci_23                 5.561625e-03 3 1  ON 22
ci_24                 4.891333e-03 3 1  ON 23
ci_25                 3.985620e-03 3 1  ON 24
ci_26                 3.661128e-03 3 1  ON 25
ci_27                 3.783994e-03 3 1  ON 26
ci_28                 3.181866e-03 3 1  ON 27
ci_29                 3.408375e-03 3 1  ON 28
ci_30                -2.478122e-03 3 1  ON 29
ci_31                -2.428407e-03 3 1  ON 30
ci_32                -1.878060e-03 3 1  ON 31
ci_33                -1.967275e-03 3 1  ON 32
ci_34                 1.428602e-03 3 1  ON 33
ci_35                 1.702610e-03 3 1  ON 34
ci_36                -1.751301e-03 3 1  ON 35
ci_37                -1.750779e-03 3 1  ON 36
ci_38                -1.143882e-03 3 1  ON 37
ci_39                -1.197863e-03 3 1  ON 38
ci_40                -1.775047e-03 3 1  ON 39
ci_41                -1.353543e-03 3 1  ON 40
ci_42                -1.115275e-03 3 1  ON 41
ci_43                -2.119041e-03 3 1  ON 42
ci_44                -1.848015e-03 3 1  ON 43
ci_45                -1.046351e-03 3 1  ON 44
ci_46                -1.074922e-03 3 1  ON 45
ci_47                -7.438450e-04 3 1  ON 46
ci_48                -7.284348e-04 3 1  ON 47
ci_49                -1.523501e-03 3 1  ON 48
ci_50                -1.161417e-03 3 1  ON 49
ci_51                 1.024275e-03 3 1  ON 50
ci_52                 1.183136e-03 3 1  ON 51
ci_53                -1.075115e-03 3 1  ON 52
ci_54                -1.105308e-03 3 1  ON 53
ci_55                -1.061007e-03 3 1  ON 54
ci_56                 1.623259e-03 3 1  ON 55
ci_57                 1.703546e-03 3 1  ON 56
ci_58                -1.010680e-03 3 1  ON 57
ci_59                -9.969567e-04 3 1  ON 58
ci_60                 7.949249e-04 3 1  ON 59
ci_61                 1.104663e-03 3 1  ON 60
ci_62                -8.947781e-04 3 1  ON 61
ci_63                -7.277262e-04 3 1  ON 62
ci_64                -7.344760e-04 3 1  ON 63
ci_65                -6.852160e-04 3 1  ON 64
ci_66                -7.981947e-04 3 1  ON 65
ci_67                -7.861900e-04 3 1  ON 66
ci_68                -1.479354e-04 3 1  ON 67
ci_69                -3.558654e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2562e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8844
    reference variance = 0.506329
====================================================
  Execution time = 4.2891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9235e-01
  Total weights = 1.963613496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477289995638
                                         uncertainty =       0.002470591447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477289995638
                                         uncertainty =       0.002470591447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488513969
  error estimate for blocks of size 2^( 2) =       0.000509114496
  error estimate for blocks of size 2^( 3) =       0.000528973440
  error estimate for blocks of size 2^( 4) =       0.000543548632
  error estimate for blocks of size 2^( 5) =       0.000552493103
  error estimate for blocks of size 2^( 6) =       0.000557304131
  error estimate for blocks of size 2^( 7) =       0.000560683229

      target function =      -0.650388652287
              le_mean =     -22.817143153952
             les_mean =     521.114375835388
             stat err =       0.000553507274
             autocorr =       1.283786166557
   target nu stat err =       0.000553507274
   target dn stat err =       0.003070050264
      target stat err =       0.001244508755
              std dev =       0.690863080044
             le_variance =       0.477291795368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281714315395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650390609963       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650609529018       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650644897413       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650650497837       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650651757604       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650652215543       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650652404863       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650652416546       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650652417433       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650652413418       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.344079e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650390609963       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650448158460       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650457285546       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650458695224       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650458999206       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650459107490       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650459152518       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650459155045       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650459155247       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.462774e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650390609963       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650405184659       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650407484765       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650407837661       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650407912899       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650407939566       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650407950672       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650407951279       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650407951328       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 8.723869e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0642e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_01                 1.446218e-01 3 1  ON 0
ci_02                -4.122961e-02 3 1  ON 1
ci_03                -4.106636e-02 3 1  ON 2
ci_04                 3.848090e-02 3 1  ON 3
ci_05                -2.960558e-02 3 1  ON 4
ci_06                -2.986386e-02 3 1  ON 5
ci_07                 2.838219e-02 3 1  ON 6
ci_08                -1.116519e-02 3 1  ON 7
ci_09                -1.271663e-02 3 1  ON 8
ci_10                -1.318597e-02 3 1  ON 9
ci_11                 1.466403e-02 3 1  ON 10
ci_12                 1.027807e-02 3 1  ON 11
ci_13                 1.220929e-02 3 1  ON 12
ci_14                 1.337798e-02 3 1  ON 13
ci_15                 9.424281e-03 3 1  ON 14
ci_16                 9.375726e-03 3 1  ON 15
ci_17                -9.639572e-03 3 1  ON 16
ci_18                -9.465379e-03 3 1  ON 17
ci_19                 1.016687e-02 3 1  ON 18
ci_20                 8.734467e-03 3 1  ON 19
ci_21                 9.151140e-03 3 1  ON 20
ci_22                 9.377933e-03 3 1  ON 21
ci_23                 5.534816e-03 3 1  ON 22
ci_24                 4.882922e-03 3 1  ON 23
ci_25                 3.981371e-03 3 1  ON 24
ci_26                 3.645766e-03 3 1  ON 25
ci_27                 3.750801e-03 3 1  ON 26
ci_28                 3.171131e-03 3 1  ON 27
ci_29                 3.370883e-03 3 1  ON 28
ci_30                -2.479953e-03 3 1  ON 29
ci_31                -2.416772e-03 3 1  ON 30
ci_32                -1.857730e-03 3 1  ON 31
ci_33                -1.942929e-03 3 1  ON 32
ci_34                 1.414878e-03 3 1  ON 33
ci_35                 1.699942e-03 3 1  ON 34
ci_36                -1.733379e-03 3 1  ON 35
ci_37                -1.736386e-03 3 1  ON 36
ci_38                -1.131619e-03 3 1  ON 37
ci_39                -1.177994e-03 3 1  ON 38
ci_40                -1.775719e-03 3 1  ON 39
ci_41                -1.319803e-03 3 1  ON 40
ci_42                -1.119107e-03 3 1  ON 41
ci_43                -2.107788e-03 3 1  ON 42
ci_44                -1.857350e-03 3 1  ON 43
ci_45                -1.026749e-03 3 1  ON 44
ci_46                -1.081680e-03 3 1  ON 45
ci_47                -7.228814e-04 3 1  ON 46
ci_48                -7.124085e-04 3 1  ON 47
ci_49                -1.509280e-03 3 1  ON 48
ci_50                -1.149474e-03 3 1  ON 49
ci_51                 1.025645e-03 3 1  ON 50
ci_52                 1.159266e-03 3 1  ON 51
ci_53                -1.061899e-03 3 1  ON 52
ci_54                -1.105432e-03 3 1  ON 53
ci_55                -1.071427e-03 3 1  ON 54
ci_56                 1.639278e-03 3 1  ON 55
ci_57                 1.714821e-03 3 1  ON 56
ci_58                -9.984439e-04 3 1  ON 57
ci_59                -9.813415e-04 3 1  ON 58
ci_60                 7.644795e-04 3 1  ON 59
ci_61                 1.089161e-03 3 1  ON 60
ci_62                -8.755423e-04 3 1  ON 61
ci_63                -7.197457e-04 3 1  ON 62
ci_64                -7.253534e-04 3 1  ON 63
ci_65                -6.792552e-04 3 1  ON 64
ci_66                -7.740764e-04 3 1  ON 65
ci_67                -7.818576e-04 3 1  ON 66
ci_68                -1.656801e-04 3 1  ON 67
ci_69                -3.615058e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7626
    reference variance = 0.554182
====================================================
  Execution time = 4.1764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9194e-01
  Total weights = 1.9632e+06
  Execution time = 5.9365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477109531080
                                         uncertainty =       0.002414235099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477109531080
                                         uncertainty =       0.002414235099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488368475
  error estimate for blocks of size 2^( 2) =       0.000509031197
  error estimate for blocks of size 2^( 3) =       0.000528718485
  error estimate for blocks of size 2^( 4) =       0.000543978069
  error estimate for blocks of size 2^( 5) =       0.000554725154
  error estimate for blocks of size 2^( 6) =       0.000560189475
  error estimate for blocks of size 2^( 7) =       0.000562991423

      target function =      -0.647881549529
              le_mean =     -22.816274186009
             les_mean =     521.080599475404
             stat err =       0.000555471030
             autocorr =       1.293682146416
   target nu stat err =       0.000555471030
   target dn stat err =       0.007011222284
      target stat err =       0.002735873302
              std dev =       0.690657320148
             le_variance =       0.477007533874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476113578502
                                         uncertainty =       0.002416998901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476113578502
                                         uncertainty =       0.002416998901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487857966
  error estimate for blocks of size 2^( 2) =       0.000508517547
  error estimate for blocks of size 2^( 3) =       0.000528211792
  error estimate for blocks of size 2^( 4) =       0.000543479320
  error estimate for blocks of size 2^( 5) =       0.000554258038
  error estimate for blocks of size 2^( 6) =       0.000559724744
  error estimate for blocks of size 2^( 7) =       0.000562521695

      target function =      -0.650098168960
              le_mean =     -22.816283763385
             les_mean =     521.075362371804
             stat err =       0.000554995949
             autocorr =       1.294174459559
   target nu stat err =       0.000554995949
   target dn stat err =       0.003191874189
      target stat err =       0.001288525378
              std dev =       0.689935352276
             le_variance =       0.476010790320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476568336028
                                         uncertainty =       0.002414817817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476568336028
                                         uncertainty =       0.002414817817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488091134
  error estimate for blocks of size 2^( 2) =       0.000508751872
  error estimate for blocks of size 2^( 3) =       0.000528442944
  error estimate for blocks of size 2^( 4) =       0.000543707081
  error estimate for blocks of size 2^( 5) =       0.000554470450
  error estimate for blocks of size 2^( 6) =       0.000559937965
  error estimate for blocks of size 2^( 7) =       0.000562733718

      target function =      -0.650431991035
              le_mean =     -22.816275964344
             les_mean =     521.074146449913
             stat err =       0.000555212304
             autocorr =       1.293946517653
   target nu stat err =       0.000555212304
   target dn stat err =       0.003073122051
      target stat err =       0.001245101860
              std dev =       0.690265100949
             le_variance =       0.476465909588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477037886827
                                         uncertainty =       0.002414259317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477037886827
                                         uncertainty =       0.002414259317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488331770
  error estimate for blocks of size 2^( 2) =       0.000508993851
  error estimate for blocks of size 2^( 3) =       0.000528682076
  error estimate for blocks of size 2^( 4) =       0.000543942384
  error estimate for blocks of size 2^( 5) =       0.000554691729
  error estimate for blocks of size 2^( 6) =       0.000560157846
  error estimate for blocks of size 2^( 7) =       0.000562957301

      target function =      -0.649729178738
              le_mean =     -22.816273737577
             les_mean =     521.075844156412
             stat err =       0.000555437315
             autocorr =       1.293719563612
   target nu stat err =       0.000555437315
   target dn stat err =       0.003474553165
      target stat err =       0.001393825035
              std dev =       0.690605412689
             le_variance =       0.476935836035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647881549529        initial
     6.1035e-01     6.1035e+00             1.3441e-03        -0.650098168960
     2.4414e+00     2.4414e+01             3.4628e-04        -0.650431991035  <--
     9.7656e+00     9.7656e+01             8.7239e-05        -0.649729178738

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 7.1360e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_01                 1.446218e-01 3 1  ON 0
ci_02                -4.122961e-02 3 1  ON 1
ci_03                -4.106636e-02 3 1  ON 2
ci_04                 3.848090e-02 3 1  ON 3
ci_05                -2.960558e-02 3 1  ON 4
ci_06                -2.986386e-02 3 1  ON 5
ci_07                 2.838219e-02 3 1  ON 6
ci_08                -1.116519e-02 3 1  ON 7
ci_09                -1.271663e-02 3 1  ON 8
ci_10                -1.318597e-02 3 1  ON 9
ci_11                 1.466403e-02 3 1  ON 10
ci_12                 1.027807e-02 3 1  ON 11
ci_13                 1.220929e-02 3 1  ON 12
ci_14                 1.337798e-02 3 1  ON 13
ci_15                 9.424281e-03 3 1  ON 14
ci_16                 9.375726e-03 3 1  ON 15
ci_17                -9.639572e-03 3 1  ON 16
ci_18                -9.465379e-03 3 1  ON 17
ci_19                 1.016687e-02 3 1  ON 18
ci_20                 8.734467e-03 3 1  ON 19
ci_21                 9.151140e-03 3 1  ON 20
ci_22                 9.377933e-03 3 1  ON 21
ci_23                 5.534816e-03 3 1  ON 22
ci_24                 4.882922e-03 3 1  ON 23
ci_25                 3.981371e-03 3 1  ON 24
ci_26                 3.645766e-03 3 1  ON 25
ci_27                 3.750801e-03 3 1  ON 26
ci_28                 3.171131e-03 3 1  ON 27
ci_29                 3.370883e-03 3 1  ON 28
ci_30                -2.479953e-03 3 1  ON 29
ci_31                -2.416772e-03 3 1  ON 30
ci_32                -1.857730e-03 3 1  ON 31
ci_33                -1.942929e-03 3 1  ON 32
ci_34                 1.414878e-03 3 1  ON 33
ci_35                 1.699942e-03 3 1  ON 34
ci_36                -1.733379e-03 3 1  ON 35
ci_37                -1.736386e-03 3 1  ON 36
ci_38                -1.131619e-03 3 1  ON 37
ci_39                -1.177994e-03 3 1  ON 38
ci_40                -1.775719e-03 3 1  ON 39
ci_41                -1.319803e-03 3 1  ON 40
ci_42                -1.119107e-03 3 1  ON 41
ci_43                -2.107788e-03 3 1  ON 42
ci_44                -1.857350e-03 3 1  ON 43
ci_45                -1.026749e-03 3 1  ON 44
ci_46                -1.081680e-03 3 1  ON 45
ci_47                -7.228814e-04 3 1  ON 46
ci_48                -7.124085e-04 3 1  ON 47
ci_49                -1.509280e-03 3 1  ON 48
ci_50                -1.149474e-03 3 1  ON 49
ci_51                 1.025645e-03 3 1  ON 50
ci_52                 1.159266e-03 3 1  ON 51
ci_53                -1.061899e-03 3 1  ON 52
ci_54                -1.105432e-03 3 1  ON 53
ci_55                -1.071427e-03 3 1  ON 54
ci_56                 1.639278e-03 3 1  ON 55
ci_57                 1.714821e-03 3 1  ON 56
ci_58                -9.984439e-04 3 1  ON 57
ci_59                -9.813415e-04 3 1  ON 58
ci_60                 7.644795e-04 3 1  ON 59
ci_61                 1.089161e-03 3 1  ON 60
ci_62                -8.755423e-04 3 1  ON 61
ci_63                -7.197457e-04 3 1  ON 62
ci_64                -7.253534e-04 3 1  ON 63
ci_65                -6.792552e-04 3 1  ON 64
ci_66                -7.740764e-04 3 1  ON 65
ci_67                -7.818576e-04 3 1  ON 66
ci_68                -1.656801e-04 3 1  ON 67
ci_69                -3.615058e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2201e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8052
    reference variance = 0.30495
====================================================
  Execution time = 4.2663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9498e-01
  Total weights = 1.963343876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480434811247
                                         uncertainty =       0.002638920318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480434811247
                                         uncertainty =       0.002638920318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490055622
  error estimate for blocks of size 2^( 2) =       0.000510882260
  error estimate for blocks of size 2^( 3) =       0.000530485756
  error estimate for blocks of size 2^( 4) =       0.000545016278
  error estimate for blocks of size 2^( 5) =       0.000553679973
  error estimate for blocks of size 2^( 6) =       0.000556740483
  error estimate for blocks of size 2^( 7) =       0.000558449575

      target function =      -0.649347077854
              le_mean =     -22.817077545981
             les_mean =     521.114011240554
             stat err =       0.000553471577
             autocorr =       1.275557074292
   target nu stat err =       0.000553471577
   target dn stat err =       0.003105864345
      target stat err =       0.001254029299
              std dev =       0.693043306348
             le_variance =       0.480309024474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281707754598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649349102048       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649560946567       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649595768376       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649601263945       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649602893581       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649603287898       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649603380775       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649603377363       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649603373661       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649603377438       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.388485e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649349102048       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649404767301       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649413752873       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649415132069       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649415528304       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649415621778       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649415643193       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649415642234       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649415641390       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.575610e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649349102048       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649363198212       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649365462638       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649365807631       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649365905915       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649365928949       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649365934187       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649365933941       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649365933735       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 9.006969e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0278e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_01                 1.442642e-01 3 1  ON 0
ci_02                -4.095944e-02 3 1  ON 1
ci_03                -4.081928e-02 3 1  ON 2
ci_04                 3.817652e-02 3 1  ON 3
ci_05                -2.943682e-02 3 1  ON 4
ci_06                -2.968192e-02 3 1  ON 5
ci_07                 2.834348e-02 3 1  ON 6
ci_08                -1.103282e-02 3 1  ON 7
ci_09                -1.264022e-02 3 1  ON 8
ci_10                -1.309991e-02 3 1  ON 9
ci_11                 1.463921e-02 3 1  ON 10
ci_12                 1.023810e-02 3 1  ON 11
ci_13                 1.220201e-02 3 1  ON 12
ci_14                 1.337687e-02 3 1  ON 13
ci_15                 9.381615e-03 3 1  ON 14
ci_16                 9.342637e-03 3 1  ON 15
ci_17                -9.598602e-03 3 1  ON 16
ci_18                -9.423109e-03 3 1  ON 17
ci_19                 1.014797e-02 3 1  ON 18
ci_20                 8.700167e-03 3 1  ON 19
ci_21                 9.145888e-03 3 1  ON 20
ci_22                 9.379307e-03 3 1  ON 21
ci_23                 5.494819e-03 3 1  ON 22
ci_24                 4.877240e-03 3 1  ON 23
ci_25                 3.967009e-03 3 1  ON 24
ci_26                 3.621585e-03 3 1  ON 25
ci_27                 3.734966e-03 3 1  ON 26
ci_28                 3.160992e-03 3 1  ON 27
ci_29                 3.339986e-03 3 1  ON 28
ci_30                -2.461836e-03 3 1  ON 29
ci_31                -2.389203e-03 3 1  ON 30
ci_32                -1.831673e-03 3 1  ON 31
ci_33                -1.918061e-03 3 1  ON 32
ci_34                 1.409940e-03 3 1  ON 33
ci_35                 1.686198e-03 3 1  ON 34
ci_36                -1.714910e-03 3 1  ON 35
ci_37                -1.718250e-03 3 1  ON 36
ci_38                -1.106987e-03 3 1  ON 37
ci_39                -1.173193e-03 3 1  ON 38
ci_40                -1.770874e-03 3 1  ON 39
ci_41                -1.305015e-03 3 1  ON 40
ci_42                -1.124783e-03 3 1  ON 41
ci_43                -2.099051e-03 3 1  ON 42
ci_44                -1.872448e-03 3 1  ON 43
ci_45                -1.009223e-03 3 1  ON 44
ci_46                -1.069280e-03 3 1  ON 45
ci_47                -6.908119e-04 3 1  ON 46
ci_48                -7.075700e-04 3 1  ON 47
ci_49                -1.497864e-03 3 1  ON 48
ci_50                -1.145829e-03 3 1  ON 49
ci_51                 1.010998e-03 3 1  ON 50
ci_52                 1.152563e-03 3 1  ON 51
ci_53                -1.061850e-03 3 1  ON 52
ci_54                -1.097837e-03 3 1  ON 53
ci_55                -1.072237e-03 3 1  ON 54
ci_56                 1.634191e-03 3 1  ON 55
ci_57                 1.718144e-03 3 1  ON 56
ci_58                -9.884977e-04 3 1  ON 57
ci_59                -9.895668e-04 3 1  ON 58
ci_60                 7.853866e-04 3 1  ON 59
ci_61                 1.085201e-03 3 1  ON 60
ci_62                -8.762124e-04 3 1  ON 61
ci_63                -7.009277e-04 3 1  ON 62
ci_64                -7.239022e-04 3 1  ON 63
ci_65                -6.662289e-04 3 1  ON 64
ci_66                -7.870978e-04 3 1  ON 65
ci_67                -7.817885e-04 3 1  ON 66
ci_68                -1.840143e-04 3 1  ON 67
ci_69                -3.649691e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7796
    reference variance = 0.341214
====================================================
  Execution time = 4.2983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9876e-01
  Total weights = 1.9635e+06
  Execution time = 5.8997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482510488061
                                         uncertainty =       0.003659153667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482510488061
                                         uncertainty =       0.003659153667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491186644
  error estimate for blocks of size 2^( 2) =       0.000512034438
  error estimate for blocks of size 2^( 3) =       0.000531754552
  error estimate for blocks of size 2^( 4) =       0.000547082903
  error estimate for blocks of size 2^( 5) =       0.000556675957
  error estimate for blocks of size 2^( 6) =       0.000563281621
  error estimate for blocks of size 2^( 7) =       0.000565753745

      target function =      -0.646650486160
              le_mean =     -22.816551483559
             les_mean =     521.096626104529
             stat err =       0.000558198557
             autocorr =       1.291469990633
   target nu stat err =       0.000558198557
   target dn stat err =       0.004733559194
      target stat err =       0.001857059227
              std dev =       0.694642814171
             le_variance =       0.482528639279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481435010799
                                         uncertainty =       0.003635058570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481435010799
                                         uncertainty =       0.003635058570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490638512
  error estimate for blocks of size 2^( 2) =       0.000511486612
  error estimate for blocks of size 2^( 3) =       0.000531216483
  error estimate for blocks of size 2^( 4) =       0.000546549556
  error estimate for blocks of size 2^( 5) =       0.000556150343
  error estimate for blocks of size 2^( 6) =       0.000562755604
  error estimate for blocks of size 2^( 7) =       0.000565270287

      target function =      -0.647532306837
              le_mean =     -22.816569451279
             les_mean =     521.095176877184
             stat err =       0.000557681448
             autocorr =       1.291960169377
   target nu stat err =       0.000557681448
   target dn stat err =       0.004469660193
      target stat err =       0.001761632372
              std dev =       0.693867638019
             le_variance =       0.481452299089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481927876755
                                         uncertainty =       0.003646072694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481927876755
                                         uncertainty =       0.003646072694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490889790
  error estimate for blocks of size 2^( 2) =       0.000511736442
  error estimate for blocks of size 2^( 3) =       0.000531461285
  error estimate for blocks of size 2^( 4) =       0.000546792487
  error estimate for blocks of size 2^( 5) =       0.000556390422
  error estimate for blocks of size 2^( 6) =       0.000562995910
  error estimate for blocks of size 2^( 7) =       0.000565490630

      target function =      -0.647868471021
              le_mean =     -22.816558269977
             les_mean =     521.093793038041
             stat err =       0.000557917362
             autocorr =       1.291730029186
   target nu stat err =       0.000557917362
   target dn stat err =       0.004172992505
      target stat err =       0.001650722897
              std dev =       0.694222998074
             le_variance =       0.481945571055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482435142993
                                         uncertainty =       0.003657390990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482435142993
                                         uncertainty =       0.003657390990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491148263
  error estimate for blocks of size 2^( 2) =       0.000511994700
  error estimate for blocks of size 2^( 3) =       0.000531715809
  error estimate for blocks of size 2^( 4) =       0.000547045034
  error estimate for blocks of size 2^( 5) =       0.000556641453
  error estimate for blocks of size 2^( 6) =       0.000563253779
  error estimate for blocks of size 2^( 7) =       0.000565727150

      target function =      -0.645046045300
              le_mean =     -22.816552332948
             les_mean =     521.100822280481
             stat err =       0.000558166854
             autocorr =       1.291525129509
   target nu stat err =       0.000558166854
   target dn stat err =       0.006344285648
      target stat err =       0.002459034150
              std dev =       0.694588534764
             le_variance =       0.482453232626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.646650486160        initial
     6.1035e-01     6.1035e+00             1.3885e-03        -0.647532306837
     2.4414e+00     2.4414e+01             3.5756e-04        -0.647868471021  <--
     9.7656e+00     9.7656e+01             9.0070e-05        -0.645046045300

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 7.2573e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_01                 1.442642e-01 3 1  ON 0
ci_02                -4.095944e-02 3 1  ON 1
ci_03                -4.081928e-02 3 1  ON 2
ci_04                 3.817652e-02 3 1  ON 3
ci_05                -2.943682e-02 3 1  ON 4
ci_06                -2.968192e-02 3 1  ON 5
ci_07                 2.834348e-02 3 1  ON 6
ci_08                -1.103282e-02 3 1  ON 7
ci_09                -1.264022e-02 3 1  ON 8
ci_10                -1.309991e-02 3 1  ON 9
ci_11                 1.463921e-02 3 1  ON 10
ci_12                 1.023810e-02 3 1  ON 11
ci_13                 1.220201e-02 3 1  ON 12
ci_14                 1.337687e-02 3 1  ON 13
ci_15                 9.381615e-03 3 1  ON 14
ci_16                 9.342637e-03 3 1  ON 15
ci_17                -9.598602e-03 3 1  ON 16
ci_18                -9.423109e-03 3 1  ON 17
ci_19                 1.014797e-02 3 1  ON 18
ci_20                 8.700167e-03 3 1  ON 19
ci_21                 9.145888e-03 3 1  ON 20
ci_22                 9.379307e-03 3 1  ON 21
ci_23                 5.494819e-03 3 1  ON 22
ci_24                 4.877240e-03 3 1  ON 23
ci_25                 3.967009e-03 3 1  ON 24
ci_26                 3.621585e-03 3 1  ON 25
ci_27                 3.734966e-03 3 1  ON 26
ci_28                 3.160992e-03 3 1  ON 27
ci_29                 3.339986e-03 3 1  ON 28
ci_30                -2.461836e-03 3 1  ON 29
ci_31                -2.389203e-03 3 1  ON 30
ci_32                -1.831673e-03 3 1  ON 31
ci_33                -1.918061e-03 3 1  ON 32
ci_34                 1.409940e-03 3 1  ON 33
ci_35                 1.686198e-03 3 1  ON 34
ci_36                -1.714910e-03 3 1  ON 35
ci_37                -1.718250e-03 3 1  ON 36
ci_38                -1.106987e-03 3 1  ON 37
ci_39                -1.173193e-03 3 1  ON 38
ci_40                -1.770874e-03 3 1  ON 39
ci_41                -1.305015e-03 3 1  ON 40
ci_42                -1.124783e-03 3 1  ON 41
ci_43                -2.099051e-03 3 1  ON 42
ci_44                -1.872448e-03 3 1  ON 43
ci_45                -1.009223e-03 3 1  ON 44
ci_46                -1.069280e-03 3 1  ON 45
ci_47                -6.908119e-04 3 1  ON 46
ci_48                -7.075700e-04 3 1  ON 47
ci_49                -1.497864e-03 3 1  ON 48
ci_50                -1.145829e-03 3 1  ON 49
ci_51                 1.010998e-03 3 1  ON 50
ci_52                 1.152563e-03 3 1  ON 51
ci_53                -1.061850e-03 3 1  ON 52
ci_54                -1.097837e-03 3 1  ON 53
ci_55                -1.072237e-03 3 1  ON 54
ci_56                 1.634191e-03 3 1  ON 55
ci_57                 1.718144e-03 3 1  ON 56
ci_58                -9.884977e-04 3 1  ON 57
ci_59                -9.895668e-04 3 1  ON 58
ci_60                 7.853866e-04 3 1  ON 59
ci_61                 1.085201e-03 3 1  ON 60
ci_62                -8.762124e-04 3 1  ON 61
ci_63                -7.009277e-04 3 1  ON 62
ci_64                -7.239022e-04 3 1  ON 63
ci_65                -6.662289e-04 3 1  ON 64
ci_66                -7.870978e-04 3 1  ON 65
ci_67                -7.817885e-04 3 1  ON 66
ci_68                -1.840143e-04 3 1  ON 67
ci_69                -3.649691e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2286e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8756
    reference variance = 0.385894
====================================================
  Execution time = 4.3856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.8708e-01
  Total weights = 1.963268487e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474040473674
                                         uncertainty =       0.002042473232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474040473674
                                         uncertainty =       0.002042473232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486864555
  error estimate for blocks of size 2^( 2) =       0.000507989614
  error estimate for blocks of size 2^( 3) =       0.000527440416
  error estimate for blocks of size 2^( 4) =       0.000542391306
  error estimate for blocks of size 2^( 5) =       0.000553038158
  error estimate for blocks of size 2^( 6) =       0.000560498061
  error estimate for blocks of size 2^( 7) =       0.000562865633

      target function =      -0.652484455443
              le_mean =     -22.817261448201
             les_mean =     521.114502771014
             stat err =       0.000554698289
             autocorr =       1.298067680211
   target nu stat err =       0.000554698289
   target dn stat err =       0.002578332394
      target stat err =       0.001067497108
              std dev =       0.688530457095
             le_variance =       0.474074190347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281726144820e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652485793794       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652690133214       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652719157268       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652724020373       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652725359826       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652725622192       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652725723450       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652725733144       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652725740761       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.227245e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652485793794       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652539490791       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652546986526       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652548210324       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652548535989       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652548597572       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652548621460       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652548623658       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652548625435       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.161806e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652485793794       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652499391795       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652501281189       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652501587534       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652501668312       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652501683446       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652501689325       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652501689860       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652501690296       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 7.965445e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1457e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_01                 1.439481e-01 3 1  ON 0
ci_02                -4.071068e-02 3 1  ON 1
ci_03                -4.055429e-02 3 1  ON 2
ci_04                 3.786461e-02 3 1  ON 3
ci_05                -2.928765e-02 3 1  ON 4
ci_06                -2.948369e-02 3 1  ON 5
ci_07                 2.831936e-02 3 1  ON 6
ci_08                -1.090910e-02 3 1  ON 7
ci_09                -1.257996e-02 3 1  ON 8
ci_10                -1.301897e-02 3 1  ON 9
ci_11                 1.461883e-02 3 1  ON 10
ci_12                 1.017910e-02 3 1  ON 11
ci_13                 1.220623e-02 3 1  ON 12
ci_14                 1.341186e-02 3 1  ON 13
ci_15                 9.323426e-03 3 1  ON 14
ci_16                 9.289438e-03 3 1  ON 15
ci_17                -9.548929e-03 3 1  ON 16
ci_18                -9.371378e-03 3 1  ON 17
ci_19                 1.012321e-02 3 1  ON 18
ci_20                 8.695283e-03 3 1  ON 19
ci_21                 9.135676e-03 3 1  ON 20
ci_22                 9.355482e-03 3 1  ON 21
ci_23                 5.491451e-03 3 1  ON 22
ci_24                 4.871233e-03 3 1  ON 23
ci_25                 3.966645e-03 3 1  ON 24
ci_26                 3.615923e-03 3 1  ON 25
ci_27                 3.708200e-03 3 1  ON 26
ci_28                 3.120591e-03 3 1  ON 27
ci_29                 3.317175e-03 3 1  ON 28
ci_30                -2.433234e-03 3 1  ON 29
ci_31                -2.373170e-03 3 1  ON 30
ci_32                -1.810418e-03 3 1  ON 31
ci_33                -1.926840e-03 3 1  ON 32
ci_34                 1.392318e-03 3 1  ON 33
ci_35                 1.677866e-03 3 1  ON 34
ci_36                -1.701918e-03 3 1  ON 35
ci_37                -1.690983e-03 3 1  ON 36
ci_38                -1.091762e-03 3 1  ON 37
ci_39                -1.157153e-03 3 1  ON 38
ci_40                -1.756673e-03 3 1  ON 39
ci_41                -1.298506e-03 3 1  ON 40
ci_42                -1.122605e-03 3 1  ON 41
ci_43                -2.100431e-03 3 1  ON 42
ci_44                -1.888016e-03 3 1  ON 43
ci_45                -1.000381e-03 3 1  ON 44
ci_46                -1.052863e-03 3 1  ON 45
ci_47                -6.878944e-04 3 1  ON 46
ci_48                -6.870538e-04 3 1  ON 47
ci_49                -1.490407e-03 3 1  ON 48
ci_50                -1.143165e-03 3 1  ON 49
ci_51                 9.981410e-04 3 1  ON 50
ci_52                 1.145589e-03 3 1  ON 51
ci_53                -1.065869e-03 3 1  ON 52
ci_54                -1.069007e-03 3 1  ON 53
ci_55                -1.068392e-03 3 1  ON 54
ci_56                 1.638348e-03 3 1  ON 55
ci_57                 1.726233e-03 3 1  ON 56
ci_58                -9.824978e-04 3 1  ON 57
ci_59                -9.837912e-04 3 1  ON 58
ci_60                 7.728763e-04 3 1  ON 59
ci_61                 1.072881e-03 3 1  ON 60
ci_62                -8.731413e-04 3 1  ON 61
ci_63                -6.967420e-04 3 1  ON 62
ci_64                -7.032352e-04 3 1  ON 63
ci_65                -6.524168e-04 3 1  ON 64
ci_66                -7.701742e-04 3 1  ON 65
ci_67                -7.858207e-04 3 1  ON 66
ci_68                -1.933669e-04 3 1  ON 67
ci_69                -3.764110e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8488
    reference variance = 0.646056
====================================================
  Execution time = 4.1296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9773e-01
  Total weights = 1.9637e+06
  Execution time = 5.8992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478263389070
                                         uncertainty =       0.002541311415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478263389070
                                         uncertainty =       0.002541311415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489004196
  error estimate for blocks of size 2^( 2) =       0.000509752163
  error estimate for blocks of size 2^( 3) =       0.000529693536
  error estimate for blocks of size 2^( 4) =       0.000543265285
  error estimate for blocks of size 2^( 5) =       0.000553715559
  error estimate for blocks of size 2^( 6) =       0.000558764585
  error estimate for blocks of size 2^( 7) =       0.000561464002

      target function =      -0.647893289793
              le_mean =     -22.816709902328
             les_mean =     521.100744228202
             stat err =       0.000554302358
             autocorr =       1.284896897220
   target nu stat err =       0.000554302358
   target dn stat err =       0.003883748688
      target stat err =       0.001541009175
              std dev =       0.691556366076
             le_variance =       0.478250207461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477182720469
                                         uncertainty =       0.002541435480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477182720469
                                         uncertainty =       0.002541435480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488451141
  error estimate for blocks of size 2^( 2) =       0.000509198191
  error estimate for blocks of size 2^( 3) =       0.000529150057
  error estimate for blocks of size 2^( 4) =       0.000542735105
  error estimate for blocks of size 2^( 5) =       0.000553173040
  error estimate for blocks of size 2^( 6) =       0.000558266330
  error estimate for blocks of size 2^( 7) =       0.000560953872

      target function =      -0.640461488136
              le_mean =     -22.816710354062
             les_mean =     521.119956509541
             stat err =       0.000553782087
             autocorr =       1.285391874063
   target nu stat err =       0.000553782087
   target dn stat err =       0.019281531664
      target stat err =       0.007309291823
              std dev =       0.690774228259
             le_variance =       0.477169034427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477673260731
                                         uncertainty =       0.002541195653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477673260731
                                         uncertainty =       0.002541195653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488702277
  error estimate for blocks of size 2^( 2) =       0.000509451126
  error estimate for blocks of size 2^( 3) =       0.000529400581
  error estimate for blocks of size 2^( 4) =       0.000542980630
  error estimate for blocks of size 2^( 5) =       0.000553427459
  error estimate for blocks of size 2^( 6) =       0.000558498204
  error estimate for blocks of size 2^( 7) =       0.000561191629

      target function =      -0.648064994615
              le_mean =     -22.816706084645
             les_mean =     521.100124663654
             stat err =       0.000554024480
             autocorr =       1.285195467509
   target nu stat err =       0.000554024480
   target dn stat err =       0.003875959306
      target stat err =       0.001538816791
              std dev =       0.691129388056
             le_variance =       0.477659831034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478186221766
                                         uncertainty =       0.002541227513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478186221766
                                         uncertainty =       0.002541227513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488964728
  error estimate for blocks of size 2^( 2) =       0.000509712793
  error estimate for blocks of size 2^( 3) =       0.000529655303
  error estimate for blocks of size 2^( 4) =       0.000543228119
  error estimate for blocks of size 2^( 5) =       0.000553677894
  error estimate for blocks of size 2^( 6) =       0.000558729699
  error estimate for blocks of size 2^( 7) =       0.000561428118

      target function =      -0.647387331766
              le_mean =     -22.816708955683
             les_mean =     521.102005389492
             stat err =       0.000554265957
             autocorr =       1.284935553081
   target nu stat err =       0.000554265957
   target dn stat err =       0.004256603055
      target stat err =       0.001679812383
              std dev =       0.691500550283
             le_variance =       0.478173011041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.647893289793        initial
     6.1035e-01     6.1035e+00             1.2272e-03        -0.640461488136
     2.4414e+00     2.4414e+01             3.1618e-04        -0.648064994615  <--
     9.7656e+00     9.7656e+01             7.9654e-05        -0.647387331766

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 7.0936e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_01                 1.439481e-01 3 1  ON 0
ci_02                -4.071068e-02 3 1  ON 1
ci_03                -4.055429e-02 3 1  ON 2
ci_04                 3.786461e-02 3 1  ON 3
ci_05                -2.928765e-02 3 1  ON 4
ci_06                -2.948369e-02 3 1  ON 5
ci_07                 2.831936e-02 3 1  ON 6
ci_08                -1.090910e-02 3 1  ON 7
ci_09                -1.257996e-02 3 1  ON 8
ci_10                -1.301897e-02 3 1  ON 9
ci_11                 1.461883e-02 3 1  ON 10
ci_12                 1.017910e-02 3 1  ON 11
ci_13                 1.220623e-02 3 1  ON 12
ci_14                 1.341186e-02 3 1  ON 13
ci_15                 9.323426e-03 3 1  ON 14
ci_16                 9.289438e-03 3 1  ON 15
ci_17                -9.548929e-03 3 1  ON 16
ci_18                -9.371378e-03 3 1  ON 17
ci_19                 1.012321e-02 3 1  ON 18
ci_20                 8.695283e-03 3 1  ON 19
ci_21                 9.135676e-03 3 1  ON 20
ci_22                 9.355482e-03 3 1  ON 21
ci_23                 5.491451e-03 3 1  ON 22
ci_24                 4.871233e-03 3 1  ON 23
ci_25                 3.966645e-03 3 1  ON 24
ci_26                 3.615923e-03 3 1  ON 25
ci_27                 3.708200e-03 3 1  ON 26
ci_28                 3.120591e-03 3 1  ON 27
ci_29                 3.317175e-03 3 1  ON 28
ci_30                -2.433234e-03 3 1  ON 29
ci_31                -2.373170e-03 3 1  ON 30
ci_32                -1.810418e-03 3 1  ON 31
ci_33                -1.926840e-03 3 1  ON 32
ci_34                 1.392318e-03 3 1  ON 33
ci_35                 1.677866e-03 3 1  ON 34
ci_36                -1.701918e-03 3 1  ON 35
ci_37                -1.690983e-03 3 1  ON 36
ci_38                -1.091762e-03 3 1  ON 37
ci_39                -1.157153e-03 3 1  ON 38
ci_40                -1.756673e-03 3 1  ON 39
ci_41                -1.298506e-03 3 1  ON 40
ci_42                -1.122605e-03 3 1  ON 41
ci_43                -2.100431e-03 3 1  ON 42
ci_44                -1.888016e-03 3 1  ON 43
ci_45                -1.000381e-03 3 1  ON 44
ci_46                -1.052863e-03 3 1  ON 45
ci_47                -6.878944e-04 3 1  ON 46
ci_48                -6.870538e-04 3 1  ON 47
ci_49                -1.490407e-03 3 1  ON 48
ci_50                -1.143165e-03 3 1  ON 49
ci_51                 9.981410e-04 3 1  ON 50
ci_52                 1.145589e-03 3 1  ON 51
ci_53                -1.065869e-03 3 1  ON 52
ci_54                -1.069007e-03 3 1  ON 53
ci_55                -1.068392e-03 3 1  ON 54
ci_56                 1.638348e-03 3 1  ON 55
ci_57                 1.726233e-03 3 1  ON 56
ci_58                -9.824978e-04 3 1  ON 57
ci_59                -9.837912e-04 3 1  ON 58
ci_60                 7.728763e-04 3 1  ON 59
ci_61                 1.072881e-03 3 1  ON 60
ci_62                -8.731413e-04 3 1  ON 61
ci_63                -6.967420e-04 3 1  ON 62
ci_64                -7.032352e-04 3 1  ON 63
ci_65                -6.524168e-04 3 1  ON 64
ci_66                -7.701742e-04 3 1  ON 65
ci_67                -7.858207e-04 3 1  ON 66
ci_68                -1.933669e-04 3 1  ON 67
ci_69                -3.764110e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2240e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7963
    reference variance = 0.335558
====================================================
  Execution time = 4.2489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9394e-01
  Total weights = 1.963391527e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478767709743
                                         uncertainty =       0.002447448795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478767709743
                                         uncertainty =       0.002447448795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489226648
  error estimate for blocks of size 2^( 2) =       0.000510072875
  error estimate for blocks of size 2^( 3) =       0.000529896910
  error estimate for blocks of size 2^( 4) =       0.000544801162
  error estimate for blocks of size 2^( 5) =       0.000554214632
  error estimate for blocks of size 2^( 6) =       0.000559420022
  error estimate for blocks of size 2^( 7) =       0.000562247325

      target function =      -0.649777060992
              le_mean =     -22.817170186474
             les_mean =     521.117193247603
             stat err =       0.000555170785
             autocorr =       1.287754267218
   target nu stat err =       0.000555170785
   target dn stat err =       0.003112865890
      target stat err =       0.001258642409
              std dev =       0.691870961357
             le_variance =       0.478685427169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281717018647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649779106010       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649986421053       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650016423683       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650021356101       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650023153278       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650023782674       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650023850279       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650023870062       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650023873911       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.267036e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649779106010       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649833577766       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649841332995       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649842577828       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649843019120       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649843167434       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649843182526       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649843187168       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649843188046       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.264217e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.649779106010       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649792899722       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649794854980       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649795166825       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649795276566       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649795313046       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649795316704       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649795317845       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649795318059       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 8.223383e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0094e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_01                 1.436216e-01 3 1  ON 0
ci_02                -4.046038e-02 3 1  ON 1
ci_03                -4.028915e-02 3 1  ON 2
ci_04                 3.755696e-02 3 1  ON 3
ci_05                -2.912230e-02 3 1  ON 4
ci_06                -2.930879e-02 3 1  ON 5
ci_07                 2.828598e-02 3 1  ON 6
ci_08                -1.078772e-02 3 1  ON 7
ci_09                -1.250872e-02 3 1  ON 8
ci_10                -1.294443e-02 3 1  ON 9
ci_11                 1.459309e-02 3 1  ON 10
ci_12                 1.011920e-02 3 1  ON 11
ci_13                 1.221073e-02 3 1  ON 12
ci_14                 1.340772e-02 3 1  ON 13
ci_15                 9.281549e-03 3 1  ON 14
ci_16                 9.242126e-03 3 1  ON 15
ci_17                -9.495024e-03 3 1  ON 16
ci_18                -9.331997e-03 3 1  ON 17
ci_19                 1.010908e-02 3 1  ON 18
ci_20                 8.649084e-03 3 1  ON 19
ci_21                 9.144574e-03 3 1  ON 20
ci_22                 9.343018e-03 3 1  ON 21
ci_23                 5.482299e-03 3 1  ON 22
ci_24                 4.865694e-03 3 1  ON 23
ci_25                 3.945378e-03 3 1  ON 24
ci_26                 3.587335e-03 3 1  ON 25
ci_27                 3.680797e-03 3 1  ON 26
ci_28                 3.103322e-03 3 1  ON 27
ci_29                 3.290908e-03 3 1  ON 28
ci_30                -2.418963e-03 3 1  ON 29
ci_31                -2.352146e-03 3 1  ON 30
ci_32                -1.799067e-03 3 1  ON 31
ci_33                -1.903014e-03 3 1  ON 32
ci_34                 1.377337e-03 3 1  ON 33
ci_35                 1.652664e-03 3 1  ON 34
ci_36                -1.687617e-03 3 1  ON 35
ci_37                -1.677647e-03 3 1  ON 36
ci_38                -1.079203e-03 3 1  ON 37
ci_39                -1.134746e-03 3 1  ON 38
ci_40                -1.748873e-03 3 1  ON 39
ci_41                -1.305056e-03 3 1  ON 40
ci_42                -1.108433e-03 3 1  ON 41
ci_43                -2.124905e-03 3 1  ON 42
ci_44                -1.887618e-03 3 1  ON 43
ci_45                -9.833503e-04 3 1  ON 44
ci_46                -1.048295e-03 3 1  ON 45
ci_47                -6.679165e-04 3 1  ON 46
ci_48                -6.686253e-04 3 1  ON 47
ci_49                -1.477310e-03 3 1  ON 48
ci_50                -1.120197e-03 3 1  ON 49
ci_51                 9.965150e-04 3 1  ON 50
ci_52                 1.125927e-03 3 1  ON 51
ci_53                -1.051101e-03 3 1  ON 52
ci_54                -1.061235e-03 3 1  ON 53
ci_55                -1.059150e-03 3 1  ON 54
ci_56                 1.647104e-03 3 1  ON 55
ci_57                 1.737570e-03 3 1  ON 56
ci_58                -9.923243e-04 3 1  ON 57
ci_59                -9.960394e-04 3 1  ON 58
ci_60                 7.787771e-04 3 1  ON 59
ci_61                 1.018605e-03 3 1  ON 60
ci_62                -8.656947e-04 3 1  ON 61
ci_63                -7.145184e-04 3 1  ON 62
ci_64                -7.290175e-04 3 1  ON 63
ci_65                -6.557008e-04 3 1  ON 64
ci_66                -7.478365e-04 3 1  ON 65
ci_67                -7.718226e-04 3 1  ON 66
ci_68                -2.061615e-04 3 1  ON 67
ci_69                -3.816795e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.821
    reference variance = 0.412772
====================================================
  Execution time = 4.1309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8931e-01
  Total weights = 1.9638e+06
  Execution time = 5.9044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475466603451
                                         uncertainty =       0.002355111709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475466603451
                                         uncertainty =       0.002355111709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487562308
  error estimate for blocks of size 2^( 2) =       0.000508760578
  error estimate for blocks of size 2^( 3) =       0.000528372327
  error estimate for blocks of size 2^( 4) =       0.000543771462
  error estimate for blocks of size 2^( 5) =       0.000552587234
  error estimate for blocks of size 2^( 6) =       0.000559088795
  error estimate for blocks of size 2^( 7) =       0.000560768006

      target function =      -0.651510913728
              le_mean =     -22.817533595838
             les_mean =     521.129572695066
             stat err =       0.000554053874
             autocorr =       1.291349337937
   target nu stat err =       0.000554053874
   target dn stat err =       0.002780275328
      target stat err =       0.001140089180
              std dev =       0.689517228194
             le_variance =       0.475434007976

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0882019
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474406219181
                                         uncertainty =       0.002343919568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474406219181
                                         uncertainty =       0.002343919568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487018080
  error estimate for blocks of size 2^( 2) =       0.000508218588
  error estimate for blocks of size 2^( 3) =       0.000527830586
  error estimate for blocks of size 2^( 4) =       0.000543242234
  error estimate for blocks of size 2^( 5) =       0.000552058971
  error estimate for blocks of size 2^( 6) =       0.000558584566
  error estimate for blocks of size 2^( 7) =       0.000560203597

      target function =      -0.651903334909
              le_mean =     -22.817532972520
             les_mean =     521.128543620299
             stat err =       0.000553522342
             autocorr =       1.291754972766
   target nu stat err =       0.000553522342
   target dn stat err =       0.002807623986
      target stat err =       0.001151583311
              std dev =       0.688747573715
             le_variance =       0.474373220298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474893580478
                                         uncertainty =       0.002349013496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474893580478
                                         uncertainty =       0.002349013496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487268295
  error estimate for blocks of size 2^( 2) =       0.000508467400
  error estimate for blocks of size 2^( 3) =       0.000528078997
  error estimate for blocks of size 2^( 4) =       0.000543484567
  error estimate for blocks of size 2^( 5) =       0.000552300735
  error estimate for blocks of size 2^( 6) =       0.000558814770
  error estimate for blocks of size 2^( 7) =       0.000560462300

      target function =      -0.651775677006
              le_mean =     -22.817530531761
             les_mean =     521.128755988411
             stat err =       0.000553765593
             autocorr =       1.291563098562
   target nu stat err =       0.000553765593
   target dn stat err =       0.002787325669
      target stat err =       0.001143568774
              std dev =       0.689101431417
             le_variance =       0.474860782781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475401682065
                                         uncertainty =       0.002353769641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475401682065
                                         uncertainty =       0.002353769641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487528989
  error estimate for blocks of size 2^( 2) =       0.000508728338
  error estimate for blocks of size 2^( 3) =       0.000528341630
  error estimate for blocks of size 2^( 4) =       0.000543741395
  error estimate for blocks of size 2^( 5) =       0.000552566861
  error estimate for blocks of size 2^( 6) =       0.000559065523
  error estimate for blocks of size 2^( 7) =       0.000560741366

      target function =      -0.454597493317
              le_mean =     -22.817535079701
             les_mean =     521.702401685235
             stat err =       0.000554028786
             autocorr =       1.291408892119
   target nu stat err =       0.000554028786
   target dn stat err =       0.573200707839
      target stat err =       0.116629317999
              std dev =       0.689470107858
             le_variance =       0.475369029630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.651510913728        initial
     6.1035e-01     6.1035e+00             1.2670e-03        -0.651903334909  <--
     2.4414e+00     2.4414e+01             3.2642e-04        -0.651775677006
     9.7656e+00     9.7656e+01             8.2234e-05        -0.454597493317

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 7.0924e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_01                 1.426810e-01 3 1  ON 0
ci_02                -3.975439e-02 3 1  ON 1
ci_03                -3.954140e-02 3 1  ON 2
ci_04                 3.669518e-02 3 1  ON 3
ci_05                -2.865793e-02 3 1  ON 4
ci_06                -2.881738e-02 3 1  ON 5
ci_07                 2.819126e-02 3 1  ON 6
ci_08                -1.044718e-02 3 1  ON 7
ci_09                -1.230639e-02 3 1  ON 8
ci_10                -1.273244e-02 3 1  ON 9
ci_11                 1.452050e-02 3 1  ON 10
ci_12                 9.950648e-03 3 1  ON 11
ci_13                 1.222406e-02 3 1  ON 12
ci_14                 1.339660e-02 3 1  ON 13
ci_15                 9.163407e-03 3 1  ON 14
ci_16                 9.108503e-03 3 1  ON 15
ci_17                -9.341969e-03 3 1  ON 16
ci_18                -9.219711e-03 3 1  ON 17
ci_19                 1.006993e-02 3 1  ON 18
ci_20                 8.519541e-03 3 1  ON 19
ci_21                 9.170038e-03 3 1  ON 20
ci_22                 9.307272e-03 3 1  ON 21
ci_23                 5.456693e-03 3 1  ON 22
ci_24                 4.850315e-03 3 1  ON 23
ci_25                 3.885673e-03 3 1  ON 24
ci_26                 3.507001e-03 3 1  ON 25
ci_27                 3.603499e-03 3 1  ON 26
ci_28                 3.053648e-03 3 1  ON 27
ci_29                 3.215839e-03 3 1  ON 28
ci_30                -2.377634e-03 3 1  ON 29
ci_31                -2.291682e-03 3 1  ON 30
ci_32                -1.768137e-03 3 1  ON 31
ci_33                -1.837485e-03 3 1  ON 32
ci_34                 1.336233e-03 3 1  ON 33
ci_35                 1.582887e-03 3 1  ON 34
ci_36                -1.647280e-03 3 1  ON 35
ci_37                -1.640006e-03 3 1  ON 36
ci_38                -1.043818e-03 3 1  ON 37
ci_39                -1.071555e-03 3 1  ON 38
ci_40                -1.726953e-03 3 1  ON 39
ci_41                -1.324215e-03 3 1  ON 40
ci_42                -1.069664e-03 3 1  ON 41
ci_43                -2.193544e-03 3 1  ON 42
ci_44                -1.885829e-03 3 1  ON 43
ci_45                -9.354941e-04 3 1  ON 44
ci_46                -1.035257e-03 3 1  ON 45
ci_47                -6.101762e-04 3 1  ON 46
ci_48                -6.155241e-04 3 1  ON 47
ci_49                -1.440176e-03 3 1  ON 48
ci_50                -1.056434e-03 3 1  ON 49
ci_51                 9.916719e-04 3 1  ON 50
ci_52                 1.070716e-03 3 1  ON 51
ci_53                -1.009990e-03 3 1  ON 52
ci_54                -1.039073e-03 3 1  ON 53
ci_55                -1.033149e-03 3 1  ON 54
ci_56                 1.671683e-03 3 1  ON 55
ci_57                 1.769415e-03 3 1  ON 56
ci_58                -1.020273e-03 3 1  ON 57
ci_59                -1.030539e-03 3 1  ON 58
ci_60                 7.959078e-04 3 1  ON 59
ci_61                 8.619190e-04 3 1  ON 60
ci_62                -8.447421e-04 3 1  ON 61
ci_63                -7.640305e-04 3 1  ON 62
ci_64                -8.007420e-04 3 1  ON 63
ci_65                -6.644694e-04 3 1  ON 64
ci_66                -6.850966e-04 3 1  ON 65
ci_67                -7.325634e-04 3 1  ON 66
ci_68                -2.424393e-04 3 1  ON 67
ci_69                -3.964612e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2103e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.83
    reference variance = 0.24719
====================================================
  Execution time = 4.4333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.8903e-01
  Total weights = 1.963194016e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475813025392
                                         uncertainty =       0.002434159750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475813025392
                                         uncertainty =       0.002434159750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487794016
  error estimate for blocks of size 2^( 2) =       0.000508684343
  error estimate for blocks of size 2^( 3) =       0.000529084604
  error estimate for blocks of size 2^( 4) =       0.000544606057
  error estimate for blocks of size 2^( 5) =       0.000553898559
  error estimate for blocks of size 2^( 6) =       0.000558992218
  error estimate for blocks of size 2^( 7) =       0.000562534098

      target function =      -0.651476253337
              le_mean =     -22.816274842452
             les_mean =     521.071424550192
             stat err =       0.000555007733
             autocorr =       1.294568788166
   target nu stat err =       0.000555007733
   target dn stat err =       0.002874142873
      target stat err =       0.001174014984
              std dev =       0.689844912846
             le_variance =       0.475886003779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281627484245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651477948733       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652063871004       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652165434379       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652184983158       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652190498669       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652191905768       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652191962385       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652192007735       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652192015412       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652192020673       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 4.436384e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651477948733       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651652981743       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651681531324       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651686629353       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651687909730       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651688181497       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651688180432       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651688191108       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651688192922       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.238827e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651477948733       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651523945809       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651531304193       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651532587263       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651532897652       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651532959667       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651532958507       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651532961127       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651532961570       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 3.191036e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1955e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_01                 1.414422e-01 3 1  ON 0
ci_02                -3.873568e-02 3 1  ON 1
ci_03                -3.869454e-02 3 1  ON 2
ci_04                 3.568564e-02 3 1  ON 3
ci_05                -2.806467e-02 3 1  ON 4
ci_06                -2.821183e-02 3 1  ON 5
ci_07                 2.813897e-02 3 1  ON 6
ci_08                -1.004438e-02 3 1  ON 7
ci_09                -1.212828e-02 3 1  ON 8
ci_10                -1.245842e-02 3 1  ON 9
ci_11                 1.440715e-02 3 1  ON 10
ci_12                 9.727542e-03 3 1  ON 11
ci_13                 1.215471e-02 3 1  ON 12
ci_14                 1.350828e-02 3 1  ON 13
ci_15                 8.992089e-03 3 1  ON 14
ci_16                 8.817991e-03 3 1  ON 15
ci_17                -9.161760e-03 3 1  ON 16
ci_18                -8.945092e-03 3 1  ON 17
ci_19                 9.994799e-03 3 1  ON 18
ci_20                 8.418947e-03 3 1  ON 19
ci_21                 9.081113e-03 3 1  ON 20
ci_22                 9.261832e-03 3 1  ON 21
ci_23                 5.432905e-03 3 1  ON 22
ci_24                 4.842900e-03 3 1  ON 23
ci_25                 3.854235e-03 3 1  ON 24
ci_26                 3.532279e-03 3 1  ON 25
ci_27                 3.514505e-03 3 1  ON 26
ci_28                 2.911936e-03 3 1  ON 27
ci_29                 3.133823e-03 3 1  ON 28
ci_30                -2.261537e-03 3 1  ON 29
ci_31                -2.150571e-03 3 1  ON 30
ci_32                -1.698012e-03 3 1  ON 31
ci_33                -1.747233e-03 3 1  ON 32
ci_34                 1.288373e-03 3 1  ON 33
ci_35                 1.524352e-03 3 1  ON 34
ci_36                -1.612038e-03 3 1  ON 35
ci_37                -1.554480e-03 3 1  ON 36
ci_38                -1.036384e-03 3 1  ON 37
ci_39                -1.017510e-03 3 1  ON 38
ci_40                -1.700832e-03 3 1  ON 39
ci_41                -1.188393e-03 3 1  ON 40
ci_42                -1.016490e-03 3 1  ON 41
ci_43                -2.202754e-03 3 1  ON 42
ci_44                -1.818915e-03 3 1  ON 43
ci_45                -9.122385e-04 3 1  ON 44
ci_46                -1.003283e-03 3 1  ON 45
ci_47                -4.541636e-04 3 1  ON 46
ci_48                -4.869240e-04 3 1  ON 47
ci_49                -1.405662e-03 3 1  ON 48
ci_50                -1.026267e-03 3 1  ON 49
ci_51                 9.121068e-04 3 1  ON 50
ci_52                 1.032046e-03 3 1  ON 51
ci_53                -9.857164e-04 3 1  ON 52
ci_54                -1.007082e-03 3 1  ON 53
ci_55                -1.017097e-03 3 1  ON 54
ci_56                 1.698549e-03 3 1  ON 55
ci_57                 1.732024e-03 3 1  ON 56
ci_58                -9.986533e-04 3 1  ON 57
ci_59                -1.047447e-03 3 1  ON 58
ci_60                 7.257000e-04 3 1  ON 59
ci_61                 8.403264e-04 3 1  ON 60
ci_62                -8.334545e-04 3 1  ON 61
ci_63                -7.050468e-04 3 1  ON 62
ci_64                -7.448553e-04 3 1  ON 63
ci_65                -7.035250e-04 3 1  ON 64
ci_66                -7.004166e-04 3 1  ON 65
ci_67                -7.438439e-04 3 1  ON 66
ci_68                -2.780803e-04 3 1  ON 67
ci_69                -4.766840e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.823
    reference variance = 0.439557
====================================================
  Execution time = 4.3070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 5.0566e-01
  Total weights = 1.9632e+06
  Execution time = 5.9019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485250718288
                                         uncertainty =       0.005018181568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485250718288
                                         uncertainty =       0.005018181568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492532524
  error estimate for blocks of size 2^( 2) =       0.000512965164
  error estimate for blocks of size 2^( 3) =       0.000532455868
  error estimate for blocks of size 2^( 4) =       0.000547896951
  error estimate for blocks of size 2^( 5) =       0.000556020605
  error estimate for blocks of size 2^( 6) =       0.000561017744
  error estimate for blocks of size 2^( 7) =       0.000565562636

      target function =      -0.644023877744
              le_mean =     -22.818125645065
             les_mean =     521.176199294236
             stat err =       0.000557624484
             autocorr =       1.281781033145
   target nu stat err =       0.000557624484
   target dn stat err =       0.011113704100
      target stat err =       0.004273845494
              std dev =       0.696546174857
             le_variance =       0.485176573707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481940472535
                                         uncertainty =       0.004992549459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481940472535
                                         uncertainty =       0.004992549459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490850914
  error estimate for blocks of size 2^( 2) =       0.000511324862
  error estimate for blocks of size 2^( 3) =       0.000530878351
  error estimate for blocks of size 2^( 4) =       0.000546395479
  error estimate for blocks of size 2^( 5) =       0.000554522881
  error estimate for blocks of size 2^( 6) =       0.000559493502
  error estimate for blocks of size 2^( 7) =       0.000563984152

      target function =      -0.645573839446
              le_mean =     -22.818136839025
             les_mean =     521.172687654871
             stat err =       0.000556099003
             autocorr =       1.283527049280
   target nu stat err =       0.000556099003
   target dn stat err =       0.010811244959
      target stat err =       0.004178181495
              std dev =       0.694168019625
             le_variance =       0.481869239470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483036995513
                                         uncertainty =       0.005010652325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483036995513
                                         uncertainty =       0.005010652325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491408558
  error estimate for blocks of size 2^( 2) =       0.000511867377
  error estimate for blocks of size 2^( 3) =       0.000531391146
  error estimate for blocks of size 2^( 4) =       0.000546875321
  error estimate for blocks of size 2^( 5) =       0.000555010773
  error estimate for blocks of size 2^( 6) =       0.000559996059
  error estimate for blocks of size 2^( 7) =       0.000564507074

      target function =      -0.645424193428
              le_mean =     -22.818106103759
             les_mean =     521.171654780199
             stat err =       0.000556597307
             autocorr =       1.282911713137
   target nu stat err =       0.000556597307
   target dn stat err =       0.010804068290
      target stat err =       0.004173400820
              std dev =       0.694956647117
             le_variance =       0.482964741372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484857902444
                                         uncertainty =       0.005013854733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484857902444
                                         uncertainty =       0.005013854733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492333254
  error estimate for blocks of size 2^( 2) =       0.000512770237
  error estimate for blocks of size 2^( 3) =       0.000532264270
  error estimate for blocks of size 2^( 4) =       0.000547711039
  error estimate for blocks of size 2^( 5) =       0.000555836887
  error estimate for blocks of size 2^( 6) =       0.000560834380
  error estimate for blocks of size 2^( 7) =       0.000565369367

      target function =      -0.644580986989
              le_mean =     -22.818116988356
             les_mean =     521.174349565219
             stat err =       0.000557437918
             autocorr =       1.281960583076
   target nu stat err =       0.000557437918
   target dn stat err =       0.010917260996
      target stat err =       0.004205957912
              std dev =       0.696264365709
             le_variance =       0.484784066955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.644023877744        initial
     1.5259e-01     1.5259e+00             4.4364e-03        -0.645573839446  <--
     6.1035e-01     6.1035e+00             1.2388e-03        -0.645424193428
     2.4414e+00     2.4414e+01             3.1910e-04        -0.644580986989

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 7.2650e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_01                 1.382446e-01 3 1  ON 0
ci_02                -3.629565e-02 3 1  ON 1
ci_03                -3.666884e-02 3 1  ON 2
ci_04                 3.333525e-02 3 1  ON 3
ci_05                -2.666804e-02 3 1  ON 4
ci_06                -2.678269e-02 3 1  ON 5
ci_07                 2.801031e-02 3 1  ON 6
ci_08                -9.095913e-03 3 1  ON 7
ci_09                -1.169091e-02 3 1  ON 8
ci_10                -1.178862e-02 3 1  ON 9
ci_11                 1.413954e-02 3 1  ON 10
ci_12                 9.204036e-03 3 1  ON 11
ci_13                 1.199041e-02 3 1  ON 12
ci_14                 1.381764e-02 3 1  ON 13
ci_15                 8.580295e-03 3 1  ON 14
ci_16                 8.119895e-03 3 1  ON 15
ci_17                -8.718088e-03 3 1  ON 16
ci_18                -8.274309e-03 3 1  ON 17
ci_19                 9.824255e-03 3 1  ON 18
ci_20                 8.181727e-03 3 1  ON 19
ci_21                 8.859908e-03 3 1  ON 20
ci_22                 9.146726e-03 3 1  ON 21
ci_23                 5.381370e-03 3 1  ON 22
ci_24                 4.828391e-03 3 1  ON 23
ci_25                 3.780966e-03 3 1  ON 24
ci_26                 3.597753e-03 3 1  ON 25
ci_27                 3.304471e-03 3 1  ON 26
ci_28                 2.564855e-03 3 1  ON 27
ci_29                 2.927992e-03 3 1  ON 28
ci_30                -1.961742e-03 3 1  ON 29
ci_31                -1.793502e-03 3 1  ON 30
ci_32                -1.545924e-03 3 1  ON 31
ci_33                -1.545045e-03 3 1  ON 32
ci_34                 1.189137e-03 3 1  ON 33
ci_35                 1.401586e-03 3 1  ON 34
ci_36                -1.528140e-03 3 1  ON 35
ci_37                -1.354471e-03 3 1  ON 36
ci_38                -1.018103e-03 3 1  ON 37
ci_39                -8.916678e-04 3 1  ON 38
ci_40                -1.640295e-03 3 1  ON 39
ci_41                -8.795578e-04 3 1  ON 40
ci_42                -9.006708e-04 3 1  ON 41
ci_43                -2.215095e-03 3 1  ON 42
ci_44                -1.649830e-03 3 1  ON 43
ci_45                -8.561069e-04 3 1  ON 44
ci_46                -9.268313e-04 3 1  ON 45
ci_47                -6.379159e-05 3 1  ON 46
ci_48                -1.633783e-04 3 1  ON 47
ci_49                -1.321104e-03 3 1  ON 48
ci_50                -9.582492e-04 3 1  ON 49
ci_51                 7.220608e-04 3 1  ON 50
ci_52                 9.384939e-04 3 1  ON 51
ci_53                -9.286579e-04 3 1  ON 52
ci_54                -9.303793e-04 3 1  ON 53
ci_55                -9.818960e-04 3 1  ON 54
ci_56                 1.764770e-03 3 1  ON 55
ci_57                 1.646188e-03 3 1  ON 56
ci_58                -9.495670e-04 3 1  ON 57
ci_59                -1.088110e-03 3 1  ON 58
ci_60                 5.469275e-04 3 1  ON 59
ci_61                 7.874919e-04 3 1  ON 60
ci_62                -8.039215e-04 3 1  ON 61
ci_63                -5.670405e-04 3 1  ON 62
ci_64                -6.097621e-04 3 1  ON 63
ci_65                -7.944983e-04 3 1  ON 64
ci_66                -7.358609e-04 3 1  ON 65
ci_67                -7.682050e-04 3 1  ON 66
ci_68                -3.664961e-04 3 1  ON 67
ci_69                -6.679604e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2461e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7798
    reference variance = 0.256284
====================================================
  Execution time = 4.2575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8981e-01
  Total weights = 1.963774859e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475263337850
                                         uncertainty =       0.002999288639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475263337850
                                         uncertainty =       0.002999288639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487459622
  error estimate for blocks of size 2^( 2) =       0.000508353399
  error estimate for blocks of size 2^( 3) =       0.000528743939
  error estimate for blocks of size 2^( 4) =       0.000542701206
  error estimate for blocks of size 2^( 5) =       0.000553004253
  error estimate for blocks of size 2^( 6) =       0.000557874971
  error estimate for blocks of size 2^( 7) =       0.000561730099

      target function =      -0.651652478108
              le_mean =     -22.818235315390
             les_mean =     521.161673237392
             stat err =       0.000553827632
             autocorr =       1.290838609596
   target nu stat err =       0.000553827632
   target dn stat err =       0.003750013278
      target stat err =       0.001509421240
              std dev =       0.689372007983
             le_variance =       0.475233765390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281823531539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651655591037       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652619007917       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652788185630       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652828819362       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652844642695       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652851224228       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652852843974       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652853023444       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652852984241       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652852972119       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652852960752       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.013642e-02

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651655591037       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652054779476       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652117463967       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652130730585       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652134819322       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652136070540       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652136352048       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652136376490       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652136361848       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652136358859       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 3.584465e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651655591037       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651774979167       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651792685155       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651796198978       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651797155516       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651797405847       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651797462106       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651797465951       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651797462138       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 1.001609e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0212e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_01                 1.346602e-01 3 1  ON 0
ci_02                -3.380060e-02 3 1  ON 1
ci_03                -3.418283e-02 3 1  ON 2
ci_04                 3.053007e-02 3 1  ON 3
ci_05                -2.503850e-02 3 1  ON 4
ci_06                -2.540818e-02 3 1  ON 5
ci_07                 2.779032e-02 3 1  ON 6
ci_08                -8.045367e-03 3 1  ON 7
ci_09                -1.108557e-02 3 1  ON 8
ci_10                -1.081952e-02 3 1  ON 9
ci_11                 1.401118e-02 3 1  ON 10
ci_12                 8.763738e-03 3 1  ON 11
ci_13                 1.193366e-02 3 1  ON 12
ci_14                 1.406078e-02 3 1  ON 13
ci_15                 7.878598e-03 3 1  ON 14
ci_16                 7.743422e-03 3 1  ON 15
ci_17                -8.201342e-03 3 1  ON 16
ci_18                -7.766232e-03 3 1  ON 17
ci_19                 9.326681e-03 3 1  ON 18
ci_20                 7.631927e-03 3 1  ON 19
ci_21                 8.819310e-03 3 1  ON 20
ci_22                 9.185029e-03 3 1  ON 21
ci_23                 5.085804e-03 3 1  ON 22
ci_24                 4.908605e-03 3 1  ON 23
ci_25                 3.847409e-03 3 1  ON 24
ci_26                 3.405293e-03 3 1  ON 25
ci_27                 2.850443e-03 3 1  ON 26
ci_28                 2.317407e-03 3 1  ON 27
ci_29                 2.666404e-03 3 1  ON 28
ci_30                -1.639162e-03 3 1  ON 29
ci_31                -1.667927e-03 3 1  ON 30
ci_32                -1.551619e-03 3 1  ON 31
ci_33                -1.176964e-03 3 1  ON 32
ci_34                 1.083652e-03 3 1  ON 33
ci_35                 1.358955e-03 3 1  ON 34
ci_36                -1.227525e-03 3 1  ON 35
ci_37                -1.378214e-03 3 1  ON 36
ci_38                -7.660216e-04 3 1  ON 37
ci_39                -5.956291e-04 3 1  ON 38
ci_40                -1.602381e-03 3 1  ON 39
ci_41                -7.827037e-04 3 1  ON 40
ci_42                -9.206193e-04 3 1  ON 41
ci_43                -2.268980e-03 3 1  ON 42
ci_44                -1.496840e-03 3 1  ON 43
ci_45                -7.158770e-04 3 1  ON 44
ci_46                -5.572887e-04 3 1  ON 45
ci_47                 1.170204e-04 3 1  ON 46
ci_48                -1.399508e-04 3 1  ON 47
ci_49                -1.257004e-03 3 1  ON 48
ci_50                -7.497846e-04 3 1  ON 49
ci_51                 7.544001e-04 3 1  ON 50
ci_52                 6.763423e-04 3 1  ON 51
ci_53                -9.742670e-04 3 1  ON 52
ci_54                -7.066908e-04 3 1  ON 53
ci_55                -9.622881e-04 3 1  ON 54
ci_56                 1.734328e-03 3 1  ON 55
ci_57                 1.855816e-03 3 1  ON 56
ci_58                -8.891279e-04 3 1  ON 57
ci_59                -9.163046e-04 3 1  ON 58
ci_60                 6.188125e-04 3 1  ON 59
ci_61                 7.059208e-04 3 1  ON 60
ci_62                -6.648041e-04 3 1  ON 61
ci_63                -5.175152e-04 3 1  ON 62
ci_64                -5.939472e-04 3 1  ON 63
ci_65                -6.207229e-04 3 1  ON 64
ci_66                -6.457002e-04 3 1  ON 65
ci_67                -7.439859e-04 3 1  ON 66
ci_68                -7.323385e-04 3 1  ON 67
ci_69                -8.687174e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8478
    reference variance = 0.316559
====================================================
  Execution time = 4.1492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8697e-01
  Total weights = 1.9638e+06
  Execution time = 5.9139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475012912849
                                         uncertainty =       0.003678702613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475012912849
                                         uncertainty =       0.003678702613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487324153
  error estimate for blocks of size 2^( 2) =       0.000508665285
  error estimate for blocks of size 2^( 3) =       0.000528695482
  error estimate for blocks of size 2^( 4) =       0.000543915418
  error estimate for blocks of size 2^( 5) =       0.000554536025
  error estimate for blocks of size 2^( 6) =       0.000559618322
  error estimate for blocks of size 2^( 7) =       0.000562445841

      target function =      -0.627372364339
              le_mean =     -22.818604458762
             les_mean =     521.242176886423
             stat err =       0.000555128902
             autocorr =       1.297632769587
   target nu stat err =       0.000555128902
   target dn stat err =       0.037286526772
      target stat err =       0.013581366797
              std dev =       0.689180426017
             le_variance =       0.474969659604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474436198547
                                         uncertainty =       0.004562175354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474436198547
                                         uncertainty =       0.004562175354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487024201
  error estimate for blocks of size 2^( 2) =       0.000508504841
  error estimate for blocks of size 2^( 3) =       0.000528645529
  error estimate for blocks of size 2^( 4) =       0.000544048939
  error estimate for blocks of size 2^( 5) =       0.000554797462
  error estimate for blocks of size 2^( 6) =       0.000559981634
  error estimate for blocks of size 2^( 7) =       0.000562984009

      target function =      -0.548030118423
              le_mean =     -22.818609202746
             les_mean =     521.470239931028
             stat err =       0.000555453011
             autocorr =       1.300749192071
   target nu stat err =       0.000555453011
   target dn stat err =       0.209685878576
      target stat err =       0.058909267598
              std dev =       0.688756230718
             le_variance =       0.474385145352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471250985382
                                         uncertainty =       0.003462290598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471250985382
                                         uncertainty =       0.003462290598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485390595
  error estimate for blocks of size 2^( 2) =       0.000506859114
  error estimate for blocks of size 2^( 3) =       0.000527020972
  error estimate for blocks of size 2^( 4) =       0.000542395836
  error estimate for blocks of size 2^( 5) =       0.000553182495
  error estimate for blocks of size 2^( 6) =       0.000558377003
  error estimate for blocks of size 2^( 7) =       0.000561139800

      target function =      -0.651052533480
              le_mean =     -22.818577934119
             les_mean =     521.179046540829
             stat err =       0.000553773783
             autocorr =       1.301613576048
   target nu stat err =       0.000553773783
   target dn stat err =       0.005137431852
      target stat err =       0.002041075720
              std dev =       0.686445962037
             le_variance =       0.471208058797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474290319148
                                         uncertainty =       0.003643965117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474290319148
                                         uncertainty =       0.003643965117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486953424
  error estimate for blocks of size 2^( 2) =       0.000508305630
  error estimate for blocks of size 2^( 3) =       0.000528334976
  error estimate for blocks of size 2^( 4) =       0.000543553267
  error estimate for blocks of size 2^( 5) =       0.000554194268
  error estimate for blocks of size 2^( 6) =       0.000559327788
  error estimate for blocks of size 2^( 7) =       0.000562143123

      target function =      -0.641267267099
              le_mean =     -22.818569619098
             les_mean =     521.203861445249
             stat err =       0.000554804612
             autocorr =       1.298091410239
   target nu stat err =       0.000554804612
   target dn stat err =       0.016559631574
      target stat err =       0.006306142734
              std dev =       0.688656137142
             le_variance =       0.474247275223


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.627372364339        initial
     3.8147e-02     3.8147e-01             1.0136e-02        -0.548030118423
     1.5259e-01     1.5259e+00             3.5845e-03        -0.651052533480  <--
     6.1035e-01     6.1035e+00             1.0016e-03        -0.641267267099

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 7.1170e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_01                 1.346602e-01 3 1  ON 0
ci_02                -3.380060e-02 3 1  ON 1
ci_03                -3.418283e-02 3 1  ON 2
ci_04                 3.053007e-02 3 1  ON 3
ci_05                -2.503850e-02 3 1  ON 4
ci_06                -2.540818e-02 3 1  ON 5
ci_07                 2.779032e-02 3 1  ON 6
ci_08                -8.045367e-03 3 1  ON 7
ci_09                -1.108557e-02 3 1  ON 8
ci_10                -1.081952e-02 3 1  ON 9
ci_11                 1.401118e-02 3 1  ON 10
ci_12                 8.763738e-03 3 1  ON 11
ci_13                 1.193366e-02 3 1  ON 12
ci_14                 1.406078e-02 3 1  ON 13
ci_15                 7.878598e-03 3 1  ON 14
ci_16                 7.743422e-03 3 1  ON 15
ci_17                -8.201342e-03 3 1  ON 16
ci_18                -7.766232e-03 3 1  ON 17
ci_19                 9.326681e-03 3 1  ON 18
ci_20                 7.631927e-03 3 1  ON 19
ci_21                 8.819310e-03 3 1  ON 20
ci_22                 9.185029e-03 3 1  ON 21
ci_23                 5.085804e-03 3 1  ON 22
ci_24                 4.908605e-03 3 1  ON 23
ci_25                 3.847409e-03 3 1  ON 24
ci_26                 3.405293e-03 3 1  ON 25
ci_27                 2.850443e-03 3 1  ON 26
ci_28                 2.317407e-03 3 1  ON 27
ci_29                 2.666404e-03 3 1  ON 28
ci_30                -1.639162e-03 3 1  ON 29
ci_31                -1.667927e-03 3 1  ON 30
ci_32                -1.551619e-03 3 1  ON 31
ci_33                -1.176964e-03 3 1  ON 32
ci_34                 1.083652e-03 3 1  ON 33
ci_35                 1.358955e-03 3 1  ON 34
ci_36                -1.227525e-03 3 1  ON 35
ci_37                -1.378214e-03 3 1  ON 36
ci_38                -7.660216e-04 3 1  ON 37
ci_39                -5.956291e-04 3 1  ON 38
ci_40                -1.602381e-03 3 1  ON 39
ci_41                -7.827037e-04 3 1  ON 40
ci_42                -9.206193e-04 3 1  ON 41
ci_43                -2.268980e-03 3 1  ON 42
ci_44                -1.496840e-03 3 1  ON 43
ci_45                -7.158770e-04 3 1  ON 44
ci_46                -5.572887e-04 3 1  ON 45
ci_47                 1.170204e-04 3 1  ON 46
ci_48                -1.399508e-04 3 1  ON 47
ci_49                -1.257004e-03 3 1  ON 48
ci_50                -7.497846e-04 3 1  ON 49
ci_51                 7.544001e-04 3 1  ON 50
ci_52                 6.763423e-04 3 1  ON 51
ci_53                -9.742670e-04 3 1  ON 52
ci_54                -7.066908e-04 3 1  ON 53
ci_55                -9.622881e-04 3 1  ON 54
ci_56                 1.734328e-03 3 1  ON 55
ci_57                 1.855816e-03 3 1  ON 56
ci_58                -8.891279e-04 3 1  ON 57
ci_59                -9.163046e-04 3 1  ON 58
ci_60                 6.188125e-04 3 1  ON 59
ci_61                 7.059208e-04 3 1  ON 60
ci_62                -6.648041e-04 3 1  ON 61
ci_63                -5.175152e-04 3 1  ON 62
ci_64                -5.939472e-04 3 1  ON 63
ci_65                -6.207229e-04 3 1  ON 64
ci_66                -6.457002e-04 3 1  ON 65
ci_67                -7.439859e-04 3 1  ON 66
ci_68                -7.323385e-04 3 1  ON 67
ci_69                -8.687174e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2139e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7447
    reference variance = 0.38636
====================================================
  Execution time = 4.2527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9258e-01
  Total weights = 1.963654791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475192066614
                                         uncertainty =       0.002617167647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475192066614
                                         uncertainty =       0.002617167647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487488976
  error estimate for blocks of size 2^( 2) =       0.000509257505
  error estimate for blocks of size 2^( 3) =       0.000529144825
  error estimate for blocks of size 2^( 4) =       0.000545094226
  error estimate for blocks of size 2^( 5) =       0.000553612469
  error estimate for blocks of size 2^( 6) =       0.000558537931
  error estimate for blocks of size 2^( 7) =       0.000557333213

      target function =      -0.650408198020
              le_mean =     -22.817581658678
             les_mean =     521.134609968373
             stat err =       0.000553644460
             autocorr =       1.289829541473
   target nu stat err =       0.000553644460
   target dn stat err =       0.003602271515
      target stat err =       0.001446618195
              std dev =       0.689413520770
             le_variance =       0.475291002620


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281758165868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650411000287       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650942533472       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651056865461       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651091491609       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651111452484       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651118294825       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651119372482       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651119428167       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651119376871       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651119353617       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651119378312       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 9.498126e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650411000287       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650630783158       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650673402313       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650684755749       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650689944223       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650691319539       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650691489696       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650691494842       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650691482297       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 3.340319e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650411000287       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650476673725       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650488750627       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650491763664       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650492984269       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650493271782       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650493303330       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650493303928       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650493301111       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 9.313521e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0126e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_01                 1.313199e-01 3 1  ON 0
ci_02                -3.176991e-02 3 1  ON 1
ci_03                -3.234209e-02 3 1  ON 2
ci_04                 2.873455e-02 3 1  ON 3
ci_05                -2.342170e-02 3 1  ON 4
ci_06                -2.435466e-02 3 1  ON 5
ci_07                 2.783659e-02 3 1  ON 6
ci_08                -7.132716e-03 3 1  ON 7
ci_09                -1.066606e-02 3 1  ON 8
ci_10                -1.013654e-02 3 1  ON 9
ci_11                 1.385865e-02 3 1  ON 10
ci_12                 8.541775e-03 3 1  ON 11
ci_13                 1.231076e-02 3 1  ON 12
ci_14                 1.395671e-02 3 1  ON 13
ci_15                 7.611577e-03 3 1  ON 14
ci_16                 7.580434e-03 3 1  ON 15
ci_17                -7.691296e-03 3 1  ON 16
ci_18                -7.415708e-03 3 1  ON 17
ci_19                 9.215016e-03 3 1  ON 18
ci_20                 7.535942e-03 3 1  ON 19
ci_21                 8.742909e-03 3 1  ON 20
ci_22                 9.189499e-03 3 1  ON 21
ci_23                 5.069035e-03 3 1  ON 22
ci_24                 5.053888e-03 3 1  ON 23
ci_25                 3.605469e-03 3 1  ON 24
ci_26                 3.508531e-03 3 1  ON 25
ci_27                 2.933225e-03 3 1  ON 26
ci_28                 2.240503e-03 3 1  ON 27
ci_29                 2.644730e-03 3 1  ON 28
ci_30                -1.319255e-03 3 1  ON 29
ci_31                -1.507419e-03 3 1  ON 30
ci_32                -1.148392e-03 3 1  ON 31
ci_33                -1.309636e-03 3 1  ON 32
ci_34                 7.955627e-04 3 1  ON 33
ci_35                 1.153793e-03 3 1  ON 34
ci_36                -1.141157e-03 3 1  ON 35
ci_37                -1.282711e-03 3 1  ON 36
ci_38                -7.018529e-04 3 1  ON 37
ci_39                -5.080203e-04 3 1  ON 38
ci_40                -1.544106e-03 3 1  ON 39
ci_41                -8.949879e-04 3 1  ON 40
ci_42                -1.016187e-03 3 1  ON 41
ci_43                -2.294456e-03 3 1  ON 42
ci_44                -1.607733e-03 3 1  ON 43
ci_45                -7.842449e-04 3 1  ON 44
ci_46                -4.205585e-04 3 1  ON 45
ci_47                 4.080458e-04 3 1  ON 46
ci_48                 1.748984e-06 3 1  ON 47
ci_49                -1.218638e-03 3 1  ON 48
ci_50                -5.547796e-04 3 1  ON 49
ci_51                 5.755686e-04 3 1  ON 50
ci_52                 4.485490e-04 3 1  ON 51
ci_53                -7.979582e-04 3 1  ON 52
ci_54                -6.991311e-04 3 1  ON 53
ci_55                -1.034871e-03 3 1  ON 54
ci_56                 1.722670e-03 3 1  ON 55
ci_57                 1.774575e-03 3 1  ON 56
ci_58                -4.644937e-04 3 1  ON 57
ci_59                -1.078296e-03 3 1  ON 58
ci_60                 7.696428e-04 3 1  ON 59
ci_61                 1.134448e-03 3 1  ON 60
ci_62                -5.554893e-04 3 1  ON 61
ci_63                -5.724972e-04 3 1  ON 62
ci_64                -4.281405e-04 3 1  ON 63
ci_65                -6.174287e-04 3 1  ON 64
ci_66                -4.931753e-04 3 1  ON 65
ci_67                -4.791746e-04 3 1  ON 66
ci_68                -7.865060e-04 3 1  ON 67
ci_69                -9.736486e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.9166
    reference variance = 0.459282
====================================================
  Execution time = 4.2975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9342e-01
  Total weights = 1.9638e+06
  Execution time = 5.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475810339789
                                         uncertainty =       0.003800360795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475810339789
                                         uncertainty =       0.003800360795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487718226
  error estimate for blocks of size 2^( 2) =       0.000508725974
  error estimate for blocks of size 2^( 3) =       0.000527941642
  error estimate for blocks of size 2^( 4) =       0.000543837520
  error estimate for blocks of size 2^( 5) =       0.000553843307
  error estimate for blocks of size 2^( 6) =       0.000559101458
  error estimate for blocks of size 2^( 7) =       0.000558095361

      target function =      -0.632143183831
              le_mean =     -22.818820155161
             les_mean =     521.239467382482
             stat err =       0.000553719411
             autocorr =       1.288966192535
   target nu stat err =       0.000553719411
   target dn stat err =       0.028551346906
      target stat err =       0.010560504741
              std dev =       0.689737729591
             le_variance =       0.475738135621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473308654070
                                         uncertainty =       0.003880651951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473308654070
                                         uncertainty =       0.003880651951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486435458
  error estimate for blocks of size 2^( 2) =       0.000507627528
  error estimate for blocks of size 2^( 3) =       0.000527076302
  error estimate for blocks of size 2^( 4) =       0.000543118178
  error estimate for blocks of size 2^( 5) =       0.000553170448
  error estimate for blocks of size 2^( 6) =       0.000558546107
  error estimate for blocks of size 2^( 7) =       0.000557660016

      target function =      -0.647167287671
              le_mean =     -22.818876391957
             les_mean =     521.202782461406
             stat err =       0.000553123687
             autocorr =       1.292986725780
   target nu stat err =       0.000553123687
   target dn stat err =       0.009759977075
      target stat err =       0.003795595964
              std dev =       0.687923621367
             le_variance =       0.473238908835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473564740986
                                         uncertainty =       0.003884884438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473564740986
                                         uncertainty =       0.003884884438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486567066
  error estimate for blocks of size 2^( 2) =       0.000507714818
  error estimate for blocks of size 2^( 3) =       0.000527108729
  error estimate for blocks of size 2^( 4) =       0.000543117802
  error estimate for blocks of size 2^( 5) =       0.000553156963
  error estimate for blocks of size 2^( 6) =       0.000558527240
  error estimate for blocks of size 2^( 7) =       0.000557608984

      target function =      -0.646753386507
              le_mean =     -22.818816198930
             les_mean =     521.201066555488
             stat err =       0.000553102747
             autocorr =       1.292189513376
   target nu stat err =       0.000553102747
   target dn stat err =       0.009826895646
      target stat err =       0.003816342942
              std dev =       0.688109743475
             le_variance =       0.473495019065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475273445253
                                         uncertainty =       0.003805632258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475273445253
                                         uncertainty =       0.003805632258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487443158
  error estimate for blocks of size 2^( 2) =       0.000508465877
  error estimate for blocks of size 2^( 3) =       0.000527707838
  error estimate for blocks of size 2^( 4) =       0.000543603861
  error estimate for blocks of size 2^( 5) =       0.000553587958
  error estimate for blocks of size 2^( 6) =       0.000558887985
  error estimate for blocks of size 2^( 7) =       0.000557897707

      target function =      -0.644930813503
              le_mean =     -22.818793439473
             les_mean =     521.204757942386
             stat err =       0.000553494378
             autocorr =       1.289372697765
   target nu stat err =       0.000553494378
   target dn stat err =       0.007981511400
      target stat err =       0.003088222396
              std dev =       0.689348725085
             le_variance =       0.475201664776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.632143183831        initial
     3.8147e-02     3.8147e-01             9.4981e-03        -0.647167287671  <--
     1.5259e-01     1.5259e+00             3.3403e-03        -0.646753386507
     6.1035e-01     6.1035e+00             9.3135e-04        -0.644930813503

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 7.6120e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_01                 1.251620e-01 3 1  ON 0
ci_02                -2.875856e-02 3 1  ON 1
ci_03                -2.962862e-02 3 1  ON 2
ci_04                 2.622711e-02 3 1  ON 3
ci_05                -2.108829e-02 3 1  ON 4
ci_06                -2.289210e-02 3 1  ON 5
ci_07                 2.794110e-02 3 1  ON 6
ci_08                -5.820406e-03 3 1  ON 7
ci_09                -9.988407e-03 3 1  ON 8
ci_10                -9.043875e-03 3 1  ON 9
ci_11                 1.364521e-02 3 1  ON 10
ci_12                 8.232119e-03 3 1  ON 11
ci_13                 1.300652e-02 3 1  ON 12
ci_14                 1.382226e-02 3 1  ON 13
ci_15                 7.205874e-03 3 1  ON 14
ci_16                 7.342202e-03 3 1  ON 15
ci_17                -6.897309e-03 3 1  ON 16
ci_18                -6.866757e-03 3 1  ON 17
ci_19                 9.072737e-03 3 1  ON 18
ci_20                 7.403618e-03 3 1  ON 19
ci_21                 8.661013e-03 3 1  ON 20
ci_22                 9.226853e-03 3 1  ON 21
ci_23                 5.049702e-03 3 1  ON 22
ci_24                 5.342081e-03 3 1  ON 23
ci_25                 3.264068e-03 3 1  ON 24
ci_26                 3.675725e-03 3 1  ON 25
ci_27                 3.073032e-03 3 1  ON 26
ci_28                 2.074793e-03 3 1  ON 27
ci_29                 2.580838e-03 3 1  ON 28
ci_30                -7.614295e-04 3 1  ON 29
ci_31                -1.207532e-03 3 1  ON 30
ci_32                -6.004877e-04 3 1  ON 31
ci_33                -1.527644e-03 3 1  ON 32
ci_34                 4.102688e-04 3 1  ON 33
ci_35                 8.940494e-04 3 1  ON 34
ci_36                -1.015500e-03 3 1  ON 35
ci_37                -1.138749e-03 3 1  ON 36
ci_38                -6.059105e-04 3 1  ON 37
ci_39                -3.801364e-04 3 1  ON 38
ci_40                -1.456978e-03 3 1  ON 39
ci_41                -1.071268e-03 3 1  ON 40
ci_42                -1.171816e-03 3 1  ON 41
ci_43                -2.289756e-03 3 1  ON 42
ci_44                -1.750452e-03 3 1  ON 43
ci_45                -8.699868e-04 3 1  ON 44
ci_46                -2.246545e-04 3 1  ON 45
ci_47                 9.089997e-04 3 1  ON 46
ci_48                 2.614378e-04 3 1  ON 47
ci_49                -1.149180e-03 3 1  ON 48
ci_50                -3.125059e-04 3 1  ON 49
ci_51                 3.084657e-04 3 1  ON 50
ci_52                 1.234046e-04 3 1  ON 51
ci_53                -5.559900e-04 3 1  ON 52
ci_54                -6.754471e-04 3 1  ON 53
ci_55                -1.142891e-03 3 1  ON 54
ci_56                 1.707147e-03 3 1  ON 55
ci_57                 1.671950e-03 3 1  ON 56
ci_58                 1.512486e-04 3 1  ON 57
ci_59                -1.317922e-03 3 1  ON 58
ci_60                 1.047648e-03 3 1  ON 59
ci_61                 1.973022e-03 3 1  ON 60
ci_62                -4.012898e-04 3 1  ON 61
ci_63                -6.439735e-04 3 1  ON 62
ci_64                -1.854888e-04 3 1  ON 63
ci_65                -6.109971e-04 3 1  ON 64
ci_66                -2.814446e-04 3 1  ON 65
ci_67                -1.111591e-04 3 1  ON 66
ci_68                -8.549777e-04 3 1  ON 67
ci_69                -1.126096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2625e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7815
    reference variance = 0.346973
====================================================
  Execution time = 4.2490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5369e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7918e-01
  Total weights = 1.963430982e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465672777268
                                         uncertainty =       0.002461825315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465672777268
                                         uncertainty =       0.002461825315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482552899
  error estimate for blocks of size 2^( 2) =       0.000504070381
  error estimate for blocks of size 2^( 3) =       0.000524684321
  error estimate for blocks of size 2^( 4) =       0.000539324129
  error estimate for blocks of size 2^( 5) =       0.000549632864
  error estimate for blocks of size 2^( 6) =       0.000554928588
  error estimate for blocks of size 2^( 7) =       0.000558003353

      target function =      -0.655937149627
              le_mean =     -22.818569360794
             les_mean =     521.166291583456
             stat err =       0.000550472234
             autocorr =       1.301310627682
   target nu stat err =       0.000550472234
   target dn stat err =       0.002805319956
      target stat err =       0.001164987062
              std dev =       0.682432854650
             le_variance =       0.465714601106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281856936079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655938791279       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656290426028       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656352195359       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656374383156       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656384591077       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656389451356       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656390158537       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656390080763       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656390096318       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.656390320710       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.656390307958       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.656390386975       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-03 is 9.677028e-03

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655938791279       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656166427416       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656202444211       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656213784134       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656217875080       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656219360642       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656219408876       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656219359273       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656219365865       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.656219430186       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 5.183032e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655938791279       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656033207595       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656046513651       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656050138521       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656051129954       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656051401404       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656051372435       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656051358116       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656051361324       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.822822e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0147e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_01                 1.199790e-01 3 1  ON 0
ci_02                -2.772004e-02 3 1  ON 1
ci_03                -2.725134e-02 3 1  ON 2
ci_04                 2.307151e-02 3 1  ON 3
ci_05                -1.941830e-02 3 1  ON 4
ci_06                -2.091988e-02 3 1  ON 5
ci_07                 2.760136e-02 3 1  ON 6
ci_08                -4.569606e-03 3 1  ON 7
ci_09                -7.996285e-03 3 1  ON 8
ci_10                -8.628438e-03 3 1  ON 9
ci_11                 1.253123e-02 3 1  ON 10
ci_12                 7.904542e-03 3 1  ON 11
ci_13                 1.351599e-02 3 1  ON 12
ci_14                 1.513436e-02 3 1  ON 13
ci_15                 6.157580e-03 3 1  ON 14
ci_16                 7.039988e-03 3 1  ON 15
ci_17                -7.203619e-03 3 1  ON 16
ci_18                -6.961790e-03 3 1  ON 17
ci_19                 9.374991e-03 3 1  ON 18
ci_20                 6.507570e-03 3 1  ON 19
ci_21                 8.928447e-03 3 1  ON 20
ci_22                 9.697588e-03 3 1  ON 21
ci_23                 4.911373e-03 3 1  ON 22
ci_24                 5.161659e-03 3 1  ON 23
ci_25                 3.457840e-03 3 1  ON 24
ci_26                 3.915784e-03 3 1  ON 25
ci_27                 3.124150e-03 3 1  ON 26
ci_28                 8.207506e-04 3 1  ON 27
ci_29                 2.832115e-03 3 1  ON 28
ci_30                -1.560389e-03 3 1  ON 29
ci_31                -8.896487e-04 3 1  ON 30
ci_32                -5.150189e-04 3 1  ON 31
ci_33                -1.405920e-03 3 1  ON 32
ci_34                 4.245431e-04 3 1  ON 33
ci_35                 7.434147e-04 3 1  ON 34
ci_36                -9.374005e-04 3 1  ON 35
ci_37                -1.074342e-03 3 1  ON 36
ci_38                -1.255746e-04 3 1  ON 37
ci_39                -5.245131e-04 3 1  ON 38
ci_40                -1.572575e-03 3 1  ON 39
ci_41                -1.285529e-03 3 1  ON 40
ci_42                -1.021572e-03 3 1  ON 41
ci_43                -1.973240e-03 3 1  ON 42
ci_44                -2.252102e-03 3 1  ON 43
ci_45                -6.916156e-04 3 1  ON 44
ci_46                -5.166983e-04 3 1  ON 45
ci_47                 1.123488e-03 3 1  ON 46
ci_48                 6.577323e-04 3 1  ON 47
ci_49                -3.087070e-04 3 1  ON 48
ci_50                -4.591306e-04 3 1  ON 49
ci_51                 4.577424e-05 3 1  ON 50
ci_52                -1.348748e-04 3 1  ON 51
ci_53                -2.988070e-04 3 1  ON 52
ci_54                -7.783431e-04 3 1  ON 53
ci_55                -9.657056e-04 3 1  ON 54
ci_56                 1.603916e-03 3 1  ON 55
ci_57                 1.949822e-03 3 1  ON 56
ci_58                -9.812098e-04 3 1  ON 57
ci_59                -1.138345e-03 3 1  ON 58
ci_60                 1.297552e-03 3 1  ON 59
ci_61                 1.851385e-03 3 1  ON 60
ci_62                -9.077839e-05 3 1  ON 61
ci_63                -3.484078e-04 3 1  ON 62
ci_64                -7.677924e-04 3 1  ON 63
ci_65                -2.238702e-04 3 1  ON 64
ci_66                -2.912912e-04 3 1  ON 65
ci_67                -6.511284e-04 3 1  ON 66
ci_68                -4.547064e-04 3 1  ON 67
ci_69                -1.007700e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7491
    reference variance = 0.343588
====================================================
  Execution time = 4.1301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8679e-01
  Total weights = 1.9642e+06
  Execution time = 5.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0900212
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543067634644
                                         uncertainty =       0.071415920355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543067634644
                                         uncertainty =       0.071415920355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521061887
  error estimate for blocks of size 2^( 2) =       0.000541326825
  error estimate for blocks of size 2^( 3) =       0.000561090249
  error estimate for blocks of size 2^( 4) =       0.000576423467
  error estimate for blocks of size 2^( 5) =       0.000584951009
  error estimate for blocks of size 2^( 6) =       0.000589965946
  error estimate for blocks of size 2^( 7) =       0.000595131041

      target function =      -0.114371056350
              le_mean =     -22.819369245719
             les_mean =     525.763535646581
             stat err =       0.000586617866
             autocorr =       1.267453264759
   target nu stat err =       0.000586617866
   target dn stat err =       4.487821545864
      target stat err =       0.082684120994
              std dev =       0.736892788085
             le_variance =       0.543010981132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470981384996
                                         uncertainty =       0.003284935326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470981384996
                                         uncertainty =       0.003284935326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485287450
  error estimate for blocks of size 2^( 2) =       0.000507115131
  error estimate for blocks of size 2^( 3) =       0.000528300738
  error estimate for blocks of size 2^( 4) =       0.000544588917
  error estimate for blocks of size 2^( 5) =       0.000554067360
  error estimate for blocks of size 2^( 6) =       0.000560272615
  error estimate for blocks of size 2^( 7) =       0.000566381340

      target function =      -0.649732440065
              le_mean =     -22.819455415975
             les_mean =     521.222999224699
             stat err =       0.000556327558
             autocorr =       1.314204730646
   target nu stat err =       0.000556327558
   target dn stat err =       0.007240436108
      target stat err =       0.002848490398
              std dev =       0.686300093814
             le_variance =       0.471007818769

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.091903
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470270061778
                                         uncertainty =       0.002969358298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470270061778
                                         uncertainty =       0.002969358298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484921039
  error estimate for blocks of size 2^( 2) =       0.000506858910
  error estimate for blocks of size 2^( 3) =       0.000528136640
  error estimate for blocks of size 2^( 4) =       0.000544504651
  error estimate for blocks of size 2^( 5) =       0.000553977376
  error estimate for blocks of size 2^( 6) =       0.000560266136
  error estimate for blocks of size 2^( 7) =       0.000566426115

      target function =      -0.603686059197
              le_mean =     -22.819505012055
             les_mean =     521.344795993123
             stat err =       0.000556293569
             autocorr =       1.316030714346
   target nu stat err =       0.000556293569
   target dn stat err =       0.114700203691
      target stat err =       0.038848147706
              std dev =       0.685781910146
             le_variance =       0.470296828283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470522101614
                                         uncertainty =       0.002927803144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470522101614
                                         uncertainty =       0.002927803144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485056136
  error estimate for blocks of size 2^( 2) =       0.000506712779
  error estimate for blocks of size 2^( 3) =       0.000527714983
  error estimate for blocks of size 2^( 4) =       0.000543825494
  error estimate for blocks of size 2^( 5) =       0.000553241205
  error estimate for blocks of size 2^( 6) =       0.000559376956
  error estimate for blocks of size 2^( 7) =       0.000565470852

      target function =      -0.512471458070
              le_mean =     -22.819499200842
             les_mean =     521.600544851632
             stat err =       0.000555478627
             autocorr =       1.311446868070
   target nu stat err =       0.000555478627
   target dn stat err =       0.377731024312
      target stat err =       0.094961355529
              std dev =       0.685972966235
             le_variance =       0.470558910405


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.114371056350        initial
     9.5367e-03     9.5367e-02             9.6770e-03        -0.649732440065  <--
     3.8147e-02     3.8147e-01             5.1830e-03        -0.603686059197
     1.5259e-01     1.5259e+00             1.8228e-03        -0.512471458070

*****************************************************************************
Applying the update for shift_i =   9.5367e-03     and shift_s =   9.5367e-02
*****************************************************************************

  Execution time = 7.0870e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_01                 1.154850e-01 3 1  ON 0
ci_02                -2.717994e-02 3 1  ON 1
ci_03                -2.589862e-02 3 1  ON 2
ci_04                 2.137975e-02 3 1  ON 3
ci_05                -1.853470e-02 3 1  ON 4
ci_06                -1.986978e-02 3 1  ON 5
ci_07                 2.742386e-02 3 1  ON 6
ci_08                -3.863431e-03 3 1  ON 7
ci_09                -6.691012e-03 3 1  ON 8
ci_10                -8.328121e-03 3 1  ON 9
ci_11                 1.179042e-02 3 1  ON 10
ci_12                 7.740051e-03 3 1  ON 11
ci_13                 1.394324e-02 3 1  ON 12
ci_14                 1.653691e-02 3 1  ON 13
ci_15                 5.557089e-03 3 1  ON 14
ci_16                 6.844717e-03 3 1  ON 15
ci_17                -7.384057e-03 3 1  ON 16
ci_18                -7.011258e-03 3 1  ON 17
ci_19                 9.548560e-03 3 1  ON 18
ci_20                 6.001217e-03 3 1  ON 19
ci_21                 9.160735e-03 3 1  ON 20
ci_22                 1.007358e-02 3 1  ON 21
ci_23                 4.829395e-03 3 1  ON 22
ci_24                 5.069344e-03 3 1  ON 23
ci_25                 3.562451e-03 3 1  ON 24
ci_26                 4.063125e-03 3 1  ON 25
ci_27                 3.201290e-03 3 1  ON 26
ci_28                 5.225339e-05 3 1  ON 27
ci_29                 2.934595e-03 3 1  ON 28
ci_30                -2.141764e-03 3 1  ON 29
ci_31                -6.699349e-04 3 1  ON 30
ci_32                -4.862572e-04 3 1  ON 31
ci_33                -1.359570e-03 3 1  ON 32
ci_34                 4.635197e-04 3 1  ON 33
ci_35                 6.611112e-04 3 1  ON 34
ci_36                -9.024620e-04 3 1  ON 35
ci_37                -1.029642e-03 3 1  ON 36
ci_38                 1.287449e-04 3 1  ON 37
ci_39                -6.051447e-04 3 1  ON 38
ci_40                -1.617953e-03 3 1  ON 39
ci_41                -1.423553e-03 3 1  ON 40
ci_42                -9.617682e-04 3 1  ON 41
ci_43                -1.762665e-03 3 1  ON 42
ci_44                -2.529868e-03 3 1  ON 43
ci_45                -5.935797e-04 3 1  ON 44
ci_46                -6.623522e-04 3 1  ON 45
ci_47                 1.316137e-03 3 1  ON 46
ci_48                 9.515813e-04 3 1  ON 47
ci_49                 1.335420e-04 3 1  ON 48
ci_50                -5.308487e-04 3 1  ON 49
ci_51                -9.487231e-05 3 1  ON 50
ci_52                -2.695999e-04 3 1  ON 51
ci_53                -1.605196e-04 3 1  ON 52
ci_54                -8.619847e-04 3 1  ON 53
ci_55                -8.962999e-04 3 1  ON 54
ci_56                 1.546250e-03 3 1  ON 55
ci_57                 2.087953e-03 3 1  ON 56
ci_58                -1.639664e-03 3 1  ON 57
ci_59                -1.046059e-03 3 1  ON 58
ci_60                 1.644681e-03 3 1  ON 59
ci_61                 1.788161e-03 3 1  ON 60
ci_62                 7.040284e-05 3 1  ON 61
ci_63                -2.036162e-04 3 1  ON 62
ci_64                -1.068769e-03 3 1  ON 63
ci_65                -2.510304e-05 3 1  ON 64
ci_66                -2.964629e-04 3 1  ON 65
ci_67                -9.427795e-04 3 1  ON 66
ci_68                -2.178016e-04 3 1  ON 67
ci_69                -9.367798e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2103e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7406
    reference variance = 0.611377
====================================================
  Execution time = 4.2544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7873e-01
  Total weights = 1.964228135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466310627174
                                         uncertainty =       0.002267058064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466310627174
                                         uncertainty =       0.002267058064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482834821
  error estimate for blocks of size 2^( 2) =       0.000504252745
  error estimate for blocks of size 2^( 3) =       0.000524651918
  error estimate for blocks of size 2^( 4) =       0.000541330153
  error estimate for blocks of size 2^( 5) =       0.000550498687
  error estimate for blocks of size 2^( 6) =       0.000556448384
  error estimate for blocks of size 2^( 7) =       0.000556933454

      target function =      -0.656107480681
              le_mean =     -22.818524194006
             les_mean =     521.163773780355
             stat err =       0.000551302669
             autocorr =       1.303716085709
   target nu stat err =       0.000551302669
   target dn stat err =       0.002705734207
      target stat err =       0.001127747236
              std dev =       0.682831552850
             le_variance =       0.466258929567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281852419401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.656108987927       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656259117354       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656286447427       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656297741346       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656302145469       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656306282751       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656308493966       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656308886489       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656308939669       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.656308734868       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.656308722472       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.656308782878       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.656308807429       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 4.966628e-03

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.656108987927       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656237844969       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656259909387       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656268558028       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656271655048       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656274427116       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656275838597       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656276017816       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656276022037       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.656275889452       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.656275883722       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-03 is 3.881293e-03

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.656108987927       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656191227468       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656203473074       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656207758348       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656209021624       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656210056910       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656210535713       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656210546909       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656210531909       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.656210490740       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 2.056023e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0170e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_01                 1.116037e-01 3 1  ON 0
ci_02                -2.568594e-02 3 1  ON 1
ci_03                -2.326815e-02 3 1  ON 2
ci_04                 2.153414e-02 3 1  ON 3
ci_05                -2.026151e-02 3 1  ON 4
ci_06                -2.097352e-02 3 1  ON 5
ci_07                 2.661693e-02 3 1  ON 6
ci_08                -3.908911e-03 3 1  ON 7
ci_09                -7.907451e-03 3 1  ON 8
ci_10                -7.428486e-03 3 1  ON 9
ci_11                 1.271103e-02 3 1  ON 10
ci_12                 7.651131e-03 3 1  ON 11
ci_13                 1.153894e-02 3 1  ON 12
ci_14                 1.562171e-02 3 1  ON 13
ci_15                 5.786587e-03 3 1  ON 14
ci_16                 6.963771e-03 3 1  ON 15
ci_17                -6.860458e-03 3 1  ON 16
ci_18                -7.142184e-03 3 1  ON 17
ci_19                 8.717834e-03 3 1  ON 18
ci_20                 8.286160e-03 3 1  ON 19
ci_21                 8.516051e-03 3 1  ON 20
ci_22                 8.287666e-03 3 1  ON 21
ci_23                 5.235903e-03 3 1  ON 22
ci_24                 4.719849e-03 3 1  ON 23
ci_25                 3.470060e-03 3 1  ON 24
ci_26                 3.125596e-03 3 1  ON 25
ci_27                 3.110644e-03 3 1  ON 26
ci_28                 1.998322e-03 3 1  ON 27
ci_29                 1.168217e-03 3 1  ON 28
ci_30                -1.612701e-03 3 1  ON 29
ci_31                -9.026717e-04 3 1  ON 30
ci_32                -7.223621e-04 3 1  ON 31
ci_33                -1.370429e-03 3 1  ON 32
ci_34                 1.579932e-03 3 1  ON 33
ci_35                -4.932005e-04 3 1  ON 34
ci_36                -8.362156e-04 3 1  ON 35
ci_37                -9.788453e-04 3 1  ON 36
ci_38                -1.792920e-04 3 1  ON 37
ci_39                -3.771418e-04 3 1  ON 38
ci_40                -9.505508e-04 3 1  ON 39
ci_41                -7.578040e-04 3 1  ON 40
ci_42                -6.276477e-04 3 1  ON 41
ci_43                -2.308686e-03 3 1  ON 42
ci_44                -1.523252e-03 3 1  ON 43
ci_45                -7.306809e-04 3 1  ON 44
ci_46                -5.459363e-04 3 1  ON 45
ci_47                 1.365925e-03 3 1  ON 46
ci_48                -5.544490e-05 3 1  ON 47
ci_49                -1.008929e-03 3 1  ON 48
ci_50                -7.230789e-04 3 1  ON 49
ci_51                 4.744451e-04 3 1  ON 50
ci_52                 4.107797e-04 3 1  ON 51
ci_53                -7.915040e-04 3 1  ON 52
ci_54                -8.592446e-04 3 1  ON 53
ci_55                -5.693338e-04 3 1  ON 54
ci_56                 1.782404e-03 3 1  ON 55
ci_57                 1.584755e-03 3 1  ON 56
ci_58                -7.601455e-04 3 1  ON 57
ci_59                -9.341418e-04 3 1  ON 58
ci_60                 2.118634e-04 3 1  ON 59
ci_61                 2.524660e-04 3 1  ON 60
ci_62                -2.334438e-04 3 1  ON 61
ci_63                -8.899824e-05 3 1  ON 62
ci_64                 6.498058e-04 3 1  ON 63
ci_65                -1.064525e-04 3 1  ON 64
ci_66                 7.702811e-05 3 1  ON 65
ci_67                 3.132931e-04 3 1  ON 66
ci_68                -5.962190e-04 3 1  ON 67
ci_69                -6.643987e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8247
    reference variance = 0.269752
====================================================
  Execution time = 4.1315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8458e-01
  Total weights = 1.9640e+06
  Execution time = 5.9009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472936688599
                                         uncertainty =       0.003568269516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472936688599
                                         uncertainty =       0.003568269516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486249286
  error estimate for blocks of size 2^( 2) =       0.000508150586
  error estimate for blocks of size 2^( 3) =       0.000528831460
  error estimate for blocks of size 2^( 4) =       0.000544750508
  error estimate for blocks of size 2^( 5) =       0.000555013381
  error estimate for blocks of size 2^( 6) =       0.000561088267
  error estimate for blocks of size 2^( 7) =       0.000559436749

      target function =      -0.603377013052
              le_mean =     -22.819327367810
             les_mean =     521.341254495431
             stat err =       0.000555072226
             autocorr =       1.303109892405
   target nu stat err =       0.000555072226
   target dn stat err =       0.080624046185
      target stat err =       0.027218125843
              std dev =       0.687660334792
             le_variance =       0.472876736046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470936768746
                                         uncertainty =       0.003442950360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470936768746
                                         uncertainty =       0.003442950360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485222017
  error estimate for blocks of size 2^( 2) =       0.000507214275
  error estimate for blocks of size 2^( 3) =       0.000527989820
  error estimate for blocks of size 2^( 4) =       0.000544033110
  error estimate for blocks of size 2^( 5) =       0.000554323205
  error estimate for blocks of size 2^( 6) =       0.000560498509
  error estimate for blocks of size 2^( 7) =       0.000558993281

      target function =      -0.653758428697
              le_mean =     -22.819149913069
             les_mean =     521.198645308789
             stat err =       0.000554462026
             autocorr =       1.305757765415
   target nu stat err =       0.000554462026
   target dn stat err =       0.003576642540
      target stat err =       0.001453534841
              std dev =       0.686207557822
             le_variance =       0.470880812411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472118540018
                                         uncertainty =       0.003472148570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472118540018
                                         uncertainty =       0.003472148570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485830045
  error estimate for blocks of size 2^( 2) =       0.000507847117
  error estimate for blocks of size 2^( 3) =       0.000528639009
  error estimate for blocks of size 2^( 4) =       0.000544758850
  error estimate for blocks of size 2^( 5) =       0.000555050511
  error estimate for blocks of size 2^( 6) =       0.000561231047
  error estimate for blocks of size 2^( 7) =       0.000559772121

      target function =      -0.633129393837
              le_mean =     -22.819223049903
             les_mean =     521.255061467568
             stat err =       0.000555203132
             autocorr =       1.305975639373
   target nu stat err =       0.000555203132
   target dn stat err =       0.037873059130
      target stat err =       0.014057538322
              std dev =       0.687067438945
             le_variance =       0.472061665659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471069288123
                                         uncertainty =       0.003454465164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471069288123
                                         uncertainty =       0.003454465164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485289929
  error estimate for blocks of size 2^( 2) =       0.000507248352
  error estimate for blocks of size 2^( 3) =       0.000527986614
  error estimate for blocks of size 2^( 4) =       0.000543980271
  error estimate for blocks of size 2^( 5) =       0.000554252582
  error estimate for blocks of size 2^( 6) =       0.000560414387
  error estimate for blocks of size 2^( 7) =       0.000558876023

      target function =      -0.653268168202
              le_mean =     -22.819182543268
             les_mean =     521.201395456470
             stat err =       0.000554380816
             autocorr =       1.305009969145
   target nu stat err =       0.000554380816
   target dn stat err =       0.003661475939
      target stat err =       0.001484058233
              std dev =       0.686303599053
             le_variance =       0.471012630074


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.603377013052        initial
     2.3842e-03     2.3842e-02             4.9666e-03        -0.653758428697  <--
     9.5367e-03     9.5367e-02             3.8813e-03        -0.633129393837
     3.8147e-02     3.8147e-01             2.0560e-03        -0.653268168202

*****************************************************************************
Applying the update for shift_i =   2.3842e-03     and shift_s =   2.3842e-02
*****************************************************************************

  Execution time = 7.2474e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_01                 1.105184e-01 3 1  ON 0
ci_02                -2.540133e-02 3 1  ON 1
ci_03                -2.278128e-02 3 1  ON 2
ci_04                 2.156561e-02 3 1  ON 3
ci_05                -2.064611e-02 3 1  ON 4
ci_06                -2.123390e-02 3 1  ON 5
ci_07                 2.647409e-02 3 1  ON 6
ci_08                -3.902869e-03 3 1  ON 7
ci_09                -8.149455e-03 3 1  ON 8
ci_10                -7.259944e-03 3 1  ON 9
ci_11                 1.294191e-02 3 1  ON 10
ci_12                 7.648079e-03 3 1  ON 11
ci_13                 1.093484e-02 3 1  ON 12
ci_14                 1.522693e-02 3 1  ON 13
ci_15                 5.817971e-03 3 1  ON 14
ci_16                 6.987168e-03 3 1  ON 15
ci_17                -6.789138e-03 3 1  ON 16
ci_18                -7.173747e-03 3 1  ON 17
ci_19                 8.589215e-03 3 1  ON 18
ci_20                 8.682043e-03 3 1  ON 19
ci_21                 8.337171e-03 3 1  ON 20
ci_22                 7.823241e-03 3 1  ON 21
ci_23                 5.296897e-03 3 1  ON 22
ci_24                 4.622873e-03 3 1  ON 23
ci_25                 3.456669e-03 3 1  ON 24
ci_26                 2.945575e-03 3 1  ON 25
ci_27                 3.081403e-03 3 1  ON 26
ci_28                 2.333682e-03 3 1  ON 27
ci_29                 8.486433e-04 3 1  ON 28
ci_30                -1.516865e-03 3 1  ON 29
ci_31                -9.662467e-04 3 1  ON 30
ci_32                -7.554991e-04 3 1  ON 31
ci_33                -1.366729e-03 3 1  ON 32
ci_34                 1.791839e-03 3 1  ON 33
ci_35                -6.853929e-04 3 1  ON 34
ci_36                -8.261972e-04 3 1  ON 35
ci_37                -9.717460e-04 3 1  ON 36
ci_38                -2.241243e-04 3 1  ON 37
ci_39                -3.370461e-04 3 1  ON 38
ci_40                -8.495756e-04 3 1  ON 39
ci_41                -6.489338e-04 3 1  ON 40
ci_42                -5.709640e-04 3 1  ON 41
ci_43                -2.421157e-03 3 1  ON 42
ci_44                -1.351996e-03 3 1  ON 43
ci_45                -7.546350e-04 3 1  ON 44
ci_46                -5.274478e-04 3 1  ON 45
ci_47                 1.382224e-03 3 1  ON 46
ci_48                -2.813427e-04 3 1  ON 47
ci_49                -1.190987e-03 3 1  ON 48
ci_50                -7.450946e-04 3 1  ON 49
ci_51                 5.665227e-04 3 1  ON 50
ci_52                 5.194671e-04 3 1  ON 51
ci_53                -8.799451e-04 3 1  ON 52
ci_54                -8.521799e-04 3 1  ON 53
ci_55                -5.035122e-04 3 1  ON 54
ci_56                 1.822134e-03 3 1  ON 55
ci_57                 1.512158e-03 3 1  ON 56
ci_58                -6.003474e-04 3 1  ON 57
ci_59                -9.112633e-04 3 1  ON 58
ci_60                -2.952407e-04 3 1  ON 59
ci_61                -2.831800e-04 3 1  ON 60
ci_62                -2.771214e-04 3 1  ON 61
ci_63                -6.981638e-05 3 1  ON 62
ci_64                 9.226294e-04 3 1  ON 63
ci_65                -1.309027e-04 3 1  ON 64
ci_66                 1.396011e-04 3 1  ON 65
ci_67                 5.200522e-04 3 1  ON 66
ci_68                -6.554049e-04 3 1  ON 67
ci_69                -6.102564e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2266e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7754
    reference variance = 0.430092
====================================================
  Execution time = 4.2605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8673e-01
  Total weights = 1.963945723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472686393582
                                         uncertainty =       0.002561398475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472686393582
                                         uncertainty =       0.002561398475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486140622
  error estimate for blocks of size 2^( 2) =       0.000507558831
  error estimate for blocks of size 2^( 3) =       0.000528082303
  error estimate for blocks of size 2^( 4) =       0.000543178838
  error estimate for blocks of size 2^( 5) =       0.000551099541
  error estimate for blocks of size 2^( 6) =       0.000555370255
  error estimate for blocks of size 2^( 7) =       0.000559276450

      target function =      -0.652711362068
              le_mean =     -22.817618710661
             les_mean =     521.130450866460
             stat err =       0.000552231271
             autocorr =       1.290381614026
   target nu stat err =       0.000552231271
   target dn stat err =       0.003822322366
      target stat err =       0.001540912541
              std dev =       0.687506661207
             le_variance =       0.472665409204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281761871066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652714601503       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652895555244       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652928572038       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652937505509       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652940027372       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652942463142       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652943455935       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652943708845       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652943861225       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652943912109       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 3.247414e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652714601503       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652888247445       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652919410061       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652927700389       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652930014504       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652932222650       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652933075319       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652933287777       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652933419338       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652933461244       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 3.095914e-03

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652714601503       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652864096396       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652889471466       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652895853034       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652897572448       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652899149014       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652899657741       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652899776395       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652899857443       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652899879025       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-03 is 2.608994e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2208e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_01                 1.088925e-01 3 1  ON 0
ci_02                -2.255597e-02 3 1  ON 1
ci_03                -2.573437e-02 3 1  ON 2
ci_04                 2.177049e-02 3 1  ON 3
ci_05                -2.019377e-02 3 1  ON 4
ci_06                -1.859986e-02 3 1  ON 5
ci_07                 2.595418e-02 3 1  ON 6
ci_08                -3.350386e-03 3 1  ON 7
ci_09                -7.697455e-03 3 1  ON 8
ci_10                -6.830544e-03 3 1  ON 9
ci_11                 1.190598e-02 3 1  ON 10
ci_12                 7.240420e-03 3 1  ON 11
ci_13                 1.107945e-02 3 1  ON 12
ci_14                 1.324379e-02 3 1  ON 13
ci_15                 6.802992e-03 3 1  ON 14
ci_16                 6.450867e-03 3 1  ON 15
ci_17                -6.366862e-03 3 1  ON 16
ci_18                -4.077832e-03 3 1  ON 17
ci_19                 8.521348e-03 3 1  ON 18
ci_20                 5.851128e-03 3 1  ON 19
ci_21                 8.628931e-03 3 1  ON 20
ci_22                 7.965325e-03 3 1  ON 21
ci_23                 5.210201e-03 3 1  ON 22
ci_24                 5.748869e-03 3 1  ON 23
ci_25                 3.328990e-03 3 1  ON 24
ci_26                 2.292317e-03 3 1  ON 25
ci_27                 2.582312e-03 3 1  ON 26
ci_28                 2.125343e-03 3 1  ON 27
ci_29                 1.418947e-03 3 1  ON 28
ci_30                -4.698865e-04 3 1  ON 29
ci_31                -5.606521e-04 3 1  ON 30
ci_32                -9.391738e-04 3 1  ON 31
ci_33                -1.339266e-04 3 1  ON 32
ci_34                 8.660257e-04 3 1  ON 33
ci_35                 2.248632e-03 3 1  ON 34
ci_36                -6.961513e-04 3 1  ON 35
ci_37                -4.817684e-04 3 1  ON 36
ci_38                 2.136500e-05 3 1  ON 37
ci_39                -6.792651e-04 3 1  ON 38
ci_40                -8.945879e-04 3 1  ON 39
ci_41                -1.447214e-03 3 1  ON 40
ci_42                -1.553845e-03 3 1  ON 41
ci_43                -1.557575e-03 3 1  ON 42
ci_44                -3.499395e-03 3 1  ON 43
ci_45                -3.445164e-05 3 1  ON 44
ci_46                -4.678234e-05 3 1  ON 45
ci_47                 1.713911e-03 3 1  ON 46
ci_48                 1.409268e-03 3 1  ON 47
ci_49                 2.430774e-04 3 1  ON 48
ci_50                -5.017090e-05 3 1  ON 49
ci_51                 9.135014e-04 3 1  ON 50
ci_52                 7.869698e-04 3 1  ON 51
ci_53                -1.465475e-03 3 1  ON 52
ci_54                -3.933506e-04 3 1  ON 53
ci_55                -1.429874e-04 3 1  ON 54
ci_56                 9.988289e-04 3 1  ON 55
ci_57                 1.860250e-03 3 1  ON 56
ci_58                -8.187207e-04 3 1  ON 57
ci_59                -1.125562e-03 3 1  ON 58
ci_60                 1.088879e-03 3 1  ON 59
ci_61                 1.629344e-03 3 1  ON 60
ci_62                 3.340328e-04 3 1  ON 61
ci_63                -3.080082e-04 3 1  ON 62
ci_64                -7.095416e-04 3 1  ON 63
ci_65                 4.619658e-04 3 1  ON 64
ci_66                -7.777810e-04 3 1  ON 65
ci_67                -1.787598e-04 3 1  ON 66
ci_68                -2.152211e-03 3 1  ON 67
ci_69                -8.736702e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7844
    reference variance = 0.371956
====================================================
  Execution time = 4.1504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8876e-01
  Total weights = 1.9642e+06
  Execution time = 5.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0448559
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475921179123
                                         uncertainty =       0.003643039794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475921179123
                                         uncertainty =       0.003643039794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488180389
  error estimate for blocks of size 2^( 2) =       0.000509621455
  error estimate for blocks of size 2^( 3) =       0.000530079332
  error estimate for blocks of size 2^( 4) =       0.000545576934
  error estimate for blocks of size 2^( 5) =       0.000556150240
  error estimate for blocks of size 2^( 6) =       0.000561454405
  error estimate for blocks of size 2^( 7) =       0.000562688988

      target function =      -0.506958108543
              le_mean =     -22.817900752441
             les_mean =     521.588472688122
             stat err =       0.000556467642
             autocorr =       1.299329124038
   target nu stat err =       0.000556467642
   target dn stat err =       0.258169979086
      target stat err =       0.062241521600
              std dev =       0.690391326648
             le_variance =       0.476640183911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469578626283
                                         uncertainty =       0.002292401642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469578626283
                                         uncertainty =       0.002292401642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484925377
  error estimate for blocks of size 2^( 2) =       0.000506586117
  error estimate for blocks of size 2^( 3) =       0.000527284833
  error estimate for blocks of size 2^( 4) =       0.000542952576
  error estimate for blocks of size 2^( 5) =       0.000553384237
  error estimate for blocks of size 2^( 6) =       0.000558855043
  error estimate for blocks of size 2^( 7) =       0.000560318701

      target function =      -0.651782927206
              le_mean =     -22.817691049501
             les_mean =     521.136155751677
             stat err =       0.000553877639
             autocorr =       1.304601402968
   target nu stat err =       0.000553877639
   target dn stat err =       0.004604375055
      target stat err =       0.001837815775
              std dev =       0.685788044714
             le_variance =       0.470305242272

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0452504
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.444144931251
                                         uncertainty =       2.950351366303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.444144931251
                                         uncertainty =       2.950351366303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001311911138
  error estimate for blocks of size 2^( 2) =       0.001320059254
  error estimate for blocks of size 2^( 3) =       0.001328456399
  error estimate for blocks of size 2^( 4) =       0.001335108440
  error estimate for blocks of size 2^( 5) =       0.001340153182
  error estimate for blocks of size 2^( 6) =       0.001342820204
  error estimate for blocks of size 2^( 7) =       0.001346338798

      target function =      -0.000767691840
              le_mean =     -22.816549431377
             les_mean =    1228.374555670880
             stat err =       0.001341105156
             autocorr =       1.045001288754
   target nu stat err =       0.001341105156
   target dn stat err =     706.360358373926
      target stat err =       0.000764884448
              std dev =       1.855322523725
             le_variance =       3.442221667040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469576768121
                                         uncertainty =       0.002332534191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469576768121
                                         uncertainty =       0.002332534191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484923953
  error estimate for blocks of size 2^( 2) =       0.000506567219
  error estimate for blocks of size 2^( 3) =       0.000527248525
  error estimate for blocks of size 2^( 4) =       0.000542908070
  error estimate for blocks of size 2^( 5) =       0.000553330755
  error estimate for blocks of size 2^( 6) =       0.000558800037
  error estimate for blocks of size 2^( 7) =       0.000560242457

      target function =      -0.650835688333
              le_mean =     -22.817696024338
             les_mean =     521.138799540240
             stat err =       0.000553820330
             autocorr =       1.304339102083
   target nu stat err =       0.000553820330
   target dn stat err =       0.005143150918
      target stat err =       0.002040285413
              std dev =       0.685786031200
             le_variance =       0.470302480590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.506958108543        initial
     5.9605e-04     5.9605e-03             3.2474e-03        -0.651782927206  <--
     2.3842e-03     2.3842e-02             3.0959e-03        -0.000767691840
     9.5367e-03     9.5367e-02             2.6090e-03        -0.650835688333

*****************************************************************************
Applying the update for shift_i =   5.9605e-04     and shift_s =   5.9605e-03
*****************************************************************************

  Execution time = 7.1081e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_01                 1.087861e-01 3 1  ON 0
ci_02                -2.241779e-02 3 1  ON 1
ci_03                -2.588602e-02 3 1  ON 2
ci_04                 2.178015e-02 3 1  ON 3
ci_05                -2.017144e-02 3 1  ON 4
ci_06                -1.846916e-02 3 1  ON 5
ci_07                 2.592365e-02 3 1  ON 6
ci_08                -3.327295e-03 3 1  ON 7
ci_09                -7.670876e-03 3 1  ON 8
ci_10                -6.809276e-03 3 1  ON 9
ci_11                 1.185393e-02 3 1  ON 10
ci_12                 7.223434e-03 3 1  ON 11
ci_13                 1.110630e-02 3 1  ON 12
ci_14                 1.308829e-02 3 1  ON 13
ci_15                 6.851897e-03 3 1  ON 14
ci_16                 6.426803e-03 3 1  ON 15
ci_17                -6.347853e-03 3 1  ON 16
ci_18                -3.926333e-03 3 1  ON 17
ci_19                 8.520233e-03 3 1  ON 18
ci_20                 5.728484e-03 3 1  ON 19
ci_21                 8.641827e-03 3 1  ON 20
ci_22                 7.978199e-03 3 1  ON 21
ci_23                 5.207628e-03 3 1  ON 22
ci_24                 5.826752e-03 3 1  ON 23
ci_25                 3.323497e-03 3 1  ON 24
ci_26                 2.259503e-03 3 1  ON 25
ci_27                 2.555235e-03 3 1  ON 26
ci_28                 2.116531e-03 3 1  ON 27
ci_29                 1.441169e-03 3 1  ON 28
ci_30                -3.969465e-04 3 1  ON 29
ci_31                -5.383799e-04 3 1  ON 30
ci_32                -9.459473e-04 3 1  ON 31
ci_33                -8.393745e-05 3 1  ON 32
ci_34                 8.167734e-04 3 1  ON 33
ci_35                 2.394140e-03 3 1  ON 34
ci_36                -6.916662e-04 3 1  ON 35
ci_37                -4.649849e-04 3 1  ON 36
ci_38                 2.926510e-05 3 1  ON 37
ci_39                -6.960845e-04 3 1  ON 38
ci_40                -8.966125e-04 3 1  ON 39
ci_41                -1.480358e-03 3 1  ON 40
ci_42                -1.592359e-03 3 1  ON 41
ci_43                -1.516357e-03 3 1  ON 42
ci_44                -3.600134e-03 3 1  ON 43
ci_45                -5.732709e-06 3 1  ON 44
ci_46                -2.602107e-05 3 1  ON 45
ci_47                 1.738078e-03 3 1  ON 46
ci_48                 1.515551e-03 3 1  ON 47
ci_49                 3.032893e-04 3 1  ON 48
ci_50                -2.486263e-05 3 1  ON 49
ci_51                 9.257623e-04 3 1  ON 50
ci_52                 7.965956e-04 3 1  ON 51
ci_53                -1.487023e-03 3 1  ON 52
ci_54                -3.669344e-04 3 1  ON 53
ci_55                -1.222249e-04 3 1  ON 54
ci_56                 9.653322e-04 3 1  ON 55
ci_57                 1.873379e-03 3 1  ON 56
ci_58                -8.302299e-04 3 1  ON 57
ci_59                -1.135146e-03 3 1  ON 58
ci_60                 1.191920e-03 3 1  ON 59
ci_61                 1.781945e-03 3 1  ON 60
ci_62                 3.583158e-04 3 1  ON 61
ci_63                -3.180506e-04 3 1  ON 62
ci_64                -7.763107e-04 3 1  ON 63
ci_65                 4.886526e-04 3 1  ON 64
ci_66                -8.171113e-04 3 1  ON 65
ci_67                -2.084102e-04 3 1  ON 66
ci_68                -2.216775e-03 3 1  ON 67
ci_69                -8.838704e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2330e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7438
    reference variance = 0.573203
====================================================
  Execution time = 4.2517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8859e-01
  Total weights = 1.964261917e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474272423869
                                         uncertainty =       0.002748857893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474272423869
                                         uncertainty =       0.002748857893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486935734
  error estimate for blocks of size 2^( 2) =       0.000508512206
  error estimate for blocks of size 2^( 3) =       0.000528918361
  error estimate for blocks of size 2^( 4) =       0.000543163053
  error estimate for blocks of size 2^( 5) =       0.000551670366
  error estimate for blocks of size 2^( 6) =       0.000558403012
  error estimate for blocks of size 2^( 7) =       0.000560925883

      target function =      -0.652423963149
              le_mean =     -22.819404522595
             les_mean =     521.213808558655
             stat err =       0.000553540578
             autocorr =       1.292277054349
   target nu stat err =       0.000553540578
   target dn stat err =       0.003228115186
      target stat err =       0.001314776130
              std dev =       0.688631119205
             le_variance =       0.474212818338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281940452259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652426185915       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652641754752       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652670800921       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652684645998       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652687166249       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652689519338       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652691490058       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652692138441       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652692375945       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652692330828       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652692090508       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652692005921       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.652691915815       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 3.785278e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652426185915       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652639628297       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652668250825       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652681840831       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652684284772       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652686558826       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652688452886       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652689070440       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652689294691       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652689248063       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652689016777       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652688935526       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.652688849757       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 3.702998e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652426185915       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652631525900       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652658563341       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652671212360       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652673382395       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652675377436       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652677006471       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652677520120       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652677700239       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652677649807       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652677450049       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652677380376       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.652677309276       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 3.407080e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0148e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_01                 1.112333e-01 3 1  ON 0
ci_02                -2.274224e-02 3 1  ON 1
ci_03                -2.420406e-02 3 1  ON 2
ci_04                 2.102794e-02 3 1  ON 3
ci_05                -2.135866e-02 3 1  ON 4
ci_06                -2.024082e-02 3 1  ON 5
ci_07                 2.659802e-02 3 1  ON 6
ci_08                -4.376813e-03 3 1  ON 7
ci_09                -8.120204e-03 3 1  ON 8
ci_10                -8.683124e-03 3 1  ON 9
ci_11                 1.303957e-02 3 1  ON 10
ci_12                 8.388105e-03 3 1  ON 11
ci_13                 1.262784e-02 3 1  ON 12
ci_14                 1.666853e-02 3 1  ON 13
ci_15                 6.271935e-03 3 1  ON 14
ci_16                 5.400952e-03 3 1  ON 15
ci_17                -7.112440e-03 3 1  ON 16
ci_18                -7.122853e-03 3 1  ON 17
ci_19                 1.108330e-02 3 1  ON 18
ci_20                 6.629702e-03 3 1  ON 19
ci_21                 9.301451e-03 3 1  ON 20
ci_22                 8.732526e-03 3 1  ON 21
ci_23                 5.066798e-03 3 1  ON 22
ci_24                 5.140876e-03 3 1  ON 23
ci_25                 3.325591e-03 3 1  ON 24
ci_26                 1.451364e-03 3 1  ON 25
ci_27                 2.124797e-03 3 1  ON 26
ci_28                 2.619136e-03 3 1  ON 27
ci_29                 1.546401e-03 3 1  ON 28
ci_30                -1.371499e-03 3 1  ON 29
ci_31                -2.995967e-04 3 1  ON 30
ci_32                -5.181922e-04 3 1  ON 31
ci_33                -3.666778e-04 3 1  ON 32
ci_34                 1.933738e-03 3 1  ON 33
ci_35                 1.440331e-03 3 1  ON 34
ci_36                -1.114090e-03 3 1  ON 35
ci_37                -1.112166e-03 3 1  ON 36
ci_38                -1.004030e-03 3 1  ON 37
ci_39                -1.017244e-03 3 1  ON 38
ci_40                -2.405279e-03 3 1  ON 39
ci_41                -7.177580e-04 3 1  ON 40
ci_42                 2.777573e-05 3 1  ON 41
ci_43                -3.454012e-03 3 1  ON 42
ci_44                -1.562324e-03 3 1  ON 43
ci_45                -4.352070e-04 3 1  ON 44
ci_46                 9.234825e-04 3 1  ON 45
ci_47                 2.025482e-03 3 1  ON 46
ci_48                 5.380415e-04 3 1  ON 47
ci_49                -3.962218e-04 3 1  ON 48
ci_50                -5.232787e-04 3 1  ON 49
ci_51                -9.001341e-04 3 1  ON 50
ci_52                 5.379091e-04 3 1  ON 51
ci_53                 4.843770e-04 3 1  ON 52
ci_54                -1.703928e-05 3 1  ON 53
ci_55                 3.288217e-05 3 1  ON 54
ci_56                 1.892653e-03 3 1  ON 55
ci_57                 2.789270e-03 3 1  ON 56
ci_58                -1.159618e-03 3 1  ON 57
ci_59                -1.439609e-03 3 1  ON 58
ci_60                 4.866383e-03 3 1  ON 59
ci_61                -1.921053e-03 3 1  ON 60
ci_62                -1.396863e-04 3 1  ON 61
ci_63                -6.625470e-04 3 1  ON 62
ci_64                -6.085591e-04 3 1  ON 63
ci_65                -4.630258e-04 3 1  ON 64
ci_66                -1.051740e-03 3 1  ON 65
ci_67                 1.047429e-04 3 1  ON 66
ci_68                -9.443850e-04 3 1  ON 67
ci_69                -2.734245e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.821
    reference variance = 0.361084
====================================================
  Execution time = 4.1276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8585e-01
  Total weights = 1.9639e+06
  Execution time = 5.9142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0574624
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472645402360
                                         uncertainty =       0.003040385445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472645402360
                                         uncertainty =       0.003040385445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486150699
  error estimate for blocks of size 2^( 2) =       0.000507989419
  error estimate for blocks of size 2^( 3) =       0.000528780171
  error estimate for blocks of size 2^( 4) =       0.000544778477
  error estimate for blocks of size 2^( 5) =       0.000554818631
  error estimate for blocks of size 2^( 6) =       0.000561819819
  error estimate for blocks of size 2^( 7) =       0.000565546060

      target function =      -0.623350178763
              le_mean =     -22.819055066375
             les_mean =     521.272954739813
             stat err =       0.000556740747
             autocorr =       1.311487591756
   target nu stat err =       0.000556740747
   target dn stat err =       0.058404157210
      target stat err =       0.021020734673
              std dev =       0.687520911992
             le_variance =       0.472685004427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470188359783
                                         uncertainty =       0.002920707834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470188359783
                                         uncertainty =       0.002920707834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484888038
  error estimate for blocks of size 2^( 2) =       0.000506716131
  error estimate for blocks of size 2^( 3) =       0.000527498334
  error estimate for blocks of size 2^( 4) =       0.000543444452
  error estimate for blocks of size 2^( 5) =       0.000553528516
  error estimate for blocks of size 2^( 6) =       0.000560465134
  error estimate for blocks of size 2^( 7) =       0.000564293280

      target function =      -0.653373683905
              le_mean =     -22.818937308150
             les_mean =     521.189779139901
             stat err =       0.000555432845
             autocorr =       1.312140002732
   target nu stat err =       0.000555432845
   target dn stat err =       0.004178039694
      target stat err =       0.001683666621
              std dev =       0.685735239196
             le_variance =       0.470232818275

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0566437
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478855900672
                                         uncertainty =       0.006405446870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478855900672
                                         uncertainty =       0.006405446870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489325849
  error estimate for blocks of size 2^( 2) =       0.000510922012
  error estimate for blocks of size 2^( 3) =       0.000531527900
  error estimate for blocks of size 2^( 4) =       0.000547273401
  error estimate for blocks of size 2^( 5) =       0.000557368795
  error estimate for blocks of size 2^( 6) =       0.000564131003
  error estimate for blocks of size 2^( 7) =       0.000567999519

      target function =      -0.597148951994
              le_mean =     -22.819186143435
             les_mean =     521.351730531837
             stat err =       0.000559193180
             autocorr =       1.305952600214
   target nu stat err =       0.000559193180
   target dn stat err =       0.098021599695
      target stat err =       0.032436597861
              std dev =       0.692011252438
             le_variance =       0.478879573500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470156705858
                                         uncertainty =       0.002908310081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470156705858
                                         uncertainty =       0.002908310081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484871714
  error estimate for blocks of size 2^( 2) =       0.000506704008
  error estimate for blocks of size 2^( 3) =       0.000527489466
  error estimate for blocks of size 2^( 4) =       0.000543440599
  error estimate for blocks of size 2^( 5) =       0.000553521099
  error estimate for blocks of size 2^( 6) =       0.000560461492
  error estimate for blocks of size 2^( 7) =       0.000564285378

      target function =      -0.651452155282
              le_mean =     -22.818936625599
             les_mean =     521.194614847489
             stat err =       0.000555427142
             autocorr =       1.312201404946
   target nu stat err =       0.000555427142
   target dn stat err =       0.006262474823
      target stat err =       0.002481154398
              std dev =       0.685712154216
             le_variance =       0.470201158440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.623350178763        initial
     1.4901e-04     1.4901e-03             3.7853e-03        -0.653373683905  <--
     5.9605e-04     5.9605e-03             3.7030e-03        -0.597148951994
     2.3842e-03     2.3842e-02             3.4071e-03        -0.651452155282

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 7.0939e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_01                 1.112800e-01 3 1  ON 0
ci_02                -2.274479e-02 3 1  ON 1
ci_03                -2.418113e-02 3 1  ON 2
ci_04                 2.102033e-02 3 1  ON 3
ci_05                -2.137433e-02 3 1  ON 4
ci_06                -2.026386e-02 3 1  ON 5
ci_07                 2.660484e-02 3 1  ON 6
ci_08                -4.387355e-03 3 1  ON 7
ci_09                -8.127687e-03 3 1  ON 8
ci_10                -8.709463e-03 3 1  ON 9
ci_11                 1.305424e-02 3 1  ON 10
ci_12                 8.400712e-03 3 1  ON 11
ci_13                 1.265148e-02 3 1  ON 12
ci_14                 1.674853e-02 3 1  ON 13
ci_15                 6.264737e-03 3 1  ON 14
ci_16                 5.387647e-03 3 1  ON 15
ci_17                -7.121902e-03 3 1  ON 16
ci_18                -7.162958e-03 3 1  ON 17
ci_19                 1.110869e-02 3 1  ON 18
ci_20                 6.639340e-03 3 1  ON 19
ci_21                 9.313362e-03 3 1  ON 20
ci_22                 8.744848e-03 3 1  ON 21
ci_23                 5.065087e-03 3 1  ON 22
ci_24                 5.127751e-03 3 1  ON 23
ci_25                 3.325963e-03 3 1  ON 24
ci_26                 1.440991e-03 3 1  ON 25
ci_27                 2.119873e-03 3 1  ON 26
ci_28                 2.625162e-03 3 1  ON 27
ci_29                 1.548326e-03 3 1  ON 28
ci_30                -1.384291e-03 3 1  ON 29
ci_31                -2.934527e-04 3 1  ON 30
ci_32                -5.136573e-04 3 1  ON 31
ci_33                -3.694740e-04 3 1  ON 32
ci_34                 1.948425e-03 3 1  ON 33
ci_35                 1.428665e-03 3 1  ON 34
ci_36                -1.118113e-03 3 1  ON 35
ci_37                -1.118198e-03 3 1  ON 36
ci_38                -1.014259e-03 3 1  ON 37
ci_39                -1.020636e-03 3 1  ON 38
ci_40                -2.419854e-03 3 1  ON 39
ci_41                -7.100600e-04 3 1  ON 40
ci_42                 4.420742e-05 3 1  ON 41
ci_43                -3.477335e-03 3 1  ON 42
ci_44                -1.538284e-03 3 1  ON 43
ci_45                -4.390350e-04 3 1  ON 44
ci_46                 9.334733e-04 3 1  ON 45
ci_47                 2.030300e-03 3 1  ON 46
ci_48                 5.214584e-04 3 1  ON 47
ci_49                -4.033750e-04 3 1  ON 48
ci_50                -5.280367e-04 3 1  ON 49
ci_51                -9.188340e-04 3 1  ON 50
ci_52                 5.353441e-04 3 1  ON 51
ci_53                 5.031795e-04 3 1  ON 52
ci_54                -1.573160e-05 3 1  ON 53
ci_55                 3.256503e-05 3 1  ON 54
ci_56                 1.901663e-03 3 1  ON 55
ci_57                 2.798387e-03 3 1  ON 56
ci_58                -1.163700e-03 3 1  ON 57
ci_59                -1.441904e-03 3 1  ON 58
ci_60                 4.956619e-03 3 1  ON 59
ci_61                -2.003334e-03 3 1  ON 60
ci_62                -1.446188e-04 3 1  ON 61
ci_63                -6.653124e-04 3 1  ON 62
ci_64                -6.066644e-04 3 1  ON 63
ci_65                -4.730065e-04 3 1  ON 64
ci_66                -1.054890e-03 3 1  ON 65
ci_67                 1.070221e-04 3 1  ON 66
ci_68                -9.299394e-04 3 1  ON 67
ci_69                -2.674616e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2110e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8329
    reference variance = 0.409239
====================================================
  Execution time = 4.2520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8403e-01
  Total weights = 1.964158959e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470392920350
                                         uncertainty =       0.002443317777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470392920350
                                         uncertainty =       0.002443317777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484942066
  error estimate for blocks of size 2^( 2) =       0.000506570916
  error estimate for blocks of size 2^( 3) =       0.000527608578
  error estimate for blocks of size 2^( 4) =       0.000543731463
  error estimate for blocks of size 2^( 5) =       0.000553689001
  error estimate for blocks of size 2^( 6) =       0.000558584684
  error estimate for blocks of size 2^( 7) =       0.000561296842

      target function =      -0.653999421930
              le_mean =     -22.818506666616
             les_mean =     521.168272806347
             stat err =       0.000554325497
             autocorr =       1.306622085689
   target nu stat err =       0.000554325497
   target dn stat err =       0.003524569143
      target stat err =       0.001433662162
              std dev =       0.685811646133
             le_variance =       0.470337613971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281850666662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654002127463       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654209116516       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654243034600       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654252925430       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654257174834       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654260704024       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654261820864       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654262107739       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654261830350       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654261650013       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654261529747       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654261552206       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654261462125       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 5.112526e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654002127463       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654208607752       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654242404272       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654252245612       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654256463175       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654259961589       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654261065648       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654261347872       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654261071810       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654260893044       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654260774223       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654260796499       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654260707541       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 5.083153e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654002127463       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654206597453       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654239915837       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654249563474       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654253657279       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654257036651       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654258091642       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654258356139       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654258085363       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654257912697       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654257799425       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654257820999       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654257736340       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 4.968951e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0532e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_01                 1.102971e-01 3 1  ON 0
ci_02                -2.261770e-02 3 1  ON 1
ci_03                -2.356350e-02 3 1  ON 2
ci_04                 2.059202e-02 3 1  ON 3
ci_05                -2.182949e-02 3 1  ON 4
ci_06                -2.130121e-02 3 1  ON 5
ci_07                 2.568190e-02 3 1  ON 6
ci_08                -1.695723e-03 3 1  ON 7
ci_09                -8.620574e-03 3 1  ON 8
ci_10                -7.854453e-03 3 1  ON 9
ci_11                 1.259216e-02 3 1  ON 10
ci_12                 7.241921e-03 3 1  ON 11
ci_13                 1.272643e-02 3 1  ON 12
ci_14                 1.356789e-02 3 1  ON 13
ci_15                 5.081589e-03 3 1  ON 14
ci_16                 6.573954e-03 3 1  ON 15
ci_17                -7.597099e-03 3 1  ON 16
ci_18                -5.281288e-03 3 1  ON 17
ci_19                 9.633052e-03 3 1  ON 18
ci_20                 6.285906e-03 3 1  ON 19
ci_21                 6.884544e-03 3 1  ON 20
ci_22                 8.887743e-03 3 1  ON 21
ci_23                 4.427593e-03 3 1  ON 22
ci_24                 4.602341e-03 3 1  ON 23
ci_25                 3.488052e-03 3 1  ON 24
ci_26                 4.293627e-03 3 1  ON 25
ci_27                 2.944370e-03 3 1  ON 26
ci_28                 2.903151e-03 3 1  ON 27
ci_29                 1.743567e-04 3 1  ON 28
ci_30                 1.332221e-04 3 1  ON 29
ci_31                -2.228233e-03 3 1  ON 30
ci_32                -2.312517e-03 3 1  ON 31
ci_33                -1.248887e-03 3 1  ON 32
ci_34                 3.637506e-04 3 1  ON 33
ci_35                 1.100361e-03 3 1  ON 34
ci_36                -6.028034e-04 3 1  ON 35
ci_37                 8.125030e-04 3 1  ON 36
ci_38                -2.021096e-04 3 1  ON 37
ci_39                -5.944304e-04 3 1  ON 38
ci_40                -1.052806e-03 3 1  ON 39
ci_41                -1.176896e-03 3 1  ON 40
ci_42                -9.386419e-04 3 1  ON 41
ci_43                -3.431807e-03 3 1  ON 42
ci_44                -1.345371e-03 3 1  ON 43
ci_45                 6.209459e-05 3 1  ON 44
ci_46                -1.078758e-03 3 1  ON 45
ci_47                 1.549265e-03 3 1  ON 46
ci_48                 1.966973e-03 3 1  ON 47
ci_49                 1.437215e-04 3 1  ON 48
ci_50                -8.601294e-04 3 1  ON 49
ci_51                -2.313854e-04 3 1  ON 50
ci_52                 1.684258e-04 3 1  ON 51
ci_53                -9.262189e-04 3 1  ON 52
ci_54                -6.304138e-04 3 1  ON 53
ci_55                -1.260468e-03 3 1  ON 54
ci_56                 1.679818e-03 3 1  ON 55
ci_57                 2.103911e-03 3 1  ON 56
ci_58                -9.763338e-04 3 1  ON 57
ci_59                -1.366004e-03 3 1  ON 58
ci_60                -1.265343e-04 3 1  ON 59
ci_61                 2.257922e-03 3 1  ON 60
ci_62                -6.640141e-04 3 1  ON 61
ci_63                -3.030715e-04 3 1  ON 62
ci_64                -1.648726e-03 3 1  ON 63
ci_65                -1.667607e-04 3 1  ON 64
ci_66                 2.093493e-04 3 1  ON 65
ci_67                 4.692148e-04 3 1  ON 66
ci_68                -1.103907e-03 3 1  ON 67
ci_69                 5.109815e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.845
    reference variance = 0.25352
====================================================
  Execution time = 4.1692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8360e-01
  Total weights = 1.9643e+06
  Execution time = 5.8886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490750707737
                                         uncertainty =       0.012625809781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490750707737
                                         uncertainty =       0.012625809781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495328582
  error estimate for blocks of size 2^( 2) =       0.000516478975
  error estimate for blocks of size 2^( 3) =       0.000537160036
  error estimate for blocks of size 2^( 4) =       0.000552849765
  error estimate for blocks of size 2^( 5) =       0.000561992430
  error estimate for blocks of size 2^( 6) =       0.000566012266
  error estimate for blocks of size 2^( 7) =       0.000567223271

      target function =      -0.475449780423
              le_mean =     -22.819111409955
             les_mean =     521.760922953111
             stat err =       0.000562019433
             autocorr =       1.287407064814
   target nu stat err =       0.000562019433
   target dn stat err =       0.352473342337
      target stat err =       0.075577006578
              std dev =       0.700500398264
             le_variance =       0.490700807968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470641351378
                                         uncertainty =       0.002572149324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470641351378
                                         uncertainty =       0.002572149324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485096048
  error estimate for blocks of size 2^( 2) =       0.000506739912
  error estimate for blocks of size 2^( 3) =       0.000527845277
  error estimate for blocks of size 2^( 4) =       0.000543647326
  error estimate for blocks of size 2^( 5) =       0.000553235854
  error estimate for blocks of size 2^( 6) =       0.000557530038
  error estimate for blocks of size 2^( 7) =       0.000558816101

      target function =      -0.654218328030
              le_mean =     -22.818703541367
             les_mean =     521.176831558730
             stat err =       0.000553307330
             autocorr =       1.301000230274
   target nu stat err =       0.000553307330
   target dn stat err =       0.002894648927
      target stat err =       0.001193675107
              std dev =       0.686029410331
             le_variance =       0.470636351840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.708693481270
                                         uncertainty =       0.171880307242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.708693481270
                                         uncertainty =       0.171880307242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000595154606
  error estimate for blocks of size 2^( 2) =       0.000612938373
  error estimate for blocks of size 2^( 3) =       0.000630610601
  error estimate for blocks of size 2^( 4) =       0.000643608162
  error estimate for blocks of size 2^( 5) =       0.000652182656
  error estimate for blocks of size 2^( 6) =       0.000654675038
  error estimate for blocks of size 2^( 7) =       0.000655187790

      target function =      -0.090187137506
              le_mean =     -22.818912862124
             les_mean =     528.507491643391
             stat err =       0.000651413411
             autocorr =       1.197991657376
   target nu stat err =       0.000651413411
   target dn stat err =       5.202127715706
      target stat err =       0.052283670577
              std dev =       0.841675715064
             le_variance =       0.708418009329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470633699127
                                         uncertainty =       0.002572133344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470633699127
                                         uncertainty =       0.002572133344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485092100
  error estimate for blocks of size 2^( 2) =       0.000506735334
  error estimate for blocks of size 2^( 3) =       0.000527839897
  error estimate for blocks of size 2^( 4) =       0.000543641367
  error estimate for blocks of size 2^( 5) =       0.000553229251
  error estimate for blocks of size 2^( 6) =       0.000557523135
  error estimate for blocks of size 2^( 7) =       0.000558809093

      target function =      -0.654214968828
              le_mean =     -22.818703588299
             les_mean =     521.176842214837
             stat err =       0.000553300711
             autocorr =       1.300990285624
   target nu stat err =       0.000553300711
   target dn stat err =       0.002895296552
      target stat err =       0.001193908318
              std dev =       0.686023826255
             le_variance =       0.470628690189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.475449780423        initial
     3.7253e-05     3.7253e-04             5.1125e-03        -0.654218328030  <--
     1.4901e-04     1.4901e-03             5.0832e-03        -0.090187137506
     5.9605e-04     5.9605e-03             4.9690e-03        -0.654214968828

*****************************************************************************
Applying the update for shift_i =   3.7253e-05     and shift_s =   3.7253e-04
*****************************************************************************

  Execution time = 7.4157e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_01                 1.102918e-01 3 1  ON 0
ci_02                -2.261743e-02 3 1  ON 1
ci_03                -2.356164e-02 3 1  ON 2
ci_04                 2.059080e-02 3 1  ON 3
ci_05                -2.183093e-02 3 1  ON 4
ci_06                -2.130429e-02 3 1  ON 5
ci_07                 2.567907e-02 3 1  ON 6
ci_08                -1.689349e-03 3 1  ON 7
ci_09                -8.622262e-03 3 1  ON 8
ci_10                -7.851129e-03 3 1  ON 9
ci_11                 1.259104e-02 3 1  ON 10
ci_12                 7.238763e-03 3 1  ON 11
ci_13                 1.272619e-02 3 1  ON 12
ci_14                 1.354977e-02 3 1  ON 13
ci_15                 5.077767e-03 3 1  ON 14
ci_16                 6.577597e-03 3 1  ON 15
ci_17                -7.598591e-03 3 1  ON 16
ci_18                -5.275593e-03 3 1  ON 17
ci_19                 9.629370e-03 3 1  ON 18
ci_20                 6.285386e-03 3 1  ON 19
ci_21                 6.874693e-03 3 1  ON 20
ci_22                 8.889609e-03 3 1  ON 21
ci_23                 4.426069e-03 3 1  ON 22
ci_24                 4.600511e-03 3 1  ON 23
ci_25                 3.488338e-03 3 1  ON 24
ci_26                 4.302351e-03 3 1  ON 25
ci_27                 2.946893e-03 3 1  ON 26
ci_28                 2.904033e-03 3 1  ON 27
ci_29                 1.706035e-04 3 1  ON 28
ci_30                 1.401087e-04 3 1  ON 29
ci_31                -2.236551e-03 3 1  ON 30
ci_32                -2.317106e-03 3 1  ON 31
ci_33                -1.251159e-03 3 1  ON 32
ci_34                 3.588893e-04 3 1  ON 33
ci_35                 1.099123e-03 3 1  ON 34
ci_36                -6.014124e-04 3 1  ON 35
ci_37                 8.174467e-04 3 1  ON 36
ci_38                -2.000575e-04 3 1  ON 37
ci_39                -5.933329e-04 3 1  ON 38
ci_40                -1.049725e-03 3 1  ON 39
ci_41                -1.178171e-03 3 1  ON 40
ci_42                -9.411137e-04 3 1  ON 41
ci_43                -3.431459e-03 3 1  ON 42
ci_44                -1.344897e-03 3 1  ON 43
ci_45                 6.314410e-05 3 1  ON 44
ci_46                -1.084217e-03 3 1  ON 45
ci_47                 1.545984e-03 3 1  ON 46
ci_48                 1.973305e-03 3 1  ON 47
ci_49                 1.449705e-04 3 1  ON 48
ci_50                -8.609345e-04 3 1  ON 49
ci_51                -2.295867e-04 3 1  ON 50
ci_52                 1.673298e-04 3 1  ON 51
ci_53                -9.296492e-04 3 1  ON 52
ci_54                -6.316768e-04 3 1  ON 53
ci_55                -1.263778e-03 3 1  ON 54
ci_56                 1.679278e-03 3 1  ON 55
ci_57                 2.102224e-03 3 1  ON 56
ci_58                -9.753911e-04 3 1  ON 57
ci_59                -1.365842e-03 3 1  ON 58
ci_60                -1.559071e-04 3 1  ON 59
ci_61                 2.279933e-03 3 1  ON 60
ci_62                -6.652032e-04 3 1  ON 61
ci_63                -3.021846e-04 3 1  ON 62
ci_64                -1.651306e-03 3 1  ON 63
ci_65                -1.659767e-04 3 1  ON 64
ci_66                 2.127125e-04 3 1  ON 65
ci_67                 4.701265e-04 3 1  ON 66
ci_68                -1.104337e-03 3 1  ON 67
ci_69                 5.215022e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2470e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8131
    reference variance = 0.316491
====================================================
  Execution time = 4.2553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8511e-01
  Total weights = 1.964631846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469921262376
                                         uncertainty =       0.002550395549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469921262376
                                         uncertainty =       0.002550395549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484691028
  error estimate for blocks of size 2^( 2) =       0.000506403202
  error estimate for blocks of size 2^( 3) =       0.000527620338
  error estimate for blocks of size 2^( 4) =       0.000543077274
  error estimate for blocks of size 2^( 5) =       0.000554451818
  error estimate for blocks of size 2^( 6) =       0.000559719640
  error estimate for blocks of size 2^( 7) =       0.000565145823

      target function =      -0.653647538057
              le_mean =     -22.818811398018
             les_mean =     521.183262319605
             stat err =       0.000555598639
             autocorr =       1.313990979867
   target nu stat err =       0.000555598639
   target dn stat err =       0.003687321034
      target stat err =       0.001495345236
              std dev =       0.685456625980
             le_variance =       0.469850786099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281881139802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653650508420       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653858226927       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653901871875       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653910034292       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653913464278       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653915054427       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653915746999       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653916111842       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653916345340       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653916287643       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653916223346       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653916250990       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 3.617738e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653650508420       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653858094477       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653901698518       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653909849523       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653913273856       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653914861170       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653915552026       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653915915942       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653916148808       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653916091164       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653916027050       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653916054628       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 3.614722e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653650508420       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653857566359       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653901007487       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653909113108       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653912514979       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653914091042       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653914775092       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653915135339       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653915365698       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653915308269       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653915244882       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 3.603643e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0160e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_01                 1.081540e-01 3 1  ON 0
ci_02                -2.623215e-02 3 1  ON 1
ci_03                -2.414829e-02 3 1  ON 2
ci_04                 2.184070e-02 3 1  ON 3
ci_05                -1.887974e-02 3 1  ON 4
ci_06                -1.836283e-02 3 1  ON 5
ci_07                 2.719917e-02 3 1  ON 6
ci_08                -3.897666e-03 3 1  ON 7
ci_09                -6.480315e-03 3 1  ON 8
ci_10                -7.680181e-03 3 1  ON 9
ci_11                 1.424198e-02 3 1  ON 10
ci_12                 7.259658e-03 3 1  ON 11
ci_13                 1.435322e-02 3 1  ON 12
ci_14                 1.514475e-02 3 1  ON 13
ci_15                 7.191668e-03 3 1  ON 14
ci_16                 5.489567e-03 3 1  ON 15
ci_17                -7.637116e-03 3 1  ON 16
ci_18                -5.700950e-03 3 1  ON 17
ci_19                 8.415513e-03 3 1  ON 18
ci_20                 5.145528e-03 3 1  ON 19
ci_21                 8.164455e-03 3 1  ON 20
ci_22                 1.196143e-02 3 1  ON 21
ci_23                 4.590297e-03 3 1  ON 22
ci_24                 6.178023e-03 3 1  ON 23
ci_25                 2.862624e-03 3 1  ON 24
ci_26                 2.383317e-03 3 1  ON 25
ci_27                 3.551140e-03 3 1  ON 26
ci_28                 2.090376e-03 3 1  ON 27
ci_29                 8.754099e-04 3 1  ON 28
ci_30                 3.377634e-04 3 1  ON 29
ci_31                 1.160444e-04 3 1  ON 30
ci_32                -1.870480e-03 3 1  ON 31
ci_33                -4.998290e-04 3 1  ON 32
ci_34                 8.010624e-04 3 1  ON 33
ci_35                 1.123422e-03 3 1  ON 34
ci_36                -8.426146e-04 3 1  ON 35
ci_37                 4.320417e-04 3 1  ON 36
ci_38                 4.164485e-04 3 1  ON 37
ci_39                 2.493308e-04 3 1  ON 38
ci_40                -1.028949e-03 3 1  ON 39
ci_41                -8.825010e-04 3 1  ON 40
ci_42                -1.509324e-04 3 1  ON 41
ci_43                -2.405032e-03 3 1  ON 42
ci_44                -1.781718e-04 3 1  ON 43
ci_45                -5.732901e-04 3 1  ON 44
ci_46                -1.253851e-04 3 1  ON 45
ci_47                 9.988070e-04 3 1  ON 46
ci_48                 2.250649e-03 3 1  ON 47
ci_49                -1.001599e-03 3 1  ON 48
ci_50                -1.350116e-04 3 1  ON 49
ci_51                 1.780958e-04 3 1  ON 50
ci_52                -1.386138e-04 3 1  ON 51
ci_53                -3.964227e-04 3 1  ON 52
ci_54                -4.298423e-04 3 1  ON 53
ci_55                -2.351428e-03 3 1  ON 54
ci_56                 1.574526e-03 3 1  ON 55
ci_57                 3.252054e-03 3 1  ON 56
ci_58                 4.638609e-04 3 1  ON 57
ci_59                -2.558519e-03 3 1  ON 58
ci_60                -5.558534e-04 3 1  ON 59
ci_61                -1.129833e-05 3 1  ON 60
ci_62                -3.611832e-04 3 1  ON 61
ci_63                 1.928555e-04 3 1  ON 62
ci_64                 4.084002e-04 3 1  ON 63
ci_65                -3.067180e-04 3 1  ON 64
ci_66                 1.687558e-03 3 1  ON 65
ci_67                -6.071588e-04 3 1  ON 66
ci_68                -1.304534e-03 3 1  ON 67
ci_69                -6.897189e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7181
    reference variance = 0.274799
====================================================
  Execution time = 4.1386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8345e-01
  Total weights = 1.9643e+06
  Execution time = 5.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473512623906
                                         uncertainty =       0.003237780922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473512623906
                                         uncertainty =       0.003237780922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486554136
  error estimate for blocks of size 2^( 2) =       0.000508098180
  error estimate for blocks of size 2^( 3) =       0.000529356217
  error estimate for blocks of size 2^( 4) =       0.000545814228
  error estimate for blocks of size 2^( 5) =       0.000555765686
  error estimate for blocks of size 2^( 6) =       0.000560961148
  error estimate for blocks of size 2^( 7) =       0.000562911453

      target function =      -0.579933890395
              le_mean =     -22.819457629067
             les_mean =     521.418552588409
             stat err =       0.000556363129
             autocorr =       1.307538075894
   target nu stat err =       0.000556363129
   target dn stat err =       0.093887490230
      target stat err =       0.029298903634
              std dev =       0.688091457817
             le_variance =       0.473469854320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469792321337
                                         uncertainty =       0.002483951373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469792321337
                                         uncertainty =       0.002483951373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484645074
  error estimate for blocks of size 2^( 2) =       0.000506232870
  error estimate for blocks of size 2^( 3) =       0.000527541631
  error estimate for blocks of size 2^( 4) =       0.000544043901
  error estimate for blocks of size 2^( 5) =       0.000554018497
  error estimate for blocks of size 2^( 6) =       0.000559162389
  error estimate for blocks of size 2^( 7) =       0.000560978209

      target function =      -0.654419388431
              le_mean =     -22.819264596109
             les_mean =     521.202284822128
             stat err =       0.000554550749
             autocorr =       1.309287396655
   target nu stat err =       0.000554550749
   target dn stat err =       0.002884087099
      target stat err =       0.001191195248
              std dev =       0.685391636356
             le_variance =       0.469761695187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472461818753
                                         uncertainty =       0.002560579764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472461818753
                                         uncertainty =       0.002560579764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486021318
  error estimate for blocks of size 2^( 2) =       0.000507569257
  error estimate for blocks of size 2^( 3) =       0.000528859286
  error estimate for blocks of size 2^( 4) =       0.000545314212
  error estimate for blocks of size 2^( 5) =       0.000555270505
  error estimate for blocks of size 2^( 6) =       0.000560300804
  error estimate for blocks of size 2^( 7) =       0.000562181787

      target function =      -0.571224165126
              le_mean =     -22.819463103140
             les_mean =     521.432527947020
             stat err =       0.000555766827
             autocorr =       1.307599073331
   target nu stat err =       0.000555766827
   target dn stat err =       0.190789568370
      target stat err =       0.058212524315
              std dev =       0.687337939182
             le_variance =       0.472433442638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469790593304
                                         uncertainty =       0.002483956156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469790593304
                                         uncertainty =       0.002483956156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484644174
  error estimate for blocks of size 2^( 2) =       0.000506231880
  error estimate for blocks of size 2^( 3) =       0.000527540489
  error estimate for blocks of size 2^( 4) =       0.000544042654
  error estimate for blocks of size 2^( 5) =       0.000554017237
  error estimate for blocks of size 2^( 6) =       0.000559161591
  error estimate for blocks of size 2^( 7) =       0.000560977581

      target function =      -0.654379764374
              le_mean =     -22.819264617154
             les_mean =     521.202385775196
             stat err =       0.000554549766
             autocorr =       1.309287611412
   target nu stat err =       0.000554549766
   target dn stat err =       0.002889592472
      target stat err =       0.001193149647
              std dev =       0.685390364443
             le_variance =       0.469759951672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.579933890395        initial
     9.3132e-06     9.3132e-05             3.6177e-03        -0.654419388431  <--
     3.7253e-05     3.7253e-04             3.6147e-03        -0.571224165126
     1.4901e-04     1.4901e-03             3.6036e-03        -0.654379764374

*****************************************************************************
Applying the update for shift_i =   9.3132e-06     and shift_s =   9.3132e-05
*****************************************************************************

  Execution time = 7.0962e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_01                 1.081515e-01 3 1  ON 0
ci_02                -2.623517e-02 3 1  ON 1
ci_03                -2.414895e-02 3 1  ON 2
ci_04                 2.184152e-02 3 1  ON 3
ci_05                -1.887731e-02 3 1  ON 4
ci_06                -1.836048e-02 3 1  ON 5
ci_07                 2.720048e-02 3 1  ON 6
ci_08                -3.898991e-03 3 1  ON 7
ci_09                -6.478418e-03 3 1  ON 8
ci_10                -7.680003e-03 3 1  ON 9
ci_11                 1.424347e-02 3 1  ON 10
ci_12                 7.259748e-03 3 1  ON 11
ci_13                 1.435547e-02 3 1  ON 12
ci_14                 1.514692e-02 3 1  ON 13
ci_15                 7.193335e-03 3 1  ON 14
ci_16                 5.488751e-03 3 1  ON 15
ci_17                -7.637065e-03 3 1  ON 16
ci_18                -5.701197e-03 3 1  ON 17
ci_19                 8.414758e-03 3 1  ON 18
ci_20                 5.144816e-03 3 1  ON 19
ci_21                 8.165716e-03 3 1  ON 20
ci_22                 1.196439e-02 3 1  ON 21
ci_23                 4.590453e-03 3 1  ON 22
ci_24                 6.179459e-03 3 1  ON 23
ci_25                 2.862214e-03 3 1  ON 24
ci_26                 2.381963e-03 3 1  ON 25
ci_27                 3.551582e-03 3 1  ON 26
ci_28                 2.089670e-03 3 1  ON 27
ci_29                 8.758974e-04 3 1  ON 28
ci_30                 3.382321e-04 3 1  ON 29
ci_31                 1.183941e-04 3 1  ON 30
ci_32                -1.870165e-03 3 1  ON 31
ci_33                -4.993819e-04 3 1  ON 32
ci_34                 8.013719e-04 3 1  ON 33
ci_35                 1.123311e-03 3 1  ON 34
ci_36                -8.428224e-04 3 1  ON 35
ci_37                 4.317926e-04 3 1  ON 36
ci_38                 4.168053e-04 3 1  ON 37
ci_39                 2.498725e-04 3 1  ON 38
ci_40                -1.028904e-03 3 1  ON 39
ci_41                -8.822553e-04 3 1  ON 40
ci_42                -1.504392e-04 3 1  ON 41
ci_43                -2.404201e-03 3 1  ON 42
ci_44                -1.772284e-04 3 1  ON 43
ci_45                -5.736451e-04 3 1  ON 44
ci_46                -1.247594e-04 3 1  ON 45
ci_47                 9.984498e-04 3 1  ON 46
ci_48                 2.251083e-03 3 1  ON 47
ci_49                -1.002342e-03 3 1  ON 48
ci_50                -1.346052e-04 3 1  ON 49
ci_51                 1.783549e-04 3 1  ON 50
ci_52                -1.388028e-04 3 1  ON 51
ci_53                -3.961000e-04 3 1  ON 52
ci_54                -4.298125e-04 3 1  ON 53
ci_55                -2.352216e-03 3 1  ON 54
ci_56                 1.574547e-03 3 1  ON 55
ci_57                 3.252794e-03 3 1  ON 56
ci_58                 4.647683e-04 3 1  ON 57
ci_59                -2.559260e-03 3 1  ON 58
ci_60                -5.563231e-04 3 1  ON 59
ci_61                -1.427537e-05 3 1  ON 60
ci_62                -3.609640e-04 3 1  ON 61
ci_63                 1.931741e-04 3 1  ON 62
ci_64                 4.097457e-04 3 1  ON 63
ci_65                -3.067904e-04 3 1  ON 64
ci_66                 1.688523e-03 3 1  ON 65
ci_67                -6.079393e-04 3 1  ON 66
ci_68                -1.304647e-03 3 1  ON 67
ci_69                -6.902814e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2114e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.784
    reference variance = 0.446219
====================================================
  Execution time = 4.2576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8065e-01
  Total weights = 1.964393882e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465495948646
                                         uncertainty =       0.002341578778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465495948646
                                         uncertainty =       0.002341578778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482462320
  error estimate for blocks of size 2^( 2) =       0.000504371764
  error estimate for blocks of size 2^( 3) =       0.000525688371
  error estimate for blocks of size 2^( 4) =       0.000542475314
  error estimate for blocks of size 2^( 5) =       0.000553374909
  error estimate for blocks of size 2^( 6) =       0.000558483023
  error estimate for blocks of size 2^( 7) =       0.000558156268

      target function =      -0.655193547789
              le_mean =     -22.817935790207
             les_mean =     521.138844343815
             stat err =       0.000553122378
             autocorr =       1.314364005664
   target nu stat err =       0.000553122378
   target dn stat err =       0.002997143296
      target stat err =       0.001235304060
              std dev =       0.682304756348
             le_variance =       0.465539780535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281793579021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655195465158       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655392527065       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655431619744       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655439299407       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655442634233       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655444351674       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655444751676       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655445299063       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655445329961       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655445316548       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655445400654       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655445456100       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 4.049510e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655195465158       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655392495843       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655431579796       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655439256999       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655442590473       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655444307066       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655444706760       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655445253845       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655445284690       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655445271275       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655445355324       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655445410722       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 4.048212e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655195465158       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655392371052       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655431420140       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655439087515       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655442415592       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655444128796       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655444527262       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655445073142       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655445103774       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655445090350       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655445174178       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655445229383       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 4.043026e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0187e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_01                 1.121997e-01 3 1  ON 0
ci_02                -2.286460e-02 3 1  ON 1
ci_03                -2.402528e-02 3 1  ON 2
ci_04                 2.159358e-02 3 1  ON 3
ci_05                -1.951848e-02 3 1  ON 4
ci_06                -2.003349e-02 3 1  ON 5
ci_07                 2.471181e-02 3 1  ON 6
ci_08                -4.054995e-03 3 1  ON 7
ci_09                -5.912750e-03 3 1  ON 8
ci_10                -8.518350e-03 3 1  ON 9
ci_11                 1.268970e-02 3 1  ON 10
ci_12                 7.674993e-03 3 1  ON 11
ci_13                 1.430150e-02 3 1  ON 12
ci_14                 1.747521e-02 3 1  ON 13
ci_15                 6.727418e-03 3 1  ON 14
ci_16                 4.482012e-03 3 1  ON 15
ci_17                -6.514678e-03 3 1  ON 16
ci_18                -6.216694e-03 3 1  ON 17
ci_19                 8.854181e-03 3 1  ON 18
ci_20                 6.324117e-03 3 1  ON 19
ci_21                 7.503113e-03 3 1  ON 20
ci_22                 9.965033e-03 3 1  ON 21
ci_23                 4.879083e-03 3 1  ON 22
ci_24                 6.729478e-03 3 1  ON 23
ci_25                 3.873804e-03 3 1  ON 24
ci_26                 4.795820e-03 3 1  ON 25
ci_27                 3.961762e-03 3 1  ON 26
ci_28                 1.710848e-03 3 1  ON 27
ci_29                 1.905140e-03 3 1  ON 28
ci_30                 9.067367e-05 3 1  ON 29
ci_31                 8.872321e-05 3 1  ON 30
ci_32                -3.379783e-04 3 1  ON 31
ci_33                -9.460643e-04 3 1  ON 32
ci_34                 1.162942e-03 3 1  ON 33
ci_35                -1.612541e-04 3 1  ON 34
ci_36                -8.977405e-04 3 1  ON 35
ci_37                -1.105708e-03 3 1  ON 36
ci_38                -2.379135e-04 3 1  ON 37
ci_39                -9.935495e-04 3 1  ON 38
ci_40                -1.399139e-03 3 1  ON 39
ci_41                -2.019267e-04 3 1  ON 40
ci_42                -4.468966e-04 3 1  ON 41
ci_43                -1.356484e-03 3 1  ON 42
ci_44                -1.571444e-03 3 1  ON 43
ci_45                -1.400688e-03 3 1  ON 44
ci_46                -3.251549e-04 3 1  ON 45
ci_47                 3.337085e-03 3 1  ON 46
ci_48                 1.858396e-03 3 1  ON 47
ci_49                -1.377216e-03 3 1  ON 48
ci_50                -9.236491e-04 3 1  ON 49
ci_51                 5.448168e-05 3 1  ON 50
ci_52                -2.004705e-04 3 1  ON 51
ci_53                 1.335571e-04 3 1  ON 52
ci_54                -4.857286e-04 3 1  ON 53
ci_55                -5.983017e-04 3 1  ON 54
ci_56                 3.087904e-03 3 1  ON 55
ci_57                 9.571819e-04 3 1  ON 56
ci_58                -1.541959e-03 3 1  ON 57
ci_59                 7.722127e-05 3 1  ON 58
ci_60                -1.346963e-03 3 1  ON 59
ci_61                -2.896914e-04 3 1  ON 60
ci_62                -3.594057e-04 3 1  ON 61
ci_63                -1.244572e-03 3 1  ON 62
ci_64                -5.543503e-04 3 1  ON 63
ci_65                 1.082635e-03 3 1  ON 64
ci_66                -6.543219e-04 3 1  ON 65
ci_67                -2.193222e-04 3 1  ON 66
ci_68                -1.564507e-03 3 1  ON 67
ci_69                -1.440626e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.769
    reference variance = 1.23226
====================================================
  Execution time = 4.1270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8596e-01
  Total weights = 1.9641e+06
  Execution time = 5.8987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000194095
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543369173682
                                         uncertainty =       0.046741483320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543369173682
                                         uncertainty =       0.046741483320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521158299
  error estimate for blocks of size 2^( 2) =       0.000541723702
  error estimate for blocks of size 2^( 3) =       0.000561055398
  error estimate for blocks of size 2^( 4) =       0.000576078251
  error estimate for blocks of size 2^( 5) =       0.000585597484
  error estimate for blocks of size 2^( 6) =       0.000591220475
  error estimate for blocks of size 2^( 7) =       0.000594677072

      target function =      -0.057072871832
              le_mean =     -22.818606202091
             les_mean =     530.943731224277
             stat err =       0.000586893321
             autocorr =       1.268174506449
   target nu stat err =       0.000586893321
   target dn stat err =       9.275591793594
      target stat err =       0.046338265118
              std dev =       0.737029134068
             le_variance =       0.543211944465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469307710195
                                         uncertainty =       0.002187228992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469307710195
                                         uncertainty =       0.002187228992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484403485
  error estimate for blocks of size 2^( 2) =       0.000506420302
  error estimate for blocks of size 2^( 3) =       0.000526965344
  error estimate for blocks of size 2^( 4) =       0.000542838196
  error estimate for blocks of size 2^( 5) =       0.000552765098
  error estimate for blocks of size 2^( 6) =       0.000558963985
  error estimate for blocks of size 2^( 7) =       0.000562417577

      target function =      -0.653186468167
              le_mean =     -22.818310546081
             les_mean =     521.161255965080
             stat err =       0.000554246214
             autocorr =       1.309154645905
   target nu stat err =       0.000554246214
   target dn stat err =       0.003670609567
      target stat err =       0.001485991868
              std dev =       0.685049978770
             le_variance =       0.469293473413

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000194735
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484789212631
                                         uncertainty =       0.006998944250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484789212631
                                         uncertainty =       0.006998944250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492313909
  error estimate for blocks of size 2^( 2) =       0.000514074705
  error estimate for blocks of size 2^( 3) =       0.000534386227
  error estimate for blocks of size 2^( 4) =       0.000550108937
  error estimate for blocks of size 2^( 5) =       0.000559821984
  error estimate for blocks of size 2^( 6) =       0.000566017061
  error estimate for blocks of size 2^( 7) =       0.000569592518

      target function =      -0.429403883846
              le_mean =     -22.818439159345
             les_mean =     521.899357885712
             stat err =       0.000561385125
             autocorr =       1.300282117044
   target nu stat err =       0.000561385125
   target dn stat err =       0.559130845427
      target stat err =       0.100543114765
              std dev =       0.696237007516
             le_variance =       0.484745970635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469307895352
                                         uncertainty =       0.002187380849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469307895352
                                         uncertainty =       0.002187380849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484403586
  error estimate for blocks of size 2^( 2) =       0.000506420410
  error estimate for blocks of size 2^( 3) =       0.000526965485
  error estimate for blocks of size 2^( 4) =       0.000542838349
  error estimate for blocks of size 2^( 5) =       0.000552765320
  error estimate for blocks of size 2^( 6) =       0.000558964147
  error estimate for blocks of size 2^( 7) =       0.000562417709

      target function =      -0.653186174982
              le_mean =     -22.818310566013
             les_mean =     521.161257632267
             stat err =       0.000554246381
             autocorr =       1.309154895020
   target nu stat err =       0.000554246381
   target dn stat err =       0.003670222724
      target stat err =       0.001485841954
              std dev =       0.685050120641
             le_variance =       0.469293667791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.057072871832        initial
            N/A            N/A                    N/A                    N/A     bad update
     9.3132e-06     9.3132e-05             4.0482e-03        -0.429403883846  <--
            N/A            N/A                    N/A                    N/A     bad update

*****************************************************************************
Applying the update for shift_i =   9.3132e-06     and shift_s =   9.3132e-05
*****************************************************************************

  Execution time = 7.1903e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_01                 1.121997e-01 3 1  ON 0
ci_02                -2.286460e-02 3 1  ON 1
ci_03                -2.402528e-02 3 1  ON 2
ci_04                 2.159358e-02 3 1  ON 3
ci_05                -1.951848e-02 3 1  ON 4
ci_06                -2.003349e-02 3 1  ON 5
ci_07                 2.471181e-02 3 1  ON 6
ci_08                -4.054995e-03 3 1  ON 7
ci_09                -5.912750e-03 3 1  ON 8
ci_10                -8.518350e-03 3 1  ON 9
ci_11                 1.268970e-02 3 1  ON 10
ci_12                 7.674993e-03 3 1  ON 11
ci_13                 1.430150e-02 3 1  ON 12
ci_14                 1.747521e-02 3 1  ON 13
ci_15                 6.727418e-03 3 1  ON 14
ci_16                 4.482012e-03 3 1  ON 15
ci_17                -6.514678e-03 3 1  ON 16
ci_18                -6.216694e-03 3 1  ON 17
ci_19                 8.854181e-03 3 1  ON 18
ci_20                 6.324117e-03 3 1  ON 19
ci_21                 7.503113e-03 3 1  ON 20
ci_22                 9.965033e-03 3 1  ON 21
ci_23                 4.879083e-03 3 1  ON 22
ci_24                 6.729478e-03 3 1  ON 23
ci_25                 3.873804e-03 3 1  ON 24
ci_26                 4.795820e-03 3 1  ON 25
ci_27                 3.961762e-03 3 1  ON 26
ci_28                 1.710848e-03 3 1  ON 27
ci_29                 1.905140e-03 3 1  ON 28
ci_30                 9.067367e-05 3 1  ON 29
ci_31                 8.872321e-05 3 1  ON 30
ci_32                -3.379783e-04 3 1  ON 31
ci_33                -9.460643e-04 3 1  ON 32
ci_34                 1.162942e-03 3 1  ON 33
ci_35                -1.612541e-04 3 1  ON 34
ci_36                -8.977405e-04 3 1  ON 35
ci_37                -1.105708e-03 3 1  ON 36
ci_38                -2.379135e-04 3 1  ON 37
ci_39                -9.935495e-04 3 1  ON 38
ci_40                -1.399139e-03 3 1  ON 39
ci_41                -2.019267e-04 3 1  ON 40
ci_42                -4.468966e-04 3 1  ON 41
ci_43                -1.356484e-03 3 1  ON 42
ci_44                -1.571444e-03 3 1  ON 43
ci_45                -1.400688e-03 3 1  ON 44
ci_46                -3.251549e-04 3 1  ON 45
ci_47                 3.337085e-03 3 1  ON 46
ci_48                 1.858396e-03 3 1  ON 47
ci_49                -1.377216e-03 3 1  ON 48
ci_50                -9.236491e-04 3 1  ON 49
ci_51                 5.448168e-05 3 1  ON 50
ci_52                -2.004705e-04 3 1  ON 51
ci_53                 1.335571e-04 3 1  ON 52
ci_54                -4.857286e-04 3 1  ON 53
ci_55                -5.983017e-04 3 1  ON 54
ci_56                 3.087904e-03 3 1  ON 55
ci_57                 9.571819e-04 3 1  ON 56
ci_58                -1.541959e-03 3 1  ON 57
ci_59                 7.722127e-05 3 1  ON 58
ci_60                -1.346963e-03 3 1  ON 59
ci_61                -2.896914e-04 3 1  ON 60
ci_62                -3.594057e-04 3 1  ON 61
ci_63                -1.244572e-03 3 1  ON 62
ci_64                -5.543503e-04 3 1  ON 63
ci_65                 1.082635e-03 3 1  ON 64
ci_66                -6.543219e-04 3 1  ON 65
ci_67                -2.193222e-04 3 1  ON 66
ci_68                -1.564507e-03 3 1  ON 67
ci_69                -1.440626e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8537
    reference variance = 0.370403
====================================================
  Execution time = 4.3926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8327e-01
  Total weights = 1.964347756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470244966890
                                         uncertainty =       0.002243811496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470244966890
                                         uncertainty =       0.002243811496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484892858
  error estimate for blocks of size 2^( 2) =       0.000507081519
  error estimate for blocks of size 2^( 3) =       0.000528606872
  error estimate for blocks of size 2^( 4) =       0.000545477765
  error estimate for blocks of size 2^( 5) =       0.000556098144
  error estimate for blocks of size 2^( 6) =       0.000560583212
  error estimate for blocks of size 2^( 7) =       0.000566316003

      target function =      -0.654203624618
              le_mean =     -22.818126445220
             les_mean =     521.150165776700
             stat err =       0.000557118781
             autocorr =       1.320091465976
   target nu stat err =       0.000557118781
   target dn stat err =       0.002861744960
      target stat err =       0.001181153475
              std dev =       0.685742056350
             le_variance =       0.470242167848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281812644522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654205330798       residual = 9.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654336435326       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654368186118       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654385083507       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654388014584       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654389688400       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654389216167       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654389461913       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654389660002       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654389645375       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654389723448       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 3.932608e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654205330798       residual = 9.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654336414224       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654368157621       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654385049191       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654387978698       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654389651399       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654389179149       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654389424752       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654389622707       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654389608086       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654389686101       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 3.931336e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654205330798       residual = 9.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654336329885       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654368043732       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654384912065       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654387835299       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654389503550       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654389031238       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654389276270       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654389473687       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654389459090       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654389536876       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 3.926258e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1540e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_01                 1.094613e-01 3 1  ON 0
ci_02                -2.331458e-02 3 1  ON 1
ci_03                -2.342981e-02 3 1  ON 2
ci_04                 2.162612e-02 3 1  ON 3
ci_05                -1.988906e-02 3 1  ON 4
ci_06                -1.945209e-02 3 1  ON 5
ci_07                 2.622487e-02 3 1  ON 6
ci_08                -3.866569e-03 3 1  ON 7
ci_09                -6.165334e-03 3 1  ON 8
ci_10                -7.736874e-03 3 1  ON 9
ci_11                 1.303646e-02 3 1  ON 10
ci_12                 6.770925e-03 3 1  ON 11
ci_13                 1.056975e-02 3 1  ON 12
ci_14                 1.495384e-02 3 1  ON 13
ci_15                 7.249958e-03 3 1  ON 14
ci_16                 6.326014e-03 3 1  ON 15
ci_17                -7.102131e-03 3 1  ON 16
ci_18                -6.497683e-03 3 1  ON 17
ci_19                 9.806204e-03 3 1  ON 18
ci_20                 5.954213e-03 3 1  ON 19
ci_21                 7.416557e-03 3 1  ON 20
ci_22                 8.791890e-03 3 1  ON 21
ci_23                 4.180374e-03 3 1  ON 22
ci_24                 5.357201e-03 3 1  ON 23
ci_25                 2.398544e-03 3 1  ON 24
ci_26                 3.362328e-03 3 1  ON 25
ci_27                 2.809420e-03 3 1  ON 26
ci_28                 2.189568e-03 3 1  ON 27
ci_29                 1.192934e-03 3 1  ON 28
ci_30                 7.935552e-05 3 1  ON 29
ci_31                -2.606529e-03 3 1  ON 30
ci_32                -4.914786e-04 3 1  ON 31
ci_33                -1.587400e-03 3 1  ON 32
ci_34                 1.034570e-03 3 1  ON 33
ci_35                 9.106613e-04 3 1  ON 34
ci_36                -6.882233e-04 3 1  ON 35
ci_37                -4.050085e-04 3 1  ON 36
ci_38                 1.107104e-04 3 1  ON 37
ci_39                -5.753998e-04 3 1  ON 38
ci_40                -1.385720e-03 3 1  ON 39
ci_41                -2.037516e-03 3 1  ON 40
ci_42                -9.892422e-04 3 1  ON 41
ci_43                -1.099076e-03 3 1  ON 42
ci_44                -6.408579e-04 3 1  ON 43
ci_45                -6.234402e-04 3 1  ON 44
ci_46                -2.604132e-05 3 1  ON 45
ci_47                 1.022694e-04 3 1  ON 46
ci_48                 1.740699e-03 3 1  ON 47
ci_49                -7.994510e-04 3 1  ON 48
ci_50                -8.273043e-04 3 1  ON 49
ci_51                 2.336062e-04 3 1  ON 50
ci_52                 1.124909e-04 3 1  ON 51
ci_53                -1.068655e-03 3 1  ON 52
ci_54                -1.282234e-03 3 1  ON 53
ci_55                 7.091616e-05 3 1  ON 54
ci_56                 1.291235e-03 3 1  ON 55
ci_57                 1.713079e-03 3 1  ON 56
ci_58                -7.441174e-04 3 1  ON 57
ci_59                -5.733137e-04 3 1  ON 58
ci_60                -3.834310e-04 3 1  ON 59
ci_61                 3.641645e-03 3 1  ON 60
ci_62                 2.307472e-04 3 1  ON 61
ci_63                -3.624220e-04 3 1  ON 62
ci_64                -2.845835e-04 3 1  ON 63
ci_65                -4.966791e-04 3 1  ON 64
ci_66                -1.362470e-03 3 1  ON 65
ci_67                -9.474957e-04 3 1  ON 66
ci_68                -2.780799e-04 3 1  ON 67
ci_69                -1.156110e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.9106
    reference variance = 1.00437
====================================================
  Execution time = 4.1280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8814e-01
  Total weights = 1.9640e+06
  Execution time = 5.9160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00152982
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473387210053
                                         uncertainty =       0.002965883991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473387210053
                                         uncertainty =       0.002965883991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486491954
  error estimate for blocks of size 2^( 2) =       0.000507949817
  error estimate for blocks of size 2^( 3) =       0.000528607515
  error estimate for blocks of size 2^( 4) =       0.000545165453
  error estimate for blocks of size 2^( 5) =       0.000555702312
  error estimate for blocks of size 2^( 6) =       0.000562180176
  error estimate for blocks of size 2^( 7) =       0.000564266571

      target function =      -0.590218824566
              le_mean =     -22.819335921171
             les_mean =     521.379044528709
             stat err =       0.000556828628
             autocorr =       1.310061810233
   target nu stat err =       0.000556828628
   target dn stat err =       0.106145856591
      target stat err =       0.034333718686
              std dev =       0.688003519792
             le_variance =       0.473348843246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350760376
                                         uncertainty =       0.002481929102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350760376
                                         uncertainty =       0.002481929102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484922615
  error estimate for blocks of size 2^( 2) =       0.000506449031
  error estimate for blocks of size 2^( 3) =       0.000527190769
  error estimate for blocks of size 2^( 4) =       0.000543776334
  error estimate for blocks of size 2^( 5) =       0.000554480284
  error estimate for blocks of size 2^( 6) =       0.000561041425
  error estimate for blocks of size 2^( 7) =       0.000563164438

      target function =      -0.652548256446
              le_mean =     -22.819190844875
             les_mean =     521.203605150975
             stat err =       0.000555615620
             autocorr =       1.312816472460
   target nu stat err =       0.000555615620
   target dn stat err =       0.003600297548
      target stat err =       0.001457585578
              std dev =       0.685784138234
             le_variance =       0.470299884253

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00154026
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491007162683
                                         uncertainty =       0.010530390848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491007162683
                                         uncertainty =       0.010530390848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495471175
  error estimate for blocks of size 2^( 2) =       0.000516674128
  error estimate for blocks of size 2^( 3) =       0.000537003341
  error estimate for blocks of size 2^( 4) =       0.000553386945
  error estimate for blocks of size 2^( 5) =       0.000564116996
  error estimate for blocks of size 2^( 6) =       0.000570738649
  error estimate for blocks of size 2^( 7) =       0.000573300350

      target function =      -0.399931587827
              le_mean =     -22.819236504893
             les_mean =     522.116596771138
             stat err =       0.000565385735
             autocorr =       1.302125686626
   target nu stat err =       0.000565385735
   target dn stat err =       0.589619745745
      target stat err =       0.091858097691
              std dev =       0.700702055500
             le_variance =       0.490983370582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350221999
                                         uncertainty =       0.002481805211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350221999
                                         uncertainty =       0.002481805211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484922346
  error estimate for blocks of size 2^( 2) =       0.000506448722
  error estimate for blocks of size 2^( 3) =       0.000527190426
  error estimate for blocks of size 2^( 4) =       0.000543776010
  error estimate for blocks of size 2^( 5) =       0.000554479904
  error estimate for blocks of size 2^( 6) =       0.000561041023
  error estimate for blocks of size 2^( 7) =       0.000563163871

      target function =      -0.652544244602
              le_mean =     -22.819190850375
             les_mean =     521.203615587791
             stat err =       0.000555615202
             autocorr =       1.312815951391
   target nu stat err =       0.000555615202
   target dn stat err =       0.003600433053
      target stat err =       0.001457620034
              std dev =       0.685783758010
             le_variance =       0.470299362750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.590218824566        initial
     2.3283e-06     2.3283e-05             3.9326e-03        -0.652548256446  <--
     9.3132e-06     9.3132e-05             3.9313e-03        -0.399931587827
     3.7253e-05     3.7253e-04             3.9263e-03        -0.652544244602

*****************************************************************************
Applying the update for shift_i =   2.3283e-06     and shift_s =   2.3283e-05
*****************************************************************************

  Execution time = 7.0940e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_01                 1.094605e-01 3 1  ON 0
ci_02                -2.331466e-02 3 1  ON 1
ci_03                -2.342970e-02 3 1  ON 2
ci_04                 2.162613e-02 3 1  ON 3
ci_05                -1.988915e-02 3 1  ON 4
ci_06                -1.945198e-02 3 1  ON 5
ci_07                 2.622527e-02 3 1  ON 6
ci_08                -3.866527e-03 3 1  ON 7
ci_09                -6.165379e-03 3 1  ON 8
ci_10                -7.736708e-03 3 1  ON 9
ci_11                 1.303648e-02 3 1  ON 10
ci_12                 6.770777e-03 3 1  ON 11
ci_13                 1.056870e-02 3 1  ON 12
ci_14                 1.495307e-02 3 1  ON 13
ci_15                 7.250056e-03 3 1  ON 14
ci_16                 6.326383e-03 3 1  ON 15
ci_17                -7.102256e-03 3 1  ON 16
ci_18                -6.497744e-03 3 1  ON 17
ci_19                 9.806353e-03 3 1  ON 18
ci_20                 5.954151e-03 3 1  ON 19
ci_21                 7.416427e-03 3 1  ON 20
ci_22                 8.791604e-03 3 1  ON 21
ci_23                 4.180259e-03 3 1  ON 22
ci_24                 5.356880e-03 3 1  ON 23
ci_25                 2.398311e-03 3 1  ON 24
ci_26                 3.362050e-03 3 1  ON 25
ci_27                 2.809202e-03 3 1  ON 26
ci_28                 2.189655e-03 3 1  ON 27
ci_29                 1.192812e-03 3 1  ON 28
ci_30                 7.922638e-05 3 1  ON 29
ci_31                -2.607341e-03 3 1  ON 30
ci_32                -4.914889e-04 3 1  ON 31
ci_33                -1.587498e-03 3 1  ON 32
ci_34                 1.034543e-03 3 1  ON 33
ci_35                 9.108596e-04 3 1  ON 34
ci_36                -6.881981e-04 3 1  ON 35
ci_37                -4.049061e-04 3 1  ON 36
ci_38                 1.107638e-04 3 1  ON 37
ci_39                -5.753369e-04 3 1  ON 38
ci_40                -1.385716e-03 3 1  ON 39
ci_41                -2.037822e-03 3 1  ON 40
ci_42                -9.893224e-04 3 1  ON 41
ci_43                -1.099035e-03 3 1  ON 42
ci_44                -6.406884e-04 3 1  ON 43
ci_45                -6.233329e-04 3 1  ON 44
ci_46                -2.600354e-05 3 1  ON 45
ci_47                 1.014884e-04 3 1  ON 46
ci_48                 1.740692e-03 3 1  ON 47
ci_49                -7.993442e-04 3 1  ON 48
ci_50                -8.272931e-04 3 1  ON 49
ci_51                 2.336401e-04 3 1  ON 50
ci_52                 1.125366e-04 3 1  ON 51
ci_53                -1.068830e-03 3 1  ON 52
ci_54                -1.282338e-03 3 1  ON 53
ci_55                 7.107099e-05 3 1  ON 54
ci_56                 1.290946e-03 3 1  ON 55
ci_57                 1.713199e-03 3 1  ON 56
ci_58                -7.439824e-04 3 1  ON 57
ci_59                -5.734387e-04 3 1  ON 58
ci_60                -3.831609e-04 3 1  ON 59
ci_61                 3.642917e-03 3 1  ON 60
ci_62                 2.308337e-04 3 1  ON 61
ci_63                -3.622904e-04 3 1  ON 62
ci_64                -2.845390e-04 3 1  ON 63
ci_65                -4.969494e-04 3 1  ON 64
ci_66                -1.362571e-03 3 1  ON 65
ci_67                -9.475953e-04 3 1  ON 66
ci_68                -2.778638e-04 3 1  ON 67
ci_69                -1.156048e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2250e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8245
    reference variance = 0.25367
====================================================
  Execution time = 4.2574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8441e-01
  Total weights = 1.964079757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469381867220
                                         uncertainty =       0.002245899945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469381867220
                                         uncertainty =       0.002245899945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484471008
  error estimate for blocks of size 2^( 2) =       0.000506549174
  error estimate for blocks of size 2^( 3) =       0.000527169822
  error estimate for blocks of size 2^( 4) =       0.000543634698
  error estimate for blocks of size 2^( 5) =       0.000554789390
  error estimate for blocks of size 2^( 6) =       0.000560568902
  error estimate for blocks of size 2^( 7) =       0.000563849632

      target function =      -0.653854975653
              le_mean =     -22.818532190486
             les_mean =     521.169821118362
             stat err =       0.000555710656
             autocorr =       1.315715114819
   target nu stat err =       0.000555710656
   target dn stat err =       0.003015368909
      target stat err =       0.001238484824
              std dev =       0.685145469471
             le_variance =       0.469424314336


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281853219049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653856893594       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653978106366       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654003474567       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654008923440       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654014422341       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654017418254       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654020341132       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654020607186       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654021019725       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654020882857       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654020868187       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654020941542       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654020999917       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 4.538261e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653856893594       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653978101474       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654003468229       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654008916640       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654014414978       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654017410449       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654020332899       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654020598867       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654021011321       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654020874461       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654020859792       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654020933133       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654020991493       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 4.537824e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653856893594       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653978081910       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654003442885       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654008889447       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654014385532       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654017379237       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654020299975       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654020565602       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654020977712       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654020840887       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654020826221       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654020899506       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654020957808       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 4.536079e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0189e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_01                 1.105464e-01 3 1  ON 0
ci_02                -2.416279e-02 3 1  ON 1
ci_03                -2.485233e-02 3 1  ON 2
ci_04                 2.207198e-02 3 1  ON 3
ci_05                -2.051588e-02 3 1  ON 4
ci_06                -1.823305e-02 3 1  ON 5
ci_07                 2.541322e-02 3 1  ON 6
ci_08                -2.989209e-03 3 1  ON 7
ci_09                -6.502970e-03 3 1  ON 8
ci_10                -7.186176e-03 3 1  ON 9
ci_11                 1.214278e-02 3 1  ON 10
ci_12                 5.469386e-03 3 1  ON 11
ci_13                 1.267306e-02 3 1  ON 12
ci_14                 1.148267e-02 3 1  ON 13
ci_15                 7.063987e-03 3 1  ON 14
ci_16                 6.308237e-03 3 1  ON 15
ci_17                -7.406727e-03 3 1  ON 16
ci_18                -8.381041e-03 3 1  ON 17
ci_19                 9.408004e-03 3 1  ON 18
ci_20                 7.085030e-03 3 1  ON 19
ci_21                 8.677808e-03 3 1  ON 20
ci_22                 8.290343e-03 3 1  ON 21
ci_23                 4.885924e-03 3 1  ON 22
ci_24                 5.011036e-03 3 1  ON 23
ci_25                 2.157148e-03 3 1  ON 24
ci_26                 3.661981e-03 3 1  ON 25
ci_27                 3.699074e-03 3 1  ON 26
ci_28                 1.965907e-03 3 1  ON 27
ci_29                 2.109353e-03 3 1  ON 28
ci_30                 5.360699e-05 3 1  ON 29
ci_31                 4.820214e-04 3 1  ON 30
ci_32                -3.666897e-04 3 1  ON 31
ci_33                -6.952776e-04 3 1  ON 32
ci_34                 1.202795e-03 3 1  ON 33
ci_35                 3.167418e-03 3 1  ON 34
ci_36                -9.949521e-04 3 1  ON 35
ci_37                -1.867496e-03 3 1  ON 36
ci_38                -1.061351e-03 3 1  ON 37
ci_39                -7.791894e-04 3 1  ON 38
ci_40                -1.342417e-03 3 1  ON 39
ci_41                -3.824003e-04 3 1  ON 40
ci_42                -1.426972e-03 3 1  ON 41
ci_43                -1.639993e-03 3 1  ON 42
ci_44                 7.794034e-04 3 1  ON 43
ci_45                -8.509332e-05 3 1  ON 44
ci_46                 4.626409e-04 3 1  ON 45
ci_47                 9.600551e-04 3 1  ON 46
ci_48                 2.467922e-03 3 1  ON 47
ci_49                -9.775274e-04 3 1  ON 48
ci_50                -5.807848e-04 3 1  ON 49
ci_51                 9.485909e-04 3 1  ON 50
ci_52                 5.561822e-04 3 1  ON 51
ci_53                -4.583750e-04 3 1  ON 52
ci_54                 2.467964e-04 3 1  ON 53
ci_55                -5.481813e-04 3 1  ON 54
ci_56                 2.377132e-03 3 1  ON 55
ci_57                 1.813886e-03 3 1  ON 56
ci_58                -9.035199e-06 3 1  ON 57
ci_59                -1.161775e-03 3 1  ON 58
ci_60                 1.389763e-04 3 1  ON 59
ci_61                -8.949077e-04 3 1  ON 60
ci_62                -1.170590e-03 3 1  ON 61
ci_63                 2.785706e-04 3 1  ON 62
ci_64                -7.632323e-04 3 1  ON 63
ci_65                -9.923087e-04 3 1  ON 64
ci_66                -2.002116e-04 3 1  ON 65
ci_67                -1.663926e-04 3 1  ON 66
ci_68                -1.175391e-03 3 1  ON 67
ci_69                -1.782297e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8506
    reference variance = 0.556397
====================================================
  Execution time = 4.1288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8732e-01
  Total weights = 1.9646e+06
  Execution time = 5.9044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471261719512
                                         uncertainty =       0.002856661101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471261719512
                                         uncertainty =       0.002856661101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485402737
  error estimate for blocks of size 2^( 2) =       0.000507279927
  error estimate for blocks of size 2^( 3) =       0.000527764224
  error estimate for blocks of size 2^( 4) =       0.000543325948
  error estimate for blocks of size 2^( 5) =       0.000551711176
  error estimate for blocks of size 2^( 6) =       0.000558164647
  error estimate for blocks of size 2^( 7) =       0.000560334613

      target function =      -0.621481237839
              le_mean =     -22.819178953456
             les_mean =     521.284592673469
             stat err =       0.000553384096
             autocorr =       1.299717319792
   target nu stat err =       0.000553384096
   target dn stat err =       0.046960696067
      target stat err =       0.016796973066
              std dev =       0.686463133563
             le_variance =       0.471231633741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468138043168
                                         uncertainty =       0.002249323369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468138043168
                                         uncertainty =       0.002249323369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483788984
  error estimate for blocks of size 2^( 2) =       0.000505721105
  error estimate for blocks of size 2^( 3) =       0.000526233891
  error estimate for blocks of size 2^( 4) =       0.000541866446
  error estimate for blocks of size 2^( 5) =       0.000550343353
  error estimate for blocks of size 2^( 6) =       0.000556681547
  error estimate for blocks of size 2^( 7) =       0.000558564294

      target function =      -0.652826906513
              le_mean =     -22.819051900004
             les_mean =     521.196450875570
             stat err =       0.000551863910
             autocorr =       1.301223915763
   target nu stat err =       0.000551863910
   target dn stat err =       0.006615121865
      target stat err =       0.002629378957
              std dev =       0.684180942771
             le_variance =       0.468103562451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493639102391
                                         uncertainty =       0.016375431845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493639102391
                                         uncertainty =       0.016375431845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496780287
  error estimate for blocks of size 2^( 2) =       0.000518100662
  error estimate for blocks of size 2^( 3) =       0.000538087664
  error estimate for blocks of size 2^( 4) =       0.000553398949
  error estimate for blocks of size 2^( 5) =       0.000561632141
  error estimate for blocks of size 2^( 6) =       0.000568145020
  error estimate for blocks of size 2^( 7) =       0.000569806148

      target function =      -0.324455938311
              le_mean =     -22.818994286894
             les_mean =     522.581143888380
             stat err =       0.000563245564
             autocorr =       1.285484523840
   target nu stat err =       0.000563245564
   target dn stat err =       0.937593014443
      target stat err =       0.099962657541
              std dev =       0.702553419533
             le_variance =       0.493581307298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468137961000
                                         uncertainty =       0.002249341705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468137961000
                                         uncertainty =       0.002249341705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483788942
  error estimate for blocks of size 2^( 2) =       0.000505721072
  error estimate for blocks of size 2^( 3) =       0.000526233866
  error estimate for blocks of size 2^( 4) =       0.000541866416
  error estimate for blocks of size 2^( 5) =       0.000550343321
  error estimate for blocks of size 2^( 6) =       0.000556681556
  error estimate for blocks of size 2^( 7) =       0.000558564294

      target function =      -0.652827949196
              le_mean =     -22.819051906394
             les_mean =     521.196448545455
             stat err =       0.000551863897
             autocorr =       1.301224080016
   target nu stat err =       0.000551863897
   target dn stat err =       0.006612762067
      target stat err =       0.002628464372
              std dev =       0.684180883026
             le_variance =       0.468103480698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.621481237839        initial
     5.8208e-07     5.8208e-06             4.5383e-03        -0.652826906513
     2.3283e-06     2.3283e-05             4.5378e-03        -0.324455938311
     9.3132e-06     9.3132e-05             4.5361e-03        -0.652827949196  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e-06     and shift_s =   9.3132e-05
*****************************************************************************

  Execution time = 7.0870e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_01                 1.105460e-01 3 1  ON 0
ci_02                -2.416263e-02 3 1  ON 1
ci_03                -2.485206e-02 3 1  ON 2
ci_04                 2.207191e-02 3 1  ON 3
ci_05                -2.051577e-02 3 1  ON 4
ci_06                -1.823331e-02 3 1  ON 5
ci_07                 2.541338e-02 3 1  ON 6
ci_08                -2.989335e-03 3 1  ON 7
ci_09                -6.502899e-03 3 1  ON 8
ci_10                -7.186299e-03 3 1  ON 9
ci_11                 1.214291e-02 3 1  ON 10
ci_12                 5.469618e-03 3 1  ON 11
ci_13                 1.267244e-02 3 1  ON 12
ci_14                 1.148413e-02 3 1  ON 13
ci_15                 7.064039e-03 3 1  ON 14
ci_16                 6.308232e-03 3 1  ON 15
ci_17                -7.406679e-03 3 1  ON 16
ci_18                -8.380690e-03 3 1  ON 17
ci_19                 9.408069e-03 3 1  ON 18
ci_20                 7.084815e-03 3 1  ON 19
ci_21                 8.677458e-03 3 1  ON 20
ci_22                 8.290476e-03 3 1  ON 21
ci_23                 4.885797e-03 3 1  ON 22
ci_24                 5.011129e-03 3 1  ON 23
ci_25                 2.157185e-03 3 1  ON 24
ci_26                 3.661919e-03 3 1  ON 25
ci_27                 3.698905e-03 3 1  ON 26
ci_28                 1.965951e-03 3 1  ON 27
ci_29                 2.109190e-03 3 1  ON 28
ci_30                 5.357862e-05 3 1  ON 29
ci_31                 4.811814e-04 3 1  ON 30
ci_32                -3.666994e-04 3 1  ON 31
ci_33                -6.954282e-04 3 1  ON 32
ci_34                 1.202770e-03 3 1  ON 33
ci_35                 3.167014e-03 3 1  ON 34
ci_36                -9.948968e-04 3 1  ON 35
ci_37                -1.867269e-03 3 1  ON 36
ci_38                -1.061175e-03 3 1  ON 37
ci_39                -7.791635e-04 3 1  ON 38
ci_40                -1.342421e-03 3 1  ON 39
ci_41                -3.826717e-04 3 1  ON 40
ci_42                -1.426895e-03 3 1  ON 41
ci_43                -1.639888e-03 3 1  ON 42
ci_44                 7.791363e-04 3 1  ON 43
ci_45                -8.518845e-05 3 1  ON 44
ci_46                 4.625617e-04 3 1  ON 45
ci_47                 9.597758e-04 3 1  ON 46
ci_48                 2.467783e-03 3 1  ON 47
ci_49                -9.775066e-04 3 1  ON 48
ci_50                -5.808247e-04 3 1  ON 49
ci_51                 9.484774e-04 3 1  ON 50
ci_52                 5.561157e-04 3 1  ON 51
ci_53                -4.584569e-04 3 1  ON 52
ci_54                 2.464807e-04 3 1  ON 53
ci_55                -5.481136e-04 3 1  ON 54
ci_56                 2.376955e-03 3 1  ON 55
ci_57                 1.813872e-03 3 1  ON 56
ci_58                -9.167943e-06 3 1  ON 57
ci_59                -1.161681e-03 3 1  ON 58
ci_60                 1.388407e-04 3 1  ON 59
ci_61                -8.931625e-04 3 1  ON 60
ci_62                -1.170383e-03 3 1  ON 61
ci_63                 2.784657e-04 3 1  ON 62
ci_64                -7.631580e-04 3 1  ON 63
ci_65                -9.922250e-04 3 1  ON 64
ci_66                -2.003926e-04 3 1  ON 65
ci_67                -1.665009e-04 3 1  ON 66
ci_68                -1.175230e-03 3 1  ON 67
ci_69                -1.782185e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2108e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8319
    reference variance = 0.376609
====================================================
  Execution time = 4.4446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8841e-01
  Total weights = 1.964176857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471528869555
                                         uncertainty =       0.002313417583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471528869555
                                         uncertainty =       0.002313417583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485613825
  error estimate for blocks of size 2^( 2) =       0.000507195645
  error estimate for blocks of size 2^( 3) =       0.000527863096
  error estimate for blocks of size 2^( 4) =       0.000544325246
  error estimate for blocks of size 2^( 5) =       0.000555451553
  error estimate for blocks of size 2^( 6) =       0.000561277134
  error estimate for blocks of size 2^( 7) =       0.000561936618

      target function =      -0.652261534010
              le_mean =     -22.818470938937
             les_mean =     521.171026621026
             stat err =       0.000555747638
             autocorr =       1.309704036830
   target nu stat err =       0.000555747638
   target dn stat err =       0.003316578373
      target stat err =       0.001347023894
              std dev =       0.686761657516
             le_variance =       0.471641574234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281847093894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652263908785       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652478072145       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652511602214       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652516579219       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652520348903       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652526183691       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652528474840       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652528811314       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652529450593       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652529323639       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652529118130       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652529110485       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.652529084532       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 4.392706e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652263908785       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652478037193       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652511558809       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652516534010       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652520302281       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652526134295       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652528423863       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652528759952       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652529398791       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652529271814       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652529066464       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652529058829       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.652529032898       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 4.390929e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652263908785       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652477897499       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652511385340       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652516353338       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652520115965       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652525936906       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652528220167       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652528554718       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652529191803       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652529064736       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652528860017       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652528852429       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.652528826583       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 4.383833e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2044e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_01                 1.137028e-01 3 1  ON 0
ci_02                -2.450136e-02 3 1  ON 1
ci_03                -2.302948e-02 3 1  ON 2
ci_04                 2.191212e-02 3 1  ON 3
ci_05                -1.966288e-02 3 1  ON 4
ci_06                -2.100045e-02 3 1  ON 5
ci_07                 2.637684e-02 3 1  ON 6
ci_08                -4.233585e-03 3 1  ON 7
ci_09                -7.164633e-03 3 1  ON 8
ci_10                -7.224148e-03 3 1  ON 9
ci_11                 1.216296e-02 3 1  ON 10
ci_12                 6.181035e-03 3 1  ON 11
ci_13                 1.450135e-02 3 1  ON 12
ci_14                 1.587506e-02 3 1  ON 13
ci_15                 4.797416e-03 3 1  ON 14
ci_16                 7.641875e-03 3 1  ON 15
ci_17                -6.381094e-03 3 1  ON 16
ci_18                -5.410023e-03 3 1  ON 17
ci_19                 8.751554e-03 3 1  ON 18
ci_20                 6.928043e-03 3 1  ON 19
ci_21                 8.371682e-03 3 1  ON 20
ci_22                 9.538690e-03 3 1  ON 21
ci_23                 4.919324e-03 3 1  ON 22
ci_24                 4.929766e-03 3 1  ON 23
ci_25                 3.004002e-03 3 1  ON 24
ci_26                 2.987784e-03 3 1  ON 25
ci_27                 2.455477e-03 3 1  ON 26
ci_28                 4.724081e-04 3 1  ON 27
ci_29                 1.216442e-03 3 1  ON 28
ci_30                -2.010316e-04 3 1  ON 29
ci_31                -4.538445e-04 3 1  ON 30
ci_32                 7.424470e-04 3 1  ON 31
ci_33                -3.229474e-04 3 1  ON 32
ci_34                -1.009060e-03 3 1  ON 33
ci_35                 1.941583e-03 3 1  ON 34
ci_36                -2.246659e-04 3 1  ON 35
ci_37                -1.702823e-03 3 1  ON 36
ci_38                -7.621910e-05 3 1  ON 37
ci_39                 1.917473e-04 3 1  ON 38
ci_40                -1.472421e-03 3 1  ON 39
ci_41                -6.527707e-05 3 1  ON 40
ci_42                -1.698691e-04 3 1  ON 41
ci_43                 1.605717e-04 3 1  ON 42
ci_44                -2.049485e-03 3 1  ON 43
ci_45                -9.633963e-04 3 1  ON 44
ci_46                -1.020190e-03 3 1  ON 45
ci_47                 2.030715e-03 3 1  ON 46
ci_48                 1.215601e-03 3 1  ON 47
ci_49                -3.709781e-04 3 1  ON 48
ci_50                -5.254117e-04 3 1  ON 49
ci_51                 6.923670e-04 3 1  ON 50
ci_52                 2.969506e-04 3 1  ON 51
ci_53                -1.548523e-03 3 1  ON 52
ci_54                -3.488764e-04 3 1  ON 53
ci_55                -1.873757e-03 3 1  ON 54
ci_56                 1.885373e-03 3 1  ON 55
ci_57                 1.901171e-03 3 1  ON 56
ci_58                -1.416098e-03 3 1  ON 57
ci_59                -9.416024e-04 3 1  ON 58
ci_60                 2.915438e-03 3 1  ON 59
ci_61                 1.423273e-03 3 1  ON 60
ci_62                 5.450364e-04 3 1  ON 61
ci_63                -4.681491e-05 3 1  ON 62
ci_64                -2.392217e-04 3 1  ON 63
ci_65                -6.351976e-04 3 1  ON 64
ci_66                 3.372633e-04 3 1  ON 65
ci_67                 5.482871e-05 3 1  ON 66
ci_68                -1.048117e-03 3 1  ON 67
ci_69                -7.985393e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8145
    reference variance = 0.404373
====================================================
  Execution time = 4.4034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8240e-01
  Total weights = 1.9641e+06
  Execution time = 6.0195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479647473255
                                         uncertainty =       0.007011945617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479647473255
                                         uncertainty =       0.007011945617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489683756
  error estimate for blocks of size 2^( 2) =       0.000511428096
  error estimate for blocks of size 2^( 3) =       0.000532066575
  error estimate for blocks of size 2^( 4) =       0.000548139804
  error estimate for blocks of size 2^( 5) =       0.000558529936
  error estimate for blocks of size 2^( 6) =       0.000565147364
  error estimate for blocks of size 2^( 7) =       0.000568762367

      target function =      -0.351268654916
              le_mean =     -22.819164892875
             les_mean =     522.367884064335
             stat err =       0.000560144868
             autocorr =       1.308486743693
   target nu stat err =       0.000560144868
   target dn stat err =       0.848912102868
      target stat err =       0.105675960058
              std dev =       0.692517408909
             le_variance =       0.479580361643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467274732371
                                         uncertainty =       0.002050524665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467274732371
                                         uncertainty =       0.002050524665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483342040
  error estimate for blocks of size 2^( 2) =       0.000505242537
  error estimate for blocks of size 2^( 3) =       0.000526082036
  error estimate for blocks of size 2^( 4) =       0.000542210246
  error estimate for blocks of size 2^( 5) =       0.000552496799
  error estimate for blocks of size 2^( 6) =       0.000559309088
  error estimate for blocks of size 2^( 7) =       0.000562703155

      target function =      -0.654768487092
              le_mean =     -22.819002705343
             les_mean =     521.189284951674
             stat err =       0.000554179822
             autocorr =       1.314595906997
   target nu stat err =       0.000554179822
   target dn stat err =       0.003162786574
      target stat err =       0.001298497001
              std dev =       0.683548868310
             le_variance =       0.467239055367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518571523123
                                         uncertainty =       0.047215355266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518571523123
                                         uncertainty =       0.047215355266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509096134
  error estimate for blocks of size 2^( 2) =       0.000529946924
  error estimate for blocks of size 2^( 3) =       0.000549766857
  error estimate for blocks of size 2^( 4) =       0.000565020776
  error estimate for blocks of size 2^( 5) =       0.000574898788
  error estimate for blocks of size 2^( 6) =       0.000580162037
  error estimate for blocks of size 2^( 7) =       0.000584289255

      target function =      -0.312694224482
              le_mean =     -22.819048275712
             les_mean =     522.579954706290
             stat err =       0.000576092714
             autocorr =       1.280516464057
   target nu stat err =       0.000576092714
   target dn stat err =       1.127130470323
      target stat err =       0.115957783612
              std dev =       0.719970657534
             le_variance =       0.518357747710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467275143488
                                         uncertainty =       0.002050604776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467275143488
                                         uncertainty =       0.002050604776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483342252
  error estimate for blocks of size 2^( 2) =       0.000505242764
  error estimate for blocks of size 2^( 3) =       0.000526082274
  error estimate for blocks of size 2^( 4) =       0.000542210532
  error estimate for blocks of size 2^( 5) =       0.000552497102
  error estimate for blocks of size 2^( 6) =       0.000559309389
  error estimate for blocks of size 2^( 7) =       0.000562703394

      target function =      -0.654766446295
              le_mean =     -22.819002692263
             les_mean =     521.189289486944
             stat err =       0.000554180105
             autocorr =       1.314596095386
   target nu stat err =       0.000554180105
   target dn stat err =       0.003164164149
      target stat err =       0.001299016989
              std dev =       0.683549168063
             le_variance =       0.467239465159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.351268654916        initial
     2.3283e-06     2.3283e-05             4.3927e-03        -0.654768487092  <--
     9.3132e-06     9.3132e-05             4.3909e-03        -0.312694224482
     3.7253e-05     3.7253e-04             4.3838e-03        -0.654766446295

*****************************************************************************
Applying the update for shift_i =   2.3283e-06     and shift_s =   2.3283e-05
*****************************************************************************

  Execution time = 7.4183e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_01                 1.137038e-01 3 1  ON 0
ci_02                -2.450140e-02 3 1  ON 1
ci_03                -2.302912e-02 3 1  ON 2
ci_04                 2.191210e-02 3 1  ON 3
ci_05                -1.966269e-02 3 1  ON 4
ci_06                -2.100098e-02 3 1  ON 5
ci_07                 2.637699e-02 3 1  ON 6
ci_08                -4.233785e-03 3 1  ON 7
ci_09                -7.164804e-03 3 1  ON 8
ci_10                -7.224170e-03 3 1  ON 9
ci_11                 1.216292e-02 3 1  ON 10
ci_12                 6.181151e-03 3 1  ON 11
ci_13                 1.450177e-02 3 1  ON 12
ci_14                 1.587684e-02 3 1  ON 13
ci_15                 4.796996e-03 3 1  ON 14
ci_16                 7.642126e-03 3 1  ON 15
ci_17                -6.380909e-03 3 1  ON 16
ci_18                -5.409463e-03 3 1  ON 17
ci_19                 8.751459e-03 3 1  ON 18
ci_20                 6.927992e-03 3 1  ON 19
ci_21                 8.371677e-03 3 1  ON 20
ci_22                 9.538994e-03 3 1  ON 21
ci_23                 4.919335e-03 3 1  ON 22
ci_24                 4.929782e-03 3 1  ON 23
ci_25                 3.004144e-03 3 1  ON 24
ci_26                 2.987656e-03 3 1  ON 25
ci_27                 2.455244e-03 3 1  ON 26
ci_28                 4.721450e-04 3 1  ON 27
ci_29                 1.216306e-03 3 1  ON 28
ci_30                -2.011308e-04 3 1  ON 29
ci_31                -4.540306e-04 3 1  ON 30
ci_32                 7.426250e-04 3 1  ON 31
ci_33                -3.229032e-04 3 1  ON 32
ci_34                -1.009451e-03 3 1  ON 33
ci_35                 1.941366e-03 3 1  ON 34
ci_36                -2.245382e-04 3 1  ON 35
ci_37                -1.702783e-03 3 1  ON 36
ci_38                -7.607603e-05 3 1  ON 37
ci_39                 1.919067e-04 3 1  ON 38
ci_40                -1.472446e-03 3 1  ON 39
ci_41                -6.523473e-05 3 1  ON 40
ci_42                -1.696598e-04 3 1  ON 41
ci_43                 1.609231e-04 3 1  ON 42
ci_44                -2.050044e-03 3 1  ON 43
ci_45                -9.635373e-04 3 1  ON 44
ci_46                -1.020433e-03 3 1  ON 45
ci_47                 2.030936e-03 3 1  ON 46
ci_48                 1.215264e-03 3 1  ON 47
ci_49                -3.709045e-04 3 1  ON 48
ci_50                -5.254059e-04 3 1  ON 49
ci_51                 6.923329e-04 3 1  ON 50
ci_52                 2.969075e-04 3 1  ON 51
ci_53                -1.548683e-03 3 1  ON 52
ci_54                -3.490290e-04 3 1  ON 53
ci_55                -1.874029e-03 3 1  ON 54
ci_56                 1.885293e-03 3 1  ON 55
ci_57                 1.901185e-03 3 1  ON 56
ci_58                -1.416362e-03 3 1  ON 57
ci_59                -9.415734e-04 3 1  ON 58
ci_60                 2.916527e-03 3 1  ON 59
ci_61                 1.424145e-03 3 1  ON 60
ci_62                 5.452932e-04 3 1  ON 61
ci_63                -4.687183e-05 3 1  ON 62
ci_64                -2.391340e-04 3 1  ON 63
ci_65                -6.351455e-04 3 1  ON 64
ci_66                 3.373508e-04 3 1  ON 65
ci_67                 5.486892e-05 3 1  ON 66
ci_68                -1.048103e-03 3 1  ON 67
ci_69                -7.983949e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2623e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8616
    reference variance = 0.423207
====================================================
  Execution time = 4.2896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9059e-01
  Total weights = 1.964107450e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472683791678
                                         uncertainty =       0.002771325218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472683791678
                                         uncertainty =       0.002771325218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486119671
  error estimate for blocks of size 2^( 2) =       0.000507694630
  error estimate for blocks of size 2^( 3) =       0.000528522069
  error estimate for blocks of size 2^( 4) =       0.000543577804
  error estimate for blocks of size 2^( 5) =       0.000552844249
  error estimate for blocks of size 2^( 6) =       0.000558601978
  error estimate for blocks of size 2^( 7) =       0.000560900608

      target function =      -0.651138999716
              le_mean =     -22.817399405772
             les_mean =     521.124307947589
             stat err =       0.000553981160
             autocorr =       1.298684328453
   target nu stat err =       0.000553981160
   target dn stat err =       0.004127920072
      target stat err =       0.001650618135
              std dev =       0.687477031771
             le_variance =       0.472624669213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281739940577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651142751815       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651308595178       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651340600827       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651359241193       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651361853571       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651366358080       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651366982587       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651368023898       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651367759735       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651367904510       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651367741898       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651367719674       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651367594386       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 6.074424e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651142751815       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651308588330       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651340591999       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651359230889       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651361842751       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651366346617       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651366970969       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651368012119       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651367747969       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651367892712       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651367730124       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651367707907       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651367582648       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 6.073924e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651142751815       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651308560944       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651340556693       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651359189685       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651361799482       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651366300776       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651366924510       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651367965017       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651367700917       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651367845534       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651367683042       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651367660850       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651367535707       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 6.071923e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0600e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_01                 1.076298e-01 3 1  ON 0
ci_02                -2.617858e-02 3 1  ON 1
ci_03                -2.567242e-02 3 1  ON 2
ci_04                 2.124097e-02 3 1  ON 3
ci_05                -2.115063e-02 3 1  ON 4
ci_06                -2.115844e-02 3 1  ON 5
ci_07                 2.594825e-02 3 1  ON 6
ci_08                -4.030021e-03 3 1  ON 7
ci_09                -6.628829e-03 3 1  ON 8
ci_10                -7.130901e-03 3 1  ON 9
ci_11                 1.366203e-02 3 1  ON 10
ci_12                 8.177461e-03 3 1  ON 11
ci_13                 1.357208e-02 3 1  ON 12
ci_14                 1.023819e-02 3 1  ON 13
ci_15                 5.771129e-03 3 1  ON 14
ci_16                 6.899439e-03 3 1  ON 15
ci_17                -7.544777e-03 3 1  ON 16
ci_18                -5.914241e-03 3 1  ON 17
ci_19                 8.364742e-03 3 1  ON 18
ci_20                 7.997147e-03 3 1  ON 19
ci_21                 8.238564e-03 3 1  ON 20
ci_22                 9.331594e-03 3 1  ON 21
ci_23                 4.815470e-03 3 1  ON 22
ci_24                 4.818768e-03 3 1  ON 23
ci_25                 2.220960e-03 3 1  ON 24
ci_26                 3.981809e-03 3 1  ON 25
ci_27                 3.544517e-03 3 1  ON 26
ci_28                 1.491955e-03 3 1  ON 27
ci_29                 1.822218e-03 3 1  ON 28
ci_30                -2.102398e-03 3 1  ON 29
ci_31                 4.116003e-04 3 1  ON 30
ci_32                -1.080142e-03 3 1  ON 31
ci_33                -1.747532e-03 3 1  ON 32
ci_34                 1.316699e-03 3 1  ON 33
ci_35                -4.988300e-04 3 1  ON 34
ci_36                -4.955109e-04 3 1  ON 35
ci_37                -9.284787e-04 3 1  ON 36
ci_38                -1.616742e-03 3 1  ON 37
ci_39                -6.333269e-04 3 1  ON 38
ci_40                -9.472524e-04 3 1  ON 39
ci_41                -1.501483e-03 3 1  ON 40
ci_42                -4.922489e-04 3 1  ON 41
ci_43                -2.102520e-03 3 1  ON 42
ci_44                -1.295302e-03 3 1  ON 43
ci_45                -8.334611e-04 3 1  ON 44
ci_46                -8.437600e-04 3 1  ON 45
ci_47                 2.829553e-03 3 1  ON 46
ci_48                -1.337841e-03 3 1  ON 47
ci_49                -1.000153e-03 3 1  ON 48
ci_50                -5.591673e-04 3 1  ON 49
ci_51                 3.733794e-05 3 1  ON 50
ci_52                -2.087229e-04 3 1  ON 51
ci_53                -1.551609e-03 3 1  ON 52
ci_54                 4.905403e-04 3 1  ON 53
ci_55                -6.580853e-04 3 1  ON 54
ci_56                 1.612275e-03 3 1  ON 55
ci_57                 9.970452e-04 3 1  ON 56
ci_58                -1.350848e-03 3 1  ON 57
ci_59                -4.954792e-04 3 1  ON 58
ci_60                -1.202652e-03 3 1  ON 59
ci_61                 2.290610e-03 3 1  ON 60
ci_62                -1.003424e-03 3 1  ON 61
ci_63                 1.643086e-04 3 1  ON 62
ci_64                -7.189385e-04 3 1  ON 63
ci_65                -4.130111e-04 3 1  ON 64
ci_66                -3.490183e-04 3 1  ON 65
ci_67                -8.625630e-06 3 1  ON 66
ci_68                -7.652658e-04 3 1  ON 67
ci_69                -1.047991e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8307
    reference variance = 0.89917
====================================================
  Execution time = 4.1975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8745e-01
  Total weights = 1.9642e+06
  Execution time = 6.0276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00387535
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501259996221
                                         uncertainty =       0.015443184798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501259996221
                                         uncertainty =       0.015443184798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500668940
  error estimate for blocks of size 2^( 2) =       0.000522195934
  error estimate for blocks of size 2^( 3) =       0.000542693866
  error estimate for blocks of size 2^( 4) =       0.000558328423
  error estimate for blocks of size 2^( 5) =       0.000567817531
  error estimate for blocks of size 2^( 6) =       0.000575413299
  error estimate for blocks of size 2^( 7) =       0.000577027397

      target function =      -0.545316060211
              le_mean =     -22.818891248902
             les_mean =     521.504385407635
             stat err =       0.000569646662
             autocorr =       1.294523131400
   target nu stat err =       0.000569646662
   target dn stat err =       0.148332119346
      target stat err =       0.041032027315
              std dev =       0.708052804834
             le_variance =       0.501338774434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472258573194
                                         uncertainty =       0.003664666257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472258573194
                                         uncertainty =       0.003664666257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485987268
  error estimate for blocks of size 2^( 2) =       0.000508083419
  error estimate for blocks of size 2^( 3) =       0.000529111982
  error estimate for blocks of size 2^( 4) =       0.000544960506
  error estimate for blocks of size 2^( 5) =       0.000554356467
  error estimate for blocks of size 2^( 6) =       0.000562157729
  error estimate for blocks of size 2^( 7) =       0.000563699681

      target function =      -0.652696693163
              le_mean =     -22.818710911361
             les_mean =     521.181017806257
             stat err =       0.000556293596
             autocorr =       1.310262577890
   target nu stat err =       0.000556293596
   target dn stat err =       0.004629839146
      target stat err =       0.001854756583
              std dev =       0.687289785465
             le_variance =       0.472367249205

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00387018
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511638472329
                                         uncertainty =       0.024032238254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511638472329
                                         uncertainty =       0.024032238254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505840957
  error estimate for blocks of size 2^( 2) =       0.000527145129
  error estimate for blocks of size 2^( 3) =       0.000547628356
  error estimate for blocks of size 2^( 4) =       0.000563096500
  error estimate for blocks of size 2^( 5) =       0.000572412151
  error estimate for blocks of size 2^( 6) =       0.000579870365
  error estimate for blocks of size 2^( 7) =       0.000581443523

      target function =      -0.407043229194
              le_mean =     -22.818808970863
             les_mean =     522.029137368569
             stat err =       0.000574205635
             autocorr =       1.288566747348
   target nu stat err =       0.000574205635
   target dn stat err =       0.625130885093
      target stat err =       0.101779555978
              std dev =       0.715367141307
             le_variance =       0.511750146862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472258494715
                                         uncertainty =       0.003664657698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472258494715
                                         uncertainty =       0.003664657698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485987229
  error estimate for blocks of size 2^( 2) =       0.000508083376
  error estimate for blocks of size 2^( 3) =       0.000529111928
  error estimate for blocks of size 2^( 4) =       0.000544960439
  error estimate for blocks of size 2^( 5) =       0.000554356398
  error estimate for blocks of size 2^( 6) =       0.000562157653
  error estimate for blocks of size 2^( 7) =       0.000563699619

      target function =      -0.652692636257
              le_mean =     -22.818710918683
             les_mean =     521.181028442055
             stat err =       0.000556293527
             autocorr =       1.310262466835
   target nu stat err =       0.000556293527
   target dn stat err =       0.004629873460
      target stat err =       0.001854747205
              std dev =       0.687289729717
             le_variance =       0.472367172575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.545316060211        initial
     5.8208e-07     5.8208e-06             6.0744e-03        -0.652696693163  <--
     2.3283e-06     2.3283e-05             6.0739e-03        -0.407043229194
     9.3132e-06     9.3132e-05             6.0719e-03        -0.652692636257

*****************************************************************************
Applying the update for shift_i =   5.8208e-07     and shift_s =   5.8208e-06
*****************************************************************************

  Execution time = 7.2229e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_01                 1.076293e-01 3 1  ON 0
ci_02                -2.617867e-02 3 1  ON 1
ci_03                -2.567255e-02 3 1  ON 2
ci_04                 2.124094e-02 3 1  ON 3
ci_05                -2.115071e-02 3 1  ON 4
ci_06                -2.115846e-02 3 1  ON 5
ci_07                 2.594825e-02 3 1  ON 6
ci_08                -4.030009e-03 3 1  ON 7
ci_09                -6.628792e-03 3 1  ON 8
ci_10                -7.130891e-03 3 1  ON 9
ci_11                 1.366212e-02 3 1  ON 10
ci_12                 8.177555e-03 3 1  ON 11
ci_13                 1.357204e-02 3 1  ON 12
ci_14                 1.023766e-02 3 1  ON 13
ci_15                 5.771175e-03 3 1  ON 14
ci_16                 6.899397e-03 3 1  ON 15
ci_17                -7.544835e-03 3 1  ON 16
ci_18                -5.914263e-03 3 1  ON 17
ci_19                 8.364726e-03 3 1  ON 18
ci_20                 7.997202e-03 3 1  ON 19
ci_21                 8.238573e-03 3 1  ON 20
ci_22                 9.331565e-03 3 1  ON 21
ci_23                 4.815465e-03 3 1  ON 22
ci_24                 4.818745e-03 3 1  ON 23
ci_25                 2.220925e-03 3 1  ON 24
ci_26                 3.981854e-03 3 1  ON 25
ci_27                 3.544569e-03 3 1  ON 26
ci_28                 1.491999e-03 3 1  ON 27
ci_29                 1.822241e-03 3 1  ON 28
ci_30                -2.102527e-03 3 1  ON 29
ci_31                 4.116619e-04 3 1  ON 30
ci_32                -1.080215e-03 3 1  ON 31
ci_33                -1.747588e-03 3 1  ON 32
ci_34                 1.316804e-03 3 1  ON 33
ci_35                -4.989515e-04 3 1  ON 34
ci_36                -4.955228e-04 3 1  ON 35
ci_37                -9.284491e-04 3 1  ON 36
ci_38                -1.616807e-03 3 1  ON 37
ci_39                -6.333630e-04 3 1  ON 38
ci_40                -9.472305e-04 3 1  ON 39
ci_41                -1.501541e-03 3 1  ON 40
ci_42                -4.922655e-04 3 1  ON 41
ci_43                -2.102629e-03 3 1  ON 42
ci_44                -1.295267e-03 3 1  ON 43
ci_45                -8.334553e-04 3 1  ON 44
ci_46                -8.437512e-04 3 1  ON 45
ci_47                 2.829622e-03 3 1  ON 46
ci_48                -1.337990e-03 3 1  ON 47
ci_49                -1.000172e-03 3 1  ON 48
ci_50                -5.591685e-04 3 1  ON 49
ci_51                 3.731293e-05 3 1  ON 50
ci_52                -2.087432e-04 3 1  ON 51
ci_53                -1.551608e-03 3 1  ON 52
ci_54                 4.905983e-04 3 1  ON 53
ci_55                -6.580184e-04 3 1  ON 54
ci_56                 1.612263e-03 3 1  ON 55
ci_57                 9.970085e-04 3 1  ON 56
ci_58                -1.350844e-03 3 1  ON 57
ci_59                -4.954613e-04 3 1  ON 58
ci_60                -1.203002e-03 3 1  ON 59
ci_61                 2.290652e-03 3 1  ON 60
ci_62                -1.003483e-03 3 1  ON 61
ci_63                 1.643171e-04 3 1  ON 62
ci_64                -7.189606e-04 3 1  ON 63
ci_65                -4.130035e-04 3 1  ON 64
ci_66                -3.490455e-04 3 1  ON 65
ci_67                -8.630275e-06 3 1  ON 66
ci_68                -7.652474e-04 3 1  ON 67
ci_69                -1.047994e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7601
    reference variance = 0.214478
====================================================
  Execution time = 4.2961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8587e-01
  Total weights = 1.964404326e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472050798733
                                         uncertainty =       0.002591330305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472050798733
                                         uncertainty =       0.002591330305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485829201
  error estimate for blocks of size 2^( 2) =       0.000507385502
  error estimate for blocks of size 2^( 3) =       0.000528045315
  error estimate for blocks of size 2^( 4) =       0.000543523091
  error estimate for blocks of size 2^( 5) =       0.000553013293
  error estimate for blocks of size 2^( 6) =       0.000559880517
  error estimate for blocks of size 2^( 7) =       0.000562936895

      target function =      -0.653646609284
              le_mean =     -22.820011995149
             les_mean =     521.238817478940
             stat err =       0.000554838449
             autocorr =       1.304265084113
   target nu stat err =       0.000554838449
   target dn stat err =       0.003444467565
      target stat err =       0.001403437951
              std dev =       0.687066245500
             le_variance =       0.472060025706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282001199515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-07, overlap shift 1.4552e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653649174107       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653767115821       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653798681086       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653802910279       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653808168039       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653812106359       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653813656506       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653813890474       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653813210678       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653813308154       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653813530767       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653813503703       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653813508163       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-07 is 7.058021e-03

solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653649174107       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653767114616       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653798679427       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653802908513       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653808166140       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653812104318       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653813654387       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653813888339       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653813208564       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653813306037       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653813528639       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653813501575       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653813506035       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 7.057848e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653649174107       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653767109793       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653798672794       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653802901449       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653808158544       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653812096153       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653813645911       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653813879799       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653813200112       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653813297569       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653813520127       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653813493066       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653813497524       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 7.057156e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0687e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_01                 1.102313e-01 3 1  ON 0
ci_02                -2.451416e-02 3 1  ON 1
ci_03                -2.581981e-02 3 1  ON 2
ci_04                 2.159902e-02 3 1  ON 3
ci_05                -1.978270e-02 3 1  ON 4
ci_06                -1.942330e-02 3 1  ON 5
ci_07                 2.536090e-02 3 1  ON 6
ci_08                -4.903947e-03 3 1  ON 7
ci_09                -6.953640e-03 3 1  ON 8
ci_10                -6.533310e-03 3 1  ON 9
ci_11                 1.345582e-02 3 1  ON 10
ci_12                 7.705168e-03 3 1  ON 11
ci_13                 1.289613e-02 3 1  ON 12
ci_14                 1.729551e-02 3 1  ON 13
ci_15                 8.154978e-03 3 1  ON 14
ci_16                 6.758710e-03 3 1  ON 15
ci_17                -4.876443e-03 3 1  ON 16
ci_18                -5.455824e-03 3 1  ON 17
ci_19                 9.026092e-03 3 1  ON 18
ci_20                 6.825070e-03 3 1  ON 19
ci_21                 8.358108e-03 3 1  ON 20
ci_22                 8.116311e-03 3 1  ON 21
ci_23                 5.380310e-03 3 1  ON 22
ci_24                 4.426497e-03 3 1  ON 23
ci_25                 2.506313e-03 3 1  ON 24
ci_26                 2.358304e-03 3 1  ON 25
ci_27                 2.535224e-03 3 1  ON 26
ci_28                 3.345761e-03 3 1  ON 27
ci_29                 1.588307e-03 3 1  ON 28
ci_30                -4.430048e-04 3 1  ON 29
ci_31                 1.172877e-03 3 1  ON 30
ci_32                -8.373207e-04 3 1  ON 31
ci_33                -5.144770e-04 3 1  ON 32
ci_34                 2.633436e-04 3 1  ON 33
ci_35                 6.102434e-04 3 1  ON 34
ci_36                -6.873506e-04 3 1  ON 35
ci_37                -5.262368e-04 3 1  ON 36
ci_38                -6.818501e-04 3 1  ON 37
ci_39                -4.413602e-04 3 1  ON 38
ci_40                -9.855683e-04 3 1  ON 39
ci_41                -9.053786e-04 3 1  ON 40
ci_42                -7.054468e-05 3 1  ON 41
ci_43                -1.880666e-03 3 1  ON 42
ci_44                -1.125161e-03 3 1  ON 43
ci_45                 5.565120e-04 3 1  ON 44
ci_46                -4.331206e-04 3 1  ON 45
ci_47                 1.514342e-03 3 1  ON 46
ci_48                 1.365063e-03 3 1  ON 47
ci_49                -4.203654e-04 3 1  ON 48
ci_50                -1.047527e-03 3 1  ON 49
ci_51                 9.990996e-05 3 1  ON 50
ci_52                 4.364627e-04 3 1  ON 51
ci_53                -1.361774e-03 3 1  ON 52
ci_54                 3.904285e-04 3 1  ON 53
ci_55                -8.647671e-04 3 1  ON 54
ci_56                 2.534774e-03 3 1  ON 55
ci_57                 1.362209e-03 3 1  ON 56
ci_58                -2.949693e-04 3 1  ON 57
ci_59                -1.035569e-03 3 1  ON 58
ci_60                 5.542610e-05 3 1  ON 59
ci_61                 3.307876e-03 3 1  ON 60
ci_62                 1.887366e-04 3 1  ON 61
ci_63                 8.444974e-05 3 1  ON 62
ci_64                 6.320463e-04 3 1  ON 63
ci_65                -1.486010e-03 3 1  ON 64
ci_66                 7.123484e-04 3 1  ON 65
ci_67                -8.535926e-04 3 1  ON 66
ci_68                -1.920969e-03 3 1  ON 67
ci_69                -4.248346e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8237
    reference variance = 0.315399
====================================================
  Execution time = 4.4461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8395e-01
  Total weights = 1.9639e+06
  Execution time = 5.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0718258
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.168933790477
                                         uncertainty =       1.678418564376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.168933790477
                                         uncertainty =       1.678418564376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001039446351
  error estimate for blocks of size 2^( 2) =       0.001050321247
  error estimate for blocks of size 2^( 3) =       0.001060923596
  error estimate for blocks of size 2^( 4) =       0.001069627559
  error estimate for blocks of size 2^( 5) =       0.001076429529
  error estimate for blocks of size 2^( 6) =       0.001077203118
  error estimate for blocks of size 2^( 7) =       0.001081553834

      target function =      -0.040045999477
              le_mean =     -22.819431791216
             les_mean =     534.713718379529
             stat err =       0.001076203510
             autocorr =       1.071974983254
   target nu stat err =       0.001076203510
   target dn stat err =      13.388249777623
      target stat err =       0.035377794360
              std dev =       1.469999127278
             le_variance =       2.160897434199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468766194035
                                         uncertainty =       0.002545425258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468766194035
                                         uncertainty =       0.002545425258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484166937
  error estimate for blocks of size 2^( 2) =       0.000505934804
  error estimate for blocks of size 2^( 3) =       0.000527160463
  error estimate for blocks of size 2^( 4) =       0.000543807871
  error estimate for blocks of size 2^( 5) =       0.000553753502
  error estimate for blocks of size 2^( 6) =       0.000559854954
  error estimate for blocks of size 2^( 7) =       0.000566242955

      target function =      -0.654008839457
              le_mean =     -22.818434145573
             les_mean =     521.164890874647
             stat err =       0.000555914820
             autocorr =       1.318336410192
   target nu stat err =       0.000555914821
   target dn stat err =       0.004065738066
      target stat err =       0.001642652592
              std dev =       0.684715448993
             le_variance =       0.468835246090

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0723237
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504268244955
                                         uncertainty =       0.026626930644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504268244955
                                         uncertainty =       0.026626930644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502148993
  error estimate for blocks of size 2^( 2) =       0.000523235723
  error estimate for blocks of size 2^( 3) =       0.000543985179
  error estimate for blocks of size 2^( 4) =       0.000560020460
  error estimate for blocks of size 2^( 5) =       0.000569863563
  error estimate for blocks of size 2^( 6) =       0.000576187967
  error estimate for blocks of size 2^( 7) =       0.000582658177

      target function =      -0.425273985515
              le_mean =     -22.818514689829
             les_mean =     521.913909026363
             stat err =       0.000572182542
             autocorr =       1.298386564870
   target nu stat err =       0.000572182542
   target dn stat err =       0.588382979956
      target stat err =       0.104307741994
              std dev =       0.710145916502
             le_variance =       0.504307222725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468766173206
                                         uncertainty =       0.002545424270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468766173206
                                         uncertainty =       0.002545424270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484166925
  error estimate for blocks of size 2^( 2) =       0.000505934794
  error estimate for blocks of size 2^( 3) =       0.000527160454
  error estimate for blocks of size 2^( 4) =       0.000543807863
  error estimate for blocks of size 2^( 5) =       0.000553753492
  error estimate for blocks of size 2^( 6) =       0.000559854946
  error estimate for blocks of size 2^( 7) =       0.000566242940

      target function =      -0.654009509759
              le_mean =     -22.818434145301
             les_mean =     521.164889172493
             stat err =       0.000555914810
             autocorr =       1.318336424467
   target nu stat err =       0.000555914810
   target dn stat err =       0.004064636770
      target stat err =       0.001642229568
              std dev =       0.684715432370
             le_variance =       0.468835223326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.040045999477        initial
            N/A            N/A                    N/A                    N/A     bad update
     5.8208e-07     5.8208e-06             7.0578e-03        -0.425273985515  <--
            N/A            N/A                    N/A                    N/A     bad update

*****************************************************************************
Applying the update for shift_i =   5.8208e-07     and shift_s =   5.8208e-06
*****************************************************************************

  Execution time = 7.3974e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_01                 1.102313e-01 3 1  ON 0
ci_02                -2.451416e-02 3 1  ON 1
ci_03                -2.581981e-02 3 1  ON 2
ci_04                 2.159902e-02 3 1  ON 3
ci_05                -1.978270e-02 3 1  ON 4
ci_06                -1.942330e-02 3 1  ON 5
ci_07                 2.536090e-02 3 1  ON 6
ci_08                -4.903947e-03 3 1  ON 7
ci_09                -6.953640e-03 3 1  ON 8
ci_10                -6.533310e-03 3 1  ON 9
ci_11                 1.345582e-02 3 1  ON 10
ci_12                 7.705168e-03 3 1  ON 11
ci_13                 1.289613e-02 3 1  ON 12
ci_14                 1.729551e-02 3 1  ON 13
ci_15                 8.154978e-03 3 1  ON 14
ci_16                 6.758710e-03 3 1  ON 15
ci_17                -4.876443e-03 3 1  ON 16
ci_18                -5.455824e-03 3 1  ON 17
ci_19                 9.026092e-03 3 1  ON 18
ci_20                 6.825070e-03 3 1  ON 19
ci_21                 8.358108e-03 3 1  ON 20
ci_22                 8.116311e-03 3 1  ON 21
ci_23                 5.380310e-03 3 1  ON 22
ci_24                 4.426497e-03 3 1  ON 23
ci_25                 2.506313e-03 3 1  ON 24
ci_26                 2.358304e-03 3 1  ON 25
ci_27                 2.535224e-03 3 1  ON 26
ci_28                 3.345761e-03 3 1  ON 27
ci_29                 1.588307e-03 3 1  ON 28
ci_30                -4.430048e-04 3 1  ON 29
ci_31                 1.172877e-03 3 1  ON 30
ci_32                -8.373207e-04 3 1  ON 31
ci_33                -5.144770e-04 3 1  ON 32
ci_34                 2.633436e-04 3 1  ON 33
ci_35                 6.102434e-04 3 1  ON 34
ci_36                -6.873506e-04 3 1  ON 35
ci_37                -5.262368e-04 3 1  ON 36
ci_38                -6.818501e-04 3 1  ON 37
ci_39                -4.413602e-04 3 1  ON 38
ci_40                -9.855683e-04 3 1  ON 39
ci_41                -9.053786e-04 3 1  ON 40
ci_42                -7.054468e-05 3 1  ON 41
ci_43                -1.880666e-03 3 1  ON 42
ci_44                -1.125161e-03 3 1  ON 43
ci_45                 5.565120e-04 3 1  ON 44
ci_46                -4.331206e-04 3 1  ON 45
ci_47                 1.514342e-03 3 1  ON 46
ci_48                 1.365063e-03 3 1  ON 47
ci_49                -4.203654e-04 3 1  ON 48
ci_50                -1.047527e-03 3 1  ON 49
ci_51                 9.990996e-05 3 1  ON 50
ci_52                 4.364627e-04 3 1  ON 51
ci_53                -1.361774e-03 3 1  ON 52
ci_54                 3.904285e-04 3 1  ON 53
ci_55                -8.647671e-04 3 1  ON 54
ci_56                 2.534774e-03 3 1  ON 55
ci_57                 1.362209e-03 3 1  ON 56
ci_58                -2.949693e-04 3 1  ON 57
ci_59                -1.035569e-03 3 1  ON 58
ci_60                 5.542610e-05 3 1  ON 59
ci_61                 3.307876e-03 3 1  ON 60
ci_62                 1.887366e-04 3 1  ON 61
ci_63                 8.444974e-05 3 1  ON 62
ci_64                 6.320463e-04 3 1  ON 63
ci_65                -1.486010e-03 3 1  ON 64
ci_66                 7.123484e-04 3 1  ON 65
ci_67                -8.535926e-04 3 1  ON 66
ci_68                -1.920969e-03 3 1  ON 67
ci_69                -4.248346e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2468e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.9189
    reference variance = 0.400567
====================================================
  Execution time = 4.4552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9895e-01
  Total weights = 1.964293663e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478673711653
                                         uncertainty =       0.008096654786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478673711653
                                         uncertainty =       0.008096654786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489216291
  error estimate for blocks of size 2^( 2) =       0.000510642003
  error estimate for blocks of size 2^( 3) =       0.000531154671
  error estimate for blocks of size 2^( 4) =       0.000547169644
  error estimate for blocks of size 2^( 5) =       0.000556656514
  error estimate for blocks of size 2^( 6) =       0.000561626007
  error estimate for blocks of size 2^( 7) =       0.000564248465

      target function =      -0.648351634672
              le_mean =     -22.819469873114
             les_mean =     521.227157120131
             stat err =       0.000557425157
             autocorr =       1.298288796583
   target nu stat err =       0.000557425157
   target dn stat err =       0.011775610660
      target stat err =       0.004593501085
              std dev =       0.691856313142
             le_variance =       0.478665158035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281946987311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-07, overlap shift 1.4552e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648384004451       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648700426069       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648779439354       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648800096534       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648809872330       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648817603874       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648821065762       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648822409078       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648823672551       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648823412488       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648823802438       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.648823652373       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.648823815195       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.648823821286       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-07 is 5.855234e-03

solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648384004451       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648700422706       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648779434706       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648800091389       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648809866936       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648817598233       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648821059973       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648822403232       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648823666650       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648823406584       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648823796513       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.648823646453       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.648823809266       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.648823815356       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 5.855100e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648384004451       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648700409252       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648779416114       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648800070812       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648809845359       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648817575671       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648821036819       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648822379851       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648823643048       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648823382972       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648823772815       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.648823622777       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.648823785552       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.648823791640       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 5.854566e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2179e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_01                 1.092168e-01 3 1  ON 0
ci_02                -2.404683e-02 3 1  ON 1
ci_03                -2.510957e-02 3 1  ON 2
ci_04                 2.423290e-02 3 1  ON 3
ci_05                -2.166532e-02 3 1  ON 4
ci_06                -1.784994e-02 3 1  ON 5
ci_07                 2.729629e-02 3 1  ON 6
ci_08                -3.380110e-03 3 1  ON 7
ci_09                -7.251959e-03 3 1  ON 8
ci_10                -6.690677e-03 3 1  ON 9
ci_11                 1.072060e-02 3 1  ON 10
ci_12                 6.047985e-03 3 1  ON 11
ci_13                 1.679397e-02 3 1  ON 12
ci_14                 2.315061e-02 3 1  ON 13
ci_15                 7.092941e-03 3 1  ON 14
ci_16                 7.038568e-03 3 1  ON 15
ci_17                -8.197725e-03 3 1  ON 16
ci_18                -5.621765e-03 3 1  ON 17
ci_19                 8.590440e-03 3 1  ON 18
ci_20                 7.180051e-03 3 1  ON 19
ci_21                 1.176625e-02 3 1  ON 20
ci_22                 6.255560e-03 3 1  ON 21
ci_23                 5.330443e-03 3 1  ON 22
ci_24                 7.662250e-04 3 1  ON 23
ci_25                 3.159386e-03 3 1  ON 24
ci_26                 3.218854e-03 3 1  ON 25
ci_27                 4.790996e-03 3 1  ON 26
ci_28                 2.542101e-03 3 1  ON 27
ci_29                 9.935742e-04 3 1  ON 28
ci_30                -2.849831e-03 3 1  ON 29
ci_31                 3.968318e-04 3 1  ON 30
ci_32                -1.984211e-03 3 1  ON 31
ci_33                 5.144017e-04 3 1  ON 32
ci_34                -3.387766e-03 3 1  ON 33
ci_35                 2.337040e-03 3 1  ON 34
ci_36                 4.657230e-04 3 1  ON 35
ci_37                -7.677279e-04 3 1  ON 36
ci_38                -1.523101e-03 3 1  ON 37
ci_39                -8.121689e-04 3 1  ON 38
ci_40                -1.765057e-03 3 1  ON 39
ci_41                -2.817664e-04 3 1  ON 40
ci_42                -5.272478e-04 3 1  ON 41
ci_43                -1.934432e-03 3 1  ON 42
ci_44                -1.503474e-03 3 1  ON 43
ci_45                 9.500722e-04 3 1  ON 44
ci_46                -6.830357e-04 3 1  ON 45
ci_47                 8.915115e-05 3 1  ON 46
ci_48                 3.701073e-03 3 1  ON 47
ci_49                -1.911073e-03 3 1  ON 48
ci_50                -9.400565e-04 3 1  ON 49
ci_51                 3.393460e-04 3 1  ON 50
ci_52                -2.410965e-05 3 1  ON 51
ci_53                -9.918445e-04 3 1  ON 52
ci_54                -1.234921e-03 3 1  ON 53
ci_55                -5.441623e-04 3 1  ON 54
ci_56                 2.300929e-03 3 1  ON 55
ci_57                 2.235993e-03 3 1  ON 56
ci_58                -8.779547e-04 3 1  ON 57
ci_59                -1.893153e-03 3 1  ON 58
ci_60                 1.303521e-03 3 1  ON 59
ci_61                 9.361976e-04 3 1  ON 60
ci_62                 2.831006e-04 3 1  ON 61
ci_63                -1.397053e-04 3 1  ON 62
ci_64                 4.063199e-04 3 1  ON 63
ci_65                 1.834751e-05 3 1  ON 64
ci_66                -1.370174e-03 3 1  ON 65
ci_67                 2.822072e-04 3 1  ON 66
ci_68                -1.721452e-03 3 1  ON 67
ci_69                -1.415705e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.78
    reference variance = 0.363503
====================================================
  Execution time = 4.1355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8139e-01
  Total weights = 1.9639e+06
  Execution time = 5.9091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.810278744395
                                         uncertainty =       0.314471166592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.810278744395
                                         uncertainty =       0.314471166592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000636511698
  error estimate for blocks of size 2^( 2) =       0.000652839521
  error estimate for blocks of size 2^( 3) =       0.000668775174
  error estimate for blocks of size 2^( 4) =       0.000680632840
  error estimate for blocks of size 2^( 5) =       0.000689094773
  error estimate for blocks of size 2^( 6) =       0.000694326870
  error estimate for blocks of size 2^( 7) =       0.000697176402

      target function =      -0.008127597383
              le_mean =     -22.818439154553
             les_mean =     588.057400996833
             stat err =       0.000690307721
             autocorr =       1.176177000454
   target nu stat err =       0.000690307721
   target dn stat err =      66.548434941774
      target stat err =       0.007890743856
              std dev =       0.900163476133
             le_variance =       0.810294283763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464461048227
                                         uncertainty =       0.001801294549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464461048227
                                         uncertainty =       0.001801294549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481953102
  error estimate for blocks of size 2^( 2) =       0.000503582695
  error estimate for blocks of size 2^( 3) =       0.000524227341
  error estimate for blocks of size 2^( 4) =       0.000539574031
  error estimate for blocks of size 2^( 5) =       0.000548821208
  error estimate for blocks of size 2^( 6) =       0.000555652743
  error estimate for blocks of size 2^( 7) =       0.000560181553

      target function =      -0.655047506184
              le_mean =     -22.818509472471
             les_mean =     521.165759545741
             stat err =       0.000551057384
             autocorr =       1.307326583325
   target nu stat err =       0.000551057384
   target dn stat err =       0.002796625663
      target stat err =       0.001158692402
              std dev =       0.681584613117
             le_variance =       0.464557584838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522692190491
                                         uncertainty =       0.044568938542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522692190491
                                         uncertainty =       0.044568938542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511227808
  error estimate for blocks of size 2^( 2) =       0.000531793073
  error estimate for blocks of size 2^( 3) =       0.000551501432
  error estimate for blocks of size 2^( 4) =       0.000566236841
  error estimate for blocks of size 2^( 5) =       0.000574914111
  error estimate for blocks of size 2^( 6) =       0.000580932258
  error estimate for blocks of size 2^( 7) =       0.000584249245

      target function =      -0.296352122670
              le_mean =     -22.818679681995
             les_mean =     522.635907317636
             stat err =       0.000576583114
             autocorr =       1.272022813465
   target nu stat err =       0.000576583114
   target dn stat err =       1.292219417719
      target stat err =       0.123016384611
              std dev =       0.722985299482
             le_variance =       0.522707743268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464461037124
                                         uncertainty =       0.001801296891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464461037124
                                         uncertainty =       0.001801296891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481953096
  error estimate for blocks of size 2^( 2) =       0.000503582688
  error estimate for blocks of size 2^( 3) =       0.000524227334
  error estimate for blocks of size 2^( 4) =       0.000539574020
  error estimate for blocks of size 2^( 5) =       0.000548821193
  error estimate for blocks of size 2^( 6) =       0.000555652732
  error estimate for blocks of size 2^( 7) =       0.000560181533

      target function =      -0.655046911892
              le_mean =     -22.818509472392
             les_mean =     521.165761039150
             stat err =       0.000551057369
             autocorr =       1.307326547240
   target nu stat err =       0.000551057369
   target dn stat err =       0.002796869387
      target stat err =       0.001158782985
              std dev =       0.681584604652
             le_variance =       0.464557573299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.008127597383        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.9856
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_01                 1.102313e-01 3 1  ON 0
ci_02                -2.451416e-02 3 1  ON 1
ci_03                -2.581981e-02 3 1  ON 2
ci_04                 2.159902e-02 3 1  ON 3
ci_05                -1.978270e-02 3 1  ON 4
ci_06                -1.942330e-02 3 1  ON 5
ci_07                 2.536090e-02 3 1  ON 6
ci_08                -4.903947e-03 3 1  ON 7
ci_09                -6.953640e-03 3 1  ON 8
ci_10                -6.533310e-03 3 1  ON 9
ci_11                 1.345582e-02 3 1  ON 10
ci_12                 7.705168e-03 3 1  ON 11
ci_13                 1.289613e-02 3 1  ON 12
ci_14                 1.729551e-02 3 1  ON 13
ci_15                 8.154978e-03 3 1  ON 14
ci_16                 6.758710e-03 3 1  ON 15
ci_17                -4.876443e-03 3 1  ON 16
ci_18                -5.455824e-03 3 1  ON 17
ci_19                 9.026092e-03 3 1  ON 18
ci_20                 6.825070e-03 3 1  ON 19
ci_21                 8.358108e-03 3 1  ON 20
ci_22                 8.116311e-03 3 1  ON 21
ci_23                 5.380310e-03 3 1  ON 22
ci_24                 4.426497e-03 3 1  ON 23
ci_25                 2.506313e-03 3 1  ON 24
ci_26                 2.358304e-03 3 1  ON 25
ci_27                 2.535224e-03 3 1  ON 26
ci_28                 3.345761e-03 3 1  ON 27
ci_29                 1.588307e-03 3 1  ON 28
ci_30                -4.430048e-04 3 1  ON 29
ci_31                 1.172877e-03 3 1  ON 30
ci_32                -8.373207e-04 3 1  ON 31
ci_33                -5.144770e-04 3 1  ON 32
ci_34                 2.633436e-04 3 1  ON 33
ci_35                 6.102434e-04 3 1  ON 34
ci_36                -6.873506e-04 3 1  ON 35
ci_37                -5.262368e-04 3 1  ON 36
ci_38                -6.818501e-04 3 1  ON 37
ci_39                -4.413602e-04 3 1  ON 38
ci_40                -9.855683e-04 3 1  ON 39
ci_41                -9.053786e-04 3 1  ON 40
ci_42                -7.054468e-05 3 1  ON 41
ci_43                -1.880666e-03 3 1  ON 42
ci_44                -1.125161e-03 3 1  ON 43
ci_45                 5.565120e-04 3 1  ON 44
ci_46                -4.331206e-04 3 1  ON 45
ci_47                 1.514342e-03 3 1  ON 46
ci_48                 1.365063e-03 3 1  ON 47
ci_49                -4.203654e-04 3 1  ON 48
ci_50                -1.047527e-03 3 1  ON 49
ci_51                 9.990996e-05 3 1  ON 50
ci_52                 4.364627e-04 3 1  ON 51
ci_53                -1.361774e-03 3 1  ON 52
ci_54                 3.904285e-04 3 1  ON 53
ci_55                -8.647671e-04 3 1  ON 54
ci_56                 2.534774e-03 3 1  ON 55
ci_57                 1.362209e-03 3 1  ON 56
ci_58                -2.949693e-04 3 1  ON 57
ci_59                -1.035569e-03 3 1  ON 58
ci_60                 5.542610e-05 3 1  ON 59
ci_61                 3.307876e-03 3 1  ON 60
ci_62                 1.887366e-04 3 1  ON 61
ci_63                 8.444974e-05 3 1  ON 62
ci_64                 6.320463e-04 3 1  ON 63
ci_65                -1.486010e-03 3 1  ON 64
ci_66                 7.123484e-04 3 1  ON 65
ci_67                -8.535926e-04 3 1  ON 66
ci_68                -1.920969e-03 3 1  ON 67
ci_69                -4.248346e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2317e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7678
    reference variance = 0.459097
====================================================
  Execution time = 4.2553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8466e-01
  Total weights = 1.963946563e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470220293722
                                         uncertainty =       0.002196184940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470220293722
                                         uncertainty =       0.002196184940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484837168
  error estimate for blocks of size 2^( 2) =       0.000506722089
  error estimate for blocks of size 2^( 3) =       0.000526998903
  error estimate for blocks of size 2^( 4) =       0.000543299421
  error estimate for blocks of size 2^( 5) =       0.000552664290
  error estimate for blocks of size 2^( 6) =       0.000557494361
  error estimate for blocks of size 2^( 7) =       0.000560530352

      target function =      -0.653987366657
              le_mean =     -22.819456029073
             les_mean =     521.212232352544
             stat err =       0.000553497106
             autocorr =       1.303283500057
   target nu stat err =       0.000553497106
   target dn stat err =       0.003245445331
      target stat err =       0.001327573848
              std dev =       0.685663298639
             le_variance =       0.470134159100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281945602907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-06, overlap shift 1.4552e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653989603028       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654104961339       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654135845755       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654146975349       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654147898249       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654149671571       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654151148671       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654150688414       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654150915792       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654150761305       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654150781545       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654150672488       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-06 is 3.780778e-03

solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653989603028       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654104949886       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654135830076       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654146957586       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654147880012       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654149652776       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654151129283       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654150669107       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654150896397       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654150741963       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654150762195       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654150653191       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 3.779905e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653989603028       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654104904099       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654135767394       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654146886577       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654147807105       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654149577643       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654151051779       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654150591929       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654150818867       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654150664644       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654150684845       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654150576052       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 3.776418e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0216e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_01                 1.107497e-01 3 1  ON 0
ci_02                -2.502126e-02 3 1  ON 1
ci_03                -2.502041e-02 3 1  ON 2
ci_04                 2.051909e-02 3 1  ON 3
ci_05                -2.036219e-02 3 1  ON 4
ci_06                -2.178360e-02 3 1  ON 5
ci_07                 2.502183e-02 3 1  ON 6
ci_08                -4.271144e-03 3 1  ON 7
ci_09                -7.004290e-03 3 1  ON 8
ci_10                -9.059625e-03 3 1  ON 9
ci_11                 1.230283e-02 3 1  ON 10
ci_12                 6.813478e-03 3 1  ON 11
ci_13                 1.478344e-02 3 1  ON 12
ci_14                 1.987925e-02 3 1  ON 13
ci_15                 6.473046e-03 3 1  ON 14
ci_16                 5.222845e-03 3 1  ON 15
ci_17                -6.218053e-03 3 1  ON 16
ci_18                -5.511391e-03 3 1  ON 17
ci_19                 9.178541e-03 3 1  ON 18
ci_20                 6.346383e-03 3 1  ON 19
ci_21                 9.276009e-03 3 1  ON 20
ci_22                 7.832472e-03 3 1  ON 21
ci_23                 5.124438e-03 3 1  ON 22
ci_24                 5.298737e-03 3 1  ON 23
ci_25                 2.922619e-03 3 1  ON 24
ci_26                 2.139032e-03 3 1  ON 25
ci_27                 3.011507e-03 3 1  ON 26
ci_28                 2.670527e-03 3 1  ON 27
ci_29                 6.257306e-04 3 1  ON 28
ci_30                -3.671019e-04 3 1  ON 29
ci_31                 5.113154e-05 3 1  ON 30
ci_32                -1.617770e-03 3 1  ON 31
ci_33                -8.626290e-04 3 1  ON 32
ci_34                 2.192832e-03 3 1  ON 33
ci_35                -2.092030e-04 3 1  ON 34
ci_36                -1.732965e-03 3 1  ON 35
ci_37                -1.076897e-03 3 1  ON 36
ci_38                -4.239489e-04 3 1  ON 37
ci_39                -6.567546e-04 3 1  ON 38
ci_40                -1.043608e-03 3 1  ON 39
ci_41                 2.251498e-04 3 1  ON 40
ci_42                 8.005550e-04 3 1  ON 41
ci_43                -2.503769e-03 3 1  ON 42
ci_44                -9.205182e-04 3 1  ON 43
ci_45                 4.241363e-04 3 1  ON 44
ci_46                -4.421916e-04 3 1  ON 45
ci_47                 1.989883e-03 3 1  ON 46
ci_48                 1.735807e-03 3 1  ON 47
ci_49                -5.497805e-04 3 1  ON 48
ci_50                -3.224157e-05 3 1  ON 49
ci_51                 8.654832e-05 3 1  ON 50
ci_52                 1.937711e-06 3 1  ON 51
ci_53                -7.243393e-04 3 1  ON 52
ci_54                -2.033856e-03 3 1  ON 53
ci_55                -2.736738e-03 3 1  ON 54
ci_56                 1.944153e-03 3 1  ON 55
ci_57                 2.573152e-03 3 1  ON 56
ci_58                -1.026550e-03 3 1  ON 57
ci_59                -9.510242e-04 3 1  ON 58
ci_60                 3.835331e-03 3 1  ON 59
ci_61                 2.849528e-04 3 1  ON 60
ci_62                 2.314746e-04 3 1  ON 61
ci_63                -9.603059e-04 3 1  ON 62
ci_64                 1.617172e-03 3 1  ON 63
ci_65                -4.195979e-04 3 1  ON 64
ci_66                 4.251157e-04 3 1  ON 65
ci_67                 1.686843e-04 3 1  ON 66
ci_68                -2.091882e-03 3 1  ON 67
ci_69                -1.662899e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7977
    reference variance = 0.574141
====================================================
  Execution time = 4.1272e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8767e-01
  Total weights = 1.9641e+06
  Execution time = 5.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517742039707
                                         uncertainty =       0.029370099422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517742039707
                                         uncertainty =       0.029370099422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508709502
  error estimate for blocks of size 2^( 2) =       0.000529796513
  error estimate for blocks of size 2^( 3) =       0.000549683917
  error estimate for blocks of size 2^( 4) =       0.000564584539
  error estimate for blocks of size 2^( 5) =       0.000573140434
  error estimate for blocks of size 2^( 6) =       0.000579872298
  error estimate for blocks of size 2^( 7) =       0.000580958395

      target function =      -0.398825560047
              le_mean =     -22.819445416829
             les_mean =     522.130916893977
             stat err =       0.000574638917
             autocorr =       1.275999105268
   target nu stat err =       0.000574638917
   target dn stat err =       0.595923391505
      target stat err =       0.092427357013
              std dev =       0.719423876848
             le_variance =       0.517570714579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472179684028
                                         uncertainty =       0.002498613336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472179684028
                                         uncertainty =       0.002498613336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485834218
  error estimate for blocks of size 2^( 2) =       0.000507900055
  error estimate for blocks of size 2^( 3) =       0.000528479192
  error estimate for blocks of size 2^( 4) =       0.000544020448
  error estimate for blocks of size 2^( 5) =       0.000553184268
  error estimate for blocks of size 2^( 6) =       0.000560246534
  error estimate for blocks of size 2^( 7) =       0.000561225239

      target function =      -0.652811517314
              le_mean =     -22.819510387896
             les_mean =     521.217723511963
             stat err =       0.000554669122
             autocorr =       1.303442208323
   target nu stat err =       0.000554669122
   target dn stat err =       0.003202205752
      target stat err =       0.001306710489
              std dev =       0.687073340408
             le_variance =       0.472069775099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474540594280
                                         uncertainty =       0.002641455158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474540594280
                                         uncertainty =       0.002641455158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487045509
  error estimate for blocks of size 2^( 2) =       0.000509103855
  error estimate for blocks of size 2^( 3) =       0.000529620031
  error estimate for blocks of size 2^( 4) =       0.000545133604
  error estimate for blocks of size 2^( 5) =       0.000554369073
  error estimate for blocks of size 2^( 6) =       0.000561494087
  error estimate for blocks of size 2^( 7) =       0.000562448130

      target function =      -0.629184482142
              le_mean =     -22.819632336285
             les_mean =     521.285004487521
             stat err =       0.000555861224
             autocorr =       1.302547805331
   target nu stat err =       0.000555861224
   target dn stat err =       0.029705517917
      target stat err =       0.010892893383
              std dev =       0.688786364878
             le_variance =       0.474426656442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472179515862
                                         uncertainty =       0.002498603381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472179515862
                                         uncertainty =       0.002498603381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485834131
  error estimate for blocks of size 2^( 2) =       0.000507899955
  error estimate for blocks of size 2^( 3) =       0.000528479087
  error estimate for blocks of size 2^( 4) =       0.000544020354
  error estimate for blocks of size 2^( 5) =       0.000553184138
  error estimate for blocks of size 2^( 6) =       0.000560246378
  error estimate for blocks of size 2^( 7) =       0.000561225095

      target function =      -0.652811023195
              le_mean =     -22.819510378680
             les_mean =     521.217724337460
             stat err =       0.000554668991
             autocorr =       1.303442060170
   target nu stat err =       0.000554668991
   target dn stat err =       0.003202438403
      target stat err =       0.001306797239
              std dev =       0.687073217515
             le_variance =       0.472069606226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.398825560047        initial
     1.4552e-06     1.4552e-05             3.7808e-03        -0.652811517314  <--
     5.8208e-06     5.8208e-05             3.7799e-03        -0.629184482142
     2.3283e-05     2.3283e-04             3.7764e-03        -0.652811023195

*****************************************************************************
Applying the update for shift_i =   1.4552e-06     and shift_s =   1.4552e-05
*****************************************************************************

  Execution time = 7.0798e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_01                 1.107498e-01 3 1  ON 0
ci_02                -2.502131e-02 3 1  ON 1
ci_03                -2.502029e-02 3 1  ON 2
ci_04                 2.051898e-02 3 1  ON 3
ci_05                -2.036228e-02 3 1  ON 4
ci_06                -2.178389e-02 3 1  ON 5
ci_07                 2.502177e-02 3 1  ON 6
ci_08                -4.271089e-03 3 1  ON 7
ci_09                -7.004310e-03 3 1  ON 8
ci_10                -9.059964e-03 3 1  ON 9
ci_11                 1.230266e-02 3 1  ON 10
ci_12                 6.813383e-03 3 1  ON 11
ci_13                 1.478374e-02 3 1  ON 12
ci_14                 1.987985e-02 3 1  ON 13
ci_15                 6.472837e-03 3 1  ON 14
ci_16                 5.222647e-03 3 1  ON 15
ci_17                -6.218211e-03 3 1  ON 16
ci_18                -5.511413e-03 3 1  ON 17
ci_19                 9.178557e-03 3 1  ON 18
ci_20                 6.346322e-03 3 1  ON 19
ci_21                 9.276168e-03 3 1  ON 20
ci_22                 7.832473e-03 3 1  ON 21
ci_23                 5.124414e-03 3 1  ON 22
ci_24                 5.298867e-03 3 1  ON 23
ci_25                 2.922666e-03 3 1  ON 24
ci_26                 2.138993e-03 3 1  ON 25
ci_27                 3.011570e-03 3 1  ON 26
ci_28                 2.670454e-03 3 1  ON 27
ci_29                 6.256268e-04 3 1  ON 28
ci_30                -3.670726e-04 3 1  ON 29
ci_31                 5.097572e-05 3 1  ON 30
ci_32                -1.617847e-03 3 1  ON 31
ci_33                -8.626654e-04 3 1  ON 32
ci_34                 2.193063e-03 3 1  ON 33
ci_35                -2.092984e-04 3 1  ON 34
ci_36                -1.733065e-03 3 1  ON 35
ci_37                -1.076941e-03 3 1  ON 36
ci_38                -4.239144e-04 3 1  ON 37
ci_39                -6.567738e-04 3 1  ON 38
ci_40                -1.043613e-03 3 1  ON 39
ci_41                 2.252611e-04 3 1  ON 40
ci_42                 8.006396e-04 3 1  ON 41
ci_43                -2.503851e-03 3 1  ON 42
ci_44                -9.205028e-04 3 1  ON 43
ci_45                 4.241252e-04 3 1  ON 44
ci_46                -4.421922e-04 3 1  ON 45
ci_47                 1.989940e-03 3 1  ON 46
ci_48                 1.735855e-03 3 1  ON 47
ci_49                -5.498030e-04 3 1  ON 48
ci_50                -3.214833e-05 3 1  ON 49
ci_51                 8.654545e-05 3 1  ON 50
ci_52                 1.894979e-06 3 1  ON 51
ci_53                -7.242830e-04 3 1  ON 52
ci_54                -2.034141e-03 3 1  ON 53
ci_55                -2.736966e-03 3 1  ON 54
ci_56                 1.944091e-03 3 1  ON 55
ci_57                 2.573270e-03 3 1  ON 56
ci_58                -1.026641e-03 3 1  ON 57
ci_59                -9.510058e-04 3 1  ON 58
ci_60                 3.836204e-03 3 1  ON 59
ci_61                 2.843134e-04 3 1  ON 60
ci_62                 2.314776e-04 3 1  ON 61
ci_63                -9.604038e-04 3 1  ON 62
ci_64                 1.617279e-03 3 1  ON 63
ci_65                -4.194842e-04 3 1  ON 64
ci_66                 4.250785e-04 3 1  ON 65
ci_67                 1.687849e-04 3 1  ON 66
ci_68                -2.091900e-03 3 1  ON 67
ci_69                -1.662625e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2102e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.849
    reference variance = 0.513048
====================================================
  Execution time = 4.4142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8250e-01
  Total weights = 1.963913994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468692770512
                                         uncertainty =       0.002314329692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468692770512
                                         uncertainty =       0.002314329692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484097814
  error estimate for blocks of size 2^( 2) =       0.000505998292
  error estimate for blocks of size 2^( 3) =       0.000526428687
  error estimate for blocks of size 2^( 4) =       0.000541702912
  error estimate for blocks of size 2^( 5) =       0.000551642023
  error estimate for blocks of size 2^( 6) =       0.000559095968
  error estimate for blocks of size 2^( 7) =       0.000560444242

      target function =      -0.654518596278
              le_mean =     -22.818172654977
             les_mean =     521.151507265423
             stat err =       0.000553221286
             autocorr =       1.305964946415
   target nu stat err =       0.000553221286
   target dn stat err =       0.003110110017
      target stat err =       0.001276252635
              std dev =       0.684617694724
             le_variance =       0.468701387930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281817265498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-07, overlap shift 3.6380e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654520668242       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654725277429       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654754819652       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654764606209       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654773562468       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654774984487       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654777177904       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654777720409       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654777734495       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654777523106       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654777597559       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654777673869       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654777667045       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-07 is 3.781503e-03

solving harmonic davidson linear method for identity shift 1.4552e-06, overlap shift 1.4552e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654520668242       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654725272223       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654754813383       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654764599483       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654773555232       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654774977071       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654777170294       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654777712730       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654777726798       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654777515424       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654777589868       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654777666168       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654777659344       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-06 is 3.781281e-03

solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654520668242       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654725251403       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654754788314       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654764572580       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654773526290       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654774947410       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654777139862       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654777682020       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654777696013       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654777484702       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654777559108       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654777635368       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654777628545       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 3.780394e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1762e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_01                 1.131083e-01 3 1  ON 0
ci_02                -2.360542e-02 3 1  ON 1
ci_03                -2.385878e-02 3 1  ON 2
ci_04                 2.276243e-02 3 1  ON 3
ci_05                -2.148090e-02 3 1  ON 4
ci_06                -2.013558e-02 3 1  ON 5
ci_07                 2.458388e-02 3 1  ON 6
ci_08                -3.588223e-03 3 1  ON 7
ci_09                -6.316977e-03 3 1  ON 8
ci_10                -8.302506e-03 3 1  ON 9
ci_11                 1.339273e-02 3 1  ON 10
ci_12                 7.704949e-03 3 1  ON 11
ci_13                 1.168485e-02 3 1  ON 12
ci_14                 1.741713e-02 3 1  ON 13
ci_15                 7.246591e-03 3 1  ON 14
ci_16                 6.101057e-03 3 1  ON 15
ci_17                -7.909672e-03 3 1  ON 16
ci_18                -6.933148e-03 3 1  ON 17
ci_19                 8.393114e-03 3 1  ON 18
ci_20                 7.920266e-03 3 1  ON 19
ci_21                 9.044671e-03 3 1  ON 20
ci_22                 6.971381e-03 3 1  ON 21
ci_23                 4.849246e-03 3 1  ON 22
ci_24                 2.387306e-03 3 1  ON 23
ci_25                 2.800774e-03 3 1  ON 24
ci_26                 1.545753e-03 3 1  ON 25
ci_27                 1.763196e-03 3 1  ON 26
ci_28                 1.602128e-03 3 1  ON 27
ci_29                 1.571688e-03 3 1  ON 28
ci_30                 5.005821e-04 3 1  ON 29
ci_31                -2.189231e-04 3 1  ON 30
ci_32                -2.417818e-04 3 1  ON 31
ci_33                -8.686346e-04 3 1  ON 32
ci_34                 9.453876e-04 3 1  ON 33
ci_35                 2.423614e-03 3 1  ON 34
ci_36                -1.158727e-03 3 1  ON 35
ci_37                -2.492756e-04 3 1  ON 36
ci_38                -2.318096e-04 3 1  ON 37
ci_39                -4.582534e-04 3 1  ON 38
ci_40                -1.199864e-03 3 1  ON 39
ci_41                -4.599031e-04 3 1  ON 40
ci_42                 2.375822e-04 3 1  ON 41
ci_43                -7.262476e-04 3 1  ON 42
ci_44                -1.912557e-03 3 1  ON 43
ci_45                -1.318270e-03 3 1  ON 44
ci_46                 7.701008e-05 3 1  ON 45
ci_47                 1.663398e-03 3 1  ON 46
ci_48                 6.258375e-04 3 1  ON 47
ci_49                -1.122247e-03 3 1  ON 48
ci_50                -8.031920e-04 3 1  ON 49
ci_51                 1.404466e-03 3 1  ON 50
ci_52                 1.589806e-04 3 1  ON 51
ci_53                 2.752289e-05 3 1  ON 52
ci_54                -1.393322e-03 3 1  ON 53
ci_55                -4.031322e-04 3 1  ON 54
ci_56                 1.592204e-03 3 1  ON 55
ci_57                 2.045536e-03 3 1  ON 56
ci_58                -1.135337e-03 3 1  ON 57
ci_59                -9.938432e-04 3 1  ON 58
ci_60                 1.166812e-03 3 1  ON 59
ci_61                -3.496968e-03 3 1  ON 60
ci_62                -3.342273e-04 3 1  ON 61
ci_63                -3.439351e-04 3 1  ON 62
ci_64                -7.747914e-04 3 1  ON 63
ci_65                 9.011417e-04 3 1  ON 64
ci_66                -5.233380e-04 3 1  ON 65
ci_67                -2.664318e-04 3 1  ON 66
ci_68                -1.776137e-03 3 1  ON 67
ci_69                -2.396971e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.9421
    reference variance = 0.6568
====================================================
  Execution time = 4.2724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9045e-01
  Total weights = 1.9642e+06
  Execution time = 5.9126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.776378037876
                                         uncertainty =       0.278877806268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.776378037876
                                         uncertainty =       0.278877806268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000623117826
  error estimate for blocks of size 2^( 2) =       0.000640151393
  error estimate for blocks of size 2^( 3) =       0.000657123526
  error estimate for blocks of size 2^( 4) =       0.000669179027
  error estimate for blocks of size 2^( 5) =       0.000678984097
  error estimate for blocks of size 2^( 6) =       0.000680995545
  error estimate for blocks of size 2^( 7) =       0.000684219223

      target function =      -0.087323911262
              le_mean =     -22.819881860634
             les_mean =     528.366604894727
             stat err =       0.000678344473
             autocorr =       1.185114276276
   target nu stat err =       0.000678344473
   target dn stat err =       5.611720982814
      target stat err =       0.055773231233
              std dev =       0.881221681082
             le_variance =       0.776551651210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476443214502
                                         uncertainty =       0.003113699923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476443214502
                                         uncertainty =       0.003113699923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488118293
  error estimate for blocks of size 2^( 2) =       0.000509702206
  error estimate for blocks of size 2^( 3) =       0.000530702971
  error estimate for blocks of size 2^( 4) =       0.000545736908
  error estimate for blocks of size 2^( 5) =       0.000557395100
  error estimate for blocks of size 2^( 6) =       0.000561639208
  error estimate for blocks of size 2^( 7) =       0.000563231175

      target function =      -0.651689091353
              le_mean =     -22.819398796001
             les_mean =     521.215410679097
             stat err =       0.000557000598
             autocorr =       1.302150419655
   target nu stat err =       0.000557000598
   target dn stat err =       0.003385624463
      target stat err =       0.001372371709
              std dev =       0.690303509716
             le_variance =       0.476518935526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480847154233
                                         uncertainty =       0.003298883031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480847154233
                                         uncertainty =       0.003298883031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490363355
  error estimate for blocks of size 2^( 2) =       0.000511863983
  error estimate for blocks of size 2^( 3) =       0.000532859893
  error estimate for blocks of size 2^( 4) =       0.000547852568
  error estimate for blocks of size 2^( 5) =       0.000559405981
  error estimate for blocks of size 2^( 6) =       0.000563633263
  error estimate for blocks of size 2^( 7) =       0.000564810351

      target function =      -0.574348954215
              le_mean =     -22.819543003666
             les_mean =     521.430838002003
             stat err =       0.000558925541
             autocorr =       1.299187684228
   target nu stat err =       0.000558925541
   target dn stat err =       0.164597106021
      target stat err =       0.050644823794
              std dev =       0.693478507680
             le_variance =       0.480912440614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476443097796
                                         uncertainty =       0.003113698828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476443097796
                                         uncertainty =       0.003113698828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488118234
  error estimate for blocks of size 2^( 2) =       0.000509702149
  error estimate for blocks of size 2^( 3) =       0.000530702913
  error estimate for blocks of size 2^( 4) =       0.000545736851
  error estimate for blocks of size 2^( 5) =       0.000557395054
  error estimate for blocks of size 2^( 6) =       0.000561639160
  error estimate for blocks of size 2^( 7) =       0.000563231129

      target function =      -0.651689206894
              le_mean =     -22.819398795475
             les_mean =     521.215410360813
             stat err =       0.000557000548
             autocorr =       1.302150503640
   target nu stat err =       0.000557000548
   target dn stat err =       0.003385618209
      target stat err =       0.001372369790
              std dev =       0.690303426190
             le_variance =       0.476518820210


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.087323911262        initial
     3.6380e-07     3.6380e-06             3.7815e-03        -0.651689091353
     1.4552e-06     1.4552e-05             3.7813e-03        -0.574348954215
     5.8208e-06     5.8208e-05             3.7804e-03        -0.651689206894  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e-06     and shift_s =   5.8208e-05
*****************************************************************************

  Execution time = 7.2392e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_01                 1.131078e-01 3 1  ON 0
ci_02                -2.360562e-02 3 1  ON 1
ci_03                -2.385893e-02 3 1  ON 2
ci_04                 2.276219e-02 3 1  ON 3
ci_05                -2.148077e-02 3 1  ON 4
ci_06                -2.013579e-02 3 1  ON 5
ci_07                 2.458392e-02 3 1  ON 6
ci_08                -3.588282e-03 3 1  ON 7
ci_09                -6.317062e-03 3 1  ON 8
ci_10                -8.302599e-03 3 1  ON 9
ci_11                 1.339255e-02 3 1  ON 10
ci_12                 7.704858e-03 3 1  ON 11
ci_13                 1.168537e-02 3 1  ON 12
ci_14                 1.741786e-02 3 1  ON 13
ci_15                 7.246495e-03 3 1  ON 14
ci_16                 6.100944e-03 3 1  ON 15
ci_17                -7.909469e-03 3 1  ON 16
ci_18                -6.932993e-03 3 1  ON 17
ci_19                 8.393186e-03 3 1  ON 18
ci_20                 7.920086e-03 3 1  ON 19
ci_21                 9.044743e-03 3 1  ON 20
ci_22                 6.971556e-03 3 1  ON 21
ci_23                 4.849272e-03 3 1  ON 22
ci_24                 2.387777e-03 3 1  ON 23
ci_25                 2.800783e-03 3 1  ON 24
ci_26                 1.545819e-03 3 1  ON 25
ci_27                 1.763337e-03 3 1  ON 26
ci_28                 1.602250e-03 3 1  ON 27
ci_29                 1.571578e-03 3 1  ON 28
ci_30                 5.004803e-04 3 1  ON 29
ci_31                -2.188388e-04 3 1  ON 30
ci_32                -2.419232e-04 3 1  ON 31
ci_33                -8.686407e-04 3 1  ON 32
ci_34                 9.455248e-04 3 1  ON 33
ci_35                 2.423294e-03 3 1  ON 34
ci_36                -1.158779e-03 3 1  ON 35
ci_37                -2.493535e-04 3 1  ON 36
ci_38                -2.318238e-04 3 1  ON 37
ci_39                -4.582667e-04 3 1  ON 38
ci_40                -1.199845e-03 3 1  ON 39
ci_41                -4.598372e-04 3 1  ON 40
ci_42                 2.376357e-04 3 1  ON 41
ci_43                -7.264614e-04 3 1  ON 42
ci_44                -1.912442e-03 3 1  ON 43
ci_45                -1.318091e-03 3 1  ON 44
ci_46                 7.695785e-05 3 1  ON 45
ci_47                 1.663458e-03 3 1  ON 46
ci_48                 6.260060e-04 3 1  ON 47
ci_49                -1.122193e-03 3 1  ON 48
ci_50                -8.031273e-04 3 1  ON 49
ci_51                 1.404337e-03 3 1  ON 50
ci_52                 1.589708e-04 3 1  ON 51
ci_53                 2.745540e-05 3 1  ON 52
ci_54                -1.393408e-03 3 1  ON 53
ci_55                -4.034119e-04 3 1  ON 54
ci_56                 1.592236e-03 3 1  ON 55
ci_57                 2.045586e-03 3 1  ON 56
ci_58                -1.135337e-03 3 1  ON 57
ci_59                -9.938501e-04 3 1  ON 58
ci_60                 1.167454e-03 3 1  ON 59
ci_61                -3.496081e-03 3 1  ON 60
ci_62                -3.341755e-04 3 1  ON 61
ci_63                -3.439964e-04 3 1  ON 62
ci_64                -7.745400e-04 3 1  ON 63
ci_65                 9.010036e-04 3 1  ON 64
ci_66                -5.232441e-04 3 1  ON 65
ci_67                -2.664002e-04 3 1  ON 66
ci_68                -1.776168e-03 3 1  ON 67
ci_69                -2.396722e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2416e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7568
    reference variance = 0.414887
====================================================
  Execution time = 4.2517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8024e-01
  Total weights = 1.964061719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468002103662
                                         uncertainty =       0.001908281222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468002103662
                                         uncertainty =       0.001908281222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483719644
  error estimate for blocks of size 2^( 2) =       0.000505252667
  error estimate for blocks of size 2^( 3) =       0.000526370402
  error estimate for blocks of size 2^( 4) =       0.000541903326
  error estimate for blocks of size 2^( 5) =       0.000551665108
  error estimate for blocks of size 2^( 6) =       0.000558070635
  error estimate for blocks of size 2^( 7) =       0.000560425623

      target function =      -0.655529439824
              le_mean =     -22.818617666213
             les_mean =     521.169553121632
             stat err =       0.000553016173
             autocorr =       1.307038004709
   target nu stat err =       0.000553016173
   target dn stat err =       0.002548565535
      target stat err =       0.001066791312
              std dev =       0.684082880947
             le_variance =       0.467969388005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281861766621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-06, overlap shift 1.4552e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655530752577       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655698688602       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655725694981       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655734619040       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655740140691       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655741646704       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655743333051       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655743449296       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655743616098       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655743608927       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655743774077       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655743775017       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-06 is 5.436221e-03

solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655530752577       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655698671473       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655725673850       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655734596010       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655740116337       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655741621721       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655743307490       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655743423647       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655743590376       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655743583200       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655743748279       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655743749214       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 5.435149e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655530752577       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655698602992       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655725589371       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655734503942       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655740018977       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655741521851       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655743205311       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655743321116       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655743487555       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655743480361       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655743645152       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655743646070       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 5.430865e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0153e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_01                 1.076726e-01 3 1  ON 0
ci_02                -2.439945e-02 3 1  ON 1
ci_03                -2.477592e-02 3 1  ON 2
ci_04                 2.075653e-02 3 1  ON 3
ci_05                -1.913847e-02 3 1  ON 4
ci_06                -2.178751e-02 3 1  ON 5
ci_07                 2.686804e-02 3 1  ON 6
ci_08                -4.766345e-03 3 1  ON 7
ci_09                -7.018118e-03 3 1  ON 8
ci_10                -7.121176e-03 3 1  ON 9
ci_11                 1.163365e-02 3 1  ON 10
ci_12                 6.890059e-03 3 1  ON 11
ci_13                 1.280903e-02 3 1  ON 12
ci_14                 1.618263e-02 3 1  ON 13
ci_15                 7.377414e-03 3 1  ON 14
ci_16                 6.431960e-03 3 1  ON 15
ci_17                -5.810968e-03 3 1  ON 16
ci_18                -5.870425e-03 3 1  ON 17
ci_19                 9.199444e-03 3 1  ON 18
ci_20                 8.280975e-03 3 1  ON 19
ci_21                 8.994831e-03 3 1  ON 20
ci_22                 8.872478e-03 3 1  ON 21
ci_23                 4.852039e-03 3 1  ON 22
ci_24                 6.315801e-03 3 1  ON 23
ci_25                 2.560773e-03 3 1  ON 24
ci_26                 3.498685e-03 3 1  ON 25
ci_27                 2.252614e-03 3 1  ON 26
ci_28                 6.504196e-04 3 1  ON 27
ci_29                 2.148485e-03 3 1  ON 28
ci_30                -6.105038e-04 3 1  ON 29
ci_31                -5.778628e-04 3 1  ON 30
ci_32                -1.632986e-03 3 1  ON 31
ci_33                -9.340894e-04 3 1  ON 32
ci_34                 5.206805e-04 3 1  ON 33
ci_35                 9.435151e-04 3 1  ON 34
ci_36                -5.218740e-04 3 1  ON 35
ci_37                -5.903705e-04 3 1  ON 36
ci_38                -4.919655e-04 3 1  ON 37
ci_39                 3.474280e-04 3 1  ON 38
ci_40                -1.700170e-03 3 1  ON 39
ci_41                -1.406051e-03 3 1  ON 40
ci_42                -1.657823e-03 3 1  ON 41
ci_43                -1.734887e-03 3 1  ON 42
ci_44                -6.759089e-04 3 1  ON 43
ci_45                -8.622067e-05 3 1  ON 44
ci_46                -2.007922e-05 3 1  ON 45
ci_47                 1.009664e-03 3 1  ON 46
ci_48                 1.288141e-03 3 1  ON 47
ci_49                -5.980083e-04 3 1  ON 48
ci_50                -5.838880e-04 3 1  ON 49
ci_51                -5.079957e-04 3 1  ON 50
ci_52                 5.007464e-04 3 1  ON 51
ci_53                -1.913742e-04 3 1  ON 52
ci_54                -1.104097e-03 3 1  ON 53
ci_55                -4.595979e-04 3 1  ON 54
ci_56                 2.900308e-03 3 1  ON 55
ci_57                 1.457692e-03 3 1  ON 56
ci_58                -2.946075e-04 3 1  ON 57
ci_59                -6.356157e-04 3 1  ON 58
ci_60                 5.596881e-04 3 1  ON 59
ci_61                -1.504937e-03 3 1  ON 60
ci_62                -3.691012e-04 3 1  ON 61
ci_63                 1.715312e-04 3 1  ON 62
ci_64                 1.363060e-04 3 1  ON 63
ci_65                -8.152795e-04 3 1  ON 64
ci_66                -1.957369e-04 3 1  ON 65
ci_67                -8.539157e-04 3 1  ON 66
ci_68                -8.454691e-04 3 1  ON 67
ci_69                -2.233204e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.678
    reference variance = 0.554216
====================================================
  Execution time = 4.1345e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8600e-01
  Total weights = 1.9644e+06
  Execution time = 5.9129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000632314
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551731914099
                                         uncertainty =       0.053830048750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.551731914099
                                         uncertainty =       0.053830048750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525314440
  error estimate for blocks of size 2^( 2) =       0.000545458390
  error estimate for blocks of size 2^( 3) =       0.000564116768
  error estimate for blocks of size 2^( 4) =       0.000579087061
  error estimate for blocks of size 2^( 5) =       0.000588615255
  error estimate for blocks of size 2^( 6) =       0.000592929733
  error estimate for blocks of size 2^( 7) =       0.000591926994

      target function =      -0.328317437161
              le_mean =     -22.818790761010
             les_mean =     522.599043174573
             stat err =       0.000588139761
             autocorr =       1.253494414986
   target nu stat err =       0.000588139761
   target dn stat err =       0.826909804949
      target stat err =       0.088408721279
              std dev =       0.742906805458
             le_variance =       0.551910521596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466386356820
                                         uncertainty =       0.002309099609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466386356820
                                         uncertainty =       0.002309099609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482974199
  error estimate for blocks of size 2^( 2) =       0.000504774680
  error estimate for blocks of size 2^( 3) =       0.000525035321
  error estimate for blocks of size 2^( 4) =       0.000541178481
  error estimate for blocks of size 2^( 5) =       0.000551764189
  error estimate for blocks of size 2^( 6) =       0.000556439308
  error estimate for blocks of size 2^( 7) =       0.000555653030

      target function =      -0.653309643706
              le_mean =     -22.818901149539
             les_mean =     521.188258264334
             stat err =       0.000551258752
             autocorr =       1.302756152658
   target nu stat err =       0.000551258752
   target dn stat err =       0.005816007781
      target stat err =       0.002320203143
              std dev =       0.683028663137
             le_variance =       0.466528154667

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000625768
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.886127227951
                                         uncertainty =       0.415345856510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.886127227951
                                         uncertainty =       0.415345856510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000665236223
  error estimate for blocks of size 2^( 2) =       0.000681378148
  error estimate for blocks of size 2^( 3) =       0.000697017447
  error estimate for blocks of size 2^( 4) =       0.000709369479
  error estimate for blocks of size 2^( 5) =       0.000717989986
  error estimate for blocks of size 2^( 6) =       0.000722653239
  error estimate for blocks of size 2^( 7) =       0.000718441717

      target function =      -0.080382501509
              le_mean =     -22.819519600646
             les_mean =     527.804700311726
             stat err =       0.000717113605
             autocorr =       1.162048208582
   target nu stat err =       0.000717113605
   target dn stat err =       6.547734243072
      target stat err =       0.063861312424
              std dev =       0.940786089103
             le_variance =       0.885078465451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466386285556
                                         uncertainty =       0.002309111882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466386285556
                                         uncertainty =       0.002309111882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482974162
  error estimate for blocks of size 2^( 2) =       0.000504774601
  error estimate for blocks of size 2^( 3) =       0.000525035183
  error estimate for blocks of size 2^( 4) =       0.000541178297
  error estimate for blocks of size 2^( 5) =       0.000551763983
  error estimate for blocks of size 2^( 6) =       0.000556439119
  error estimate for blocks of size 2^( 7) =       0.000555652895

      target function =      -0.653310582585
              le_mean =     -22.818901156527
             les_mean =     521.188256615112
             stat err =       0.000551258573
             autocorr =       1.302755509944
   target nu stat err =       0.000551258573
   target dn stat err =       0.005757857173
      target stat err =       0.002297491449
              std dev =       0.683028609815
             le_variance =       0.466528081826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.328317437161        initial
     1.4552e-06     1.4552e-05             5.4362e-03        -0.653309643706
     5.8208e-06     5.8208e-05             5.4351e-03        -0.080382501509
     2.3283e-05     2.3283e-04             5.4309e-03        -0.653310582585  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e-05     and shift_s =   2.3283e-04
*****************************************************************************

  Execution time = 7.1004e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_01                 1.076769e-01 3 1  ON 0
ci_02                -2.439888e-02 3 1  ON 1
ci_03                -2.477539e-02 3 1  ON 2
ci_04                 2.075741e-02 3 1  ON 3
ci_05                -1.913952e-02 3 1  ON 4
ci_06                -2.178664e-02 3 1  ON 5
ci_07                 2.686667e-02 3 1  ON 6
ci_08                -4.765945e-03 3 1  ON 7
ci_09                -7.017786e-03 3 1  ON 8
ci_10                -7.121821e-03 3 1  ON 9
ci_11                 1.163472e-02 3 1  ON 10
ci_12                 6.890367e-03 3 1  ON 11
ci_13                 1.280823e-02 3 1  ON 12
ci_14                 1.618375e-02 3 1  ON 13
ci_15                 7.377383e-03 3 1  ON 14
ci_16                 6.431819e-03 3 1  ON 15
ci_17                -5.812003e-03 3 1  ON 16
ci_18                -5.870855e-03 3 1  ON 17
ci_19                 9.199134e-03 3 1  ON 18
ci_20                 8.280804e-03 3 1  ON 19
ci_21                 8.994736e-03 3 1  ON 20
ci_22                 8.871179e-03 3 1  ON 21
ci_23                 4.852053e-03 3 1  ON 22
ci_24                 6.313213e-03 3 1  ON 23
ci_25                 2.560879e-03 3 1  ON 24
ci_26                 3.497743e-03 3 1  ON 25
ci_27                 2.252387e-03 3 1  ON 26
ci_28                 6.508821e-04 3 1  ON 27
ci_29                 2.148247e-03 3 1  ON 28
ci_30                -6.097967e-04 3 1  ON 29
ci_31                -5.774855e-04 3 1  ON 30
ci_32                -1.632406e-03 3 1  ON 31
ci_33                -9.340616e-04 3 1  ON 32
ci_34                 5.209318e-04 3 1  ON 33
ci_35                 9.442623e-04 3 1  ON 34
ci_36                -5.221110e-04 3 1  ON 35
ci_37                -5.902025e-04 3 1  ON 36
ci_38                -4.918504e-04 3 1  ON 37
ci_39                 3.470928e-04 3 1  ON 38
ci_40                -1.700016e-03 3 1  ON 39
ci_41                -1.405692e-03 3 1  ON 40
ci_42                -1.657027e-03 3 1  ON 41
ci_43                -1.734443e-03 3 1  ON 42
ci_44                -6.764640e-04 3 1  ON 43
ci_45                -8.673503e-05 3 1  ON 44
ci_46                -2.003961e-05 3 1  ON 45
ci_47                 1.010051e-03 3 1  ON 46
ci_48                 1.287717e-03 3 1  ON 47
ci_49                -5.982346e-04 3 1  ON 48
ci_50                -5.839632e-04 3 1  ON 49
ci_51                -5.071995e-04 3 1  ON 50
ci_52                 5.006237e-04 3 1  ON 51
ci_53                -1.913154e-04 3 1  ON 52
ci_54                -1.104272e-03 3 1  ON 53
ci_55                -4.596152e-04 3 1  ON 54
ci_56                 2.899797e-03 3 1  ON 55
ci_57                 1.457943e-03 3 1  ON 56
ci_58                -2.949843e-04 3 1  ON 57
ci_59                -6.357438e-04 3 1  ON 58
ci_60                 5.602599e-04 3 1  ON 59
ci_61                -1.506580e-03 3 1  ON 60
ci_62                -3.690839e-04 3 1  ON 61
ci_63                 1.713487e-04 3 1  ON 62
ci_64                 1.359293e-04 3 1  ON 63
ci_65                -8.145604e-04 3 1  ON 64
ci_66                -1.958760e-04 3 1  ON 65
ci_67                -8.536485e-04 3 1  ON 66
ci_68                -8.459246e-04 3 1  ON 67
ci_69                -2.233291e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8071
    reference variance = 0.363585
====================================================
  Execution time = 4.2469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8459e-01
  Total weights = 1.963851466e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468919461645
                                         uncertainty =       0.002368050420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468919461645
                                         uncertainty =       0.002368050420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484176499
  error estimate for blocks of size 2^( 2) =       0.000505983539
  error estimate for blocks of size 2^( 3) =       0.000527240134
  error estimate for blocks of size 2^( 4) =       0.000542037314
  error estimate for blocks of size 2^( 5) =       0.000552273795
  error estimate for blocks of size 2^( 6) =       0.000556937837
  error estimate for blocks of size 2^( 7) =       0.000560045976

      target function =      -0.653851886276
              le_mean =     -22.818797565898
             les_mean =     521.182107762080
             stat err =       0.000552823731
             autocorr =       1.303664813515
   target nu stat err =       0.000552823731
   target dn stat err =       0.003082919238
      target stat err =       0.001264044333
              std dev =       0.684728970879
             le_variance =       0.468853763560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281879756590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653853903823       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654019672574       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654048870561       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654059869498       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654066216876       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654067431639       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654070422577       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654070973240       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654071257070       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654071824340       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654071890746       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654071886912       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 4.278125e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653853903823       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654019604811       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654048785904       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654059776991       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654066118724       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654067331395       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654070319206       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654070868922       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654071152269       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654071718456       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654071784651       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654071780768       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 4.274374e-03

solving harmonic davidson linear method for identity shift 9.3132e-05, overlap shift 9.3132e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653853903823       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654019334311       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654048448009       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654059407799       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654065727043       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654066931387       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654069906749       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654070452696       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654070734125       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654071296008       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654071361373       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654071357292       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-05 is 4.259440e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0064e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_01                 1.083990e-01 3 1  ON 0
ci_02                -2.266971e-02 3 1  ON 1
ci_03                -2.546378e-02 3 1  ON 2
ci_04                 2.111753e-02 3 1  ON 3
ci_05                -2.080451e-02 3 1  ON 4
ci_06                -2.013523e-02 3 1  ON 5
ci_07                 2.644974e-02 3 1  ON 6
ci_08                -4.169756e-03 3 1  ON 7
ci_09                -7.093695e-03 3 1  ON 8
ci_10                -7.351316e-03 3 1  ON 9
ci_11                 1.357891e-02 3 1  ON 10
ci_12                 8.464082e-03 3 1  ON 11
ci_13                 1.185695e-02 3 1  ON 12
ci_14                 1.190938e-02 3 1  ON 13
ci_15                 7.622102e-03 3 1  ON 14
ci_16                 5.951073e-03 3 1  ON 15
ci_17                -6.988753e-03 3 1  ON 16
ci_18                -5.473337e-03 3 1  ON 17
ci_19                 9.029785e-03 3 1  ON 18
ci_20                 8.480658e-03 3 1  ON 19
ci_21                 7.546847e-03 3 1  ON 20
ci_22                 7.611274e-03 3 1  ON 21
ci_23                 4.414879e-03 3 1  ON 22
ci_24                 2.465521e-03 3 1  ON 23
ci_25                 2.087204e-03 3 1  ON 24
ci_26                 3.782313e-03 3 1  ON 25
ci_27                 3.378108e-03 3 1  ON 26
ci_28                 2.023017e-03 3 1  ON 27
ci_29                 1.111549e-03 3 1  ON 28
ci_30                -1.222586e-03 3 1  ON 29
ci_31                -1.195180e-03 3 1  ON 30
ci_32                 2.315310e-04 3 1  ON 31
ci_33                 1.889000e-04 3 1  ON 32
ci_34                 2.049915e-03 3 1  ON 33
ci_35                 1.109202e-03 3 1  ON 34
ci_36                -1.240781e-03 3 1  ON 35
ci_37                -4.763065e-04 3 1  ON 36
ci_38                -1.392987e-04 3 1  ON 37
ci_39                 2.811557e-05 3 1  ON 38
ci_40                -1.194138e-03 3 1  ON 39
ci_41                -2.916480e-04 3 1  ON 40
ci_42                -3.338601e-04 3 1  ON 41
ci_43                -1.756612e-03 3 1  ON 42
ci_44                -5.204729e-05 3 1  ON 43
ci_45                 9.728332e-04 3 1  ON 44
ci_46                -2.477251e-04 3 1  ON 45
ci_47                 1.471002e-03 3 1  ON 46
ci_48                 1.252816e-03 3 1  ON 47
ci_49                 3.374763e-05 3 1  ON 48
ci_50                -7.606540e-04 3 1  ON 49
ci_51                 4.873586e-04 3 1  ON 50
ci_52                 2.532567e-04 3 1  ON 51
ci_53                -5.765400e-04 3 1  ON 52
ci_54                -6.784936e-06 3 1  ON 53
ci_55                 2.830558e-05 3 1  ON 54
ci_56                 2.081965e-03 3 1  ON 55
ci_57                 1.639369e-03 3 1  ON 56
ci_58                -1.369752e-03 3 1  ON 57
ci_59                -2.171937e-05 3 1  ON 58
ci_60                 8.115951e-04 3 1  ON 59
ci_61                -4.878500e-04 3 1  ON 60
ci_62                -6.606873e-04 3 1  ON 61
ci_63                -5.160764e-04 3 1  ON 62
ci_64                -1.263094e-04 3 1  ON 63
ci_65                -1.384208e-03 3 1  ON 64
ci_66                -1.601053e-03 3 1  ON 65
ci_67                -1.860712e-04 3 1  ON 66
ci_68                -2.709200e-03 3 1  ON 67
ci_69                -1.024819e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7728
    reference variance = 0.680382
====================================================
  Execution time = 4.3476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8732e-01
  Total weights = 1.9640e+06
  Execution time = 5.9763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472942820028
                                         uncertainty =       0.002578326853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472942820028
                                         uncertainty =       0.002578326853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486268034
  error estimate for blocks of size 2^( 2) =       0.000508159676
  error estimate for blocks of size 2^( 3) =       0.000529330264
  error estimate for blocks of size 2^( 4) =       0.000545234549
  error estimate for blocks of size 2^( 5) =       0.000555465202
  error estimate for blocks of size 2^( 6) =       0.000558974913
  error estimate for blocks of size 2^( 7) =       0.000562214284

      target function =      -0.607484989331
              le_mean =     -22.819692405770
             les_mean =     521.345576692288
             stat err =       0.000555472237
             autocorr =       1.304888107578
   target nu stat err =       0.000555472237
   target dn stat err =       0.084786335494
      target stat err =       0.029031165581
              std dev =       0.687686848289
             le_variance =       0.472913201309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471793687446
                                         uncertainty =       0.002542935186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471793687446
                                         uncertainty =       0.002542935186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485678011
  error estimate for blocks of size 2^( 2) =       0.000507601618
  error estimate for blocks of size 2^( 3) =       0.000528783426
  error estimate for blocks of size 2^( 4) =       0.000544718198
  error estimate for blocks of size 2^( 5) =       0.000554981006
  error estimate for blocks of size 2^( 6) =       0.000558436876
  error estimate for blocks of size 2^( 7) =       0.000561612343

      target function =      -0.652975381872
              le_mean =     -22.819616799195
             les_mean =     521.222231869184
             stat err =       0.000554937106
             autocorr =       1.305541395275
   target nu stat err =       0.000554937106
   target dn stat err =       0.003145057385
      target stat err =       0.001285728951
              std dev =       0.686852430317
             le_variance =       0.471766261032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477199646418
                                         uncertainty =       0.002820805250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477199646418
                                         uncertainty =       0.002820805250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488448550
  error estimate for blocks of size 2^( 2) =       0.000510278988
  error estimate for blocks of size 2^( 3) =       0.000531356307
  error estimate for blocks of size 2^( 4) =       0.000547247752
  error estimate for blocks of size 2^( 5) =       0.000557444617
  error estimate for blocks of size 2^( 6) =       0.000560747492
  error estimate for blocks of size 2^( 7) =       0.000564064687

      target function =      -0.549117973471
              le_mean =     -22.819837827321
             les_mean =     521.534975400408
             stat err =       0.000557376137
             autocorr =       1.302144236062
   target nu stat err =       0.000557376137
   target dn stat err =       0.142409062782
      target stat err =       0.039965376511
              std dev =       0.690770564188
             le_variance =       0.477163972349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471791837162
                                         uncertainty =       0.002542954622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471791837162
                                         uncertainty =       0.002542954622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485677059
  error estimate for blocks of size 2^( 2) =       0.000507600683
  error estimate for blocks of size 2^( 3) =       0.000528782523
  error estimate for blocks of size 2^( 4) =       0.000544717283
  error estimate for blocks of size 2^( 5) =       0.000554980014
  error estimate for blocks of size 2^( 6) =       0.000558435896
  error estimate for blocks of size 2^( 7) =       0.000561611284

      target function =      -0.652968599305
              le_mean =     -22.819616780242
             les_mean =     521.222248176882
             stat err =       0.000554936119
             autocorr =       1.305541871956
   target nu stat err =       0.000554936119
   target dn stat err =       0.003145492004
      target stat err =       0.001285868556
              std dev =       0.686851083868
             le_variance =       0.471764411410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.607484989331        initial
     5.8208e-06     5.8208e-05             4.2781e-03        -0.652975381872  <--
     2.3283e-05     2.3283e-04             4.2744e-03        -0.549117973471
     9.3132e-05     9.3132e-04             4.2594e-03        -0.652968599305

*****************************************************************************
Applying the update for shift_i =   5.8208e-06     and shift_s =   5.8208e-05
*****************************************************************************

  Execution time = 7.3541e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_01                 1.083995e-01 3 1  ON 0
ci_02                -2.266889e-02 3 1  ON 1
ci_03                -2.546400e-02 3 1  ON 2
ci_04                 2.111778e-02 3 1  ON 3
ci_05                -2.080534e-02 3 1  ON 4
ci_06                -2.013440e-02 3 1  ON 5
ci_07                 2.644954e-02 3 1  ON 6
ci_08                -4.169528e-03 3 1  ON 7
ci_09                -7.093738e-03 3 1  ON 8
ci_10                -7.351436e-03 3 1  ON 9
ci_11                 1.357999e-02 3 1  ON 10
ci_12                 8.464759e-03 3 1  ON 11
ci_13                 1.185615e-02 3 1  ON 12
ci_14                 1.190563e-02 3 1  ON 13
ci_15                 7.622178e-03 3 1  ON 14
ci_16                 5.950860e-03 3 1  ON 15
ci_17                -6.989331e-03 3 1  ON 16
ci_18                -5.473086e-03 3 1  ON 17
ci_19                 9.029744e-03 3 1  ON 18
ci_20                 8.480746e-03 3 1  ON 19
ci_21                 7.545852e-03 3 1  ON 20
ci_22                 7.610466e-03 3 1  ON 21
ci_23                 4.414715e-03 3 1  ON 22
ci_24                 2.463151e-03 3 1  ON 23
ci_25                 2.087023e-03 3 1  ON 24
ci_26                 3.782432e-03 3 1  ON 25
ci_27                 3.378607e-03 3 1  ON 26
ci_28                 2.023713e-03 3 1  ON 27
ci_29                 1.111026e-03 3 1  ON 28
ci_30                -1.222883e-03 3 1  ON 29
ci_31                -1.195541e-03 3 1  ON 30
ci_32                 2.323406e-04 3 1  ON 31
ci_33                 1.893390e-04 3 1  ON 32
ci_34                 2.050712e-03 3 1  ON 33
ci_35                 1.109316e-03 3 1  ON 34
ci_36                -1.241055e-03 3 1  ON 35
ci_37                -4.763075e-04 3 1  ON 36
ci_38                -1.391429e-04 3 1  ON 37
ci_39                 2.795981e-05 3 1  ON 38
ci_40                -1.193980e-03 3 1  ON 39
ci_41                -2.912067e-04 3 1  ON 40
ci_42                -3.333209e-04 3 1  ON 41
ci_43                -1.756631e-03 3 1  ON 42
ci_44                -5.170753e-05 3 1  ON 43
ci_45                 9.732541e-04 3 1  ON 44
ci_46                -2.477981e-04 3 1  ON 45
ci_47                 1.471189e-03 3 1  ON 46
ci_48                 1.252751e-03 3 1  ON 47
ci_49                 3.401982e-05 3 1  ON 48
ci_50                -7.606732e-04 3 1  ON 49
ci_51                 4.877625e-04 3 1  ON 50
ci_52                 2.531430e-04 3 1  ON 51
ci_53                -5.766843e-04 3 1  ON 52
ci_54                -6.161798e-06 3 1  ON 53
ci_55                 2.866864e-05 3 1  ON 54
ci_56                 2.081646e-03 3 1  ON 55
ci_57                 1.639460e-03 3 1  ON 56
ci_58                -1.370250e-03 3 1  ON 57
ci_59                -2.148758e-05 3 1  ON 58
ci_60                 8.117489e-04 3 1  ON 59
ci_61                -4.871648e-04 3 1  ON 60
ci_62                -6.607963e-04 3 1  ON 61
ci_63                -5.163357e-04 3 1  ON 62
ci_64                -1.264690e-04 3 1  ON 63
ci_65                -1.384425e-03 3 1  ON 64
ci_66                -1.601658e-03 3 1  ON 65
ci_67                -1.857819e-04 3 1  ON 66
ci_68                -2.710061e-03 3 1  ON 67
ci_69                -1.024216e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2361e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.9073
    reference variance = 0.532937
====================================================
  Execution time = 4.4079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8704e-01
  Total weights = 1.964247940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471741452744
                                         uncertainty =       0.002843377265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471741452744
                                         uncertainty =       0.002843377265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485664804
  error estimate for blocks of size 2^( 2) =       0.000507619830
  error estimate for blocks of size 2^( 3) =       0.000528313393
  error estimate for blocks of size 2^( 4) =       0.000543493186
  error estimate for blocks of size 2^( 5) =       0.000553485652
  error estimate for blocks of size 2^( 6) =       0.000559175905
  error estimate for blocks of size 2^( 7) =       0.000564342804

      target function =      -0.652822896433
              le_mean =     -22.818564579054
             les_mean =     521.173931509454
             stat err =       0.000555124387
             autocorr =       1.306493789831
   target nu stat err =       0.000555124387
   target dn stat err =       0.003751164503
      target stat err =       0.001515792151
              std dev =       0.686833752780
             le_variance =       0.471740603958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281856457905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-06, overlap shift 1.4552e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652826005434       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653031686406       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653070013314       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653079010637       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653081547380       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653083796710       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653083214240       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653083332470       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653083369698       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653083192201       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653083165807       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653083182238       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-06 is 3.421290e-03

solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652826005434       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653031665964       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653069987555       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653078983138       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653081519214       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653083767927       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653083185532       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653083303712       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653083340919       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653083163480       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653083137105       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653083153530       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 3.420880e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652826005434       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653031584237       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653069884571       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653078873204       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653081406609       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653083652863       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653083070764       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653083188745       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653083225870       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653083048664       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653083022367       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653083038765       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 3.419242e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1735e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_01                 1.103850e-01 3 1  ON 0
ci_02                -2.457221e-02 3 1  ON 1
ci_03                -2.466310e-02 3 1  ON 2
ci_04                 2.212270e-02 3 1  ON 3
ci_05                -2.010353e-02 3 1  ON 4
ci_06                -1.835059e-02 3 1  ON 5
ci_07                 2.575933e-02 3 1  ON 6
ci_08                -4.788466e-03 3 1  ON 7
ci_09                -7.635374e-03 3 1  ON 8
ci_10                -9.418968e-03 3 1  ON 9
ci_11                 1.322549e-02 3 1  ON 10
ci_12                 6.963201e-03 3 1  ON 11
ci_13                 1.098087e-02 3 1  ON 12
ci_14                 1.330690e-02 3 1  ON 13
ci_15                 6.366314e-03 3 1  ON 14
ci_16                 5.304089e-03 3 1  ON 15
ci_17                -5.413927e-03 3 1  ON 16
ci_18                -6.956345e-03 3 1  ON 17
ci_19                 8.495105e-03 3 1  ON 18
ci_20                 8.388403e-03 3 1  ON 19
ci_21                 5.532207e-03 3 1  ON 20
ci_22                 9.585942e-03 3 1  ON 21
ci_23                 4.631952e-03 3 1  ON 22
ci_24                 5.815078e-03 3 1  ON 23
ci_25                 3.345647e-03 3 1  ON 24
ci_26                 3.615516e-04 3 1  ON 25
ci_27                 4.189924e-03 3 1  ON 26
ci_28                 1.500082e-03 3 1  ON 27
ci_29                 2.839166e-04 3 1  ON 28
ci_30                -4.607312e-04 3 1  ON 29
ci_31                -1.698242e-03 3 1  ON 30
ci_32                -1.475305e-03 3 1  ON 31
ci_33                -9.715869e-04 3 1  ON 32
ci_34                 7.892851e-04 3 1  ON 33
ci_35                 3.912251e-04 3 1  ON 34
ci_36                -1.220204e-03 3 1  ON 35
ci_37                -1.456152e-03 3 1  ON 36
ci_38                -9.062429e-04 3 1  ON 37
ci_39                -6.094460e-04 3 1  ON 38
ci_40                -1.146261e-03 3 1  ON 39
ci_41                -1.166431e-03 3 1  ON 40
ci_42                -1.488192e-05 3 1  ON 41
ci_43                -2.745961e-03 3 1  ON 42
ci_44                -1.435020e-03 3 1  ON 43
ci_45                -1.628034e-04 3 1  ON 44
ci_46                 3.087854e-04 3 1  ON 45
ci_47                 2.407625e-04 3 1  ON 46
ci_48                 7.759776e-04 3 1  ON 47
ci_49                -7.978214e-04 3 1  ON 48
ci_50                 3.765067e-04 3 1  ON 49
ci_51                 5.194168e-04 3 1  ON 50
ci_52                -4.161910e-04 3 1  ON 51
ci_53                -4.923352e-04 3 1  ON 52
ci_54                -1.515648e-03 3 1  ON 53
ci_55                 3.643093e-04 3 1  ON 54
ci_56                 2.971919e-03 3 1  ON 55
ci_57                 2.055525e-03 3 1  ON 56
ci_58                -1.600195e-03 3 1  ON 57
ci_59                -3.179995e-04 3 1  ON 58
ci_60                -2.424861e-05 3 1  ON 59
ci_61                -8.649124e-04 3 1  ON 60
ci_62                -3.899792e-04 3 1  ON 61
ci_63                 6.814883e-04 3 1  ON 62
ci_64                -1.808287e-03 3 1  ON 63
ci_65                -1.121183e-03 3 1  ON 64
ci_66                 1.776491e-04 3 1  ON 65
ci_67                -1.014546e-03 3 1  ON 66
ci_68                -6.453146e-04 3 1  ON 67
ci_69                 3.252103e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8524
    reference variance = 0.814493
====================================================
  Execution time = 4.1475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8667e-01
  Total weights = 1.9641e+06
  Execution time = 5.9658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0619532
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473649613978
                                         uncertainty =       0.003918017009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473649613978
                                         uncertainty =       0.003918017009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486682170
  error estimate for blocks of size 2^( 2) =       0.000507829371
  error estimate for blocks of size 2^( 3) =       0.000528097794
  error estimate for blocks of size 2^( 4) =       0.000543905906
  error estimate for blocks of size 2^( 5) =       0.000553720663
  error estimate for blocks of size 2^( 6) =       0.000559206604
  error estimate for blocks of size 2^( 7) =       0.000564021214

      target function =      -0.614592827544
              le_mean =     -22.818543868501
             les_mean =     521.273820403445
             stat err =       0.000555213597
             autocorr =       1.301455474222
   target nu stat err =       0.000555213597
   target dn stat err =       0.062339370517
      target stat err =       0.021803135583
              std dev =       0.688272525438
             le_variance =       0.473719069273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350944815
                                         uncertainty =       0.002918919919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350944815
                                         uncertainty =       0.002918919919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484989245
  error estimate for blocks of size 2^( 2) =       0.000506228859
  error estimate for blocks of size 2^( 3) =       0.000526516078
  error estimate for blocks of size 2^( 4) =       0.000542462970
  error estimate for blocks of size 2^( 5) =       0.000552224843
  error estimate for blocks of size 2^( 6) =       0.000557759786
  error estimate for blocks of size 2^( 7) =       0.000562383528

      target function =      -0.652925020047
              le_mean =     -22.818392388012
             les_mean =     521.165705395642
             stat err =       0.000553707782
             autocorr =       1.303457990257
   target nu stat err =       0.000553707782
   target dn stat err =       0.003745041639
      target stat err =       0.001513470845
              std dev =       0.685878367725
             le_variance =       0.470429135314

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0635208
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475354757500
                                         uncertainty =       0.003546463670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475354757500
                                         uncertainty =       0.003546463670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487558427
  error estimate for blocks of size 2^( 2) =       0.000508680593
  error estimate for blocks of size 2^( 3) =       0.000528885548
  error estimate for blocks of size 2^( 4) =       0.000544806286
  error estimate for blocks of size 2^( 5) =       0.000554392320
  error estimate for blocks of size 2^( 6) =       0.000559899745
  error estimate for blocks of size 2^( 7) =       0.000564829642

      target function =      -0.610099705281
              le_mean =     -22.818587458961
             les_mean =     521.287028169128
             stat err =       0.000555981998
             autocorr =       1.300373546992
   target nu stat err =       0.000555981998
   target dn stat err =       0.083813052114
      target stat err =       0.028914871434
              std dev =       0.689511739460
             le_variance =       0.475426438853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350286303
                                         uncertainty =       0.002918837978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470350286303
                                         uncertainty =       0.002918837978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484988905
  error estimate for blocks of size 2^( 2) =       0.000506228545
  error estimate for blocks of size 2^( 3) =       0.000526515801
  error estimate for blocks of size 2^( 4) =       0.000542462715
  error estimate for blocks of size 2^( 5) =       0.000552224638
  error estimate for blocks of size 2^( 6) =       0.000557759616
  error estimate for blocks of size 2^( 7) =       0.000562383376

      target function =      -0.652927342787
              le_mean =     -22.818392390707
             les_mean =     521.165699630031
             stat err =       0.000553707586
             autocorr =       1.303458896106
   target nu stat err =       0.000553707586
   target dn stat err =       0.003744437637
      target stat err =       0.001513249137
              std dev =       0.685877886931
             le_variance =       0.470428475781


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.614592827544        initial
     1.4552e-06     1.4552e-05             3.4213e-03        -0.652925020047
     5.8208e-06     5.8208e-05             3.4209e-03        -0.610099705281
     2.3283e-05     2.3283e-04             3.4192e-03        -0.652927342787  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e-05     and shift_s =   2.3283e-04
*****************************************************************************

  Execution time = 7.1454e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_01                 1.103834e-01 3 1  ON 0
ci_02                -2.457126e-02 3 1  ON 1
ci_03                -2.466345e-02 3 1  ON 2
ci_04                 2.212229e-02 3 1  ON 3
ci_05                -2.010396e-02 3 1  ON 4
ci_06                -1.835148e-02 3 1  ON 5
ci_07                 2.575971e-02 3 1  ON 6
ci_08                -4.788206e-03 3 1  ON 7
ci_09                -7.635093e-03 3 1  ON 8
ci_10                -9.417854e-03 3 1  ON 9
ci_11                 1.322576e-02 3 1  ON 10
ci_12                 6.963875e-03 3 1  ON 11
ci_13                 1.098152e-02 3 1  ON 12
ci_14                 1.330567e-02 3 1  ON 13
ci_15                 6.366923e-03 3 1  ON 14
ci_16                 5.304379e-03 3 1  ON 15
ci_17                -5.414684e-03 3 1  ON 16
ci_18                -6.955685e-03 3 1  ON 17
ci_19                 8.495335e-03 3 1  ON 18
ci_20                 8.388449e-03 3 1  ON 19
ci_21                 5.533541e-03 3 1  ON 20
ci_22                 9.584750e-03 3 1  ON 21
ci_23                 4.631875e-03 3 1  ON 22
ci_24                 5.812976e-03 3 1  ON 23
ci_25                 3.345165e-03 3 1  ON 24
ci_26                 3.631898e-04 3 1  ON 25
ci_27                 4.189500e-03 3 1  ON 26
ci_28                 1.500290e-03 3 1  ON 27
ci_29                 2.842431e-04 3 1  ON 28
ci_30                -4.611850e-04 3 1  ON 29
ci_31                -1.697718e-03 3 1  ON 30
ci_32                -1.474636e-03 3 1  ON 31
ci_33                -9.711170e-04 3 1  ON 32
ci_34                 7.898171e-04 3 1  ON 33
ci_35                 3.915958e-04 3 1  ON 34
ci_36                -1.220209e-03 3 1  ON 35
ci_37                -1.455790e-03 3 1  ON 36
ci_38                -9.059265e-04 3 1  ON 37
ci_39                -6.092251e-04 3 1  ON 38
ci_40                -1.146270e-03 3 1  ON 39
ci_41                -1.166097e-03 3 1  ON 40
ci_42                -1.501397e-05 3 1  ON 41
ci_43                -2.745464e-03 3 1  ON 42
ci_44                -1.434387e-03 3 1  ON 43
ci_45                -1.623606e-04 3 1  ON 44
ci_46                 3.085404e-04 3 1  ON 45
ci_47                 2.415636e-04 3 1  ON 46
ci_48                 7.760700e-04 3 1  ON 47
ci_49                -7.974742e-04 3 1  ON 48
ci_50                 3.760957e-04 3 1  ON 49
ci_51                 5.194050e-04 3 1  ON 50
ci_52                -4.159300e-04 3 1  ON 51
ci_53                -4.923590e-04 3 1  ON 52
ci_54                -1.514915e-03 3 1  ON 53
ci_55                 3.641718e-04 3 1  ON 54
ci_56                 2.971577e-03 3 1  ON 55
ci_57                 2.055358e-03 3 1  ON 56
ci_58                -1.600103e-03 3 1  ON 57
ci_59                -3.178639e-04 3 1  ON 58
ci_60                -2.355228e-05 3 1  ON 59
ci_61                -8.645683e-04 3 1  ON 60
ci_62                -3.900815e-04 3 1  ON 61
ci_63                 6.810465e-04 3 1  ON 62
ci_64                -1.807602e-03 3 1  ON 63
ci_65                -1.121316e-03 3 1  ON 64
ci_66                 1.768904e-04 3 1  ON 65
ci_67                -1.014194e-03 3 1  ON 66
ci_68                -6.462229e-04 3 1  ON 67
ci_69                 3.246683e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2320e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7877
    reference variance = 0.37243
====================================================
  Execution time = 4.2509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8724e-01
  Total weights = 1.964212077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470608050721
                                         uncertainty =       0.002200548286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470608050721
                                         uncertainty =       0.002200548286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485045910
  error estimate for blocks of size 2^( 2) =       0.000506372794
  error estimate for blocks of size 2^( 3) =       0.000527140437
  error estimate for blocks of size 2^( 4) =       0.000542857256
  error estimate for blocks of size 2^( 5) =       0.000552915991
  error estimate for blocks of size 2^( 6) =       0.000558425489
  error estimate for blocks of size 2^( 7) =       0.000563052814

      target function =      -0.652741218989
              le_mean =     -22.818555544800
             les_mean =     521.173720499381
             stat err =       0.000554312887
             autocorr =       1.306003248941
   target nu stat err =       0.000554312887
   target dn stat err =       0.003838238906
      target stat err =       0.001548779402
              std dev =       0.685958504569
             le_variance =       0.470539069990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281855554480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652744444100       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652914335466       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652962376400       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652982534812       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652995013831       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653002505620       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653006214265       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653007942141       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653007607668       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653007969728       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653008119349       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653008210537       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653008216020       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 6.190994e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652744444100       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652914269174       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652962283502       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652982425854       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652994891897       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653002374221       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653006077097       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653007801541       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653007466757       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653007827916       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653007977178       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653008068144       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653008073597       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 6.184697e-03

solving harmonic davidson linear method for identity shift 9.3132e-05, overlap shift 9.3132e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652744444100       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652914004520       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652961912703       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652981991038       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652994405404       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653001850059       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653005529994       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653007240806       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653006904807       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653007262393       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653007410233       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653007500320       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653007505656       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-05 is 6.159636e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0178e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_01                 1.111864e-01 3 1  ON 0
ci_02                -2.566524e-02 3 1  ON 1
ci_03                -2.442968e-02 3 1  ON 2
ci_04                 1.999984e-02 3 1  ON 3
ci_05                -1.935202e-02 3 1  ON 4
ci_06                -2.060679e-02 3 1  ON 5
ci_07                 2.631075e-02 3 1  ON 6
ci_08                -3.710224e-03 3 1  ON 7
ci_09                -8.614507e-03 3 1  ON 8
ci_10                -7.816404e-03 3 1  ON 9
ci_11                 1.270999e-02 3 1  ON 10
ci_12                 6.886617e-03 3 1  ON 11
ci_13                 1.455246e-02 3 1  ON 12
ci_14                 1.949037e-02 3 1  ON 13
ci_15                 7.305302e-03 3 1  ON 14
ci_16                 6.358708e-03 3 1  ON 15
ci_17                -5.661035e-03 3 1  ON 16
ci_18                -5.447394e-03 3 1  ON 17
ci_19                 9.903101e-03 3 1  ON 18
ci_20                 7.946411e-03 3 1  ON 19
ci_21                 1.046738e-02 3 1  ON 20
ci_22                 8.793528e-03 3 1  ON 21
ci_23                 5.134266e-03 3 1  ON 22
ci_24                 3.739495e-03 3 1  ON 23
ci_25                 2.688850e-03 3 1  ON 24
ci_26                 1.682078e-03 3 1  ON 25
ci_27                 2.341686e-03 3 1  ON 26
ci_28                 1.211839e-03 3 1  ON 27
ci_29                 1.937803e-03 3 1  ON 28
ci_30                -6.040571e-04 3 1  ON 29
ci_31                 2.949608e-04 3 1  ON 30
ci_32                -3.397486e-04 3 1  ON 31
ci_33                -1.118553e-03 3 1  ON 32
ci_34                 2.549252e-03 3 1  ON 33
ci_35                 3.798869e-04 3 1  ON 34
ci_36                -3.944625e-04 3 1  ON 35
ci_37                -2.020426e-03 3 1  ON 36
ci_38                -1.220440e-03 3 1  ON 37
ci_39                 3.636379e-04 3 1  ON 38
ci_40                -2.606621e-04 3 1  ON 39
ci_41                -1.273642e-03 3 1  ON 40
ci_42                -6.529638e-04 3 1  ON 41
ci_43                -2.963951e-03 3 1  ON 42
ci_44                -1.616933e-03 3 1  ON 43
ci_45                -1.718820e-05 3 1  ON 44
ci_46                -7.046223e-06 3 1  ON 45
ci_47                 1.842455e-03 3 1  ON 46
ci_48                 3.197897e-04 3 1  ON 47
ci_49                 1.135440e-04 3 1  ON 48
ci_50                -1.138842e-03 3 1  ON 49
ci_51                 2.851886e-04 3 1  ON 50
ci_52                 1.396980e-04 3 1  ON 51
ci_53                -1.160498e-03 3 1  ON 52
ci_54                -1.458887e-03 3 1  ON 53
ci_55                -1.078416e-03 3 1  ON 54
ci_56                 2.428500e-03 3 1  ON 55
ci_57                 1.956565e-03 3 1  ON 56
ci_58                -1.672919e-03 3 1  ON 57
ci_59                -1.594462e-03 3 1  ON 58
ci_60                 2.357198e-03 3 1  ON 59
ci_61                 2.139899e-03 3 1  ON 60
ci_62                -8.557498e-04 3 1  ON 61
ci_63                -9.830120e-04 3 1  ON 62
ci_64                -1.320385e-03 3 1  ON 63
ci_65                -1.444035e-03 3 1  ON 64
ci_66                -8.574450e-04 3 1  ON 65
ci_67                -5.113787e-04 3 1  ON 66
ci_68                -1.470686e-03 3 1  ON 67
ci_69                 3.037206e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7601
    reference variance = 0.486887
====================================================
  Execution time = 4.1505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8887e-01
  Total weights = 1.9638e+06
  Execution time = 5.9384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000132473
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.110607776172
                                         uncertainty =       0.621765631150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.110607776172
                                         uncertainty =       0.621765631150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000745233652
  error estimate for blocks of size 2^( 2) =       0.000759860748
  error estimate for blocks of size 2^( 3) =       0.000773496505
  error estimate for blocks of size 2^( 4) =       0.000785245601
  error estimate for blocks of size 2^( 5) =       0.000794214599
  error estimate for blocks of size 2^( 6) =       0.000797721475
  error estimate for blocks of size 2^( 7) =       0.000802118886

      target function =      -0.072123862409
              le_mean =     -22.818365779742
             les_mean =     528.821545449501
             stat err =       0.000794825140
             autocorr =       1.137517992906
   target nu stat err =       0.000794825140
   target dn stat err =       7.281072607646
      target stat err =       0.056383767985
              std dev =       1.053919538156
             le_variance =       1.110746392907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472303343210
                                         uncertainty =       0.002045778703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472303343210
                                         uncertainty =       0.002045778703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485886284
  error estimate for blocks of size 2^( 2) =       0.000507794797
  error estimate for blocks of size 2^( 3) =       0.000528209487
  error estimate for blocks of size 2^( 4) =       0.000545286431
  error estimate for blocks of size 2^( 5) =       0.000556126865
  error estimate for blocks of size 2^( 6) =       0.000561975954
  error estimate for blocks of size 2^( 7) =       0.000564856488

      target function =      -0.652138254635
              le_mean =     -22.818716265335
             les_mean =     521.182690905605
             stat err =       0.000557061435
             autocorr =       1.314428318087
   target nu stat err =       0.000557061435
   target dn stat err =       0.003217617974
      target stat err =       0.001309376537
              std dev =       0.687146973090
             le_variance =       0.472170962627

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000132457
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531473987950
                                         uncertainty =       0.056024815020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531473987950
                                         uncertainty =       0.056024815020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515381227
  error estimate for blocks of size 2^( 2) =       0.000535864623
  error estimate for blocks of size 2^( 3) =       0.000555292717
  error estimate for blocks of size 2^( 4) =       0.000571629500
  error estimate for blocks of size 2^( 5) =       0.000582138059
  error estimate for blocks of size 2^( 6) =       0.000588621063
  error estimate for blocks of size 2^( 7) =       0.000590931832

      target function =      -0.357504691637
              le_mean =     -22.818819910017
             les_mean =     522.211587825334
             stat err =       0.000583330113
             autocorr =       1.281066288516
   target nu stat err =       0.000583330113
   target dn stat err =       0.958689865166
      target stat err =       0.127791577192
              std dev =       0.728859121354
             le_variance =       0.531235618781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472304034526
                                         uncertainty =       0.002045650865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472304034526
                                         uncertainty =       0.002045650865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485886640
  error estimate for blocks of size 2^( 2) =       0.000507795233
  error estimate for blocks of size 2^( 3) =       0.000528209986
  error estimate for blocks of size 2^( 4) =       0.000545287015
  error estimate for blocks of size 2^( 5) =       0.000556127612
  error estimate for blocks of size 2^( 6) =       0.000561976325
  error estimate for blocks of size 2^( 7) =       0.000564857224

      target function =      -0.652160459607
              le_mean =     -22.818716329199
             les_mean =     521.182637409892
             stat err =       0.000557062044
             autocorr =       1.314429268425
   target nu stat err =       0.000557062044
   target dn stat err =       0.003216600947
      target stat err =       0.001309076296
              std dev =       0.687147476024
             le_variance =       0.472171653806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.072123862409        initial
     5.8208e-06     5.8208e-05             6.1910e-03        -0.652138254635
     2.3283e-05     2.3283e-04             6.1847e-03        -0.357504691637
     9.3132e-05     9.3132e-04             6.1596e-03        -0.652160459607  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e-05     and shift_s =   9.3132e-04
*****************************************************************************

  Execution time = 7.1376e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_01                 1.111847e-01 3 1  ON 0
ci_02                -2.566312e-02 3 1  ON 1
ci_03                -2.443023e-02 3 1  ON 2
ci_04                 2.000339e-02 3 1  ON 3
ci_05                -1.935341e-02 3 1  ON 4
ci_06                -2.060262e-02 3 1  ON 5
ci_07                 2.631042e-02 3 1  ON 6
ci_08                -3.711785e-03 3 1  ON 7
ci_09                -8.612450e-03 3 1  ON 8
ci_10                -7.819870e-03 3 1  ON 9
ci_11                 1.271092e-02 3 1  ON 10
ci_12                 6.886784e-03 3 1  ON 11
ci_13                 1.454186e-02 3 1  ON 12
ci_14                 1.946531e-02 3 1  ON 13
ci_15                 7.303473e-03 3 1  ON 14
ci_16                 6.356630e-03 3 1  ON 15
ci_17                -5.660630e-03 3 1  ON 16
ci_18                -5.450033e-03 3 1  ON 17
ci_19                 9.900834e-03 3 1  ON 18
ci_20                 7.947574e-03 3 1  ON 19
ci_21                 1.045455e-02 3 1  ON 20
ci_22                 8.795253e-03 3 1  ON 21
ci_23                 5.133466e-03 3 1  ON 22
ci_24                 3.744572e-03 3 1  ON 23
ci_25                 2.689880e-03 3 1  ON 24
ci_26                 1.679463e-03 3 1  ON 25
ci_27                 2.345360e-03 3 1  ON 26
ci_28                 1.212419e-03 3 1  ON 27
ci_29                 1.934752e-03 3 1  ON 28
ci_30                -6.037642e-04 3 1  ON 29
ci_31                 2.887751e-04 3 1  ON 30
ci_32                -3.414514e-04 3 1  ON 31
ci_33                -1.118235e-03 3 1  ON 32
ci_34                 2.546092e-03 3 1  ON 33
ci_35                 3.799310e-04 3 1  ON 34
ci_36                -3.956702e-04 3 1  ON 35
ci_37                -2.019447e-03 3 1  ON 36
ci_38                -1.219970e-03 3 1  ON 37
ci_39                 3.620096e-04 3 1  ON 38
ci_40                -2.619332e-04 3 1  ON 39
ci_41                -1.273412e-03 3 1  ON 40
ci_42                -6.518618e-04 3 1  ON 41
ci_43                -2.963387e-03 3 1  ON 42
ci_44                -1.616448e-03 3 1  ON 43
ci_45                -1.754326e-05 3 1  ON 44
ci_46                -6.482828e-06 3 1  ON 45
ci_47                 1.837840e-03 3 1  ON 46
ci_48                 3.214213e-04 3 1  ON 47
ci_49                 1.121310e-04 3 1  ON 48
ci_50                -1.136584e-03 3 1  ON 49
ci_51                 2.855525e-04 3 1  ON 50
ci_52                 1.388470e-04 3 1  ON 51
ci_53                -1.159449e-03 3 1  ON 52
ci_54                -1.458191e-03 3 1  ON 53
ci_55                -1.074957e-03 3 1  ON 54
ci_56                 2.429384e-03 3 1  ON 55
ci_57                 1.956724e-03 3 1  ON 56
ci_58                -1.672608e-03 3 1  ON 57
ci_59                -1.592068e-03 3 1  ON 58
ci_60                 2.347298e-03 3 1  ON 59
ci_61                 2.127698e-03 3 1  ON 60
ci_62                -8.550434e-04 3 1  ON 61
ci_63                -9.804886e-04 3 1  ON 62
ci_64                -1.321193e-03 3 1  ON 63
ci_65                -1.443372e-03 3 1  ON 64
ci_66                -8.555248e-04 3 1  ON 65
ci_67                -5.120501e-04 3 1  ON 66
ci_68                -1.469387e-03 3 1  ON 67
ci_69                 3.037654e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2157e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7695
    reference variance = 0.420231
====================================================
  Execution time = 4.3893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8650e-01
  Total weights = 1.964241092e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469623881558
                                         uncertainty =       0.002204930808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469623881558
                                         uncertainty =       0.002204930808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484617044
  error estimate for blocks of size 2^( 2) =       0.000506193868
  error estimate for blocks of size 2^( 3) =       0.000526870887
  error estimate for blocks of size 2^( 4) =       0.000542604994
  error estimate for blocks of size 2^( 5) =       0.000551662124
  error estimate for blocks of size 2^( 6) =       0.000556957915
  error estimate for blocks of size 2^( 7) =       0.000559145055

      target function =      -0.653315643491
              le_mean =     -22.819688705193
             les_mean =     521.224694221980
             stat err =       0.000552592522
             autocorr =       1.300207415369
   target nu stat err =       0.000552592522
   target dn stat err =       0.003847379924
      target stat err =       0.001556373271
              std dev =       0.685351996124
             le_variance =       0.469707358592


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281968870519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653318940135       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653411602858       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653429052284       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653434292650       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653439775150       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653442562163       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653444154069       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653444090411       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653444096280       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653444488544       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653444699561       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653444705315       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653444829292       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 5.217591e-03

solving harmonic davidson linear method for identity shift 9.3132e-05, overlap shift 9.3132e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653318940135       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653411450555       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653428857691       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653434080041       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653439540499       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653442312475       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653443894754       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653443830565       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653443836357       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653444225783       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653444434924       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653444440533       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653444563268       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-05 is 5.198036e-03

solving harmonic davidson linear method for identity shift 3.7253e-04, overlap shift 3.7253e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653318940135       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653410846312       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653428086181       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653433237498       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653438611271       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653441324386       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653442869054       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653442802852       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653442808372       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653443186759       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653443388623       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653443393680       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653443511615       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-04 is 5.121288e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.453275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1571e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_01                 1.120253e-01 3 1  ON 0
ci_02                -2.336804e-02 3 1  ON 1
ci_03                -2.407663e-02 3 1  ON 2
ci_04                 2.165892e-02 3 1  ON 3
ci_05                -1.864350e-02 3 1  ON 4
ci_06                -2.053470e-02 3 1  ON 5
ci_07                 2.536593e-02 3 1  ON 6
ci_08                -3.777534e-03 3 1  ON 7
ci_09                -8.084592e-03 3 1  ON 8
ci_10                -8.151045e-03 3 1  ON 9
ci_11                 1.291491e-02 3 1  ON 10
ci_12                 7.431888e-03 3 1  ON 11
ci_13                 1.177789e-02 3 1  ON 12
ci_14                 1.426727e-02 3 1  ON 13
ci_15                 6.024011e-03 3 1  ON 14
ci_16                 5.703028e-03 3 1  ON 15
ci_17                -5.479048e-03 3 1  ON 16
ci_18                -6.101537e-03 3 1  ON 17
ci_19                 8.747130e-03 3 1  ON 18
ci_20                 7.292621e-03 3 1  ON 19
ci_21                 9.683005e-03 3 1  ON 20
ci_22                 8.349595e-03 3 1  ON 21
ci_23                 5.870934e-03 3 1  ON 22
ci_24                 7.294018e-03 3 1  ON 23
ci_25                 3.222127e-03 3 1  ON 24
ci_26                 2.367242e-03 3 1  ON 25
ci_27                 2.175955e-03 3 1  ON 26
ci_28                 1.486751e-03 3 1  ON 27
ci_29                 1.605934e-03 3 1  ON 28
ci_30                -1.514565e-03 3 1  ON 29
ci_31                -1.086362e-03 3 1  ON 30
ci_32                -6.234706e-04 3 1  ON 31
ci_33                -9.266592e-04 3 1  ON 32
ci_34                 1.033393e-03 3 1  ON 33
ci_35                 2.050872e-03 3 1  ON 34
ci_36                -1.248542e-03 3 1  ON 35
ci_37                -1.113947e-03 3 1  ON 36
ci_38                -9.131940e-04 3 1  ON 37
ci_39                -3.012988e-04 3 1  ON 38
ci_40                -6.001870e-04 3 1  ON 39
ci_41                -8.509777e-04 3 1  ON 40
ci_42                -8.453960e-05 3 1  ON 41
ci_43                -3.401452e-03 3 1  ON 42
ci_44                -2.564541e-03 3 1  ON 43
ci_45                 1.933348e-04 3 1  ON 44
ci_46                -5.293683e-04 3 1  ON 45
ci_47                 6.733852e-04 3 1  ON 46
ci_48                 3.466759e-04 3 1  ON 47
ci_49                -9.458350e-04 3 1  ON 48
ci_50                -9.604654e-04 3 1  ON 49
ci_51                 4.796818e-04 3 1  ON 50
ci_52                 5.893964e-04 3 1  ON 51
ci_53                -7.599333e-04 3 1  ON 52
ci_54                -1.092462e-03 3 1  ON 53
ci_55                -8.557492e-04 3 1  ON 54
ci_56                 1.945783e-03 3 1  ON 55
ci_57                 1.817510e-03 3 1  ON 56
ci_58                -8.527983e-04 3 1  ON 57
ci_59                 2.902846e-05 3 1  ON 58
ci_60                 1.642365e-03 3 1  ON 59
ci_61                 2.524287e-03 3 1  ON 60
ci_62                -1.239199e-03 3 1  ON 61
ci_63                 4.414778e-05 3 1  ON 62
ci_64                -1.015938e-03 3 1  ON 63
ci_65                -1.004270e-03 3 1  ON 64
ci_66                -6.890719e-04 3 1  ON 65
ci_67                -1.048777e-03 3 1  ON 66
ci_68                -1.372243e-03 3 1  ON 67
ci_69                 1.019047e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7636
    reference variance = 0.409465
====================================================
  Execution time = 4.2924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8697e-01
  Total weights = 1.9639e+06
  Execution time = 5.9387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00407929
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510426175553
                                         uncertainty =       0.026601795647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510426175553
                                         uncertainty =       0.026601795647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505149133
  error estimate for blocks of size 2^( 2) =       0.000526114182
  error estimate for blocks of size 2^( 3) =       0.000545177726
  error estimate for blocks of size 2^( 4) =       0.000561180866
  error estimate for blocks of size 2^( 5) =       0.000570994641
  error estimate for blocks of size 2^( 6) =       0.000573731336
  error estimate for blocks of size 2^( 7) =       0.000576012058

      target function =      -0.382530414227
              le_mean =     -22.818689705081
             les_mean =     522.135305292498
             stat err =       0.000570479725
             autocorr =       1.275384707342
   target nu stat err =       0.000570479725
   target dn stat err =       0.749453265681
      target stat err =       0.109761112160
              std dev =       0.714388754685
             le_variance =       0.510351292820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469838609308
                                         uncertainty =       0.002295958741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469838609308
                                         uncertainty =       0.002295958741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484666528
  error estimate for blocks of size 2^( 2) =       0.000506523064
  error estimate for blocks of size 2^( 3) =       0.000526312581
  error estimate for blocks of size 2^( 4) =       0.000542981679
  error estimate for blocks of size 2^( 5) =       0.000552752761
  error estimate for blocks of size 2^( 6) =       0.000556124630
  error estimate for blocks of size 2^( 7) =       0.000559274764

      target function =      -0.652912707245
              le_mean =     -22.818601567133
             les_mean =     521.175416722137
             stat err =       0.000552783458
             autocorr =       1.300840418753
   target nu stat err =       0.000552783458
   target dn stat err =       0.003361836333
      target stat err =       0.001366644708
              std dev =       0.685421976979
             le_variance =       0.469803286525

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00403971
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480555052139
                                         uncertainty =       0.007208649306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480555052139
                                         uncertainty =       0.007208649306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490133891
  error estimate for blocks of size 2^( 2) =       0.000511743342
  error estimate for blocks of size 2^( 3) =       0.000531399323
  error estimate for blocks of size 2^( 4) =       0.000547947898
  error estimate for blocks of size 2^( 5) =       0.000557572456
  error estimate for blocks of size 2^( 6) =       0.000561124072
  error estimate for blocks of size 2^( 7) =       0.000564559283

      target function =      -0.498208149436
              le_mean =     -22.818770960510
             les_mean =     521.643816493665
             stat err =       0.000557800927
             autocorr =       1.295176622823
   target nu stat err =       0.000557800927
   target dn stat err =       0.337199716396
      target stat err =       0.079372266259
              std dev =       0.693153995786
             le_variance =       0.480462461874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469841388263
                                         uncertainty =       0.002297050613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469841388263
                                         uncertainty =       0.002297050613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484667957
  error estimate for blocks of size 2^( 2) =       0.000506524147
  error estimate for blocks of size 2^( 3) =       0.000526314208
  error estimate for blocks of size 2^( 4) =       0.000542983596
  error estimate for blocks of size 2^( 5) =       0.000552755261
  error estimate for blocks of size 2^( 6) =       0.000556127691
  error estimate for blocks of size 2^( 7) =       0.000559279253

      target function =      -0.651473729994
              le_mean =     -22.818601355268
             les_mean =     521.179057972802
             stat err =       0.000552786450
             autocorr =       1.300846829920
   target nu stat err =       0.000552786450
   target dn stat err =       0.004846491218
      target stat err =       0.001931056542
              std dev =       0.685423997554
             le_variance =       0.469806056423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.382530414227        initial
     2.3283e-05     2.3283e-04             5.2176e-03        -0.652912707245  <--
     9.3132e-05     9.3132e-04             5.1980e-03        -0.498208149436
     3.7253e-04     3.7253e-03             5.1213e-03        -0.651473729994

*****************************************************************************
Applying the update for shift_i =   2.3283e-05     and shift_s =   2.3283e-04
*****************************************************************************

  Execution time = 7.2808e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_01                 1.120288e-01 3 1  ON 0
ci_02                -2.336327e-02 3 1  ON 1
ci_03                -2.407594e-02 3 1  ON 2
ci_04                 2.166186e-02 3 1  ON 3
ci_05                -1.864213e-02 3 1  ON 4
ci_06                -2.053469e-02 3 1  ON 5
ci_07                 2.536473e-02 3 1  ON 6
ci_08                -3.777634e-03 3 1  ON 7
ci_09                -8.083591e-03 3 1  ON 8
ci_10                -8.151825e-03 3 1  ON 9
ci_11                 1.291478e-02 3 1  ON 10
ci_12                 7.432831e-03 3 1  ON 11
ci_13                 1.176995e-02 3 1  ON 12
ci_14                 1.424771e-02 3 1  ON 13
ci_15                 6.021629e-03 3 1  ON 14
ci_16                 5.701785e-03 3 1  ON 15
ci_17                -5.478642e-03 3 1  ON 16
ci_18                -6.102794e-03 3 1  ON 17
ci_19                 8.745342e-03 3 1  ON 18
ci_20                 7.291674e-03 3 1  ON 19
ci_21                 9.680650e-03 3 1  ON 20
ci_22                 8.348202e-03 3 1  ON 21
ci_23                 5.872139e-03 3 1  ON 22
ci_24                 7.303569e-03 3 1  ON 23
ci_25                 3.222921e-03 3 1  ON 24
ci_26                 2.368528e-03 3 1  ON 25
ci_27                 2.175627e-03 3 1  ON 26
ci_28                 1.487322e-03 3 1  ON 27
ci_29                 1.605240e-03 3 1  ON 28
ci_30                -1.517321e-03 3 1  ON 29
ci_31                -1.090664e-03 3 1  ON 30
ci_32                -6.238949e-04 3 1  ON 31
ci_33                -9.263155e-04 3 1  ON 32
ci_34                 1.030654e-03 3 1  ON 33
ci_35                 2.054340e-03 3 1  ON 34
ci_36                -1.250024e-03 3 1  ON 35
ci_37                -1.112477e-03 3 1  ON 36
ci_38                -9.126762e-04 3 1  ON 37
ci_39                -3.023150e-04 3 1  ON 38
ci_40                -6.006601e-04 3 1  ON 39
ci_41                -8.501960e-04 3 1  ON 40
ci_42                -8.350957e-05 3 1  ON 41
ci_43                -3.402213e-03 3 1  ON 42
ci_44                -2.566362e-03 3 1  ON 43
ci_45                 1.936659e-04 3 1  ON 44
ci_46                -5.302073e-04 3 1  ON 45
ci_47                 6.707336e-04 3 1  ON 46
ci_48                 3.470415e-04 3 1  ON 47
ci_49                -9.474931e-04 3 1  ON 48
ci_50                -9.602010e-04 3 1  ON 49
ci_51                 4.800136e-04 3 1  ON 50
ci_52                 5.900839e-04 3 1  ON 51
ci_53                -7.593777e-04 3 1  ON 52
ci_54                -1.091144e-03 3 1  ON 53
ci_55                -8.545890e-04 3 1  ON 54
ci_56                 1.945045e-03 3 1  ON 55
ci_57                 1.817372e-03 3 1  ON 56
ci_58                -8.513236e-04 3 1  ON 57
ci_59                 3.181254e-05 3 1  ON 58
ci_60                 1.638241e-03 3 1  ON 59
ci_61                 2.524529e-03 3 1  ON 60
ci_62                -1.239770e-03 3 1  ON 61
ci_63                 4.569430e-05 3 1  ON 62
ci_64                -1.015347e-03 3 1  ON 63
ci_65                -1.003443e-03 3 1  ON 64
ci_66                -6.886522e-04 3 1  ON 65
ci_67                -1.049572e-03 3 1  ON 66
ci_68                -1.372139e-03 3 1  ON 67
ci_69                 1.015562e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2439e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.8385
    reference variance = 0.671167
====================================================
  Execution time = 4.2525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9174e-01
  Total weights = 1.964572133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474636894926
                                         uncertainty =       0.002680545379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474636894926
                                         uncertainty =       0.002680545379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487203785
  error estimate for blocks of size 2^( 2) =       0.000508947654
  error estimate for blocks of size 2^( 3) =       0.000528966795
  error estimate for blocks of size 2^( 4) =       0.000544343169
  error estimate for blocks of size 2^( 5) =       0.000554500294
  error estimate for blocks of size 2^( 6) =       0.000561248246
  error estimate for blocks of size 2^( 7) =       0.000564533900

      target function =      -0.651074415295
              le_mean =     -22.818954490585
             les_mean =     521.196419382773
             stat err =       0.000556156402
             autocorr =       1.303084485913
   target nu stat err =       0.000556156402
   target dn stat err =       0.003699833488
      target stat err =       0.001488944265
              std dev =       0.689010200808
             le_variance =       0.474735056818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281895449058e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651077409864       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651232249712       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651254573311       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651261282210       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651266392930       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651269115905       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651270062652       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651270029128       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651269764963       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651269186895       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651269132815       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651269172658       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651269120459       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 4.860199e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651077409864       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651232186507       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651254496015       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651261199411       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651266305431       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651269024878       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651269969633       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651269935869       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651269671914       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651269094717       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651269040807       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651269080611       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651269028561       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 4.855894e-03

solving harmonic davidson linear method for identity shift 9.3132e-05, overlap shift 9.3132e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651077409864       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651231934201       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651254187511       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651260868972       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651265956265       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651268661670       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651269598504       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651269563797       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651269300678       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651268726942       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651268673710       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651268713356       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651268661900       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-05 is 4.838754e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.458918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0183e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_01                 1.093456e-01 3 1  ON 0
ci_02                -2.241968e-02 3 1  ON 1
ci_03                -2.625435e-02 3 1  ON 2
ci_04                 2.189070e-02 3 1  ON 3
ci_05                -1.930464e-02 3 1  ON 4
ci_06                -1.873950e-02 3 1  ON 5
ci_07                 2.613742e-02 3 1  ON 6
ci_08                -4.698313e-03 3 1  ON 7
ci_09                -8.204413e-03 3 1  ON 8
ci_10                -7.648738e-03 3 1  ON 9
ci_11                 1.305163e-02 3 1  ON 10
ci_12                 7.229045e-03 3 1  ON 11
ci_13                 1.048070e-02 3 1  ON 12
ci_14                 1.910361e-02 3 1  ON 13
ci_15                 5.708412e-03 3 1  ON 14
ci_16                 6.216709e-03 3 1  ON 15
ci_17                -7.580421e-03 3 1  ON 16
ci_18                -6.550872e-03 3 1  ON 17
ci_19                 1.005755e-02 3 1  ON 18
ci_20                 7.031805e-03 3 1  ON 19
ci_21                 8.109969e-03 3 1  ON 20
ci_22                 8.411625e-03 3 1  ON 21
ci_23                 4.210311e-03 3 1  ON 22
ci_24                 6.863452e-03 3 1  ON 23
ci_25                 2.861652e-03 3 1  ON 24
ci_26                 4.094214e-03 3 1  ON 25
ci_27                 2.553979e-03 3 1  ON 26
ci_28                 1.667909e-03 3 1  ON 27
ci_29                 2.456405e-04 3 1  ON 28
ci_30                 4.214977e-05 3 1  ON 29
ci_31                -8.798630e-04 3 1  ON 30
ci_32                 1.013894e-05 3 1  ON 31
ci_33                 4.620575e-04 3 1  ON 32
ci_34                 9.553974e-05 3 1  ON 33
ci_35                 2.153914e-03 3 1  ON 34
ci_36                -4.797233e-04 3 1  ON 35
ci_37                -1.045014e-03 3 1  ON 36
ci_38                -7.282027e-04 3 1  ON 37
ci_39                -1.778875e-04 3 1  ON 38
ci_40                -1.819545e-03 3 1  ON 39
ci_41                -2.589446e-03 3 1  ON 40
ci_42                -1.477414e-03 3 1  ON 41
ci_43                -9.527414e-04 3 1  ON 42
ci_44                -1.854603e-03 3 1  ON 43
ci_45                -5.457191e-04 3 1  ON 44
ci_46                -5.020901e-04 3 1  ON 45
ci_47                 2.580270e-03 3 1  ON 46
ci_48                 2.547490e-03 3 1  ON 47
ci_49                -1.065090e-03 3 1  ON 48
ci_50                -4.911274e-04 3 1  ON 49
ci_51                -8.918790e-04 3 1  ON 50
ci_52                 9.021001e-04 3 1  ON 51
ci_53                -4.685518e-04 3 1  ON 52
ci_54                -1.712185e-03 3 1  ON 53
ci_55                -1.717085e-03 3 1  ON 54
ci_56                 2.181877e-03 3 1  ON 55
ci_57                 6.750638e-04 3 1  ON 56
ci_58                -1.004218e-04 3 1  ON 57
ci_59                 6.942082e-04 3 1  ON 58
ci_60                -5.169863e-04 3 1  ON 59
ci_61                 2.072016e-03 3 1  ON 60
ci_62                -1.337519e-04 3 1  ON 61
ci_63                 5.310926e-04 3 1  ON 62
ci_64                -1.113704e-04 3 1  ON 63
ci_65                 6.874116e-05 3 1  ON 64
ci_66                -1.569163e-04 3 1  ON 65
ci_67                -5.030626e-04 3 1  ON 66
ci_68                -2.183520e-03 3 1  ON 67
ci_69                -5.387265e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.8832
    reference variance = 0.294407
====================================================
  Execution time = 4.1463e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8897e-01
  Total weights = 1.9644e+06
  Execution time = 5.9298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0154595
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483847486826
                                         uncertainty =       0.006881957198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483847486826
                                         uncertainty =       0.006881957198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491811532
  error estimate for blocks of size 2^( 2) =       0.000513072155
  error estimate for blocks of size 2^( 3) =       0.000533435602
  error estimate for blocks of size 2^( 4) =       0.000547612505
  error estimate for blocks of size 2^( 5) =       0.000558037148
  error estimate for blocks of size 2^( 6) =       0.000563784750
  error estimate for blocks of size 2^( 7) =       0.000569087805

      target function =      -0.525119618530
              le_mean =     -22.818574118994
             les_mean =     521.536577319096
             stat err =       0.000559630552
             autocorr =       1.294808127533
   target nu stat err =       0.000559630552
   target dn stat err =       0.286663503405
      target stat err =       0.074568317071
              std dev =       0.695526538317
             le_variance =       0.483757165504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472606891556
                                         uncertainty =       0.003101779590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472606891556
                                         uncertainty =       0.003101779590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486069100
  error estimate for blocks of size 2^( 2) =       0.000507543643
  error estimate for blocks of size 2^( 3) =       0.000528005414
  error estimate for blocks of size 2^( 4) =       0.000542165347
  error estimate for blocks of size 2^( 5) =       0.000552797517
  error estimate for blocks of size 2^( 6) =       0.000558525526
  error estimate for blocks of size 2^( 7) =       0.000563649529

      target function =      -0.652035338882
              le_mean =     -22.818454917368
             les_mean =     521.170852036748
             stat err =       0.000554284480
             autocorr =       1.300377390627
   target nu stat err =       0.000554284480
   target dn stat err =       0.005018804577
      target stat err =       0.002000984789
              std dev =       0.687405513820
             le_variance =       0.472526340430

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.015139
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475058653093
                                         uncertainty =       0.003275510877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475058653093
                                         uncertainty =       0.003275510877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487324906
  error estimate for blocks of size 2^( 2) =       0.000508799656
  error estimate for blocks of size 2^( 3) =       0.000529228068
  error estimate for blocks of size 2^( 4) =       0.000543327182
  error estimate for blocks of size 2^( 5) =       0.000554083520
  error estimate for blocks of size 2^( 6) =       0.000559800126
  error estimate for blocks of size 2^( 7) =       0.000564973045

      target function =      -0.636225563453
              le_mean =     -22.818647832463
             les_mean =     521.220846318141
             stat err =       0.000555545969
             autocorr =       1.299579299196
   target nu stat err =       0.000555545969
   target dn stat err =       0.016359835592
      target stat err =       0.006133263504
              std dev =       0.689181491765
             le_variance =       0.474971128592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472607253281
                                         uncertainty =       0.003101475435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472607253281
                                         uncertainty =       0.003101475435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486069288
  error estimate for blocks of size 2^( 2) =       0.000507543754
  error estimate for blocks of size 2^( 3) =       0.000528005436
  error estimate for blocks of size 2^( 4) =       0.000542165252
  error estimate for blocks of size 2^( 5) =       0.000552797245
  error estimate for blocks of size 2^( 6) =       0.000558525217
  error estimate for blocks of size 2^( 7) =       0.000563649340

      target function =      -0.652032829732
              le_mean =     -22.818454941463
             les_mean =     521.170859528716
             stat err =       0.000554284264
             autocorr =       1.300375371245
   target nu stat err =       0.000554284264
   target dn stat err =       0.005019774677
      target stat err =       0.002001345621
              std dev =       0.687405779324
             le_variance =       0.472526705448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.525119618530        initial
     5.8208e-06     5.8208e-05             4.8602e-03        -0.652035338882  <--
     2.3283e-05     2.3283e-04             4.8559e-03        -0.636225563453
     9.3132e-05     9.3132e-04             4.8388e-03        -0.652032829732

*****************************************************************************
Applying the update for shift_i =   5.8208e-06     and shift_s =   5.8208e-05
*****************************************************************************

  Execution time = 7.1288e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_01                 1.093434e-01 3 1  ON 0
ci_02                -2.241927e-02 3 1  ON 1
ci_03                -2.625551e-02 3 1  ON 2
ci_04                 2.189078e-02 3 1  ON 3
ci_05                -1.930500e-02 3 1  ON 4
ci_06                -1.873864e-02 3 1  ON 5
ci_07                 2.613758e-02 3 1  ON 6
ci_08                -4.698626e-03 3 1  ON 7
ci_09                -8.204431e-03 3 1  ON 8
ci_10                -7.648398e-03 3 1  ON 9
ci_11                 1.305177e-02 3 1  ON 10
ci_12                 7.228992e-03 3 1  ON 11
ci_13                 1.047992e-02 3 1  ON 12
ci_14                 1.910791e-02 3 1  ON 13
ci_15                 5.708249e-03 3 1  ON 14
ci_16                 6.216949e-03 3 1  ON 15
ci_17                -7.581466e-03 3 1  ON 16
ci_18                -6.551081e-03 3 1  ON 17
ci_19                 1.005809e-02 3 1  ON 18
ci_20                 7.031627e-03 3 1  ON 19
ci_21                 8.108987e-03 3 1  ON 20
ci_22                 8.411651e-03 3 1  ON 21
ci_23                 4.209630e-03 3 1  ON 22
ci_24                 6.863143e-03 3 1  ON 23
ci_25                 2.861513e-03 3 1  ON 24
ci_26                 4.095056e-03 3 1  ON 25
ci_27                 2.554165e-03 3 1  ON 26
ci_28                 1.667975e-03 3 1  ON 27
ci_29                 2.449766e-04 3 1  ON 28
ci_30                 4.320606e-05 3 1  ON 29
ci_31                -8.797140e-04 3 1  ON 30
ci_32                 1.040606e-05 3 1  ON 31
ci_33                 4.626301e-04 3 1  ON 32
ci_34                 9.501272e-05 3 1  ON 33
ci_35                 2.153946e-03 3 1  ON 34
ci_36                -4.794281e-04 3 1  ON 35
ci_37                -1.045007e-03 3 1  ON 36
ci_38                -7.281237e-04 3 1  ON 37
ci_39                -1.778349e-04 3 1  ON 38
ci_40                -1.819992e-03 3 1  ON 39
ci_41                -2.590181e-03 3 1  ON 40
ci_42                -1.478013e-03 3 1  ON 41
ci_43                -9.515351e-04 3 1  ON 42
ci_44                -1.854203e-03 3 1  ON 43
ci_45                -5.460490e-04 3 1  ON 44
ci_46                -5.020953e-04 3 1  ON 45
ci_47                 2.581217e-03 3 1  ON 46
ci_48                 2.548691e-03 3 1  ON 47
ci_49                -1.065153e-03 3 1  ON 48
ci_50                -4.909451e-04 3 1  ON 49
ci_51                -8.924634e-04 3 1  ON 50
ci_52                 9.022239e-04 3 1  ON 51
ci_53                -4.684292e-04 3 1  ON 52
ci_54                -1.712643e-03 3 1  ON 53
ci_55                -1.717682e-03 3 1  ON 54
ci_56                 2.181950e-03 3 1  ON 55
ci_57                 6.745890e-04 3 1  ON 56
ci_58                -1.000945e-04 3 1  ON 57
ci_59                 6.944862e-04 3 1  ON 58
ci_60                -5.185719e-04 3 1  ON 59
ci_61                 2.071891e-03 3 1  ON 60
ci_62                -1.333295e-04 3 1  ON 61
ci_63                 5.312679e-04 3 1  ON 62
ci_64                -1.110005e-04 3 1  ON 63
ci_65                 6.920616e-05 3 1  ON 64
ci_66                -1.566869e-04 3 1  ON 65
ci_67                -5.028342e-04 3 1  ON 66
ci_68                -2.183882e-03 3 1  ON 67
ci_69                -5.389864e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2148e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7559
    reference variance = 0.756767
====================================================
  Execution time = 4.2539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8512e-01
  Total weights = 1.964387612e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469116158656
                                         uncertainty =       0.002188324021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469116158656
                                         uncertainty =       0.002188324021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484278370
  error estimate for blocks of size 2^( 2) =       0.000506227954
  error estimate for blocks of size 2^( 3) =       0.000527181759
  error estimate for blocks of size 2^( 4) =       0.000543800436
  error estimate for blocks of size 2^( 5) =       0.000555081849
  error estimate for blocks of size 2^( 6) =       0.000561293595
  error estimate for blocks of size 2^( 7) =       0.000567603876

      target function =      -0.653725034398
              le_mean =     -22.819134480195
             les_mean =     521.198015312180
             stat err =       0.000556944939
             autocorr =       1.322617848040
   target nu stat err =       0.000556944939
   target dn stat err =       0.003756374363
      target stat err =       0.001522935347
              std dev =       0.684873039407
             le_variance =       0.469051080106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281913448019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-06, overlap shift 1.4552e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653728019400       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653890173564       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653922080986       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653934841226       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653940061422       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653942693887       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653942392448       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653943091384       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653943309475       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653943430717       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653943627743       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653943745314       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653943844688       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-06 is 4.639301e-03

solving harmonic davidson linear method for identity shift 5.8208e-06, overlap shift 5.8208e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653728019400       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653890156997       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653922059795       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653934817635       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653940036332       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653942667852       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653942366381       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653943065066       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653943283055       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653943404245       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653943601179       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653943718689       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653943818003       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-06 is 4.638438e-03

solving harmonic davidson linear method for identity shift 2.3283e-05, overlap shift 2.3283e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653728019400       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653890090760       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653921975079       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653934723323       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653939936033       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653942563779       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653942262177       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653942959862       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653943177448       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653943298428       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653943494994       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653943612257       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653943711335       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-05 is 4.634990e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0173e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_01                 1.078592e-01 3 1  ON 0
ci_02                -2.350544e-02 3 1  ON 1
ci_03                -2.523683e-02 3 1  ON 2
ci_04                 2.061850e-02 3 1  ON 3
ci_05                -2.198325e-02 3 1  ON 4
ci_06                -2.008834e-02 3 1  ON 5
ci_07                 2.539210e-02 3 1  ON 6
ci_08                -3.789132e-03 3 1  ON 7
ci_09                -8.065595e-03 3 1  ON 8
ci_10                -7.125173e-03 3 1  ON 9
ci_11                 1.330564e-02 3 1  ON 10
ci_12                 6.931486e-03 3 1  ON 11
ci_13                 1.511836e-02 3 1  ON 12
ci_14                 1.548295e-02 3 1  ON 13
ci_15                 5.119236e-03 3 1  ON 14
ci_16                 4.080526e-03 3 1  ON 15
ci_17                -6.308331e-03 3 1  ON 16
ci_18                -6.159000e-03 3 1  ON 17
ci_19                 9.342824e-03 3 1  ON 18
ci_20                 6.848493e-03 3 1  ON 19
ci_21                 9.919267e-03 3 1  ON 20
ci_22                 1.002652e-02 3 1  ON 21
ci_23                 5.059655e-03 3 1  ON 22
ci_24                 4.244421e-03 3 1  ON 23
ci_25                 2.536981e-03 3 1  ON 24
ci_26                 3.464320e-03 3 1  ON 25
ci_27                 3.727281e-03 3 1  ON 26
ci_28                 1.428707e-03 3 1  ON 27
ci_29                -1.734382e-06 3 1  ON 28
ci_30                 2.513801e-04 3 1  ON 29
ci_31                 5.342420e-04 3 1  ON 30
ci_32                -2.023364e-03 3 1  ON 31
ci_33                -1.170273e-03 3 1  ON 32
ci_34                -2.203828e-04 3 1  ON 33
ci_35                 2.367739e-03 3 1  ON 34
ci_36                 1.979180e-05 3 1  ON 35
ci_37                -5.592532e-04 3 1  ON 36
ci_38                 3.641219e-04 3 1  ON 37
ci_39                 3.115929e-04 3 1  ON 38
ci_40                -1.469430e-03 3 1  ON 39
ci_41                -1.130664e-03 3 1  ON 40
ci_42                -1.510841e-03 3 1  ON 41
ci_43                -2.817862e-03 3 1  ON 42
ci_44                -2.538581e-03 3 1  ON 43
ci_45                 6.964319e-04 3 1  ON 44
ci_46                 1.214390e-04 3 1  ON 45
ci_47                 1.022818e-03 3 1  ON 46
ci_48                 1.343101e-03 3 1  ON 47
ci_49                -1.144254e-03 3 1  ON 48
ci_50                -8.870572e-04 3 1  ON 49
ci_51                -1.062565e-03 3 1  ON 50
ci_52                 1.634551e-04 3 1  ON 51
ci_53                -7.428055e-04 3 1  ON 52
ci_54                -1.014680e-03 3 1  ON 53
ci_55                -4.138730e-04 3 1  ON 54
ci_56                 2.159023e-03 3 1  ON 55
ci_57                 1.639574e-03 3 1  ON 56
ci_58                -1.758053e-03 3 1  ON 57
ci_59                -6.336263e-04 3 1  ON 58
ci_60                 6.305916e-04 3 1  ON 59
ci_61                 1.122683e-04 3 1  ON 60
ci_62                 4.305515e-04 3 1  ON 61
ci_63                -5.566627e-04 3 1  ON 62
ci_64                -6.910568e-04 3 1  ON 63
ci_65                -1.215159e-03 3 1  ON 64
ci_66                -6.220343e-04 3 1  ON 65
ci_67                -2.918992e-06 3 1  ON 66
ci_68                -1.617316e-03 3 1  ON 67
ci_69                -7.971743e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.8334
    reference variance = 0.316182
====================================================
  Execution time = 4.3012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8468e-01
  Total weights = 1.9643e+06
  Execution time = 5.9464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.765465612080
                                         uncertainty =       1.284366256624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.765465612080
                                         uncertainty =       1.284366256624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000938906829
  error estimate for blocks of size 2^( 2) =       0.000950440643
  error estimate for blocks of size 2^( 3) =       0.000961585565
  error estimate for blocks of size 2^( 4) =       0.000970627219
  error estimate for blocks of size 2^( 5) =       0.000976493546
  error estimate for blocks of size 2^( 6) =       0.000981231559
  error estimate for blocks of size 2^( 7) =       0.000984992345

      target function =      -0.013563208947
              le_mean =     -22.820323265432
             les_mean =     561.227570471956
             stat err =       0.000978336167
             autocorr =       1.085753460133
   target nu stat err =       0.000978336167
   target dn stat err =      39.762181696087
      target stat err =       0.012955880638
              std dev =       1.327814771619
             le_variance =       1.763092067730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471117816684
                                         uncertainty =       0.002400602075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471117816684
                                         uncertainty =       0.002400602075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485306542
  error estimate for blocks of size 2^( 2) =       0.000507216660
  error estimate for blocks of size 2^( 3) =       0.000527962241
  error estimate for blocks of size 2^( 4) =       0.000543838397
  error estimate for blocks of size 2^( 5) =       0.000553601750
  error estimate for blocks of size 2^( 6) =       0.000558500792
  error estimate for blocks of size 2^( 7) =       0.000560986410

      target function =      -0.653964334505
              le_mean =     -22.819400251477
             les_mean =     521.209710511900
             stat err =       0.000554231837
             autocorr =       1.304219375125
   target nu stat err =       0.000554231837
   target dn stat err =       0.002987331470
      target stat err =       0.001228957776
              std dev =       0.686327093736
             le_variance =       0.471044879595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492315905304
                                         uncertainty =       0.012840666027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492315905304
                                         uncertainty =       0.012840666027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496092301
  error estimate for blocks of size 2^( 2) =       0.000517584229
  error estimate for blocks of size 2^( 3) =       0.000537947639
  error estimate for blocks of size 2^( 4) =       0.000553536666
  error estimate for blocks of size 2^( 5) =       0.000563168321
  error estimate for blocks of size 2^( 6) =       0.000567779992
  error estimate for blocks of size 2^( 7) =       0.000570209573

      target function =      -0.483697746402
              le_mean =     -22.819672200015
             les_mean =     521.763370796950
             stat err =       0.000563673638
             autocorr =       1.291012579934
   target nu stat err =       0.000563673638
   target dn stat err =       0.297900258397
      target stat err =       0.065705491228
              std dev =       0.701580459690
             le_variance =       0.492215141420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471117463909
                                         uncertainty =       0.002400549132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471117463909
                                         uncertainty =       0.002400549132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485306361
  error estimate for blocks of size 2^( 2) =       0.000507216475
  error estimate for blocks of size 2^( 3) =       0.000527962060
  error estimate for blocks of size 2^( 4) =       0.000543838199
  error estimate for blocks of size 2^( 5) =       0.000553601589
  error estimate for blocks of size 2^( 6) =       0.000558500719
  error estimate for blocks of size 2^( 7) =       0.000560986271

      target function =      -0.653964589016
              le_mean =     -22.819400243598
             les_mean =     521.209709503995
             stat err =       0.000554231695
             autocorr =       1.304219676568
   target nu stat err =       0.000554231695
   target dn stat err =       0.002987404354
      target stat err =       0.001228986415
              std dev =       0.686326838072
             le_variance =       0.471044528659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.013563208947        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.9431
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_01                 1.093434e-01 3 1  ON 0
ci_02                -2.241927e-02 3 1  ON 1
ci_03                -2.625551e-02 3 1  ON 2
ci_04                 2.189078e-02 3 1  ON 3
ci_05                -1.930500e-02 3 1  ON 4
ci_06                -1.873864e-02 3 1  ON 5
ci_07                 2.613758e-02 3 1  ON 6
ci_08                -4.698626e-03 3 1  ON 7
ci_09                -8.204431e-03 3 1  ON 8
ci_10                -7.648398e-03 3 1  ON 9
ci_11                 1.305177e-02 3 1  ON 10
ci_12                 7.228992e-03 3 1  ON 11
ci_13                 1.047992e-02 3 1  ON 12
ci_14                 1.910791e-02 3 1  ON 13
ci_15                 5.708249e-03 3 1  ON 14
ci_16                 6.216949e-03 3 1  ON 15
ci_17                -7.581466e-03 3 1  ON 16
ci_18                -6.551081e-03 3 1  ON 17
ci_19                 1.005809e-02 3 1  ON 18
ci_20                 7.031627e-03 3 1  ON 19
ci_21                 8.108987e-03 3 1  ON 20
ci_22                 8.411651e-03 3 1  ON 21
ci_23                 4.209630e-03 3 1  ON 22
ci_24                 6.863143e-03 3 1  ON 23
ci_25                 2.861513e-03 3 1  ON 24
ci_26                 4.095056e-03 3 1  ON 25
ci_27                 2.554165e-03 3 1  ON 26
ci_28                 1.667975e-03 3 1  ON 27
ci_29                 2.449766e-04 3 1  ON 28
ci_30                 4.320606e-05 3 1  ON 29
ci_31                -8.797140e-04 3 1  ON 30
ci_32                 1.040606e-05 3 1  ON 31
ci_33                 4.626301e-04 3 1  ON 32
ci_34                 9.501272e-05 3 1  ON 33
ci_35                 2.153946e-03 3 1  ON 34
ci_36                -4.794281e-04 3 1  ON 35
ci_37                -1.045007e-03 3 1  ON 36
ci_38                -7.281237e-04 3 1  ON 37
ci_39                -1.778349e-04 3 1  ON 38
ci_40                -1.819992e-03 3 1  ON 39
ci_41                -2.590181e-03 3 1  ON 40
ci_42                -1.478013e-03 3 1  ON 41
ci_43                -9.515351e-04 3 1  ON 42
ci_44                -1.854203e-03 3 1  ON 43
ci_45                -5.460490e-04 3 1  ON 44
ci_46                -5.020953e-04 3 1  ON 45
ci_47                 2.581217e-03 3 1  ON 46
ci_48                 2.548691e-03 3 1  ON 47
ci_49                -1.065153e-03 3 1  ON 48
ci_50                -4.909451e-04 3 1  ON 49
ci_51                -8.924634e-04 3 1  ON 50
ci_52                 9.022239e-04 3 1  ON 51
ci_53                -4.684292e-04 3 1  ON 52
ci_54                -1.712643e-03 3 1  ON 53
ci_55                -1.717682e-03 3 1  ON 54
ci_56                 2.181950e-03 3 1  ON 55
ci_57                 6.745890e-04 3 1  ON 56
ci_58                -1.000945e-04 3 1  ON 57
ci_59                 6.944862e-04 3 1  ON 58
ci_60                -5.185719e-04 3 1  ON 59
ci_61                 2.071891e-03 3 1  ON 60
ci_62                -1.333295e-04 3 1  ON 61
ci_63                 5.312679e-04 3 1  ON 62
ci_64                -1.110005e-04 3 1  ON 63
ci_65                 6.920616e-05 3 1  ON 64
ci_66                -1.566869e-04 3 1  ON 65
ci_67                -5.028342e-04 3 1  ON 66
ci_68                -2.183882e-03 3 1  ON 67
ci_69                -5.389864e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2313e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.8312
    reference variance = 0.31187
====================================================
  Execution time = 4.2594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8637e-01
  Total weights = 1.964035987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471217606326
                                         uncertainty =       0.003145673499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471217606326
                                         uncertainty =       0.003145673499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485334476
  error estimate for blocks of size 2^( 2) =       0.000507086920
  error estimate for blocks of size 2^( 3) =       0.000527318076
  error estimate for blocks of size 2^( 4) =       0.000543051132
  error estimate for blocks of size 2^( 5) =       0.000554519131
  error estimate for blocks of size 2^( 6) =       0.000560768490
  error estimate for blocks of size 2^( 7) =       0.000565278242

      target function =      -0.653240150942
              le_mean =     -22.819182953174
             les_mean =     521.201481093521
             stat err =       0.000555904249
             autocorr =       1.311951259690
   target nu stat err =       0.000555904249
   target dn stat err =       0.004561249228
      target stat err =       0.001831936356
              std dev =       0.686366598488
             le_variance =       0.471099107521


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281918295317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-05, overlap shift 1.4552e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653244827847       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653453591340       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653491529682       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653501720032       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653511756367       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653516194946       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653518778245       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653519115581       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653519867420       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653519367738       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653519497457       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653519500064       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653519508077       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.653519510928       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-05 is 7.665515e-03

solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653244827847       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653453381034       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653491265815       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653501434325       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653511445225       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653515866743       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653518440228       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653518775384       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653519523946       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653519025637       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653519154639       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653519157188       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653519165149       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.653519167996       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 7.650230e-03

solving harmonic davidson linear method for identity shift 2.3283e-04, overlap shift 2.3283e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653244827847       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653452544031       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653490215990       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653500297915       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653510208153       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653514562406       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653517097224       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653517423829       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653518159500       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653517666639       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653517792838       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653517795162       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653517802924       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.653517805755       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-04 is 7.589711e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.476826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0247e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_01                 1.169937e-01 3 1  ON 0
ci_02                -2.469940e-02 3 1  ON 1
ci_03                -2.448746e-02 3 1  ON 2
ci_04                 2.229765e-02 3 1  ON 3
ci_05                -2.017105e-02 3 1  ON 4
ci_06                -1.955393e-02 3 1  ON 5
ci_07                 2.626444e-02 3 1  ON 6
ci_08                -3.309284e-03 3 1  ON 7
ci_09                -8.347149e-03 3 1  ON 8
ci_10                -6.632907e-03 3 1  ON 9
ci_11                 1.288400e-02 3 1  ON 10
ci_12                 7.481529e-03 3 1  ON 11
ci_13                 1.243724e-02 3 1  ON 12
ci_14                 1.294527e-02 3 1  ON 13
ci_15                 5.442851e-03 3 1  ON 14
ci_16                 3.209462e-03 3 1  ON 15
ci_17                -6.033181e-03 3 1  ON 16
ci_18                -5.412004e-03 3 1  ON 17
ci_19                 1.014510e-02 3 1  ON 18
ci_20                 8.474281e-03 3 1  ON 19
ci_21                 8.508399e-03 3 1  ON 20
ci_22                 8.037573e-03 3 1  ON 21
ci_23                 4.919929e-03 3 1  ON 22
ci_24                 4.174192e-03 3 1  ON 23
ci_25                 3.917954e-03 3 1  ON 24
ci_26                 3.281112e-03 3 1  ON 25
ci_27                 2.072964e-03 3 1  ON 26
ci_28                 2.288201e-03 3 1  ON 27
ci_29                 2.225007e-03 3 1  ON 28
ci_30                -1.947583e-04 3 1  ON 29
ci_31                 2.787740e-03 3 1  ON 30
ci_32                -2.161105e-04 3 1  ON 31
ci_33                -1.937079e-03 3 1  ON 32
ci_34                 2.701883e-03 3 1  ON 33
ci_35                 1.715314e-03 3 1  ON 34
ci_36                -4.676928e-04 3 1  ON 35
ci_37                -7.996733e-05 3 1  ON 36
ci_38                -5.423834e-04 3 1  ON 37
ci_39                -6.501208e-04 3 1  ON 38
ci_40                -2.075111e-03 3 1  ON 39
ci_41                -7.042067e-04 3 1  ON 40
ci_42                -1.499117e-03 3 1  ON 41
ci_43                -1.176609e-03 3 1  ON 42
ci_44                -1.592940e-03 3 1  ON 43
ci_45                 9.613413e-04 3 1  ON 44
ci_46                 3.045411e-04 3 1  ON 45
ci_47                 3.586622e-03 3 1  ON 46
ci_48                 2.770468e-03 3 1  ON 47
ci_49                -1.085337e-03 3 1  ON 48
ci_50                -1.521115e-03 3 1  ON 49
ci_51                 3.730343e-04 3 1  ON 50
ci_52                -2.578357e-05 3 1  ON 51
ci_53                -4.955998e-04 3 1  ON 52
ci_54                 3.346537e-05 3 1  ON 53
ci_55                -1.410017e-03 3 1  ON 54
ci_56                 1.504659e-03 3 1  ON 55
ci_57                 1.233039e-03 3 1  ON 56
ci_58                -8.593098e-04 3 1  ON 57
ci_59                -4.024335e-04 3 1  ON 58
ci_60                -1.550584e-03 3 1  ON 59
ci_61                -1.334942e-03 3 1  ON 60
ci_62                -1.334480e-04 3 1  ON 61
ci_63                -3.090404e-04 3 1  ON 62
ci_64                -7.341229e-04 3 1  ON 63
ci_65                -2.014208e-03 3 1  ON 64
ci_66                -2.741255e-04 3 1  ON 65
ci_67                -1.142690e-03 3 1  ON 66
ci_68                -4.432895e-04 3 1  ON 67
ci_69                -9.026804e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.8819
    reference variance = 0.663898
====================================================
  Execution time = 4.1286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8536e-01
  Total weights = 1.9642e+06
  Execution time = 5.9515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485752684419
                                         uncertainty =       0.008742409281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485752684419
                                         uncertainty =       0.008742409281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492769904
  error estimate for blocks of size 2^( 2) =       0.000514122769
  error estimate for blocks of size 2^( 3) =       0.000534770321
  error estimate for blocks of size 2^( 4) =       0.000550326666
  error estimate for blocks of size 2^( 5) =       0.000560830845
  error estimate for blocks of size 2^( 6) =       0.000567826344
  error estimate for blocks of size 2^( 7) =       0.000572005118

      target function =      -0.595595394953
              le_mean =     -22.819302148440
             les_mean =     521.362566551625
             stat err =       0.000562747243
             autocorr =       1.304182599517
   target nu stat err =       0.000562747243
   target dn stat err =       0.090937978298
      target stat err =       0.029926756114
              std dev =       0.696881881571
             le_variance =       0.485644356862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472135477686
                                         uncertainty =       0.002567009106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472135477686
                                         uncertainty =       0.002567009106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485819556
  error estimate for blocks of size 2^( 2) =       0.000507381055
  error estimate for blocks of size 2^( 3) =       0.000528185016
  error estimate for blocks of size 2^( 4) =       0.000543734779
  error estimate for blocks of size 2^( 5) =       0.000554192250
  error estimate for blocks of size 2^( 6) =       0.000561183693
  error estimate for blocks of size 2^( 7) =       0.000565429244

      target function =      -0.653633264969
              le_mean =     -22.819137650743
             les_mean =     521.198395216617
             stat err =       0.000556134991
             autocorr =       1.310419831988
   target nu stat err =       0.000556134991
   target dn stat err =       0.003454807515
      target stat err =       0.001406403068
              std dev =       0.687052604978
             le_variance =       0.472041282007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.892409629314
                                         uncertainty =       0.391623727876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.892409629314
                                         uncertainty =       0.391623727876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000667670614
  error estimate for blocks of size 2^( 2) =       0.000683406596
  error estimate for blocks of size 2^( 3) =       0.000699371754
  error estimate for blocks of size 2^( 4) =       0.000711365649
  error estimate for blocks of size 2^( 5) =       0.000720345633
  error estimate for blocks of size 2^( 6) =       0.000725648662
  error estimate for blocks of size 2^( 7) =       0.000727331829

      target function =      -0.113388169125
              le_mean =     -22.819049327360
             les_mean =     526.163305791039
             stat err =       0.000721172944
             autocorr =       1.166686911754
   target nu stat err =       0.000721172944
   target dn stat err =       4.393644245047
      target stat err =       0.075223688554
              std dev =       0.944228836849
             le_variance =       0.891568096338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472130275184
                                         uncertainty =       0.002566459486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472130275184
                                         uncertainty =       0.002566459486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485816877
  error estimate for blocks of size 2^( 2) =       0.000507378852
  error estimate for blocks of size 2^( 3) =       0.000528183564
  error estimate for blocks of size 2^( 4) =       0.000543734160
  error estimate for blocks of size 2^( 5) =       0.000554192040
  error estimate for blocks of size 2^( 6) =       0.000561183922
  error estimate for blocks of size 2^( 7) =       0.000565429586

      target function =      -0.653598380737
              le_mean =     -22.819137674044
             les_mean =     521.198484551743
             stat err =       0.000556134927
             autocorr =       1.310433977746
   target nu stat err =       0.000556134927
   target dn stat err =       0.003455043552
      target stat err =       0.001406347850
              std dev =       0.687048816833
             le_variance =       0.472036076711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.595595394953        initial
     1.4552e-05     1.4552e-04             7.6655e-03        -0.653633264969  <--
     5.8208e-05     5.8208e-04             7.6502e-03        -0.113388169125
     2.3283e-04     2.3283e-03             7.5897e-03        -0.653598380737

*****************************************************************************
Applying the update for shift_i =   1.4552e-05     and shift_s =   1.4552e-04
*****************************************************************************

  Execution time = 7.1188e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_01                 1.170089e-01 3 1  ON 0
ci_02                -2.470178e-02 3 1  ON 1
ci_03                -2.448492e-02 3 1  ON 2
ci_04                 2.229797e-02 3 1  ON 3
ci_05                -2.017154e-02 3 1  ON 4
ci_06                -1.955451e-02 3 1  ON 5
ci_07                 2.626461e-02 3 1  ON 6
ci_08                -3.308131e-03 3 1  ON 7
ci_09                -8.347580e-03 3 1  ON 8
ci_10                -6.631884e-03 3 1  ON 9
ci_11                 1.288429e-02 3 1  ON 10
ci_12                 7.481627e-03 3 1  ON 11
ci_13                 1.244113e-02 3 1  ON 12
ci_14                 1.292930e-02 3 1  ON 13
ci_15                 5.442541e-03 3 1  ON 14
ci_16                 3.206004e-03 3 1  ON 15
ci_17                -6.031364e-03 3 1  ON 16
ci_18                -5.410999e-03 3 1  ON 17
ci_19                 1.014515e-02 3 1  ON 18
ci_20                 8.476060e-03 3 1  ON 19
ci_21                 8.509333e-03 3 1  ON 20
ci_22                 8.037042e-03 3 1  ON 21
ci_23                 4.920645e-03 3 1  ON 22
ci_24                 4.169667e-03 3 1  ON 23
ci_25                 3.919036e-03 3 1  ON 24
ci_26                 3.280360e-03 3 1  ON 25
ci_27                 2.072467e-03 3 1  ON 26
ci_28                 2.288999e-03 3 1  ON 27
ci_29                 2.227396e-03 3 1  ON 28
ci_30                -1.947521e-04 3 1  ON 29
ci_31                 2.794294e-03 3 1  ON 30
ci_32                -2.163629e-04 3 1  ON 31
ci_33                -1.939445e-03 3 1  ON 32
ci_34                 2.705076e-03 3 1  ON 33
ci_35                 1.714735e-03 3 1  ON 34
ci_36                -4.677231e-04 3 1  ON 35
ci_37                -7.898617e-05 3 1  ON 36
ci_38                -5.422403e-04 3 1  ON 37
ci_39                -6.507276e-04 3 1  ON 38
ci_40                -2.075406e-03 3 1  ON 39
ci_41                -7.023146e-04 3 1  ON 40
ci_42                -1.499199e-03 3 1  ON 41
ci_43                -1.176976e-03 3 1  ON 42
ci_44                -1.592715e-03 3 1  ON 43
ci_45                 9.629789e-04 3 1  ON 44
ci_46                 3.053396e-04 3 1  ON 45
ci_47                 3.588387e-03 3 1  ON 46
ci_48                 2.770643e-03 3 1  ON 47
ci_49                -1.085272e-03 3 1  ON 48
ci_50                -1.522105e-03 3 1  ON 49
ci_51                 3.742998e-04 3 1  ON 50
ci_52                -2.678144e-05 3 1  ON 51
ci_53                -4.956345e-04 3 1  ON 52
ci_54                 3.588997e-05 3 1  ON 53
ci_55                -1.409125e-03 3 1  ON 54
ci_56                 1.504028e-03 3 1  ON 55
ci_57                 1.233597e-03 3 1  ON 56
ci_58                -8.600482e-04 3 1  ON 57
ci_59                -4.036056e-04 3 1  ON 58
ci_60                -1.554033e-03 3 1  ON 59
ci_61                -1.343223e-03 3 1  ON 60
ci_62                -1.334159e-04 3 1  ON 61
ci_63                -3.097619e-04 3 1  ON 62
ci_64                -7.347359e-04 3 1  ON 63
ci_65                -2.016311e-03 3 1  ON 64
ci_66                -2.743171e-04 3 1  ON 65
ci_67                -1.143458e-03 3 1  ON 66
ci_68                -4.415072e-04 3 1  ON 67
ci_69                -9.033380e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2144e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.9029
    reference variance = 0.476849
====================================================
  Execution time = 4.2484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8561e-01
  Total weights = 1.964046426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470555296328
                                         uncertainty =       0.002579403630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470555296328
                                         uncertainty =       0.002579403630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485032740
  error estimate for blocks of size 2^( 2) =       0.000507074834
  error estimate for blocks of size 2^( 3) =       0.000527753190
  error estimate for blocks of size 2^( 4) =       0.000543767509
  error estimate for blocks of size 2^( 5) =       0.000553407793
  error estimate for blocks of size 2^( 6) =       0.000562240103
  error estimate for blocks of size 2^( 7) =       0.000564116458

      target function =      -0.653593113366
              le_mean =     -22.819387931987
             les_mean =     521.210077723554
             stat err =       0.000555882966
             autocorr =       1.313483501719
   target nu stat err =       0.000555882966
   target dn stat err =       0.003335316580
      target stat err =       0.001360703506
              std dev =       0.685939879384
             le_variance =       0.470513518129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281938793199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-06, overlap shift 3.6380e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653595514056       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653852247841       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653909888790       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653927920530       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653935263110       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653940178043       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653943502926       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653944373856       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653944017995       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653944214865       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653944223676       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653944319969       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653944243789       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-06 is 5.929677e-03

solving harmonic davidson linear method for identity shift 1.4552e-05, overlap shift 1.4552e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653595514056       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653852182835       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653909803592       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653927826468       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653935164089       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653940074721       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653943396457       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653944266207       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653943910494       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653944107076       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653944115856       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653944211985       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653944135898       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-05 is 5.925792e-03

solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653595514056       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653851923140       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653909463263       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653927450759       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653934768595       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653939662082       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653942971274       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653943836327       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653943481209       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653943676647       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653943685302       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653943780781       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653943705063       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 5.910299e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0144e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_01                 1.115113e-01 3 1  ON 0
ci_02                -2.431801e-02 3 1  ON 1
ci_03                -2.500698e-02 3 1  ON 2
ci_04                 2.074002e-02 3 1  ON 3
ci_05                -2.024770e-02 3 1  ON 4
ci_06                -2.035987e-02 3 1  ON 5
ci_07                 2.633676e-02 3 1  ON 6
ci_08                -4.480447e-03 3 1  ON 7
ci_09                -7.685114e-03 3 1  ON 8
ci_10                -7.435232e-03 3 1  ON 9
ci_11                 1.335391e-02 3 1  ON 10
ci_12                 7.853290e-03 3 1  ON 11
ci_13                 1.331123e-02 3 1  ON 12
ci_14                 1.885509e-02 3 1  ON 13
ci_15                 6.544373e-03 3 1  ON 14
ci_16                 6.974295e-03 3 1  ON 15
ci_17                -8.581896e-03 3 1  ON 16
ci_18                -7.442206e-03 3 1  ON 17
ci_19                 8.883899e-03 3 1  ON 18
ci_20                 4.832852e-03 3 1  ON 19
ci_21                 7.907203e-03 3 1  ON 20
ci_22                 8.262069e-03 3 1  ON 21
ci_23                 3.947370e-03 3 1  ON 22
ci_24                 2.544812e-03 3 1  ON 23
ci_25                 3.341701e-03 3 1  ON 24
ci_26                 2.372818e-03 3 1  ON 25
ci_27                 4.444288e-03 3 1  ON 26
ci_28                 1.769193e-03 3 1  ON 27
ci_29                 3.750937e-04 3 1  ON 28
ci_30                 7.498161e-04 3 1  ON 29
ci_31                 3.626909e-04 3 1  ON 30
ci_32                 1.204533e-04 3 1  ON 31
ci_33                -2.066227e-03 3 1  ON 32
ci_34                -5.921780e-04 3 1  ON 33
ci_35                 2.139441e-03 3 1  ON 34
ci_36                -7.857628e-04 3 1  ON 35
ci_37                -1.386227e-03 3 1  ON 36
ci_38                 7.488517e-05 3 1  ON 37
ci_39                 2.497087e-04 3 1  ON 38
ci_40                -1.187828e-03 3 1  ON 39
ci_41                -1.821155e-03 3 1  ON 40
ci_42                -1.474102e-03 3 1  ON 41
ci_43                 1.150990e-04 3 1  ON 42
ci_44                -1.460308e-03 3 1  ON 43
ci_45                -2.342402e-04 3 1  ON 44
ci_46                -4.593874e-04 3 1  ON 45
ci_47                -6.714568e-04 3 1  ON 46
ci_48                 5.118662e-04 3 1  ON 47
ci_49                 5.349752e-04 3 1  ON 48
ci_50                -2.155829e-04 3 1  ON 49
ci_51                 1.055972e-04 3 1  ON 50
ci_52                 8.360736e-04 3 1  ON 51
ci_53                -9.424980e-04 3 1  ON 52
ci_54                -6.971499e-04 3 1  ON 53
ci_55                -1.533890e-03 3 1  ON 54
ci_56                 2.615155e-03 3 1  ON 55
ci_57                 2.005518e-03 3 1  ON 56
ci_58                -6.813592e-04 3 1  ON 57
ci_59                -1.950951e-03 3 1  ON 58
ci_60                 1.496221e-03 3 1  ON 59
ci_61                 1.382669e-05 3 1  ON 60
ci_62                -3.236549e-05 3 1  ON 61
ci_63                -1.490713e-04 3 1  ON 62
ci_64                 8.273556e-04 3 1  ON 63
ci_65                -3.325024e-04 3 1  ON 64
ci_66                -5.536414e-04 3 1  ON 65
ci_67                 1.071352e-04 3 1  ON 66
ci_68                -1.391178e-03 3 1  ON 67
ci_69                -2.139051e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8548
    reference variance = 0.598364
====================================================
  Execution time = 4.1279e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8641e-01
  Total weights = 1.9643e+06
  Execution time = 5.9615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000753319
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512213668314
                                         uncertainty =       0.020026881676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512213668314
                                         uncertainty =       0.020026881676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506055568
  error estimate for blocks of size 2^( 2) =       0.000526345440
  error estimate for blocks of size 2^( 3) =       0.000546497237
  error estimate for blocks of size 2^( 4) =       0.000561635644
  error estimate for blocks of size 2^( 5) =       0.000572681792
  error estimate for blocks of size 2^( 6) =       0.000576598715
  error estimate for blocks of size 2^( 7) =       0.000579682580

      target function =      -0.465924604552
              le_mean =     -22.819905237547
             les_mean =     521.866505937746
             stat err =       0.000572649683
             autocorr =       1.280506045451
   target nu stat err =       0.000572649683
   target dn stat err =       0.275365315841
      target stat err =       0.056148236175
              std dev =       0.715670647989
             le_variance =       0.512184476394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472091726416
                                         uncertainty =       0.002981437059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472091726416
                                         uncertainty =       0.002981437059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485817762
  error estimate for blocks of size 2^( 2) =       0.000507271908
  error estimate for blocks of size 2^( 3) =       0.000528259714
  error estimate for blocks of size 2^( 4) =       0.000544119654
  error estimate for blocks of size 2^( 5) =       0.000555655627
  error estimate for blocks of size 2^( 6) =       0.000558951596
  error estimate for blocks of size 2^( 7) =       0.000563205824

      target function =      -0.653370689475
              le_mean =     -22.819757851189
             les_mean =     521.227755285794
             stat err =       0.000555483175
             autocorr =       1.307359541807
   target nu stat err =       0.000555483175
   target dn stat err =       0.003620614923
      target stat err =       0.001469728613
              std dev =       0.687050067248
             le_variance =       0.472037794905

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00074554
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.841069945941
                                         uncertainty =       0.347909601825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.841069945941
                                         uncertainty =       0.347909601825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000648453197
  error estimate for blocks of size 2^( 2) =       0.000665366403
  error estimate for blocks of size 2^( 3) =       0.000681307262
  error estimate for blocks of size 2^( 4) =       0.000693377937
  error estimate for blocks of size 2^( 5) =       0.000702224932
  error estimate for blocks of size 2^( 6) =       0.000705606227
  error estimate for blocks of size 2^( 7) =       0.000706485984

      target function =      -0.100610658053
              le_mean =     -22.820450295622
             les_mean =     526.621412456159
             stat err =       0.000701923770
             autocorr =       1.171716721308
   target nu stat err =       0.000701923770
   target dn stat err =       5.106221855800
      target stat err =       0.073246182735
              std dev =       0.917051305905
             le_variance =       0.840983097662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472092563368
                                         uncertainty =       0.002982032357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472092563368
                                         uncertainty =       0.002982032357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485818196
  error estimate for blocks of size 2^( 2) =       0.000507272244
  error estimate for blocks of size 2^( 3) =       0.000528259823
  error estimate for blocks of size 2^( 4) =       0.000544119660
  error estimate for blocks of size 2^( 5) =       0.000555655467
  error estimate for blocks of size 2^( 6) =       0.000558951310
  error estimate for blocks of size 2^( 7) =       0.000563205525

      target function =      -0.653373665916
              le_mean =     -22.819757938432
             les_mean =     521.227751791184
             stat err =       0.000555482991
             autocorr =       1.307356337524
   target nu stat err =       0.000555482991
   target dn stat err =       0.003620486288
      target stat err =       0.001469692258
              std dev =       0.687050681282
             le_variance =       0.472038638650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.465924604552        initial
     3.6380e-06     3.6380e-05             5.9297e-03        -0.653370689475
     1.4552e-05     1.4552e-04             5.9258e-03        -0.100610658053
     5.8208e-05     5.8208e-04             5.9103e-03        -0.653373665916  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e-05     and shift_s =   5.8208e-04
*****************************************************************************

  Execution time = 7.2384e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_01                 1.115225e-01 3 1  ON 0
ci_02                -2.431828e-02 3 1  ON 1
ci_03                -2.500595e-02 3 1  ON 2
ci_04                 2.074165e-02 3 1  ON 3
ci_05                -2.024710e-02 3 1  ON 4
ci_06                -2.035851e-02 3 1  ON 5
ci_07                 2.633643e-02 3 1  ON 6
ci_08                -4.479447e-03 3 1  ON 7
ci_09                -7.686164e-03 3 1  ON 8
ci_10                -7.434405e-03 3 1  ON 9
ci_11                 1.335329e-02 3 1  ON 10
ci_12                 7.852734e-03 3 1  ON 11
ci_13                 1.331011e-02 3 1  ON 12
ci_14                 1.883960e-02 3 1  ON 13
ci_15                 6.543220e-03 3 1  ON 14
ci_16                 6.969882e-03 3 1  ON 15
ci_17                -8.578788e-03 3 1  ON 16
ci_18                -7.439765e-03 3 1  ON 17
ci_19                 8.885123e-03 3 1  ON 18
ci_20                 4.836902e-03 3 1  ON 19
ci_21                 7.908266e-03 3 1  ON 20
ci_22                 8.261500e-03 3 1  ON 21
ci_23                 3.948304e-03 3 1  ON 22
ci_24                 2.547233e-03 3 1  ON 23
ci_25                 3.342226e-03 3 1  ON 24
ci_26                 2.373970e-03 3 1  ON 25
ci_27                 4.441467e-03 3 1  ON 26
ci_28                 1.769848e-03 3 1  ON 27
ci_29                 3.773011e-04 3 1  ON 28
ci_30                 7.485059e-04 3 1  ON 29
ci_31                 3.668749e-04 3 1  ON 30
ci_32                 1.201356e-04 3 1  ON 31
ci_33                -2.066048e-03 3 1  ON 32
ci_34                -5.882212e-04 3 1  ON 33
ci_35                 2.138961e-03 3 1  ON 34
ci_36                -7.854672e-04 3 1  ON 35
ci_37                -1.384949e-03 3 1  ON 36
ci_38                 7.421466e-05 3 1  ON 37
ci_39                 2.487307e-04 3 1  ON 38
ci_40                -1.188706e-03 3 1  ON 39
ci_41                -1.819966e-03 3 1  ON 40
ci_42                -1.474129e-03 3 1  ON 41
ci_43                 1.135228e-04 3 1  ON 42
ci_44                -1.460506e-03 3 1  ON 43
ci_45                -2.330646e-04 3 1  ON 44
ci_46                -4.585663e-04 3 1  ON 45
ci_47                -6.653582e-04 3 1  ON 46
ci_48                 5.148327e-04 3 1  ON 47
ci_49                 5.333942e-04 3 1  ON 48
ci_50                -2.167837e-04 3 1  ON 49
ci_51                 1.058266e-04 3 1  ON 50
ci_52                 8.351171e-04 3 1  ON 51
ci_53                -9.421068e-04 3 1  ON 52
ci_54                -6.959783e-04 3 1  ON 53
ci_55                -1.533317e-03 3 1  ON 54
ci_56                 2.614020e-03 3 1  ON 55
ci_57                 2.004677e-03 3 1  ON 56
ci_58                -6.813928e-04 3 1  ON 57
ci_59                -1.949240e-03 3 1  ON 58
ci_60                 1.488568e-03 3 1  ON 59
ci_61                 1.020009e-05 3 1  ON 60
ci_62                -3.243092e-05 3 1  ON 61
ci_63                -1.491913e-04 3 1  ON 62
ci_64                 8.258331e-04 3 1  ON 63
ci_65                -3.342670e-04 3 1  ON 64
ci_66                -5.533672e-04 3 1  ON 65
ci_67                 1.058618e-04 3 1  ON 66
ci_68                -1.390212e-03 3 1  ON 67
ci_69                -2.137830e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2254e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8619
    reference variance = 0.647031
====================================================
  Execution time = 4.2516e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8525e-01
  Total weights = 1.964341402e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559275022
                                         uncertainty =       0.002838395269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559275022
                                         uncertainty =       0.002838395269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486089734
  error estimate for blocks of size 2^( 2) =       0.000507761622
  error estimate for blocks of size 2^( 3) =       0.000529060305
  error estimate for blocks of size 2^( 4) =       0.000544423105
  error estimate for blocks of size 2^( 5) =       0.000554955014
  error estimate for blocks of size 2^( 6) =       0.000558897617
  error estimate for blocks of size 2^( 7) =       0.000560648534

      target function =      -0.653539811618
              le_mean =     -22.818596634968
             les_mean =     521.173599252938
             stat err =       0.000554731068
             autocorr =       1.302363093964
   target nu stat err =       0.000554731068
   target dn stat err =       0.003355266010
      target stat err =       0.001366958364
              std dev =       0.687434693780
             le_variance =       0.472566458213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281859663497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-05, overlap shift 1.4552e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653542251491       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653747799659       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653778426918       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653787299255       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653790483627       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653792747209       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653794940270       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653794649126       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653794508955       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653794342587       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653794215926       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653794282560       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653794397166       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-05 is 3.846021e-03

solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653542251491       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653747589792       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653778169658       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653787024899       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653790201351       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653792458193       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653794642904       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653794351921       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653794212096       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653794046304       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653793920294       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653793986668       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653794100701       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 3.836938e-03

solving harmonic davidson linear method for identity shift 2.3283e-04, overlap shift 2.3283e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653542251491       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653746754590       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653777146229       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653785933657       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653789078748       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653791308953       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653793460747       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653793170439       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653793031992       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653792868475       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653792745029       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653792810378       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653792922161       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-04 is 3.801033e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.488191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0998e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_01                 1.101758e-01 3 1  ON 0
ci_02                -2.645925e-02 3 1  ON 1
ci_03                -2.350105e-02 3 1  ON 2
ci_04                 2.225391e-02 3 1  ON 3
ci_05                -1.943998e-02 3 1  ON 4
ci_06                -1.929838e-02 3 1  ON 5
ci_07                 2.594720e-02 3 1  ON 6
ci_08                -3.917470e-03 3 1  ON 7
ci_09                -6.883294e-03 3 1  ON 8
ci_10                -9.042153e-03 3 1  ON 9
ci_11                 1.277465e-02 3 1  ON 10
ci_12                 8.293714e-03 3 1  ON 11
ci_13                 1.220510e-02 3 1  ON 12
ci_14                 1.500266e-02 3 1  ON 13
ci_15                 6.948369e-03 3 1  ON 14
ci_16                 5.593073e-03 3 1  ON 15
ci_17                -5.827598e-03 3 1  ON 16
ci_18                -6.485815e-03 3 1  ON 17
ci_19                 8.118021e-03 3 1  ON 18
ci_20                 6.052437e-03 3 1  ON 19
ci_21                 8.447908e-03 3 1  ON 20
ci_22                 1.026044e-02 3 1  ON 21
ci_23                 4.806207e-03 3 1  ON 22
ci_24                 3.989396e-03 3 1  ON 23
ci_25                 4.051698e-03 3 1  ON 24
ci_26                 2.008310e-03 3 1  ON 25
ci_27                 2.104009e-03 3 1  ON 26
ci_28                 1.004555e-03 3 1  ON 27
ci_29                 2.505111e-03 3 1  ON 28
ci_30                 1.847784e-04 3 1  ON 29
ci_31                -6.936307e-04 3 1  ON 30
ci_32                -6.555280e-04 3 1  ON 31
ci_33                 1.796389e-04 3 1  ON 32
ci_34                 2.303569e-03 3 1  ON 33
ci_35                 5.474547e-05 3 1  ON 34
ci_36                -1.803568e-03 3 1  ON 35
ci_37                -1.703121e-04 3 1  ON 36
ci_38                -3.648575e-04 3 1  ON 37
ci_39                -7.129804e-04 3 1  ON 38
ci_40                -1.468860e-03 3 1  ON 39
ci_41                 1.081708e-03 3 1  ON 40
ci_42                -5.234830e-05 3 1  ON 41
ci_43                -1.985474e-03 3 1  ON 42
ci_44                -7.987367e-04 3 1  ON 43
ci_45                -1.227607e-03 3 1  ON 44
ci_46                -3.585217e-04 3 1  ON 45
ci_47                 1.002484e-03 3 1  ON 46
ci_48                 1.746635e-03 3 1  ON 47
ci_49                -1.335554e-04 3 1  ON 48
ci_50                -6.725159e-04 3 1  ON 49
ci_51                -2.046212e-04 3 1  ON 50
ci_52                 2.085512e-04 3 1  ON 51
ci_53                -7.543172e-04 3 1  ON 52
ci_54                -1.444581e-03 3 1  ON 53
ci_55                -7.636105e-04 3 1  ON 54
ci_56                 1.711593e-03 3 1  ON 55
ci_57                 1.957937e-03 3 1  ON 56
ci_58                -8.794742e-04 3 1  ON 57
ci_59                -9.975282e-04 3 1  ON 58
ci_60                 3.788405e-03 3 1  ON 59
ci_61                -2.637620e-03 3 1  ON 60
ci_62                -7.221637e-04 3 1  ON 61
ci_63                -7.741292e-04 3 1  ON 62
ci_64                -7.217567e-04 3 1  ON 63
ci_65                -5.418100e-04 3 1  ON 64
ci_66                -3.747559e-04 3 1  ON 65
ci_67                -5.139857e-04 3 1  ON 66
ci_68                -1.366419e-03 3 1  ON 67
ci_69                -2.597363e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8305
    reference variance = 0.329723
====================================================
  Execution time = 4.1540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8820e-01
  Total weights = 1.9642e+06
  Execution time = 5.9489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.018942
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519312232660
                                         uncertainty =       0.038055704212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519312232660
                                         uncertainty =       0.038055704212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509563006
  error estimate for blocks of size 2^( 2) =       0.000530373654
  error estimate for blocks of size 2^( 3) =       0.000550178525
  error estimate for blocks of size 2^( 4) =       0.000565877666
  error estimate for blocks of size 2^( 5) =       0.000576245551
  error estimate for blocks of size 2^( 6) =       0.000582281231
  error estimate for blocks of size 2^( 7) =       0.000587759121

      target function =      -0.062274283403
              le_mean =     -22.818992059630
             les_mean =     529.853351970575
             stat err =       0.000578040892
             autocorr =       1.286830493794
   target nu stat err =       0.000578040892
   target dn stat err =       8.528322723342
      target stat err =       0.051485015219
              std dev =       0.720630913888
             le_variance =       0.519308914051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965869864
                                         uncertainty =       0.002271727574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471965869864
                                         uncertainty =       0.002271727574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485811484
  error estimate for blocks of size 2^( 2) =       0.000507324811
  error estimate for blocks of size 2^( 3) =       0.000528115550
  error estimate for blocks of size 2^( 4) =       0.000544325172
  error estimate for blocks of size 2^( 5) =       0.000554730757
  error estimate for blocks of size 2^( 6) =       0.000559708672
  error estimate for blocks of size 2^( 7) =       0.000565885957

      target function =      -0.652442094253
              le_mean =     -22.818920938989
             les_mean =     521.191386553317
             stat err =       0.000556162639
             autocorr =       1.310593679092
   target nu stat err =       0.000556162639
   target dn stat err =       0.003677915332
      target stat err =       0.001486593387
              std dev =       0.687041189536
             le_variance =       0.472025596120

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0185064
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479151598126
                                         uncertainty =       0.004942533191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479151598126
                                         uncertainty =       0.004942533191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489488881
  error estimate for blocks of size 2^( 2) =       0.000510880578
  error estimate for blocks of size 2^( 3) =       0.000531622265
  error estimate for blocks of size 2^( 4) =       0.000547765198
  error estimate for blocks of size 2^( 5) =       0.000558055449
  error estimate for blocks of size 2^( 6) =       0.000563048183
  error estimate for blocks of size 2^( 7) =       0.000569023920

      target function =      -0.611451190416
              le_mean =     -22.819013388387
             les_mean =     521.303619998004
             stat err =       0.000559473188
             autocorr =       1.306390141658
   target nu stat err =       0.000559473188
   target dn stat err =       0.074320992214
      target stat err =       0.025752269382
              std dev =       0.692241813908
             le_variance =       0.479198728923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471966371826
                                         uncertainty =       0.002272145505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471966371826
                                         uncertainty =       0.002272145505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485811812
  error estimate for blocks of size 2^( 2) =       0.000507324976
  error estimate for blocks of size 2^( 3) =       0.000528115244
  error estimate for blocks of size 2^( 4) =       0.000544324818
  error estimate for blocks of size 2^( 5) =       0.000554730524
  error estimate for blocks of size 2^( 6) =       0.000559709060
  error estimate for blocks of size 2^( 7) =       0.000565886487

      target function =      -0.652504148635
              le_mean =     -22.818920960171
             les_mean =     521.191230119271
             stat err =       0.000556162722
             autocorr =       1.310592301154
   target nu stat err =       0.000556162722
   target dn stat err =       0.003639956662
      target stat err =       0.001472309365
              std dev =       0.687041653220
             le_variance =       0.472026233259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.062274283403        initial
     1.4552e-05     1.4552e-04             3.8460e-03        -0.652442094253
     5.8208e-05     5.8208e-04             3.8369e-03        -0.611451190416
     2.3283e-04     2.3283e-03             3.8010e-03        -0.652504148635  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e-04     and shift_s =   2.3283e-03
*****************************************************************************

  Execution time = 7.1480e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_01                 1.101854e-01 3 1  ON 0
ci_02                -2.644819e-02 3 1  ON 1
ci_03                -2.350863e-02 3 1  ON 2
ci_04                 2.224700e-02 3 1  ON 3
ci_05                -1.944413e-02 3 1  ON 4
ci_06                -1.930359e-02 3 1  ON 5
ci_07                 2.594743e-02 3 1  ON 6
ci_08                -3.919795e-03 3 1  ON 7
ci_09                -6.887157e-03 3 1  ON 8
ci_10                -9.033745e-03 3 1  ON 9
ci_11                 1.277829e-02 3 1  ON 10
ci_12                 8.291852e-03 3 1  ON 11
ci_13                 1.221184e-02 3 1  ON 12
ci_14                 1.503857e-02 3 1  ON 13
ci_15                 6.945769e-03 3 1  ON 14
ci_16                 5.599908e-03 3 1  ON 15
ci_17                -5.841214e-03 3 1  ON 16
ci_18                -6.490617e-03 3 1  ON 17
ci_19                 8.121110e-03 3 1  ON 18
ci_20                 6.046604e-03 3 1  ON 19
ci_21                 8.445101e-03 3 1  ON 20
ci_22                 1.024886e-02 3 1  ON 21
ci_23                 4.802618e-03 3 1  ON 22
ci_24                 3.979377e-03 3 1  ON 23
ci_25                 4.048929e-03 3 1  ON 24
ci_26                 2.010309e-03 3 1  ON 25
ci_27                 2.115242e-03 3 1  ON 26
ci_28                 1.008285e-03 3 1  ON 27
ci_29                 2.495551e-03 3 1  ON 28
ci_30                 1.890625e-04 3 1  ON 29
ci_31                -6.862762e-04 3 1  ON 30
ci_32                -6.523188e-04 3 1  ON 31
ci_33                 1.707738e-04 3 1  ON 32
ci_34                 2.289483e-03 3 1  ON 33
ci_35                 6.469465e-05 3 1  ON 34
ci_36                -1.799433e-03 3 1  ON 35
ci_37                -1.750252e-04 3 1  ON 36
ci_38                -3.634143e-04 3 1  ON 37
ci_39                -7.090328e-04 3 1  ON 38
ci_40                -1.467997e-03 3 1  ON 39
ci_41                 1.069730e-03 3 1  ON 40
ci_42                -5.824374e-05 3 1  ON 41
ci_43                -1.975167e-03 3 1  ON 42
ci_44                -8.019862e-04 3 1  ON 43
ci_45                -1.223734e-03 3 1  ON 44
ci_46                -3.592539e-04 3 1  ON 45
ci_47                 9.935419e-04 3 1  ON 46
ci_48                 1.739227e-03 3 1  ON 47
ci_49                -1.310661e-04 3 1  ON 48
ci_50                -6.709354e-04 3 1  ON 49
ci_51                -2.032940e-04 3 1  ON 50
ci_52                 2.109852e-04 3 1  ON 51
ci_53                -7.549605e-04 3 1  ON 52
ci_54                -1.442142e-03 3 1  ON 53
ci_55                -7.683273e-04 3 1  ON 54
ci_56                 1.714790e-03 3 1  ON 55
ci_57                 1.958062e-03 3 1  ON 56
ci_58                -8.784984e-04 3 1  ON 57
ci_59                -1.001842e-03 3 1  ON 58
ci_60                 3.768709e-03 3 1  ON 59
ci_61                -2.611878e-03 3 1  ON 60
ci_62                -7.196153e-04 3 1  ON 61
ci_63                -7.718950e-04 3 1  ON 62
ci_64                -7.154111e-04 3 1  ON 63
ci_65                -5.409021e-04 3 1  ON 64
ci_66                -3.755579e-04 3 1  ON 65
ci_67                -5.114603e-04 3 1  ON 66
ci_68                -1.366570e-03 3 1  ON 67
ci_69                -2.595219e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7591
    reference variance = 0.373086
====================================================
  Execution time = 4.2486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8749e-01
  Total weights = 1.963948627e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470892768026
                                         uncertainty =       0.002041291174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470892768026
                                         uncertainty =       0.002041291174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485217620
  error estimate for blocks of size 2^( 2) =       0.000506587881
  error estimate for blocks of size 2^( 3) =       0.000526988494
  error estimate for blocks of size 2^( 4) =       0.000542960593
  error estimate for blocks of size 2^( 5) =       0.000552920810
  error estimate for blocks of size 2^( 6) =       0.000558620766
  error estimate for blocks of size 2^( 7) =       0.000561381983

      target function =      -0.652730390948
              le_mean =     -22.818904379666
             les_mean =     521.189889579041
             stat err =       0.000553971038
             autocorr =       1.303469862547
   target nu stat err =       0.000553971038
   target dn stat err =       0.003441037602
      target stat err =       0.001396747035
              std dev =       0.686201338564
             le_variance =       0.470872277047


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281890437967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652732941814       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653162603599       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653222004772       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653220752860       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653229790869       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653231994800       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653233673459       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653234198935       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653234305589       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653235121679       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653234812025       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653234897950       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653234866675       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 3.847037e-03

solving harmonic davidson linear method for identity shift 2.3283e-04, overlap shift 2.3283e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652732941814       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653160748833       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653219736135       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653218456626       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653227449573       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653229591605       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653231256016       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653231765327       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653231872601       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653232674422       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653232367621       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653232452259       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653232420576       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-04 is 3.828063e-03

solving harmonic davidson linear method for identity shift 9.3132e-04, overlap shift 9.3132e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652732941814       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653153487022       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653210865728       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653209487227       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653218304410       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653220212097       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653221822527       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653222271271       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653222381886       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653223128795       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653222833381       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653222913362       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653222880294       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-04 is 3.753997e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.499563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0147e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_01                 1.106167e-01 3 1  ON 0
ci_02                -2.262013e-02 3 1  ON 1
ci_03                -2.336606e-02 3 1  ON 2
ci_04                 2.112195e-02 3 1  ON 3
ci_05                -1.935634e-02 3 1  ON 4
ci_06                -2.095547e-02 3 1  ON 5
ci_07                 2.626555e-02 3 1  ON 6
ci_08                -4.113039e-03 3 1  ON 7
ci_09                -7.931067e-03 3 1  ON 8
ci_10                -8.094430e-03 3 1  ON 9
ci_11                 1.260133e-02 3 1  ON 10
ci_12                 7.799455e-03 3 1  ON 11
ci_13                 1.365826e-02 3 1  ON 12
ci_14                 1.743795e-02 3 1  ON 13
ci_15                 5.405084e-03 3 1  ON 14
ci_16                 7.635378e-03 3 1  ON 15
ci_17                -6.124724e-03 3 1  ON 16
ci_18                -6.542893e-03 3 1  ON 17
ci_19                 9.251114e-03 3 1  ON 18
ci_20                 8.018290e-03 3 1  ON 19
ci_21                 8.218624e-03 3 1  ON 20
ci_22                 7.851828e-03 3 1  ON 21
ci_23                 4.490844e-03 3 1  ON 22
ci_24                 2.587987e-03 3 1  ON 23
ci_25                 3.221168e-03 3 1  ON 24
ci_26                 3.128307e-03 3 1  ON 25
ci_27                 4.798669e-03 3 1  ON 26
ci_28                 1.541051e-03 3 1  ON 27
ci_29                 2.168668e-03 3 1  ON 28
ci_30                -1.200520e-04 3 1  ON 29
ci_31                 2.457801e-03 3 1  ON 30
ci_32                -5.201363e-04 3 1  ON 31
ci_33                 7.456284e-05 3 1  ON 32
ci_34                 2.530066e-03 3 1  ON 33
ci_35                 1.790673e-03 3 1  ON 34
ci_36                -4.428522e-04 3 1  ON 35
ci_37                -2.709602e-04 3 1  ON 36
ci_38                 7.759041e-05 3 1  ON 37
ci_39                -3.387509e-03 3 1  ON 38
ci_40                -4.733537e-04 3 1  ON 39
ci_41                -9.141246e-04 3 1  ON 40
ci_42                -3.092794e-03 3 1  ON 41
ci_43                -1.982111e-03 3 1  ON 42
ci_44                -2.232803e-03 3 1  ON 43
ci_45                -2.713688e-04 3 1  ON 44
ci_46                -9.572963e-04 3 1  ON 45
ci_47                 1.512828e-04 3 1  ON 46
ci_48                 1.453313e-03 3 1  ON 47
ci_49                -5.723189e-04 3 1  ON 48
ci_50                 5.410502e-04 3 1  ON 49
ci_51                -3.773990e-04 3 1  ON 50
ci_52                -1.106404e-03 3 1  ON 51
ci_53                -2.486288e-04 3 1  ON 52
ci_54                -1.009824e-03 3 1  ON 53
ci_55                -8.096881e-04 3 1  ON 54
ci_56                 2.061889e-03 3 1  ON 55
ci_57                 1.161549e-03 3 1  ON 56
ci_58                -8.717067e-04 3 1  ON 57
ci_59                -1.273877e-03 3 1  ON 58
ci_60                 2.656287e-03 3 1  ON 59
ci_61                -3.408816e-05 3 1  ON 60
ci_62                -4.644176e-04 3 1  ON 61
ci_63                -6.970407e-04 3 1  ON 62
ci_64                -2.243090e-04 3 1  ON 63
ci_65                -1.043924e-03 3 1  ON 64
ci_66                -5.250031e-04 3 1  ON 65
ci_67                -3.002162e-05 3 1  ON 66
ci_68                -7.642232e-04 3 1  ON 67
ci_69                -1.102385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8179
    reference variance = 0.310001
====================================================
  Execution time = 4.1223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8990e-01
  Total weights = 1.9639e+06
  Execution time = 5.9552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00297286
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481606239628
                                         uncertainty =       0.005248383479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481606239628
                                         uncertainty =       0.005248383479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490694281
  error estimate for blocks of size 2^( 2) =       0.000512293641
  error estimate for blocks of size 2^( 3) =       0.000533250527
  error estimate for blocks of size 2^( 4) =       0.000548839430
  error estimate for blocks of size 2^( 5) =       0.000559752823
  error estimate for blocks of size 2^( 6) =       0.000565069454
  error estimate for blocks of size 2^( 7) =       0.000568253410

      target function =      -0.171882867705
              le_mean =     -22.818735769208
             les_mean =     524.133572696531
             stat err =       0.000560478779
             autocorr =       1.304657020027
   target nu stat err =       0.000560478779
   target dn stat err =       2.785917884423
      target stat err =       0.103917410341
              std dev =       0.693946506934
             le_variance =       0.481561754486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473229534144
                                         uncertainty =       0.002488203369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473229534144
                                         uncertainty =       0.002488203369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486413061
  error estimate for blocks of size 2^( 2) =       0.000508302580
  error estimate for blocks of size 2^( 3) =       0.000529394355
  error estimate for blocks of size 2^( 4) =       0.000545236276
  error estimate for blocks of size 2^( 5) =       0.000556243500
  error estimate for blocks of size 2^( 6) =       0.000561286954
  error estimate for blocks of size 2^( 7) =       0.000564265192

      target function =      -0.651529943739
              le_mean =     -22.818598380635
             les_mean =     521.178779793922
             stat err =       0.000556757981
             autocorr =       1.310154300672
   target nu stat err =       0.000556757981
   target dn stat err =       0.004376092896
      target stat err =       0.001750238895
              std dev =       0.687891947077
             le_variance =       0.473195330854

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00300397
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499654809975
                                         uncertainty =       0.025680257195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499654809975
                                         uncertainty =       0.025680257195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499732487
  error estimate for blocks of size 2^( 2) =       0.000521114209
  error estimate for blocks of size 2^( 3) =       0.000541874518
  error estimate for blocks of size 2^( 4) =       0.000557440348
  error estimate for blocks of size 2^( 5) =       0.000568108334
  error estimate for blocks of size 2^( 6) =       0.000572850432
  error estimate for blocks of size 2^( 7) =       0.000575194991

      target function =      -0.439106209317
              le_mean =     -22.818687347251
             les_mean =     521.822730942108
             stat err =       0.000568398526
             autocorr =       1.293691487541
   target nu stat err =       0.000568398526
   target dn stat err =       0.612710217021
      target stat err =       0.117002923427
              std dev =       0.706728460001
             le_variance =       0.499465116176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473218617220
                                         uncertainty =       0.002490045468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473218617220
                                         uncertainty =       0.002490045468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486407472
  error estimate for blocks of size 2^( 2) =       0.000508295938
  error estimate for blocks of size 2^( 3) =       0.000529387049
  error estimate for blocks of size 2^( 4) =       0.000545228600
  error estimate for blocks of size 2^( 5) =       0.000556236514
  error estimate for blocks of size 2^( 6) =       0.000561280356
  error estimate for blocks of size 2^( 7) =       0.000564258579

      target function =      -0.651657411592
              le_mean =     -22.818598124581
             les_mean =     521.178443591660
             stat err =       0.000556751012
             autocorr =       1.310151611979
   target nu stat err =       0.000556751012
   target dn stat err =       0.004316897028
      target stat err =       0.001728100317
              std dev =       0.687884043469
             le_variance =       0.473184457259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.171882867705        initial
     5.8208e-05     5.8208e-04             3.8470e-03        -0.651529943739
     2.3283e-04     2.3283e-03             3.8281e-03        -0.439106209317
     9.3132e-04     9.3132e-03             3.7540e-03        -0.651657411592  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e-04     and shift_s =   9.3132e-03
*****************************************************************************

  Execution time = 7.1191e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_01                 1.106057e-01 3 1  ON 0
ci_02                -2.269419e-02 3 1  ON 1
ci_03                -2.337135e-02 3 1  ON 2
ci_04                 2.114138e-02 3 1  ON 3
ci_05                -1.936035e-02 3 1  ON 4
ci_06                -2.092230e-02 3 1  ON 5
ci_07                 2.625301e-02 3 1  ON 6
ci_08                -4.109804e-03 3 1  ON 7
ci_09                -7.909269e-03 3 1  ON 8
ci_10                -8.114825e-03 3 1  ON 9
ci_11                 1.260403e-02 3 1  ON 10
ci_12                 7.808391e-03 3 1  ON 11
ci_13                 1.362178e-02 3 1  ON 12
ci_14                 1.737235e-02 3 1  ON 13
ci_15                 5.437139e-03 3 1  ON 14
ci_16                 7.594344e-03 3 1  ON 15
ci_17                -6.120049e-03 3 1  ON 16
ci_18                -6.551930e-03 3 1  ON 17
ci_19                 9.232653e-03 3 1  ON 18
ci_20                 7.987828e-03 3 1  ON 19
ci_21                 8.223965e-03 3 1  ON 20
ci_22                 7.904711e-03 3 1  ON 21
ci_23                 4.496309e-03 3 1  ON 22
ci_24                 2.618057e-03 3 1  ON 23
ci_25                 3.234494e-03 3 1  ON 24
ci_26                 3.107962e-03 3 1  ON 25
ci_27                 4.749919e-03 3 1  ON 26
ci_28                 1.530083e-03 3 1  ON 27
ci_29                 2.174472e-03 3 1  ON 28
ci_30                -1.157566e-04 3 1  ON 29
ci_31                 2.387481e-03 3 1  ON 30
ci_32                -5.228887e-04 3 1  ON 31
ci_33                 7.385153e-05 3 1  ON 32
ci_34                 2.524991e-03 3 1  ON 33
ci_35                 1.758632e-03 3 1  ON 34
ci_36                -4.610109e-04 3 1  ON 35
ci_37                -2.767384e-04 3 1  ON 36
ci_38                 7.250740e-05 3 1  ON 37
ci_39                -3.338867e-03 3 1  ON 38
ci_40                -4.886635e-04 3 1  ON 39
ci_41                -8.827332e-04 3 1  ON 40
ci_42                -3.051765e-03 3 1  ON 41
ci_43                -1.984210e-03 3 1  ON 42
ci_44                -2.201108e-03 3 1  ON 43
ci_45                -2.893130e-04 3 1  ON 44
ci_46                -9.498785e-04 3 1  ON 45
ci_47                 1.825978e-04 3 1  ON 46
ci_48                 1.460646e-03 3 1  ON 47
ci_49                -5.656683e-04 3 1  ON 48
ci_50                 5.291228e-04 3 1  ON 49
ci_51                -3.755690e-04 3 1  ON 50
ci_52                -1.084198e-03 3 1  ON 51
ci_53                -2.540937e-04 3 1  ON 52
ci_54                -1.012954e-03 3 1  ON 53
ci_55                -8.042195e-04 3 1  ON 54
ci_56                 2.056344e-03 3 1  ON 55
ci_57                 1.170335e-03 3 1  ON 56
ci_58                -8.729237e-04 3 1  ON 57
ci_59                -1.268981e-03 3 1  ON 58
ci_60                 2.756056e-03 3 1  ON 59
ci_61                -1.270518e-04 3 1  ON 60
ci_62                -4.690732e-04 3 1  ON 61
ci_63                -6.989836e-04 3 1  ON 62
ci_64                -2.297334e-04 3 1  ON 63
ci_65                -1.036367e-03 3 1  ON 64
ci_66                -5.177932e-04 3 1  ON 65
ci_67                -3.886428e-05 3 1  ON 66
ci_68                -7.716125e-04 3 1  ON 67
ci_69                -1.129080e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2141e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8008
    reference variance = 0.301245
====================================================
  Execution time = 4.2521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7561e-01
  Total weights = 1.963980550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464034582179
                                         uncertainty =       0.002080396228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464034582179
                                         uncertainty =       0.002080396228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481640547
  error estimate for blocks of size 2^( 2) =       0.000503737873
  error estimate for blocks of size 2^( 3) =       0.000524711199
  error estimate for blocks of size 2^( 4) =       0.000541066211
  error estimate for blocks of size 2^( 5) =       0.000550648017
  error estimate for blocks of size 2^( 6) =       0.000557912900
  error estimate for blocks of size 2^( 7) =       0.000560346713

      target function =      -0.657494955845
              le_mean =     -22.819083300169
             les_mean =     521.186170698733
             stat err =       0.000552493460
             autocorr =       1.315855504088
   target nu stat err =       0.000552493460
   target dn stat err =       0.002583399011
      target stat err =       0.001086483821
              std dev =       0.681142594055
             le_variance =       0.463955233436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281908330017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-04, overlap shift 2.3283e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.657496325442       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.657649082624       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.657667738616       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.657678594075       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.657682369368       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.657684329465       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.657685794465       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.657686176980       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.657686076332       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.657686131161       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.657686289003       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.657686405333       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.657686332329       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-04 is 3.493023e-03

solving harmonic davidson linear method for identity shift 9.3132e-04, overlap shift 9.3132e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.657496325442       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.657646669466       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.657664914828       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.657675471717       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.657679114873       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.657680976611       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.657682360593       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.657682714116       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.657682613738       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.657682664554       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.657682809740       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.657682916446       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.657682848884       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-04 is 3.364463e-03

solving harmonic davidson linear method for identity shift 3.7253e-03, overlap shift 3.7253e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.657496325442       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.657637733737       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.657654494036       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.657663992282       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.657667177869       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.657668713166       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.657669834822       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.657670098617       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.657670002687       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.657670041862       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.657670148856       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.657670226644       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-03 is 2.934409e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.504949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1426e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_01                 1.136221e-01 3 1  ON 0
ci_02                -2.222077e-02 3 1  ON 1
ci_03                -2.578885e-02 3 1  ON 2
ci_04                 2.236595e-02 3 1  ON 3
ci_05                -1.977901e-02 3 1  ON 4
ci_06                -2.078265e-02 3 1  ON 5
ci_07                 2.466559e-02 3 1  ON 6
ci_08                -4.302276e-03 3 1  ON 7
ci_09                -8.737974e-03 3 1  ON 8
ci_10                -7.757027e-03 3 1  ON 9
ci_11                 1.310735e-02 3 1  ON 10
ci_12                 7.567707e-03 3 1  ON 11
ci_13                 1.299600e-02 3 1  ON 12
ci_14                 1.400789e-02 3 1  ON 13
ci_15                 5.696128e-03 3 1  ON 14
ci_16                 6.664822e-03 3 1  ON 15
ci_17                -5.800729e-03 3 1  ON 16
ci_18                -7.422813e-03 3 1  ON 17
ci_19                 9.624347e-03 3 1  ON 18
ci_20                 7.012240e-03 3 1  ON 19
ci_21                 9.155548e-03 3 1  ON 20
ci_22                 6.735237e-03 3 1  ON 21
ci_23                 5.072696e-03 3 1  ON 22
ci_24                 4.664478e-03 3 1  ON 23
ci_25                 3.295253e-03 3 1  ON 24
ci_26                 2.693614e-03 3 1  ON 25
ci_27                 4.033411e-03 3 1  ON 26
ci_28                 2.090032e-03 3 1  ON 27
ci_29                 1.932568e-03 3 1  ON 28
ci_30                -1.376424e-03 3 1  ON 29
ci_31                 6.557141e-04 3 1  ON 30
ci_32                -5.065391e-04 3 1  ON 31
ci_33                -7.856018e-04 3 1  ON 32
ci_34                -6.170034e-04 3 1  ON 33
ci_35                -3.141995e-04 3 1  ON 34
ci_36                -9.179514e-04 3 1  ON 35
ci_37                -1.001155e-03 3 1  ON 36
ci_38                -2.879530e-05 3 1  ON 37
ci_39                -2.178952e-04 3 1  ON 38
ci_40                -4.815834e-04 3 1  ON 39
ci_41                -1.278739e-03 3 1  ON 40
ci_42                -5.318611e-04 3 1  ON 41
ci_43                -2.657380e-03 3 1  ON 42
ci_44                -1.351236e-03 3 1  ON 43
ci_45                -3.158793e-04 3 1  ON 44
ci_46                -5.345414e-04 3 1  ON 45
ci_47                 7.772971e-04 3 1  ON 46
ci_48                -3.214498e-04 3 1  ON 47
ci_49                -9.423691e-04 3 1  ON 48
ci_50                -2.539619e-04 3 1  ON 49
ci_51                 1.288942e-04 3 1  ON 50
ci_52                 4.778602e-04 3 1  ON 51
ci_53                -5.201955e-04 3 1  ON 52
ci_54                -5.950484e-04 3 1  ON 53
ci_55                -1.072296e-03 3 1  ON 54
ci_56                 1.403905e-03 3 1  ON 55
ci_57                 1.556071e-03 3 1  ON 56
ci_58                -7.606486e-04 3 1  ON 57
ci_59                -1.400982e-03 3 1  ON 58
ci_60                 1.435268e-03 3 1  ON 59
ci_61                -8.434351e-04 3 1  ON 60
ci_62                -8.082982e-04 3 1  ON 61
ci_63                -3.430792e-04 3 1  ON 62
ci_64                -3.832823e-04 3 1  ON 63
ci_65                -6.367579e-04 3 1  ON 64
ci_66                -2.986790e-04 3 1  ON 65
ci_67                -8.553097e-04 3 1  ON 66
ci_68                -5.540752e-04 3 1  ON 67
ci_69                -1.722037e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8721
    reference variance = 0.405423
====================================================
  Execution time = 4.1536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8614e-01
  Total weights = 1.9644e+06
  Execution time = 5.9416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.17586
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509936000770
                                         uncertainty =       0.026718569236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509936000770
                                         uncertainty =       0.026718569236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504921043
  error estimate for blocks of size 2^( 2) =       0.000525570646
  error estimate for blocks of size 2^( 3) =       0.000545045101
  error estimate for blocks of size 2^( 4) =       0.000560153748
  error estimate for blocks of size 2^( 5) =       0.000571642061
  error estimate for blocks of size 2^( 6) =       0.000580491812
  error estimate for blocks of size 2^( 7) =       0.000582699713

      target function =      -0.408954982711
              le_mean =     -22.818746237179
             les_mean =     522.061991381567
             stat err =       0.000573746834
             autocorr =       1.291200428096
   target nu stat err =       0.000573746834
   target dn stat err =       0.523700525545
      target stat err =       0.084454770369
              std dev =       0.714066187516
             le_variance =       0.509890520154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471176671309
                                         uncertainty =       0.002302465771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471176671309
                                         uncertainty =       0.002302465771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485367787
  error estimate for blocks of size 2^( 2) =       0.000506827755
  error estimate for blocks of size 2^( 3) =       0.000526878488
  error estimate for blocks of size 2^( 4) =       0.000542319472
  error estimate for blocks of size 2^( 5) =       0.000554434770
  error estimate for blocks of size 2^( 6) =       0.000562956535
  error estimate for blocks of size 2^( 7) =       0.000565454729

      target function =      -0.653134421462
              le_mean =     -22.818667849760
             les_mean =     521.177921609737
             stat err =       0.000556291376
             autocorr =       1.313598835784
   target nu stat err =       0.000556291376
   target dn stat err =       0.003302339633
      target stat err =       0.001345407479
              std dev =       0.686413707629
             le_variance =       0.471163778022

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.185129
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496986317519
                                         uncertainty =       0.018174507876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496986317519
                                         uncertainty =       0.018174507876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498444149
  error estimate for blocks of size 2^( 2) =       0.000519236775
  error estimate for blocks of size 2^( 3) =       0.000538854840
  error estimate for blocks of size 2^( 4) =       0.000554132434
  error estimate for blocks of size 2^( 5) =       0.000565962457
  error estimate for blocks of size 2^( 6) =       0.000574157842
  error estimate for blocks of size 2^( 7) =       0.000577270744

      target function =      -0.388348190834
              le_mean =     -22.818713683599
             les_mean =     522.072689871327
             stat err =       0.000567880869
             autocorr =       1.298020261138
   target nu stat err =       0.000567880869
   target dn stat err =       0.776180740858
      target stat err =       0.118292009159
              std dev =       0.704906475970
             le_variance =       0.496893139865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471216534094
                                         uncertainty =       0.002310037309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471216534094
                                         uncertainty =       0.002310037309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485388392
  error estimate for blocks of size 2^( 2) =       0.000506852032
  error estimate for blocks of size 2^( 3) =       0.000526911750
  error estimate for blocks of size 2^( 4) =       0.000542358066
  error estimate for blocks of size 2^( 5) =       0.000554469482
  error estimate for blocks of size 2^( 6) =       0.000562991795
  error estimate for blocks of size 2^( 7) =       0.000565483203

      target function =      -0.652724273934
              le_mean =     -22.818671088576
             les_mean =     521.179111578988
             stat err =       0.000556325636
             autocorr =       1.313649107160
   target nu stat err =       0.000556325637
   target dn stat err =       0.003354077827
      target stat err =       0.001363528177
              std dev =       0.686442846932
             le_variance =       0.471203782105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.408954982711        initial
     2.3283e-04     2.3283e-03             3.4930e-03        -0.653134421462  <--
     9.3132e-04     9.3132e-03             3.3645e-03        -0.388348190834
     3.7253e-03     3.7253e-02             2.9344e-03        -0.652724273934

*****************************************************************************
Applying the update for shift_i =   2.3283e-04     and shift_s =   2.3283e-03
*****************************************************************************

  Execution time = 7.2453e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_01                 1.137186e-01 3 1  ON 0
ci_02                -2.221145e-02 3 1  ON 1
ci_03                -2.583467e-02 3 1  ON 2
ci_04                 2.238649e-02 3 1  ON 3
ci_05                -1.978245e-02 3 1  ON 4
ci_06                -2.077513e-02 3 1  ON 5
ci_07                 2.463709e-02 3 1  ON 6
ci_08                -4.306177e-03 3 1  ON 7
ci_09                -8.755433e-03 3 1  ON 8
ci_10                -7.751904e-03 3 1  ON 9
ci_11                 1.311312e-02 3 1  ON 10
ci_12                 7.562368e-03 3 1  ON 11
ci_13                 1.297372e-02 3 1  ON 12
ci_14                 1.387933e-02 3 1  ON 13
ci_15                 5.701237e-03 3 1  ON 14
ci_16                 6.648363e-03 3 1  ON 15
ci_17                -5.794652e-03 3 1  ON 16
ci_18                -7.438016e-03 3 1  ON 17
ci_19                 9.630244e-03 3 1  ON 18
ci_20                 6.996779e-03 3 1  ON 19
ci_21                 9.178838e-03 3 1  ON 20
ci_22                 6.706101e-03 3 1  ON 21
ci_23                 5.082179e-03 3 1  ON 22
ci_24                 4.712151e-03 3 1  ON 23
ci_25                 3.296086e-03 3 1  ON 24
ci_26                 2.687365e-03 3 1  ON 25
ci_27                 4.020736e-03 3 1  ON 26
ci_28                 2.101282e-03 3 1  ON 27
ci_29                 1.929160e-03 3 1  ON 28
ci_30                -1.411380e-03 3 1  ON 29
ci_31                 6.138447e-04 3 1  ON 30
ci_32                -5.068032e-04 3 1  ON 31
ci_33                -7.991431e-04 3 1  ON 32
ci_34                -6.761645e-04 3 1  ON 33
ci_35                -3.522456e-04 3 1  ON 34
ci_36                -9.245471e-04 3 1  ON 35
ci_37                -1.014183e-03 3 1  ON 36
ci_38                -3.069054e-05 3 1  ON 37
ci_39                -1.672725e-04 3 1  ON 38
ci_40                -4.815525e-04 3 1  ON 39
ci_41                -1.284072e-03 3 1  ON 40
ci_42                -4.906675e-04 3 1  ON 41
ci_43                -2.666928e-03 3 1  ON 42
ci_44                -1.334238e-03 3 1  ON 43
ci_45                -3.169901e-04 3 1  ON 44
ci_46                -5.285862e-04 3 1  ON 45
ci_47                 7.917726e-04 3 1  ON 46
ci_48                -3.622563e-04 3 1  ON 47
ci_49                -9.484596e-04 3 1  ON 48
ci_50                -2.646081e-04 3 1  ON 49
ci_51                 1.367426e-04 3 1  ON 50
ci_52                 5.034407e-04 3 1  ON 51
ci_53                -5.245051e-04 3 1  ON 52
ci_54                -5.828916e-04 3 1  ON 53
ci_55                -1.075226e-03 3 1  ON 54
ci_56                 1.393688e-03 3 1  ON 55
ci_57                 1.562736e-03 3 1  ON 56
ci_58                -7.578531e-04 3 1  ON 57
ci_59                -1.403489e-03 3 1  ON 58
ci_60                 1.380310e-03 3 1  ON 59
ci_61                -8.776193e-04 3 1  ON 60
ci_62                -8.134426e-04 3 1  ON 61
ci_63                -3.375689e-04 3 1  ON 62
ci_64                -3.858915e-04 3 1  ON 63
ci_65                -6.298372e-04 3 1  ON 64
ci_66                -2.939422e-04 3 1  ON 65
ci_67                -8.677187e-04 3 1  ON 66
ci_68                -5.509063e-04 3 1  ON 67
ci_69                -1.731052e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2389e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7511
    reference variance = 0.478721
====================================================
  Execution time = 4.2596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8378e-01
  Total weights = 1.963962893e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468717861250
                                         uncertainty =       0.002280087460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468717861250
                                         uncertainty =       0.002280087460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484049844
  error estimate for blocks of size 2^( 2) =       0.000505868358
  error estimate for blocks of size 2^( 3) =       0.000526503035
  error estimate for blocks of size 2^( 4) =       0.000543038505
  error estimate for blocks of size 2^( 5) =       0.000552633399
  error estimate for blocks of size 2^( 6) =       0.000557938776
  error estimate for blocks of size 2^( 7) =       0.000559562991

      target function =      -0.654094100755
              le_mean =     -22.818488631905
             les_mean =     521.167200273966
             stat err =       0.000553293418
             autocorr =       1.306564450807
   target nu stat err =       0.000553293418
   target dn stat err =       0.003196420146
      target stat err =       0.001308016377
              std dev =       0.684549854773
             le_variance =       0.468608503670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281848863190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654096284968       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654200635699       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654221737184       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654230615022       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654233061003       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654235282706       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654236482037       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654236690214       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654236870222       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654237053994       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654236923425       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654236932119       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654236940942       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 3.011123e-03

solving harmonic davidson linear method for identity shift 2.3283e-04, overlap shift 2.3283e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654096284968       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654200208936       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654221179071       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654229993610       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654232413323       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654234610435       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654235790647       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654235992269       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654236168529       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654236348003       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654236219426       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654236227807       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654236236325       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-04 is 2.981101e-03

solving harmonic davidson linear method for identity shift 9.3132e-04, overlap shift 9.3132e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654096284968       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654198536221       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654218995650       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654227565020       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654229883966       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654231987035       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654233095110       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654233272531       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654233434890       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654233598517       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654233477522       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654233484775       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654233492189       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-04 is 2.866706e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.516213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0286e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_01                 1.116607e-01 3 1  ON 0
ci_02                -2.500722e-02 3 1  ON 1
ci_03                -2.404257e-02 3 1  ON 2
ci_04                 2.175225e-02 3 1  ON 3
ci_05                -2.098168e-02 3 1  ON 4
ci_06                -1.931734e-02 3 1  ON 5
ci_07                 2.361195e-02 3 1  ON 6
ci_08                -4.064704e-03 3 1  ON 7
ci_09                -7.123774e-03 3 1  ON 8
ci_10                -9.371858e-03 3 1  ON 9
ci_11                 1.275812e-02 3 1  ON 10
ci_12                 6.965150e-03 3 1  ON 11
ci_13                 1.293159e-02 3 1  ON 12
ci_14                 1.658751e-02 3 1  ON 13
ci_15                 6.124496e-03 3 1  ON 14
ci_16                 4.662728e-03 3 1  ON 15
ci_17                -7.197173e-03 3 1  ON 16
ci_18                -5.333790e-03 3 1  ON 17
ci_19                 8.844071e-03 3 1  ON 18
ci_20                 7.657099e-03 3 1  ON 19
ci_21                 8.210435e-03 3 1  ON 20
ci_22                 8.297665e-03 3 1  ON 21
ci_23                 4.508354e-03 3 1  ON 22
ci_24                 5.453345e-03 3 1  ON 23
ci_25                 3.090836e-03 3 1  ON 24
ci_26                 2.736249e-03 3 1  ON 25
ci_27                 2.272817e-03 3 1  ON 26
ci_28                 1.775813e-03 3 1  ON 27
ci_29                 3.195968e-03 3 1  ON 28
ci_30                 2.827002e-04 3 1  ON 29
ci_31                -1.542824e-03 3 1  ON 30
ci_32                -9.520818e-04 3 1  ON 31
ci_33                -3.707926e-04 3 1  ON 32
ci_34                 1.296968e-03 3 1  ON 33
ci_35                -1.864255e-04 3 1  ON 34
ci_36                -5.456649e-04 3 1  ON 35
ci_37                -7.986218e-04 3 1  ON 36
ci_38                -1.334463e-04 3 1  ON 37
ci_39                -6.260125e-04 3 1  ON 38
ci_40                -9.869749e-04 3 1  ON 39
ci_41                -1.115814e-03 3 1  ON 40
ci_42                -6.738150e-04 3 1  ON 41
ci_43                -2.980230e-03 3 1  ON 42
ci_44                -2.122672e-03 3 1  ON 43
ci_45                 1.342676e-04 3 1  ON 44
ci_46                -8.407429e-05 3 1  ON 45
ci_47                 1.275517e-03 3 1  ON 46
ci_48                 1.891030e-03 3 1  ON 47
ci_49                -1.147548e-03 3 1  ON 48
ci_50                -6.282175e-04 3 1  ON 49
ci_51                 1.930411e-04 3 1  ON 50
ci_52                 3.591511e-04 3 1  ON 51
ci_53                -1.099344e-03 3 1  ON 52
ci_54                -1.227299e-03 3 1  ON 53
ci_55                -7.317724e-04 3 1  ON 54
ci_56                 1.799436e-03 3 1  ON 55
ci_57                 1.389270e-03 3 1  ON 56
ci_58                -2.025125e-03 3 1  ON 57
ci_59                -6.474250e-04 3 1  ON 58
ci_60                 4.361411e-03 3 1  ON 59
ci_61                 1.481394e-03 3 1  ON 60
ci_62                 1.290950e-04 3 1  ON 61
ci_63                 4.280291e-04 3 1  ON 62
ci_64                -4.481323e-04 3 1  ON 63
ci_65                -4.554675e-04 3 1  ON 64
ci_66                -2.992307e-04 3 1  ON 65
ci_67                -2.811914e-04 3 1  ON 66
ci_68                -1.214179e-03 3 1  ON 67
ci_69                -8.544913e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8081
    reference variance = 0.58749
====================================================
  Execution time = 4.1557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8697e-01
  Total weights = 1.9643e+06
  Execution time = 5.9490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0333207
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476579779303
                                         uncertainty =       0.003220326424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476579779303
                                         uncertainty =       0.003220326424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488143491
  error estimate for blocks of size 2^( 2) =       0.000510174376
  error estimate for blocks of size 2^( 3) =       0.000531329361
  error estimate for blocks of size 2^( 4) =       0.000546506581
  error estimate for blocks of size 2^( 5) =       0.000554829181
  error estimate for blocks of size 2^( 6) =       0.000559991036
  error estimate for blocks of size 2^( 7) =       0.000559983272

      target function =      -0.626439535683
              le_mean =     -22.819259062903
             les_mean =     521.274228042009
             stat err =       0.000555327518
             autocorr =       1.294205921845
   target nu stat err =       0.000555327518
   target dn stat err =       0.052033708342
      target stat err =       0.018913811574
              std dev =       0.690339145640
             le_variance =       0.476568136003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473801603985
                                         uncertainty =       0.002325163084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473801603985
                                         uncertainty =       0.002325163084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486719060
  error estimate for blocks of size 2^( 2) =       0.000508826466
  error estimate for blocks of size 2^( 3) =       0.000530090815
  error estimate for blocks of size 2^( 4) =       0.000545367208
  error estimate for blocks of size 2^( 5) =       0.000553667151
  error estimate for blocks of size 2^( 6) =       0.000558629951
  error estimate for blocks of size 2^( 7) =       0.000558444033

      target function =      -0.653006125217
              le_mean =     -22.819221894148
             les_mean =     521.203882008030
             stat err =       0.000554027086
             autocorr =       1.295702471839
   target nu stat err =       0.000554027086
   target dn stat err =       0.003219390419
      target stat err =       0.001313570857
              std dev =       0.688324695823
             le_variance =       0.473790886880

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0332093
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509907225156
                                         uncertainty =       0.026246056972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509907225156
                                         uncertainty =       0.026246056972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504909690
  error estimate for blocks of size 2^( 2) =       0.000526310634
  error estimate for blocks of size 2^( 3) =       0.000546899645
  error estimate for blocks of size 2^( 4) =       0.000561644646
  error estimate for blocks of size 2^( 5) =       0.000569491605
  error estimate for blocks of size 2^( 6) =       0.000574533614
  error estimate for blocks of size 2^( 7) =       0.000573424103

      target function =      -0.368943027427
              le_mean =     -22.819467605297
             les_mean =     522.342229971678
             stat err =       0.000569773492
             autocorr =       1.273435842676
   target nu stat err =       0.000569773492
   target dn stat err =       0.639715675386
      target stat err =       0.084847786545
              std dev =       0.714050131468
             le_variance =       0.509867590249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473779996011
                                         uncertainty =       0.002322286337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473779996011
                                         uncertainty =       0.002322286337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486707946
  error estimate for blocks of size 2^( 2) =       0.000508814578
  error estimate for blocks of size 2^( 3) =       0.000530077920
  error estimate for blocks of size 2^( 4) =       0.000545354208
  error estimate for blocks of size 2^( 5) =       0.000553655099
  error estimate for blocks of size 2^( 6) =       0.000558619895
  error estimate for blocks of size 2^( 7) =       0.000558434943

      target function =      -0.652985665434
              le_mean =     -22.819221120648
             les_mean =     521.203898081185
             stat err =       0.000554016036
             autocorr =       1.295709963293
   target nu stat err =       0.000554016036
   target dn stat err =       0.003218327014
      target stat err =       0.001313082893
              std dev =       0.688308978131
             le_variance =       0.473769249376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.626439535683        initial
     5.8208e-05     5.8208e-04             3.0111e-03        -0.653006125217  <--
     2.3283e-04     2.3283e-03             2.9811e-03        -0.368943027427
     9.3132e-04     9.3132e-03             2.8667e-03        -0.652985665434

*****************************************************************************
Applying the update for shift_i =   5.8208e-05     and shift_s =   5.8208e-04
*****************************************************************************

  Execution time = 7.1327e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_01                 1.116434e-01 3 1  ON 0
ci_02                -2.502071e-02 3 1  ON 1
ci_03                -2.403416e-02 3 1  ON 2
ci_04                 2.174966e-02 3 1  ON 3
ci_05                -2.098817e-02 3 1  ON 4
ci_06                -1.931033e-02 3 1  ON 5
ci_07                 2.360551e-02 3 1  ON 6
ci_08                -4.063597e-03 3 1  ON 7
ci_09                -7.115453e-03 3 1  ON 8
ci_10                -9.380518e-03 3 1  ON 9
ci_11                 1.275570e-02 3 1  ON 10
ci_12                 6.962853e-03 3 1  ON 11
ci_13                 1.293192e-02 3 1  ON 12
ci_14                 1.661800e-02 3 1  ON 13
ci_15                 6.126918e-03 3 1  ON 14
ci_16                 4.652611e-03 3 1  ON 15
ci_17                -7.204092e-03 3 1  ON 16
ci_18                -5.323503e-03 3 1  ON 17
ci_19                 8.840963e-03 3 1  ON 18
ci_20                 7.659831e-03 3 1  ON 19
ci_21                 8.203679e-03 3 1  ON 20
ci_22                 8.308260e-03 3 1  ON 21
ci_23                 4.506176e-03 3 1  ON 22
ci_24                 5.459742e-03 3 1  ON 23
ci_25                 3.089955e-03 3 1  ON 24
ci_26                 2.736081e-03 3 1  ON 25
ci_27                 2.264559e-03 3 1  ON 26
ci_28                 1.774148e-03 3 1  ON 27
ci_29                 3.201553e-03 3 1  ON 28
ci_30                 2.943150e-04 3 1  ON 29
ci_31                -1.556435e-03 3 1  ON 30
ci_32                -9.538024e-04 3 1  ON 31
ci_33                -3.691050e-04 3 1  ON 32
ci_34                 1.306601e-03 3 1  ON 33
ci_35                -1.860661e-04 3 1  ON 34
ci_36                -5.444310e-04 3 1  ON 35
ci_37                -7.976822e-04 3 1  ON 36
ci_38                -1.340347e-04 3 1  ON 37
ci_39                -6.281532e-04 3 1  ON 38
ci_40                -9.887940e-04 3 1  ON 39
ci_41                -1.115310e-03 3 1  ON 40
ci_42                -6.745454e-04 3 1  ON 41
ci_43                -2.982020e-03 3 1  ON 42
ci_44                -2.126432e-03 3 1  ON 43
ci_45                 1.358100e-04 3 1  ON 44
ci_46                -8.200262e-05 3 1  ON 45
ci_47                 1.276403e-03 3 1  ON 46
ci_48                 1.905480e-03 3 1  ON 47
ci_49                -1.148263e-03 3 1  ON 48
ci_50                -6.293139e-04 3 1  ON 49
ci_51                 1.931786e-04 3 1  ON 50
ci_52                 3.585824e-04 3 1  ON 51
ci_53                -1.101377e-03 3 1  ON 52
ci_54                -1.230883e-03 3 1  ON 53
ci_55                -7.310784e-04 3 1  ON 54
ci_56                 1.801017e-03 3 1  ON 55
ci_57                 1.388346e-03 3 1  ON 56
ci_58                -2.030706e-03 3 1  ON 57
ci_59                -6.442523e-04 3 1  ON 58
ci_60                 4.391433e-03 3 1  ON 59
ci_61                 1.504087e-03 3 1  ON 60
ci_62                 1.324602e-04 3 1  ON 61
ci_63                 4.309845e-04 3 1  ON 62
ci_64                -4.486624e-04 3 1  ON 63
ci_65                -4.549419e-04 3 1  ON 64
ci_66                -2.993835e-04 3 1  ON 65
ci_67                -2.788293e-04 3 1  ON 66
ci_68                -1.217046e-03 3 1  ON 67
ci_69                -8.505282e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2163e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.8427
    reference variance = 0.495052
====================================================
  Execution time = 4.2639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8281e-01
  Total weights = 1.964091605e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467836740243
                                         uncertainty =       0.002860371898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467836740243
                                         uncertainty =       0.002860371898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483618648
  error estimate for blocks of size 2^( 2) =       0.000505568222
  error estimate for blocks of size 2^( 3) =       0.000526316980
  error estimate for blocks of size 2^( 4) =       0.000541992100
  error estimate for blocks of size 2^( 5) =       0.000552209515
  error estimate for blocks of size 2^( 6) =       0.000558406808
  error estimate for blocks of size 2^( 7) =       0.000562093727

      target function =      -0.654705891269
              le_mean =     -22.819409266672
             les_mean =     521.208252955122
             stat err =       0.000553675538
             autocorr =       1.310703907398
   target nu stat err =       0.000553675538
   target dn stat err =       0.003737541640
      target stat err =       0.001520062280
              std dev =       0.683940051462
             le_variance =       0.467773993993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281940926667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-05, overlap shift 1.4552e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654709038623       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654873882986       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654903835577       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654908490549       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654909535924       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654910108124       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654909934572       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654909473787       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654909366182       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654909625946       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654909842572       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654909843690       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654909850068       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-05 is 4.256885e-03

solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654709038623       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654873709625       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654903615416       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654908259742       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654909302271       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654909872334       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654909698504       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654909238996       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654909131953       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654909390868       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654909606443       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654909607443       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654909613795       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 4.251579e-03

solving harmonic davidson linear method for identity shift 2.3283e-04, overlap shift 2.3283e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654709038623       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654873019812       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654902739752       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654907341887       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654908373153       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654908934782       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654908759879       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654908305432       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654908200603       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654908456164       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654908667608       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654908668150       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654908674400       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-04 is 4.230484e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.521860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0343e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_01                 1.128504e-01 3 1  ON 0
ci_02                -2.377186e-02 3 1  ON 1
ci_03                -2.464242e-02 3 1  ON 2
ci_04                 2.201311e-02 3 1  ON 3
ci_05                -2.076831e-02 3 1  ON 4
ci_06                -2.055714e-02 3 1  ON 5
ci_07                 2.622680e-02 3 1  ON 6
ci_08                -3.943164e-03 3 1  ON 7
ci_09                -9.350719e-03 3 1  ON 8
ci_10                -7.379762e-03 3 1  ON 9
ci_11                 1.265732e-02 3 1  ON 10
ci_12                 6.641781e-03 3 1  ON 11
ci_13                 1.341760e-02 3 1  ON 12
ci_14                 1.540176e-02 3 1  ON 13
ci_15                 6.062511e-03 3 1  ON 14
ci_16                 8.904190e-03 3 1  ON 15
ci_17                -3.531435e-03 3 1  ON 16
ci_18                -6.888366e-03 3 1  ON 17
ci_19                 9.447995e-03 3 1  ON 18
ci_20                 5.358362e-03 3 1  ON 19
ci_21                 9.991305e-03 3 1  ON 20
ci_22                 7.377695e-03 3 1  ON 21
ci_23                 4.987637e-03 3 1  ON 22
ci_24                 4.255552e-03 3 1  ON 23
ci_25                 3.448999e-03 3 1  ON 24
ci_26                 2.613592e-03 3 1  ON 25
ci_27                 1.428502e-03 3 1  ON 26
ci_28                 2.223788e-03 3 1  ON 27
ci_29                 2.244808e-03 3 1  ON 28
ci_30                 3.681408e-04 3 1  ON 29
ci_31                -1.750034e-03 3 1  ON 30
ci_32                -1.320301e-03 3 1  ON 31
ci_33                -9.259952e-04 3 1  ON 32
ci_34                 1.517574e-04 3 1  ON 33
ci_35                 1.065037e-03 3 1  ON 34
ci_36                -1.324148e-03 3 1  ON 35
ci_37                -9.948867e-04 3 1  ON 36
ci_38                -1.526588e-04 3 1  ON 37
ci_39                -4.006243e-04 3 1  ON 38
ci_40                -7.685968e-04 3 1  ON 39
ci_41                -7.105129e-04 3 1  ON 40
ci_42                -6.263167e-04 3 1  ON 41
ci_43                -1.957697e-03 3 1  ON 42
ci_44                -2.195176e-03 3 1  ON 43
ci_45                 2.930096e-04 3 1  ON 44
ci_46                -6.952421e-04 3 1  ON 45
ci_47                 1.251182e-03 3 1  ON 46
ci_48                 1.587149e-03 3 1  ON 47
ci_49                -1.087660e-03 3 1  ON 48
ci_50                -6.491755e-04 3 1  ON 49
ci_51                 2.617414e-04 3 1  ON 50
ci_52                 1.196018e-03 3 1  ON 51
ci_53                -6.807021e-04 3 1  ON 52
ci_54                -4.895623e-04 3 1  ON 53
ci_55                -1.758613e-03 3 1  ON 54
ci_56                 1.670947e-03 3 1  ON 55
ci_57                 6.880929e-04 3 1  ON 56
ci_58                -1.760442e-03 3 1  ON 57
ci_59                 1.195015e-03 3 1  ON 58
ci_60                 2.928067e-03 3 1  ON 59
ci_61                -9.616432e-04 3 1  ON 60
ci_62                -6.256667e-04 3 1  ON 61
ci_63                -6.347889e-04 3 1  ON 62
ci_64                 1.128242e-05 3 1  ON 63
ci_65                -1.714120e-03 3 1  ON 64
ci_66                -9.038369e-04 3 1  ON 65
ci_67                -7.797058e-04 3 1  ON 66
ci_68                -1.973341e-04 3 1  ON 67
ci_69                -1.146799e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7855
    reference variance = 0.36099
====================================================
  Execution time = 4.1526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8202e-01
  Total weights = 1.9639e+06
  Execution time = 5.9033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000532039
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470376623226
                                         uncertainty =       0.002362375498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470376623226
                                         uncertainty =       0.002362375498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484942783
  error estimate for blocks of size 2^( 2) =       0.000506451572
  error estimate for blocks of size 2^( 3) =       0.000527138103
  error estimate for blocks of size 2^( 4) =       0.000543326356
  error estimate for blocks of size 2^( 5) =       0.000552830177
  error estimate for blocks of size 2^( 6) =       0.000557343107
  error estimate for blocks of size 2^( 7) =       0.000560740760

      target function =      -0.562172468736
              le_mean =     -22.819311170760
             les_mean =     521.457041046163
             stat err =       0.000553560100
             autocorr =       1.303012429295
   target nu stat err =       0.000553560100
   target dn stat err =       0.187132289696
      target stat err =       0.055254132727
              std dev =       0.685812660001
             le_variance =       0.470339004618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467434622326
                                         uncertainty =       0.001805548395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467434622326
                                         uncertainty =       0.001805548395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483398276
  error estimate for blocks of size 2^( 2) =       0.000505018482
  error estimate for blocks of size 2^( 3) =       0.000525716370
  error estimate for blocks of size 2^( 4) =       0.000541958927
  error estimate for blocks of size 2^( 5) =       0.000551390757
  error estimate for blocks of size 2^( 6) =       0.000556009184
  error estimate for blocks of size 2^( 7) =       0.000559351944

      target function =      -0.654959020348
              le_mean =     -22.819160665675
             les_mean =     521.196115537010
             stat err =       0.000552177703
             autocorr =       1.304810783949
   target nu stat err =       0.000552177703
   target dn stat err =       0.002729557058
      target stat err =       0.001133826124
              std dev =       0.683628397853
             le_variance =       0.467347786351

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000530372
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475347611639
                                         uncertainty =       0.004412445104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475347611639
                                         uncertainty =       0.004412445104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487467143
  error estimate for blocks of size 2^( 2) =       0.000508915646
  error estimate for blocks of size 2^( 3) =       0.000529456053
  error estimate for blocks of size 2^( 4) =       0.000544875208
  error estimate for blocks of size 2^( 5) =       0.000554297479
  error estimate for blocks of size 2^( 6) =       0.000558759611
  error estimate for blocks of size 2^( 7) =       0.000561974102

      target function =      -0.592615423723
              le_mean =     -22.819207166155
             les_mean =     521.366690280601
             stat err =       0.000554976600
             autocorr =       1.296160099638
   target nu stat err =       0.000554976600
   target dn stat err =       0.097201198541
      target stat err =       0.031676001374
              std dev =       0.689382644351
             le_variance =       0.475248430333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467432763730
                                         uncertainty =       0.001805663074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467432763730
                                         uncertainty =       0.001805663074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483397332
  error estimate for blocks of size 2^( 2) =       0.000505017555
  error estimate for blocks of size 2^( 3) =       0.000525715687
  error estimate for blocks of size 2^( 4) =       0.000541958178
  error estimate for blocks of size 2^( 5) =       0.000551390252
  error estimate for blocks of size 2^( 6) =       0.000556008555
  error estimate for blocks of size 2^( 7) =       0.000559351550

      target function =      -0.654921257685
              le_mean =     -22.819160707282
             les_mean =     521.196212615042
             stat err =       0.000552177134
             autocorr =       1.304813186816
   target nu stat err =       0.000552177134
   target dn stat err =       0.002729308366
      target stat err =       0.001133606722
              std dev =       0.683627063452
             le_variance =       0.467345961884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.562172468736        initial
     1.4552e-05     1.4552e-04             4.2569e-03        -0.654959020348  <--
     5.8208e-05     5.8208e-04             4.2516e-03        -0.592615423723
     2.3283e-04     2.3283e-03             4.2305e-03        -0.654921257685

*****************************************************************************
Applying the update for shift_i =   1.4552e-05     and shift_s =   1.4552e-04
*****************************************************************************

  Execution time = 7.1706e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_01                 1.128527e-01 3 1  ON 0
ci_02                -2.377025e-02 3 1  ON 1
ci_03                -2.464310e-02 3 1  ON 2
ci_04                 2.201339e-02 3 1  ON 3
ci_05                -2.076785e-02 3 1  ON 4
ci_06                -2.055867e-02 3 1  ON 5
ci_07                 2.623041e-02 3 1  ON 6
ci_08                -3.943074e-03 3 1  ON 7
ci_09                -9.353656e-03 3 1  ON 8
ci_10                -7.376958e-03 3 1  ON 9
ci_11                 1.265721e-02 3 1  ON 10
ci_12                 6.641382e-03 3 1  ON 11
ci_13                 1.341835e-02 3 1  ON 12
ci_14                 1.539817e-02 3 1  ON 13
ci_15                 6.062323e-03 3 1  ON 14
ci_16                 8.909496e-03 3 1  ON 15
ci_17                -3.527075e-03 3 1  ON 16
ci_18                -6.890228e-03 3 1  ON 17
ci_19                 9.448550e-03 3 1  ON 18
ci_20                 5.355997e-03 3 1  ON 19
ci_21                 9.994144e-03 3 1  ON 20
ci_22                 7.376439e-03 3 1  ON 21
ci_23                 4.988118e-03 3 1  ON 22
ci_24                 4.253504e-03 3 1  ON 23
ci_25                 3.449386e-03 3 1  ON 24
ci_26                 2.613504e-03 3 1  ON 25
ci_27                 1.427422e-03 3 1  ON 26
ci_28                 2.224333e-03 3 1  ON 27
ci_29                 2.243753e-03 3 1  ON 28
ci_30                 3.680971e-04 3 1  ON 29
ci_31                -1.750191e-03 3 1  ON 30
ci_32                -1.320672e-03 3 1  ON 31
ci_33                -9.265489e-04 3 1  ON 32
ci_34                 1.503490e-04 3 1  ON 33
ci_35                 1.066545e-03 3 1  ON 34
ci_36                -1.324957e-03 3 1  ON 35
ci_37                -9.951346e-04 3 1  ON 36
ci_38                -1.527102e-04 3 1  ON 37
ci_39                -4.004081e-04 3 1  ON 38
ci_40                -7.684271e-04 3 1  ON 39
ci_41                -7.100437e-04 3 1  ON 40
ci_42                -6.263305e-04 3 1  ON 41
ci_43                -1.956558e-03 3 1  ON 42
ci_44                -2.195298e-03 3 1  ON 43
ci_45                 2.931582e-04 3 1  ON 44
ci_46                -6.958966e-04 3 1  ON 45
ci_47                 1.251160e-03 3 1  ON 46
ci_48                 1.586327e-03 3 1  ON 47
ci_49                -1.087573e-03 3 1  ON 48
ci_50                -6.492348e-04 3 1  ON 49
ci_51                 2.618203e-04 3 1  ON 50
ci_52                 1.196886e-03 3 1  ON 51
ci_53                -6.803438e-04 3 1  ON 52
ci_54                -4.886185e-04 3 1  ON 53
ci_55                -1.759683e-03 3 1  ON 54
ci_56                 1.670899e-03 3 1  ON 55
ci_57                 6.874299e-04 3 1  ON 56
ci_58                -1.760150e-03 3 1  ON 57
ci_59                 1.196934e-03 3 1  ON 58
ci_60                 2.924688e-03 3 1  ON 59
ci_61                -9.671686e-04 3 1  ON 60
ci_62                -6.263712e-04 3 1  ON 61
ci_63                -6.357728e-04 3 1  ON 62
ci_64                 1.179755e-05 3 1  ON 63
ci_65                -1.715313e-03 3 1  ON 64
ci_66                -9.044785e-04 3 1  ON 65
ci_67                -7.802359e-04 3 1  ON 66
ci_68                -1.962592e-04 3 1  ON 67
ci_69                -1.147126e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2206e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.81
    reference variance = 0.331027
====================================================
  Execution time = 4.4225e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8483e-01
  Total weights = 1.964240002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469359016458
                                         uncertainty =       0.003262672690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469359016458
                                         uncertainty =       0.003262672690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484482923
  error estimate for blocks of size 2^( 2) =       0.000505886086
  error estimate for blocks of size 2^( 3) =       0.000526583470
  error estimate for blocks of size 2^( 4) =       0.000543670316
  error estimate for blocks of size 2^( 5) =       0.000553265975
  error estimate for blocks of size 2^( 6) =       0.000558844661
  error estimate for blocks of size 2^( 7) =       0.000564656475

      target function =      -0.653725202418
              le_mean =     -22.818685452860
             les_mean =     521.177238039691
             stat err =       0.000555109357
             autocorr =       1.312804774818
   target nu stat err =       0.000555109357
   target dn stat err =       0.003738795101
      target stat err =       0.001515282874
              std dev =       0.685162320540
             le_variance =       0.469447405488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281868545286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-06, overlap shift 3.6380e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653728271554       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653913415556       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653947053321       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653949731235       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653951927166       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653954222316       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653956629431       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653957233328       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653957537030       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653957507860       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653957422975       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653957483463       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-06 is 3.807799e-03

solving harmonic davidson linear method for identity shift 1.4552e-05, overlap shift 1.4552e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653728271554       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653913367958       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653946993165       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653949668918       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653951863484       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653954157218       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653956562594       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653957165907       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653957469271       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653957440073       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653957355284       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653957415709       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-05 is 3.806287e-03

solving harmonic davidson linear method for identity shift 5.8208e-05, overlap shift 5.8208e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653728271554       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653913177812       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653946752872       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653949420003       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653951609128       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653953897210       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653956295653       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653956896637       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653957198655       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653957169345       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653957084937       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653957145111       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-05 is 3.800247e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.531976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1942e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_01                 1.128577e-01 3 1  ON 0
ci_02                -2.414520e-02 3 1  ON 1
ci_03                -2.294273e-02 3 1  ON 2
ci_04                 2.133803e-02 3 1  ON 3
ci_05                -1.876296e-02 3 1  ON 4
ci_06                -1.959713e-02 3 1  ON 5
ci_07                 2.665825e-02 3 1  ON 6
ci_08                -4.364231e-03 3 1  ON 7
ci_09                -8.185109e-03 3 1  ON 8
ci_10                -8.019083e-03 3 1  ON 9
ci_11                 1.231718e-02 3 1  ON 10
ci_12                 9.453686e-03 3 1  ON 11
ci_13                 1.111564e-02 3 1  ON 12
ci_14                 1.745727e-02 3 1  ON 13
ci_15                 6.201960e-03 3 1  ON 14
ci_16                 5.597530e-03 3 1  ON 15
ci_17                -5.566037e-03 3 1  ON 16
ci_18                -5.095512e-03 3 1  ON 17
ci_19                 9.124265e-03 3 1  ON 18
ci_20                 5.667620e-03 3 1  ON 19
ci_21                 9.342917e-03 3 1  ON 20
ci_22                 7.602945e-03 3 1  ON 21
ci_23                 4.824616e-03 3 1  ON 22
ci_24                 8.059790e-03 3 1  ON 23
ci_25                 3.111443e-03 3 1  ON 24
ci_26                 2.551966e-03 3 1  ON 25
ci_27                 1.903542e-03 3 1  ON 26
ci_28                 7.330529e-04 3 1  ON 27
ci_29                 2.148355e-03 3 1  ON 28
ci_30                -2.550187e-03 3 1  ON 29
ci_31                -4.267109e-04 3 1  ON 30
ci_32                -8.128427e-04 3 1  ON 31
ci_33                -1.956203e-03 3 1  ON 32
ci_34                 3.382634e-03 3 1  ON 33
ci_35                -1.565101e-04 3 1  ON 34
ci_36                -2.820549e-04 3 1  ON 35
ci_37                -7.402404e-04 3 1  ON 36
ci_38                 2.506581e-04 3 1  ON 37
ci_39                -1.280304e-04 3 1  ON 38
ci_40                -1.284845e-03 3 1  ON 39
ci_41                -3.017996e-04 3 1  ON 40
ci_42                -3.308368e-04 3 1  ON 41
ci_43                -1.606095e-03 3 1  ON 42
ci_44                -9.022512e-04 3 1  ON 43
ci_45                 1.551236e-04 3 1  ON 44
ci_46                 1.810982e-04 3 1  ON 45
ci_47                 1.785972e-03 3 1  ON 46
ci_48                 9.911055e-04 3 1  ON 47
ci_49                -1.382188e-03 3 1  ON 48
ci_50                -7.189745e-04 3 1  ON 49
ci_51                 9.120275e-04 3 1  ON 50
ci_52                 1.559988e-04 3 1  ON 51
ci_53                -8.521379e-04 3 1  ON 52
ci_54                -8.625516e-04 3 1  ON 53
ci_55                -2.307451e-03 3 1  ON 54
ci_56                 2.025386e-03 3 1  ON 55
ci_57                 1.212979e-03 3 1  ON 56
ci_58                -1.441835e-04 3 1  ON 57
ci_59                -4.674319e-04 3 1  ON 58
ci_60                 2.233346e-03 3 1  ON 59
ci_61                 4.818152e-04 3 1  ON 60
ci_62                 1.434158e-04 3 1  ON 61
ci_63                 8.126260e-05 3 1  ON 62
ci_64                 6.350852e-04 3 1  ON 63
ci_65                 3.467773e-04 3 1  ON 64
ci_66                -6.280088e-04 3 1  ON 65
ci_67                -2.909652e-04 3 1  ON 66
ci_68                -8.169309e-04 3 1  ON 67
ci_69                -1.591623e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7676
    reference variance = 0.377573
====================================================
  Execution time = 4.1453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8561e-01
  Total weights = 1.9640e+06
  Execution time = 5.9086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475273519337
                                         uncertainty =       0.003517329374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475273519337
                                         uncertainty =       0.003517329374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487468876
  error estimate for blocks of size 2^( 2) =       0.000509413114
  error estimate for blocks of size 2^( 3) =       0.000530166265
  error estimate for blocks of size 2^( 4) =       0.000546409918
  error estimate for blocks of size 2^( 5) =       0.000556095310
  error estimate for blocks of size 2^( 6) =       0.000560674439
  error estimate for blocks of size 2^( 7) =       0.000563499873

      target function =      -0.630357743905
              le_mean =     -22.819295691407
             les_mean =     521.266296063764
             stat err =       0.000556669885
             autocorr =       1.304072303266
   target nu stat err =       0.000556669885
   target dn stat err =       0.028329211709
      target stat err =       0.010423922743
              std dev =       0.689385095236
             le_variance =       0.475251809533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470291709133
                                         uncertainty =       0.002185448866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470291709133
                                         uncertainty =       0.002185448866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484911810
  error estimate for blocks of size 2^( 2) =       0.000507019980
  error estimate for blocks of size 2^( 3) =       0.000527907824
  error estimate for blocks of size 2^( 4) =       0.000544201491
  error estimate for blocks of size 2^( 5) =       0.000553976231
  error estimate for blocks of size 2^( 6) =       0.000558671231
  error estimate for blocks of size 2^( 7) =       0.000561372264

      target function =      -0.653533157980
              le_mean =     -22.819131806170
             les_mean =     521.198379743092
             stat err =       0.000554555304
             autocorr =       1.307868872004
   target nu stat err =       0.000554555304
   target dn stat err =       0.002998685640
      target stat err =       0.001231463172
              std dev =       0.685768858843
             le_variance =       0.470278927758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558156082240
                                         uncertainty =       0.080395712313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.558156082240
                                         uncertainty =       0.080395712313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000528034328
  error estimate for blocks of size 2^( 2) =       0.000548305117
  error estimate for blocks of size 2^( 3) =       0.000567580273
  error estimate for blocks of size 2^( 4) =       0.000582628702
  error estimate for blocks of size 2^( 5) =       0.000592047400
  error estimate for blocks of size 2^( 6) =       0.000596375508
  error estimate for blocks of size 2^( 7) =       0.000597590042

      target function =      -0.173877781611
              le_mean =     -22.819081736743
             les_mean =     524.210516205171
             stat err =       0.000592160413
             autocorr =       1.257634452975
   target nu stat err =       0.000592160413
   target dn stat err =       2.689990778418
      target stat err =       0.100190412104
              std dev =       0.746753308405
             le_variance =       0.557640503614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470291320608
                                         uncertainty =       0.002185581264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470291320608
                                         uncertainty =       0.002185581264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484911612
  error estimate for blocks of size 2^( 2) =       0.000507019722
  error estimate for blocks of size 2^( 3) =       0.000527907478
  error estimate for blocks of size 2^( 4) =       0.000544201125
  error estimate for blocks of size 2^( 5) =       0.000553975820
  error estimate for blocks of size 2^( 6) =       0.000558670953
  error estimate for blocks of size 2^( 7) =       0.000561372082

      target function =      -0.653523459399
              le_mean =     -22.819131762177
             les_mean =     521.198402240848
             stat err =       0.000554554995
             autocorr =       1.307868483243
   target nu stat err =       0.000554554995
   target dn stat err =       0.003001793586
      target stat err =       0.001232609601
              std dev =       0.685768578304
             le_variance =       0.470278542989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.630357743905        initial
     3.6380e-06     3.6380e-05             3.8078e-03        -0.653533157980  <--
     1.4552e-05     1.4552e-04             3.8063e-03        -0.173877781611
     5.8208e-05     5.8208e-04             3.8002e-03        -0.653523459399

*****************************************************************************
Applying the update for shift_i =   3.6380e-06     and shift_s =   3.6380e-05
*****************************************************************************

  Execution time = 7.1036e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_01                 1.128578e-01 3 1  ON 0
ci_02                -2.414537e-02 3 1  ON 1
ci_03                -2.294223e-02 3 1  ON 2
ci_04                 2.133787e-02 3 1  ON 3
ci_05                -1.876237e-02 3 1  ON 4
ci_06                -1.959681e-02 3 1  ON 5
ci_07                 2.665837e-02 3 1  ON 6
ci_08                -4.364324e-03 3 1  ON 7
ci_09                -8.184746e-03 3 1  ON 8
ci_10                -8.019333e-03 3 1  ON 9
ci_11                 1.231694e-02 3 1  ON 10
ci_12                 9.454395e-03 3 1  ON 11
ci_13                 1.111455e-02 3 1  ON 12
ci_14                 1.745851e-02 3 1  ON 13
ci_15                 6.202012e-03 3 1  ON 14
ci_16                 5.596542e-03 3 1  ON 15
ci_17                -5.566622e-03 3 1  ON 16
ci_18                -5.094977e-03 3 1  ON 17
ci_19                 9.124166e-03 3 1  ON 18
ci_20                 5.667670e-03 3 1  ON 19
ci_21                 9.342683e-03 3 1  ON 20
ci_22                 7.602897e-03 3 1  ON 21
ci_23                 4.824581e-03 3 1  ON 22
ci_24                 8.061303e-03 3 1  ON 23
ci_25                 3.111352e-03 3 1  ON 24
ci_26                 2.551954e-03 3 1  ON 25
ci_27                 1.903695e-03 3 1  ON 26
ci_28                 7.326231e-04 3 1  ON 27
ci_29                 2.148343e-03 3 1  ON 28
ci_30                -2.551466e-03 3 1  ON 29
ci_31                -4.263236e-04 3 1  ON 30
ci_32                -8.127221e-04 3 1  ON 31
ci_33                -1.956463e-03 3 1  ON 32
ci_34                 3.383569e-03 3 1  ON 33
ci_35                -1.568821e-04 3 1  ON 34
ci_36                -2.818144e-04 3 1  ON 35
ci_37                -7.401809e-04 3 1  ON 36
ci_38                 2.507755e-04 3 1  ON 37
ci_39                -1.279600e-04 3 1  ON 38
ci_40                -1.284952e-03 3 1  ON 39
ci_41                -3.016988e-04 3 1  ON 40
ci_42                -3.307344e-04 3 1  ON 41
ci_43                -1.605980e-03 3 1  ON 42
ci_44                -9.018776e-04 3 1  ON 43
ci_45                 1.550797e-04 3 1  ON 44
ci_46                 1.812986e-04 3 1  ON 45
ci_47                 1.786182e-03 3 1  ON 46
ci_48                 9.908027e-04 3 1  ON 47
ci_49                -1.382282e-03 3 1  ON 48
ci_50                -7.189848e-04 3 1  ON 49
ci_51                 9.122005e-04 3 1  ON 50
ci_52                 1.557319e-04 3 1  ON 51
ci_53                -8.521925e-04 3 1  ON 52
ci_54                -8.626993e-04 3 1  ON 53
ci_55                -2.307649e-03 3 1  ON 54
ci_56                 2.025482e-03 3 1  ON 55
ci_57                 1.213115e-03 3 1  ON 56
ci_58                -1.437557e-04 3 1  ON 57
ci_59                -4.678825e-04 3 1  ON 58
ci_60                 2.233014e-03 3 1  ON 59
ci_61                 4.827224e-04 3 1  ON 60
ci_62                 1.435930e-04 3 1  ON 61
ci_63                 8.142405e-05 3 1  ON 62
ci_64                 6.352250e-04 3 1  ON 63
ci_65                 3.473017e-04 3 1  ON 64
ci_66                -6.279120e-04 3 1  ON 65
ci_67                -2.908391e-04 3 1  ON 66
ci_68                -8.171104e-04 3 1  ON 67
ci_69                -1.591749e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2299e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.816
    reference variance = 0.339687
====================================================
  Execution time = 4.2615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9258e-01
  Total weights = 1.964220597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469664817389
                                         uncertainty =       0.002497970617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469664817389
                                         uncertainty =       0.002497970617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484612467
  error estimate for blocks of size 2^( 2) =       0.000506371347
  error estimate for blocks of size 2^( 3) =       0.000526752291
  error estimate for blocks of size 2^( 4) =       0.000542228778
  error estimate for blocks of size 2^( 5) =       0.000551646113
  error estimate for blocks of size 2^( 6) =       0.000557690139
  error estimate for blocks of size 2^( 7) =       0.000561255618

      target function =      -0.650746708031
              le_mean =     -22.819042043898
             les_mean =     521.201260189482
             stat err =       0.000553205162
             autocorr =       1.303116617714
   target nu stat err =       0.000553205162
   target dn stat err =       0.009473359733
      target stat err =       0.003726273067
              std dev =       0.685345523178
             le_variance =       0.469698486140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281904204390e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-07, overlap shift 9.0949e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650767663293       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651454638636       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651613837190       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651657478646       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651686490189       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651696288530       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651696533110       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651696544099       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651697707519       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651697873228       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651697765725       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651697760030       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-07 is 7.891748e-03

solving harmonic davidson linear method for identity shift 3.6380e-06, overlap shift 3.6380e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650767663293       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651454593824       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651613776765       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651657412002       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651686418376       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651696214521       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651696458681       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651696469593       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651697632737       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651697798341       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651697690864       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651697685171       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-06 is 7.890680e-03

solving harmonic davidson linear method for identity shift 1.4552e-05, overlap shift 1.4552e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650767663293       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651454414634       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651613535152       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651657145527       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651686131242       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651695918610       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651696161093       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651696171697       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651697333734       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651697498924       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651697391548       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651697385865       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-05 is 7.886412e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.542121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0345e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_01                 1.049671e-01 3 1  ON 0
ci_02                -2.907607e-02 3 1  ON 1
ci_03                -2.507717e-02 3 1  ON 2
ci_04                 2.251407e-02 3 1  ON 3
ci_05                -2.165705e-02 3 1  ON 4
ci_06                -2.116448e-02 3 1  ON 5
ci_07                 3.189447e-02 3 1  ON 6
ci_08                -3.957044e-03 3 1  ON 7
ci_09                -7.008303e-03 3 1  ON 8
ci_10                -6.877722e-03 3 1  ON 9
ci_11                 1.292911e-02 3 1  ON 10
ci_12                 7.554031e-03 3 1  ON 11
ci_13                 1.630669e-02 3 1  ON 12
ci_14                 2.288978e-02 3 1  ON 13
ci_15                 5.835423e-03 3 1  ON 14
ci_16                 6.972654e-03 3 1  ON 15
ci_17                -5.073269e-03 3 1  ON 16
ci_18                -5.321213e-03 3 1  ON 17
ci_19                 7.250805e-03 3 1  ON 18
ci_20                 6.545731e-03 3 1  ON 19
ci_21                 1.546820e-02 3 1  ON 20
ci_22                 1.200002e-02 3 1  ON 21
ci_23                 5.154211e-03 3 1  ON 22
ci_24                 4.855617e-03 3 1  ON 23
ci_25                 1.699482e-03 3 1  ON 24
ci_26                 3.357810e-03 3 1  ON 25
ci_27                 4.895626e-03 3 1  ON 26
ci_28                 2.399708e-03 3 1  ON 27
ci_29                 7.583093e-04 3 1  ON 28
ci_30                 6.007559e-04 3 1  ON 29
ci_31                -5.496679e-05 3 1  ON 30
ci_32                -1.110926e-03 3 1  ON 31
ci_33                 2.306944e-05 3 1  ON 32
ci_34                -1.593378e-03 3 1  ON 33
ci_35                -5.826106e-03 3 1  ON 34
ci_36                -4.823130e-04 3 1  ON 35
ci_37                 2.003135e-03 3 1  ON 36
ci_38                -1.135354e-03 3 1  ON 37
ci_39                -2.208322e-04 3 1  ON 38
ci_40                -8.703264e-04 3 1  ON 39
ci_41                -3.621561e-04 3 1  ON 40
ci_42                -2.234562e-04 3 1  ON 41
ci_43                -2.795116e-03 3 1  ON 42
ci_44                -1.762847e-03 3 1  ON 43
ci_45                 8.924745e-04 3 1  ON 44
ci_46                -3.476300e-04 3 1  ON 45
ci_47                 3.190343e-03 3 1  ON 46
ci_48                 2.424932e-03 3 1  ON 47
ci_49                -4.128339e-04 3 1  ON 48
ci_50                -1.143678e-03 3 1  ON 49
ci_51                 3.074483e-04 3 1  ON 50
ci_52                 6.992888e-04 3 1  ON 51
ci_53                -6.607215e-04 3 1  ON 52
ci_54                 3.123951e-04 3 1  ON 53
ci_55                -5.695620e-06 3 1  ON 54
ci_56                 1.848605e-03 3 1  ON 55
ci_57                 1.607594e-03 3 1  ON 56
ci_58                -1.146200e-03 3 1  ON 57
ci_59                -1.731639e-03 3 1  ON 58
ci_60                -1.255538e-03 3 1  ON 59
ci_61                -1.460550e-03 3 1  ON 60
ci_62                -8.584800e-04 3 1  ON 61
ci_63                -1.243748e-03 3 1  ON 62
ci_64                -6.654290e-04 3 1  ON 63
ci_65                -5.572178e-04 3 1  ON 64
ci_66                 9.700534e-04 3 1  ON 65
ci_67                -3.656507e-04 3 1  ON 66
ci_68                 1.542251e-05 3 1  ON 67
ci_69                -2.249522e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8032
    reference variance = 0.860805
====================================================
  Execution time = 4.1280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8079e-01
  Total weights = 1.9640e+06
  Execution time = 5.9100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0459348
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      24.065734293268
                                         uncertainty =      23.401002429494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      24.065734293268
                                         uncertainty =      23.401002429494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.003467205179
  error estimate for blocks of size 2^( 2) =       0.003470696662
  error estimate for blocks of size 2^( 3) =       0.003473796089
  error estimate for blocks of size 2^( 4) =       0.003477107626
  error estimate for blocks of size 2^( 5) =       0.003479965002
  error estimate for blocks of size 2^( 6) =       0.003480160701
  error estimate for blocks of size 2^( 7) =       0.003479362350

      target function =      -0.005242300622
              le_mean =     -22.814576704712
             les_mean =     625.384091129047
             stat err =       0.003479148920
             autocorr =       1.006901416101
   target nu stat err =       0.003479148920
   target dn stat err =     103.708338322585
      target stat err =       0.005126220270
              std dev =       4.903368587195
             le_variance =      24.043023501888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467150820428
                                         uncertainty =       0.002202110031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467150820428
                                         uncertainty =       0.002202110031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483286808
  error estimate for blocks of size 2^( 2) =       0.000505468433
  error estimate for blocks of size 2^( 3) =       0.000526180746
  error estimate for blocks of size 2^( 4) =       0.000542229228
  error estimate for blocks of size 2^( 5) =       0.000553281081
  error estimate for blocks of size 2^( 6) =       0.000558727157
  error estimate for blocks of size 2^( 7) =       0.000560109277

      target function =      -0.655066841484
              le_mean =     -22.817650479752
             les_mean =     521.125961843255
             stat err =       0.000553586686
             autocorr =       1.312083248915
   target nu stat err =       0.000553586686
   target dn stat err =       0.002910089173
      target stat err =       0.001201412193
              std dev =       0.683470758779
             le_variance =       0.467132278107

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0448664
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504628867670
                                         uncertainty =       0.019723121177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504628867670
                                         uncertainty =       0.019723121177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502577989
  error estimate for blocks of size 2^( 2) =       0.000523947964
  error estimate for blocks of size 2^( 3) =       0.000544039062
  error estimate for blocks of size 2^( 4) =       0.000559959183
  error estimate for blocks of size 2^( 5) =       0.000570342901
  error estimate for blocks of size 2^( 6) =       0.000575259470
  error estimate for blocks of size 2^( 7) =       0.000576945745

      target function =      -0.583197298888
              le_mean =     -22.818391118249
             les_mean =     521.360548714405
             stat err =       0.000570626825
             autocorr =       1.289132147556
   target nu stat err =       0.000570626825
   target dn stat err =       0.076529590106
      target stat err =       0.024108351177
              std dev =       0.710752608437
             le_variance =       0.505169270400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467150714435
                                         uncertainty =       0.002202137429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467150714435
                                         uncertainty =       0.002202137429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483286752
  error estimate for blocks of size 2^( 2) =       0.000505468345
  error estimate for blocks of size 2^( 3) =       0.000526180623
  error estimate for blocks of size 2^( 4) =       0.000542229037
  error estimate for blocks of size 2^( 5) =       0.000553280864
  error estimate for blocks of size 2^( 6) =       0.000558726881
  error estimate for blocks of size 2^( 7) =       0.000560109038

      target function =      -0.655066062436
              le_mean =     -22.817650487206
             les_mean =     521.125964152287
             stat err =       0.000553586455
             autocorr =       1.312082464070
   target nu stat err =       0.000553586455
   target dn stat err =       0.002910337035
      target stat err =       0.001201503786
              std dev =       0.683470678668
             le_variance =       0.467132168599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.005242300622        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 70.8726
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_01                 1.128578e-01 3 1  ON 0
ci_02                -2.414537e-02 3 1  ON 1
ci_03                -2.294223e-02 3 1  ON 2
ci_04                 2.133787e-02 3 1  ON 3
ci_05                -1.876237e-02 3 1  ON 4
ci_06                -1.959681e-02 3 1  ON 5
ci_07                 2.665837e-02 3 1  ON 6
ci_08                -4.364324e-03 3 1  ON 7
ci_09                -8.184746e-03 3 1  ON 8
ci_10                -8.019333e-03 3 1  ON 9
ci_11                 1.231694e-02 3 1  ON 10
ci_12                 9.454395e-03 3 1  ON 11
ci_13                 1.111455e-02 3 1  ON 12
ci_14                 1.745851e-02 3 1  ON 13
ci_15                 6.202012e-03 3 1  ON 14
ci_16                 5.596542e-03 3 1  ON 15
ci_17                -5.566622e-03 3 1  ON 16
ci_18                -5.094977e-03 3 1  ON 17
ci_19                 9.124166e-03 3 1  ON 18
ci_20                 5.667670e-03 3 1  ON 19
ci_21                 9.342683e-03 3 1  ON 20
ci_22                 7.602897e-03 3 1  ON 21
ci_23                 4.824581e-03 3 1  ON 22
ci_24                 8.061303e-03 3 1  ON 23
ci_25                 3.111352e-03 3 1  ON 24
ci_26                 2.551954e-03 3 1  ON 25
ci_27                 1.903695e-03 3 1  ON 26
ci_28                 7.326231e-04 3 1  ON 27
ci_29                 2.148343e-03 3 1  ON 28
ci_30                -2.551466e-03 3 1  ON 29
ci_31                -4.263236e-04 3 1  ON 30
ci_32                -8.127221e-04 3 1  ON 31
ci_33                -1.956463e-03 3 1  ON 32
ci_34                 3.383569e-03 3 1  ON 33
ci_35                -1.568821e-04 3 1  ON 34
ci_36                -2.818144e-04 3 1  ON 35
ci_37                -7.401809e-04 3 1  ON 36
ci_38                 2.507755e-04 3 1  ON 37
ci_39                -1.279600e-04 3 1  ON 38
ci_40                -1.284952e-03 3 1  ON 39
ci_41                -3.016988e-04 3 1  ON 40
ci_42                -3.307344e-04 3 1  ON 41
ci_43                -1.605980e-03 3 1  ON 42
ci_44                -9.018776e-04 3 1  ON 43
ci_45                 1.550797e-04 3 1  ON 44
ci_46                 1.812986e-04 3 1  ON 45
ci_47                 1.786182e-03 3 1  ON 46
ci_48                 9.908027e-04 3 1  ON 47
ci_49                -1.382282e-03 3 1  ON 48
ci_50                -7.189848e-04 3 1  ON 49
ci_51                 9.122005e-04 3 1  ON 50
ci_52                 1.557319e-04 3 1  ON 51
ci_53                -8.521925e-04 3 1  ON 52
ci_54                -8.626993e-04 3 1  ON 53
ci_55                -2.307649e-03 3 1  ON 54
ci_56                 2.025482e-03 3 1  ON 55
ci_57                 1.213115e-03 3 1  ON 56
ci_58                -1.437557e-04 3 1  ON 57
ci_59                -4.678825e-04 3 1  ON 58
ci_60                 2.233014e-03 3 1  ON 59
ci_61                 4.827224e-04 3 1  ON 60
ci_62                 1.435930e-04 3 1  ON 61
ci_63                 8.142405e-05 3 1  ON 62
ci_64                 6.352250e-04 3 1  ON 63
ci_65                 3.473017e-04 3 1  ON 64
ci_66                -6.279120e-04 3 1  ON 65
ci_67                -2.908391e-04 3 1  ON 66
ci_68                -8.171104e-04 3 1  ON 67
ci_69                -1.591749e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2123e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7729
    reference variance = 0.272718
====================================================
  Execution time = 4.4116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8291e-01
  Total weights = 1.964234673e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466930337080
                                         uncertainty =       0.002173164124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466930337080
                                         uncertainty =       0.002173164124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483211635
  error estimate for blocks of size 2^( 2) =       0.000504872278
  error estimate for blocks of size 2^( 3) =       0.000525592115
  error estimate for blocks of size 2^( 4) =       0.000542165961
  error estimate for blocks of size 2^( 5) =       0.000552073211
  error estimate for blocks of size 2^( 6) =       0.000557597037
  error estimate for blocks of size 2^( 7) =       0.000559418124

      target function =      -0.654449810539
              le_mean =     -22.818536122888
             les_mean =     521.168498035200
             stat err =       0.000552813583
             autocorr =       1.308828203758
   target nu stat err =       0.000552813583
   target dn stat err =       0.003477156052
      target stat err =       0.001417155078
              std dev =       0.683364448074
             le_variance =       0.466986968892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281853612289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654452413186       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654581058569       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654606161929       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654613947009       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654622617908       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654624278020       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654625421424       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654626043177       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654626070827       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654625991026       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654625899933       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654625837891       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 7.742006e-03

solving harmonic davidson linear method for identity shift 3.6380e-05, overlap shift 3.6380e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654452413186       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654580975520       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654606054962       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654613828737       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654622484385       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654624139735       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654625280440       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654625900724       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654625928093       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654625848379       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654625757526       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654625695685       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-05 is 7.732293e-03

solving harmonic davidson linear method for identity shift 1.4552e-04, overlap shift 1.4552e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654452413186       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654580644391       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654605628585       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654613357411       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654621952482       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654623588974       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654624718985       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654625333446       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654625359707       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654625280339       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654625190440       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654625129392       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-04 is 7.693686e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.547013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1733e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_01                 1.051255e-01 3 1  ON 0
ci_02                -2.495803e-02 3 1  ON 1
ci_03                -2.409317e-02 3 1  ON 2
ci_04                 2.107430e-02 3 1  ON 3
ci_05                -1.906166e-02 3 1  ON 4
ci_06                -2.146174e-02 3 1  ON 5
ci_07                 2.636495e-02 3 1  ON 6
ci_08                -4.307796e-03 3 1  ON 7
ci_09                -8.418273e-03 3 1  ON 8
ci_10                -8.393048e-03 3 1  ON 9
ci_11                 1.250406e-02 3 1  ON 10
ci_12                 7.559608e-03 3 1  ON 11
ci_13                 1.244884e-02 3 1  ON 12
ci_14                 1.718033e-02 3 1  ON 13
ci_15                 6.198275e-03 3 1  ON 14
ci_16                 5.846857e-03 3 1  ON 15
ci_17                -6.067644e-03 3 1  ON 16
ci_18                -7.085523e-03 3 1  ON 17
ci_19                 9.151494e-03 3 1  ON 18
ci_20                 6.467401e-03 3 1  ON 19
ci_21                 7.653732e-03 3 1  ON 20
ci_22                 8.222386e-03 3 1  ON 21
ci_23                 5.587169e-03 3 1  ON 22
ci_24                 5.361156e-03 3 1  ON 23
ci_25                 3.399690e-03 3 1  ON 24
ci_26                 2.633399e-03 3 1  ON 25
ci_27                 3.121258e-03 3 1  ON 26
ci_28                 1.293663e-03 3 1  ON 27
ci_29                 1.061211e-03 3 1  ON 28
ci_30                 6.064984e-04 3 1  ON 29
ci_31                -1.015706e-03 3 1  ON 30
ci_32                 4.618758e-04 3 1  ON 31
ci_33                -9.838718e-04 3 1  ON 32
ci_34                 1.164658e-03 3 1  ON 33
ci_35                 1.076421e-03 3 1  ON 34
ci_36                -1.144080e-03 3 1  ON 35
ci_37                -1.072789e-03 3 1  ON 36
ci_38                -1.056070e-03 3 1  ON 37
ci_39                -4.145326e-04 3 1  ON 38
ci_40                -8.079430e-04 3 1  ON 39
ci_41                 4.651048e-04 3 1  ON 40
ci_42                -9.786133e-04 3 1  ON 41
ci_43                -1.573732e-03 3 1  ON 42
ci_44                -1.965117e-03 3 1  ON 43
ci_45                -7.898789e-04 3 1  ON 44
ci_46                -4.499060e-04 3 1  ON 45
ci_47                 1.132729e-03 3 1  ON 46
ci_48                 1.337546e-03 3 1  ON 47
ci_49                -7.699321e-04 3 1  ON 48
ci_50                -9.763913e-04 3 1  ON 49
ci_51                 7.755646e-04 3 1  ON 50
ci_52                 2.997674e-04 3 1  ON 51
ci_53                -4.529694e-04 3 1  ON 52
ci_54                -1.607571e-03 3 1  ON 53
ci_55                -5.407851e-04 3 1  ON 54
ci_56                 2.641839e-03 3 1  ON 55
ci_57                 1.616712e-03 3 1  ON 56
ci_58                -5.010699e-04 3 1  ON 57
ci_59                -6.896003e-04 3 1  ON 58
ci_60                -2.507129e-04 3 1  ON 59
ci_61                 5.151812e-04 3 1  ON 60
ci_62                -6.187238e-04 3 1  ON 61
ci_63                 3.676172e-05 3 1  ON 62
ci_64                -5.685098e-04 3 1  ON 63
ci_65                -6.089679e-04 3 1  ON 64
ci_66                -1.333790e-03 3 1  ON 65
ci_67                -9.239082e-04 3 1  ON 66
ci_68                -1.647379e-03 3 1  ON 67
ci_69                -1.936682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8501
    reference variance = 0.347665
====================================================
  Execution time = 4.2304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7580e-01
  Total weights = 1.9641e+06
  Execution time = 5.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0414285
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465661120804
                                         uncertainty =       0.002245989133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465661120804
                                         uncertainty =       0.002245989133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482500012
  error estimate for blocks of size 2^( 2) =       0.000504644833
  error estimate for blocks of size 2^( 3) =       0.000525595554
  error estimate for blocks of size 2^( 4) =       0.000540800635
  error estimate for blocks of size 2^( 5) =       0.000549949112
  error estimate for blocks of size 2^( 6) =       0.000555509123
  error estimate for blocks of size 2^( 7) =       0.000558249705

      target function =      -0.629476016582
              le_mean =     -22.819023406092
             les_mean =     521.255861157770
             stat err =       0.000551127144
             autocorr =       1.304694840051
   target nu stat err =       0.000551127144
   target dn stat err =       0.035240074543
      target stat err =       0.012926929132
              std dev =       0.682358061232
             le_variance =       0.465612523728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463110858176
                                         uncertainty =       0.002151058200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463110858176
                                         uncertainty =       0.002151058200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481178482
  error estimate for blocks of size 2^( 2) =       0.000503437209
  error estimate for blocks of size 2^( 3) =       0.000524507028
  error estimate for blocks of size 2^( 4) =       0.000539766094
  error estimate for blocks of size 2^( 5) =       0.000548882325
  error estimate for blocks of size 2^( 6) =       0.000554444013
  error estimate for blocks of size 2^( 7) =       0.000557106597

      target function =      -0.657357876158
              le_mean =     -22.818852753596
             les_mean =     521.175844263546
             stat err =       0.000550049757
             autocorr =       1.306747142621
   target nu stat err =       0.000550049757
   target dn stat err =       0.002538613214
      target stat err =       0.001068347006
              std dev =       0.680489135255
             le_variance =       0.463065463200

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0400419
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472385538889
                                         uncertainty =       0.007053890464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472385538889
                                         uncertainty =       0.007053890464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485981203
  error estimate for blocks of size 2^( 2) =       0.000508126368
  error estimate for blocks of size 2^( 3) =       0.000529157790
  error estimate for blocks of size 2^( 4) =       0.000544299666
  error estimate for blocks of size 2^( 5) =       0.000553295842
  error estimate for blocks of size 2^( 6) =       0.000558748809
  error estimate for blocks of size 2^( 7) =       0.000561114398

      target function =      -0.555704688736
              le_mean =     -22.819018003466
             les_mean =     521.455795925654
             stat err =       0.000554364679
             autocorr =       1.301224285674
   target nu stat err =       0.000554364679
   target dn stat err =       0.233821414376
      target stat err =       0.067790685757
              std dev =       0.687281207699
             le_variance =       0.472355458456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463111093755
                                         uncertainty =       0.002151046038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463111093755
                                         uncertainty =       0.002151046038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481178606
  error estimate for blocks of size 2^( 2) =       0.000503436970
  error estimate for blocks of size 2^( 3) =       0.000524506341
  error estimate for blocks of size 2^( 4) =       0.000539765130
  error estimate for blocks of size 2^( 5) =       0.000548881365
  error estimate for blocks of size 2^( 6) =       0.000554443116
  error estimate for blocks of size 2^( 7) =       0.000557105822

      target function =      -0.657353142031
              le_mean =     -22.818852885775
             les_mean =     521.175862225469
             stat err =       0.000550048858
             autocorr =       1.306742199894
   target nu stat err =       0.000550048858
   target dn stat err =       0.002538637465
      target stat err =       0.001068341537
              std dev =       0.680489309978
             le_variance =       0.463065700994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.629476016582        initial
     9.0949e-06     9.0949e-05             7.7420e-03        -0.657357876158  <--
     3.6380e-05     3.6380e-04             7.7323e-03        -0.555704688736
     1.4552e-04     1.4552e-03             7.6937e-03        -0.657353142031

*****************************************************************************
Applying the update for shift_i =   9.0949e-06     and shift_s =   9.0949e-05
*****************************************************************************

  Execution time = 7.1877e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_01                 1.051158e-01 3 1  ON 0
ci_02                -2.495872e-02 3 1  ON 1
ci_03                -2.409423e-02 3 1  ON 2
ci_04                 2.107407e-02 3 1  ON 3
ci_05                -1.906214e-02 3 1  ON 4
ci_06                -2.146347e-02 3 1  ON 5
ci_07                 2.636486e-02 3 1  ON 6
ci_08                -4.307688e-03 3 1  ON 7
ci_09                -8.418307e-03 3 1  ON 8
ci_10                -8.393241e-03 3 1  ON 9
ci_11                 1.250458e-02 3 1  ON 10
ci_12                 7.558439e-03 3 1  ON 11
ci_13                 1.245066e-02 3 1  ON 12
ci_14                 1.717973e-02 3 1  ON 13
ci_15                 6.198188e-03 3 1  ON 14
ci_16                 5.846959e-03 3 1  ON 15
ci_17                -6.068039e-03 3 1  ON 16
ci_18                -7.087065e-03 3 1  ON 17
ci_19                 9.151507e-03 3 1  ON 18
ci_20                 6.467971e-03 3 1  ON 19
ci_21                 7.652161e-03 3 1  ON 20
ci_22                 8.223234e-03 3 1  ON 21
ci_23                 5.587616e-03 3 1  ON 22
ci_24                 5.358398e-03 3 1  ON 23
ci_25                 3.399901e-03 3 1  ON 24
ci_26                 2.633424e-03 3 1  ON 25
ci_27                 3.122102e-03 3 1  ON 26
ci_28                 1.293982e-03 3 1  ON 27
ci_29                 1.060382e-03 3 1  ON 28
ci_30                 6.097535e-04 3 1  ON 29
ci_31                -1.016167e-03 3 1  ON 30
ci_32                 4.626615e-04 3 1  ON 31
ci_33                -9.832803e-04 3 1  ON 32
ci_34                 1.163025e-03 3 1  ON 33
ci_35                 1.077283e-03 3 1  ON 34
ci_36                -1.144571e-03 3 1  ON 35
ci_37                -1.072982e-03 3 1  ON 36
ci_38                -1.056952e-03 3 1  ON 37
ci_39                -4.147096e-04 3 1  ON 38
ci_40                -8.076149e-04 3 1  ON 39
ci_41                 4.655298e-04 3 1  ON 40
ci_42                -9.790620e-04 3 1  ON 41
ci_43                -1.573650e-03 3 1  ON 42
ci_44                -1.965873e-03 3 1  ON 43
ci_45                -7.904629e-04 3 1  ON 44
ci_46                -4.502901e-04 3 1  ON 45
ci_47                 1.132001e-03 3 1  ON 46
ci_48                 1.338202e-03 3 1  ON 47
ci_49                -7.694835e-04 3 1  ON 48
ci_50                -9.765270e-04 3 1  ON 49
ci_51                 7.754977e-04 3 1  ON 50
ci_52                 2.998651e-04 3 1  ON 51
ci_53                -4.527212e-04 3 1  ON 52
ci_54                -1.608096e-03 3 1  ON 53
ci_55                -5.395313e-04 3 1  ON 54
ci_56                 2.642209e-03 3 1  ON 55
ci_57                 1.616958e-03 3 1  ON 56
ci_58                -5.012682e-04 3 1  ON 57
ci_59                -6.897574e-04 3 1  ON 58
ci_60                -2.540538e-04 3 1  ON 59
ci_61                 5.151302e-04 3 1  ON 60
ci_62                -6.191648e-04 3 1  ON 61
ci_63                 3.670554e-05 3 1  ON 62
ci_64                -5.693137e-04 3 1  ON 63
ci_65                -6.095926e-04 3 1  ON 64
ci_66                -1.334257e-03 3 1  ON 65
ci_67                -9.243689e-04 3 1  ON 66
ci_68                -1.647857e-03 3 1  ON 67
ci_69                -1.936819e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2362e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.9104
    reference variance = 0.351443
====================================================
  Execution time = 4.2543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8175e-01
  Total weights = 1.964315969e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469516699880
                                         uncertainty =       0.002130835723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469516699880
                                         uncertainty =       0.002130835723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484532506
  error estimate for blocks of size 2^( 2) =       0.000506444636
  error estimate for blocks of size 2^( 3) =       0.000527022999
  error estimate for blocks of size 2^( 4) =       0.000542830788
  error estimate for blocks of size 2^( 5) =       0.000551684848
  error estimate for blocks of size 2^( 6) =       0.000557464257
  error estimate for blocks of size 2^( 7) =       0.000560010589

      target function =      -0.655034924117
              le_mean =     -22.819027306110
             les_mean =     521.189753000590
             stat err =       0.000552997621
             autocorr =       1.302568854666
   target nu stat err =       0.000552997621
   target dn stat err =       0.002831542260
      target stat err =       0.001172819080
              std dev =       0.685232440982
             le_variance =       0.469543498174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281902730611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-06, overlap shift 2.2737e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655036600344       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655176863150       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655188753621       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655193375574       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655200013355       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655201699183       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655202584659       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655203080997       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655203164483       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655203148178       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655203164852       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655203148852       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-06 is 3.119006e-03

solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655036600344       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655176840436       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655188727892       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655193348507       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655199983975       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655201668783       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655202553727       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655203049758       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655203133161       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655203116852       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655203133511       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655203117517       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 3.117918e-03

solving harmonic davidson linear method for identity shift 3.6380e-05, overlap shift 3.6380e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655036600344       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655176749653       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655188625063       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655193240334       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655199866564       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655201547300       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655202430122       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655202924925       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655203008001       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655202991678       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655203008272       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655202992302       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-05 is 3.113576e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.557243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0160e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_01                 1.080263e-01 3 1  ON 0
ci_02                -2.587792e-02 3 1  ON 1
ci_03                -2.396178e-02 3 1  ON 2
ci_04                 2.130628e-02 3 1  ON 3
ci_05                -1.975615e-02 3 1  ON 4
ci_06                -2.037899e-02 3 1  ON 5
ci_07                 2.654896e-02 3 1  ON 6
ci_08                -3.876862e-03 3 1  ON 7
ci_09                -8.794173e-03 3 1  ON 8
ci_10                -6.002146e-03 3 1  ON 9
ci_11                 1.344940e-02 3 1  ON 10
ci_12                 7.027488e-03 3 1  ON 11
ci_13                 1.120685e-02 3 1  ON 12
ci_14                 1.714987e-02 3 1  ON 13
ci_15                 6.185799e-03 3 1  ON 14
ci_16                 6.590552e-03 3 1  ON 15
ci_17                -5.619921e-03 3 1  ON 16
ci_18                -8.936794e-03 3 1  ON 17
ci_19                 9.846610e-03 3 1  ON 18
ci_20                 6.926822e-03 3 1  ON 19
ci_21                 8.100831e-03 3 1  ON 20
ci_22                 7.310693e-03 3 1  ON 21
ci_23                 5.116743e-03 3 1  ON 22
ci_24                 6.021632e-03 3 1  ON 23
ci_25                 3.308377e-03 3 1  ON 24
ci_26                 1.561593e-03 3 1  ON 25
ci_27                 2.760591e-03 3 1  ON 26
ci_28                 9.472035e-04 3 1  ON 27
ci_29                 3.253910e-03 3 1  ON 28
ci_30                 9.586612e-05 3 1  ON 29
ci_31                 5.773646e-04 3 1  ON 30
ci_32                -3.551281e-04 3 1  ON 31
ci_33                -1.215691e-03 3 1  ON 32
ci_34                 7.925886e-04 3 1  ON 33
ci_35                 2.584472e-03 3 1  ON 34
ci_36                -1.878590e-03 3 1  ON 35
ci_37                -8.432355e-04 3 1  ON 36
ci_38                -1.446514e-07 3 1  ON 37
ci_39                -5.104645e-04 3 1  ON 38
ci_40                -8.615364e-04 3 1  ON 39
ci_41                 1.762552e-04 3 1  ON 40
ci_42                -1.421021e-03 3 1  ON 41
ci_43                -1.096171e-03 3 1  ON 42
ci_44                -4.232046e-03 3 1  ON 43
ci_45                -2.283953e-04 3 1  ON 44
ci_46                 1.221814e-04 3 1  ON 45
ci_47                 2.284466e-03 3 1  ON 46
ci_48                 2.689010e-04 3 1  ON 47
ci_49                -1.029651e-04 3 1  ON 48
ci_50                -6.800926e-04 3 1  ON 49
ci_51                -1.886549e-04 3 1  ON 50
ci_52                 2.546124e-04 3 1  ON 51
ci_53                -5.734463e-04 3 1  ON 52
ci_54                -1.939877e-03 3 1  ON 53
ci_55                -9.041631e-04 3 1  ON 54
ci_56                 2.458595e-03 3 1  ON 55
ci_57                 2.010908e-03 3 1  ON 56
ci_58                -9.996002e-04 3 1  ON 57
ci_59                -1.841905e-04 3 1  ON 58
ci_60                 2.863864e-03 3 1  ON 59
ci_61                 1.852483e-03 3 1  ON 60
ci_62                -8.299541e-05 3 1  ON 61
ci_63                 3.584809e-04 3 1  ON 62
ci_64                 4.659455e-04 3 1  ON 63
ci_65                -7.006590e-04 3 1  ON 64
ci_66                -2.713371e-04 3 1  ON 65
ci_67                -1.651588e-04 3 1  ON 66
ci_68                 1.280723e-03 3 1  ON 67
ci_69                -8.921467e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7103
    reference variance = 0.345807
====================================================
  Execution time = 4.1337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8916e-01
  Total weights = 1.9640e+06
  Execution time = 5.9135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0110426
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475890254785
                                         uncertainty =       0.003817419755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475890254785
                                         uncertainty =       0.003817419755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487807478
  error estimate for blocks of size 2^( 2) =       0.000509408157
  error estimate for blocks of size 2^( 3) =       0.000529937576
  error estimate for blocks of size 2^( 4) =       0.000545559480
  error estimate for blocks of size 2^( 5) =       0.000556641080
  error estimate for blocks of size 2^( 6) =       0.000562498361
  error estimate for blocks of size 2^( 7) =       0.000565852691

      target function =      -0.630678572506
              le_mean =     -22.819233970087
             les_mean =     521.262511911395
             stat err =       0.000557637903
             autocorr =       1.306795600644
   target nu stat err =       0.000557637903
   target dn stat err =       0.030074679351
      target stat err =       0.011076606454
              std dev =       0.689863951114
             le_variance =       0.475912271047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472380928512
                                         uncertainty =       0.003112241413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472380928512
                                         uncertainty =       0.003112241413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486008592
  error estimate for blocks of size 2^( 2) =       0.000507663113
  error estimate for blocks of size 2^( 3) =       0.000528221149
  error estimate for blocks of size 2^( 4) =       0.000543866440
  error estimate for blocks of size 2^( 5) =       0.000554927716
  error estimate for blocks of size 2^( 6) =       0.000560737121
  error estimate for blocks of size 2^( 7) =       0.000564212122

      target function =      -0.652125319978
              le_mean =     -22.819113444796
             les_mean =     521.201095928696
             stat err =       0.000555935850
             autocorr =       1.308463060933
   target nu stat err =       0.000555935850
   target dn stat err =       0.004087346380
      target stat err =       0.001642753533
              std dev =       0.687319942704
             le_variance =       0.472408703639

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0108938
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474715385358
                                         uncertainty =       0.003202746706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474715385358
                                         uncertainty =       0.003202746706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487206335
  error estimate for blocks of size 2^( 2) =       0.000508800863
  error estimate for blocks of size 2^( 3) =       0.000529329067
  error estimate for blocks of size 2^( 4) =       0.000544955773
  error estimate for blocks of size 2^( 5) =       0.000556079865
  error estimate for blocks of size 2^( 6) =       0.000561890664
  error estimate for blocks of size 2^( 7) =       0.000565411593

      target function =      -0.608827810099
              le_mean =     -22.819234644625
             les_mean =     521.321921875459
             stat err =       0.000557084474
             autocorr =       1.307423407381
   target nu stat err =       0.000557084474
   target dn stat err =       0.068601914221
      target stat err =       0.023565765298
              std dev =       0.689013806412
             le_variance =       0.474740025427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472380369099
                                         uncertainty =       0.003112261078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472380369099
                                         uncertainty =       0.003112261078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486008305
  error estimate for blocks of size 2^( 2) =       0.000507662862
  error estimate for blocks of size 2^( 3) =       0.000528220922
  error estimate for blocks of size 2^( 4) =       0.000543866250
  error estimate for blocks of size 2^( 5) =       0.000554927589
  error estimate for blocks of size 2^( 6) =       0.000560737067
  error estimate for blocks of size 2^( 7) =       0.000564212074

      target function =      -0.652122372880
              le_mean =     -22.819113463538
             les_mean =     521.201104293255
             stat err =       0.000555935745
             autocorr =       1.308464115137
   target nu stat err =       0.000555935745
   target dn stat err =       0.004085970086
      target stat err =       0.001642208922
              std dev =       0.687319536404
             le_variance =       0.472408145122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.630678572506        initial
     2.2737e-06     2.2737e-05             3.1190e-03        -0.652125319978  <--
     9.0949e-06     9.0949e-05             3.1179e-03        -0.608827810099
     3.6380e-05     3.6380e-04             3.1136e-03        -0.652122372880

*****************************************************************************
Applying the update for shift_i =   2.2737e-06     and shift_s =   2.2737e-05
*****************************************************************************

  Execution time = 7.1032e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_01                 1.080272e-01 3 1  ON 0
ci_02                -2.587808e-02 3 1  ON 1
ci_03                -2.396175e-02 3 1  ON 2
ci_04                 2.130632e-02 3 1  ON 3
ci_05                -1.975624e-02 3 1  ON 4
ci_06                -2.037878e-02 3 1  ON 5
ci_07                 2.654896e-02 3 1  ON 6
ci_08                -3.876807e-03 3 1  ON 7
ci_09                -8.794256e-03 3 1  ON 8
ci_10                -6.001677e-03 3 1  ON 9
ci_11                 1.344957e-02 3 1  ON 10
ci_12                 7.027388e-03 3 1  ON 11
ci_13                 1.120653e-02 3 1  ON 12
ci_14                 1.714994e-02 3 1  ON 13
ci_15                 6.185804e-03 3 1  ON 14
ci_16                 6.590729e-03 3 1  ON 15
ci_17                -5.619848e-03 3 1  ON 16
ci_18                -8.937120e-03 3 1  ON 17
ci_19                 9.846714e-03 3 1  ON 18
ci_20                 6.926895e-03 3 1  ON 19
ci_21                 8.100957e-03 3 1  ON 20
ci_22                 7.310414e-03 3 1  ON 21
ci_23                 5.116667e-03 3 1  ON 22
ci_24                 6.021811e-03 3 1  ON 23
ci_25                 3.308363e-03 3 1  ON 24
ci_26                 1.561405e-03 3 1  ON 25
ci_27                 2.760525e-03 3 1  ON 26
ci_28                 9.471477e-04 3 1  ON 27
ci_29                 3.254307e-03 3 1  ON 28
ci_30                 9.568199e-05 3 1  ON 29
ci_31                 5.777629e-04 3 1  ON 30
ci_32                -3.552542e-04 3 1  ON 31
ci_33                -1.215722e-03 3 1  ON 32
ci_34                 7.925288e-04 3 1  ON 33
ci_35                 2.584740e-03 3 1  ON 34
ci_36                -1.878706e-03 3 1  ON 35
ci_37                -8.431954e-04 3 1  ON 36
ci_38                 2.977781e-08 3 1  ON 37
ci_39                -5.104867e-04 3 1  ON 38
ci_40                -8.615497e-04 3 1  ON 39
ci_41                 1.762113e-04 3 1  ON 40
ci_42                -1.421095e-03 3 1  ON 41
ci_43                -1.096095e-03 3 1  ON 42
ci_44                -4.232455e-03 3 1  ON 43
ci_45                -2.283148e-04 3 1  ON 44
ci_46                 1.222715e-04 3 1  ON 45
ci_47                 2.284782e-03 3 1  ON 46
ci_48                 2.686404e-04 3 1  ON 47
ci_49                -1.028743e-04 3 1  ON 48
ci_50                -6.800518e-04 3 1  ON 49
ci_51                -1.888017e-04 3 1  ON 50
ci_52                 2.546133e-04 3 1  ON 51
ci_53                -5.734671e-04 3 1  ON 52
ci_54                -1.939929e-03 3 1  ON 53
ci_55                -9.042265e-04 3 1  ON 54
ci_56                 2.458564e-03 3 1  ON 55
ci_57                 2.010961e-03 3 1  ON 56
ci_58                -9.996952e-04 3 1  ON 57
ci_59                -1.841070e-04 3 1  ON 58
ci_60                 2.864952e-03 3 1  ON 59
ci_61                 1.852928e-03 3 1  ON 60
ci_62                -8.292198e-05 3 1  ON 61
ci_63                 3.585223e-04 3 1  ON 62
ci_64                 4.661082e-04 3 1  ON 63
ci_65                -7.006750e-04 3 1  ON 64
ci_66                -2.711656e-04 3 1  ON 65
ci_67                -1.650313e-04 3 1  ON 66
ci_68                 1.281223e-03 3 1  ON 67
ci_69                -8.919855e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2121e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7451
    reference variance = 0.31345
====================================================
  Execution time = 4.2509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5377e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8418e-01
  Total weights = 1.964202637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468089245700
                                         uncertainty =       0.002273981249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468089245700
                                         uncertainty =       0.002273981249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483790855
  error estimate for blocks of size 2^( 2) =       0.000505283326
  error estimate for blocks of size 2^( 3) =       0.000526128370
  error estimate for blocks of size 2^( 4) =       0.000542010483
  error estimate for blocks of size 2^( 5) =       0.000551370492
  error estimate for blocks of size 2^( 6) =       0.000554893287
  error estimate for blocks of size 2^( 7) =       0.000558149952

      target function =      -0.654162433178
              le_mean =     -22.819399685548
             les_mean =     521.209183274853
             stat err =       0.000551606053
             autocorr =       1.299998160149
   target nu stat err =       0.000551606053
   target dn stat err =       0.003166550584
      target stat err =       0.001297688893
              std dev =       0.684183588514
             le_variance =       0.468107182792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281939968555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-07, overlap shift 5.6843e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654164597718       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654333930014       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654367355785       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654374402312       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654378210582       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654379328867       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654379933164       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654380054082       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654380113593       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654380124933       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654380336436       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654380362463       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-07 is 3.395668e-03

solving harmonic davidson linear method for identity shift 2.2737e-06, overlap shift 2.2737e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654164597718       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654333923124       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654367346860       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654374392847       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654378200749       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654379318898       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654379923109       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654380043999       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654380103496       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654380114833       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654380326304       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654380352323       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-06 is 3.395518e-03

solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654164597718       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654333895571       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654367311167       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654374354994       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654378161426       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654379279034       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654379882899       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654380003676       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654380063120       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654380074446       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654380285785       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654380311777       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 3.394917e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.567397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0149e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_01                 1.097728e-01 3 1  ON 0
ci_02                -2.345937e-02 3 1  ON 1
ci_03                -2.485487e-02 3 1  ON 2
ci_04                 2.115405e-02 3 1  ON 3
ci_05                -2.030440e-02 3 1  ON 4
ci_06                -2.090156e-02 3 1  ON 5
ci_07                 2.561074e-02 3 1  ON 6
ci_08                -4.318141e-03 3 1  ON 7
ci_09                -7.111194e-03 3 1  ON 8
ci_10                -7.622534e-03 3 1  ON 9
ci_11                 1.065995e-02 3 1  ON 10
ci_12                 5.385485e-03 3 1  ON 11
ci_13                 1.180606e-02 3 1  ON 12
ci_14                 1.782908e-02 3 1  ON 13
ci_15                 6.086246e-03 3 1  ON 14
ci_16                 6.134585e-03 3 1  ON 15
ci_17                -6.859096e-03 3 1  ON 16
ci_18                -8.412170e-03 3 1  ON 17
ci_19                 8.790624e-03 3 1  ON 18
ci_20                 6.695703e-03 3 1  ON 19
ci_21                 9.422350e-03 3 1  ON 20
ci_22                 6.151639e-03 3 1  ON 21
ci_23                 4.985026e-03 3 1  ON 22
ci_24                 3.464146e-03 3 1  ON 23
ci_25                 2.535166e-03 3 1  ON 24
ci_26                 2.923412e-03 3 1  ON 25
ci_27                 2.578675e-03 3 1  ON 26
ci_28                 1.233522e-03 3 1  ON 27
ci_29                 2.184498e-03 3 1  ON 28
ci_30                -1.716214e-03 3 1  ON 29
ci_31                -4.286734e-04 3 1  ON 30
ci_32                -2.745802e-04 3 1  ON 31
ci_33                -3.435578e-04 3 1  ON 32
ci_34                 1.152999e-03 3 1  ON 33
ci_35                -8.107773e-04 3 1  ON 34
ci_36                -9.472848e-04 3 1  ON 35
ci_37                -9.784568e-05 3 1  ON 36
ci_38                 6.249260e-04 3 1  ON 37
ci_39                -9.274713e-05 3 1  ON 38
ci_40                -1.637934e-03 3 1  ON 39
ci_41                 2.209694e-04 3 1  ON 40
ci_42                -8.649855e-04 3 1  ON 41
ci_43                -3.204468e-03 3 1  ON 42
ci_44                -1.703860e-03 3 1  ON 43
ci_45                -5.350000e-04 3 1  ON 44
ci_46                -5.205706e-04 3 1  ON 45
ci_47                 4.118437e-04 3 1  ON 46
ci_48                 1.614596e-03 3 1  ON 47
ci_49                -7.076006e-04 3 1  ON 48
ci_50                -6.610167e-04 3 1  ON 49
ci_51                 3.625250e-04 3 1  ON 50
ci_52                 1.238067e-04 3 1  ON 51
ci_53                -7.793835e-04 3 1  ON 52
ci_54                -8.208136e-04 3 1  ON 53
ci_55                -2.201463e-05 3 1  ON 54
ci_56                 2.198732e-03 3 1  ON 55
ci_57                 2.228274e-03 3 1  ON 56
ci_58                -1.048995e-03 3 1  ON 57
ci_59                -1.249108e-03 3 1  ON 58
ci_60                 5.208327e-04 3 1  ON 59
ci_61                 5.917870e-04 3 1  ON 60
ci_62                 3.902425e-04 3 1  ON 61
ci_63                 1.942088e-04 3 1  ON 62
ci_64                 3.594047e-04 3 1  ON 63
ci_65                -2.354077e-04 3 1  ON 64
ci_66                -2.303503e-04 3 1  ON 65
ci_67                -7.769278e-04 3 1  ON 66
ci_68                 6.148060e-04 3 1  ON 67
ci_69                -3.442093e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.8853
    reference variance = 0.359954
====================================================
  Execution time = 4.3030e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8263e-01
  Total weights = 1.9642e+06
  Execution time = 5.9205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.020947
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468739284498
                                         uncertainty =       0.002559826436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468739284498
                                         uncertainty =       0.002559826436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484129125
  error estimate for blocks of size 2^( 2) =       0.000505850791
  error estimate for blocks of size 2^( 3) =       0.000526806515
  error estimate for blocks of size 2^( 4) =       0.000543187570
  error estimate for blocks of size 2^( 5) =       0.000553720727
  error estimate for blocks of size 2^( 6) =       0.000560237040
  error estimate for blocks of size 2^( 7) =       0.000561793837

      target function =      -0.640622003679
              le_mean =     -22.818804241864
             les_mean =     521.216395789551
             stat err =       0.000554734794
             autocorr =       1.312950614481
   target nu stat err =       0.000554734794
   target dn stat err =       0.017205676413
      target stat err =       0.006539813805
              std dev =       0.684661975216
             le_variance =       0.468762020307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466074656630
                                         uncertainty =       0.002215816825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466074656630
                                         uncertainty =       0.002215816825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482746425
  error estimate for blocks of size 2^( 2) =       0.000504556123
  error estimate for blocks of size 2^( 3) =       0.000525575569
  error estimate for blocks of size 2^( 4) =       0.000541975465
  error estimate for blocks of size 2^( 5) =       0.000552524941
  error estimate for blocks of size 2^( 6) =       0.000559033949
  error estimate for blocks of size 2^( 7) =       0.000560527942

      target function =      -0.654589357928
              le_mean =     -22.818661385440
             les_mean =     521.173937829843
             stat err =       0.000553515574
             autocorr =       1.314684544038
   target nu stat err =       0.000553515574
   target dn stat err =       0.004324027735
      target stat err =       0.001745889383
              std dev =       0.682706541961
             le_variance =       0.466088222436

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0204875
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.829192991329
                                         uncertainty =       0.360562928565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.829192991329
                                         uncertainty =       0.360562928565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000643779840
  error estimate for blocks of size 2^( 2) =       0.000660206766
  error estimate for blocks of size 2^( 3) =       0.000675991780
  error estimate for blocks of size 2^( 4) =       0.000688794434
  error estimate for blocks of size 2^( 5) =       0.000696045167
  error estimate for blocks of size 2^( 6) =       0.000702097262
  error estimate for blocks of size 2^( 7) =       0.000702327086

      target function =      -0.060562334685
              le_mean =     -22.818354855455
             les_mean =     529.966577909906
             stat err =       0.000697315987
             autocorr =       1.173233618841
   target nu stat err =       0.000697315987
   target dn stat err =       8.804128185336
      target stat err =       0.050978842331
              std dev =       0.910442181470
             le_variance =       0.828904965799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466074670167
                                         uncertainty =       0.002215837025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466074670167
                                         uncertainty =       0.002215837025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482746433
  error estimate for blocks of size 2^( 2) =       0.000504556123
  error estimate for blocks of size 2^( 3) =       0.000525575558
  error estimate for blocks of size 2^( 4) =       0.000541975452
  error estimate for blocks of size 2^( 5) =       0.000552524914
  error estimate for blocks of size 2^( 6) =       0.000559033926
  error estimate for blocks of size 2^( 7) =       0.000560527899

      target function =      -0.654589685948
              le_mean =     -22.818661378239
             les_mean =     521.173936673875
             stat err =       0.000553515548
             autocorr =       1.314684377937
   target nu stat err =       0.000553515548
   target dn stat err =       0.004323062669
      target stat err =       0.001745515774
              std dev =       0.682706552250
             le_variance =       0.466088236485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.640622003679        initial
     5.6843e-07     5.6843e-06             3.3957e-03        -0.654589357928
     2.2737e-06     2.2737e-05             3.3955e-03        -0.060562334685
     9.0949e-06     9.0949e-05             3.3949e-03        -0.654589685948  <--

*****************************************************************************
Applying the update for shift_i =   9.0949e-06     and shift_s =   9.0949e-05
*****************************************************************************

  Execution time = 7.2737e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_01                 1.097723e-01 3 1  ON 0
ci_02                -2.345983e-02 3 1  ON 1
ci_03                -2.485472e-02 3 1  ON 2
ci_04                 2.115406e-02 3 1  ON 3
ci_05                -2.030427e-02 3 1  ON 4
ci_06                -2.090148e-02 3 1  ON 5
ci_07                 2.561091e-02 3 1  ON 6
ci_08                -4.318072e-03 3 1  ON 7
ci_09                -7.111535e-03 3 1  ON 8
ci_10                -7.622206e-03 3 1  ON 9
ci_11                 1.066054e-02 3 1  ON 10
ci_12                 5.385770e-03 3 1  ON 11
ci_13                 1.180598e-02 3 1  ON 12
ci_14                 1.782888e-02 3 1  ON 13
ci_15                 6.086238e-03 3 1  ON 14
ci_16                 6.134694e-03 3 1  ON 15
ci_17                -6.858876e-03 3 1  ON 16
ci_18                -8.412252e-03 3 1  ON 17
ci_19                 8.790783e-03 3 1  ON 18
ci_20                 6.695743e-03 3 1  ON 19
ci_21                 9.422044e-03 3 1  ON 20
ci_22                 6.151873e-03 3 1  ON 21
ci_23                 4.985036e-03 3 1  ON 22
ci_24                 3.464790e-03 3 1  ON 23
ci_25                 2.535288e-03 3 1  ON 24
ci_26                 2.923163e-03 3 1  ON 25
ci_27                 2.578689e-03 3 1  ON 26
ci_28                 1.233458e-03 3 1  ON 27
ci_29                 2.184689e-03 3 1  ON 28
ci_30                -1.715759e-03 3 1  ON 29
ci_31                -4.283906e-04 3 1  ON 30
ci_32                -2.745832e-04 3 1  ON 31
ci_33                -3.436908e-04 3 1  ON 32
ci_34                 1.152940e-03 3 1  ON 33
ci_35                -8.101763e-04 3 1  ON 34
ci_36                -9.474211e-04 3 1  ON 35
ci_37                -9.796339e-05 3 1  ON 36
ci_38                 6.248192e-04 3 1  ON 37
ci_39                -9.281683e-05 3 1  ON 38
ci_40                -1.637827e-03 3 1  ON 39
ci_41                 2.209598e-04 3 1  ON 40
ci_42                -8.650766e-04 3 1  ON 41
ci_43                -3.204085e-03 3 1  ON 42
ci_44                -1.704344e-03 3 1  ON 43
ci_45                -5.349533e-04 3 1  ON 44
ci_46                -5.204728e-04 3 1  ON 45
ci_47                 4.122641e-04 3 1  ON 46
ci_48                 1.614371e-03 3 1  ON 47
ci_49                -7.075062e-04 3 1  ON 48
ci_50                -6.610173e-04 3 1  ON 49
ci_51                 3.624453e-04 3 1  ON 50
ci_52                 1.238342e-04 3 1  ON 51
ci_53                -7.793538e-04 3 1  ON 52
ci_54                -8.210027e-04 3 1  ON 53
ci_55                -2.215322e-05 3 1  ON 54
ci_56                 2.198774e-03 3 1  ON 55
ci_57                 2.228236e-03 3 1  ON 56
ci_58                -1.048990e-03 3 1  ON 57
ci_59                -1.248935e-03 3 1  ON 58
ci_60                 5.216018e-04 3 1  ON 59
ci_61                 5.921472e-04 3 1  ON 60
ci_62                 3.901780e-04 3 1  ON 61
ci_63                 1.942334e-04 3 1  ON 62
ci_64                 3.594209e-04 3 1  ON 63
ci_65                -2.354807e-04 3 1  ON 64
ci_66                -2.303569e-04 3 1  ON 65
ci_67                -7.768378e-04 3 1  ON 66
ci_68                 6.149413e-04 3 1  ON 67
ci_69                -3.443108e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7743
    reference variance = 0.275257
====================================================
  Execution time = 4.4505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8651e-01
  Total weights = 1.964052515e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472467001558
                                         uncertainty =       0.002509982501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472467001558
                                         uncertainty =       0.002509982501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486060121
  error estimate for blocks of size 2^( 2) =       0.000507837341
  error estimate for blocks of size 2^( 3) =       0.000528614698
  error estimate for blocks of size 2^( 4) =       0.000544695677
  error estimate for blocks of size 2^( 5) =       0.000554862411
  error estimate for blocks of size 2^( 6) =       0.000560532399
  error estimate for blocks of size 2^( 7) =       0.000564115895

      target function =      -0.653051559112
              le_mean =     -22.818634067738
             les_mean =     521.176568089688
             stat err =       0.000556051595
             autocorr =       1.308730431379
   target nu stat err =       0.000556051595
   target dn stat err =       0.003404376463
      target stat err =       0.001384003151
              std dev =       0.687392815230
             le_variance =       0.472508882429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281863406774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-06, overlap shift 2.2737e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653054094647       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653250163538       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653279086213       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653286078856       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653288541390       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653291326917       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653292304976       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653292599099       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653292764205       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653292826346       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653292708064       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653292786217       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653292716404       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-06 is 4.943343e-03

solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653054094647       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653250132108       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653279047886       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653286038357       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653288499880       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653291284123       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653292261449       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653292555289       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653292720273       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653292782351       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653292664138       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653292742225       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653292672463       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 4.941484e-03

solving harmonic davidson linear method for identity shift 3.6380e-05, overlap shift 3.6380e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653054094647       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653250006488       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653278894706       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653285876505       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653288333992       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653291113107       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653292087504       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653292380221       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653292544714       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653292606543       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653292488606       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653292566429       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.653292496871       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-05 is 4.934061e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.573085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2168e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_01                 1.097650e-01 3 1  ON 0
ci_02                -2.559008e-02 3 1  ON 1
ci_03                -2.393072e-02 3 1  ON 2
ci_04                 2.217464e-02 3 1  ON 3
ci_05                -2.152388e-02 3 1  ON 4
ci_06                -2.004772e-02 3 1  ON 5
ci_07                 2.608511e-02 3 1  ON 6
ci_08                -3.867553e-03 3 1  ON 7
ci_09                -9.510839e-03 3 1  ON 8
ci_10                -5.524817e-03 3 1  ON 9
ci_11                 1.178975e-02 3 1  ON 10
ci_12                 8.928748e-03 3 1  ON 11
ci_13                 1.257224e-02 3 1  ON 12
ci_14                 1.288739e-02 3 1  ON 13
ci_15                 6.267359e-03 3 1  ON 14
ci_16                 5.451236e-03 3 1  ON 15
ci_17                -6.961809e-03 3 1  ON 16
ci_18                -6.700342e-03 3 1  ON 17
ci_19                 9.907869e-03 3 1  ON 18
ci_20                 7.031141e-03 3 1  ON 19
ci_21                 9.627048e-03 3 1  ON 20
ci_22                 8.176869e-03 3 1  ON 21
ci_23                 4.433994e-03 3 1  ON 22
ci_24                 5.302017e-03 3 1  ON 23
ci_25                 3.285396e-03 3 1  ON 24
ci_26                 2.730131e-03 3 1  ON 25
ci_27                 2.399370e-03 3 1  ON 26
ci_28                 2.443887e-03 3 1  ON 27
ci_29                 6.654542e-04 3 1  ON 28
ci_30                -7.365636e-04 3 1  ON 29
ci_31                 1.825502e-05 3 1  ON 30
ci_32                -9.838050e-04 3 1  ON 31
ci_33                -5.309790e-05 3 1  ON 32
ci_34                 1.045714e-03 3 1  ON 33
ci_35                 3.210305e-04 3 1  ON 34
ci_36                 6.597330e-05 3 1  ON 35
ci_37                -2.241252e-04 3 1  ON 36
ci_38                -7.095397e-05 3 1  ON 37
ci_39                -8.242065e-04 3 1  ON 38
ci_40                -9.889476e-04 3 1  ON 39
ci_41                -1.375312e-03 3 1  ON 40
ci_42                -1.249037e-03 3 1  ON 41
ci_43                -1.232313e-03 3 1  ON 42
ci_44                -2.389445e-03 3 1  ON 43
ci_45                -5.803536e-04 3 1  ON 44
ci_46                -4.777592e-04 3 1  ON 45
ci_47                 2.079602e-03 3 1  ON 46
ci_48                 7.459234e-07 3 1  ON 47
ci_49                 3.063451e-04 3 1  ON 48
ci_50                -8.568022e-04 3 1  ON 49
ci_51                -1.349744e-04 3 1  ON 50
ci_52                -3.126576e-04 3 1  ON 51
ci_53                 3.416564e-05 3 1  ON 52
ci_54                -9.422431e-04 3 1  ON 53
ci_55                -1.958986e-03 3 1  ON 54
ci_56                 1.655662e-03 3 1  ON 55
ci_57                 2.051446e-03 3 1  ON 56
ci_58                -1.651568e-03 3 1  ON 57
ci_59                -1.117517e-03 3 1  ON 58
ci_60                 1.862494e-03 3 1  ON 59
ci_61                 4.323240e-04 3 1  ON 60
ci_62                 3.779044e-04 3 1  ON 61
ci_63                -3.738001e-04 3 1  ON 62
ci_64                -1.471416e-03 3 1  ON 63
ci_65                 6.238949e-05 3 1  ON 64
ci_66                -2.341376e-04 3 1  ON 65
ci_67                -2.566218e-04 3 1  ON 66
ci_68                -1.686352e-03 3 1  ON 67
ci_69                -1.524958e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7502
    reference variance = 0.438229
====================================================
  Execution time = 4.1619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8338e-01
  Total weights = 1.9642e+06
  Execution time = 5.9105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0909962
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477952163930
                                         uncertainty =       0.005184768214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477952163930
                                         uncertainty =       0.005184768214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488865172
  error estimate for blocks of size 2^( 2) =       0.000510337900
  error estimate for blocks of size 2^( 3) =       0.000530978968
  error estimate for blocks of size 2^( 4) =       0.000546286047
  error estimate for blocks of size 2^( 5) =       0.000557804929
  error estimate for blocks of size 2^( 6) =       0.000564328821
  error estimate for blocks of size 2^( 7) =       0.000569232244

      target function =      -0.479152272180
              le_mean =     -22.818664545817
             les_mean =     521.720919370162
             stat err =       0.000559413010
             autocorr =       1.309443998597
   target nu stat err =       0.000559413010
   target dn stat err =       0.357359450881
      target stat err =       0.077876130784
              std dev =       0.691359755928
             le_variance =       0.477978312117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468916290472
                                         uncertainty =       0.002443718025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468916290472
                                         uncertainty =       0.002443718025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484228591
  error estimate for blocks of size 2^( 2) =       0.000505913128
  error estimate for blocks of size 2^( 3) =       0.000526667674
  error estimate for blocks of size 2^( 4) =       0.000542151855
  error estimate for blocks of size 2^( 5) =       0.000553780328
  error estimate for blocks of size 2^( 6) =       0.000560126077
  error estimate for blocks of size 2^( 7) =       0.000564988469

      target function =      -0.654283004633
              le_mean =     -22.818608521986
             les_mean =     521.172271160543
             stat err =       0.000555261682
             autocorr =       1.314905531675
   target nu stat err =       0.000555261682
   target dn stat err =       0.002990468962
      target stat err =       0.001230575451
              std dev =       0.684802640590
             le_variance =       0.468954656559

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0905844
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521814369763
                                         uncertainty =       0.049708999075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521814369763
                                         uncertainty =       0.049708999075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510758382
  error estimate for blocks of size 2^( 2) =       0.000530815510
  error estimate for blocks of size 2^( 3) =       0.000550402429
  error estimate for blocks of size 2^( 4) =       0.000564537567
  error estimate for blocks of size 2^( 5) =       0.000576004125
  error estimate for blocks of size 2^( 6) =       0.000582297281
  error estimate for blocks of size 2^( 7) =       0.000588189400

      target function =      -0.250741993837
              le_mean =     -22.818634891172
             les_mean =     522.949480566478
             stat err =       0.000577757093
             autocorr =       1.279556794596
   target nu stat err =       0.000577757093
   target dn stat err =       1.741936071059
      target stat err =       0.127387228642
              std dev =       0.722321430845
             le_variance =       0.521748249458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468916003520
                                         uncertainty =       0.002443749915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468916003520
                                         uncertainty =       0.002443749915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484228439
  error estimate for blocks of size 2^( 2) =       0.000505913007
  error estimate for blocks of size 2^( 3) =       0.000526667595
  error estimate for blocks of size 2^( 4) =       0.000542151812
  error estimate for blocks of size 2^( 5) =       0.000553780330
  error estimate for blocks of size 2^( 6) =       0.000560126164
  error estimate for blocks of size 2^( 7) =       0.000564988560

      target function =      -0.654282348523
              le_mean =     -22.818608502993
             les_mean =     521.172271938682
             stat err =       0.000555261716
             autocorr =       1.314906515593
   target nu stat err =       0.000555261716
   target dn stat err =       0.002990591974
      target stat err =       0.001230619906
              std dev =       0.684802426308
             le_variance =       0.468954363077


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.479152272180        initial
     2.2737e-06     2.2737e-05             4.9433e-03        -0.654283004633  <--
     9.0949e-06     9.0949e-05             4.9415e-03        -0.250741993837
     3.6380e-05     3.6380e-04             4.9341e-03        -0.654282348523

*****************************************************************************
Applying the update for shift_i =   2.2737e-06     and shift_s =   2.2737e-05
*****************************************************************************

  Execution time = 7.1275e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_01                 1.097649e-01 3 1  ON 0
ci_02                -2.559047e-02 3 1  ON 1
ci_03                -2.393056e-02 3 1  ON 2
ci_04                 2.217479e-02 3 1  ON 3
ci_05                -2.152411e-02 3 1  ON 4
ci_06                -2.004753e-02 3 1  ON 5
ci_07                 2.608525e-02 3 1  ON 6
ci_08                -3.867496e-03 3 1  ON 7
ci_09                -9.511332e-03 3 1  ON 8
ci_10                -5.524415e-03 3 1  ON 9
ci_11                 1.179000e-02 3 1  ON 10
ci_12                 8.929333e-03 3 1  ON 11
ci_13                 1.257254e-02 3 1  ON 12
ci_14                 1.288553e-02 3 1  ON 13
ci_15                 6.267375e-03 3 1  ON 14
ci_16                 5.451129e-03 3 1  ON 15
ci_17                -6.961844e-03 3 1  ON 16
ci_18                -6.699998e-03 3 1  ON 17
ci_19                 9.908037e-03 3 1  ON 18
ci_20                 7.031214e-03 3 1  ON 19
ci_21                 9.627121e-03 3 1  ON 20
ci_22                 8.177310e-03 3 1  ON 21
ci_23                 4.433904e-03 3 1  ON 22
ci_24                 5.302469e-03 3 1  ON 23
ci_25                 3.285514e-03 3 1  ON 24
ci_26                 2.730108e-03 3 1  ON 25
ci_27                 2.399318e-03 3 1  ON 26
ci_28                 2.444095e-03 3 1  ON 27
ci_29                 6.651719e-04 3 1  ON 28
ci_30                -7.363075e-04 3 1  ON 29
ci_31                 1.840513e-05 3 1  ON 30
ci_32                -9.838998e-04 3 1  ON 31
ci_33                -5.305450e-05 3 1  ON 32
ci_34                 1.045708e-03 3 1  ON 33
ci_35                 3.212228e-04 3 1  ON 34
ci_36                 6.613464e-05 3 1  ON 35
ci_37                -2.241466e-04 3 1  ON 36
ci_38                -7.107336e-05 3 1  ON 37
ci_39                -8.243250e-04 3 1  ON 38
ci_40                -9.888597e-04 3 1  ON 39
ci_41                -1.375561e-03 3 1  ON 40
ci_42                -1.249100e-03 3 1  ON 41
ci_43                -1.231958e-03 3 1  ON 42
ci_44                -2.389571e-03 3 1  ON 43
ci_45                -5.803563e-04 3 1  ON 44
ci_46                -4.777534e-04 3 1  ON 45
ci_47                 2.080002e-03 3 1  ON 46
ci_48                 4.624256e-07 3 1  ON 47
ci_49                 3.065083e-04 3 1  ON 48
ci_50                -8.568372e-04 3 1  ON 49
ci_51                -1.350534e-04 3 1  ON 50
ci_52                -3.127242e-04 3 1  ON 51
ci_53                 3.427944e-05 3 1  ON 52
ci_54                -9.421955e-04 3 1  ON 53
ci_55                -1.959253e-03 3 1  ON 54
ci_56                 1.655571e-03 3 1  ON 55
ci_57                 2.051414e-03 3 1  ON 56
ci_58                -1.651668e-03 3 1  ON 57
ci_59                -1.117492e-03 3 1  ON 58
ci_60                 1.862812e-03 3 1  ON 59
ci_61                 4.321361e-04 3 1  ON 60
ci_62                 3.779095e-04 3 1  ON 61
ci_63                -3.738831e-04 3 1  ON 62
ci_64                -1.471710e-03 3 1  ON 63
ci_65                 6.242578e-05 3 1  ON 64
ci_66                -2.341477e-04 3 1  ON 65
ci_67                -2.565506e-04 3 1  ON 66
ci_68                -1.686754e-03 3 1  ON 67
ci_69                -1.525161e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2345e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.8143
    reference variance = 0.850646
====================================================
  Execution time = 4.2692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9466e-01
  Total weights = 1.963916451e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471296321572
                                         uncertainty =       0.003002725236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471296321572
                                         uncertainty =       0.003002725236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485448074
  error estimate for blocks of size 2^( 2) =       0.000506828957
  error estimate for blocks of size 2^( 3) =       0.000527174892
  error estimate for blocks of size 2^( 4) =       0.000542902703
  error estimate for blocks of size 2^( 5) =       0.000552612075
  error estimate for blocks of size 2^( 6) =       0.000558999959
  error estimate for blocks of size 2^( 7) =       0.000561686435

      target function =      -0.650053287388
              le_mean =     -22.819506018634
             les_mean =     521.224518681746
             stat err =       0.000554050293
             autocorr =       1.302605216130
   target nu stat err =       0.000554050293
   target dn stat err =       0.007255933432
      target stat err =       0.002857278612
              std dev =       0.686527250499
             le_variance =       0.471319665678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281950601863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-07, overlap shift 5.6843e-06 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650065474777       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650561126517       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650613845186       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650628872502       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650633816226       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650636722510       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650638981713       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650639518611       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650639444797       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650639476278       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.650639258274       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.650639077924       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.650639073997       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-07 is 4.622583e-03

solving harmonic davidson linear method for identity shift 2.2737e-06, overlap shift 2.2737e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650065474777       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650561106804       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650613822454       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650628848608       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650633791899       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650636697842       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650638956705       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650639493469       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650639419632       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650639451087       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.650639233117       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.650639052805       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.650639048881       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-06 is 4.622152e-03

solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650065474777       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650561027967       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650613731541       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650628753052       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650633694611       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650636599190       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650638856693       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650639392926       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650639318997       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650639350345       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.650639132508       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.650638952353       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.650638948439       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 4.620428e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.584316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0346e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_01                 1.093662e-01 3 1  ON 0
ci_02                -2.243497e-02 3 1  ON 1
ci_03                -2.366192e-02 3 1  ON 2
ci_04                 2.149676e-02 3 1  ON 3
ci_05                -2.376649e-02 3 1  ON 4
ci_06                -1.692223e-02 3 1  ON 5
ci_07                 2.747727e-02 3 1  ON 6
ci_08                -4.286021e-03 3 1  ON 7
ci_09                -6.120944e-03 3 1  ON 8
ci_10                -5.291050e-03 3 1  ON 9
ci_11                 1.046194e-02 3 1  ON 10
ci_12                 8.497570e-03 3 1  ON 11
ci_13                 1.270225e-02 3 1  ON 12
ci_14                 1.750769e-02 3 1  ON 13
ci_15                 7.751716e-03 3 1  ON 14
ci_16                 6.743135e-03 3 1  ON 15
ci_17                -7.269200e-03 3 1  ON 16
ci_18                -4.695333e-03 3 1  ON 17
ci_19                 7.062099e-03 3 1  ON 18
ci_20                 6.074332e-03 3 1  ON 19
ci_21                 8.183495e-03 3 1  ON 20
ci_22                 9.388104e-03 3 1  ON 21
ci_23                 6.750883e-03 3 1  ON 22
ci_24                 5.064250e-03 3 1  ON 23
ci_25                 1.865787e-03 3 1  ON 24
ci_26                 1.848171e-03 3 1  ON 25
ci_27                 4.598577e-03 3 1  ON 26
ci_28                 3.524101e-03 3 1  ON 27
ci_29                 5.584576e-04 3 1  ON 28
ci_30                -6.523534e-04 3 1  ON 29
ci_31                -1.030263e-03 3 1  ON 30
ci_32                -7.091392e-04 3 1  ON 31
ci_33                -3.027366e-03 3 1  ON 32
ci_34                 2.966039e-03 3 1  ON 33
ci_35                 2.210615e-03 3 1  ON 34
ci_36                -1.991649e-03 3 1  ON 35
ci_37                -6.311809e-04 3 1  ON 36
ci_38                -7.047010e-04 3 1  ON 37
ci_39                 4.877376e-05 3 1  ON 38
ci_40                -4.612225e-04 3 1  ON 39
ci_41                -1.885119e-03 3 1  ON 40
ci_42                 2.918478e-03 3 1  ON 41
ci_43                -3.916820e-03 3 1  ON 42
ci_44                -1.464359e-03 3 1  ON 43
ci_45                -1.097050e-03 3 1  ON 44
ci_46                 1.466358e-03 3 1  ON 45
ci_47                 1.129585e-03 3 1  ON 46
ci_48                 2.741135e-03 3 1  ON 47
ci_49                -8.323452e-04 3 1  ON 48
ci_50                -1.075660e-03 3 1  ON 49
ci_51                 1.166799e-03 3 1  ON 50
ci_52                 1.192694e-03 3 1  ON 51
ci_53                -9.801513e-04 3 1  ON 52
ci_54                -2.117383e-03 3 1  ON 53
ci_55                 6.023401e-04 3 1  ON 54
ci_56                 1.401262e-03 3 1  ON 55
ci_57                 4.234559e-03 3 1  ON 56
ci_58                 2.521006e-03 3 1  ON 57
ci_59                -1.639987e-03 3 1  ON 58
ci_60                 2.899098e-03 3 1  ON 59
ci_61                 1.475494e-03 3 1  ON 60
ci_62                -4.037149e-04 3 1  ON 61
ci_63                 1.742359e-03 3 1  ON 62
ci_64                 1.973820e-04 3 1  ON 63
ci_65                -1.423814e-04 3 1  ON 64
ci_66                -4.513060e-04 3 1  ON 65
ci_67                -1.192107e-03 3 1  ON 66
ci_68                -9.645862e-04 3 1  ON 67
ci_69                 2.662134e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6541
    reference variance = 0.491262
====================================================
  Execution time = 4.1464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8838e-01
  Total weights = 1.9641e+06
  Execution time = 5.9078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480936869680
                                         uncertainty =       0.004783749545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480936869680
                                         uncertainty =       0.004783749545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490401970
  error estimate for blocks of size 2^( 2) =       0.000511851063
  error estimate for blocks of size 2^( 3) =       0.000532126195
  error estimate for blocks of size 2^( 4) =       0.000548144109
  error estimate for blocks of size 2^( 5) =       0.000558065237
  error estimate for blocks of size 2^( 6) =       0.000561797068
  error estimate for blocks of size 2^( 7) =       0.000564434508

      target function =      -0.610044375443
              le_mean =     -22.819054010015
             les_mean =     521.310388339934
             stat err =       0.000558110231
             autocorr =       1.295196177879
   target nu stat err =       0.000558110231
   target dn stat err =       0.063902993263
      target stat err =       0.022031814733
              std dev =       0.693533117445
             le_variance =       0.480988184993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473933449430
                                         uncertainty =       0.004190773944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473933449430
                                         uncertainty =       0.004190773944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486811439
  error estimate for blocks of size 2^( 2) =       0.000508579003
  error estimate for blocks of size 2^( 3) =       0.000529169849
  error estimate for blocks of size 2^( 4) =       0.000545290104
  error estimate for blocks of size 2^( 5) =       0.000555247569
  error estimate for blocks of size 2^( 6) =       0.000559018670
  error estimate for blocks of size 2^( 7) =       0.000561463730

      target function =      -0.652330110437
              le_mean =     -22.818705045353
             les_mean =     521.181675826068
             stat err =       0.000555255018
             autocorr =       1.300958476160
   target nu stat err =       0.000555255018
   target dn stat err =       0.004897820834
      target stat err =       0.001956403518
              std dev =       0.688455339440
             le_variance =       0.473970754403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497824229270
                                         uncertainty =       0.012172151770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497824229270
                                         uncertainty =       0.012172151770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498907252
  error estimate for blocks of size 2^( 2) =       0.000520371113
  error estimate for blocks of size 2^( 3) =       0.000540704954
  error estimate for blocks of size 2^( 4) =       0.000556547767
  error estimate for blocks of size 2^( 5) =       0.000566353523
  error estimate for blocks of size 2^( 6) =       0.000570163458
  error estimate for blocks of size 2^( 7) =       0.000571850564

      target function =      -0.525978827605
              le_mean =     -22.818984303542
             les_mean =     521.572016758313
             stat err =       0.000566228828
             autocorr =       1.288084394119
   target nu stat err =       0.000566228828
   target dn stat err =       0.205229848646
      target stat err =       0.053056993405
              std dev =       0.705561402831
             le_variance =       0.497816893165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473933256187
                                         uncertainty =       0.004190784030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473933256187
                                         uncertainty =       0.004190784030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486811342
  error estimate for blocks of size 2^( 2) =       0.000508578878
  error estimate for blocks of size 2^( 3) =       0.000529169698
  error estimate for blocks of size 2^( 4) =       0.000545289954
  error estimate for blocks of size 2^( 5) =       0.000555247426
  error estimate for blocks of size 2^( 6) =       0.000559018509
  error estimate for blocks of size 2^( 7) =       0.000561463580

      target function =      -0.652331364281
              le_mean =     -22.818705040339
             les_mean =     521.181672407948
             stat err =       0.000555254867
             autocorr =       1.300958290288
   target nu stat err =       0.000555254867
   target dn stat err =       0.004897832111
      target stat err =       0.001956415276
              std dev =       0.688455201769
             le_variance =       0.473970564843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.610044375443        initial
     5.6843e-07     5.6843e-06             4.6226e-03        -0.652330110437
     2.2737e-06     2.2737e-05             4.6222e-03        -0.525978827605
     9.0949e-06     9.0949e-05             4.6204e-03        -0.652331364281  <--

*****************************************************************************
Applying the update for shift_i =   9.0949e-06     and shift_s =   9.0949e-05
*****************************************************************************

  Execution time = 7.1113e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_01                 1.093664e-01 3 1  ON 0
ci_02                -2.243557e-02 3 1  ON 1
ci_03                -2.366196e-02 3 1  ON 2
ci_04                 2.149685e-02 3 1  ON 3
ci_05                -2.376604e-02 3 1  ON 4
ci_06                -1.692282e-02 3 1  ON 5
ci_07                 2.747699e-02 3 1  ON 6
ci_08                -4.285976e-03 3 1  ON 7
ci_09                -6.121652e-03 3 1  ON 8
ci_10                -5.291084e-03 3 1  ON 9
ci_11                 1.046226e-02 3 1  ON 10
ci_12                 8.497640e-03 3 1  ON 11
ci_13                 1.270233e-02 3 1  ON 12
ci_14                 1.750596e-02 3 1  ON 13
ci_15                 7.751418e-03 3 1  ON 14
ci_16                 6.742875e-03 3 1  ON 15
ci_17                -7.269130e-03 3 1  ON 16
ci_18                -4.695747e-03 3 1  ON 17
ci_19                 7.062537e-03 3 1  ON 18
ci_20                 6.074499e-03 3 1  ON 19
ci_21                 8.183880e-03 3 1  ON 20
ci_22                 9.387718e-03 3 1  ON 21
ci_23                 6.750514e-03 3 1  ON 22
ci_24                 5.064281e-03 3 1  ON 23
ci_25                 1.866006e-03 3 1  ON 24
ci_26                 1.848354e-03 3 1  ON 25
ci_27                 4.598159e-03 3 1  ON 26
ci_28                 3.523904e-03 3 1  ON 27
ci_29                 5.584997e-04 3 1  ON 28
ci_30                -6.524213e-04 3 1  ON 29
ci_31                -1.029854e-03 3 1  ON 30
ci_32                -7.091790e-04 3 1  ON 31
ci_33                -3.026902e-03 3 1  ON 32
ci_34                 2.965685e-03 3 1  ON 33
ci_35                 2.210276e-03 3 1  ON 34
ci_36                -1.991331e-03 3 1  ON 35
ci_37                -6.311210e-04 3 1  ON 36
ci_38                -7.046087e-04 3 1  ON 37
ci_39                 4.863803e-05 3 1  ON 38
ci_40                -4.612965e-04 3 1  ON 39
ci_41                -1.885040e-03 3 1  ON 40
ci_42                 2.917810e-03 3 1  ON 41
ci_43                -3.916315e-03 3 1  ON 42
ci_44                -1.464521e-03 3 1  ON 43
ci_45                -1.096968e-03 3 1  ON 44
ci_46                 1.466047e-03 3 1  ON 45
ci_47                 1.129935e-03 3 1  ON 46
ci_48                 2.740512e-03 3 1  ON 47
ci_49                -8.321629e-04 3 1  ON 48
ci_50                -1.075635e-03 3 1  ON 49
ci_51                 1.166612e-03 3 1  ON 50
ci_52                 1.192454e-03 3 1  ON 51
ci_53                -9.800073e-04 3 1  ON 52
ci_54                -2.117111e-03 3 1  ON 53
ci_55                 6.019105e-04 3 1  ON 54
ci_56                 1.401307e-03 3 1  ON 55
ci_57                 4.234212e-03 3 1  ON 56
ci_58                 2.520324e-03 3 1  ON 57
ci_59                -1.639885e-03 3 1  ON 58
ci_60                 2.898668e-03 3 1  ON 59
ci_61                 1.474987e-03 3 1  ON 60
ci_62                -4.035948e-04 3 1  ON 61
ci_63                 1.742048e-03 3 1  ON 62
ci_64                 1.971067e-04 3 1  ON 63
ci_65                -1.423447e-04 3 1  ON 64
ci_66                -4.512723e-04 3 1  ON 65
ci_67                -1.191949e-03 3 1  ON 66
ci_68                -9.647022e-04 3 1  ON 67
ci_69                 2.658918e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2148e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7649
    reference variance = 0.3306
====================================================
  Execution time = 4.4467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8558e-01
  Total weights = 1.964296420e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471632916064
                                         uncertainty =       0.003159857844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471632916064
                                         uncertainty =       0.003159857844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485576035
  error estimate for blocks of size 2^( 2) =       0.000506904059
  error estimate for blocks of size 2^( 3) =       0.000527657106
  error estimate for blocks of size 2^( 4) =       0.000543393478
  error estimate for blocks of size 2^( 5) =       0.000553726438
  error estimate for blocks of size 2^( 6) =       0.000560001635
  error estimate for blocks of size 2^( 7) =       0.000562553153

      target function =      -0.653238945520
              le_mean =     -22.817923957227
             les_mean =     521.143234093318
             stat err =       0.000554918676
             autocorr =       1.306003055579
   target nu stat err =       0.000554918676
   target dn stat err =       0.004043358630
      target stat err =       0.001629334493
              std dev =       0.686708214884
             le_variance =       0.471568172389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281792395723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-06, overlap shift 2.2737e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653242576175       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653625508903       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653689244100       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653701179759       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653706158035       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653709289635       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653710117307       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653710101469       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653710269315       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653710400664       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653710276241       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653710260069       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-06 is 4.371101e-03

solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653242576175       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653625447315       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653689167736       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653701099644       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653706076172       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653709206496       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653710033577       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653710017663       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653710185411       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653710316670       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653710192317       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653710176150       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 4.370217e-03

solving harmonic davidson linear method for identity shift 3.6380e-05, overlap shift 3.6380e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653242576175       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653625201160       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653688862543       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653700779464       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653705749011       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653708874241       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653709698966       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653709682747       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653709850103       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653709981002       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653709856928       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653709840786       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-05 is 4.366687e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.594467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2198e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_01                 1.120014e-01 3 1  ON 0
ci_02                -2.393939e-02 3 1  ON 1
ci_03                -2.260242e-02 3 1  ON 2
ci_04                 2.096555e-02 3 1  ON 3
ci_05                -1.939582e-02 3 1  ON 4
ci_06                -2.107051e-02 3 1  ON 5
ci_07                 2.565947e-02 3 1  ON 6
ci_08                -2.924306e-03 3 1  ON 7
ci_09                -9.056222e-03 3 1  ON 8
ci_10                -7.050205e-03 3 1  ON 9
ci_11                 1.424760e-02 3 1  ON 10
ci_12                 6.497318e-03 3 1  ON 11
ci_13                 1.372179e-02 3 1  ON 12
ci_14                 1.755310e-02 3 1  ON 13
ci_15                 5.963384e-03 3 1  ON 14
ci_16                 6.519108e-03 3 1  ON 15
ci_17                -7.231340e-03 3 1  ON 16
ci_18                -6.536577e-03 3 1  ON 17
ci_19                 9.364650e-03 3 1  ON 18
ci_20                 6.358811e-03 3 1  ON 19
ci_21                 8.148664e-03 3 1  ON 20
ci_22                 8.431458e-03 3 1  ON 21
ci_23                 4.521668e-03 3 1  ON 22
ci_24                 3.682640e-03 3 1  ON 23
ci_25                 4.485586e-03 3 1  ON 24
ci_26                 1.932566e-03 3 1  ON 25
ci_27                 3.740197e-03 3 1  ON 26
ci_28                 6.788311e-04 3 1  ON 27
ci_29                -2.000046e-05 3 1  ON 28
ci_30                 7.472558e-04 3 1  ON 29
ci_31                -5.234839e-04 3 1  ON 30
ci_32                -5.894101e-04 3 1  ON 31
ci_33                -1.671941e-03 3 1  ON 32
ci_34                -7.969927e-05 3 1  ON 33
ci_35                 1.034951e-03 3 1  ON 34
ci_36                -9.375436e-04 3 1  ON 35
ci_37                -7.386965e-04 3 1  ON 36
ci_38                -4.911912e-04 3 1  ON 37
ci_39                 1.656032e-05 3 1  ON 38
ci_40                -1.339805e-03 3 1  ON 39
ci_41                -2.111292e-04 3 1  ON 40
ci_42                -9.711583e-04 3 1  ON 41
ci_43                -2.023506e-03 3 1  ON 42
ci_44                -2.922465e-03 3 1  ON 43
ci_45                -2.127447e-04 3 1  ON 44
ci_46                -5.241966e-04 3 1  ON 45
ci_47                 1.049062e-03 3 1  ON 46
ci_48                 2.122151e-03 3 1  ON 47
ci_49                -1.089753e-03 3 1  ON 48
ci_50                -7.141329e-04 3 1  ON 49
ci_51                 2.151357e-04 3 1  ON 50
ci_52                -4.534961e-04 3 1  ON 51
ci_53                -4.551522e-04 3 1  ON 52
ci_54                -1.439911e-03 3 1  ON 53
ci_55                -1.422721e-03 3 1  ON 54
ci_56                 1.370569e-03 3 1  ON 55
ci_57                 2.327259e-03 3 1  ON 56
ci_58                -3.772344e-04 3 1  ON 57
ci_59                -7.590284e-04 3 1  ON 58
ci_60                 4.779092e-03 3 1  ON 59
ci_61                 2.055136e-03 3 1  ON 60
ci_62                 2.301593e-04 3 1  ON 61
ci_63                 3.333776e-05 3 1  ON 62
ci_64                 1.626316e-04 3 1  ON 63
ci_65                 4.228760e-04 3 1  ON 64
ci_66                 2.258144e-05 3 1  ON 65
ci_67                -7.612229e-04 3 1  ON 66
ci_68                -2.342749e-03 3 1  ON 67
ci_69                -1.518427e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7798
    reference variance = 0.929406
====================================================
  Execution time = 4.3461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8427e-01
  Total weights = 1.9638e+06
  Execution time = 5.9214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00427709
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497941424165
                                         uncertainty =       0.018166076021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497941424165
                                         uncertainty =       0.018166076021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498954973
  error estimate for blocks of size 2^( 2) =       0.000520109772
  error estimate for blocks of size 2^( 3) =       0.000540122474
  error estimate for blocks of size 2^( 4) =       0.000555665980
  error estimate for blocks of size 2^( 5) =       0.000565023210
  error estimate for blocks of size 2^( 6) =       0.000570661908
  error estimate for blocks of size 2^( 7) =       0.000577727434

      target function =      -0.544697792438
              le_mean =     -22.819773223229
             les_mean =     521.546421969604
             stat err =       0.000567269633
             autocorr =       1.292576810712
   target nu stat err =       0.000567269633
   target dn stat err =       0.153264980628
      target stat err =       0.042351044705
              std dev =       0.705628889712
             le_variance =       0.497912129996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467638366938
                                         uncertainty =       0.001888369133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467638366938
                                         uncertainty =       0.001888369133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483550459
  error estimate for blocks of size 2^( 2) =       0.000505417548
  error estimate for blocks of size 2^( 3) =       0.000526077944
  error estimate for blocks of size 2^( 4) =       0.000542011195
  error estimate for blocks of size 2^( 5) =       0.000551484537
  error estimate for blocks of size 2^( 6) =       0.000556514064
  error estimate for blocks of size 2^( 7) =       0.000563877348

      target function =      -0.654118394433
              le_mean =     -22.819362966364
             les_mean =     521.207593687967
             stat err =       0.000553471786
             autocorr =       1.310108831998
   target nu stat err =       0.000553471786
   target dn stat err =       0.003606189849
      target stat err =       0.001466629470
              std dev =       0.683843616716
             le_variance =       0.467642092123

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0043438
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543756133498
                                         uncertainty =       0.056067818113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543756133498
                                         uncertainty =       0.056067818113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521339953
  error estimate for blocks of size 2^( 2) =       0.000541697959
  error estimate for blocks of size 2^( 3) =       0.000560883127
  error estimate for blocks of size 2^( 4) =       0.000576030741
  error estimate for blocks of size 2^( 5) =       0.000584793573
  error estimate for blocks of size 2^( 6) =       0.000590535700
  error estimate for blocks of size 2^( 7) =       0.000598710255

      target function =      -0.356765907290
              le_mean =     -22.819771157471
             les_mean =     522.414244659183
             stat err =       0.000587517567
             autocorr =       1.269988234025
   target nu stat err =       0.000587517567
   target dn stat err =       0.732144158624
      target stat err =       0.091999925837
              std dev =       0.737286031965
             le_variance =       0.543590692931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467637989478
                                         uncertainty =       0.001888427816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467637989478
                                         uncertainty =       0.001888427816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483550265
  error estimate for blocks of size 2^( 2) =       0.000505417363
  error estimate for blocks of size 2^( 3) =       0.000526077774
  error estimate for blocks of size 2^( 4) =       0.000542011066
  error estimate for blocks of size 2^( 5) =       0.000551484428
  error estimate for blocks of size 2^( 6) =       0.000556514032
  error estimate for blocks of size 2^( 7) =       0.000563877497

      target function =      -0.654120471378
              le_mean =     -22.819362962526
             les_mean =     521.207588251307
             stat err =       0.000553471756
             autocorr =       1.310109738753
   target nu stat err =       0.000553471756
   target dn stat err =       0.003609302844
      target stat err =       0.001467838564
              std dev =       0.683843343304
             le_variance =       0.467641718181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.544697792438        initial
     2.2737e-06     2.2737e-05             4.3711e-03        -0.654118394433
     9.0949e-06     9.0949e-05             4.3702e-03        -0.356765907290
     3.6380e-05     3.6380e-04             4.3667e-03        -0.654120471378  <--

*****************************************************************************
Applying the update for shift_i =   3.6380e-05     and shift_s =   3.6380e-04
*****************************************************************************

  Execution time = 7.3194e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_01                 1.119980e-01 3 1  ON 0
ci_02                -2.393833e-02 3 1  ON 1
ci_03                -2.260324e-02 3 1  ON 2
ci_04                 2.096591e-02 3 1  ON 3
ci_05                -1.939935e-02 3 1  ON 4
ci_06                -2.106736e-02 3 1  ON 5
ci_07                 2.566132e-02 3 1  ON 6
ci_08                -2.925059e-03 3 1  ON 7
ci_09                -9.053719e-03 3 1  ON 8
ci_10                -7.048735e-03 3 1  ON 9
ci_11                 1.424426e-02 3 1  ON 10
ci_12                 6.498726e-03 3 1  ON 11
ci_13                 1.372054e-02 3 1  ON 12
ci_14                 1.755263e-02 3 1  ON 13
ci_15                 5.964813e-03 3 1  ON 14
ci_16                 6.519331e-03 3 1  ON 15
ci_17                -7.231508e-03 3 1  ON 16
ci_18                -6.535071e-03 3 1  ON 17
ci_19                 9.363180e-03 3 1  ON 18
ci_20                 6.358628e-03 3 1  ON 19
ci_21                 8.148767e-03 3 1  ON 20
ci_22                 8.432402e-03 3 1  ON 21
ci_23                 4.523123e-03 3 1  ON 22
ci_24                 3.684069e-03 3 1  ON 23
ci_25                 4.483873e-03 3 1  ON 24
ci_26                 1.932492e-03 3 1  ON 25
ci_27                 3.740873e-03 3 1  ON 26
ci_28                 6.808880e-04 3 1  ON 27
ci_29                -1.973715e-05 3 1  ON 28
ci_30                 7.455488e-04 3 1  ON 29
ci_31                -5.245798e-04 3 1  ON 30
ci_32                -5.894538e-04 3 1  ON 31
ci_33                -1.672841e-03 3 1  ON 32
ci_34                -7.746212e-05 3 1  ON 33
ci_35                 1.035803e-03 3 1  ON 34
ci_36                -9.382405e-04 3 1  ON 35
ci_37                -7.386915e-04 3 1  ON 36
ci_38                -4.912836e-04 3 1  ON 37
ci_39                 1.654444e-05 3 1  ON 38
ci_40                -1.339284e-03 3 1  ON 39
ci_41                -2.121411e-04 3 1  ON 40
ci_42                -9.685975e-04 3 1  ON 41
ci_43                -2.025116e-03 3 1  ON 42
ci_44                -2.921403e-03 3 1  ON 43
ci_45                -2.133274e-04 3 1  ON 44
ci_46                -5.229170e-04 3 1  ON 45
ci_47                 1.048881e-03 3 1  ON 46
ci_48                 2.122517e-03 3 1  ON 47
ci_49                -1.089580e-03 3 1  ON 48
ci_50                -7.143388e-04 3 1  ON 49
ci_51                 2.156691e-04 3 1  ON 50
ci_52                -4.524598e-04 3 1  ON 51
ci_53                -4.554598e-04 3 1  ON 52
ci_54                -1.440439e-03 3 1  ON 53
ci_55                -1.421263e-03 3 1  ON 54
ci_56                 1.370557e-03 3 1  ON 55
ci_57                 2.328494e-03 3 1  ON 56
ci_58                -3.752027e-04 3 1  ON 57
ci_59                -7.596320e-04 3 1  ON 58
ci_60                 4.776429e-03 3 1  ON 59
ci_61                 2.054348e-03 3 1  ON 60
ci_62                 2.297780e-04 3 1  ON 61
ci_63                 3.436957e-05 3 1  ON 62
ci_64                 1.626739e-04 3 1  ON 63
ci_65                 4.225044e-04 3 1  ON 64
ci_66                 2.226694e-05 3 1  ON 65
ci_67                -7.615338e-04 3 1  ON 66
ci_68                -2.341840e-03 3 1  ON 67
ci_69                -1.517103e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2541e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.8146
    reference variance = 0.327737
====================================================
  Execution time = 4.2717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9161e-01
  Total weights = 1.964058060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474497207816
                                         uncertainty =       0.002910728583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474497207816
                                         uncertainty =       0.002910728583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487036634
  error estimate for blocks of size 2^( 2) =       0.000508255982
  error estimate for blocks of size 2^( 3) =       0.000529009126
  error estimate for blocks of size 2^( 4) =       0.000544449147
  error estimate for blocks of size 2^( 5) =       0.000554529596
  error estimate for blocks of size 2^( 6) =       0.000559486777
  error estimate for blocks of size 2^( 7) =       0.000562987615

      target function =      -0.651133322977
              le_mean =     -22.818994631590
             les_mean =     521.198123855689
             stat err =       0.000555363284
             autocorr =       1.300262598110
   target nu stat err =       0.000555363284
   target dn stat err =       0.004186585607
      target stat err =       0.001675733902
              std dev =       0.688773813079
             le_variance =       0.474409365583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281899463159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-06, overlap shift 9.0949e-05 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651137260818       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651282448891       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651293147265       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651297183313       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651297195273       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651296978417       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651297716310       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651298469490       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651298514893       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651298676353       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651298691245       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651298799627       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-06 is 2.789220e-03

solving harmonic davidson linear method for identity shift 3.6380e-05, overlap shift 3.6380e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651137260818       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651282355941       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651293043276       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651297074616       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651297085785       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651296868897       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651297605468       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651298356987       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651298402168       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651298563184       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651298577986       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651298686019       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-05 is 2.786245e-03

solving harmonic davidson linear method for identity shift 1.4552e-04, overlap shift 1.4552e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651137260818       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651281985330       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651292628709       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651296641314       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651296649351       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651296432343       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651297163666       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651297908601       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651297952909       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651298112165       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651298126611       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651298233267       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-04 is 2.774409e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.599374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0332e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_01                 1.132288e-01 3 1  ON 0
ci_02                -2.397592e-02 3 1  ON 1
ci_03                -2.352127e-02 3 1  ON 2
ci_04                 2.240837e-02 3 1  ON 3
ci_05                -1.887077e-02 3 1  ON 4
ci_06                -1.854215e-02 3 1  ON 5
ci_07                 2.560680e-02 3 1  ON 6
ci_08                -3.617319e-03 3 1  ON 7
ci_09                -7.935462e-03 3 1  ON 8
ci_10                -7.920521e-03 3 1  ON 9
ci_11                 1.456430e-02 3 1  ON 10
ci_12                 7.335433e-03 3 1  ON 11
ci_13                 1.093430e-02 3 1  ON 12
ci_14                 1.603938e-02 3 1  ON 13
ci_15                 6.755492e-03 3 1  ON 14
ci_16                 6.014721e-03 3 1  ON 15
ci_17                -7.490466e-03 3 1  ON 16
ci_18                -6.469315e-03 3 1  ON 17
ci_19                 9.861610e-03 3 1  ON 18
ci_20                 6.918055e-03 3 1  ON 19
ci_21                 8.098561e-03 3 1  ON 20
ci_22                 7.920318e-03 3 1  ON 21
ci_23                 4.926991e-03 3 1  ON 22
ci_24                 4.030766e-03 3 1  ON 23
ci_25                 2.081871e-03 3 1  ON 24
ci_26                 2.401570e-03 3 1  ON 25
ci_27                 4.554375e-03 3 1  ON 26
ci_28                 2.081066e-03 3 1  ON 27
ci_29                 5.917323e-04 3 1  ON 28
ci_30                 1.142255e-03 3 1  ON 29
ci_31                -8.762373e-04 3 1  ON 30
ci_32                -4.712433e-05 3 1  ON 31
ci_33                -6.915799e-04 3 1  ON 32
ci_34                 1.252338e-03 3 1  ON 33
ci_35                 2.080892e-03 3 1  ON 34
ci_36                 3.778773e-05 3 1  ON 35
ci_37                -1.445540e-05 3 1  ON 36
ci_38                -7.123779e-04 3 1  ON 37
ci_39                 1.928864e-04 3 1  ON 38
ci_40                -1.105829e-03 3 1  ON 39
ci_41                -1.161366e-03 3 1  ON 40
ci_42                -1.578573e-03 3 1  ON 41
ci_43                -2.716047e-03 3 1  ON 42
ci_44                -2.604166e-04 3 1  ON 43
ci_45                -3.047966e-04 3 1  ON 44
ci_46                -9.079361e-04 3 1  ON 45
ci_47                 7.909138e-04 3 1  ON 46
ci_48                 1.057289e-03 3 1  ON 47
ci_49                -9.600699e-04 3 1  ON 48
ci_50                -1.098712e-03 3 1  ON 49
ci_51                 8.017161e-04 3 1  ON 50
ci_52                 4.598411e-04 3 1  ON 51
ci_53                -9.923982e-04 3 1  ON 52
ci_54                -5.584412e-04 3 1  ON 53
ci_55                -6.700527e-06 3 1  ON 54
ci_56                 5.128681e-04 3 1  ON 55
ci_57                 1.979294e-03 3 1  ON 56
ci_58                -1.435450e-03 3 1  ON 57
ci_59                -2.993659e-04 3 1  ON 58
ci_60                 2.280348e-03 3 1  ON 59
ci_61                 2.373290e-03 3 1  ON 60
ci_62                -2.755601e-04 3 1  ON 61
ci_63                -7.331224e-04 3 1  ON 62
ci_64                 1.942257e-04 3 1  ON 63
ci_65                -8.250246e-04 3 1  ON 64
ci_66                -8.100962e-04 3 1  ON 65
ci_67                -9.705595e-04 3 1  ON 66
ci_68                -1.950958e-03 3 1  ON 67
ci_69                 1.539546e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7563
    reference variance = 0.257571
====================================================
  Execution time = 4.1501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9452e-01
  Total weights = 1.9639e+06
  Execution time = 5.9183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000608073
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486867419719
                                         uncertainty =       0.015275555726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486867419719
                                         uncertainty =       0.015275555726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493339116
  error estimate for blocks of size 2^( 2) =       0.000514473459
  error estimate for blocks of size 2^( 3) =       0.000534162529
  error estimate for blocks of size 2^( 4) =       0.000549307944
  error estimate for blocks of size 2^( 5) =       0.000559272170
  error estimate for blocks of size 2^( 6) =       0.000565632232
  error estimate for blocks of size 2^( 7) =       0.000566889595

      target function =      -0.630398190712
              le_mean =     -22.817870808906
             les_mean =     521.200365102216
             stat err =       0.000560275485
             autocorr =       1.289769606783
   target nu stat err =       0.000560275485
   target dn stat err =       0.027453331067
      target stat err =       0.010089845752
              std dev =       0.697686868368
             le_variance =       0.486766966293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474188938705
                                         uncertainty =       0.004114733724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474188938705
                                         uncertainty =       0.004114733724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486877231
  error estimate for blocks of size 2^( 2) =       0.000508256241
  error estimate for blocks of size 2^( 3) =       0.000528160594
  error estimate for blocks of size 2^( 4) =       0.000543492475
  error estimate for blocks of size 2^( 5) =       0.000553563608
  error estimate for blocks of size 2^( 6) =       0.000559856436
  error estimate for blocks of size 2^( 7) =       0.000560990229

      target function =      -0.649667917109
              le_mean =     -22.817692751903
             les_mean =     521.141625439609
             stat err =       0.000554475687
             autocorr =       1.296958515616
   target nu stat err =       0.000554475687
   target dn stat err =       0.006804481256
      target stat err =       0.002674385032
              std dev =       0.688548383219
             le_variance =       0.474098876034

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00060608
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474780415920
                                         uncertainty =       0.002890276657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474780415920
                                         uncertainty =       0.002890276657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487179819
  error estimate for blocks of size 2^( 2) =       0.000508535661
  error estimate for blocks of size 2^( 3) =       0.000528445608
  error estimate for blocks of size 2^( 4) =       0.000543843621
  error estimate for blocks of size 2^( 5) =       0.000553945418
  error estimate for blocks of size 2^( 6) =       0.000560120095
  error estimate for blocks of size 2^( 7) =       0.000561413148

      target function =      -0.603854134515
              le_mean =     -22.817764635981
             les_mean =     521.268526360141
             stat err =       0.000554830570
             autocorr =       1.297006593678
   target nu stat err =       0.000554830570
   target dn stat err =       0.071303497172
      target stat err =       0.024064509970
              std dev =       0.688976307993
             le_variance =       0.474688352975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474203437282
                                         uncertainty =       0.004126956310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474203437282
                                         uncertainty =       0.004126956310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486884665
  error estimate for blocks of size 2^( 2) =       0.000508263407
  error estimate for blocks of size 2^( 3) =       0.000528167592
  error estimate for blocks of size 2^( 4) =       0.000543499329
  error estimate for blocks of size 2^( 5) =       0.000553570384
  error estimate for blocks of size 2^( 6) =       0.000559863432
  error estimate for blocks of size 2^( 7) =       0.000560997520

      target function =      -0.649673960235
              le_mean =     -22.817692837207
             les_mean =     521.141613832053
             stat err =       0.000554482666
             autocorr =       1.296951562747
   target nu stat err =       0.000554482666
   target dn stat err =       0.006811338038
      target stat err =       0.002677088496
              std dev =       0.688558895969
             le_variance =       0.474113353218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.630398190712        initial
     9.0949e-06     9.0949e-05             2.7892e-03        -0.649667917109
     3.6380e-05     3.6380e-04             2.7862e-03        -0.603854134515
     1.4552e-04     1.4552e-03             2.7744e-03        -0.649673960235  <--

*****************************************************************************
Applying the update for shift_i =   1.4552e-04     and shift_s =   1.4552e-03
*****************************************************************************

  Execution time = 7.1180e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_01                 1.132213e-01 3 1  ON 0
ci_02                -2.397589e-02 3 1  ON 1
ci_03                -2.351854e-02 3 1  ON 2
ci_04                 2.240446e-02 3 1  ON 3
ci_05                -1.887260e-02 3 1  ON 4
ci_06                -1.855064e-02 3 1  ON 5
ci_07                 2.560651e-02 3 1  ON 6
ci_08                -3.615708e-03 3 1  ON 7
ci_09                -7.939266e-03 3 1  ON 8
ci_10                -7.917707e-03 3 1  ON 9
ci_11                 1.456338e-02 3 1  ON 10
ci_12                 7.333251e-03 3 1  ON 11
ci_13                 1.094614e-02 3 1  ON 12
ci_14                 1.604944e-02 3 1  ON 13
ci_15                 6.752981e-03 3 1  ON 14
ci_16                 6.016230e-03 3 1  ON 15
ci_17                -7.489762e-03 3 1  ON 16
ci_18                -6.469574e-03 3 1  ON 17
ci_19                 9.860298e-03 3 1  ON 18
ci_20                 6.916339e-03 3 1  ON 19
ci_21                 8.099684e-03 3 1  ON 20
ci_22                 7.923251e-03 3 1  ON 21
ci_23                 4.926032e-03 3 1  ON 22
ci_24                 4.029257e-03 3 1  ON 23
ci_25                 2.088029e-03 3 1  ON 24
ci_26                 2.400229e-03 3 1  ON 25
ci_27                 4.551901e-03 3 1  ON 26
ci_28                 2.076948e-03 3 1  ON 27
ci_29                 5.902173e-04 3 1  ON 28
ci_30                 1.142109e-03 3 1  ON 29
ci_31                -8.738482e-04 3 1  ON 30
ci_32                -4.853665e-05 3 1  ON 31
ci_33                -6.943073e-04 3 1  ON 32
ci_34                 1.248538e-03 3 1  ON 33
ci_35                 2.078031e-03 3 1  ON 34
ci_36                 3.543714e-05 3 1  ON 35
ci_37                -1.606113e-05 3 1  ON 36
ci_38                -7.116955e-04 3 1  ON 37
ci_39                 1.924682e-04 3 1  ON 38
ci_40                -1.106265e-03 3 1  ON 39
ci_41                -1.159031e-03 3 1  ON 40
ci_42                -1.577078e-03 3 1  ON 41
ci_43                -2.713909e-03 3 1  ON 42
ci_44                -2.684780e-04 3 1  ON 43
ci_45                -3.043965e-04 3 1  ON 44
ci_46                -9.068634e-04 3 1  ON 45
ci_47                 7.918839e-04 3 1  ON 46
ci_48                 1.061053e-03 3 1  ON 47
ci_49                -9.604176e-04 3 1  ON 48
ci_50                -1.097887e-03 3 1  ON 49
ci_51                 8.002781e-04 3 1  ON 50
ci_52                 4.573546e-04 3 1  ON 51
ci_53                -9.911354e-04 3 1  ON 52
ci_54                -5.611742e-04 3 1  ON 53
ci_55                -1.081984e-05 3 1  ON 54
ci_56                 5.149346e-04 3 1  ON 55
ci_57                 1.980132e-03 3 1  ON 56
ci_58                -1.432845e-03 3 1  ON 57
ci_59                -3.005670e-04 3 1  ON 58
ci_60                 2.294895e-03 3 1  ON 59
ci_61                 2.371945e-03 3 1  ON 60
ci_62                -2.743846e-04 3 1  ON 61
ci_63                -7.314103e-04 3 1  ON 62
ci_64                 1.941684e-04 3 1  ON 63
ci_65                -8.218130e-04 3 1  ON 64
ci_66                -8.081266e-04 3 1  ON 65
ci_67                -9.702001e-04 3 1  ON 66
ci_68                -1.951797e-03 3 1  ON 67
ci_69                 1.114434e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2152e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.9572
    reference variance = 0.437951
====================================================
  Execution time = 4.2608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8484e-01
  Total weights = 1.964313711e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468200222731
                                         uncertainty =       0.002226219856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468200222731
                                         uncertainty =       0.002226219856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483828697
  error estimate for blocks of size 2^( 2) =       0.000505620308
  error estimate for blocks of size 2^( 3) =       0.000526646584
  error estimate for blocks of size 2^( 4) =       0.000542397190
  error estimate for blocks of size 2^( 5) =       0.000553611216
  error estimate for blocks of size 2^( 6) =       0.000557264666
  error estimate for blocks of size 2^( 7) =       0.000559980668

      target function =      -0.653827253335
              le_mean =     -22.819108728897
             les_mean =     521.196563755502
             stat err =       0.000553313435
             autocorr =       1.307853753302
   target nu stat err =       0.000553313435
   target dn stat err =       0.004006877485
      target stat err =       0.001619678709
              std dev =       0.684237105588
             le_variance =       0.468180416664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281910872890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-05, overlap shift 3.6380e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653830847932       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654003989060       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654036366568       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654049516750       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654062504115       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654068084647       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654071010895       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654072547123       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654072940325       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654073218670       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654073039941       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654073061246       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654073167777       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.654073185159       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-05 is 7.677005e-03

solving harmonic davidson linear method for identity shift 1.4552e-04, overlap shift 1.4552e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653830847932       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654003549925       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654035807458       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654048884919       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654061787981       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654067320889       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654070220062       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654071740950       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654072128862       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654072403360       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654072226256       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654072247302       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654072352325       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.654072369315       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-04 is 7.638195e-03

solving harmonic davidson linear method for identity shift 5.8208e-04, overlap shift 5.8208e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653830847932       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654001815430       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654033601284       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654046394536       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654058969435       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654064318106       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654067112866       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654068574701       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654068942388       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654069202213       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654069031432       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654069051503       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654069150789       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.654069166314       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-04 is 7.486784e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.605859 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0213e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_01                 1.055831e-01 3 1  ON 0
ci_02                -2.291588e-02 3 1  ON 1
ci_03                -2.419010e-02 3 1  ON 2
ci_04                 2.153640e-02 3 1  ON 3
ci_05                -2.099133e-02 3 1  ON 4
ci_06                -2.001874e-02 3 1  ON 5
ci_07                 2.748173e-02 3 1  ON 6
ci_08                -4.182913e-03 3 1  ON 7
ci_09                -8.061682e-03 3 1  ON 8
ci_10                -7.970272e-03 3 1  ON 9
ci_11                 1.203370e-02 3 1  ON 10
ci_12                 6.477841e-03 3 1  ON 11
ci_13                 1.189077e-02 3 1  ON 12
ci_14                 1.504596e-02 3 1  ON 13
ci_15                 4.596990e-03 3 1  ON 14
ci_16                 6.874839e-03 3 1  ON 15
ci_17                -7.482926e-03 3 1  ON 16
ci_18                -6.028836e-03 3 1  ON 17
ci_19                 9.028793e-03 3 1  ON 18
ci_20                 6.341667e-03 3 1  ON 19
ci_21                 7.810308e-03 3 1  ON 20
ci_22                 8.366382e-03 3 1  ON 21
ci_23                 3.840820e-03 3 1  ON 22
ci_24                 4.954869e-03 3 1  ON 23
ci_25                 3.994222e-03 3 1  ON 24
ci_26                 1.767847e-03 3 1  ON 25
ci_27                 3.517032e-03 3 1  ON 26
ci_28                 1.941181e-03 3 1  ON 27
ci_29                 1.569787e-04 3 1  ON 28
ci_30                -1.634915e-03 3 1  ON 29
ci_31                -2.211598e-03 3 1  ON 30
ci_32                -2.390221e-03 3 1  ON 31
ci_33                -7.674527e-04 3 1  ON 32
ci_34                 1.855575e-03 3 1  ON 33
ci_35                 1.850443e-03 3 1  ON 34
ci_36                -1.078222e-03 3 1  ON 35
ci_37                -1.877190e-04 3 1  ON 36
ci_38                -3.490290e-04 3 1  ON 37
ci_39                -6.657893e-04 3 1  ON 38
ci_40                -1.981213e-03 3 1  ON 39
ci_41                -6.684903e-04 3 1  ON 40
ci_42                -5.821938e-04 3 1  ON 41
ci_43                -1.906953e-03 3 1  ON 42
ci_44                -1.996284e-03 3 1  ON 43
ci_45                -3.840946e-04 3 1  ON 44
ci_46                -6.597349e-04 3 1  ON 45
ci_47                -5.352312e-05 3 1  ON 46
ci_48                -4.665230e-04 3 1  ON 47
ci_49                -5.526293e-04 3 1  ON 48
ci_50                -7.318048e-04 3 1  ON 49
ci_51                 3.271680e-04 3 1  ON 50
ci_52                 1.338320e-04 3 1  ON 51
ci_53                 9.614913e-05 3 1  ON 52
ci_54                 5.873367e-06 3 1  ON 53
ci_55                -1.202865e-03 3 1  ON 54
ci_56                 2.116369e-03 3 1  ON 55
ci_57                 2.024372e-03 3 1  ON 56
ci_58                -5.529684e-04 3 1  ON 57
ci_59                -1.080320e-03 3 1  ON 58
ci_60                -5.605580e-04 3 1  ON 59
ci_61                -1.699704e-03 3 1  ON 60
ci_62                -1.466536e-04 3 1  ON 61
ci_63                -4.437846e-04 3 1  ON 62
ci_64                -8.465159e-04 3 1  ON 63
ci_65                 3.590423e-04 3 1  ON 64
ci_66                -7.315806e-04 3 1  ON 65
ci_67                -5.450722e-04 3 1  ON 66
ci_68                -4.135095e-04 3 1  ON 67
ci_69                -1.172645e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.798
    reference variance = 0.313738
====================================================
  Execution time = 4.4061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9620e-01
  Total weights = 1.9641e+06
  Execution time = 5.9342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0285774
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.389712871297
                                         uncertainty =       1.893799613971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.389712871297
                                         uncertainty =       1.893799613971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001091845429
  error estimate for blocks of size 2^( 2) =       0.001101478845
  error estimate for blocks of size 2^( 3) =       0.001111628515
  error estimate for blocks of size 2^( 4) =       0.001119912825
  error estimate for blocks of size 2^( 5) =       0.001124510151
  error estimate for blocks of size 2^( 6) =       0.001122563321
  error estimate for blocks of size 2^( 7) =       0.001126554418

      target function =      -0.038822491319
              le_mean =     -22.817078261996
             les_mean =     535.839694408533
             stat err =       0.001123385179
             autocorr =       1.058607724602
   target nu stat err =       0.001123385179
   target dn stat err =      13.744408417291
      target stat err =       0.032549324663
              std dev =       1.544102613908
             le_variance =       2.384252882278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470741882328
                                         uncertainty =       0.002513600029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470741882328
                                         uncertainty =       0.002513600029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485197757
  error estimate for blocks of size 2^( 2) =       0.000507254123
  error estimate for blocks of size 2^( 3) =       0.000528378177
  error estimate for blocks of size 2^( 4) =       0.000544447330
  error estimate for blocks of size 2^( 5) =       0.000553883383
  error estimate for blocks of size 2^( 6) =       0.000558957617
  error estimate for blocks of size 2^( 7) =       0.000565183334

      target function =      -0.648848814558
              le_mean =     -22.817979961267
             les_mean =     521.157009014460
             stat err =       0.000555617916
             autocorr =       1.311338805652
   target nu stat err =       0.000555617916
   target dn stat err =       0.007473625408
      target stat err =       0.002927006323
              std dev =       0.686173248492
             le_variance =       0.470833726946

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0285057
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.585600558732
                                         uncertainty =       1.795913773891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.585600558732
                                         uncertainty =       1.795913773891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136055291
  error estimate for blocks of size 2^( 2) =       0.001145113503
  error estimate for blocks of size 2^( 3) =       0.001154403814
  error estimate for blocks of size 2^( 4) =       0.001161830746
  error estimate for blocks of size 2^( 5) =       0.001166200579
  error estimate for blocks of size 2^( 6) =       0.001168822139
  error estimate for blocks of size 2^( 7) =       0.001169537612

      target function =      -0.011307285173
              le_mean =     -22.817616901667
             les_mean =     578.290281276554
             stat err =       0.001166597769
             autocorr =       1.054492137183
   target nu stat err =       0.001166597769
   target dn stat err =      46.607829903530
      target stat err =       0.008959957477
              std dev =       1.606624799921
             le_variance =       2.581243247720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470721429911
                                         uncertainty =       0.002507463699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470721429911
                                         uncertainty =       0.002507463699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485187208
  error estimate for blocks of size 2^( 2) =       0.000507242823
  error estimate for blocks of size 2^( 3) =       0.000528364938
  error estimate for blocks of size 2^( 4) =       0.000544433395
  error estimate for blocks of size 2^( 5) =       0.000553869728
  error estimate for blocks of size 2^( 6) =       0.000558943979
  error estimate for blocks of size 2^( 7) =       0.000565171614

      target function =      -0.649104061641
              le_mean =     -22.817980489605
             les_mean =     521.156378293785
             stat err =       0.000555604679
             autocorr =       1.311333348036
   target nu stat err =       0.000555604679
   target dn stat err =       0.007405880098
      target stat err =       0.002903086752
              std dev =       0.686158329306
             le_variance =       0.470813252876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.038822491319        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     1.4552e-04     1.4552e-03             7.6382e-03        -0.011307285173
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.8209
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_01                 1.132213e-01 3 1  ON 0
ci_02                -2.397589e-02 3 1  ON 1
ci_03                -2.351854e-02 3 1  ON 2
ci_04                 2.240446e-02 3 1  ON 3
ci_05                -1.887260e-02 3 1  ON 4
ci_06                -1.855064e-02 3 1  ON 5
ci_07                 2.560651e-02 3 1  ON 6
ci_08                -3.615708e-03 3 1  ON 7
ci_09                -7.939266e-03 3 1  ON 8
ci_10                -7.917707e-03 3 1  ON 9
ci_11                 1.456338e-02 3 1  ON 10
ci_12                 7.333251e-03 3 1  ON 11
ci_13                 1.094614e-02 3 1  ON 12
ci_14                 1.604944e-02 3 1  ON 13
ci_15                 6.752981e-03 3 1  ON 14
ci_16                 6.016230e-03 3 1  ON 15
ci_17                -7.489762e-03 3 1  ON 16
ci_18                -6.469574e-03 3 1  ON 17
ci_19                 9.860298e-03 3 1  ON 18
ci_20                 6.916339e-03 3 1  ON 19
ci_21                 8.099684e-03 3 1  ON 20
ci_22                 7.923251e-03 3 1  ON 21
ci_23                 4.926032e-03 3 1  ON 22
ci_24                 4.029257e-03 3 1  ON 23
ci_25                 2.088029e-03 3 1  ON 24
ci_26                 2.400229e-03 3 1  ON 25
ci_27                 4.551901e-03 3 1  ON 26
ci_28                 2.076948e-03 3 1  ON 27
ci_29                 5.902173e-04 3 1  ON 28
ci_30                 1.142109e-03 3 1  ON 29
ci_31                -8.738482e-04 3 1  ON 30
ci_32                -4.853665e-05 3 1  ON 31
ci_33                -6.943073e-04 3 1  ON 32
ci_34                 1.248538e-03 3 1  ON 33
ci_35                 2.078031e-03 3 1  ON 34
ci_36                 3.543714e-05 3 1  ON 35
ci_37                -1.606113e-05 3 1  ON 36
ci_38                -7.116955e-04 3 1  ON 37
ci_39                 1.924682e-04 3 1  ON 38
ci_40                -1.106265e-03 3 1  ON 39
ci_41                -1.159031e-03 3 1  ON 40
ci_42                -1.577078e-03 3 1  ON 41
ci_43                -2.713909e-03 3 1  ON 42
ci_44                -2.684780e-04 3 1  ON 43
ci_45                -3.043965e-04 3 1  ON 44
ci_46                -9.068634e-04 3 1  ON 45
ci_47                 7.918839e-04 3 1  ON 46
ci_48                 1.061053e-03 3 1  ON 47
ci_49                -9.604176e-04 3 1  ON 48
ci_50                -1.097887e-03 3 1  ON 49
ci_51                 8.002781e-04 3 1  ON 50
ci_52                 4.573546e-04 3 1  ON 51
ci_53                -9.911354e-04 3 1  ON 52
ci_54                -5.611742e-04 3 1  ON 53
ci_55                -1.081984e-05 3 1  ON 54
ci_56                 5.149346e-04 3 1  ON 55
ci_57                 1.980132e-03 3 1  ON 56
ci_58                -1.432845e-03 3 1  ON 57
ci_59                -3.005670e-04 3 1  ON 58
ci_60                 2.294895e-03 3 1  ON 59
ci_61                 2.371945e-03 3 1  ON 60
ci_62                -2.743846e-04 3 1  ON 61
ci_63                -7.314103e-04 3 1  ON 62
ci_64                 1.941684e-04 3 1  ON 63
ci_65                -8.218130e-04 3 1  ON 64
ci_66                -8.081266e-04 3 1  ON 65
ci_67                -9.702001e-04 3 1  ON 66
ci_68                -1.951797e-03 3 1  ON 67
ci_69                 1.114434e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2404e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6847
    reference variance = 2.68455
====================================================
  Execution time = 4.4333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8187e-01
  Total weights = 1.964133315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467345989385
                                         uncertainty =       0.002133349684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467345989385
                                         uncertainty =       0.002133349684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483451262
  error estimate for blocks of size 2^( 2) =       0.000504852359
  error estimate for blocks of size 2^( 3) =       0.000524911097
  error estimate for blocks of size 2^( 4) =       0.000540999630
  error estimate for blocks of size 2^( 5) =       0.000550437246
  error estimate for blocks of size 2^( 6) =       0.000556762164
  error estimate for blocks of size 2^( 7) =       0.000559039156

      target function =      -0.654955413406
              le_mean =     -22.818904205975
             les_mean =     521.184257115276
             stat err =       0.000551809549
             autocorr =       1.302785830811
   target nu stat err =       0.000551809549
   target dn stat err =       0.002831135882
      target stat err =       0.001172052454
              std dev =       0.683703331815
             le_variance =       0.467450245935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281890420598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-04, overlap shift 3.6380e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654957084295       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655117158481       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655146105755       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655155558317       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655162154597       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655166206713       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655166687655       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655166971367       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655166775515       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655166732740       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655166711381       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655166685034       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-04 is 3.384413e-03

solving harmonic davidson linear method for identity shift 1.4552e-03, overlap shift 1.4552e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654957084295       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655113327011       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655141258897       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655150292248       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655156533723       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655160313329       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655160730904       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655160979950       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655160796069       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655160756142       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655160736420       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-03 is 3.204208e-03

solving harmonic davidson linear method for identity shift 5.8208e-03, overlap shift 5.8208e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654957084295       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655099674564       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655124134507       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655131778520       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655136880634       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655139820998       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655140064519       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655140219743       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655140074512       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655140043941       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655140029303       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-03 is 2.769112e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.610276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1961e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_01                 1.100171e-01 3 1  ON 0
ci_02                -2.471213e-02 3 1  ON 1
ci_03                -2.566987e-02 3 1  ON 2
ci_04                 2.070628e-02 3 1  ON 3
ci_05                -2.197773e-02 3 1  ON 4
ci_06                -1.893962e-02 3 1  ON 5
ci_07                 2.608161e-02 3 1  ON 6
ci_08                -3.195043e-03 3 1  ON 7
ci_09                -7.360408e-03 3 1  ON 8
ci_10                -6.755060e-03 3 1  ON 9
ci_11                 1.273958e-02 3 1  ON 10
ci_12                 6.549202e-03 3 1  ON 11
ci_13                 1.386082e-02 3 1  ON 12
ci_14                 1.575192e-02 3 1  ON 13
ci_15                 4.865923e-03 3 1  ON 14
ci_16                 6.277393e-03 3 1  ON 15
ci_17                -7.293116e-03 3 1  ON 16
ci_18                -6.046043e-03 3 1  ON 17
ci_19                 9.415570e-03 3 1  ON 18
ci_20                 7.967772e-03 3 1  ON 19
ci_21                 7.746435e-03 3 1  ON 20
ci_22                 1.027156e-02 3 1  ON 21
ci_23                 4.185786e-03 3 1  ON 22
ci_24                 4.784404e-03 3 1  ON 23
ci_25                 3.546410e-03 3 1  ON 24
ci_26                 2.683356e-03 3 1  ON 25
ci_27                 1.692220e-03 3 1  ON 26
ci_28                 2.188502e-03 3 1  ON 27
ci_29                 1.119850e-03 3 1  ON 28
ci_30                 1.383626e-03 3 1  ON 29
ci_31                 9.163437e-04 3 1  ON 30
ci_32                -1.563728e-04 3 1  ON 31
ci_33                -1.202264e-03 3 1  ON 32
ci_34                -1.718904e-04 3 1  ON 33
ci_35                -3.803839e-04 3 1  ON 34
ci_36                 6.496457e-04 3 1  ON 35
ci_37                -9.857070e-04 3 1  ON 36
ci_38                 9.314203e-04 3 1  ON 37
ci_39                 3.274727e-04 3 1  ON 38
ci_40                -4.210531e-04 3 1  ON 39
ci_41                -8.661012e-04 3 1  ON 40
ci_42                -1.118981e-03 3 1  ON 41
ci_43                -1.774879e-03 3 1  ON 42
ci_44                -9.214332e-04 3 1  ON 43
ci_45                -2.559744e-04 3 1  ON 44
ci_46                -7.127318e-04 3 1  ON 45
ci_47                 1.084429e-03 3 1  ON 46
ci_48                 2.553404e-03 3 1  ON 47
ci_49                -1.451477e-03 3 1  ON 48
ci_50                -3.130751e-04 3 1  ON 49
ci_51                -1.723526e-04 3 1  ON 50
ci_52                 5.240139e-04 3 1  ON 51
ci_53                -1.381213e-03 3 1  ON 52
ci_54                -1.260742e-03 3 1  ON 53
ci_55                 1.774049e-04 3 1  ON 54
ci_56                 1.983498e-03 3 1  ON 55
ci_57                 2.343263e-03 3 1  ON 56
ci_58                -8.573217e-04 3 1  ON 57
ci_59                -5.347711e-04 3 1  ON 58
ci_60                 2.221572e-03 3 1  ON 59
ci_61                 9.217368e-04 3 1  ON 60
ci_62                -1.019270e-03 3 1  ON 61
ci_63                -6.542901e-04 3 1  ON 62
ci_64                -4.428421e-04 3 1  ON 63
ci_65                -8.444171e-05 3 1  ON 64
ci_66                -1.903819e-04 3 1  ON 65
ci_67                -4.956288e-04 3 1  ON 66
ci_68                -1.101275e-03 3 1  ON 67
ci_69                -2.250653e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8149
    reference variance = 0.22095
====================================================
  Execution time = 4.1546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9061e-01
  Total weights = 1.9641e+06
  Execution time = 5.9628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473444258271
                                         uncertainty =       0.002813170823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473444258271
                                         uncertainty =       0.002813170823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486600127
  error estimate for blocks of size 2^( 2) =       0.000508525085
  error estimate for blocks of size 2^( 3) =       0.000529411435
  error estimate for blocks of size 2^( 4) =       0.000544556494
  error estimate for blocks of size 2^( 5) =       0.000553848503
  error estimate for blocks of size 2^( 6) =       0.000556924566
  error estimate for blocks of size 2^( 7) =       0.000559676834

      target function =      -0.602320020836
              le_mean =     -22.818647880522
             les_mean =     521.313857988007
             stat err =       0.000553751599
             autocorr =       1.295047060995
   target nu stat err =       0.000553751599
   target dn stat err =       0.071125633633
      target stat err =       0.023901933829
              std dev =       0.688156499434
             le_variance =       0.473559367714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471085101738
                                         uncertainty =       0.002772815018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471085101738
                                         uncertainty =       0.002772815018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485386802
  error estimate for blocks of size 2^( 2) =       0.000507412552
  error estimate for blocks of size 2^( 3) =       0.000528354746
  error estimate for blocks of size 2^( 4) =       0.000543596371
  error estimate for blocks of size 2^( 5) =       0.000552913403
  error estimate for blocks of size 2^( 6) =       0.000556067227
  error estimate for blocks of size 2^( 7) =       0.000558781986

      target function =      -0.628040835407
              le_mean =     -22.818505383105
             les_mean =     521.234488115693
             stat err =       0.000552839747
             autocorr =       1.297246754524
   target nu stat err =       0.000552839747
   target dn stat err =       0.059883881835
      target stat err =       0.021869238162
              std dev =       0.686440597889
             le_variance =       0.471200694430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474720063516
                                         uncertainty =       0.003264977219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474720063516
                                         uncertainty =       0.003264977219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487250558
  error estimate for blocks of size 2^( 2) =       0.000509207320
  error estimate for blocks of size 2^( 3) =       0.000530110086
  error estimate for blocks of size 2^( 4) =       0.000545432252
  error estimate for blocks of size 2^( 5) =       0.000554562252
  error estimate for blocks of size 2^( 6) =       0.000557863537
  error estimate for blocks of size 2^( 7) =       0.000560452623

      target function =      -0.586858636580
              le_mean =     -22.818635787391
             les_mean =     521.358888678769
             stat err =       0.000554577666
             autocorr =       1.295448227770
   target nu stat err =       0.000554577666
   target dn stat err =       0.091337841567
      target stat err =       0.029163436690
              std dev =       0.689076347454
             le_variance =       0.474826212621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471198472079
                                         uncertainty =       0.002771058583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471198472079
                                         uncertainty =       0.002771058583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485445279
  error estimate for blocks of size 2^( 2) =       0.000507484736
  error estimate for blocks of size 2^( 3) =       0.000528422091
  error estimate for blocks of size 2^( 4) =       0.000543658736
  error estimate for blocks of size 2^( 5) =       0.000552968651
  error estimate for blocks of size 2^( 6) =       0.000556079780
  error estimate for blocks of size 2^( 7) =       0.000558907234

      target function =      -0.583736191730
              le_mean =     -22.818516856114
             les_mean =     521.351032600459
             stat err =       0.000552903600
             autocorr =       1.297233850139
   target nu stat err =       0.000552903600
   target dn stat err =       0.175512889114
      target stat err =       0.055805430886
              std dev =       0.686523296663
             le_variance =       0.471314236861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.602320020836        initial
     3.6380e-04     3.6380e-03             3.3844e-03        -0.628040835407  <--
     1.4552e-03     1.4552e-02             3.2042e-03        -0.586858636580
     5.8208e-03     5.8208e-02             2.7691e-03        -0.583736191730

*****************************************************************************
Applying the update for shift_i =   3.6380e-04     and shift_s =   3.6380e-03
*****************************************************************************

  Execution time = 7.1357e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_01                 1.098369e-01 3 1  ON 0
ci_02                -2.473847e-02 3 1  ON 1
ci_03                -2.573348e-02 3 1  ON 2
ci_04                 2.065907e-02 3 1  ON 3
ci_05                -2.207387e-02 3 1  ON 4
ci_06                -1.895265e-02 3 1  ON 5
ci_07                 2.609298e-02 3 1  ON 6
ci_08                -3.176908e-03 3 1  ON 7
ci_09                -7.348300e-03 3 1  ON 8
ci_10                -6.710839e-03 3 1  ON 9
ci_11                 1.268138e-02 3 1  ON 10
ci_12                 6.528005e-03 3 1  ON 11
ci_13                 1.398759e-02 3 1  ON 12
ci_14                 1.571912e-02 3 1  ON 13
ci_15                 4.809018e-03 3 1  ON 14
ci_16                 6.286989e-03 3 1  ON 15
ci_17                -7.291975e-03 3 1  ON 16
ci_18                -6.034529e-03 3 1  ON 17
ci_19                 9.408672e-03 3 1  ON 18
ci_20                 7.992209e-03 3 1  ON 19
ci_21                 7.731197e-03 3 1  ON 20
ci_22                 1.036244e-02 3 1  ON 21
ci_23                 4.169475e-03 3 1  ON 22
ci_24                 4.808671e-03 3 1  ON 23
ci_25                 3.587847e-03 3 1  ON 24
ci_26                 2.693076e-03 3 1  ON 25
ci_27                 1.610716e-03 3 1  ON 26
ci_28                 2.192197e-03 3 1  ON 27
ci_29                 1.133508e-03 3 1  ON 28
ci_30                 1.395567e-03 3 1  ON 29
ci_31                 9.905877e-04 3 1  ON 30
ci_32                -1.582317e-04 3 1  ON 31
ci_33                -1.216887e-03 3 1  ON 32
ci_34                -2.142171e-04 3 1  ON 33
ci_35                -4.450695e-04 3 1  ON 34
ci_36                 6.613371e-04 3 1  ON 35
ci_37                -1.009973e-03 3 1  ON 36
ci_38                 9.669649e-04 3 1  ON 37
ci_39                 3.284733e-04 3 1  ON 38
ci_40                -4.091131e-04 3 1  ON 39
ci_41                -8.588706e-04 3 1  ON 40
ci_42                -1.106524e-03 3 1  ON 41
ci_43                -1.744471e-03 3 1  ON 42
ci_44                -9.363348e-04 3 1  ON 43
ci_45                -2.565370e-04 3 1  ON 44
ci_46                -7.058039e-04 3 1  ON 45
ci_47                 1.097767e-03 3 1  ON 46
ci_48                 2.607244e-03 3 1  ON 47
ci_49                -1.463634e-03 3 1  ON 48
ci_50                -2.978810e-04 3 1  ON 49
ci_51                -1.968547e-04 3 1  ON 50
ci_52                 5.257614e-04 3 1  ON 51
ci_53                -1.389747e-03 3 1  ON 52
ci_54                -1.281280e-03 3 1  ON 53
ci_55                 1.828109e-04 3 1  ON 54
ci_56                 2.018178e-03 3 1  ON 55
ci_57                 2.347302e-03 3 1  ON 56
ci_58                -8.455809e-04 3 1  ON 57
ci_59                -5.429975e-04 3 1  ON 58
ci_60                 2.218845e-03 3 1  ON 59
ci_61                 8.335415e-04 3 1  ON 60
ci_62                -1.038706e-03 3 1  ON 61
ci_63                -6.547020e-04 3 1  ON 62
ci_64                -4.598006e-04 3 1  ON 63
ci_65                -6.681415e-05 3 1  ON 64
ci_66                -1.738971e-04 3 1  ON 65
ci_67                -4.854405e-04 3 1  ON 66
ci_68                -1.078423e-03 3 1  ON 67
ci_69                -2.282585e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2332e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8722
    reference variance = 0.940112
====================================================
  Execution time = 4.2883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.2394e-01
  Total weights = 1.964419642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508859158831
                                         uncertainty =       0.040873959521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508859158831
                                         uncertainty =       0.040873959521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504386597
  error estimate for blocks of size 2^( 2) =       0.000525406622
  error estimate for blocks of size 2^( 3) =       0.000545370285
  error estimate for blocks of size 2^( 4) =       0.000561214497
  error estimate for blocks of size 2^( 5) =       0.000572222289
  error estimate for blocks of size 2^( 6) =       0.000577035238
  error estimate for blocks of size 2^( 7) =       0.000583236278

      target function =      -0.638321194495
              le_mean =     -22.819005545723
             les_mean =     521.230953326106
             stat err =       0.000573427076
             autocorr =       1.292496321761
   target nu stat err =       0.000573427076
   target dn stat err =       0.041443420970
      target stat err =       0.015634035193
              std dev =       0.713310365610
             le_variance =       0.508811677686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281900554572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-05, overlap shift 9.0949e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.638701304727       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642797925202       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.643225771820       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.643354180163       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.643390335188       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.643422897736       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.643432179355       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.643435641800       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.643435883401       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.643436094384       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.643436716353       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.643437031415       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.643437408572       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.643437428376       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.643437395568       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-05 is 1.833753e-02

solving harmonic davidson linear method for identity shift 3.6380e-04, overlap shift 3.6380e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.638701304727       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642772833343       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.643197093508       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.643324050253       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.643359694292       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.643391634494       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.643400655237       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.643404008298       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.643404237663       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.643404440445       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.643405045421       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.643405348967       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.643405712736       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.643405729986       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.643405697285       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-04 is 1.812259e-02

solving harmonic davidson linear method for identity shift 1.4552e-03, overlap shift 1.4552e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.638701304727       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.642675440200       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.643085904307       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.643207333424       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.643241048344       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.643270673547       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.643278746068       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.643281707191       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.643281894221       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.643282068183       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.643282611934       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.643282874784       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.643283191195       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.643283199998       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.643283168191       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-03 is 1.731235e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.617688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0485e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_01                 9.171432e-02 3 1  ON 0
ci_02                -4.241628e-02 3 1  ON 1
ci_03                -2.962000e-02 3 1  ON 2
ci_04                 1.676145e-02 3 1  ON 3
ci_05                -1.566277e-02 3 1  ON 4
ci_06                -9.792019e-03 3 1  ON 5
ci_07                 2.680393e-02 3 1  ON 6
ci_08                -3.211419e-04 3 1  ON 7
ci_09                -6.001330e-03 3 1  ON 8
ci_10                -6.314093e-03 3 1  ON 9
ci_11                 1.422533e-02 3 1  ON 10
ci_12                 6.097160e-03 3 1  ON 11
ci_13                 1.464223e-02 3 1  ON 12
ci_14                 1.398913e-02 3 1  ON 13
ci_15                 8.434370e-03 3 1  ON 14
ci_16                 5.305937e-03 3 1  ON 15
ci_17                 1.919962e-03 3 1  ON 16
ci_18                -2.386353e-03 3 1  ON 17
ci_19                 1.289660e-02 3 1  ON 18
ci_20                 2.758053e-03 3 1  ON 19
ci_21                 8.950563e-03 3 1  ON 20
ci_22                 9.075713e-03 3 1  ON 21
ci_23                 3.288490e-03 3 1  ON 22
ci_24                -1.089759e-04 3 1  ON 23
ci_25                 7.353713e-03 3 1  ON 24
ci_26                 3.550357e-03 3 1  ON 25
ci_27                 2.899627e-03 3 1  ON 26
ci_28                -1.124291e-03 3 1  ON 27
ci_29                 1.075830e-02 3 1  ON 28
ci_30                -9.124732e-04 3 1  ON 29
ci_31                 6.548634e-04 3 1  ON 30
ci_32                 4.832979e-03 3 1  ON 31
ci_33                -3.714986e-03 3 1  ON 32
ci_34                 4.922360e-03 3 1  ON 33
ci_35                -8.400643e-03 3 1  ON 34
ci_36                -6.308059e-04 3 1  ON 35
ci_37                -1.434628e-03 3 1  ON 36
ci_38                -5.644092e-04 3 1  ON 37
ci_39                -4.813988e-04 3 1  ON 38
ci_40                -2.085637e-03 3 1  ON 39
ci_41                -1.199756e-02 3 1  ON 40
ci_42                -2.034997e-03 3 1  ON 41
ci_43                -8.527851e-03 3 1  ON 42
ci_44                 4.757033e-03 3 1  ON 43
ci_45                 5.318504e-04 3 1  ON 44
ci_46                -4.283243e-04 3 1  ON 45
ci_47                 1.737383e-03 3 1  ON 46
ci_48                 2.156773e-03 3 1  ON 47
ci_49                -1.528723e-04 3 1  ON 48
ci_50                -1.183044e-03 3 1  ON 49
ci_51                 1.438601e-04 3 1  ON 50
ci_52                -3.534664e-04 3 1  ON 51
ci_53                 3.826060e-04 3 1  ON 52
ci_54                -2.019792e-04 3 1  ON 53
ci_55                 6.025021e-06 3 1  ON 54
ci_56                -3.077160e-03 3 1  ON 55
ci_57                 2.526227e-03 3 1  ON 56
ci_58                 4.252139e-05 3 1  ON 57
ci_59                -1.341887e-02 3 1  ON 58
ci_60                 1.222236e-02 3 1  ON 59
ci_61                 7.471726e-03 3 1  ON 60
ci_62                 1.578915e-03 3 1  ON 61
ci_63                -1.923150e-03 3 1  ON 62
ci_64                -1.378075e-03 3 1  ON 63
ci_65                 1.277894e-03 3 1  ON 64
ci_66                -1.007146e-03 3 1  ON 65
ci_67                -1.021179e-03 3 1  ON 66
ci_68                 3.642110e-03 3 1  ON 67
ci_69                 2.397756e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8324
    reference variance = 0.434947
====================================================
  Execution time = 4.1556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9671e-01
  Total weights = 1.9637e+06
  Execution time = 5.9512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0601187
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.804857990323
                                         uncertainty =       0.130439441600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.804857990323
                                         uncertainty =       0.130439441600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000635059012
  error estimate for blocks of size 2^( 2) =       0.000651568728
  error estimate for blocks of size 2^( 3) =       0.000668194049
  error estimate for blocks of size 2^( 4) =       0.000680834976
  error estimate for blocks of size 2^( 5) =       0.000688822615
  error estimate for blocks of size 2^( 6) =       0.000695008857
  error estimate for blocks of size 2^( 7) =       0.000700028527

      target function =      -0.050790893510
              le_mean =     -22.819723709875
             les_mean =     532.537869141011
             stat err =       0.000691173744
             autocorr =       1.184530632056
   target nu stat err =       0.000691173744
   target dn stat err =      10.379630949675
      target stat err =       0.040662384576
              std dev =       0.898109068327
             le_variance =       0.806599898611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480532678721
                                         uncertainty =       0.004995722277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480532678721
                                         uncertainty =       0.004995722277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490129195
  error estimate for blocks of size 2^( 2) =       0.000511551887
  error estimate for blocks of size 2^( 3) =       0.000532726695
  error estimate for blocks of size 2^( 4) =       0.000549431534
  error estimate for blocks of size 2^( 5) =       0.000558709357
  error estimate for blocks of size 2^( 6) =       0.000564713828
  error estimate for blocks of size 2^( 7) =       0.000568762704

      target function =      -0.648453579104
              le_mean =     -22.816697182679
             les_mean =     521.098693371027
             stat err =       0.000560404356
             autocorr =       1.307319864094
   target nu stat err =       0.000560404356
   target dn stat err =       0.006730171139
      target stat err =       0.002633856148
              std dev =       0.693147354517
             le_variance =       0.480453255074

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0608017
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     696.806853914525
                                         uncertainty =     692.291221053133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     696.806853914525
                                         uncertainty =     692.291221053133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.018657229200
  error estimate for blocks of size 2^( 2) =       0.018659272851
  error estimate for blocks of size 2^( 3) =       0.018662089642
  error estimate for blocks of size 2^( 4) =       0.018662860778
  error estimate for blocks of size 2^( 5) =       0.018672791759
  error estimate for blocks of size 2^( 6) =       0.018673085077
  error estimate for blocks of size 2^( 7) =       0.018675525896

      target function =      -0.000158808878
              le_mean =     -22.837634632531
             les_mean =    3844.253768459641
             stat err =       0.018671065878
             autocorr =       1.001483801103
   target nu stat err =       0.018671065878
   target dn stat err =    3317.172249426393
      target stat err =       0.000158515598
              std dev =      26.385306570547
             le_variance =     696.184402821740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480167414327
                                         uncertainty =       0.005016923421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480167414327
                                         uncertainty =       0.005016923421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489942933
  error estimate for blocks of size 2^( 2) =       0.000511351024
  error estimate for blocks of size 2^( 3) =       0.000532510251
  error estimate for blocks of size 2^( 4) =       0.000549205021
  error estimate for blocks of size 2^( 5) =       0.000558486971
  error estimate for blocks of size 2^( 6) =       0.000564493338
  error estimate for blocks of size 2^( 7) =       0.000568578110

      target function =      -0.639676819672
              le_mean =     -22.816705116280
             les_mean =     521.121762035339
             stat err =       0.000560190860
             autocorr =       1.307317403452
   target nu stat err =       0.000560190860
   target dn stat err =       0.019008054443
      target stat err =       0.007188455371
              std dev =       0.692883940268
             le_variance =       0.480088154682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.050790893510        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     3.6380e-04     3.6380e-03             1.8123e-02        -0.000158808878
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.4640
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_01                 1.098369e-01 3 1  ON 0
ci_02                -2.473847e-02 3 1  ON 1
ci_03                -2.573348e-02 3 1  ON 2
ci_04                 2.065907e-02 3 1  ON 3
ci_05                -2.207387e-02 3 1  ON 4
ci_06                -1.895265e-02 3 1  ON 5
ci_07                 2.609298e-02 3 1  ON 6
ci_08                -3.176908e-03 3 1  ON 7
ci_09                -7.348300e-03 3 1  ON 8
ci_10                -6.710839e-03 3 1  ON 9
ci_11                 1.268138e-02 3 1  ON 10
ci_12                 6.528005e-03 3 1  ON 11
ci_13                 1.398759e-02 3 1  ON 12
ci_14                 1.571912e-02 3 1  ON 13
ci_15                 4.809018e-03 3 1  ON 14
ci_16                 6.286989e-03 3 1  ON 15
ci_17                -7.291975e-03 3 1  ON 16
ci_18                -6.034529e-03 3 1  ON 17
ci_19                 9.408672e-03 3 1  ON 18
ci_20                 7.992209e-03 3 1  ON 19
ci_21                 7.731197e-03 3 1  ON 20
ci_22                 1.036244e-02 3 1  ON 21
ci_23                 4.169475e-03 3 1  ON 22
ci_24                 4.808671e-03 3 1  ON 23
ci_25                 3.587847e-03 3 1  ON 24
ci_26                 2.693076e-03 3 1  ON 25
ci_27                 1.610716e-03 3 1  ON 26
ci_28                 2.192197e-03 3 1  ON 27
ci_29                 1.133508e-03 3 1  ON 28
ci_30                 1.395567e-03 3 1  ON 29
ci_31                 9.905877e-04 3 1  ON 30
ci_32                -1.582317e-04 3 1  ON 31
ci_33                -1.216887e-03 3 1  ON 32
ci_34                -2.142171e-04 3 1  ON 33
ci_35                -4.450695e-04 3 1  ON 34
ci_36                 6.613371e-04 3 1  ON 35
ci_37                -1.009973e-03 3 1  ON 36
ci_38                 9.669649e-04 3 1  ON 37
ci_39                 3.284733e-04 3 1  ON 38
ci_40                -4.091131e-04 3 1  ON 39
ci_41                -8.588706e-04 3 1  ON 40
ci_42                -1.106524e-03 3 1  ON 41
ci_43                -1.744471e-03 3 1  ON 42
ci_44                -9.363348e-04 3 1  ON 43
ci_45                -2.565370e-04 3 1  ON 44
ci_46                -7.058039e-04 3 1  ON 45
ci_47                 1.097767e-03 3 1  ON 46
ci_48                 2.607244e-03 3 1  ON 47
ci_49                -1.463634e-03 3 1  ON 48
ci_50                -2.978810e-04 3 1  ON 49
ci_51                -1.968547e-04 3 1  ON 50
ci_52                 5.257614e-04 3 1  ON 51
ci_53                -1.389747e-03 3 1  ON 52
ci_54                -1.281280e-03 3 1  ON 53
ci_55                 1.828109e-04 3 1  ON 54
ci_56                 2.018178e-03 3 1  ON 55
ci_57                 2.347302e-03 3 1  ON 56
ci_58                -8.455809e-04 3 1  ON 57
ci_59                -5.429975e-04 3 1  ON 58
ci_60                 2.218845e-03 3 1  ON 59
ci_61                 8.335415e-04 3 1  ON 60
ci_62                -1.038706e-03 3 1  ON 61
ci_63                -6.547020e-04 3 1  ON 62
ci_64                -4.598006e-04 3 1  ON 63
ci_65                -6.681415e-05 3 1  ON 64
ci_66                -1.738971e-04 3 1  ON 65
ci_67                -4.854405e-04 3 1  ON 66
ci_68                -1.078423e-03 3 1  ON 67
ci_69                -2.282585e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2196e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.8739
    reference variance = 0.313468
====================================================
  Execution time = 4.4117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8261e-01
  Total weights = 1.964307717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466214252682
                                         uncertainty =       0.002466501537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466214252682
                                         uncertainty =       0.002466501537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482760781
  error estimate for blocks of size 2^( 2) =       0.000504476748
  error estimate for blocks of size 2^( 3) =       0.000525916347
  error estimate for blocks of size 2^( 4) =       0.000542282734
  error estimate for blocks of size 2^( 5) =       0.000552599539
  error estimate for blocks of size 2^( 6) =       0.000559860648
  error estimate for blocks of size 2^( 7) =       0.000566467826

      target function =      -0.654314245145
              le_mean =     -22.817536992348
             les_mean =     521.122605103359
             stat err =       0.000555302687
             autocorr =       1.323108886537
   target nu stat err =       0.000555302687
   target dn stat err =       0.004291907610
      target stat err =       0.001730380195
              std dev =       0.682726844532
             le_variance =       0.466115944244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281753699235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-04, overlap shift 9.0949e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654318368031       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654489129050       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654522842851       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654525039416       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654523284677       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654523529536       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654523551605       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654522874560       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654522835695       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654522766441       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654522662387       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654522626669       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-04 is 3.318595e-03

solving harmonic davidson linear method for identity shift 3.6380e-03, overlap shift 3.6380e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654318368031       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654479036094       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654509940791       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654511786522       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654510164044       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654510376587       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654510375500       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654509802047       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654509778037       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654509723575       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654509643590       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-03 is 3.093667e-03

solving harmonic davidson linear method for identity shift 1.4552e-02, overlap shift 1.4552e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654318368031       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654448311724       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654471360887       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654472370469       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654471144195       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654471284006       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654471247714       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654470911964       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654470912067       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654470886027       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-02 is 2.434127e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.626943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1828e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_01                 1.087666e-01 3 1  ON 0
ci_02                -2.220885e-02 3 1  ON 1
ci_03                -2.316482e-02 3 1  ON 2
ci_04                 2.176958e-02 3 1  ON 3
ci_05                -2.265144e-02 3 1  ON 4
ci_06                -1.984426e-02 3 1  ON 5
ci_07                 2.639675e-02 3 1  ON 6
ci_08                -3.804341e-03 3 1  ON 7
ci_09                -7.914244e-03 3 1  ON 8
ci_10                -7.518187e-03 3 1  ON 9
ci_11                 1.369082e-02 3 1  ON 10
ci_12                 5.819278e-03 3 1  ON 11
ci_13                 1.294390e-02 3 1  ON 12
ci_14                 1.672384e-02 3 1  ON 13
ci_15                 5.397452e-03 3 1  ON 14
ci_16                 5.184276e-03 3 1  ON 15
ci_17                -8.165685e-03 3 1  ON 16
ci_18                -6.876466e-03 3 1  ON 17
ci_19                 1.012181e-02 3 1  ON 18
ci_20                 6.176916e-03 3 1  ON 19
ci_21                 8.762581e-03 3 1  ON 20
ci_22                 8.611623e-03 3 1  ON 21
ci_23                 4.414511e-03 3 1  ON 22
ci_24                 5.343894e-03 3 1  ON 23
ci_25                 2.925872e-03 3 1  ON 24
ci_26                 1.882838e-03 3 1  ON 25
ci_27                 3.880306e-03 3 1  ON 26
ci_28                 5.165421e-04 3 1  ON 27
ci_29                 1.244002e-03 3 1  ON 28
ci_30                 7.631723e-04 3 1  ON 29
ci_31                -4.942063e-04 3 1  ON 30
ci_32                -5.216022e-04 3 1  ON 31
ci_33                -5.793602e-04 3 1  ON 32
ci_34                 1.883141e-03 3 1  ON 33
ci_35                 2.648598e-03 3 1  ON 34
ci_36                -5.277778e-04 3 1  ON 35
ci_37                -2.715957e-04 3 1  ON 36
ci_38                 3.827121e-04 3 1  ON 37
ci_39                 3.153727e-04 3 1  ON 38
ci_40                -1.269797e-03 3 1  ON 39
ci_41                -2.167808e-04 3 1  ON 40
ci_42                 9.369285e-05 3 1  ON 41
ci_43                 1.439248e-04 3 1  ON 42
ci_44                -5.272522e-04 3 1  ON 43
ci_45                -2.875650e-04 3 1  ON 44
ci_46                -6.902664e-05 3 1  ON 45
ci_47                 2.032487e-03 3 1  ON 46
ci_48                 2.245403e-03 3 1  ON 47
ci_49                -1.100877e-03 3 1  ON 48
ci_50                -6.562778e-04 3 1  ON 49
ci_51                 1.248821e-06 3 1  ON 50
ci_52                -4.304311e-05 3 1  ON 51
ci_53                -5.321784e-04 3 1  ON 52
ci_54                -6.819902e-04 3 1  ON 53
ci_55                 6.056861e-04 3 1  ON 54
ci_56                 1.133129e-03 3 1  ON 55
ci_57                 2.551395e-03 3 1  ON 56
ci_58                -3.319316e-04 3 1  ON 57
ci_59                -4.654999e-04 3 1  ON 58
ci_60                 3.297030e-03 3 1  ON 59
ci_61                -9.799892e-04 3 1  ON 60
ci_62                -4.909341e-04 3 1  ON 61
ci_63                -1.169924e-03 3 1  ON 62
ci_64                 3.455819e-04 3 1  ON 63
ci_65                -8.450169e-04 3 1  ON 64
ci_66                -9.343743e-04 3 1  ON 65
ci_67                -5.092191e-04 3 1  ON 66
ci_68                -2.185734e-03 3 1  ON 67
ci_69                -5.839078e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.9177
    reference variance = 0.327539
====================================================
  Execution time = 4.2874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8872e-01
  Total weights = 1.9643e+06
  Execution time = 5.9599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0011144
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475690390182
                                         uncertainty =       0.003143735468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475690390182
                                         uncertainty =       0.003143735468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487749649
  error estimate for blocks of size 2^( 2) =       0.000509586506
  error estimate for blocks of size 2^( 3) =       0.000530240730
  error estimate for blocks of size 2^( 4) =       0.000546674971
  error estimate for blocks of size 2^( 5) =       0.000557482217
  error estimate for blocks of size 2^( 6) =       0.000561880081
  error estimate for blocks of size 2^( 7) =       0.000566986064

      target function =      -0.508520747796
              le_mean =     -22.819102882350
             les_mean =     521.616208950448
             stat err =       0.000558255833
             autocorr =       1.310003962862
   target nu stat err =       0.000558255833
   target dn stat err =       0.329983501754
      target stat err =       0.080944023346
              std dev =       0.689782168055
             le_variance =       0.475799439367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473473424217
                                         uncertainty =       0.003115356092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473473424217
                                         uncertainty =       0.003115356092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486614517
  error estimate for blocks of size 2^( 2) =       0.000508503135
  error estimate for blocks of size 2^( 3) =       0.000529210373
  error estimate for blocks of size 2^( 4) =       0.000545707807
  error estimate for blocks of size 2^( 5) =       0.000556617968
  error estimate for blocks of size 2^( 6) =       0.000560937400
  error estimate for blocks of size 2^( 7) =       0.000566015394

      target function =      -0.651991653607
              le_mean =     -22.818933568707
             les_mean =     521.193115542949
             stat err =       0.000557319642
             autocorr =       1.311712259038
   target nu stat err =       0.000557319642
   target dn stat err =       0.003720141135
      target stat err =       0.001500946575
              std dev =       0.688176849509
             le_variance =       0.473587376201

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00110489
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478340255015
                                         uncertainty =       0.004119437189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478340255015
                                         uncertainty =       0.004119437189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489108251
  error estimate for blocks of size 2^( 2) =       0.000510828480
  error estimate for blocks of size 2^( 3) =       0.000531457335
  error estimate for blocks of size 2^( 4) =       0.000547864285
  error estimate for blocks of size 2^( 5) =       0.000558650299
  error estimate for blocks of size 2^( 6) =       0.000562919427
  error estimate for blocks of size 2^( 7) =       0.000567891186

      target function =      -0.593211209959
              le_mean =     -22.819054646486
             les_mean =     521.356171816144
             stat err =       0.000559331299
             autocorr =       1.307760652508
   target nu stat err =       0.000559331299
   target dn stat err =       0.111412435869
      target stat err =       0.036407911024
              std dev =       0.691703522398
             le_variance =       0.478453762898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473488336672
                                         uncertainty =       0.003116473125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473488336672
                                         uncertainty =       0.003116473125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486622063
  error estimate for blocks of size 2^( 2) =       0.000508503087
  error estimate for blocks of size 2^( 3) =       0.000529203216
  error estimate for blocks of size 2^( 4) =       0.000545695651
  error estimate for blocks of size 2^( 5) =       0.000556594778
  error estimate for blocks of size 2^( 6) =       0.000560931461
  error estimate for blocks of size 2^( 7) =       0.000565996066

      target function =      -0.651545560584
              le_mean =     -22.818948847802
             les_mean =     521.194956888902
             stat err =       0.000557304489
             autocorr =       1.311600251303
   target nu stat err =       0.000557304489
   target dn stat err =       0.003882532504
      target stat err =       0.001561177339
              std dev =       0.688187521358
             le_variance =       0.473602064554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.508520747796        initial
     9.0949e-04     9.0949e-03             3.3186e-03        -0.651991653607  <--
     3.6380e-03     3.6380e-02             3.0937e-03        -0.593211209959
     1.4552e-02     1.4552e-01             2.4341e-03        -0.651545560584

*****************************************************************************
Applying the update for shift_i =   9.0949e-04     and shift_s =   9.0949e-03
*****************************************************************************

  Execution time = 7.2855e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_01                 1.086502e-01 3 1  ON 0
ci_02                -2.201067e-02 3 1  ON 1
ci_03                -2.296569e-02 3 1  ON 2
ci_04                 2.184748e-02 3 1  ON 3
ci_05                -2.270664e-02 3 1  ON 4
ci_06                -1.993021e-02 3 1  ON 5
ci_07                 2.642061e-02 3 1  ON 6
ci_08                -3.844656e-03 3 1  ON 7
ci_09                -7.954478e-03 3 1  ON 8
ci_10                -7.591725e-03 3 1  ON 9
ci_11                 1.375576e-02 3 1  ON 10
ci_12                 5.772089e-03 3 1  ON 11
ci_13                 1.281552e-02 3 1  ON 12
ci_14                 1.687339e-02 3 1  ON 13
ci_15                 5.434296e-03 3 1  ON 14
ci_16                 5.100070e-03 3 1  ON 15
ci_17                -8.223690e-03 3 1  ON 16
ci_18                -6.938136e-03 3 1  ON 17
ci_19                 1.016775e-02 3 1  ON 18
ci_20                 6.052911e-03 3 1  ON 19
ci_21                 8.855658e-03 3 1  ON 20
ci_22                 8.454646e-03 3 1  ON 21
ci_23                 4.430350e-03 3 1  ON 22
ci_24                 5.404179e-03 3 1  ON 23
ci_25                 2.890682e-03 3 1  ON 24
ci_26                 1.823417e-03 3 1  ON 25
ci_27                 4.039246e-03 3 1  ON 26
ci_28                 3.988407e-04 3 1  ON 27
ci_29                 1.249269e-03 3 1  ON 28
ci_30                 7.006446e-04 3 1  ON 29
ci_31                -6.311180e-04 3 1  ON 30
ci_32                -5.440441e-04 3 1  ON 31
ci_33                -5.360164e-04 3 1  ON 32
ci_34                 2.036011e-03 3 1  ON 33
ci_35                 2.873526e-03 3 1  ON 34
ci_36                -5.995176e-04 3 1  ON 35
ci_37                -2.258362e-04 3 1  ON 36
ci_38                 3.473225e-04 3 1  ON 37
ci_39                 3.169167e-04 3 1  ON 38
ci_40                -1.315465e-03 3 1  ON 39
ci_41                -1.749931e-04 3 1  ON 40
ci_42                 1.711016e-04 3 1  ON 41
ci_43                 2.682548e-04 3 1  ON 42
ci_44                -5.046742e-04 3 1  ON 43
ci_45                -2.913810e-04 3 1  ON 44
ci_46                -2.964295e-05 3 1  ON 45
ci_47                 2.108281e-03 3 1  ON 46
ci_48                 2.205305e-03 3 1  ON 47
ci_49                -1.077716e-03 3 1  ON 48
ci_50                -6.745626e-04 3 1  ON 49
ci_51                 1.473110e-05 3 1  ON 50
ci_52                -7.545167e-05 3 1  ON 51
ci_53                -4.875460e-04 3 1  ON 52
ci_54                -6.479568e-04 3 1  ON 53
ci_55                 6.277498e-04 3 1  ON 54
ci_56                 1.080918e-03 3 1  ON 55
ci_57                 2.567362e-03 3 1  ON 56
ci_58                -3.024469e-04 3 1  ON 57
ci_59                -4.588969e-04 3 1  ON 58
ci_60                 3.479556e-03 3 1  ON 59
ci_61                -1.198961e-03 3 1  ON 60
ci_62                -4.659708e-04 3 1  ON 61
ci_63                -1.202292e-03 3 1  ON 62
ci_64                 4.002177e-04 3 1  ON 63
ci_65                -8.925825e-04 3 1  ON 64
ci_66                -9.846291e-04 3 1  ON 65
ci_67                -5.072429e-04 3 1  ON 66
ci_68                -2.260871e-03 3 1  ON 67
ci_69                -6.113437e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2470e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8749
    reference variance = 0.44627
====================================================
  Execution time = 4.2669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9786e-01
  Total weights = 1.964029568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472200239273
                                         uncertainty =       0.002438953298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472200239273
                                         uncertainty =       0.002438953298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485938444
  error estimate for blocks of size 2^( 2) =       0.000507710790
  error estimate for blocks of size 2^( 3) =       0.000528476688
  error estimate for blocks of size 2^( 4) =       0.000543638239
  error estimate for blocks of size 2^( 5) =       0.000554796330
  error estimate for blocks of size 2^( 6) =       0.000560423219
  error estimate for blocks of size 2^( 7) =       0.000564748588

      target function =      -0.648407480611
              le_mean =     -22.817867306634
             les_mean =     521.152926021584
             stat err =       0.000555901594
             autocorr =       1.308679567285
   target nu stat err =       0.000555901594
   target dn stat err =       0.008204529840
      target stat err =       0.003205070958
              std dev =       0.687220737476
             le_variance =       0.472272342017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281786730663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-04, overlap shift 2.2737e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648422875523       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648787937003       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648835840662       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648842584689       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648846005903       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648848055089       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648849131399       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648848694674       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648848345146       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648848184923       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648848193293       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.648848126077       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-04 is 4.999479e-03

solving harmonic davidson linear method for identity shift 9.0949e-04, overlap shift 9.0949e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648422875523       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648782099873       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648828883517       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648835404676       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648838690551       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648840635350       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648841638944       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648841213097       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648840878940       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648840727497       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648840736402       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.648840674453       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-04 is 4.904567e-03

solving harmonic davidson linear method for identity shift 3.6380e-03, overlap shift 3.6380e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648422875523       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.648760504500       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.648803257391       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.648808998988       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.648811821425       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.648813419796       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.648814190837       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.648813807006       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.648813524905       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.648813402564       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.648813412854       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.648813367153       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-03 is 4.558844e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.637146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0365e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_01                 1.054636e-01 3 1  ON 0
ci_02                -2.062435e-02 3 1  ON 1
ci_03                -2.411263e-02 3 1  ON 2
ci_04                 2.298774e-02 3 1  ON 3
ci_05                -2.147345e-02 3 1  ON 4
ci_06                -2.483478e-02 3 1  ON 5
ci_07                 2.777664e-02 3 1  ON 6
ci_08                -4.409770e-03 3 1  ON 7
ci_09                -6.504313e-03 3 1  ON 8
ci_10                -8.373261e-03 3 1  ON 9
ci_11                 1.395454e-02 3 1  ON 10
ci_12                 7.926550e-03 3 1  ON 11
ci_13                 1.167528e-02 3 1  ON 12
ci_14                 1.413481e-02 3 1  ON 13
ci_15                 7.303124e-03 3 1  ON 14
ci_16                 5.919637e-03 3 1  ON 15
ci_17                -7.668542e-03 3 1  ON 16
ci_18                -4.092284e-03 3 1  ON 17
ci_19                 9.993035e-03 3 1  ON 18
ci_20                 8.795330e-03 3 1  ON 19
ci_21                 8.997867e-03 3 1  ON 20
ci_22                 8.248620e-03 3 1  ON 21
ci_23                 4.492890e-03 3 1  ON 22
ci_24                 4.073264e-03 3 1  ON 23
ci_25                 3.777721e-03 3 1  ON 24
ci_26                 2.778198e-03 3 1  ON 25
ci_27                 6.306656e-03 3 1  ON 26
ci_28                 2.419880e-03 3 1  ON 27
ci_29                 4.808194e-04 3 1  ON 28
ci_30                -1.953965e-03 3 1  ON 29
ci_31                -1.497102e-03 3 1  ON 30
ci_32                 1.862469e-03 3 1  ON 31
ci_33                 1.602891e-04 3 1  ON 32
ci_34                 2.210619e-03 3 1  ON 33
ci_35                 4.132568e-03 3 1  ON 34
ci_36                -2.172104e-03 3 1  ON 35
ci_37                -4.695125e-04 3 1  ON 36
ci_38                -1.212631e-03 3 1  ON 37
ci_39                -1.068771e-03 3 1  ON 38
ci_40                -6.040916e-04 3 1  ON 39
ci_41                -4.122177e-04 3 1  ON 40
ci_42                -5.934021e-04 3 1  ON 41
ci_43                -3.829897e-03 3 1  ON 42
ci_44                -3.288851e-03 3 1  ON 43
ci_45                -6.429303e-04 3 1  ON 44
ci_46                -3.586224e-04 3 1  ON 45
ci_47                 1.328505e-03 3 1  ON 46
ci_48                 9.699220e-04 3 1  ON 47
ci_49                -1.571530e-03 3 1  ON 48
ci_50                -6.565919e-04 3 1  ON 49
ci_51                 1.262292e-04 3 1  ON 50
ci_52                 8.571337e-04 3 1  ON 51
ci_53                 3.237902e-04 3 1  ON 52
ci_54                -2.651254e-03 3 1  ON 53
ci_55                -1.212546e-03 3 1  ON 54
ci_56                 2.237356e-03 3 1  ON 55
ci_57                 1.309671e-03 3 1  ON 56
ci_58                -1.505050e-03 3 1  ON 57
ci_59                 2.056104e-04 3 1  ON 58
ci_60                 3.638630e-03 3 1  ON 59
ci_61                 1.299614e-03 3 1  ON 60
ci_62                -7.113177e-05 3 1  ON 61
ci_63                -1.022493e-03 3 1  ON 62
ci_64                 1.547623e-03 3 1  ON 63
ci_65                -1.308196e-03 3 1  ON 64
ci_66                -4.769024e-04 3 1  ON 65
ci_67                -2.734305e-04 3 1  ON 66
ci_68                -5.702060e-04 3 1  ON 67
ci_69                 1.073724e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8165
    reference variance = 0.293827
====================================================
  Execution time = 4.1613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8574e-01
  Total weights = 1.9639e+06
  Execution time = 5.9616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0346941
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.686123201493
                                         uncertainty =       0.212863871763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.686123201493
                                         uncertainty =       0.212863871763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000585493558
  error estimate for blocks of size 2^( 2) =       0.000603818350
  error estimate for blocks of size 2^( 3) =       0.000621696173
  error estimate for blocks of size 2^( 4) =       0.000634300647
  error estimate for blocks of size 2^( 5) =       0.000641766617
  error estimate for blocks of size 2^( 6) =       0.000643454673
  error estimate for blocks of size 2^( 7) =       0.000646640049

      target function =      -0.004802433811
              le_mean =     -22.818559303347
             les_mean =     633.929676405458
             stat err =       0.000641540497
             autocorr =       1.200615400316
   target nu stat err =       0.000641540497
   target dn stat err =     112.645650890422
      target stat err =       0.004728269932
              std dev =       0.828012930730
             le_variance =       0.685605413456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468747728456
                                         uncertainty =       0.002182244930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468747728456
                                         uncertainty =       0.002182244930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484075331
  error estimate for blocks of size 2^( 2) =       0.000505831565
  error estimate for blocks of size 2^( 3) =       0.000527275857
  error estimate for blocks of size 2^( 4) =       0.000542825145
  error estimate for blocks of size 2^( 5) =       0.000551677067
  error estimate for blocks of size 2^( 6) =       0.000553691498
  error estimate for blocks of size 2^( 7) =       0.000557428113

      target function =      -0.653279100050
              le_mean =     -22.818661997556
             les_mean =     521.177283674881
             stat err =       0.000551405456
             autocorr =       1.297526437746
   target nu stat err =       0.000551405456
   target dn stat err =       0.003394628376
      target stat err =       0.001380563023
              std dev =       0.684585898252
             le_variance =       0.468657852085

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0338293
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474785160581
                                         uncertainty =       0.002503347102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474785160581
                                         uncertainty =       0.002503347102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487180905
  error estimate for blocks of size 2^( 2) =       0.000508888425
  error estimate for blocks of size 2^( 3) =       0.000530293735
  error estimate for blocks of size 2^( 4) =       0.000545761772
  error estimate for blocks of size 2^( 5) =       0.000554597453
  error estimate for blocks of size 2^( 6) =       0.000556761306
  error estimate for blocks of size 2^( 7) =       0.000560643507

      target function =      -0.607311667362
              le_mean =     -22.818970402601
             les_mean =     521.315734233144
             stat err =       0.000554441010
             autocorr =       1.295180137163
   target nu stat err =       0.000554441010
   target dn stat err =       0.043758158336
      target stat err =       0.014941752917
              std dev =       0.688977843248
             le_variance =       0.474690468487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468698730390
                                         uncertainty =       0.002180839878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468698730390
                                         uncertainty =       0.002180839878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484050083
  error estimate for blocks of size 2^( 2) =       0.000505805905
  error estimate for blocks of size 2^( 3) =       0.000527238548
  error estimate for blocks of size 2^( 4) =       0.000542780161
  error estimate for blocks of size 2^( 5) =       0.000551632451
  error estimate for blocks of size 2^( 6) =       0.000553644680
  error estimate for blocks of size 2^( 7) =       0.000557385667

      target function =      -0.647790403752
              le_mean =     -22.818657598138
             les_mean =     521.190990206467
             stat err =       0.000551360740
             autocorr =       1.297451342639
   target nu stat err =       0.000551360740
   target dn stat err =       0.014264887690
      target stat err =       0.005545966764
              std dev =       0.684550191684
             le_variance =       0.468608964935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.004802433811        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.5615
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_01                 1.086502e-01 3 1  ON 0
ci_02                -2.201067e-02 3 1  ON 1
ci_03                -2.296569e-02 3 1  ON 2
ci_04                 2.184748e-02 3 1  ON 3
ci_05                -2.270664e-02 3 1  ON 4
ci_06                -1.993021e-02 3 1  ON 5
ci_07                 2.642061e-02 3 1  ON 6
ci_08                -3.844656e-03 3 1  ON 7
ci_09                -7.954478e-03 3 1  ON 8
ci_10                -7.591725e-03 3 1  ON 9
ci_11                 1.375576e-02 3 1  ON 10
ci_12                 5.772089e-03 3 1  ON 11
ci_13                 1.281552e-02 3 1  ON 12
ci_14                 1.687339e-02 3 1  ON 13
ci_15                 5.434296e-03 3 1  ON 14
ci_16                 5.100070e-03 3 1  ON 15
ci_17                -8.223690e-03 3 1  ON 16
ci_18                -6.938136e-03 3 1  ON 17
ci_19                 1.016775e-02 3 1  ON 18
ci_20                 6.052911e-03 3 1  ON 19
ci_21                 8.855658e-03 3 1  ON 20
ci_22                 8.454646e-03 3 1  ON 21
ci_23                 4.430350e-03 3 1  ON 22
ci_24                 5.404179e-03 3 1  ON 23
ci_25                 2.890682e-03 3 1  ON 24
ci_26                 1.823417e-03 3 1  ON 25
ci_27                 4.039246e-03 3 1  ON 26
ci_28                 3.988407e-04 3 1  ON 27
ci_29                 1.249269e-03 3 1  ON 28
ci_30                 7.006446e-04 3 1  ON 29
ci_31                -6.311180e-04 3 1  ON 30
ci_32                -5.440441e-04 3 1  ON 31
ci_33                -5.360164e-04 3 1  ON 32
ci_34                 2.036011e-03 3 1  ON 33
ci_35                 2.873526e-03 3 1  ON 34
ci_36                -5.995176e-04 3 1  ON 35
ci_37                -2.258362e-04 3 1  ON 36
ci_38                 3.473225e-04 3 1  ON 37
ci_39                 3.169167e-04 3 1  ON 38
ci_40                -1.315465e-03 3 1  ON 39
ci_41                -1.749931e-04 3 1  ON 40
ci_42                 1.711016e-04 3 1  ON 41
ci_43                 2.682548e-04 3 1  ON 42
ci_44                -5.046742e-04 3 1  ON 43
ci_45                -2.913810e-04 3 1  ON 44
ci_46                -2.964295e-05 3 1  ON 45
ci_47                 2.108281e-03 3 1  ON 46
ci_48                 2.205305e-03 3 1  ON 47
ci_49                -1.077716e-03 3 1  ON 48
ci_50                -6.745626e-04 3 1  ON 49
ci_51                 1.473110e-05 3 1  ON 50
ci_52                -7.545167e-05 3 1  ON 51
ci_53                -4.875460e-04 3 1  ON 52
ci_54                -6.479568e-04 3 1  ON 53
ci_55                 6.277498e-04 3 1  ON 54
ci_56                 1.080918e-03 3 1  ON 55
ci_57                 2.567362e-03 3 1  ON 56
ci_58                -3.024469e-04 3 1  ON 57
ci_59                -4.588969e-04 3 1  ON 58
ci_60                 3.479556e-03 3 1  ON 59
ci_61                -1.198961e-03 3 1  ON 60
ci_62                -4.659708e-04 3 1  ON 61
ci_63                -1.202292e-03 3 1  ON 62
ci_64                 4.002177e-04 3 1  ON 63
ci_65                -8.925825e-04 3 1  ON 64
ci_66                -9.846291e-04 3 1  ON 65
ci_67                -5.072429e-04 3 1  ON 66
ci_68                -2.260871e-03 3 1  ON 67
ci_69                -6.113437e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2194e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8277
    reference variance = 0.421195
====================================================
  Execution time = 4.2705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8520e-01
  Total weights = 1.964287116e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469784560936
                                         uncertainty =       0.002479544385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469784560936
                                         uncertainty =       0.002479544385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484687924
  error estimate for blocks of size 2^( 2) =       0.000506032529
  error estimate for blocks of size 2^( 3) =       0.000526542354
  error estimate for blocks of size 2^( 4) =       0.000542238835
  error estimate for blocks of size 2^( 5) =       0.000550643606
  error estimate for blocks of size 2^( 6) =       0.000555774785
  error estimate for blocks of size 2^( 7) =       0.000556832912

      target function =      -0.653720649679
              le_mean =     -22.819238911231
             les_mean =     521.202860726491
             stat err =       0.000551372535
             autocorr =       1.294094106054
   target nu stat err =       0.000551372535
   target dn stat err =       0.003140472421
      target stat err =       0.001285803815
              std dev =       0.685452235505
             le_variance =       0.469844767159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281923891123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653722737609       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653916584997       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653948174837       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653955805337       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653957162773       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653957240324       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653956823451       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653956572694       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653956758821       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653956697901       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 3.326033e-03

solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653722737609       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653890938854       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653916869756       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653922800698       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653923766813       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653923762703       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653923443614       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653923275951       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653923398005       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653923355915       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 2.807399e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653722737609       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653832724228       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653847618640       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653850620500       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653851017237       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653850953521       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653850807057       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653850748458       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653850791448       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 1.725988e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.645323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0410e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_01                 1.105180e-01 3 1  ON 0
ci_02                -2.481807e-02 3 1  ON 1
ci_03                -2.317797e-02 3 1  ON 2
ci_04                 2.199429e-02 3 1  ON 3
ci_05                -2.034699e-02 3 1  ON 4
ci_06                -2.028972e-02 3 1  ON 5
ci_07                 2.576061e-02 3 1  ON 6
ci_08                -3.810004e-03 3 1  ON 7
ci_09                -8.115214e-03 3 1  ON 8
ci_10                -7.825822e-03 3 1  ON 9
ci_11                 1.296495e-02 3 1  ON 10
ci_12                 7.572605e-03 3 1  ON 11
ci_13                 1.269738e-02 3 1  ON 12
ci_14                 1.591329e-02 3 1  ON 13
ci_15                 5.096617e-03 3 1  ON 14
ci_16                 5.928530e-03 3 1  ON 15
ci_17                -5.682013e-03 3 1  ON 16
ci_18                -6.947214e-03 3 1  ON 17
ci_19                 8.684048e-03 3 1  ON 18
ci_20                 6.680406e-03 3 1  ON 19
ci_21                 7.896090e-03 3 1  ON 20
ci_22                 8.670566e-03 3 1  ON 21
ci_23                 4.976101e-03 3 1  ON 22
ci_24                 4.976904e-03 3 1  ON 23
ci_25                 3.712494e-03 3 1  ON 24
ci_26                 3.223639e-03 3 1  ON 25
ci_27                 2.858909e-03 3 1  ON 26
ci_28                 1.858178e-03 3 1  ON 27
ci_29                 1.191106e-03 3 1  ON 28
ci_30                 4.396624e-04 3 1  ON 29
ci_31                -5.476503e-04 3 1  ON 30
ci_32                -2.558075e-05 3 1  ON 31
ci_33                -1.548387e-03 3 1  ON 32
ci_34                 2.926858e-04 3 1  ON 33
ci_35                 6.982385e-04 3 1  ON 34
ci_36                 4.888010e-05 3 1  ON 35
ci_37                -1.125780e-03 3 1  ON 36
ci_38                 1.210790e-04 3 1  ON 37
ci_39                -3.006419e-05 3 1  ON 38
ci_40                -7.217682e-04 3 1  ON 39
ci_41                 1.172504e-05 3 1  ON 40
ci_42                -3.572251e-04 3 1  ON 41
ci_43                -1.219289e-03 3 1  ON 42
ci_44                -1.680629e-03 3 1  ON 43
ci_45                -8.840709e-04 3 1  ON 44
ci_46                -2.887140e-04 3 1  ON 45
ci_47                 1.664410e-03 3 1  ON 46
ci_48                 1.973312e-03 3 1  ON 47
ci_49                -7.939454e-04 3 1  ON 48
ci_50                -6.220162e-04 3 1  ON 49
ci_51                 5.502391e-04 3 1  ON 50
ci_52                 4.944541e-04 3 1  ON 51
ci_53                -5.907750e-04 3 1  ON 52
ci_54                -2.953974e-04 3 1  ON 53
ci_55                -2.278170e-04 3 1  ON 54
ci_56                 1.881238e-03 3 1  ON 55
ci_57                 1.857410e-03 3 1  ON 56
ci_58                -1.676542e-03 3 1  ON 57
ci_59                -5.150959e-04 3 1  ON 58
ci_60                 3.371082e-03 3 1  ON 59
ci_61                -4.253927e-04 3 1  ON 60
ci_62                -6.103426e-04 3 1  ON 61
ci_63                -3.112700e-04 3 1  ON 62
ci_64                -3.170261e-04 3 1  ON 63
ci_65                -6.168411e-05 3 1  ON 64
ci_66                -5.604148e-05 3 1  ON 65
ci_67                -8.962097e-04 3 1  ON 66
ci_68                -1.018610e-03 3 1  ON 67
ci_69                -1.134331e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.7468
    reference variance = 0.42273
====================================================
  Execution time = 4.3184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8861e-01
  Total weights = 1.9644e+06
  Execution time = 5.9741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00309053
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528919300485
                                         uncertainty =       0.053679657953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528919300485
                                         uncertainty =       0.053679657953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514220097
  error estimate for blocks of size 2^( 2) =       0.000534521415
  error estimate for blocks of size 2^( 3) =       0.000553976971
  error estimate for blocks of size 2^( 4) =       0.000569705355
  error estimate for blocks of size 2^( 5) =       0.000579769953
  error estimate for blocks of size 2^( 6) =       0.000585417203
  error estimate for blocks of size 2^( 7) =       0.000590215440

      target function =      -0.105933957473
              le_mean =     -22.819140227900
             les_mean =     526.111370160462
             stat err =       0.000581276988
             autocorr =       1.277815546624
   target nu stat err =       0.000581276988
   target dn stat err =       4.888442798278
      target stat err =       0.078863139886
              std dev =       0.727217035498
             le_variance =       0.528844616719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474551440225
                                         uncertainty =       0.002846996591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474551440225
                                         uncertainty =       0.002846996591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487066458
  error estimate for blocks of size 2^( 2) =       0.000508853433
  error estimate for blocks of size 2^( 3) =       0.000529314572
  error estimate for blocks of size 2^( 4) =       0.000545692006
  error estimate for blocks of size 2^( 5) =       0.000555924751
  error estimate for blocks of size 2^( 6) =       0.000562109989
  error estimate for blocks of size 2^( 7) =       0.000566846566

      target function =      -0.647200299161
              le_mean =     -22.818862681038
             les_mean =     521.202025015355
             stat err =       0.000557643328
             autocorr =       1.310800427966
   target nu stat err =       0.000557643328
   target dn stat err =       0.012612022401
      target stat err =       0.004897978537
              std dev =       0.688815991273
             le_variance =       0.474467469834

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00313441
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475895182005
                                         uncertainty =       0.002855051467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475895182005
                                         uncertainty =       0.002855051467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487755792
  error estimate for blocks of size 2^( 2) =       0.000509521698
  error estimate for blocks of size 2^( 3) =       0.000529962928
  error estimate for blocks of size 2^( 4) =       0.000546263913
  error estimate for blocks of size 2^( 5) =       0.000556488462
  error estimate for blocks of size 2^( 6) =       0.000562643598
  error estimate for blocks of size 2^( 7) =       0.000567246621

      target function =      -0.625614908022
              le_mean =     -22.818929742729
             les_mean =     521.261938956435
             stat err =       0.000558160649
             autocorr =       1.309524290871
   target nu stat err =       0.000558160649
   target dn stat err =       0.039815452402
      target stat err =       0.014426163161
              std dev =       0.689790856229
             le_variance =       0.475811425338

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.113119
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474688721493
                                         uncertainty =       0.002903605651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474688721493
                                         uncertainty =       0.002903605651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487136335
  error estimate for blocks of size 2^( 2) =       0.000508929305
  error estimate for blocks of size 2^( 3) =       0.000529390217
  error estimate for blocks of size 2^( 4) =       0.000545760377
  error estimate for blocks of size 2^( 5) =       0.000555986026
  error estimate for blocks of size 2^( 6) =       0.000562184262
  error estimate for blocks of size 2^( 7) =       0.000566942961

      target function =      -0.649999123304
              le_mean =     -22.818878786897
             les_mean =     521.195647452641
             stat err =       0.000557718407
             autocorr =       1.310777286086
   target nu stat err =       0.000557718407
   target dn stat err =       0.006441824241
      target stat err =       0.002539714774
              std dev =       0.688914811822
             le_variance =       0.474603617948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.105933957473        initial
     2.2737e-03     2.2737e-02             3.3260e-03        -0.647200299161
     9.0949e-03     9.0949e-02             2.8074e-03        -0.625614908022
     3.6380e-02     3.6380e-01             1.7260e-03        -0.649999123304  <--

*****************************************************************************
Applying the update for shift_i =   3.6380e-02     and shift_s =   3.6380e-01
*****************************************************************************

  Execution time = 7.4465e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_01                 1.096363e-01 3 1  ON 0
ci_02                -2.373666e-02 3 1  ON 1
ci_03                -2.307669e-02 3 1  ON 2
ci_04                 2.194722e-02 3 1  ON 3
ci_05                -2.127410e-02 3 1  ON 4
ci_06                -2.017416e-02 3 1  ON 5
ci_07                 2.600663e-02 3 1  ON 6
ci_08                -3.813600e-03 3 1  ON 7
ci_09                -8.044713e-03 3 1  ON 8
ci_10                -7.743515e-03 3 1  ON 9
ci_11                 1.326592e-02 3 1  ON 10
ci_12                 6.941310e-03 3 1  ON 11
ci_13                 1.276923e-02 3 1  ON 12
ci_14                 1.635342e-02 3 1  ON 13
ci_15                 5.213374e-03 3 1  ON 14
ci_16                 5.622805e-03 3 1  ON 15
ci_17                -6.653572e-03 3 1  ON 16
ci_18                -6.949171e-03 3 1  ON 17
ci_19                 9.188960e-03 3 1  ON 18
ci_20                 6.455595e-03 3 1  ON 19
ci_21                 8.295390e-03 3 1  ON 20
ci_22                 8.574996e-03 3 1  ON 21
ci_23                 4.797343e-03 3 1  ON 22
ci_24                 5.155711e-03 3 1  ON 23
ci_25                 3.431804e-03 3 1  ON 24
ci_26                 2.700492e-03 3 1  ON 25
ci_27                 3.294570e-03 3 1  ON 26
ci_28                 1.330364e-03 3 1  ON 27
ci_29                 1.197345e-03 3 1  ON 28
ci_30                 5.673510e-04 3 1  ON 29
ci_31                -5.682931e-04 3 1  ON 30
ci_32                -2.036144e-04 3 1  ON 31
ci_33                -1.193126e-03 3 1  ON 32
ci_34                 9.286826e-04 3 1  ON 33
ci_35                 1.519386e-03 3 1  ON 34
ci_36                -1.748691e-04 3 1  ON 35
ci_37                -8.307980e-04 3 1  ON 36
ci_38                 1.985465e-04 3 1  ON 37
ci_39                 7.286413e-05 3 1  ON 38
ci_40                -9.123075e-04 3 1  ON 39
ci_41                -5.448674e-05 3 1  ON 40
ci_42                -1.851014e-04 3 1  ON 41
ci_43                -6.885617e-04 3 1  ON 42
ci_44                -1.244830e-03 3 1  ON 43
ci_45                -6.903656e-04 3 1  ON 44
ci_46                -1.968487e-04 3 1  ON 45
ci_47                 1.848207e-03 3 1  ON 46
ci_48                 2.072866e-03 3 1  ON 47
ci_49                -8.876136e-04 3 1  ON 48
ci_50                -6.420220e-04 3 1  ON 49
ci_51                 3.718729e-04 3 1  ON 50
ci_52                 2.960178e-04 3 1  ON 51
ci_53                -5.517357e-04 3 1  ON 52
ci_54                -4.290932e-04 3 1  ON 53
ci_55                 7.474662e-05 3 1  ON 54
ci_56                 1.612752e-03 3 1  ON 55
ci_57                 2.102784e-03 3 1  ON 56
ci_58                -1.190626e-03 3 1  ON 57
ci_59                -5.002288e-04 3 1  ON 58
ci_60                 3.430084e-03 3 1  ON 59
ci_61                -7.961071e-04 3 1  ON 60
ci_62                -5.602567e-04 3 1  ON 61
ci_63                -6.046363e-04 3 1  ON 62
ci_64                -6.376302e-05 3 1  ON 63
ci_65                -3.497931e-04 3 1  ON 64
ci_66                -3.781237e-04 3 1  ON 65
ci_67                -7.578558e-04 3 1  ON 66
ci_68                -1.467267e-03 3 1  ON 67
ci_69                -9.501606e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2489e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.7674
    reference variance = 0.276209
====================================================
  Execution time = 4.3085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7948e-01
  Total weights = 1.964320062e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465269884147
                                         uncertainty =       0.002179698969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465269884147
                                         uncertainty =       0.002179698969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482324245
  error estimate for blocks of size 2^( 2) =       0.000503943216
  error estimate for blocks of size 2^( 3) =       0.000525044315
  error estimate for blocks of size 2^( 4) =       0.000540591427
  error estimate for blocks of size 2^( 5) =       0.000549911083
  error estimate for blocks of size 2^( 6) =       0.000553141081
  error estimate for blocks of size 2^( 7) =       0.000556706956

      target function =      -0.655938495616
              le_mean =     -22.819042669324
             les_mean =     521.188188834469
             stat err =       0.000550087637
             autocorr =       1.300725280247
   target nu stat err =       0.000550087637
   target dn stat err =       0.003314795437
      target stat err =       0.001360968473
              std dev =       0.682109489415
             le_variance =       0.465273355550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281904266932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655940909715       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.656006342948       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.656014407898       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.656017655426       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.656018557348       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.656019190758       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.656019835923       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.656020010997       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.656020045105       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.656020026384       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 1.988906e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655940909715       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655983812281       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655988505583       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655990261157       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655990629948       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655990868210       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655991104567       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655991160911       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655991172756       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 1.296679e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.655940909715       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655958955685       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655960675908       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655961268159       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655961353090       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655961407924       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655961462981       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655961474765       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-01 is 5.414361e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.652996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0750e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_01                 1.106359e-01 3 1  ON 0
ci_02                -2.446860e-02 3 1  ON 1
ci_03                -2.359201e-02 3 1  ON 2
ci_04                 2.205498e-02 3 1  ON 3
ci_05                -2.113670e-02 3 1  ON 4
ci_06                -2.043131e-02 3 1  ON 5
ci_07                 2.565355e-02 3 1  ON 6
ci_08                -3.672005e-03 3 1  ON 7
ci_09                -8.393534e-03 3 1  ON 8
ci_10                -8.015275e-03 3 1  ON 9
ci_11                 1.321364e-02 3 1  ON 10
ci_12                 7.144510e-03 3 1  ON 11
ci_13                 1.306669e-02 3 1  ON 12
ci_14                 1.598527e-02 3 1  ON 13
ci_15                 6.151311e-03 3 1  ON 14
ci_16                 5.865418e-03 3 1  ON 15
ci_17                -6.977889e-03 3 1  ON 16
ci_18                -6.475923e-03 3 1  ON 17
ci_19                 9.252539e-03 3 1  ON 18
ci_20                 7.012410e-03 3 1  ON 19
ci_21                 8.573239e-03 3 1  ON 20
ci_22                 8.832224e-03 3 1  ON 21
ci_23                 4.475927e-03 3 1  ON 22
ci_24                 5.420117e-03 3 1  ON 23
ci_25                 2.874214e-03 3 1  ON 24
ci_26                 2.626776e-03 3 1  ON 25
ci_27                 2.270888e-03 3 1  ON 26
ci_28                 1.043395e-03 3 1  ON 27
ci_29                 1.251265e-03 3 1  ON 28
ci_30                 7.932074e-04 3 1  ON 29
ci_31                -8.142937e-04 3 1  ON 30
ci_32                 1.699248e-04 3 1  ON 31
ci_33                -1.063148e-03 3 1  ON 32
ci_34                 2.604452e-04 3 1  ON 33
ci_35                 9.552156e-04 3 1  ON 34
ci_36                -2.932759e-04 3 1  ON 35
ci_37                -7.882895e-04 3 1  ON 36
ci_38                 4.376336e-05 3 1  ON 37
ci_39                -3.271052e-04 3 1  ON 38
ci_40                -1.208592e-03 3 1  ON 39
ci_41                -1.142167e-04 3 1  ON 40
ci_42                -7.226207e-04 3 1  ON 41
ci_43                -1.046455e-03 3 1  ON 42
ci_44                -9.366556e-04 3 1  ON 43
ci_45                -1.096522e-03 3 1  ON 44
ci_46                -5.155704e-04 3 1  ON 45
ci_47                 1.931421e-03 3 1  ON 46
ci_48                 1.919239e-03 3 1  ON 47
ci_49                -5.227938e-04 3 1  ON 48
ci_50                -5.084832e-04 3 1  ON 49
ci_51                 8.136190e-05 3 1  ON 50
ci_52                 2.968002e-05 3 1  ON 51
ci_53                -4.525637e-04 3 1  ON 52
ci_54                -9.355292e-04 3 1  ON 53
ci_55                -1.221932e-03 3 1  ON 54
ci_56                 1.358962e-03 3 1  ON 55
ci_57                 2.167120e-03 3 1  ON 56
ci_58                -9.828997e-04 3 1  ON 57
ci_59                -9.629938e-04 3 1  ON 58
ci_60                 2.841846e-03 3 1  ON 59
ci_61                -1.379264e-04 3 1  ON 60
ci_62                -4.928038e-04 3 1  ON 61
ci_63                -1.690443e-04 3 1  ON 62
ci_64                -2.007346e-04 3 1  ON 63
ci_65                -1.707312e-04 3 1  ON 64
ci_66                -7.534297e-04 3 1  ON 65
ci_67                -2.214392e-04 3 1  ON 66
ci_68                -1.264948e-03 3 1  ON 67
ci_69                -4.328336e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8542
    reference variance = 0.51013
====================================================
  Execution time = 4.1858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8293e-01
  Total weights = 1.9640e+06
  Execution time = 5.9482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000782069
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466960015310
                                         uncertainty =       0.002284345667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466960015310
                                         uncertainty =       0.002284345667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483331873
  error estimate for blocks of size 2^( 2) =       0.000504938843
  error estimate for blocks of size 2^( 3) =       0.000525847774
  error estimate for blocks of size 2^( 4) =       0.000542379406
  error estimate for blocks of size 2^( 5) =       0.000552468916
  error estimate for blocks of size 2^( 6) =       0.000553501381
  error estimate for blocks of size 2^( 7) =       0.000556963420

      target function =      -0.298107428223
              le_mean =     -22.818625097752
             les_mean =     522.540737704728
             stat err =       0.000551328281
             autocorr =       1.301156902112
   target nu stat err =       0.000551328281
   target dn stat err =       1.354625139876
      target stat err =       0.133696304762
              std dev =       0.683534490075
             le_variance =       0.467219399121

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00734054
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466195961679
                                         uncertainty =       0.001992386672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466195961679
                                         uncertainty =       0.001992386672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482934450
  error estimate for blocks of size 2^( 2) =       0.000504532801
  error estimate for blocks of size 2^( 3) =       0.000525404036
  error estimate for blocks of size 2^( 4) =       0.000541856337
  error estimate for blocks of size 2^( 5) =       0.000551909022
  error estimate for blocks of size 2^( 6) =       0.000552854819
  error estimate for blocks of size 2^( 7) =       0.000556292967

      target function =      -0.653210019817
              le_mean =     -22.818598620818
             les_mean =     521.174525375012
             stat err =       0.000550728286
             autocorr =       1.300464175502
   target nu stat err =       0.000550728286
   target dn stat err =       0.003637950181
      target stat err =       0.001473458470
              std dev =       0.682972448239
             le_variance =       0.466451365054

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000788794
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466381462296
                                         uncertainty =       0.001987437812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466381462296
                                         uncertainty =       0.001987437812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483029626
  error estimate for blocks of size 2^( 2) =       0.000504603952
  error estimate for blocks of size 2^( 3) =       0.000525463995
  error estimate for blocks of size 2^( 4) =       0.000541910755
  error estimate for blocks of size 2^( 5) =       0.000551953546
  error estimate for blocks of size 2^( 6) =       0.000552879224
  error estimate for blocks of size 2^( 7) =       0.000556302255

      target function =      -0.646835981807
              le_mean =     -22.818603040849
             les_mean =     521.190989033649
             stat err =       0.000550761445
             autocorr =       1.300108280084
   target nu stat err =       0.000550761445
   target dn stat err =       0.010236137587
      target stat err =       0.003974226696
              std dev =       0.683107048221
             le_variance =       0.466635239330

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00464911
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466254006976
                                         uncertainty =       0.002054655097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466254006976
                                         uncertainty =       0.002054655097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482966783
  error estimate for blocks of size 2^( 2) =       0.000504595243
  error estimate for blocks of size 2^( 3) =       0.000525499469
  error estimate for blocks of size 2^( 4) =       0.000541990398
  error estimate for blocks of size 2^( 5) =       0.000552077503
  error estimate for blocks of size 2^( 6) =       0.000553049246
  error estimate for blocks of size 2^( 7) =       0.000556459686

      target function =      -0.629387197637
              le_mean =     -22.818596720885
             les_mean =     521.235437933591
             stat err =       0.000550894208
             autocorr =       1.301073668347
   target nu stat err =       0.000550894208
   target dn stat err =       0.053572872484
      target stat err =       0.019645955754
              std dev =       0.683018175282
             le_variance =       0.466513827766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.298107428223        initial
     9.0949e-03     9.0949e-02             1.9889e-03        -0.653210019817  <--
     3.6380e-02     3.6380e-01             1.2967e-03        -0.646835981807
     1.4552e-01     1.4552e+00             5.4144e-04        -0.629387197637

*****************************************************************************
Applying the update for shift_i =   9.0949e-03     and shift_s =   9.0949e-02
*****************************************************************************

  Execution time = 7.1723e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_01                 1.114917e-01 3 1  ON 0
ci_02                -2.489962e-02 3 1  ON 1
ci_03                -2.389726e-02 3 1  ON 2
ci_04                 2.210471e-02 3 1  ON 3
ci_05                -2.103994e-02 3 1  ON 4
ci_06                -2.053931e-02 3 1  ON 5
ci_07                 2.543193e-02 3 1  ON 6
ci_08                -3.611842e-03 3 1  ON 7
ci_09                -8.614574e-03 3 1  ON 8
ci_10                -8.185189e-03 3 1  ON 9
ci_11                 1.317535e-02 3 1  ON 10
ci_12                 7.253099e-03 3 1  ON 11
ci_13                 1.329587e-02 3 1  ON 12
ci_14                 1.570516e-02 3 1  ON 13
ci_15                 6.725160e-03 3 1  ON 14
ci_16                 6.012986e-03 3 1  ON 15
ci_17                -7.164705e-03 3 1  ON 16
ci_18                -6.205037e-03 3 1  ON 17
ci_19                 9.285687e-03 3 1  ON 18
ci_20                 7.318590e-03 3 1  ON 19
ci_21                 8.772924e-03 3 1  ON 20
ci_22                 9.006149e-03 3 1  ON 21
ci_23                 4.312722e-03 3 1  ON 22
ci_24                 5.614861e-03 3 1  ON 23
ci_25                 2.579116e-03 3 1  ON 24
ci_26                 2.586117e-03 3 1  ON 25
ci_27                 1.655017e-03 3 1  ON 26
ci_28                 8.817720e-04 3 1  ON 27
ci_29                 1.301242e-03 3 1  ON 28
ci_30                 9.558087e-04 3 1  ON 29
ci_31                -9.666911e-04 3 1  ON 30
ci_32                 3.620261e-04 3 1  ON 31
ci_33                -9.969593e-04 3 1  ON 32
ci_34                -1.348979e-04 3 1  ON 33
ci_35                 6.138065e-04 3 1  ON 34
ci_36                -3.384193e-04 3 1  ON 35
ci_37                -7.588061e-04 3 1  ON 36
ci_38                -2.716661e-05 3 1  ON 37
ci_39                -5.353687e-04 3 1  ON 38
ci_40                -1.352618e-03 3 1  ON 39
ci_41                -1.497208e-04 3 1  ON 40
ci_42                -1.004072e-03 3 1  ON 41
ci_43                -1.251883e-03 3 1  ON 42
ci_44                -7.596513e-04 3 1  ON 43
ci_45                -1.303287e-03 3 1  ON 44
ci_46                -6.734187e-04 3 1  ON 45
ci_47                 1.988622e-03 3 1  ON 46
ci_48                 1.843402e-03 3 1  ON 47
ci_49                -3.355444e-04 3 1  ON 48
ci_50                -4.439250e-04 3 1  ON 49
ci_51                -6.114064e-05 3 1  ON 50
ci_52                -1.084163e-04 3 1  ON 51
ci_53                -4.015106e-04 3 1  ON 52
ci_54                -1.198916e-03 3 1  ON 53
ci_55                -1.914159e-03 3 1  ON 54
ci_56                 1.221829e-03 3 1  ON 55
ci_57                 2.191574e-03 3 1  ON 56
ci_58                -8.599478e-04 3 1  ON 57
ci_59                -1.217557e-03 3 1  ON 58
ci_60                 2.293138e-03 3 1  ON 59
ci_61                 4.529387e-04 3 1  ON 60
ci_62                -4.683700e-04 3 1  ON 61
ci_63                 4.778891e-05 3 1  ON 62
ci_64                -2.790183e-04 3 1  ON 63
ci_65                -8.600782e-05 3 1  ON 64
ci_66                -9.607431e-04 3 1  ON 65
ci_67                 6.321599e-05 3 1  ON 66
ci_68                -1.160561e-03 3 1  ON 67
ci_69                -1.579286e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7661
    reference variance = 0.348622
====================================================
  Execution time = 4.3159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8805e-01
  Total weights = 1.964108513e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472523702693
                                         uncertainty =       0.002377602558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472523702693
                                         uncertainty =       0.002377602558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486060014
  error estimate for blocks of size 2^( 2) =       0.000508124154
  error estimate for blocks of size 2^( 3) =       0.000529413521
  error estimate for blocks of size 2^( 4) =       0.000545500402
  error estimate for blocks of size 2^( 5) =       0.000556326242
  error estimate for blocks of size 2^( 6) =       0.000562597491
  error estimate for blocks of size 2^( 7) =       0.000566110560

      target function =      -0.652507554280
              le_mean =     -22.818896780354
             les_mean =     521.190102739121
             stat err =       0.000557633674
             autocorr =       1.316188806808
   target nu stat err =       0.000557633674
   target dn stat err =       0.003645825854
      target stat err =       0.001474744423
              std dev =       0.687392663915
             le_variance =       0.472508674405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281889678035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652510445344       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652625436015       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652647717016       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652654465283       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652658168496       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652659912229       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652660511290       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652660194916       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652660587549       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652660570404       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652660487391       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652660359900       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 3.406011e-03

solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652510445344       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652610463873       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652628708342       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652633954375       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652636662786       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652637776256       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652638058215       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652637812080       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652638052093       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652638026362       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.652637972440       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.652637903704       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 2.562617e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652510445344       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.652576209754       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.652586624698       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.652589281907       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.652590477067       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.652590830903       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.652590848169       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.652590743803       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.652590821765       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.652590803566       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 1.285928e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.662551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0802e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_01                 1.118474e-01 3 1  ON 0
ci_02                -2.462856e-02 3 1  ON 1
ci_03                -2.448485e-02 3 1  ON 2
ci_04                 2.242728e-02 3 1  ON 3
ci_05                -2.114753e-02 3 1  ON 4
ci_06                -2.048708e-02 3 1  ON 5
ci_07                 2.592825e-02 3 1  ON 6
ci_08                -4.444505e-03 3 1  ON 7
ci_09                -7.339221e-03 3 1  ON 8
ci_10                -7.471797e-03 3 1  ON 9
ci_11                 1.230014e-02 3 1  ON 10
ci_12                 8.158380e-03 3 1  ON 11
ci_13                 1.233530e-02 3 1  ON 12
ci_14                 1.750309e-02 3 1  ON 13
ci_15                 6.742591e-03 3 1  ON 14
ci_16                 6.905634e-03 3 1  ON 15
ci_17                -7.102362e-03 3 1  ON 16
ci_18                -7.015091e-03 3 1  ON 17
ci_19                 8.255508e-03 3 1  ON 18
ci_20                 7.181441e-03 3 1  ON 19
ci_21                 7.152037e-03 3 1  ON 20
ci_22                 9.089054e-03 3 1  ON 21
ci_23                 5.567355e-03 3 1  ON 22
ci_24                 4.790714e-03 3 1  ON 23
ci_25                 2.915764e-03 3 1  ON 24
ci_26                 2.309729e-03 3 1  ON 25
ci_27                 2.545010e-03 3 1  ON 26
ci_28                 1.836291e-03 3 1  ON 27
ci_29                 1.996550e-03 3 1  ON 28
ci_30                -7.434094e-04 3 1  ON 29
ci_31                -7.312544e-04 3 1  ON 30
ci_32                 2.693467e-04 3 1  ON 31
ci_33                -8.232878e-04 3 1  ON 32
ci_34                 1.269069e-03 3 1  ON 33
ci_35                 1.836652e-03 3 1  ON 34
ci_36                -4.434703e-04 3 1  ON 35
ci_37                -7.426385e-04 3 1  ON 36
ci_38                -2.034092e-05 3 1  ON 37
ci_39                -5.598255e-04 3 1  ON 38
ci_40                -7.338444e-04 3 1  ON 39
ci_41                -6.315477e-05 3 1  ON 40
ci_42                -1.057394e-03 3 1  ON 41
ci_43                -2.421265e-03 3 1  ON 42
ci_44                -2.294525e-03 3 1  ON 43
ci_45                -7.759544e-04 3 1  ON 44
ci_46                 1.674370e-04 3 1  ON 45
ci_47                 2.701582e-03 3 1  ON 46
ci_48                 1.687849e-03 3 1  ON 47
ci_49                -9.382782e-04 3 1  ON 48
ci_50                -5.715907e-04 3 1  ON 49
ci_51                -2.463690e-04 3 1  ON 50
ci_52                -3.763803e-04 3 1  ON 51
ci_53                -5.749599e-04 3 1  ON 52
ci_54                -2.012242e-03 3 1  ON 53
ci_55                -1.767927e-03 3 1  ON 54
ci_56                 1.200601e-03 3 1  ON 55
ci_57                 1.782068e-03 3 1  ON 56
ci_58                -1.190747e-03 3 1  ON 57
ci_59                -1.523083e-03 3 1  ON 58
ci_60                 4.855755e-03 3 1  ON 59
ci_61                 2.861850e-05 3 1  ON 60
ci_62                -8.887124e-04 3 1  ON 61
ci_63                -1.172787e-04 3 1  ON 62
ci_64                -3.168140e-04 3 1  ON 63
ci_65                -7.104050e-04 3 1  ON 64
ci_66                -1.295670e-03 3 1  ON 65
ci_67                -7.730817e-04 3 1  ON 66
ci_68                -8.029811e-04 3 1  ON 67
ci_69                -1.723138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.9342
    reference variance = 0.328722
====================================================
  Execution time = 4.2127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8240e-01
  Total weights = 1.9641e+06
  Execution time = 5.9503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470663147668
                                         uncertainty =       0.002295544870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470663147668
                                         uncertainty =       0.002295544870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485081643
  error estimate for blocks of size 2^( 2) =       0.000506290032
  error estimate for blocks of size 2^( 3) =       0.000526562496
  error estimate for blocks of size 2^( 4) =       0.000542084109
  error estimate for blocks of size 2^( 5) =       0.000551393712
  error estimate for blocks of size 2^( 6) =       0.000557049815
  error estimate for blocks of size 2^( 7) =       0.000560004036

      target function =      -0.639572851989
              le_mean =     -22.819235901155
             les_mean =     521.238752553275
             stat err =       0.000552632918
             autocorr =       1.297907734899
   target nu stat err =       0.000552632918
   target dn stat err =       0.030372476898
      target stat err =       0.011503898966
              std dev =       0.686009038613
             le_variance =       0.470608401059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469523525456
                                         uncertainty =       0.002238434626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469523525456
                                         uncertainty =       0.002238434626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484496384
  error estimate for blocks of size 2^( 2) =       0.000505737823
  error estimate for blocks of size 2^( 3) =       0.000526035777
  error estimate for blocks of size 2^( 4) =       0.000541597632
  error estimate for blocks of size 2^( 5) =       0.000550879508
  error estimate for blocks of size 2^( 6) =       0.000556525004
  error estimate for blocks of size 2^( 7) =       0.000559687928

      target function =      -0.653742056524
              le_mean =     -22.819137006195
             les_mean =     521.198090039881
             stat err =       0.000552172518
             autocorr =       1.298878399972
   target nu stat err =       0.000552172518
   target dn stat err =       0.003471890884
      target stat err =       0.001412848630
              std dev =       0.685181357321
             le_variance =       0.469473492420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470555780042
                                         uncertainty =       0.002237885440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470555780042
                                         uncertainty =       0.002237885440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485028928
  error estimate for blocks of size 2^( 2) =       0.000506245812
  error estimate for blocks of size 2^( 3) =       0.000526508081
  error estimate for blocks of size 2^( 4) =       0.000542039288
  error estimate for blocks of size 2^( 5) =       0.000551243648
  error estimate for blocks of size 2^( 6) =       0.000556871797
  error estimate for blocks of size 2^( 7) =       0.000560190796

      target function =      -0.632166257198
              le_mean =     -22.819184307902
             les_mean =     521.256125642356
             stat err =       0.000552586382
             autocorr =       1.297971250446
   target nu stat err =       0.000552586382
   target dn stat err =       0.031684611277
      target stat err =       0.011723932758
              std dev =       0.685934487989
             le_variance =       0.470506121813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469689482374
                                         uncertainty =       0.002246589902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469689482374
                                         uncertainty =       0.002246589902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484581013
  error estimate for blocks of size 2^( 2) =       0.000505824936
  error estimate for blocks of size 2^( 3) =       0.000526125231
  error estimate for blocks of size 2^( 4) =       0.000541693433
  error estimate for blocks of size 2^( 5) =       0.000550994737
  error estimate for blocks of size 2^( 6) =       0.000556626003
  error estimate for blocks of size 2^( 7) =       0.000559698480

      target function =      -0.654083603706
              le_mean =     -22.819155238895
             les_mean =     521.198071595732
             stat err =       0.000552253163
             autocorr =       1.298804056596
   target nu stat err =       0.000552253163
   target dn stat err =       0.003160055443
      target stat err =       0.001294709889
              std dev =       0.685301041297
             le_variance =       0.469637517203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.639572851989        initial
     2.2737e-03     2.2737e-02             3.4060e-03        -0.653742056524
     9.0949e-03     9.0949e-02             2.5626e-03        -0.632166257198
     3.6380e-02     3.6380e-01             1.2859e-03        -0.654083603706  <--

*****************************************************************************
Applying the update for shift_i =   3.6380e-02     and shift_s =   3.6380e-01
*****************************************************************************

  Execution time = 7.5874e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_01                 1.116821e-01 3 1  ON 0
ci_02                -2.473479e-02 3 1  ON 1
ci_03                -2.426686e-02 3 1  ON 2
ci_04                 2.231355e-02 3 1  ON 3
ci_05                -2.110803e-02 3 1  ON 4
ci_06                -2.048988e-02 3 1  ON 5
ci_07                 2.574801e-02 3 1  ON 6
ci_08                -4.177669e-03 3 1  ON 7
ci_09                -7.845722e-03 3 1  ON 8
ci_10                -7.747702e-03 3 1  ON 9
ci_11                 1.267281e-02 3 1  ON 10
ci_12                 7.838528e-03 3 1  ON 11
ci_13                 1.279398e-02 3 1  ON 12
ci_14                 1.656339e-02 3 1  ON 13
ci_15                 6.727077e-03 3 1  ON 14
ci_16                 6.568964e-03 3 1  ON 15
ci_17                -7.135306e-03 3 1  ON 16
ci_18                -6.718944e-03 3 1  ON 17
ci_19                 8.600370e-03 3 1  ON 18
ci_20                 7.227693e-03 3 1  ON 19
ci_21                 7.809942e-03 3 1  ON 20
ci_22                 9.064646e-03 3 1  ON 21
ci_23                 5.140505e-03 3 1  ON 22
ci_24                 5.111488e-03 3 1  ON 23
ci_25                 2.797218e-03 3 1  ON 24
ci_26                 2.429015e-03 3 1  ON 25
ci_27                 2.213543e-03 3 1  ON 26
ci_28                 1.504554e-03 3 1  ON 27
ci_29                 1.750487e-03 3 1  ON 28
ci_30                -1.307023e-05 3 1  ON 29
ci_31                -8.113373e-04 3 1  ON 30
ci_32                 3.004691e-04 3 1  ON 31
ci_33                -8.811855e-04 3 1  ON 32
ci_34                 7.360760e-04 3 1  ON 33
ci_35                 1.374423e-03 3 1  ON 34
ci_36                -4.060471e-04 3 1  ON 35
ci_37                -7.444198e-04 3 1  ON 36
ci_38                -2.512797e-05 3 1  ON 37
ci_39                -5.516173e-04 3 1  ON 38
ci_40                -9.345496e-04 3 1  ON 39
ci_41                -1.037758e-04 3 1  ON 40
ci_42                -1.037749e-03 3 1  ON 41
ci_43                -1.987785e-03 3 1  ON 42
ci_44                -1.715671e-03 3 1  ON 43
ci_45                -9.555425e-04 3 1  ON 44
ci_46                -1.203447e-04 3 1  ON 45
ci_47                 2.439794e-03 3 1  ON 46
ci_48                 1.782682e-03 3 1  ON 47
ci_49                -7.389269e-04 3 1  ON 48
ci_50                -5.326030e-04 3 1  ON 49
ci_51                -1.778724e-04 3 1  ON 50
ci_52                -2.889164e-04 3 1  ON 51
ci_53                -5.146224e-04 3 1  ON 52
ci_54                -1.701395e-03 3 1  ON 53
ci_55                -1.806353e-03 3 1  ON 54
ci_56                 1.201372e-03 3 1  ON 55
ci_57                 1.918938e-03 3 1  ON 56
ci_58                -1.065551e-03 3 1  ON 57
ci_59                -1.415314e-03 3 1  ON 58
ci_60                 3.579066e-03 3 1  ON 59
ci_61                 2.016184e-04 3 1  ON 60
ci_62                -7.531678e-04 3 1  ON 61
ci_63                -5.975645e-05 3 1  ON 62
ci_64                -3.165752e-04 3 1  ON 63
ci_65                -4.948827e-04 3 1  ON 64
ci_66                -1.191970e-03 3 1  ON 65
ci_67                -4.798866e-04 3 1  ON 66
ci_68                -9.392809e-04 3 1  ON 67
ci_69                -1.170832e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2669e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.8315
    reference variance = 0.392783
====================================================
  Execution time = 4.3878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9361e-01
  Total weights = 1.963977365e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474584335425
                                         uncertainty =       0.002719860606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474584335425
                                         uncertainty =       0.002719860606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487308212
  error estimate for blocks of size 2^( 2) =       0.000508703051
  error estimate for blocks of size 2^( 3) =       0.000528683654
  error estimate for blocks of size 2^( 4) =       0.000544388064
  error estimate for blocks of size 2^( 5) =       0.000554094991
  error estimate for blocks of size 2^( 6) =       0.000561421490
  error estimate for blocks of size 2^( 7) =       0.000565378129

      target function =      -0.650154997156
              le_mean =     -22.818199309655
             les_mean =     521.163828805093
             stat err =       0.000556320669
             autocorr =       1.303295602793
   target nu stat err =       0.000556320669
   target dn stat err =       0.004239366415
      target stat err =       0.001689900219
              std dev =       0.689157882888
             le_variance =       0.474938587546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281819930966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650158969737       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650257874441       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650266149104       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650266204686       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650267119189       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650267318758       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650267323777       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650267557754       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650267527291       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650267526568       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.650267545821       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 1.767737e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650158969737       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650223094455       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650227315765       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650227202164       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650227652967       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650227708095       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650227725996       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650227801250       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.650227778385       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.650227782487       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 1.082272e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650158969737       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.650185613588       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.650186907665       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.650186823508       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.650186970207       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.650186977979       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.650186988522       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.650186999587       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-01 is 4.363717e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.666040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1516e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_01                 1.107554e-01 3 1  ON 0
ci_02                -2.499345e-02 3 1  ON 1
ci_03                -2.351655e-02 3 1  ON 2
ci_04                 2.188474e-02 3 1  ON 3
ci_05                -2.094130e-02 3 1  ON 4
ci_06                -2.031307e-02 3 1  ON 5
ci_07                 2.574553e-02 3 1  ON 6
ci_08                -3.965772e-03 3 1  ON 7
ci_09                -8.181424e-03 3 1  ON 8
ci_10                -8.065075e-03 3 1  ON 9
ci_11                 1.248266e-02 3 1  ON 10
ci_12                 8.045656e-03 3 1  ON 11
ci_13                 1.339062e-02 3 1  ON 12
ci_14                 1.723356e-02 3 1  ON 13
ci_15                 6.405712e-03 3 1  ON 14
ci_16                 6.636007e-03 3 1  ON 15
ci_17                -7.080250e-03 3 1  ON 16
ci_18                -5.636672e-03 3 1  ON 17
ci_19                 8.519806e-03 3 1  ON 18
ci_20                 7.007408e-03 3 1  ON 19
ci_21                 8.256979e-03 3 1  ON 20
ci_22                 9.056858e-03 3 1  ON 21
ci_23                 4.658403e-03 3 1  ON 22
ci_24                 5.680776e-03 3 1  ON 23
ci_25                 2.903045e-03 3 1  ON 24
ci_26                 2.258077e-03 3 1  ON 25
ci_27                 3.226973e-03 3 1  ON 26
ci_28                 1.642191e-03 3 1  ON 27
ci_29                 1.858115e-03 3 1  ON 28
ci_30                -7.906289e-05 3 1  ON 29
ci_31                -5.582586e-04 3 1  ON 30
ci_32                -2.717690e-04 3 1  ON 31
ci_33                -1.922117e-03 3 1  ON 32
ci_34                 1.753488e-03 3 1  ON 33
ci_35                 3.598954e-04 3 1  ON 34
ci_36                -3.170011e-04 3 1  ON 35
ci_37                -7.934135e-04 3 1  ON 36
ci_38                -1.549767e-04 3 1  ON 37
ci_39                -4.117442e-04 3 1  ON 38
ci_40                -8.858380e-04 3 1  ON 39
ci_41                -2.964204e-04 3 1  ON 40
ci_42                -1.278475e-04 3 1  ON 41
ci_43                -2.353654e-03 3 1  ON 42
ci_44                -1.974172e-03 3 1  ON 43
ci_45                -9.220540e-04 3 1  ON 44
ci_46                -3.469872e-04 3 1  ON 45
ci_47                 1.594520e-03 3 1  ON 46
ci_48                 1.556488e-03 3 1  ON 47
ci_49                -2.667719e-04 3 1  ON 48
ci_50                -5.670356e-04 3 1  ON 49
ci_51                -6.411057e-05 3 1  ON 50
ci_52                -2.353889e-04 3 1  ON 51
ci_53                -5.191629e-04 3 1  ON 52
ci_54                -1.641465e-03 3 1  ON 53
ci_55                -1.353288e-03 3 1  ON 54
ci_56                 9.229423e-04 3 1  ON 55
ci_57                 1.585391e-03 3 1  ON 56
ci_58                -1.038769e-03 3 1  ON 57
ci_59                -1.727203e-03 3 1  ON 58
ci_60                 3.307519e-03 3 1  ON 59
ci_61                 6.429794e-04 3 1  ON 60
ci_62                -6.091512e-04 3 1  ON 61
ci_63                 7.538331e-05 3 1  ON 62
ci_64                -4.675521e-04 3 1  ON 63
ci_65                -7.339079e-06 3 1  ON 64
ci_66                -8.630473e-04 3 1  ON 65
ci_67                -8.741687e-05 3 1  ON 66
ci_68                -7.398199e-04 3 1  ON 67
ci_69                -1.074625e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7741
    reference variance = 0.389447
====================================================
  Execution time = 4.1763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8225e-01
  Total weights = 1.9641e+06
  Execution time = 5.9496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469309633593
                                         uncertainty =       0.002105845204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469309633593
                                         uncertainty =       0.002105845204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484389816
  error estimate for blocks of size 2^( 2) =       0.000506108459
  error estimate for blocks of size 2^( 3) =       0.000527388664
  error estimate for blocks of size 2^( 4) =       0.000543512860
  error estimate for blocks of size 2^( 5) =       0.000553526663
  error estimate for blocks of size 2^( 6) =       0.000557601632
  error estimate for blocks of size 2^( 7) =       0.000562035430

      target function =      -0.621866415064
              le_mean =     -22.818877640341
             les_mean =     521.268231199518
             stat err =       0.000554169146
             autocorr =       1.308864468499
   target nu stat err =       0.000554169146
   target dn stat err =       0.067639410999
      target stat err =       0.024233424885
              std dev =       0.685030646565
             le_variance =       0.469266986733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469106505428
                                         uncertainty =       0.002125786830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469106505428
                                         uncertainty =       0.002125786830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484284368
  error estimate for blocks of size 2^( 2) =       0.000506047229
  error estimate for blocks of size 2^( 3) =       0.000527386602
  error estimate for blocks of size 2^( 4) =       0.000543554614
  error estimate for blocks of size 2^( 5) =       0.000553562579
  error estimate for blocks of size 2^( 6) =       0.000557711053
  error estimate for blocks of size 2^( 7) =       0.000562084456

      target function =      -0.649298681175
              le_mean =     -22.818862022981
             les_mean =     521.196630415060
             stat err =       0.000554228176
             autocorr =       1.309713484410
   target nu stat err =       0.000554228176
   target dn stat err =       0.010045855229
      target stat err =       0.003931628428
              std dev =       0.684881521401
             le_variance =       0.469062698356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469311303125
                                         uncertainty =       0.002134025138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469311303125
                                         uncertainty =       0.002134025138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484389648
  error estimate for blocks of size 2^( 2) =       0.000506158292
  error estimate for blocks of size 2^( 3) =       0.000527514682
  error estimate for blocks of size 2^( 4) =       0.000543680302
  error estimate for blocks of size 2^( 5) =       0.000553704447
  error estimate for blocks of size 2^( 6) =       0.000557861072
  error estimate for blocks of size 2^( 7) =       0.000562166078

      target function =      -0.643039003754
              le_mean =     -22.818874357481
             les_mean =     521.213337188551
             stat err =       0.000554352975
             autocorr =       1.309733870364
   target nu stat err =       0.000554352975
   target dn stat err =       0.014960445902
      target stat err =       0.005731878315
              std dev =       0.685030409445
             le_variance =       0.469266661865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469156525629
                                         uncertainty =       0.002115861019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469156525629
                                         uncertainty =       0.002115861019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484310724
  error estimate for blocks of size 2^( 2) =       0.000506037789
  error estimate for blocks of size 2^( 3) =       0.000527339758
  error estimate for blocks of size 2^( 4) =       0.000543476425
  error estimate for blocks of size 2^( 5) =       0.000553477588
  error estimate for blocks of size 2^( 6) =       0.000557591879
  error estimate for blocks of size 2^( 7) =       0.000561999990

      target function =      -0.620137011372
              le_mean =     -22.818862458051
             les_mean =     521.270784398299
             stat err =       0.000554136471
             autocorr =       1.309137600618
   target nu stat err =       0.000554136471
   target dn stat err =       0.085781120279
      target stat err =       0.030588878099
              std dev =       0.684918794794
             le_variance =       0.469113755462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.621866415064        initial
     9.0949e-03     9.0949e-02             1.7677e-03        -0.649298681175  <--
     3.6380e-02     3.6380e-01             1.0823e-03        -0.643039003754
     1.4552e-01     1.4552e+00             4.3637e-04        -0.620137011372

*****************************************************************************
Applying the update for shift_i =   9.0949e-03     and shift_s =   9.0949e-02
*****************************************************************************

  Execution time = 7.1658e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_01                 1.099393e-01 3 1  ON 0
ci_02                -2.518785e-02 3 1  ON 1
ci_03                -2.305741e-02 3 1  ON 2
ci_04                 2.165343e-02 3 1  ON 3
ci_05                -2.087895e-02 3 1  ON 4
ci_06                -2.021178e-02 3 1  ON 5
ci_07                 2.577018e-02 3 1  ON 6
ci_08                -3.853738e-03 3 1  ON 7
ci_09                -8.385533e-03 3 1  ON 8
ci_10                -8.256162e-03 3 1  ON 9
ci_11                 1.237213e-02 3 1  ON 10
ci_12                 8.166541e-03 3 1  ON 11
ci_13                 1.387062e-02 3 1  ON 12
ci_14                 1.791112e-02 3 1  ON 13
ci_15                 6.190413e-03 3 1  ON 14
ci_16                 6.698953e-03 3 1  ON 15
ci_17                -7.041343e-03 3 1  ON 16
ci_18                -4.951207e-03 3 1  ON 17
ci_19                 8.476334e-03 3 1  ON 18
ci_20                 6.871747e-03 3 1  ON 19
ci_21                 8.587935e-03 3 1  ON 20
ci_22                 9.086730e-03 3 1  ON 21
ci_23                 4.425458e-03 3 1  ON 22
ci_24                 6.098147e-03 3 1  ON 23
ci_25                 2.953438e-03 3 1  ON 24
ci_26                 2.129507e-03 3 1  ON 25
ci_27                 3.824677e-03 3 1  ON 26
ci_28                 1.713300e-03 3 1  ON 27
ci_29                 1.917667e-03 3 1  ON 28
ci_30                -1.320107e-04 3 1  ON 29
ci_31                -3.904405e-04 3 1  ON 30
ci_32                -5.764399e-04 3 1  ON 31
ci_33                -2.481315e-03 3 1  ON 32
ci_34                 2.356583e-03 3 1  ON 33
ci_35                -2.599011e-04 3 1  ON 34
ci_36                -2.595311e-04 3 1  ON 35
ci_37                -8.121823e-04 3 1  ON 36
ci_38                -2.213804e-04 3 1  ON 37
ci_39                -3.370195e-04 3 1  ON 38
ci_40                -8.578005e-04 3 1  ON 39
ci_41                -3.987878e-04 3 1  ON 40
ci_42                 3.557717e-04 3 1  ON 41
ci_43                -2.587781e-03 3 1  ON 42
ci_44                -2.152752e-03 3 1  ON 43
ci_45                -9.065821e-04 3 1  ON 44
ci_46                -4.685128e-04 3 1  ON 45
ci_47                 1.073781e-03 3 1  ON 46
ci_48                 1.399143e-03 3 1  ON 47
ci_49                -2.919255e-05 3 1  ON 48
ci_50                -5.869686e-04 3 1  ON 49
ci_51                -2.272001e-06 3 1  ON 50
ci_52                -2.073083e-04 3 1  ON 51
ci_53                -5.141599e-04 3 1  ON 52
ci_54                -1.636687e-03 3 1  ON 53
ci_55                -1.106884e-03 3 1  ON 54
ci_56                 7.741685e-04 3 1  ON 55
ci_57                 1.426756e-03 3 1  ON 56
ci_58                -1.030404e-03 3 1  ON 57
ci_59                -1.898726e-03 3 1  ON 58
ci_60                 3.092908e-03 3 1  ON 59
ci_61                 1.093495e-03 3 1  ON 60
ci_62                -5.307063e-04 3 1  ON 61
ci_63                 1.444305e-04 3 1  ON 62
ci_64                -5.537643e-04 3 1  ON 63
ci_65                 2.565542e-04 3 1  ON 64
ci_66                -6.943822e-04 3 1  ON 65
ci_67                 1.150982e-04 3 1  ON 66
ci_68                -6.192679e-04 3 1  ON 67
ci_69                -1.020923e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2318e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7697
    reference variance = 0.405232
====================================================
  Execution time = 4.3119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8646e-01
  Total weights = 1.964187142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472170304975
                                         uncertainty =       0.002251218627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472170304975
                                         uncertainty =       0.002251218627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485853344
  error estimate for blocks of size 2^( 2) =       0.000508127950
  error estimate for blocks of size 2^( 3) =       0.000528953135
  error estimate for blocks of size 2^( 4) =       0.000544041442
  error estimate for blocks of size 2^( 5) =       0.000553389482
  error estimate for blocks of size 2^( 6) =       0.000557525727
  error estimate for blocks of size 2^( 7) =       0.000557434598

      target function =      -0.652979473202
              le_mean =     -22.818261606332
             les_mean =     521.159517850325
             stat err =       0.000553097812
             autocorr =       1.295965647360
   target nu stat err =       0.000553097812
   target dn stat err =       0.003385633963
      target stat err =       0.001375630513
              std dev =       0.687100387963
             le_variance =       0.472106943138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281826160633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652981923294       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653102188497       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653119232403       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653124598916       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653129428377       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653134647840       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653135935039       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653136466910       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653137220050       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653136885441       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653136946972       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.653136984202       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 5.651442e-03

solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652981923294       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653086333436       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653100113639       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653104237262       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653107810788       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653111280160       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653111936391       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653112207837       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653112645293       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653112419357       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.653112454274       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 4.205673e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.652981923294       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.653050281867       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.653057906728       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.653059946191       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.653061587673       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.653062852515       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.653062967696       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.653063022773       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.653063146319       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.653063066939       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 2.080885e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.670223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0809e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_01                 1.103325e-01 3 1  ON 0
ci_02                -2.416506e-02 3 1  ON 1
ci_03                -2.455991e-02 3 1  ON 2
ci_04                 2.239987e-02 3 1  ON 3
ci_05                -2.014328e-02 3 1  ON 4
ci_06                -1.945796e-02 3 1  ON 5
ci_07                 2.570974e-02 3 1  ON 6
ci_08                -3.454361e-03 3 1  ON 7
ci_09                -8.432536e-03 3 1  ON 8
ci_10                -7.398652e-03 3 1  ON 9
ci_11                 1.225599e-02 3 1  ON 10
ci_12                 8.592913e-03 3 1  ON 11
ci_13                 1.314429e-02 3 1  ON 12
ci_14                 1.370545e-02 3 1  ON 13
ci_15                 6.367723e-03 3 1  ON 14
ci_16                 6.846445e-03 3 1  ON 15
ci_17                -6.545544e-03 3 1  ON 16
ci_18                -5.794645e-03 3 1  ON 17
ci_19                 9.558750e-03 3 1  ON 18
ci_20                 8.246268e-03 3 1  ON 19
ci_21                 7.807831e-03 3 1  ON 20
ci_22                 7.708114e-03 3 1  ON 21
ci_23                 4.413508e-03 3 1  ON 22
ci_24                 6.395896e-03 3 1  ON 23
ci_25                 2.973643e-03 3 1  ON 24
ci_26                 2.421744e-03 3 1  ON 25
ci_27                 2.314158e-03 3 1  ON 26
ci_28                 2.279213e-03 3 1  ON 27
ci_29                 2.299972e-03 3 1  ON 28
ci_30                -1.017889e-03 3 1  ON 29
ci_31                 5.647825e-04 3 1  ON 30
ci_32                -5.829022e-04 3 1  ON 31
ci_33                -1.684436e-03 3 1  ON 32
ci_34                 1.991580e-03 3 1  ON 33
ci_35                 1.451792e-03 3 1  ON 34
ci_36                -2.610762e-04 3 1  ON 35
ci_37                -7.222984e-04 3 1  ON 36
ci_38                -5.328466e-05 3 1  ON 37
ci_39                -9.972657e-04 3 1  ON 38
ci_40                -1.077858e-03 3 1  ON 39
ci_41                -8.694476e-04 3 1  ON 40
ci_42                 1.846492e-04 3 1  ON 41
ci_43                -2.389494e-03 3 1  ON 42
ci_44                -3.964193e-03 3 1  ON 43
ci_45                -7.378123e-04 3 1  ON 44
ci_46                 3.957236e-04 3 1  ON 45
ci_47                 4.316584e-04 3 1  ON 46
ci_48                 1.932312e-03 3 1  ON 47
ci_49                -5.723226e-04 3 1  ON 48
ci_50                -4.118860e-04 3 1  ON 49
ci_51                 5.671795e-04 3 1  ON 50
ci_52                 7.394793e-04 3 1  ON 51
ci_53                -5.929548e-04 3 1  ON 52
ci_54                -7.629605e-04 3 1  ON 53
ci_55                -6.354712e-04 3 1  ON 54
ci_56                 1.169262e-03 3 1  ON 55
ci_57                 2.455647e-03 3 1  ON 56
ci_58                -3.221879e-04 3 1  ON 57
ci_59                -1.810352e-04 3 1  ON 58
ci_60                 3.703608e-04 3 1  ON 59
ci_61                 7.134841e-04 3 1  ON 60
ci_62                -3.879992e-04 3 1  ON 61
ci_63                -4.812530e-04 3 1  ON 62
ci_64                -7.132686e-04 3 1  ON 63
ci_65                -1.128385e-03 3 1  ON 64
ci_66                -5.130261e-04 3 1  ON 65
ci_67                -2.088857e-04 3 1  ON 66
ci_68                 1.638050e-04 3 1  ON 67
ci_69                -1.401344e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8097
    reference variance = 0.368744
====================================================
  Execution time = 4.1829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8601e-01
  Total weights = 1.9644e+06
  Execution time = 5.9579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000495338
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471108745779
                                         uncertainty =       0.002837559104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471108745779
                                         uncertainty =       0.002837559104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485334068
  error estimate for blocks of size 2^( 2) =       0.000506916078
  error estimate for blocks of size 2^( 3) =       0.000527509572
  error estimate for blocks of size 2^( 4) =       0.000543274469
  error estimate for blocks of size 2^( 5) =       0.000552348953
  error estimate for blocks of size 2^( 6) =       0.000557914699
  error estimate for blocks of size 2^( 7) =       0.000560708599

      target function =      -0.642566926440
              le_mean =     -22.819736087649
             les_mean =     521.254466375110
             stat err =       0.000553561680
             autocorr =       1.300919677535
   target nu stat err =       0.000553561680
   target dn stat err =       0.012235347431
      target stat err =       0.004688346165
              std dev =       0.686366020650
             le_variance =       0.471098314303

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0248981
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470065201686
                                         uncertainty =       0.002790243280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470065201686
                                         uncertainty =       0.002790243280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484797907
  error estimate for blocks of size 2^( 2) =       0.000506404578
  error estimate for blocks of size 2^( 3) =       0.000526936784
  error estimate for blocks of size 2^( 4) =       0.000542756787
  error estimate for blocks of size 2^( 5) =       0.000551769911
  error estimate for blocks of size 2^( 6) =       0.000557340514
  error estimate for blocks of size 2^( 7) =       0.000560064806

      target function =      -0.652491453920
              le_mean =     -22.819656901257
             les_mean =     521.225310724816
             stat err =       0.000552983005
             autocorr =       1.301074294059
   target nu stat err =       0.000552983005
   target dn stat err =       0.004007898889
      target stat err =       0.001614379484
              std dev =       0.685607774432
             le_variance =       0.470058020361

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00049713
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477022864121
                                         uncertainty =       0.004389446106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477022864121
                                         uncertainty =       0.004389446106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488368385
  error estimate for blocks of size 2^( 2) =       0.000509834803
  error estimate for blocks of size 2^( 3) =       0.000530280269
  error estimate for blocks of size 2^( 4) =       0.000546030113
  error estimate for blocks of size 2^( 5) =       0.000555002229
  error estimate for blocks of size 2^( 6) =       0.000560414526
  error estimate for blocks of size 2^( 7) =       0.000563370121

      target function =      -0.284773942339
              le_mean =     -22.819730619000
             les_mean =     522.766119764657
             stat err =       0.000556204247
             autocorr =       1.297100177382
   target nu stat err =       0.000556204247
   target dn stat err =       1.385282573595
      target stat err =       0.123549367346
              std dev =       0.690657193037
             le_variance =       0.477007358293

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00426341
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476660124541
                                         uncertainty =       0.006545990170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476660124541
                                         uncertainty =       0.006545990170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488175443
  error estimate for blocks of size 2^( 2) =       0.000509589818
  error estimate for blocks of size 2^( 3) =       0.000529979149
  error estimate for blocks of size 2^( 4) =       0.000545680540
  error estimate for blocks of size 2^( 5) =       0.000554653982
  error estimate for blocks of size 2^( 6) =       0.000560050597
  error estimate for blocks of size 2^( 7) =       0.000562688194

      target function =      -0.175520398939
              le_mean =     -22.819708998568
             les_mean =     524.025994596922
             stat err =       0.000555768328
             autocorr =       1.296091699953
   target nu stat err =       0.000555768328
   target dn stat err =       2.753483338551
      target stat err =       0.108509885013
              std dev =       0.690384332305
             le_variance =       0.476630526292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.642566926440        initial
     2.2737e-03     2.2737e-02             5.6514e-03        -0.652491453920  <--
     9.0949e-03     9.0949e-02             4.2057e-03        -0.284773942339
     3.6380e-02     3.6380e-01             2.0809e-03        -0.175520398939

*****************************************************************************
Applying the update for shift_i =   2.2737e-03     and shift_s =   2.2737e-02
*****************************************************************************

  Execution time = 7.1755e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_01                 1.104694e-01 3 1  ON 0
ci_02                -2.397773e-02 3 1  ON 1
ci_03                -2.482849e-02 3 1  ON 2
ci_04                 2.251408e-02 3 1  ON 3
ci_05                -1.999568e-02 3 1  ON 4
ci_06                -1.932319e-02 3 1  ON 5
ci_07                 2.572064e-02 3 1  ON 6
ci_08                -3.394737e-03 3 1  ON 7
ci_09                -8.450092e-03 3 1  ON 8
ci_10                -7.227803e-03 3 1  ON 9
ci_11                 1.224709e-02 3 1  ON 10
ci_12                 8.659276e-03 3 1  ON 11
ci_13                 1.295411e-02 3 1  ON 12
ci_14                 1.225968e-02 3 1  ON 13
ci_15                 6.413689e-03 3 1  ON 14
ci_16                 6.883288e-03 3 1  ON 15
ci_17                -6.446469e-03 3 1  ON 16
ci_18                -5.938058e-03 3 1  ON 17
ci_19                 9.716551e-03 3 1  ON 18
ci_20                 8.484233e-03 3 1  ON 19
ci_21                 7.629172e-03 3 1  ON 20
ci_22                 7.401056e-03 3 1  ON 21
ci_23                 4.408327e-03 3 1  ON 22
ci_24                 6.435980e-03 3 1  ON 23
ci_25                 2.973621e-03 3 1  ON 24
ci_26                 2.478380e-03 3 1  ON 25
ci_27                 2.053251e-03 3 1  ON 26
ci_28                 2.372136e-03 3 1  ON 27
ci_29                 2.361612e-03 3 1  ON 28
ci_30                -1.204351e-03 3 1  ON 29
ci_31                 7.646748e-04 3 1  ON 30
ci_32                -5.788417e-04 3 1  ON 31
ci_33                -1.561797e-03 3 1  ON 32
ci_34                 1.917951e-03 3 1  ON 33
ci_35                 1.762068e-03 3 1  ON 34
ci_36                -2.664070e-04 3 1  ON 35
ci_37                -7.124950e-04 3 1  ON 36
ci_38                -2.487292e-05 3 1  ON 37
ci_39                -1.104734e-03 3 1  ON 38
ci_40                -1.109331e-03 3 1  ON 39
ci_41                -9.325291e-04 3 1  ON 40
ci_42                 1.608741e-04 3 1  ON 41
ci_43                -2.349761e-03 3 1  ON 42
ci_44                -4.278892e-03 3 1  ON 43
ci_45                -7.188181e-04 3 1  ON 44
ci_46                 5.118583e-04 3 1  ON 45
ci_47                 2.974873e-04 3 1  ON 46
ci_48                 2.025200e-03 3 1  ON 47
ci_49                -6.554010e-04 3 1  ON 48
ci_50                -3.877279e-04 3 1  ON 49
ci_51                 6.417713e-04 3 1  ON 50
ci_52                 8.716057e-04 3 1  ON 51
ci_53                -6.016116e-04 3 1  ON 52
ci_54                -5.839865e-04 3 1  ON 53
ci_55                -5.144142e-04 3 1  ON 54
ci_56                 1.223378e-03 3 1  ON 55
ci_57                 2.609673e-03 3 1  ON 56
ci_58                -2.001404e-04 3 1  ON 57
ci_59                 9.572763e-05 3 1  ON 58
ci_60                -5.582458e-04 3 1  ON 59
ci_61                 5.055058e-04 3 1  ON 60
ci_62                -3.692004e-04 3 1  ON 61
ci_63                -5.625378e-04 3 1  ON 62
ci_64                -7.326083e-04 3 1  ON 63
ci_65                -1.338457e-03 3 1  ON 64
ci_66                -4.870212e-04 3 1  ON 65
ci_67                -2.565736e-04 3 1  ON 66
ci_68                 2.941355e-04 3 1  ON 67
ci_69                -1.459777e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2257e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.8386
    reference variance = 0.364908
====================================================
  Execution time = 4.4868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 5.0207e-01
  Total weights = 1.964148126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477270026255
                                         uncertainty =       0.004979439260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477270026255
                                         uncertainty =       0.004979439260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488542161
  error estimate for blocks of size 2^( 2) =       0.000509733597
  error estimate for blocks of size 2^( 3) =       0.000529875219
  error estimate for blocks of size 2^( 4) =       0.000544914944
  error estimate for blocks of size 2^( 5) =       0.000555506565
  error estimate for blocks of size 2^( 6) =       0.000561008539
  error estimate for blocks of size 2^( 7) =       0.000564163650

      target function =      -0.647171127927
              le_mean =     -22.819674384176
             les_mean =     521.239610726114
             stat err =       0.000556398425
             autocorr =       1.297082756540
   target nu stat err =       0.000556398425
   target dn stat err =       0.014762429786
      target stat err =       0.005733373099
              std dev =       0.690902949195
             le_variance =       0.477346885207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281967438418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647221232466       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647451014173       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647516052011       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647538670328       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647547389513       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647549368586       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647551221293       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647551263655       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647552339977       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647552309291       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.647552325664       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.647552306740       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.647552259018       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.647552288444       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 1.262584e-02

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647221232466       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647441632215       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647502489121       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647522964360       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647530583722       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647532217305       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647533814348       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647533833279       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647534757255       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647534703924       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.647534712319       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.647534692382       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.647534652420       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 1.180215e-02

solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.647221232466       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.647410687546       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.647458832054       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.647473327546       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.647478112132       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.647478947668       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.647479929372       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.647479909219       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647480465333       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.647480385056       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.647480382769       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.647480366210       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.647480345022       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 9.352548e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.676276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2549e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_01                 1.104762e-01 3 1  ON 0
ci_02                -2.465667e-02 3 1  ON 1
ci_03                -2.298945e-02 3 1  ON 2
ci_04                 2.060951e-02 3 1  ON 3
ci_05                -1.816556e-02 3 1  ON 4
ci_06                -2.077462e-02 3 1  ON 5
ci_07                 2.514677e-02 3 1  ON 6
ci_08                -2.743436e-03 3 1  ON 7
ci_09                -5.783482e-03 3 1  ON 8
ci_10                -5.887109e-03 3 1  ON 9
ci_11                 1.394046e-02 3 1  ON 10
ci_12                 7.189410e-03 3 1  ON 11
ci_13                 1.151962e-03 3 1  ON 12
ci_14                 1.776233e-02 3 1  ON 13
ci_15                 7.212780e-03 3 1  ON 14
ci_16                 6.155040e-03 3 1  ON 15
ci_17                -6.368230e-03 3 1  ON 16
ci_18                -6.513870e-03 3 1  ON 17
ci_19                 9.712167e-03 3 1  ON 18
ci_20                 7.830709e-03 3 1  ON 19
ci_21                 2.190748e-03 3 1  ON 20
ci_22                 4.856816e-03 3 1  ON 21
ci_23                 5.545570e-03 3 1  ON 22
ci_24                 4.985730e-03 3 1  ON 23
ci_25                 1.927036e-03 3 1  ON 24
ci_26                 2.891738e-03 3 1  ON 25
ci_27                 3.440761e-03 3 1  ON 26
ci_28                 1.372215e-03 3 1  ON 27
ci_29                 9.534357e-04 3 1  ON 28
ci_30                -2.374917e-03 3 1  ON 29
ci_31                -3.345384e-03 3 1  ON 30
ci_32                -1.158278e-03 3 1  ON 31
ci_33                -2.087602e-03 3 1  ON 32
ci_34                 1.125184e-03 3 1  ON 33
ci_35                 1.212374e-03 3 1  ON 34
ci_36                -5.356739e-04 3 1  ON 35
ci_37                -1.760113e-03 3 1  ON 36
ci_38                -6.583193e-04 3 1  ON 37
ci_39                -6.944752e-04 3 1  ON 38
ci_40                -9.973451e-04 3 1  ON 39
ci_41                -2.484603e-03 3 1  ON 40
ci_42                -1.834952e-04 3 1  ON 41
ci_43                -1.557904e-03 3 1  ON 42
ci_44                -2.491442e-03 3 1  ON 43
ci_45                -1.922331e-04 3 1  ON 44
ci_46                -6.944969e-04 3 1  ON 45
ci_47                 7.014760e-04 3 1  ON 46
ci_48                 8.735177e-04 3 1  ON 47
ci_49                -1.250411e-03 3 1  ON 48
ci_50                -6.034347e-04 3 1  ON 49
ci_51                 7.286401e-04 3 1  ON 50
ci_52                -3.124021e-04 3 1  ON 51
ci_53                -7.458156e-04 3 1  ON 52
ci_54                -6.446174e-04 3 1  ON 53
ci_55                -1.236766e-03 3 1  ON 54
ci_56                 2.118088e-03 3 1  ON 55
ci_57                 2.074014e-03 3 1  ON 56
ci_58                -1.215627e-03 3 1  ON 57
ci_59                -5.968895e-04 3 1  ON 58
ci_60                 5.250314e-04 3 1  ON 59
ci_61                 1.891977e-04 3 1  ON 60
ci_62                -2.948246e-04 3 1  ON 61
ci_63                -4.522602e-04 3 1  ON 62
ci_64                -3.367689e-04 3 1  ON 63
ci_65                -4.303397e-04 3 1  ON 64
ci_66                -4.878000e-04 3 1  ON 65
ci_67                -9.558356e-04 3 1  ON 66
ci_68                -1.247572e-03 3 1  ON 67
ci_69                -7.682725e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7823
    reference variance = 0.45626
====================================================
  Execution time = 4.1879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8133e-01
  Total weights = 1.9642e+06
  Execution time = 6.1427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000148255
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.718835714319
                                         uncertainty =       0.174950280859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.718835714319
                                         uncertainty =       0.174950280859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000599055119
  error estimate for blocks of size 2^( 2) =       0.000616971850
  error estimate for blocks of size 2^( 3) =       0.000634702949
  error estimate for blocks of size 2^( 4) =       0.000648055096
  error estimate for blocks of size 2^( 5) =       0.000656993336
  error estimate for blocks of size 2^( 6) =       0.000663697320
  error estimate for blocks of size 2^( 7) =       0.000666108895

      target function =      -0.069424545809
              le_mean =     -22.819856205860
             les_mean =     530.915330290783
             stat err =       0.000658713662
             autocorr =       1.209093188207
   target nu stat err =       0.000658713662
   target dn stat err =       6.919931268328
      target stat err =       0.042378678073
              std dev =       0.847191873969
             le_variance =       0.717734071320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468121811421
                                         uncertainty =       0.002473580791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468121811421
                                         uncertainty =       0.002473580791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483785222
  error estimate for blocks of size 2^( 2) =       0.000505153066
  error estimate for blocks of size 2^( 3) =       0.000526289813
  error estimate for blocks of size 2^( 4) =       0.000541774539
  error estimate for blocks of size 2^( 5) =       0.000552367435
  error estimate for blocks of size 2^( 6) =       0.000559501887
  error estimate for blocks of size 2^( 7) =       0.000563255818

      target function =      -0.653580808363
              le_mean =     -22.819098082240
             les_mean =     521.196690599103
             stat err =       0.000554224920
             autocorr =       1.312402059505
   target nu stat err =       0.000554224920
   target dn stat err =       0.004822967395
      target stat err =       0.001935267464
              std dev =       0.684175621753
             le_variance =       0.468096281401

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000148088
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.664615884111
                                         uncertainty =       0.180610446728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.664615884111
                                         uncertainty =       0.180610446728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000576330221
  error estimate for blocks of size 2^( 2) =       0.000594503524
  error estimate for blocks of size 2^( 3) =       0.000612625820
  error estimate for blocks of size 2^( 4) =       0.000625911325
  error estimate for blocks of size 2^( 5) =       0.000635228957
  error estimate for blocks of size 2^( 6) =       0.000641623890
  error estimate for blocks of size 2^( 7) =       0.000644807129

      target function =      -0.367229534315
              le_mean =     -22.819704213952
             les_mean =     522.264321927628
             stat err =       0.000636892825
             autocorr =       1.221208805046
   target nu stat err =       0.000636892825
   target dn stat err =       0.819250338873
      target stat err =       0.111739238170
              std dev =       0.815054014549
             le_variance =       0.664313046632

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0868029
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.531435905102
                                         uncertainty =       1.057709174215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.531435905102
                                         uncertainty =       1.057709174215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000874935371
  error estimate for blocks of size 2^( 2) =       0.000886679569
  error estimate for blocks of size 2^( 3) =       0.000899045725
  error estimate for blocks of size 2^( 4) =       0.000907513116
  error estimate for blocks of size 2^( 5) =       0.000915204812
  error estimate for blocks of size 2^( 6) =       0.000920252298
  error estimate for blocks of size 2^( 7) =       0.000920504093

      target function =      -0.004219163784
              le_mean =     -22.819826795806
             les_mean =     649.200264353214
             stat err =       0.000915868580
             autocorr =       1.095757297798
   target nu stat err =       0.000915868580
   target dn stat err =     128.010976170174
      target stat err =       0.004166709424
              std dev =       1.237345468353
             le_variance =       1.531023808053


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.069424545809        initial
     5.6843e-04     5.6843e-03             1.2626e-02        -0.653580808363  <--
     2.2737e-03     2.2737e-02             1.1802e-02        -0.367229534315
     9.0949e-03     9.0949e-02             9.3525e-03        -0.004219163784

*****************************************************************************
Applying the update for shift_i =   5.6843e-04     and shift_s =   5.6843e-03
*****************************************************************************

  Execution time = 7.1682e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_01                 1.104729e-01 3 1  ON 0
ci_02                -2.468463e-02 3 1  ON 1
ci_03                -2.289721e-02 3 1  ON 2
ci_04                 2.054342e-02 3 1  ON 3
ci_05                -1.807359e-02 3 1  ON 4
ci_06                -2.083716e-02 3 1  ON 5
ci_07                 2.509880e-02 3 1  ON 6
ci_08                -2.720843e-03 3 1  ON 7
ci_09                -5.644795e-03 3 1  ON 8
ci_10                -5.822723e-03 3 1  ON 9
ci_11                 1.399838e-02 3 1  ON 10
ci_12                 7.134097e-03 3 1  ON 11
ci_13                 3.282693e-04 3 1  ON 12
ci_14                 1.830519e-02 3 1  ON 13
ci_15                 7.253549e-03 3 1  ON 14
ci_16                 6.120383e-03 3 1  ON 15
ci_17                -6.360829e-03 3 1  ON 16
ci_18                -6.545579e-03 3 1  ON 17
ci_19                 9.711574e-03 3 1  ON 18
ci_20                 7.800349e-03 3 1  ON 19
ci_21                 1.823747e-03 3 1  ON 20
ci_22                 4.662557e-03 3 1  ON 21
ci_23                 5.592658e-03 3 1  ON 22
ci_24                 4.898195e-03 3 1  ON 23
ci_25                 1.884455e-03 3 1  ON 24
ci_26                 2.918717e-03 3 1  ON 25
ci_27                 3.512902e-03 3 1  ON 26
ci_28                 1.328115e-03 3 1  ON 27
ci_29                 8.860895e-04 3 1  ON 28
ci_30                -2.495616e-03 3 1  ON 29
ci_31                -3.663672e-03 3 1  ON 30
ci_32                -1.178017e-03 3 1  ON 31
ci_33                -2.112523e-03 3 1  ON 32
ci_34                 1.089361e-03 3 1  ON 33
ci_35                 1.187325e-03 3 1  ON 34
ci_36                -5.489921e-04 3 1  ON 35
ci_37                -1.804079e-03 3 1  ON 36
ci_38                -6.914351e-04 3 1  ON 37
ci_39                -6.772787e-04 3 1  ON 38
ci_40                -9.952876e-04 3 1  ON 39
ci_41                -2.550498e-03 3 1  ON 40
ci_42                -1.967178e-04 3 1  ON 41
ci_43                -1.509337e-03 3 1  ON 42
ci_44                -2.400938e-03 3 1  ON 43
ci_45                -1.702901e-04 3 1  ON 44
ci_46                -7.462559e-04 3 1  ON 45
ci_47                 6.761557e-04 3 1  ON 46
ci_48                 7.945011e-04 3 1  ON 47
ci_49                -1.275697e-03 3 1  ON 48
ci_50                -6.065588e-04 3 1  ON 49
ci_51                 7.310458e-04 3 1  ON 50
ci_52                -3.577148e-04 3 1  ON 51
ci_53                -7.567623e-04 3 1  ON 52
ci_54                -6.665844e-04 3 1  ON 53
ci_55                -1.287105e-03 3 1  ON 54
ci_56                 2.152189e-03 3 1  ON 55
ci_57                 2.048172e-03 3 1  ON 56
ci_58                -1.257556e-03 3 1  ON 57
ci_59                -6.256793e-04 3 1  ON 58
ci_60                 6.444843e-04 3 1  ON 59
ci_61                 2.015074e-04 3 1  ON 60
ci_62                -2.925700e-04 3 1  ON 61
ci_63                -4.528873e-04 3 1  ON 62
ci_64                -3.170066e-04 3 1  ON 63
ci_65                -3.915669e-04 3 1  ON 64
ci_66                -4.811196e-04 3 1  ON 65
ci_67                -9.721715e-04 3 1  ON 66
ci_68                -1.315187e-03 3 1  ON 67
ci_69                -7.404419e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2424e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.9169
    reference variance = 0.425243
====================================================
  Execution time = 4.2518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9164e-01
  Total weights = 1.964417447e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472335411382
                                         uncertainty =       0.004247044357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472335411382
                                         uncertainty =       0.004247044357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485984249
  error estimate for blocks of size 2^( 2) =       0.000507867018
  error estimate for blocks of size 2^( 3) =       0.000528993929
  error estimate for blocks of size 2^( 4) =       0.000545110403
  error estimate for blocks of size 2^( 5) =       0.000554929741
  error estimate for blocks of size 2^( 6) =       0.000560684161
  error estimate for blocks of size 2^( 7) =       0.000563838222

      target function =      -0.650991644950
              le_mean =     -22.818484081414
             les_mean =     521.174854545274
             stat err =       0.000556140632
             autocorr =       1.309558382016
   target nu stat err =       0.000556140632
   target dn stat err =       0.005979599816
      target stat err =       0.002366916769
              std dev =       0.687285515858
             le_variance =       0.472361380309


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281848408141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650999729167       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651248163490       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651332277374       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651372972820       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651389040078       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651395404864       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651395759075       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651396008053       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651396657085       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651396651363       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651396525689       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651396627810       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651396622334       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.651396664621       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 1.205396e-02

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650999729167       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651245668957       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651328466016       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651368217775       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651383781833       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651389912334       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651390222443       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651390456460       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651391076408       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651391063818       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651390942669       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651391039301       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651391033955       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.651391073735       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 1.184326e-02

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650999729167       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651236172179       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651314062623       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651350383980       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651364161693       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651369474442       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651369640399       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651369825337       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651370346448       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651370313460       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651370208741       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651370287280       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.651370282620       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.651370314210       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 1.107001e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.688682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0224e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_01                 1.189483e-01 3 1  ON 0
ci_02                -2.517327e-02 3 1  ON 1
ci_03                -2.555082e-02 3 1  ON 2
ci_04                 2.077533e-02 3 1  ON 3
ci_05                -1.927412e-02 3 1  ON 4
ci_06                -1.888101e-02 3 1  ON 5
ci_07                 2.571258e-02 3 1  ON 6
ci_08                -3.797538e-03 3 1  ON 7
ci_09                -7.414631e-03 3 1  ON 8
ci_10                -6.386088e-03 3 1  ON 9
ci_11                 1.459604e-02 3 1  ON 10
ci_12                 5.373073e-03 3 1  ON 11
ci_13                 1.217153e-02 3 1  ON 12
ci_14                 1.416439e-02 3 1  ON 13
ci_15                 5.510200e-03 3 1  ON 14
ci_16                 7.479183e-03 3 1  ON 15
ci_17                -7.051366e-03 3 1  ON 16
ci_18                -6.523842e-03 3 1  ON 17
ci_19                 9.336774e-03 3 1  ON 18
ci_20                 7.346422e-03 3 1  ON 19
ci_21                 6.936688e-03 3 1  ON 20
ci_22                 7.498265e-03 3 1  ON 21
ci_23                 4.870564e-03 3 1  ON 22
ci_24                 3.752599e-03 3 1  ON 23
ci_25                 2.884701e-03 3 1  ON 24
ci_26                 5.064003e-03 3 1  ON 25
ci_27                 4.088948e-03 3 1  ON 26
ci_28                 2.645547e-03 3 1  ON 27
ci_29                 1.175548e-03 3 1  ON 28
ci_30                 7.339625e-04 3 1  ON 29
ci_31                -3.804025e-04 3 1  ON 30
ci_32                -1.748797e-04 3 1  ON 31
ci_33                -3.108446e-04 3 1  ON 32
ci_34                 7.771469e-04 3 1  ON 33
ci_35                 9.403386e-04 3 1  ON 34
ci_36                -1.562358e-03 3 1  ON 35
ci_37                -8.776609e-04 3 1  ON 36
ci_38                 2.756876e-04 3 1  ON 37
ci_39                -9.575244e-04 3 1  ON 38
ci_40                -2.103272e-03 3 1  ON 39
ci_41                -4.192997e-04 3 1  ON 40
ci_42                -1.322303e-03 3 1  ON 41
ci_43                -2.139352e-03 3 1  ON 42
ci_44                 4.724752e-04 3 1  ON 43
ci_45                 3.243163e-04 3 1  ON 44
ci_46                -1.477891e-03 3 1  ON 45
ci_47                 6.947366e-04 3 1  ON 46
ci_48                 1.320719e-03 3 1  ON 47
ci_49                -1.060936e-03 3 1  ON 48
ci_50                -4.171550e-04 3 1  ON 49
ci_51                 7.045038e-04 3 1  ON 50
ci_52                -1.023295e-03 3 1  ON 51
ci_53                -2.288403e-04 3 1  ON 52
ci_54                -1.545513e-03 3 1  ON 53
ci_55                -1.148237e-04 3 1  ON 54
ci_56                 2.603950e-03 3 1  ON 55
ci_57                 1.702983e-03 3 1  ON 56
ci_58                -1.072721e-03 3 1  ON 57
ci_59                -6.602640e-04 3 1  ON 58
ci_60                 1.232232e-03 3 1  ON 59
ci_61                -3.020105e-03 3 1  ON 60
ci_62                 3.771277e-04 3 1  ON 61
ci_63                -5.690111e-04 3 1  ON 62
ci_64                 1.389123e-04 3 1  ON 63
ci_65                 1.464610e-04 3 1  ON 64
ci_66                -4.114026e-04 3 1  ON 65
ci_67                -2.120923e-05 3 1  ON 66
ci_68                -8.780066e-04 3 1  ON 67
ci_69                -2.158162e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8662
    reference variance = 0.661696
====================================================
  Execution time = 4.1581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8819e-01
  Total weights = 1.9642e+06
  Execution time = 5.9009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00905855
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584063373790
                                         uncertainty =       0.104050612874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.584063373790
                                         uncertainty =       0.104050612874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000540421767
  error estimate for blocks of size 2^( 2) =       0.000560010787
  error estimate for blocks of size 2^( 3) =       0.000578637838
  error estimate for blocks of size 2^( 4) =       0.000593104308
  error estimate for blocks of size 2^( 5) =       0.000601539677
  error estimate for blocks of size 2^( 6) =       0.000606637355
  error estimate for blocks of size 2^( 7) =       0.000610088362

      target function =      -0.504420938310
              le_mean =     -22.818617936432
             les_mean =     521.622992462998
             stat err =       0.000602842426
             autocorr =       1.244348278473
   target nu stat err =       0.000602842426
   target dn stat err =       0.292676204927
      target stat err =       0.070199392432
              std dev =       0.764271792053
             le_variance =       0.584111372128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472711789779
                                         uncertainty =       0.002809064483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472711789779
                                         uncertainty =       0.002809064483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486232805
  error estimate for blocks of size 2^( 2) =       0.000507767529
  error estimate for blocks of size 2^( 3) =       0.000528166422
  error estimate for blocks of size 2^( 4) =       0.000544233718
  error estimate for blocks of size 2^( 5) =       0.000553856235
  error estimate for blocks of size 2^( 6) =       0.000559283268
  error estimate for blocks of size 2^( 7) =       0.000563110745

      target function =      -0.651865247707
              le_mean =     -22.817951719676
             les_mean =     521.148011644303
             stat err =       0.000555120991
             autocorr =       1.303427221662
   target nu stat err =       0.000555120991
   target dn stat err =       0.003509558726
      target stat err =       0.001418228591
              std dev =       0.687637027759
             le_variance =       0.472844681945

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00931643
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517984622580
                                         uncertainty =       0.030392738647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517984622580
                                         uncertainty =       0.030392738647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508957161
  error estimate for blocks of size 2^( 2) =       0.000529488339
  error estimate for blocks of size 2^( 3) =       0.000549007327
  error estimate for blocks of size 2^( 4) =       0.000565096020
  error estimate for blocks of size 2^( 5) =       0.000573980110
  error estimate for blocks of size 2^( 6) =       0.000579003551
  error estimate for blocks of size 2^( 7) =       0.000583454039

      target function =      -0.338435138922
              le_mean =     -22.818247236258
             les_mean =     522.331324444777
             stat err =       0.000575383430
             autocorr =       1.278062943958
   target nu stat err =       0.000575383430
   target dn stat err =       1.019906539352
      target stat err =       0.122007630584
              std dev =       0.719774119947
             le_variance =       0.518074783745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472676473037
                                         uncertainty =       0.002798206632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472676473037
                                         uncertainty =       0.002798206632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486214355
  error estimate for blocks of size 2^( 2) =       0.000507756276
  error estimate for blocks of size 2^( 3) =       0.000528160486
  error estimate for blocks of size 2^( 4) =       0.000544237901
  error estimate for blocks of size 2^( 5) =       0.000553862747
  error estimate for blocks of size 2^( 6) =       0.000559307300
  error estimate for blocks of size 2^( 7) =       0.000563126713

      target function =      -0.649136924199
              le_mean =     -22.817954032661
             les_mean =     521.155063301066
             stat err =       0.000555133665
             autocorr =       1.303585668368
   target nu stat err =       0.000555133665
   target dn stat err =       0.008109448163
      target stat err =       0.003175629166
              std dev =       0.687610934846
             le_variance =       0.472808797720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.504420938310        initial
     1.4211e-04     1.4211e-03             1.2054e-02        -0.651865247707  <--
     5.6843e-04     5.6843e-03             1.1843e-02        -0.338435138922
     2.2737e-03     2.2737e-02             1.1070e-02        -0.649136924199

*****************************************************************************
Applying the update for shift_i =   1.4211e-04     and shift_s =   1.4211e-03
*****************************************************************************

  Execution time = 7.1164e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_01                 1.191135e-01 3 1  ON 0
ci_02                -2.517572e-02 3 1  ON 1
ci_03                -2.558054e-02 3 1  ON 2
ci_04                 2.077834e-02 3 1  ON 3
ci_05                -1.928379e-02 3 1  ON 4
ci_06                -1.885117e-02 3 1  ON 5
ci_07                 2.571944e-02 3 1  ON 6
ci_08                -3.810164e-03 3 1  ON 7
ci_09                -7.436837e-03 3 1  ON 8
ci_10                -6.392969e-03 3 1  ON 9
ci_11                 1.461168e-02 3 1  ON 10
ci_12                 5.353128e-03 3 1  ON 11
ci_13                 1.238223e-02 3 1  ON 12
ci_14                 1.405185e-02 3 1  ON 13
ci_15                 5.489827e-03 3 1  ON 14
ci_16                 7.494843e-03 3 1  ON 15
ci_17                -7.059245e-03 3 1  ON 16
ci_18                -6.523797e-03 3 1  ON 17
ci_19                 9.334105e-03 3 1  ON 18
ci_20                 7.342303e-03 3 1  ON 19
ci_21                 7.024666e-03 3 1  ON 20
ci_22                 7.551287e-03 3 1  ON 21
ci_23                 4.863200e-03 3 1  ON 22
ci_24                 3.732242e-03 3 1  ON 23
ci_25                 2.895307e-03 3 1  ON 24
ci_26                 5.089478e-03 3 1  ON 25
ci_27                 4.096459e-03 3 1  ON 26
ci_28                 2.661120e-03 3 1  ON 27
ci_29                 1.179039e-03 3 1  ON 28
ci_30                 8.022592e-04 3 1  ON 29
ci_31                -3.119824e-04 3 1  ON 30
ci_32                -1.656331e-04 3 1  ON 31
ci_33                -2.924159e-04 3 1  ON 32
ci_34                 7.724956e-04 3 1  ON 33
ci_35                 9.371558e-04 3 1  ON 34
ci_36                -1.572438e-03 3 1  ON 35
ci_37                -8.679835e-04 3 1  ON 36
ci_38                 2.855511e-04 3 1  ON 37
ci_39                -9.613029e-04 3 1  ON 38
ci_40                -2.114209e-03 3 1  ON 39
ci_41                -3.993733e-04 3 1  ON 40
ci_42                -1.334437e-03 3 1  ON 41
ci_43                -2.146540e-03 3 1  ON 42
ci_44                 5.059779e-04 3 1  ON 43
ci_45                 3.301352e-04 3 1  ON 44
ci_46                -1.483514e-03 3 1  ON 45
ci_47                 7.030853e-04 3 1  ON 46
ci_48                 1.334333e-03 3 1  ON 47
ci_49                -1.059111e-03 3 1  ON 48
ci_50                -4.160595e-04 3 1  ON 49
ci_51                 7.043038e-04 3 1  ON 50
ci_52                -1.030471e-03 3 1  ON 51
ci_53                -2.247557e-04 3 1  ON 52
ci_54                -1.551996e-03 3 1  ON 53
ci_55                -9.737565e-05 3 1  ON 54
ci_56                 2.608706e-03 3 1  ON 55
ci_57                 1.699338e-03 3 1  ON 56
ci_58                -1.070623e-03 3 1  ON 57
ci_59                -6.602549e-04 3 1  ON 58
ci_60                 1.238438e-03 3 1  ON 59
ci_61                -3.095751e-03 3 1  ON 60
ci_62                 3.827945e-04 3 1  ON 61
ci_63                -5.700775e-04 3 1  ON 62
ci_64                 1.441549e-04 3 1  ON 63
ci_65                 1.520173e-04 3 1  ON 64
ci_66                -4.136537e-04 3 1  ON 65
ci_67                -1.495416e-05 3 1  ON 66
ci_68                -8.753875e-04 3 1  ON 67
ci_69                -2.172775e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2140e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7159
    reference variance = 0.443341
====================================================
  Execution time = 4.2676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8404e-01
  Total weights = 1.964337042e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470054016979
                                         uncertainty =       0.003766450566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470054016979
                                         uncertainty =       0.003766450566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484762258
  error estimate for blocks of size 2^( 2) =       0.000506141305
  error estimate for blocks of size 2^( 3) =       0.000526069022
  error estimate for blocks of size 2^( 4) =       0.000540945936
  error estimate for blocks of size 2^( 5) =       0.000549794928
  error estimate for blocks of size 2^( 6) =       0.000554483869
  error estimate for blocks of size 2^( 7) =       0.000556992200

      target function =      -0.654343225514
              le_mean =     -22.819907429025
             les_mean =     521.232216683424
             stat err =       0.000550554233
             autocorr =       1.289860110926
   target nu stat err =       0.000550554233
   target dn stat err =       0.004140419467
      target stat err =       0.001674881238
              std dev =       0.685557360426
             le_variance =       0.469988894435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281990742903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-05, overlap shift 3.5527e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654347121862       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654511516617       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654536011339       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654543658579       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654548275440       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654551720791       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654553344775       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654553285150       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654553776546       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654553723524       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654553761790       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654553758989       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e-05 is 4.552006e-03

solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654347121862       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654511111506       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654535516103       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654543126099       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654547715064       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654551133907       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654552741955       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654552681572       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654553168660       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654553115566       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654553153331       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654553150409       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 4.529403e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654347121862       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654509510826       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654533560988       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654541025095       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654545505236       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654548821242       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654550367842       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654550304685       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654550775130       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654550721813       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654550757678       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654550754310       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 4.441193e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.698935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0314e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_01                 1.145841e-01 3 1  ON 0
ci_02                -2.487692e-02 3 1  ON 1
ci_03                -2.390698e-02 3 1  ON 2
ci_04                 2.258456e-02 3 1  ON 3
ci_05                -1.999510e-02 3 1  ON 4
ci_06                -2.134122e-02 3 1  ON 5
ci_07                 2.585688e-02 3 1  ON 6
ci_08                -4.069216e-03 3 1  ON 7
ci_09                -7.698630e-03 3 1  ON 8
ci_10                -7.012420e-03 3 1  ON 9
ci_11                 1.345311e-02 3 1  ON 10
ci_12                 6.964611e-03 3 1  ON 11
ci_13                 9.608794e-03 3 1  ON 12
ci_14                 1.497423e-02 3 1  ON 13
ci_15                 7.523115e-03 3 1  ON 14
ci_16                 6.286444e-03 3 1  ON 15
ci_17                -5.603165e-03 3 1  ON 16
ci_18                -4.349057e-03 3 1  ON 17
ci_19                 8.010682e-03 3 1  ON 18
ci_20                 6.304028e-03 3 1  ON 19
ci_21                 7.846346e-03 3 1  ON 20
ci_22                 7.069972e-03 3 1  ON 21
ci_23                 3.719363e-03 3 1  ON 22
ci_24                 4.750315e-03 3 1  ON 23
ci_25                 3.061482e-03 3 1  ON 24
ci_26                 3.012256e-03 3 1  ON 25
ci_27                 3.349200e-03 3 1  ON 26
ci_28                 1.401824e-03 3 1  ON 27
ci_29                 1.888472e-03 3 1  ON 28
ci_30                -8.533818e-04 3 1  ON 29
ci_31                -1.759444e-03 3 1  ON 30
ci_32                -9.593946e-04 3 1  ON 31
ci_33                -1.718945e-03 3 1  ON 32
ci_34                 7.831338e-05 3 1  ON 33
ci_35                 1.107885e-03 3 1  ON 34
ci_36                -8.211632e-04 3 1  ON 35
ci_37                 1.748465e-05 3 1  ON 36
ci_38                 4.795954e-06 3 1  ON 37
ci_39                -5.437937e-04 3 1  ON 38
ci_40                -1.361885e-03 3 1  ON 39
ci_41                -3.156900e-04 3 1  ON 40
ci_42                 2.390959e-04 3 1  ON 41
ci_43                -1.682289e-03 3 1  ON 42
ci_44                -2.392492e-03 3 1  ON 43
ci_45                -2.128698e-04 3 1  ON 44
ci_46                -1.022298e-03 3 1  ON 45
ci_47                 3.340903e-04 3 1  ON 46
ci_48                 2.407530e-04 3 1  ON 47
ci_49                -1.037718e-03 3 1  ON 48
ci_50                -8.342916e-04 3 1  ON 49
ci_51                -1.012862e-04 3 1  ON 50
ci_52                 7.916844e-04 3 1  ON 51
ci_53                -9.154354e-04 3 1  ON 52
ci_54                -8.391855e-04 3 1  ON 53
ci_55                -1.541123e-03 3 1  ON 54
ci_56                 1.691427e-03 3 1  ON 55
ci_57                 2.171190e-03 3 1  ON 56
ci_58                -1.541479e-03 3 1  ON 57
ci_59                -1.578661e-03 3 1  ON 58
ci_60                -8.527817e-04 3 1  ON 59
ci_61                 2.327706e-04 3 1  ON 60
ci_62                -7.758815e-04 3 1  ON 61
ci_63                -3.591645e-04 3 1  ON 62
ci_64                 2.293254e-04 3 1  ON 63
ci_65                -8.195540e-05 3 1  ON 64
ci_66                -5.195382e-04 3 1  ON 65
ci_67                -6.376533e-04 3 1  ON 66
ci_68                 1.505145e-04 3 1  ON 67
ci_69                -1.732989e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.7452
    reference variance = 0.302278
====================================================
  Execution time = 4.1485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8826e-01
  Total weights = 1.9641e+06
  Execution time = 6.1139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478529531504
                                         uncertainty =       0.006582995283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478529531504
                                         uncertainty =       0.006582995283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489140057
  error estimate for blocks of size 2^( 2) =       0.000510232598
  error estimate for blocks of size 2^( 3) =       0.000530863510
  error estimate for blocks of size 2^( 4) =       0.000545814594
  error estimate for blocks of size 2^( 5) =       0.000556182990
  error estimate for blocks of size 2^( 6) =       0.000561751756
  error estimate for blocks of size 2^( 7) =       0.000563087027

      target function =      -0.442097801304
              le_mean =     -22.819693940836
             les_mean =     521.879633563171
             stat err =       0.000556709092
             autocorr =       1.295359064411
   target nu stat err =       0.000556709092
   target dn stat err =       0.559214772760
      target stat err =       0.107105715557
              std dev =       0.691748502246
             le_variance =       0.478515990360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470218831303
                                         uncertainty =       0.002531678656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470218831303
                                         uncertainty =       0.002531678656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484876085
  error estimate for blocks of size 2^( 2) =       0.000506105400
  error estimate for blocks of size 2^( 3) =       0.000526861856
  error estimate for blocks of size 2^( 4) =       0.000541933012
  error estimate for blocks of size 2^( 5) =       0.000552233802
  error estimate for blocks of size 2^( 6) =       0.000557988987
  error estimate for blocks of size 2^( 7) =       0.000559648713

      target function =      -0.652590578395
              le_mean =     -22.819587406688
             les_mean =     521.221833002852
             stat err =       0.000552951128
             autocorr =       1.300504826741
   target nu stat err =       0.000552951128
   target dn stat err =       0.005825371537
      target stat err =       0.002320421488
              std dev =       0.685718335282
             le_variance =       0.470209635342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476950141750
                                         uncertainty =       0.004022564021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476950141750
                                         uncertainty =       0.004022564021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488330099
  error estimate for blocks of size 2^( 2) =       0.000509456698
  error estimate for blocks of size 2^( 3) =       0.000530120285
  error estimate for blocks of size 2^( 4) =       0.000545063117
  error estimate for blocks of size 2^( 5) =       0.000555405499
  error estimate for blocks of size 2^( 6) =       0.000561306723
  error estimate for blocks of size 2^( 7) =       0.000563035764

      target function =      -0.462358857110
              le_mean =     -22.819703979410
             les_mean =     521.808892037566
             stat err =       0.000556202776
             autocorr =       1.297296708296
   target nu stat err =       0.000556202776
   target dn stat err =       0.471899808756
      target stat err =       0.097534030877
              std dev =       0.690603049574
             le_variance =       0.476932572081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470205135316
                                         uncertainty =       0.002525251261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470205135316
                                         uncertainty =       0.002525251261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484869066
  error estimate for blocks of size 2^( 2) =       0.000506098286
  error estimate for blocks of size 2^( 3) =       0.000526854526
  error estimate for blocks of size 2^( 4) =       0.000541925352
  error estimate for blocks of size 2^( 5) =       0.000552225121
  error estimate for blocks of size 2^( 6) =       0.000557978254
  error estimate for blocks of size 2^( 7) =       0.000559637042

      target function =      -0.652598123451
              le_mean =     -22.819587504131
             les_mean =     521.221818624874
             stat err =       0.000552941442
             autocorr =       1.300496917610
   target nu stat err =       0.000552941442
   target dn stat err =       0.005789037927
      target stat err =       0.002306301260
              std dev =       0.685708408483
             le_variance =       0.470196021465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.442097801304        initial
     3.5527e-05     3.5527e-04             4.5520e-03        -0.652590578395
     1.4211e-04     1.4211e-03             4.5294e-03        -0.462358857110
     5.6843e-04     5.6843e-03             4.4412e-03        -0.652598123451  <--

*****************************************************************************
Applying the update for shift_i =   5.6843e-04     and shift_s =   5.6843e-03
*****************************************************************************

  Execution time = 7.1214e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_01                 1.146724e-01 3 1  ON 0
ci_02                -2.488015e-02 3 1  ON 1
ci_03                -2.392642e-02 3 1  ON 2
ci_04                 2.256675e-02 3 1  ON 3
ci_05                -1.998495e-02 3 1  ON 4
ci_06                -2.130868e-02 3 1  ON 5
ci_07                 2.585080e-02 3 1  ON 6
ci_08                -4.067705e-03 3 1  ON 7
ci_09                -7.695526e-03 3 1  ON 8
ci_10                -7.004048e-03 3 1  ON 9
ci_11                 1.347172e-02 3 1  ON 10
ci_12                 6.947015e-03 3 1  ON 11
ci_13                 9.656248e-03 3 1  ON 12
ci_14                 1.495064e-02 3 1  ON 13
ci_15                 7.499991e-03 3 1  ON 14
ci_16                 6.299959e-03 3 1  ON 15
ci_17                -5.619166e-03 3 1  ON 16
ci_18                -4.373874e-03 3 1  ON 17
ci_19                 8.023610e-03 3 1  ON 18
ci_20                 6.314752e-03 3 1  ON 19
ci_21                 7.836653e-03 3 1  ON 20
ci_22                 7.078729e-03 3 1  ON 21
ci_23                 3.729685e-03 3 1  ON 22
ci_24                 4.734321e-03 3 1  ON 23
ci_25                 3.059898e-03 3 1  ON 24
ci_26                 3.036320e-03 3 1  ON 25
ci_27                 3.358768e-03 3 1  ON 26
ci_28                 1.416258e-03 3 1  ON 27
ci_29                 1.880230e-03 3 1  ON 28
ci_30                -8.197250e-04 3 1  ON 29
ci_31                -1.730109e-03 3 1  ON 30
ci_32                -9.525820e-04 3 1  ON 31
ci_33                -1.705079e-03 3 1  ON 32
ci_34                 8.507258e-05 3 1  ON 33
ci_35                 1.105843e-03 3 1  ON 34
ci_36                -8.278910e-04 3 1  ON 35
ci_37                 9.053698e-06 3 1  ON 36
ci_38                 7.600190e-06 3 1  ON 37
ci_39                -5.478131e-04 3 1  ON 38
ci_40                -1.369025e-03 3 1  ON 39
ci_41                -3.171279e-04 3 1  ON 40
ci_42                 2.227669e-04 3 1  ON 41
ci_43                -1.686402e-03 3 1  ON 42
ci_44                -2.357704e-03 3 1  ON 43
ci_45                -2.069489e-04 3 1  ON 44
ci_46                -1.026369e-03 3 1  ON 45
ci_47                 3.401854e-04 3 1  ON 46
ci_48                 2.576139e-04 3 1  ON 47
ci_49                -1.038079e-03 3 1  ON 48
ci_50                -8.307586e-04 3 1  ON 49
ci_51                -9.365107e-05 3 1  ON 50
ci_52                 7.741571e-04 3 1  ON 51
ci_53                -9.095557e-04 3 1  ON 52
ci_54                -8.465277e-04 3 1  ON 53
ci_55                -1.524556e-03 3 1  ON 54
ci_56                 1.700105e-03 3 1  ON 55
ci_57                 2.166140e-03 3 1  ON 56
ci_58                -1.537060e-03 3 1  ON 57
ci_59                -1.569494e-03 3 1  ON 58
ci_60                -8.085146e-04 3 1  ON 59
ci_61                 1.619878e-04 3 1  ON 60
ci_62                -7.656634e-04 3 1  ON 61
ci_63                -3.611747e-04 3 1  ON 62
ci_64                 2.282878e-04 3 1  ON 63
ci_65                -8.032016e-05 3 1  ON 64
ci_66                -5.192182e-04 3 1  ON 65
ci_67                -6.321773e-04 3 1  ON 66
ci_68                 1.382931e-04 3 1  ON 67
ci_69                -1.737338e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2154e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8535
    reference variance = 0.661963
====================================================
  Execution time = 4.3875e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9752e-01
  Total weights = 1.964241558e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480820801024
                                         uncertainty =       0.006874999444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480820801024
                                         uncertainty =       0.006874999444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490334834
  error estimate for blocks of size 2^( 2) =       0.000511661917
  error estimate for blocks of size 2^( 3) =       0.000531936656
  error estimate for blocks of size 2^( 4) =       0.000546828925
  error estimate for blocks of size 2^( 5) =       0.000556956193
  error estimate for blocks of size 2^( 6) =       0.000562134606
  error estimate for blocks of size 2^( 7) =       0.000565288014

      target function =      -0.648784888491
              le_mean =     -22.818882586239
             les_mean =     521.198924006326
             stat err =       0.000557801934
             autocorr =       1.294119968468
   target nu stat err =       0.000557801934
   target dn stat err =       0.007879742311
      target stat err =       0.003086170059
              std dev =       0.693438171693
             le_variance =       0.480856497961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281888258624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648799016072       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649169231899       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649226581095       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649240875092       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649247641672       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649249818707       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649254345505       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649254273755       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649254522093       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649254592082       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.649254517552       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.649254481179       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 7.946823e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648799016072       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649165428431       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649221942921       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649235955800       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649242558853       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649244657313       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649249044870       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649248964877       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649249202665       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649249268991       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.649249197043       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.649249162529       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 7.856112e-03

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.648799016072       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.649150964612       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.649204356634       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.649217334483       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.649223343923       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.649225165583       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.649229060757       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.649228955770       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.649229157568       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.649229211607       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.649229148883       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.649229120670       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 7.513143e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.703819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1534e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_01                 1.080966e-01 3 1  ON 0
ci_02                -2.436062e-02 3 1  ON 1
ci_03                -2.287730e-02 3 1  ON 2
ci_04                 2.284231e-02 3 1  ON 3
ci_05                -2.036828e-02 3 1  ON 4
ci_06                -2.102268e-02 3 1  ON 5
ci_07                 2.548587e-02 3 1  ON 6
ci_08                -4.247079e-03 3 1  ON 7
ci_09                -7.920538e-03 3 1  ON 8
ci_10                -1.271592e-02 3 1  ON 9
ci_11                 1.328490e-02 3 1  ON 10
ci_12                 7.540095e-03 3 1  ON 11
ci_13                 1.121884e-02 3 1  ON 12
ci_14                 1.416447e-02 3 1  ON 13
ci_15                 5.394603e-03 3 1  ON 14
ci_16                 4.428692e-03 3 1  ON 15
ci_17                -3.179128e-03 3 1  ON 16
ci_18                -6.602451e-03 3 1  ON 17
ci_19                 9.473626e-03 3 1  ON 18
ci_20                 5.098881e-03 3 1  ON 19
ci_21                 6.669748e-03 3 1  ON 20
ci_22                 7.669441e-03 3 1  ON 21
ci_23                 5.213905e-03 3 1  ON 22
ci_24                 6.167388e-03 3 1  ON 23
ci_25                 3.211788e-03 3 1  ON 24
ci_26                -4.819792e-03 3 1  ON 25
ci_27                 1.813928e-03 3 1  ON 26
ci_28                 1.705055e-03 3 1  ON 27
ci_29                 6.748264e-04 3 1  ON 28
ci_30                 1.806131e-03 3 1  ON 29
ci_31                -2.545082e-03 3 1  ON 30
ci_32                -9.630176e-04 3 1  ON 31
ci_33                -7.121479e-04 3 1  ON 32
ci_34                 1.135167e-03 3 1  ON 33
ci_35                 7.268286e-04 3 1  ON 34
ci_36                -1.356297e-03 3 1  ON 35
ci_37                -1.280462e-03 3 1  ON 36
ci_38                 4.098407e-04 3 1  ON 37
ci_39                -5.349855e-04 3 1  ON 38
ci_40                -1.499506e-03 3 1  ON 39
ci_41                -9.639700e-04 3 1  ON 40
ci_42                -2.025699e-04 3 1  ON 41
ci_43                -2.513366e-03 3 1  ON 42
ci_44                -4.755342e-03 3 1  ON 43
ci_45                 3.376006e-04 3 1  ON 44
ci_46                 2.848175e-04 3 1  ON 45
ci_47                -2.458054e-04 3 1  ON 46
ci_48                 2.289005e-03 3 1  ON 47
ci_49                 5.461378e-04 3 1  ON 48
ci_50                -1.138427e-03 3 1  ON 49
ci_51                -3.752443e-05 3 1  ON 50
ci_52                 7.474578e-04 3 1  ON 51
ci_53                -7.806890e-04 3 1  ON 52
ci_54                 1.402987e-04 3 1  ON 53
ci_55                -6.529413e-04 3 1  ON 54
ci_56                 2.556054e-03 3 1  ON 55
ci_57                 1.521713e-03 3 1  ON 56
ci_58                 5.799133e-04 3 1  ON 57
ci_59                 1.197662e-03 3 1  ON 58
ci_60                -2.315857e-03 3 1  ON 59
ci_61                 1.930602e-03 3 1  ON 60
ci_62                -8.351808e-04 3 1  ON 61
ci_63                 2.111203e-04 3 1  ON 62
ci_64                 1.158622e-03 3 1  ON 63
ci_65                -1.460182e-03 3 1  ON 64
ci_66                 4.411857e-04 3 1  ON 65
ci_67                -1.902456e-03 3 1  ON 66
ci_68                -1.539898e-03 3 1  ON 67
ci_69                -1.833394e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8619
    reference variance = 0.398251
====================================================
  Execution time = 4.1322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8295e-01
  Total weights = 1.9643e+06
  Execution time = 5.8988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000187283
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485042845814
                                         uncertainty =       0.006438326242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485042845814
                                         uncertainty =       0.006438326242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492454938
  error estimate for blocks of size 2^( 2) =       0.000513670978
  error estimate for blocks of size 2^( 3) =       0.000534264430
  error estimate for blocks of size 2^( 4) =       0.000550104632
  error estimate for blocks of size 2^( 5) =       0.000559787713
  error estimate for blocks of size 2^( 6) =       0.000566925877
  error estimate for blocks of size 2^( 7) =       0.000570796906

      target function =      -0.527879206752
              le_mean =     -22.819921986050
             les_mean =     521.606008407544
             stat err =       0.000561903782
             autocorr =       1.301939839132
   target nu stat err =       0.000561903782
   target dn stat err =       0.212671418034
      target stat err =       0.055474683128
              std dev =       0.696436452800
             le_variance =       0.485023732788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470318034998
                                         uncertainty =       0.002075090961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470318034998
                                         uncertainty =       0.002075090961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484903827
  error estimate for blocks of size 2^( 2) =       0.000506500496
  error estimate for blocks of size 2^( 3) =       0.000527487395
  error estimate for blocks of size 2^( 4) =       0.000543634347
  error estimate for blocks of size 2^( 5) =       0.000553504070
  error estimate for blocks of size 2^( 6) =       0.000560733883
  error estimate for blocks of size 2^( 7) =       0.000564977976

      target function =      -0.649661847768
              le_mean =     -22.819571154791
             les_mean =     521.228465557925
             stat err =       0.000555712569
             autocorr =       1.313376424841
   target nu stat err =       0.000555712569
   target dn stat err =       0.012872463378
      target stat err =       0.005039909353
              std dev =       0.685757567995
             le_variance =       0.470263442063

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000186358
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478849529932
                                         uncertainty =       0.004221948017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478849529932
                                         uncertainty =       0.004221948017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489276665
  error estimate for blocks of size 2^( 2) =       0.000510773746
  error estimate for blocks of size 2^( 3) =       0.000531752770
  error estimate for blocks of size 2^( 4) =       0.000547888950
  error estimate for blocks of size 2^( 5) =       0.000557516501
  error estimate for blocks of size 2^( 6) =       0.000564774364
  error estimate for blocks of size 2^( 7) =       0.000569169456

      target function =      -0.617581375150
              le_mean =     -22.819867430131
             les_mean =     521.327543890315
             stat err =       0.000559837318
             autocorr =       1.309226180377
   target nu stat err =       0.000559837318
   target dn stat err =       0.043708551003
      target stat err =       0.015446926164
              std dev =       0.691941695962
             le_variance =       0.478783310611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470280460488
                                         uncertainty =       0.002074437103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470280460488
                                         uncertainty =       0.002074437103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484884644
  error estimate for blocks of size 2^( 2) =       0.000506476622
  error estimate for blocks of size 2^( 3) =       0.000527455732
  error estimate for blocks of size 2^( 4) =       0.000543596500
  error estimate for blocks of size 2^( 5) =       0.000553459443
  error estimate for blocks of size 2^( 6) =       0.000560685246
  error estimate for blocks of size 2^( 7) =       0.000564923284

      target function =      -0.654599678696
              le_mean =     -22.819575260591
             les_mean =     521.216205756587
             stat err =       0.000555666118
             autocorr =       1.313260771107
   target nu stat err =       0.000555666118
   target dn stat err =       0.002732410639
      target stat err =       0.001134777666
              std dev =       0.685730439961
             le_variance =       0.470226236290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.527879206752        initial
     1.4211e-04     1.4211e-03             7.9468e-03        -0.649661847768
     5.6843e-04     5.6843e-03             7.8561e-03        -0.617581375150
     2.2737e-03     2.2737e-02             7.5131e-03        -0.654599678696  <--

*****************************************************************************
Applying the update for shift_i =   2.2737e-03     and shift_s =   2.2737e-02
*****************************************************************************

  Execution time = 7.0918e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_01                 1.085615e-01 3 1  ON 0
ci_02                -2.437299e-02 3 1  ON 1
ci_03                -2.292160e-02 3 1  ON 2
ci_04                 2.283414e-02 3 1  ON 3
ci_05                -2.033540e-02 3 1  ON 4
ci_06                -2.101566e-02 3 1  ON 5
ci_07                 2.549915e-02 3 1  ON 6
ci_08                -4.244634e-03 3 1  ON 7
ci_09                -7.908503e-03 3 1  ON 8
ci_10                -1.244430e-02 3 1  ON 9
ci_11                 1.329025e-02 3 1  ON 10
ci_12                 7.513921e-03 3 1  ON 11
ci_13                 1.110599e-02 3 1  ON 12
ci_14                 1.423527e-02 3 1  ON 13
ci_15                 5.489889e-03 3 1  ON 14
ci_16                 4.508083e-03 3 1  ON 15
ci_17                -3.278573e-03 3 1  ON 16
ci_18                -6.505580e-03 3 1  ON 17
ci_19                 9.422038e-03 3 1  ON 18
ci_20                 5.144668e-03 3 1  ON 19
ci_21                 6.740938e-03 3 1  ON 20
ci_22                 7.612386e-03 3 1  ON 21
ci_23                 5.160247e-03 3 1  ON 22
ci_24                 6.080308e-03 3 1  ON 23
ci_25                 3.207335e-03 3 1  ON 24
ci_26                -4.476823e-03 3 1  ON 25
ci_27                 1.882604e-03 3 1  ON 26
ci_28                 1.697598e-03 3 1  ON 27
ci_29                 7.332624e-04 3 1  ON 28
ci_30                 1.642674e-03 3 1  ON 29
ci_31                -2.503631e-03 3 1  ON 30
ci_32                -9.606317e-04 3 1  ON 31
ci_33                -7.503389e-04 3 1  ON 32
ci_34                 1.081958e-03 3 1  ON 33
ci_35                 7.375636e-04 3 1  ON 34
ci_36                -1.335677e-03 3 1  ON 35
ci_37                -1.234020e-03 3 1  ON 36
ci_38                 3.974501e-04 3 1  ON 37
ci_39                -5.372357e-04 3 1  ON 38
ci_40                -1.496573e-03 3 1  ON 39
ci_41                -9.399897e-04 3 1  ON 40
ci_42                -1.868284e-04 3 1  ON 41
ci_43                -2.468060e-03 3 1  ON 42
ci_44                -4.653583e-03 3 1  ON 43
ci_45                 3.166471e-04 3 1  ON 44
ci_46                 2.332039e-04 3 1  ON 45
ci_47                -2.110441e-04 3 1  ON 46
ci_48                 2.168971e-03 3 1  ON 47
ci_49                 4.879450e-04 3 1  ON 48
ci_50                -1.128135e-03 3 1  ON 49
ci_51                -3.701222e-05 3 1  ON 50
ci_52                 7.488833e-04 3 1  ON 51
ci_53                -7.878957e-04 3 1  ON 52
ci_54                 9.630028e-05 3 1  ON 53
ci_55                -6.907041e-04 3 1  ON 54
ci_56                 2.527512e-03 3 1  ON 55
ci_57                 1.544683e-03 3 1  ON 56
ci_58                 4.960071e-04 3 1  ON 57
ci_59                 1.087285e-03 3 1  ON 58
ci_60                -2.198576e-03 3 1  ON 59
ci_61                 1.805210e-03 3 1  ON 60
ci_62                -8.322350e-04 3 1  ON 61
ci_63                 1.904870e-04 3 1  ON 62
ci_64                 1.125360e-03 3 1  ON 63
ci_65                -1.407945e-03 3 1  ON 64
ci_66                 4.066990e-04 3 1  ON 65
ci_67                -1.850990e-03 3 1  ON 66
ci_68                -1.475024e-03 3 1  ON 67
ci_69                -1.828713e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2246e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8603
    reference variance = 0.34822
====================================================
  Execution time = 4.2515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8418e-01
  Total weights = 1.964155402e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470280267021
                                         uncertainty =       0.001761939090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470280267021
                                         uncertainty =       0.001761939090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484890769
  error estimate for blocks of size 2^( 2) =       0.000506725432
  error estimate for blocks of size 2^( 3) =       0.000527300519
  error estimate for blocks of size 2^( 4) =       0.000543178614
  error estimate for blocks of size 2^( 5) =       0.000553508034
  error estimate for blocks of size 2^( 6) =       0.000561702098
  error estimate for blocks of size 2^( 7) =       0.000566314228

      target function =      -0.654159214521
              le_mean =     -22.819384001191
             les_mean =     521.208467319725
             stat err =       0.000556175743
             autocorr =       1.315637535540
   target nu stat err =       0.000556175743
   target dn stat err =       0.002706242749
      target stat err =       0.001123318866
              std dev =       0.685739101498
             le_variance =       0.470238115323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281938400119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654160724829       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654497094010       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654544381564       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654556576137       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654563229334       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654565122306       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654567034956       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654568224701       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654568245131       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654568368283       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654568208523       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654568122128       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654568122560       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 7.381144e-03

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654160724829       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654483650301       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654528116355       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654539442712       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654545537589       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654547177612       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654548831300       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654549856168       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654549859485       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654549958254       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654549819873       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654549748398       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654549748556       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 7.054685e-03

solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654160724829       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654439135247       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654474880105       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654483623028       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654488114674       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654489103216       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654490120071       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654490745288       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654490719753       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654490766801       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654490682982       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654490645914       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 5.995215e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.709331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0230e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_01                 1.105355e-01 3 1  ON 0
ci_02                -2.347897e-02 3 1  ON 1
ci_03                -2.350448e-02 3 1  ON 2
ci_04                 2.163409e-02 3 1  ON 3
ci_05                -2.208026e-02 3 1  ON 4
ci_06                -2.113387e-02 3 1  ON 5
ci_07                 2.567842e-02 3 1  ON 6
ci_08                -4.047092e-03 3 1  ON 7
ci_09                -6.212259e-03 3 1  ON 8
ci_10                -7.082911e-03 3 1  ON 9
ci_11                 1.302296e-02 3 1  ON 10
ci_12                 7.230531e-03 3 1  ON 11
ci_13                 1.004168e-02 3 1  ON 12
ci_14                 1.695118e-02 3 1  ON 13
ci_15                 7.014232e-03 3 1  ON 14
ci_16                 6.689332e-03 3 1  ON 15
ci_17                -7.223042e-03 3 1  ON 16
ci_18                -6.839409e-03 3 1  ON 17
ci_19                 9.116098e-03 3 1  ON 18
ci_20                 6.784150e-03 3 1  ON 19
ci_21                 6.623034e-03 3 1  ON 20
ci_22                 8.406237e-03 3 1  ON 21
ci_23                 4.139293e-03 3 1  ON 22
ci_24                 4.335041e-03 3 1  ON 23
ci_25                 3.150554e-03 3 1  ON 24
ci_26                 2.577862e-03 3 1  ON 25
ci_27                 3.036069e-03 3 1  ON 26
ci_28                 1.675182e-03 3 1  ON 27
ci_29                 7.291387e-04 3 1  ON 28
ci_30                -7.319474e-04 3 1  ON 29
ci_31                 7.263185e-05 3 1  ON 30
ci_32                 2.065281e-04 3 1  ON 31
ci_33                -1.029607e-03 3 1  ON 32
ci_34                 6.899652e-04 3 1  ON 33
ci_35                 1.368278e-03 3 1  ON 34
ci_36                -8.794451e-04 3 1  ON 35
ci_37                -3.267469e-04 3 1  ON 36
ci_38                 4.139489e-04 3 1  ON 37
ci_39                -6.288357e-04 3 1  ON 38
ci_40                -1.377333e-03 3 1  ON 39
ci_41                -1.607962e-03 3 1  ON 40
ci_42                -1.357090e-03 3 1  ON 41
ci_43                -2.310268e-03 3 1  ON 42
ci_44                -2.650064e-03 3 1  ON 43
ci_45                 1.025249e-04 3 1  ON 44
ci_46                 9.756546e-05 3 1  ON 45
ci_47                 1.854960e-03 3 1  ON 46
ci_48                 9.226397e-04 3 1  ON 47
ci_49                -7.463646e-04 3 1  ON 48
ci_50                -8.451445e-04 3 1  ON 49
ci_51                -1.160549e-04 3 1  ON 50
ci_52                 2.045782e-04 3 1  ON 51
ci_53                -9.752897e-04 3 1  ON 52
ci_54                -2.591075e-03 3 1  ON 53
ci_55                -9.812095e-04 3 1  ON 54
ci_56                 2.467202e-03 3 1  ON 55
ci_57                 3.142225e-03 3 1  ON 56
ci_58                -5.422606e-04 3 1  ON 57
ci_59                 2.391867e-04 3 1  ON 58
ci_60                 1.255314e-03 3 1  ON 59
ci_61                -7.347490e-04 3 1  ON 60
ci_62                -2.610902e-04 3 1  ON 61
ci_63                -6.427059e-04 3 1  ON 62
ci_64                -4.323434e-04 3 1  ON 63
ci_65                -3.771663e-04 3 1  ON 64
ci_66                -1.077367e-03 3 1  ON 65
ci_67                -5.845440e-04 3 1  ON 66
ci_68                -5.148065e-04 3 1  ON 67
ci_69                -1.479088e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.9347
    reference variance = 0.827179
====================================================
  Execution time = 4.1416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8610e-01
  Total weights = 1.9640e+06
  Execution time = 5.9034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000618463
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514959897365
                                         uncertainty =       0.021844131180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514959897365
                                         uncertainty =       0.021844131180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507444883
  error estimate for blocks of size 2^( 2) =       0.000527893705
  error estimate for blocks of size 2^( 3) =       0.000547200949
  error estimate for blocks of size 2^( 4) =       0.000561619726
  error estimate for blocks of size 2^( 5) =       0.000570844985
  error estimate for blocks of size 2^( 6) =       0.000574464502
  error estimate for blocks of size 2^( 7) =       0.000577822283

      target function =      -0.438222648366
              le_mean =     -22.818700564320
             les_mean =     521.944489598694
             stat err =       0.000571187874
             autocorr =       1.267010468736
   target nu stat err =       0.000571187874
   target dn stat err =       0.336952000817
      target stat err =       0.061001776945
              std dev =       0.717635435147
             le_variance =       0.515000617778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469851081382
                                         uncertainty =       0.002394578836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469851081382
                                         uncertainty =       0.002394578836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484719381
  error estimate for blocks of size 2^( 2) =       0.000506157382
  error estimate for blocks of size 2^( 3) =       0.000526209407
  error estimate for blocks of size 2^( 4) =       0.000541946914
  error estimate for blocks of size 2^( 5) =       0.000550905075
  error estimate for blocks of size 2^( 6) =       0.000555151194
  error estimate for blocks of size 2^( 7) =       0.000558922963

      target function =      -0.652105239251
              le_mean =     -22.818513753084
             les_mean =     521.173403745732
             stat err =       0.000551731536
             autocorr =       1.295611657491
   target nu stat err =       0.000551731536
   target dn stat err =       0.003619250324
      target stat err =       0.001461466215
              std dev =       0.685496722638
             le_variance =       0.469905756747

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000616746
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519856687789
                                         uncertainty =       0.040885003761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519856687789
                                         uncertainty =       0.040885003761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509841363
  error estimate for blocks of size 2^( 2) =       0.000530034205
  error estimate for blocks of size 2^( 3) =       0.000549164309
  error estimate for blocks of size 2^( 4) =       0.000564311031
  error estimate for blocks of size 2^( 5) =       0.000572757550
  error estimate for blocks of size 2^( 6) =       0.000576621671
  error estimate for blocks of size 2^( 7) =       0.000580018105

      target function =      -0.224200582078
              le_mean =     -22.818692879745
             les_mean =     523.436877235364
             stat err =       0.000573427089
             autocorr =       1.264987628559
   target nu stat err =       0.000573427089
   target dn stat err =       1.887101332958
      target stat err =       0.108114186884
              std dev =       0.721024570484
             le_variance =       0.519876431241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469901131719
                                         uncertainty =       0.002414805787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469901131719
                                         uncertainty =       0.002414805787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484747275
  error estimate for blocks of size 2^( 2) =       0.000506180649
  error estimate for blocks of size 2^( 3) =       0.000526225309
  error estimate for blocks of size 2^( 4) =       0.000541951208
  error estimate for blocks of size 2^( 5) =       0.000550917854
  error estimate for blocks of size 2^( 6) =       0.000555145430
  error estimate for blocks of size 2^( 7) =       0.000558920306

      target function =      -0.651826873573
              le_mean =     -22.818524231920
             les_mean =     521.174597450494
             stat err =       0.000551733699
             autocorr =       1.295472710648
   target nu stat err =       0.000551733699
   target dn stat err =       0.003464115157
      target stat err =       0.001400987107
              std dev =       0.685536171030
             le_variance =       0.469959841791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.438222648366        initial
     5.6843e-04     5.6843e-03             7.3811e-03        -0.652105239251  <--
     2.2737e-03     2.2737e-02             7.0547e-03        -0.224200582078
     9.0949e-03     9.0949e-02             5.9952e-03        -0.651826873573

*****************************************************************************
Applying the update for shift_i =   5.6843e-04     and shift_s =   5.6843e-03
*****************************************************************************

  Execution time = 7.1014e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_01                 1.106823e-01 3 1  ON 0
ci_02                -2.343786e-02 3 1  ON 1
ci_03                -2.352472e-02 3 1  ON 2
ci_04                 2.158454e-02 3 1  ON 3
ci_05                -2.216396e-02 3 1  ON 4
ci_06                -2.113476e-02 3 1  ON 5
ci_07                 2.567587e-02 3 1  ON 6
ci_08                -4.041119e-03 3 1  ON 7
ci_09                -6.124350e-03 3 1  ON 8
ci_10                -6.809432e-03 3 1  ON 9
ci_11                 1.300923e-02 3 1  ON 10
ci_12                 7.215918e-03 3 1  ON 11
ci_13                 9.973186e-03 3 1  ON 12
ci_14                 1.720924e-02 3 1  ON 13
ci_15                 7.087981e-03 3 1  ON 14
ci_16                 6.791013e-03 3 1  ON 15
ci_17                -7.404496e-03 3 1  ON 16
ci_18                -6.859486e-03 3 1  ON 17
ci_19                 9.104589e-03 3 1  ON 18
ci_20                 6.850765e-03 3 1  ON 19
ci_21                 6.626103e-03 3 1  ON 20
ci_22                 8.426175e-03 3 1  ON 21
ci_23                 4.099577e-03 3 1  ON 22
ci_24                 4.231655e-03 3 1  ON 23
ci_25                 3.150263e-03 3 1  ON 24
ci_26                 2.904322e-03 3 1  ON 25
ci_27                 3.093228e-03 3 1  ON 26
ci_28                 1.677842e-03 3 1  ON 27
ci_29                 7.304982e-04 3 1  ON 28
ci_30                -8.747761e-04 3 1  ON 29
ci_31                 2.206517e-04 3 1  ON 30
ci_32                 2.530178e-04 3 1  ON 31
ci_33                -1.039783e-03 3 1  ON 32
ci_34                 6.698483e-04 3 1  ON 33
ci_35                 1.391215e-03 3 1  ON 34
ci_36                -8.604946e-04 3 1  ON 35
ci_37                -2.918137e-04 3 1  ON 36
ci_38                 4.157521e-04 3 1  ON 37
ci_39                -6.346297e-04 3 1  ON 38
ci_40                -1.372486e-03 3 1  ON 39
ci_41                -1.635716e-03 3 1  ON 40
ci_42                -1.405030e-03 3 1  ON 41
ci_43                -2.297791e-03 3 1  ON 42
ci_44                -2.560569e-03 3 1  ON 43
ci_45                 9.406460e-05 3 1  ON 44
ci_46                 9.190163e-05 3 1  ON 45
ci_47                 1.973637e-03 3 1  ON 46
ci_48                 8.413876e-04 3 1  ON 47
ci_49                -7.948474e-04 3 1  ON 48
ci_50                -8.351637e-04 3 1  ON 49
ci_51                -1.190803e-04 3 1  ON 50
ci_52                 1.843006e-04 3 1  ON 51
ci_53                -9.827161e-04 3 1  ON 52
ci_54                -2.714791e-03 3 1  ON 53
ci_55                -9.999776e-04 3 1  ON 54
ci_56                 2.465701e-03 3 1  ON 55
ci_57                 3.202106e-03 3 1  ON 56
ci_58                -5.900344e-04 3 1  ON 57
ci_59                 2.092290e-04 3 1  ON 58
ci_60                 1.562103e-03 3 1  ON 59
ci_61                -9.331990e-04 3 1  ON 60
ci_62                -2.413996e-04 3 1  ON 61
ci_63                -6.730782e-04 3 1  ON 62
ci_64                -4.949924e-04 3 1  ON 63
ci_65                -3.355865e-04 3 1  ON 64
ci_66                -1.132517e-03 3 1  ON 65
ci_67                -5.336444e-04 3 1  ON 66
ci_68                -4.774780e-04 3 1  ON 67
ci_69                -1.461851e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2125e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8479
    reference variance = 0.379138
====================================================
  Execution time = 4.4061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9109e-01
  Total weights = 1.964384165e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474764458563
                                         uncertainty =       0.005613344085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474764458563
                                         uncertainty =       0.005613344085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487213362
  error estimate for blocks of size 2^( 2) =       0.000508552591
  error estimate for blocks of size 2^( 3) =       0.000529230411
  error estimate for blocks of size 2^( 4) =       0.000545684276
  error estimate for blocks of size 2^( 5) =       0.000556587141
  error estimate for blocks of size 2^( 6) =       0.000561928694
  error estimate for blocks of size 2^( 7) =       0.000565779526

      target function =      -0.651093921681
              le_mean =     -22.818029336008
             les_mean =     521.153549422793
             stat err =       0.000557494909
             autocorr =       1.309312852326
   target nu stat err =       0.000557494909
   target dn stat err =       0.006746936988
      target stat err =       0.002664739114
              std dev =       0.689023744122
             le_variance =       0.474753719964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281802933601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651104260486       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651715325126       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651846501596       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651872680628       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651886365378       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651895251212       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651899409230       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651900984884       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651900885736       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651901038916       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651900955348       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651900909778       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 8.196757e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651104260486       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651709605287       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651839020751       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651864739304       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651878098464       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651886734988       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651890717782       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651892220216       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651892120031       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651892266297       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651892185791       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651892142283       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 8.112731e-03

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.651104260486       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651687756823       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651810552697       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651834564642       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651846739481       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651854483383       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651857860953       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651859115148       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651859013587       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651859136566       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651859066920       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.651859030496       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 7.792961e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.714184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1702e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_01                 1.134465e-01 3 1  ON 0
ci_02                -2.270228e-02 3 1  ON 1
ci_03                -2.107768e-02 3 1  ON 2
ci_04                 2.047588e-02 3 1  ON 3
ci_05                -1.675010e-02 3 1  ON 4
ci_06                -2.174681e-02 3 1  ON 5
ci_07                 2.575764e-02 3 1  ON 6
ci_08                -3.976011e-03 3 1  ON 7
ci_09                -7.631979e-03 3 1  ON 8
ci_10                -1.085324e-02 3 1  ON 9
ci_11                 1.377675e-02 3 1  ON 10
ci_12                 8.442034e-03 3 1  ON 11
ci_13                 1.448796e-02 3 1  ON 12
ci_14                 1.647060e-02 3 1  ON 13
ci_15                 6.342294e-03 3 1  ON 14
ci_16                 4.186830e-03 3 1  ON 15
ci_17                -3.960417e-03 3 1  ON 16
ci_18                -8.132923e-03 3 1  ON 17
ci_19                 9.517221e-03 3 1  ON 18
ci_20                 6.101696e-03 3 1  ON 19
ci_21                 9.450295e-03 3 1  ON 20
ci_22                 8.059390e-03 3 1  ON 21
ci_23                 4.490717e-03 3 1  ON 22
ci_24                 4.297641e-03 3 1  ON 23
ci_25                 4.029305e-03 3 1  ON 24
ci_26                -5.208410e-03 3 1  ON 25
ci_27                 2.980692e-03 3 1  ON 26
ci_28                 4.312665e-04 3 1  ON 27
ci_29                 2.262382e-03 3 1  ON 28
ci_30                 5.624271e-04 3 1  ON 29
ci_31                -2.864678e-04 3 1  ON 30
ci_32                -2.916052e-04 3 1  ON 31
ci_33                -1.366579e-03 3 1  ON 32
ci_34                 1.572101e-03 3 1  ON 33
ci_35                 2.104190e-03 3 1  ON 34
ci_36                -3.251569e-04 3 1  ON 35
ci_37                 5.462418e-04 3 1  ON 36
ci_38                -2.261556e-04 3 1  ON 37
ci_39                 8.845720e-04 3 1  ON 38
ci_40                 1.757219e-04 3 1  ON 39
ci_41                -8.154024e-04 3 1  ON 40
ci_42                -2.525983e-03 3 1  ON 41
ci_43                -6.685208e-03 3 1  ON 42
ci_44                -1.317691e-03 3 1  ON 43
ci_45                -1.300442e-03 3 1  ON 44
ci_46                -7.262630e-04 3 1  ON 45
ci_47                 1.224531e-03 3 1  ON 46
ci_48                 3.249844e-03 3 1  ON 47
ci_49                -1.026286e-03 3 1  ON 48
ci_50                 5.408201e-04 3 1  ON 49
ci_51                -1.943392e-04 3 1  ON 50
ci_52                 7.548126e-04 3 1  ON 51
ci_53                -1.671225e-03 3 1  ON 52
ci_54                -1.292256e-03 3 1  ON 53
ci_55                -8.060975e-04 3 1  ON 54
ci_56                 9.164686e-04 3 1  ON 55
ci_57                 1.867151e-03 3 1  ON 56
ci_58                -1.322103e-03 3 1  ON 57
ci_59                -4.529207e-03 3 1  ON 58
ci_60                -3.455173e-03 3 1  ON 59
ci_61                 5.172393e-03 3 1  ON 60
ci_62                 2.481682e-03 3 1  ON 61
ci_63                -8.633668e-04 3 1  ON 62
ci_64                -2.325091e-04 3 1  ON 63
ci_65                -1.166579e-03 3 1  ON 64
ci_66                -8.109398e-05 3 1  ON 65
ci_67                -2.678104e-04 3 1  ON 66
ci_68                -3.512480e-04 3 1  ON 67
ci_69                -3.703781e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8593
    reference variance = 0.677083
====================================================
  Execution time = 4.2786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8274e-01
  Total weights = 1.9640e+06
  Execution time = 5.9044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00523633
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478761894635
                                         uncertainty =       0.004680240998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478761894635
                                         uncertainty =       0.004680240998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489250926
  error estimate for blocks of size 2^( 2) =       0.000510673284
  error estimate for blocks of size 2^( 3) =       0.000531505586
  error estimate for blocks of size 2^( 4) =       0.000547287442
  error estimate for blocks of size 2^( 5) =       0.000558026646
  error estimate for blocks of size 2^( 6) =       0.000562319892
  error estimate for blocks of size 2^( 7) =       0.000563833196

      target function =      -0.624796783751
              le_mean =     -22.818983558785
             les_mean =     521.267288417177
             stat err =       0.000557866794
             autocorr =       1.300162723695
   target nu stat err =       0.000557866794
   target dn stat err =       0.023343985506
      target stat err =       0.008437554144
              std dev =       0.691905294906
             le_variance =       0.478732937119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469903256368
                                         uncertainty =       0.002730687628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469903256368
                                         uncertainty =       0.002730687628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484705286
  error estimate for blocks of size 2^( 2) =       0.000506382283
  error estimate for blocks of size 2^( 3) =       0.000527370684
  error estimate for blocks of size 2^( 4) =       0.000543323923
  error estimate for blocks of size 2^( 5) =       0.000554303114
  error estimate for blocks of size 2^( 6) =       0.000558868897
  error estimate for blocks of size 2^( 7) =       0.000560519837

      target function =      -0.654198036605
              le_mean =     -22.818427920372
             les_mean =     521.164127074213
             stat err =       0.000554253943
             autocorr =       1.307561335441
   target nu stat err =       0.000554253943
   target dn stat err =       0.003510321340
      target stat err =       0.001428913612
              std dev =       0.685476789739
             le_variance =       0.469878429270

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00517929
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493932698841
                                         uncertainty =       0.013011629289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493932698841
                                         uncertainty =       0.013011629289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496932051
  error estimate for blocks of size 2^( 2) =       0.000518201355
  error estimate for blocks of size 2^( 3) =       0.000538922136
  error estimate for blocks of size 2^( 4) =       0.000554883867
  error estimate for blocks of size 2^( 5) =       0.000565745753
  error estimate for blocks of size 2^( 6) =       0.000570513691
  error estimate for blocks of size 2^( 7) =       0.000573156112

      target function =      -0.603472844835
              le_mean =     -22.818783684176
             les_mean =     521.316645958694
             stat err =       0.000566074856
             autocorr =       1.297638470038
   target nu stat err =       0.000566074856
   target dn stat err =       0.071765614230
      target stat err =       0.024213231985
              std dev =       0.702768045984
             le_variance =       0.493882926457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469797245848
                                         uncertainty =       0.002725720940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469797245848
                                         uncertainty =       0.002725720940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484650708
  error estimate for blocks of size 2^( 2) =       0.000506324225
  error estimate for blocks of size 2^( 3) =       0.000527312771
  error estimate for blocks of size 2^( 4) =       0.000543258998
  error estimate for blocks of size 2^( 5) =       0.000554240744
  error estimate for blocks of size 2^( 6) =       0.000558796852
  error estimate for blocks of size 2^( 7) =       0.000560444502

      target function =      -0.654118354479
              le_mean =     -22.818431736925
             les_mean =     521.164505404813
             stat err =       0.000554185274
             autocorr =       1.307531801975
   target nu stat err =       0.000554185274
   target dn stat err =       0.003429746347
      target stat err =       0.001397604087
              std dev =       0.685399603880
             le_variance =       0.469772616999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.624796783751        initial
     1.4211e-04     1.4211e-03             8.1968e-03        -0.654198036605  <--
     5.6843e-04     5.6843e-03             8.1127e-03        -0.603472844835
     2.2737e-03     2.2737e-02             7.7930e-03        -0.654118354479

*****************************************************************************
Applying the update for shift_i =   1.4211e-04     and shift_s =   1.4211e-03
*****************************************************************************

  Execution time = 7.2408e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_01                 1.135079e-01 3 1  ON 0
ci_02                -2.269495e-02 3 1  ON 1
ci_03                -2.105054e-02 3 1  ON 2
ci_04                 2.046701e-02 3 1  ON 3
ci_05                -1.668553e-02 3 1  ON 4
ci_06                -2.175431e-02 3 1  ON 5
ci_07                 2.575511e-02 3 1  ON 6
ci_08                -3.976195e-03 3 1  ON 7
ci_09                -7.651500e-03 3 1  ON 8
ci_10                -1.090388e-02 3 1  ON 9
ci_11                 1.378908e-02 3 1  ON 10
ci_12                 8.454770e-03 3 1  ON 11
ci_13                 1.456665e-02 3 1  ON 12
ci_14                 1.645532e-02 3 1  ON 13
ci_15                 6.332948e-03 3 1  ON 14
ci_16                 4.160595e-03 3 1  ON 15
ci_17                -3.919092e-03 3 1  ON 16
ci_18                -8.148637e-03 3 1  ON 17
ci_19                 9.521044e-03 3 1  ON 18
ci_20                 6.094893e-03 3 1  ON 19
ci_21                 9.494096e-03 3 1  ON 20
ci_22                 8.061623e-03 3 1  ON 21
ci_23                 4.494472e-03 3 1  ON 22
ci_24                 4.295756e-03 3 1  ON 23
ci_25                 4.038235e-03 3 1  ON 24
ci_26                -5.292436e-03 3 1  ON 25
ci_27                 2.978573e-03 3 1  ON 26
ci_28                 4.167584e-04 3 1  ON 27
ci_29                 2.279469e-03 3 1  ON 28
ci_30                 5.940148e-04 3 1  ON 29
ci_31                -2.838015e-04 3 1  ON 30
ci_32                -2.979603e-04 3 1  ON 31
ci_33                -1.367358e-03 3 1  ON 32
ci_34                 1.584323e-03 3 1  ON 33
ci_35                 2.113097e-03 3 1  ON 34
ci_36                -3.196460e-04 3 1  ON 35
ci_37                 5.537395e-04 3 1  ON 36
ci_38                -2.323794e-04 3 1  ON 37
ci_39                 8.997626e-04 3 1  ON 38
ci_40                 1.873844e-04 3 1  ON 39
ci_41                -8.059902e-04 3 1  ON 40
ci_42                -2.536339e-03 3 1  ON 41
ci_43                -6.729551e-03 3 1  ON 42
ci_44                -1.304122e-03 3 1  ON 43
ci_45                -1.314049e-03 3 1  ON 44
ci_46                -7.347604e-04 3 1  ON 45
ci_47                 1.215859e-03 3 1  ON 46
ci_48                 3.286082e-03 3 1  ON 47
ci_49                -1.028888e-03 3 1  ON 48
ci_50                 5.515923e-04 3 1  ON 49
ci_51                -1.947505e-04 3 1  ON 50
ci_52                 7.590845e-04 3 1  ON 51
ci_53                -1.676584e-03 3 1  ON 52
ci_54                -1.275589e-03 3 1  ON 53
ci_55                -8.033457e-04 3 1  ON 54
ci_56                 9.029859e-04 3 1  ON 55
ci_57                 1.854281e-03 3 1  ON 56
ci_58                -1.328555e-03 3 1  ON 57
ci_59                -4.578892e-03 3 1  ON 58
ci_60                -3.558577e-03 3 1  ON 59
ci_61                 5.307475e-03 3 1  ON 60
ci_62                 2.503505e-03 3 1  ON 61
ci_63                -8.648688e-04 3 1  ON 62
ci_64                -2.311303e-04 3 1  ON 63
ci_65                -1.174917e-03 3 1  ON 64
ci_66                -7.237879e-05 3 1  ON 65
ci_67                -2.659335e-04 3 1  ON 66
ci_68                -3.513144e-04 3 1  ON 67
ci_69                -3.727203e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2412e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.703
    reference variance = 0.453228
====================================================
  Execution time = 4.2652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8237e-01
  Total weights = 1.963632670e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468980935108
                                         uncertainty =       0.002074312533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468980935108
                                         uncertainty =       0.002074312533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484213814
  error estimate for blocks of size 2^( 2) =       0.000506134103
  error estimate for blocks of size 2^( 3) =       0.000526610647
  error estimate for blocks of size 2^( 4) =       0.000542978256
  error estimate for blocks of size 2^( 5) =       0.000551899264
  error estimate for blocks of size 2^( 6) =       0.000557619193
  error estimate for blocks of size 2^( 7) =       0.000560198701

      target function =      -0.654903222848
              le_mean =     -22.819493959689
             les_mean =     521.211678702608
             stat err =       0.000553173854
             autocorr =       1.305115473785
   target nu stat err =       0.000553173854
   target dn stat err =       0.002723936769
      target stat err =       0.001132038331
              std dev =       0.684781743033
             le_variance =       0.468926035591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281949395969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-05, overlap shift 3.5527e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654904760639       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655356402911       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655457994034       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655476791376       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655485245591       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655489970236       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655494104161       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655494906513       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655495372102       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655495592666       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655495561332       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655495629353       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e-05 is 7.776891e-03

solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654904760639       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655355298199       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655456521146       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655475229395       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655483635305       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655488329642       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655492427787       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655493219452       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655493680297       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655493898642       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655493867539       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655493934819       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 7.754028e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654904760639       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.655350932817       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.655450707511       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.655469066586       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.655477283791       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.655481860056       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.655485819687       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.655486570450       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.655487013058       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655487222864       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.655487192661       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.655487257094       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 7.663900e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.724484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0321e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_01                 1.081936e-01 3 1  ON 0
ci_02                -2.520194e-02 3 1  ON 1
ci_03                -2.701331e-02 3 1  ON 2
ci_04                 2.115144e-02 3 1  ON 3
ci_05                -2.086159e-02 3 1  ON 4
ci_06                -2.111395e-02 3 1  ON 5
ci_07                 2.633521e-02 3 1  ON 6
ci_08                -4.116123e-03 3 1  ON 7
ci_09                -6.879509e-03 3 1  ON 8
ci_10                -7.358570e-03 3 1  ON 9
ci_11                 1.401145e-02 3 1  ON 10
ci_12                 7.742709e-03 3 1  ON 11
ci_13                 1.476981e-02 3 1  ON 12
ci_14                 1.503656e-02 3 1  ON 13
ci_15                 6.148514e-03 3 1  ON 14
ci_16                 6.639436e-03 3 1  ON 15
ci_17                -7.408119e-03 3 1  ON 16
ci_18                -6.886501e-03 3 1  ON 17
ci_19                 8.902094e-03 3 1  ON 18
ci_20                 6.091561e-03 3 1  ON 19
ci_21                 7.413937e-03 3 1  ON 20
ci_22                 8.837183e-03 3 1  ON 21
ci_23                 4.077722e-03 3 1  ON 22
ci_24                 4.988017e-03 3 1  ON 23
ci_25                 2.849156e-03 3 1  ON 24
ci_26                 2.461592e-03 3 1  ON 25
ci_27                 3.148534e-03 3 1  ON 26
ci_28                 1.173827e-03 3 1  ON 27
ci_29                 1.489649e-03 3 1  ON 28
ci_30                 3.005399e-04 3 1  ON 29
ci_31                 1.630698e-04 3 1  ON 30
ci_32                -4.663329e-04 3 1  ON 31
ci_33                -2.836118e-04 3 1  ON 32
ci_34                 9.999325e-04 3 1  ON 33
ci_35                 1.715257e-03 3 1  ON 34
ci_36                -1.108240e-03 3 1  ON 35
ci_37                -8.204305e-04 3 1  ON 36
ci_38                -3.124496e-04 3 1  ON 37
ci_39                 6.235313e-05 3 1  ON 38
ci_40                -1.841623e-03 3 1  ON 39
ci_41                -1.444669e-03 3 1  ON 40
ci_42                -1.701674e-03 3 1  ON 41
ci_43                -1.735784e-03 3 1  ON 42
ci_44                -2.223192e-03 3 1  ON 43
ci_45                -3.529273e-04 3 1  ON 44
ci_46                -3.268715e-04 3 1  ON 45
ci_47                 1.328012e-03 3 1  ON 46
ci_48                 1.208493e-03 3 1  ON 47
ci_49                -6.997538e-04 3 1  ON 48
ci_50                -8.108068e-04 3 1  ON 49
ci_51                -2.239821e-04 3 1  ON 50
ci_52                 1.882578e-04 3 1  ON 51
ci_53                -6.691689e-04 3 1  ON 52
ci_54                -1.793992e-03 3 1  ON 53
ci_55                -2.871761e-04 3 1  ON 54
ci_56                 1.413186e-03 3 1  ON 55
ci_57                 1.103861e-03 3 1  ON 56
ci_58                 7.776940e-05 3 1  ON 57
ci_59                -9.720812e-04 3 1  ON 58
ci_60                -7.816088e-04 3 1  ON 59
ci_61                 3.222382e-03 3 1  ON 60
ci_62                -5.551987e-05 3 1  ON 61
ci_63                -4.984743e-04 3 1  ON 62
ci_64                -1.562547e-04 3 1  ON 63
ci_65                 3.653552e-04 3 1  ON 64
ci_66                -5.881149e-04 3 1  ON 65
ci_67                 1.831632e-04 3 1  ON 66
ci_68                -1.125992e-03 3 1  ON 67
ci_69                -1.743739e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8081
    reference variance = 0.471525
====================================================
  Execution time = 4.1640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9004e-01
  Total weights = 1.9646e+06
  Execution time = 5.9056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00394722
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498987567359
                                         uncertainty =       0.011861883745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498987567359
                                         uncertainty =       0.011861883745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499453234
  error estimate for blocks of size 2^( 2) =       0.000520834501
  error estimate for blocks of size 2^( 3) =       0.000540645998
  error estimate for blocks of size 2^( 4) =       0.000556348515
  error estimate for blocks of size 2^( 5) =       0.000565117494
  error estimate for blocks of size 2^( 6) =       0.000569989358
  error estimate for blocks of size 2^( 7) =       0.000573062904

      target function =      -0.373362945205
              le_mean =     -22.818910195516
             les_mean =     522.160798764574
             stat err =       0.000566129568
             autocorr =       1.284819196964
   target nu stat err =       0.000566129568
   target dn stat err =       0.840534925009
      target stat err =       0.119466306513
              std dev =       0.706333536785
             le_variance =       0.498907065188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472128142421
                                         uncertainty =       0.002910936648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472128142421
                                         uncertainty =       0.002910936648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485861696
  error estimate for blocks of size 2^( 2) =       0.000507592391
  error estimate for blocks of size 2^( 3) =       0.000527816269
  error estimate for blocks of size 2^( 4) =       0.000543773273
  error estimate for blocks of size 2^( 5) =       0.000552652724
  error estimate for blocks of size 2^( 6) =       0.000557914892
  error estimate for blocks of size 2^( 7) =       0.000561464819

      target function =      -0.651569772738
              le_mean =     -22.818371282658
             les_mean =     521.168174313006
             stat err =       0.000553951427
             autocorr =       1.299924253477
   target nu stat err =       0.000553951427
   target dn stat err =       0.003811159446
      target stat err =       0.001532669242
              std dev =       0.687112200414
             le_variance =       0.472123175958

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00399288
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505407111425
                                         uncertainty =       0.016181587044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505407111425
                                         uncertainty =       0.016181587044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502686644
  error estimate for blocks of size 2^( 2) =       0.000523518864
  error estimate for blocks of size 2^( 3) =       0.000543142288
  error estimate for blocks of size 2^( 4) =       0.000558316261
  error estimate for blocks of size 2^( 5) =       0.000566706686
  error estimate for blocks of size 2^( 6) =       0.000571466317
  error estimate for blocks of size 2^( 7) =       0.000575323070

      target function =      -0.546311526258
              le_mean =     -22.818751187034
             les_mean =     521.494178703873
             stat err =       0.000567953083
             autocorr =       1.276527663465
   target nu stat err =       0.000567953083
   target dn stat err =       0.149283764231
      target stat err =       0.041444462672
              std dev =       0.710906269288
             le_variance =       0.505387723713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472119118908
                                         uncertainty =       0.002910610119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472119118908
                                         uncertainty =       0.002910610119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485857018
  error estimate for blocks of size 2^( 2) =       0.000507589004
  error estimate for blocks of size 2^( 3) =       0.000527814051
  error estimate for blocks of size 2^( 4) =       0.000543771586
  error estimate for blocks of size 2^( 5) =       0.000552651772
  error estimate for blocks of size 2^( 6) =       0.000557913838
  error estimate for blocks of size 2^( 7) =       0.000561461039

      target function =      -0.651624760646
              le_mean =     -22.818371271983
             les_mean =     521.168033740441
             stat err =       0.000553949559
             autocorr =       1.299940518608
   target nu stat err =       0.000553949559
   target dn stat err =       0.003810308544
      target stat err =       0.001532595524
              std dev =       0.687105584249
             le_variance =       0.472114083906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.373362945205        initial
     3.5527e-05     3.5527e-04             7.7769e-03        -0.651569772738
     1.4211e-04     1.4211e-03             7.7540e-03        -0.546311526258
     5.6843e-04     5.6843e-03             7.6639e-03        -0.651624760646  <--

*****************************************************************************
Applying the update for shift_i =   5.6843e-04     and shift_s =   5.6843e-03
*****************************************************************************

  Execution time = 7.1270e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_01                 1.083015e-01 3 1  ON 0
ci_02                -2.517213e-02 3 1  ON 1
ci_03                -2.694301e-02 3 1  ON 2
ci_04                 2.114539e-02 3 1  ON 3
ci_05                -2.081266e-02 3 1  ON 4
ci_06                -2.112192e-02 3 1  ON 5
ci_07                 2.632363e-02 3 1  ON 6
ci_08                -4.115752e-03 3 1  ON 7
ci_09                -6.889986e-03 3 1  ON 8
ci_10                -7.406940e-03 3 1  ON 9
ci_11                 1.400834e-02 3 1  ON 10
ci_12                 7.748934e-03 3 1  ON 11
ci_13                 1.476525e-02 3 1  ON 12
ci_14                 1.506120e-02 3 1  ON 13
ci_15                 6.150997e-03 3 1  ON 14
ci_16                 6.612782e-03 3 1  ON 15
ci_17                -7.366376e-03 3 1  ON 16
ci_18                -6.901182e-03 3 1  ON 17
ci_19                 8.907154e-03 3 1  ON 18
ci_20                 6.091387e-03 3 1  ON 19
ci_21                 7.440971e-03 3 1  ON 20
ci_22                 8.827627e-03 3 1  ON 21
ci_23                 4.081745e-03 3 1  ON 22
ci_24                 4.977631e-03 3 1  ON 23
ci_25                 2.860364e-03 3 1  ON 24
ci_26                 2.371464e-03 3 1  ON 25
ci_27                 3.146256e-03 3 1  ON 26
ci_28                 1.164488e-03 3 1  ON 27
ci_29                 1.499391e-03 3 1  ON 28
ci_30                 3.048255e-04 3 1  ON 29
ci_31                 1.581927e-04 3 1  ON 30
ci_32                -4.655442e-04 3 1  ON 31
ci_33                -2.937470e-04 3 1  ON 32
ci_34                 1.011604e-03 3 1  ON 33
ci_35                 1.721889e-03 3 1  ON 34
ci_36                -1.101231e-03 3 1  ON 35
ci_37                -8.064319e-04 3 1  ON 36
ci_38                -3.113969e-04 3 1  ON 37
ci_39                 7.098669e-05 3 1  ON 38
ci_40                -1.824099e-03 3 1  ON 39
ci_41                -1.437864e-03 3 1  ON 40
ci_42                -1.709735e-03 3 1  ON 41
ci_43                -1.791487e-03 3 1  ON 42
ci_44                -2.213808e-03 3 1  ON 43
ci_45                -3.624351e-04 3 1  ON 44
ci_46                -3.306014e-04 3 1  ON 45
ci_47                 1.325422e-03 3 1  ON 46
ci_48                 1.234770e-03 3 1  ON 47
ci_49                -7.030556e-04 3 1  ON 48
ci_50                -7.990584e-04 3 1  ON 49
ci_51                -2.232388e-04 3 1  ON 50
ci_52                 1.932819e-04 3 1  ON 51
ci_53                -6.785422e-04 3 1  ON 52
ci_54                -1.788910e-03 3 1  ON 53
ci_55                -2.925896e-04 3 1  ON 54
ci_56                 1.408162e-03 3 1  ON 55
ci_57                 1.110830e-03 3 1  ON 56
ci_58                 6.423012e-05 3 1  ON 57
ci_59                -1.009252e-03 3 1  ON 58
ci_60                -8.370557e-04 3 1  ON 59
ci_61                 3.268141e-03 3 1  ON 60
ci_62                -3.205684e-05 3 1  ON 61
ci_63                -5.019825e-04 3 1  ON 62
ci_64                -1.572522e-04 3 1  ON 63
ci_65                 3.503080e-04 3 1  ON 64
ci_66                -5.830594e-04 3 1  ON 65
ci_67                 1.792434e-04 3 1  ON 66
ci_68                -1.118733e-03 3 1  ON 67
ci_69                -2.136131e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2161e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7985
    reference variance = 0.449379
====================================================
  Execution time = 4.2715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8411e-01
  Total weights = 1.964094285e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469831736281
                                         uncertainty =       0.002290014251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469831736281
                                         uncertainty =       0.002290014251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484675491
  error estimate for blocks of size 2^( 2) =       0.000506303571
  error estimate for blocks of size 2^( 3) =       0.000527161505
  error estimate for blocks of size 2^( 4) =       0.000542892179
  error estimate for blocks of size 2^( 5) =       0.000553238400
  error estimate for blocks of size 2^( 6) =       0.000560439881
  error estimate for blocks of size 2^( 7) =       0.000564790145

      target function =      -0.653965913946
              le_mean =     -22.818494843069
             les_mean =     521.167812480502
             stat err =       0.000555340151
             autocorr =       1.312852784949
   target nu stat err =       0.000555340151
   target dn stat err =       0.002997365272
      target stat err =       0.001231934775
              std dev =       0.685434653247
             le_variance =       0.469820663872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281849484307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653967816518       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654095037429       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654123574556       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654130033168       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654134637095       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654135571062       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654135222155       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654135815749       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654135819405       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654135853943       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654135857811       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654135865104       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 3.249405e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653967816518       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654093787667       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654121907039       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654128242840       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654132740923       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654133631476       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654133282158       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654133856319       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654133859122       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654133891598       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654133895760       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654133902275       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 3.212279e-03

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.653967816518       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654089024815       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654115581355       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654121464309       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654125576974       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654126316654       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654125970023       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654126476043       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654126476210       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654126501863       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654126506975       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654126510978       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 3.071984e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.729315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0457e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_01                 1.074017e-01 3 1  ON 0
ci_02                -2.669453e-02 3 1  ON 1
ci_03                -2.373073e-02 3 1  ON 2
ci_04                 2.229339e-02 3 1  ON 3
ci_05                -1.912632e-02 3 1  ON 4
ci_06                -1.879450e-02 3 1  ON 5
ci_07                 2.613814e-02 3 1  ON 6
ci_08                -3.876302e-03 3 1  ON 7
ci_09                -8.530895e-03 3 1  ON 8
ci_10                -8.131063e-03 3 1  ON 9
ci_11                 1.295883e-02 3 1  ON 10
ci_12                 7.470186e-03 3 1  ON 11
ci_13                 1.173903e-02 3 1  ON 12
ci_14                 1.535328e-02 3 1  ON 13
ci_15                 6.257739e-03 3 1  ON 14
ci_16                 6.396855e-03 3 1  ON 15
ci_17                -7.693283e-03 3 1  ON 16
ci_18                -7.035390e-03 3 1  ON 17
ci_19                 8.747533e-03 3 1  ON 18
ci_20                 6.494971e-03 3 1  ON 19
ci_21                 6.757736e-03 3 1  ON 20
ci_22                 7.490961e-03 3 1  ON 21
ci_23                 5.408932e-03 3 1  ON 22
ci_24                 3.939013e-03 3 1  ON 23
ci_25                 2.967209e-03 3 1  ON 24
ci_26                 1.576057e-03 3 1  ON 25
ci_27                 1.936815e-03 3 1  ON 26
ci_28                 5.819597e-05 3 1  ON 27
ci_29                 1.220112e-03 3 1  ON 28
ci_30                -1.067727e-04 3 1  ON 29
ci_31                 2.029664e-04 3 1  ON 30
ci_32                -2.290536e-04 3 1  ON 31
ci_33                 9.978837e-05 3 1  ON 32
ci_34                 1.051444e-03 3 1  ON 33
ci_35                -7.328534e-04 3 1  ON 34
ci_36                -6.100744e-04 3 1  ON 35
ci_37                -1.240195e-03 3 1  ON 36
ci_38                -2.832848e-05 3 1  ON 37
ci_39                -4.134486e-04 3 1  ON 38
ci_40                -7.456766e-04 3 1  ON 39
ci_41                -1.055863e-03 3 1  ON 40
ci_42                -6.743064e-04 3 1  ON 41
ci_43                -3.055416e-04 3 1  ON 42
ci_44                 3.086980e-05 3 1  ON 43
ci_45                 1.844319e-04 3 1  ON 44
ci_46                -3.708875e-04 3 1  ON 45
ci_47                 4.888259e-04 3 1  ON 46
ci_48                 6.748588e-04 3 1  ON 47
ci_49                -5.372160e-04 3 1  ON 48
ci_50                -2.665406e-04 3 1  ON 49
ci_51                 6.346673e-04 3 1  ON 50
ci_52                 9.119867e-05 3 1  ON 51
ci_53                -2.870162e-04 3 1  ON 52
ci_54                -1.870397e-03 3 1  ON 53
ci_55                -8.414226e-04 3 1  ON 54
ci_56                 2.005124e-03 3 1  ON 55
ci_57                 2.161337e-03 3 1  ON 56
ci_58                -1.584013e-03 3 1  ON 57
ci_59                -9.078954e-05 3 1  ON 58
ci_60                 2.148619e-03 3 1  ON 59
ci_61                 1.484860e-04 3 1  ON 60
ci_62                -8.258653e-04 3 1  ON 61
ci_63                -8.132263e-04 3 1  ON 62
ci_64                -7.232152e-04 3 1  ON 63
ci_65                -6.419332e-04 3 1  ON 64
ci_66                -3.084036e-04 3 1  ON 65
ci_67                -3.410901e-04 3 1  ON 66
ci_68                -1.232807e-03 3 1  ON 67
ci_69                -8.329972e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7658
    reference variance = 0.252567
====================================================
  Execution time = 4.3383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7865e-01
  Total weights = 1.9643e+06
  Execution time = 5.9347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518257226574
                                         uncertainty =       0.049694181561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518257226574
                                         uncertainty =       0.049694181561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509003822
  error estimate for blocks of size 2^( 2) =       0.000530036314
  error estimate for blocks of size 2^( 3) =       0.000549721249
  error estimate for blocks of size 2^( 4) =       0.000564450973
  error estimate for blocks of size 2^( 5) =       0.000574725799
  error estimate for blocks of size 2^( 6) =       0.000579368710
  error estimate for blocks of size 2^( 7) =       0.000581385104

      target function =      -0.109232254236
              le_mean =     -22.819244325144
             les_mean =     526.013448469445
             stat err =       0.000574982646
             autocorr =       1.276049105764
   target nu stat err =       0.000574982646
   target dn stat err =       4.710513125599
      target stat err =       0.079606181430
              std dev =       0.719840108715
             le_variance =       0.518169782115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465437999303
                                         uncertainty =       0.001893952621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465437999303
                                         uncertainty =       0.001893952621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482402598
  error estimate for blocks of size 2^( 2) =       0.000504460609
  error estimate for blocks of size 2^( 3) =       0.000525139594
  error estimate for blocks of size 2^( 4) =       0.000540912523
  error estimate for blocks of size 2^( 5) =       0.000551777605
  error estimate for blocks of size 2^( 6) =       0.000556628687
  error estimate for blocks of size 2^( 7) =       0.000559505906

      target function =      -0.656247968265
              le_mean =     -22.818977210267
             les_mean =     521.184385152229
             stat err =       0.000552206180
             autocorr =       1.310337741657
   target nu stat err =       0.000552206180
   target dn stat err =       0.002585508840
      target stat err =       0.001083202435
              std dev =       0.682220296466
             le_variance =       0.465424532910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      11.545839900980
                                         uncertainty =      10.913150014327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      11.545839900980
                                         uncertainty =      10.913150014327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.002400565797
  error estimate for blocks of size 2^( 2) =       0.002404945535
  error estimate for blocks of size 2^( 3) =       0.002409773033
  error estimate for blocks of size 2^( 4) =       0.002414155564
  error estimate for blocks of size 2^( 5) =       0.002417775920
  error estimate for blocks of size 2^( 6) =       0.002419238880
  error estimate for blocks of size 2^( 7) =       0.002422500372

      target function =      -0.000977882378
              le_mean =     -22.821536093712
             les_mean =    1077.972957635855
             stat err =       0.002418417684
             autocorr =       1.014928368502
   target nu stat err =       0.002418417684
   target dn stat err =     551.026645520253
      target stat err =       0.000965121936
              std dev =       3.394912707049
             le_variance =      11.525432288483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465412594024
                                         uncertainty =       0.001891678306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465412594024
                                         uncertainty =       0.001891678306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482389434
  error estimate for blocks of size 2^( 2) =       0.000504443784
  error estimate for blocks of size 2^( 3) =       0.000525119684
  error estimate for blocks of size 2^( 4) =       0.000540887612
  error estimate for blocks of size 2^( 5) =       0.000551752546
  error estimate for blocks of size 2^( 6) =       0.000556606776
  error estimate for blocks of size 2^( 7) =       0.000559475935

      target function =      -0.656120704789
              le_mean =     -22.818975394595
             les_mean =     521.184620592527
             stat err =       0.000552180717
             autocorr =       1.310288408602
   target nu stat err =       0.000552180717
   target dn stat err =       0.002601688476
      target stat err =       0.001088924525
              std dev =       0.682201680548
             le_variance =       0.465399132942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.109232254236        initial
     1.4211e-04     1.4211e-03             3.2494e-03        -0.656247968265  <--
     5.6843e-04     5.6843e-03             3.2123e-03        -0.000977882378
     2.2737e-03     2.2737e-02             3.0720e-03        -0.656120704789

*****************************************************************************
Applying the update for shift_i =   1.4211e-04     and shift_s =   1.4211e-03
*****************************************************************************

  Execution time = 7.3113e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_01                 1.073909e-01 3 1  ON 0
ci_02                -2.671406e-02 3 1  ON 1
ci_03                -2.369360e-02 3 1  ON 2
ci_04                 2.230678e-02 3 1  ON 3
ci_05                -1.910618e-02 3 1  ON 4
ci_06                -1.876621e-02 3 1  ON 5
ci_07                 2.613679e-02 3 1  ON 6
ci_08                -3.873838e-03 3 1  ON 7
ci_09                -8.551552e-03 3 1  ON 8
ci_10                -8.139865e-03 3 1  ON 9
ci_11                 1.294510e-02 3 1  ON 10
ci_12                 7.466917e-03 3 1  ON 11
ci_13                 1.168681e-02 3 1  ON 12
ci_14                 1.536448e-02 3 1  ON 13
ci_15                 6.258172e-03 3 1  ON 14
ci_16                 6.394270e-03 3 1  ON 15
ci_17                -7.698392e-03 3 1  ON 16
ci_18                -7.036210e-03 3 1  ON 17
ci_19                 8.744932e-03 3 1  ON 18
ci_20                 6.499142e-03 3 1  ON 19
ci_21                 6.743603e-03 3 1  ON 20
ci_22                 7.467935e-03 3 1  ON 21
ci_23                 5.422402e-03 3 1  ON 22
ci_24                 3.922231e-03 3 1  ON 23
ci_25                 2.968881e-03 3 1  ON 24
ci_26                 1.567327e-03 3 1  ON 25
ci_27                 1.922933e-03 3 1  ON 26
ci_28                 4.521801e-05 3 1  ON 27
ci_29                 1.217082e-03 3 1  ON 28
ci_30                -1.192431e-04 3 1  ON 29
ci_31                 1.976758e-04 3 1  ON 30
ci_32                -2.264807e-04 3 1  ON 31
ci_33                 1.041284e-04 3 1  ON 32
ci_34                 1.054160e-03 3 1  ON 33
ci_35                -7.615670e-04 3 1  ON 34
ci_36                -6.055789e-04 3 1  ON 35
ci_37                -1.243745e-03 3 1  ON 36
ci_38                -2.613527e-05 3 1  ON 37
ci_39                -4.180104e-04 3 1  ON 38
ci_40                -7.363742e-04 3 1  ON 39
ci_41                -1.049763e-03 3 1  ON 40
ci_42                -6.635719e-04 3 1  ON 41
ci_43                -2.870739e-04 3 1  ON 42
ci_44                 5.814064e-05 3 1  ON 43
ci_45                 1.893002e-04 3 1  ON 44
ci_46                -3.714194e-04 3 1  ON 45
ci_47                 4.768749e-04 3 1  ON 46
ci_48                 6.641351e-04 3 1  ON 47
ci_49                -5.357539e-04 3 1  ON 48
ci_50                -2.616279e-04 3 1  ON 49
ci_51                 6.432398e-04 3 1  ON 50
ci_52                 9.011269e-05 3 1  ON 51
ci_53                -2.831020e-04 3 1  ON 52
ci_54                -1.871382e-03 3 1  ON 53
ci_55                -8.476025e-04 3 1  ON 54
ci_56                 2.011639e-03 3 1  ON 55
ci_57                 2.171635e-03 3 1  ON 56
ci_58                -1.602582e-03 3 1  ON 57
ci_59                -8.089130e-05 3 1  ON 58
ci_60                 2.214698e-03 3 1  ON 59
ci_61                 8.676657e-05 3 1  ON 60
ci_62                -8.334671e-04 3 1  ON 61
ci_63                -8.162004e-04 3 1  ON 62
ci_64                -7.288478e-04 3 1  ON 63
ci_65                -6.519754e-04 3 1  ON 64
ci_66                -3.048279e-04 3 1  ON 65
ci_67                -3.455435e-04 3 1  ON 66
ci_68                -1.234717e-03 3 1  ON 67
ci_69                -8.393821e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2358e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.8437
    reference variance = 0.434796
====================================================
  Execution time = 4.4384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5369e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8297e-01
  Total weights = 1.964206356e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466421946031
                                         uncertainty =       0.002206186710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466421946031
                                         uncertainty =       0.002206186710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482903350
  error estimate for blocks of size 2^( 2) =       0.000504946201
  error estimate for blocks of size 2^( 3) =       0.000525362562
  error estimate for blocks of size 2^( 4) =       0.000540471428
  error estimate for blocks of size 2^( 5) =       0.000552466295
  error estimate for blocks of size 2^( 6) =       0.000557826641
  error estimate for blocks of size 2^( 7) =       0.000557943921

      target function =      -0.654529179893
              le_mean =     -22.818947749654
             les_mean =     521.187343207266
             stat err =       0.000552177071
             autocorr =       1.307483754449
   target nu stat err =       0.000552177071
   target dn stat err =       0.003738971065
      target stat err =       0.001518965727
              std dev =       0.682928466866
             le_variance =       0.466391290856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281894774965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-05, overlap shift 3.5527e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654532305196       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654702217252       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654735264643       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654747200473       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654754235910       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654756753497       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654757491242       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654757007522       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654756896527       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654756957914       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654756953862       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654757044410       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e-05 is 4.551664e-03

solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654532305196       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654701795540       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654734722055       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654746603264       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654753597729       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654756092267       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654756821646       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654756340141       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654756229668       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654756290479       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654756286332       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654756375742       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 4.531204e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654532305196       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654700129411       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654732580546       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654744247649       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654751082128       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654753487374       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654754184570       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654753711829       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654753603443       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654753662045       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654753657549       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654753742594       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 4.451220e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.734231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2039e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_01                 1.119222e-01 3 1  ON 0
ci_02                -2.606411e-02 3 1  ON 1
ci_03                -2.657951e-02 3 1  ON 2
ci_04                 2.087975e-02 3 1  ON 3
ci_05                -2.029880e-02 3 1  ON 4
ci_06                -2.134994e-02 3 1  ON 5
ci_07                 2.578917e-02 3 1  ON 6
ci_08                -3.102600e-03 3 1  ON 7
ci_09                -8.461989e-03 3 1  ON 8
ci_10                -8.769176e-03 3 1  ON 9
ci_11                 1.241246e-02 3 1  ON 10
ci_12                 5.112605e-03 3 1  ON 11
ci_13                 1.236548e-02 3 1  ON 12
ci_14                 1.560782e-02 3 1  ON 13
ci_15                 3.562624e-03 3 1  ON 14
ci_16                 7.506950e-03 3 1  ON 15
ci_17                -7.716261e-03 3 1  ON 16
ci_18                -7.314611e-03 3 1  ON 17
ci_19                 9.573024e-03 3 1  ON 18
ci_20                 7.629049e-03 3 1  ON 19
ci_21                 9.057987e-03 3 1  ON 20
ci_22                 8.407562e-03 3 1  ON 21
ci_23                 5.732878e-03 3 1  ON 22
ci_24                 6.384093e-03 3 1  ON 23
ci_25                 1.627153e-03 3 1  ON 24
ci_26                 1.464126e-03 3 1  ON 25
ci_27                 3.314394e-03 3 1  ON 26
ci_28                 9.030814e-04 3 1  ON 27
ci_29                 7.841149e-04 3 1  ON 28
ci_30                 9.548701e-04 3 1  ON 29
ci_31                -1.686113e-03 3 1  ON 30
ci_32                -5.171398e-04 3 1  ON 31
ci_33                -8.068566e-04 3 1  ON 32
ci_34                -5.448736e-04 3 1  ON 33
ci_35                 4.659154e-04 3 1  ON 34
ci_36                -6.113692e-04 3 1  ON 35
ci_37                -7.531281e-04 3 1  ON 36
ci_38                -9.923465e-04 3 1  ON 37
ci_39                -6.700781e-04 3 1  ON 38
ci_40                -1.181997e-03 3 1  ON 39
ci_41                -7.358721e-04 3 1  ON 40
ci_42                -7.919032e-04 3 1  ON 41
ci_43                -1.679478e-03 3 1  ON 42
ci_44                -6.387876e-04 3 1  ON 43
ci_45                -4.221373e-04 3 1  ON 44
ci_46                -8.236947e-04 3 1  ON 45
ci_47                 3.455240e-03 3 1  ON 46
ci_48                 1.705838e-03 3 1  ON 47
ci_49                 1.188100e-04 3 1  ON 48
ci_50                -7.296603e-04 3 1  ON 49
ci_51                 1.454682e-03 3 1  ON 50
ci_52                 1.537054e-04 3 1  ON 51
ci_53                -1.065784e-03 3 1  ON 52
ci_54                -1.032835e-03 3 1  ON 53
ci_55                -1.409764e-03 3 1  ON 54
ci_56                 1.769910e-03 3 1  ON 55
ci_57                 1.431027e-03 3 1  ON 56
ci_58                 1.089205e-04 3 1  ON 57
ci_59                 3.045276e-04 3 1  ON 58
ci_60                -3.675423e-04 3 1  ON 59
ci_61                 3.209824e-03 3 1  ON 60
ci_62                -7.308334e-04 3 1  ON 61
ci_63                 2.101375e-04 3 1  ON 62
ci_64                -2.012532e-04 3 1  ON 63
ci_65                -1.358576e-04 3 1  ON 64
ci_66                -1.347224e-03 3 1  ON 65
ci_67                 1.626255e-04 3 1  ON 66
ci_68                -9.137574e-04 3 1  ON 67
ci_69                -2.116310e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.836
    reference variance = 0.689524
====================================================
  Execution time = 4.1687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8534e-01
  Total weights = 1.9641e+06
  Execution time = 5.9142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0145941
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471881306388
                                         uncertainty =       0.002340182420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471881306388
                                         uncertainty =       0.002340182420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485755892
  error estimate for blocks of size 2^( 2) =       0.000507651209
  error estimate for blocks of size 2^( 3) =       0.000528087775
  error estimate for blocks of size 2^( 4) =       0.000543631651
  error estimate for blocks of size 2^( 5) =       0.000553579406
  error estimate for blocks of size 2^( 6) =       0.000558277434
  error estimate for blocks of size 2^( 7) =       0.000564215129

      target function =      -0.636682368803
              le_mean =     -22.819209092759
             les_mean =     521.245557849359
             stat err =       0.000554925905
             autocorr =       1.305070112615
   target nu stat err =       0.000554925905
   target dn stat err =       0.017116820113
      target stat err =       0.006428850291
              std dev =       0.686962569961
             le_variance =       0.471917572527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470238549048
                                         uncertainty =       0.002286556536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470238549048
                                         uncertainty =       0.002286556536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484913138
  error estimate for blocks of size 2^( 2) =       0.000506794476
  error estimate for blocks of size 2^( 3) =       0.000527185355
  error estimate for blocks of size 2^( 4) =       0.000542671949
  error estimate for blocks of size 2^( 5) =       0.000552555455
  error estimate for blocks of size 2^( 6) =       0.000557155641
  error estimate for blocks of size 2^( 7) =       0.000562927540

      target function =      -0.653580580474
              le_mean =     -22.818962124306
             les_mean =     521.190407690032
             stat err =       0.000553827646
             autocorr =       1.304431751526
   target nu stat err =       0.000553827646
   target dn stat err =       0.003232147967
      target stat err =       0.001320336777
              std dev =       0.685770736023
             le_variance =       0.470281502385

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0144288
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512660358203
                                         uncertainty =       0.033232356387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512660358203
                                         uncertainty =       0.033232356387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506261462
  error estimate for blocks of size 2^( 2) =       0.000527171705
  error estimate for blocks of size 2^( 3) =       0.000546677881
  error estimate for blocks of size 2^( 4) =       0.000561603972
  error estimate for blocks of size 2^( 5) =       0.000571049170
  error estimate for blocks of size 2^( 6) =       0.000575563528
  error estimate for blocks of size 2^( 7) =       0.000581166736

      target function =      -0.374727927065
              le_mean =     -22.818894123880
             les_mean =     522.210001332563
             stat err =       0.000572345852
             autocorr =       1.278107373838
   target nu stat err =       0.000572345852
   target dn stat err =       0.747005681901
      target stat err =       0.104571835356
              std dev =       0.715961825878
             le_variance =       0.512601336115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470230871516
                                         uncertainty =       0.002286977329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470230871516
                                         uncertainty =       0.002286977329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484909147
  error estimate for blocks of size 2^( 2) =       0.000506791409
  error estimate for blocks of size 2^( 3) =       0.000527183179
  error estimate for blocks of size 2^( 4) =       0.000542670748
  error estimate for blocks of size 2^( 5) =       0.000552555287
  error estimate for blocks of size 2^( 6) =       0.000557156134
  error estimate for blocks of size 2^( 7) =       0.000562930300

      target function =      -0.653598602635
              le_mean =     -22.818962801897
             les_mean =     521.190393440485
             stat err =       0.000553828117
             autocorr =       1.304455438847
   target nu stat err =       0.000553828117
   target dn stat err =       0.003230381115
      target stat err =       0.001319732778
              std dev =       0.685765092741
             le_variance =       0.470273762422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.636682368803        initial
     3.5527e-05     3.5527e-04             4.5517e-03        -0.653580580474
     1.4211e-04     1.4211e-03             4.5312e-03        -0.374727927065
     5.6843e-04     5.6843e-03             4.4512e-03        -0.653598602635  <--

*****************************************************************************
Applying the update for shift_i =   5.6843e-04     and shift_s =   5.6843e-03
*****************************************************************************

  Execution time = 7.1380e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_01                 1.118422e-01 3 1  ON 0
ci_02                -2.607546e-02 3 1  ON 1
ci_03                -2.654783e-02 3 1  ON 2
ci_04                 2.089428e-02 3 1  ON 3
ci_05                -2.028635e-02 3 1  ON 4
ci_06                -2.132203e-02 3 1  ON 5
ci_07                 2.579543e-02 3 1  ON 6
ci_08                -3.108856e-03 3 1  ON 7
ci_09                -8.461935e-03 3 1  ON 8
ci_10                -8.762008e-03 3 1  ON 9
ci_11                 1.242086e-02 3 1  ON 10
ci_12                 5.137458e-03 3 1  ON 11
ci_13                 1.235200e-02 3 1  ON 12
ci_14                 1.560615e-02 3 1  ON 13
ci_15                 3.592771e-03 3 1  ON 14
ci_16                 7.493285e-03 3 1  ON 15
ci_17                -7.716697e-03 3 1  ON 16
ci_18                -7.310350e-03 3 1  ON 17
ci_19                 9.564718e-03 3 1  ON 18
ci_20                 7.617651e-03 3 1  ON 19
ci_21                 9.022669e-03 3 1  ON 20
ci_22                 8.393084e-03 3 1  ON 21
ci_23                 5.729635e-03 3 1  ON 22
ci_24                 6.345264e-03 3 1  ON 23
ci_25                 1.640874e-03 3 1  ON 24
ci_26                 1.465852e-03 3 1  ON 25
ci_27                 3.298199e-03 3 1  ON 26
ci_28                 8.922620e-04 3 1  ON 27
ci_29                 7.885182e-04 3 1  ON 28
ci_30                 9.385862e-04 3 1  ON 29
ci_31                -1.661312e-03 3 1  ON 30
ci_32                -5.139571e-04 3 1  ON 31
ci_33                -7.977348e-04 3 1  ON 32
ci_34                -5.264901e-04 3 1  ON 33
ci_35                 4.513794e-04 3 1  ON 34
ci_36                -6.109286e-04 3 1  ON 35
ci_37                -7.576015e-04 3 1  ON 36
ci_38                -9.832701e-04 3 1  ON 37
ci_39                -6.678323e-04 3 1  ON 38
ci_40                -1.177733e-03 3 1  ON 39
ci_41                -7.387905e-04 3 1  ON 40
ci_42                -7.904551e-04 3 1  ON 41
ci_43                -1.664028e-03 3 1  ON 42
ci_44                -6.298882e-04 3 1  ON 43
ci_45                -4.161670e-04 3 1  ON 44
ci_46                -8.193653e-04 3 1  ON 45
ci_47                 3.416400e-03 3 1  ON 46
ci_48                 1.691648e-03 3 1  ON 47
ci_49                 1.131682e-04 3 1  ON 48
ci_50                -7.255082e-04 3 1  ON 49
ci_51                 1.446920e-03 3 1  ON 50
ci_52                 1.531324e-04 3 1  ON 51
ci_53                -1.058538e-03 3 1  ON 52
ci_54                -1.041869e-03 3 1  ON 53
ci_55                -1.403774e-03 3 1  ON 54
ci_56                 1.772380e-03 3 1  ON 55
ci_57                 1.438578e-03 3 1  ON 56
ci_58                 9.119017e-05 3 1  ON 57
ci_59                 3.014713e-04 3 1  ON 58
ci_60                -3.161824e-04 3 1  ON 59
ci_61                 3.145813e-03 3 1  ON 60
ci_62                -7.316859e-04 3 1  ON 61
ci_63                 2.014827e-04 3 1  ON 62
ci_64                -2.061645e-04 3 1  ON 63
ci_65                -1.404156e-04 3 1  ON 64
ci_66                -1.336683e-03 3 1  ON 65
ci_67                 1.571829e-04 3 1  ON 66
ci_68                -9.163577e-04 3 1  ON 67
ci_69                -2.103470e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2343e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8165
    reference variance = 0.583088
====================================================
  Execution time = 4.2843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9241e-01
  Total weights = 1.963971246e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478391606379
                                         uncertainty =       0.005173156219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478391606379
                                         uncertainty =       0.005173156219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489222744
  error estimate for blocks of size 2^( 2) =       0.000511036126
  error estimate for blocks of size 2^( 3) =       0.000531467201
  error estimate for blocks of size 2^( 4) =       0.000548038060
  error estimate for blocks of size 2^( 5) =       0.000556452118
  error estimate for blocks of size 2^( 6) =       0.000563572093
  error estimate for blocks of size 2^( 7) =       0.000565118944

      target function =      -0.650885419875
              le_mean =     -22.819279299307
             les_mean =     521.211917954824
             stat err =       0.000558295304
             autocorr =       1.302310883780
   target nu stat err =       0.000558295304
   target dn stat err =       0.005530967856
      target stat err =       0.002194127979
              std dev =       0.691865440287
             le_variance =       0.478677787464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281927929931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650892485056       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651074234265       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651105858888       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651111817710       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651114693363       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651114308152       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651114760858       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651114730034       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651114705450       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651114739393       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651114643970       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 3.896023e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650892485056       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651072448471       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651103620761       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651109445271       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651112257507       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651111872369       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651112311098       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651112280079       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651112255485       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651112287954       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651112196285       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 3.826375e-03

solving harmonic davidson linear method for identity shift 2.2737e-03, overlap shift 2.2737e-02 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.650892485056       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.651065642824       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.651095120382       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.651100453260       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.651103034457       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.651102652060       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.651103041434       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.651103010226       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.651102985926       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.651103013353       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.651102934735       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e-03 is 3.571585e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.743455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0498e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_01                 1.080158e-01 3 1  ON 0
ci_02                -2.438746e-02 3 1  ON 1
ci_03                -2.398018e-02 3 1  ON 2
ci_04                 2.195224e-02 3 1  ON 3
ci_05                -1.985583e-02 3 1  ON 4
ci_06                -1.996942e-02 3 1  ON 5
ci_07                 2.671907e-02 3 1  ON 6
ci_08                -3.142761e-03 3 1  ON 7
ci_09                -7.202101e-03 3 1  ON 8
ci_10                -8.818250e-03 3 1  ON 9
ci_11                 1.384895e-02 3 1  ON 10
ci_12                 6.698041e-03 3 1  ON 11
ci_13                 1.135344e-02 3 1  ON 12
ci_14                 1.577661e-02 3 1  ON 13
ci_15                 5.475169e-03 3 1  ON 14
ci_16                 4.400280e-03 3 1  ON 15
ci_17                -7.099952e-03 3 1  ON 16
ci_18                -6.604169e-03 3 1  ON 17
ci_19                 9.945966e-03 3 1  ON 18
ci_20                 5.678094e-03 3 1  ON 19
ci_21                 6.939728e-03 3 1  ON 20
ci_22                 9.417304e-03 3 1  ON 21
ci_23                 3.844897e-03 3 1  ON 22
ci_24                 5.080093e-03 3 1  ON 23
ci_25                 2.699464e-03 3 1  ON 24
ci_26                 3.645853e-03 3 1  ON 25
ci_27                 2.457481e-03 3 1  ON 26
ci_28                 1.436812e-03 3 1  ON 27
ci_29                 1.019694e-04 3 1  ON 28
ci_30                 6.237206e-04 3 1  ON 29
ci_31                 6.234179e-04 3 1  ON 30
ci_32                -9.017966e-04 3 1  ON 31
ci_33                -1.346255e-03 3 1  ON 32
ci_34                 7.430141e-04 3 1  ON 33
ci_35                 1.306263e-03 3 1  ON 34
ci_36                -9.346706e-04 3 1  ON 35
ci_37                -7.163591e-04 3 1  ON 36
ci_38                 6.172076e-04 3 1  ON 37
ci_39                 4.102211e-04 3 1  ON 38
ci_40                -9.132822e-04 3 1  ON 39
ci_41                -6.110760e-04 3 1  ON 40
ci_42                -9.450079e-04 3 1  ON 41
ci_43                -1.653812e-03 3 1  ON 42
ci_44                -2.043820e-03 3 1  ON 43
ci_45                -6.570866e-04 3 1  ON 44
ci_46                -4.188600e-04 3 1  ON 45
ci_47                 1.952534e-04 3 1  ON 46
ci_48                 2.238875e-03 3 1  ON 47
ci_49                -5.947277e-04 3 1  ON 48
ci_50                 8.199667e-05 3 1  ON 49
ci_51                 4.091573e-04 3 1  ON 50
ci_52                 9.064082e-04 3 1  ON 51
ci_53                -9.643625e-04 3 1  ON 52
ci_54                -6.454690e-04 3 1  ON 53
ci_55                -8.134955e-04 3 1  ON 54
ci_56                 1.957582e-03 3 1  ON 55
ci_57                 1.599453e-03 3 1  ON 56
ci_58                -1.180477e-03 3 1  ON 57
ci_59                -9.198857e-04 3 1  ON 58
ci_60                -3.623816e-04 3 1  ON 59
ci_61                 4.116008e-03 3 1  ON 60
ci_62                -3.159049e-04 3 1  ON 61
ci_63                -5.192763e-04 3 1  ON 62
ci_64                -1.066850e-03 3 1  ON 63
ci_65                -1.117380e-03 3 1  ON 64
ci_66                -1.236114e-03 3 1  ON 65
ci_67                -6.093920e-04 3 1  ON 66
ci_68                -2.141545e-03 3 1  ON 67
ci_69                -1.929835e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8048
    reference variance = 0.335279
====================================================
  Execution time = 4.1585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8779e-01
  Total weights = 1.9645e+06
  Execution time = 5.9263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.174942
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479263492588
                                         uncertainty =       0.003935819980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479263492588
                                         uncertainty =       0.003935819980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489478434
  error estimate for blocks of size 2^( 2) =       0.000510877821
  error estimate for blocks of size 2^( 3) =       0.000531458597
  error estimate for blocks of size 2^( 4) =       0.000548017610
  error estimate for blocks of size 2^( 5) =       0.000557127176
  error estimate for blocks of size 2^( 6) =       0.000562754437
  error estimate for blocks of size 2^( 7) =       0.000564357789

      target function =      -0.524128000222
              le_mean =     -22.819167735594
             les_mean =     521.567640280739
             stat err =       0.000558064253
             autocorr =       1.299874086970
   target nu stat err =       0.000558064253
   target dn stat err =       0.287117093768
      target stat err =       0.074446139307
              std dev =       0.692227039374
             le_variance =       0.479178274040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473990914215
                                         uncertainty =       0.002592842390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473990914215
                                         uncertainty =       0.002592842390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486782571
  error estimate for blocks of size 2^( 2) =       0.000508403870
  error estimate for blocks of size 2^( 3) =       0.000528997158
  error estimate for blocks of size 2^( 4) =       0.000545621122
  error estimate for blocks of size 2^( 5) =       0.000554955944
  error estimate for blocks of size 2^( 6) =       0.000560756038
  error estimate for blocks of size 2^( 7) =       0.000562437081

      target function =      -0.652594627895
              le_mean =     -22.819076652556
             les_mean =     521.198205040083
             stat err =       0.000555942546
             autocorr =       1.304336906703
   target nu stat err =       0.000555942546
   target dn stat err =       0.003348440695
      target stat err =       0.001361305001
              std dev =       0.688414514099
             le_variance =       0.473914543222

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.179349
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477235120264
                                         uncertainty =       0.003001625482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477235120264
                                         uncertainty =       0.003001625482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488440638
  error estimate for blocks of size 2^( 2) =       0.000510105632
  error estimate for blocks of size 2^( 3) =       0.000530766818
  error estimate for blocks of size 2^( 4) =       0.000547496710
  error estimate for blocks of size 2^( 5) =       0.000556912735
  error estimate for blocks of size 2^( 6) =       0.000562700049
  error estimate for blocks of size 2^( 7) =       0.000564480623

      target function =      -0.612572157205
              le_mean =     -22.819231557775
             les_mean =     521.311999022044
             stat err =       0.000557897529
             autocorr =       1.304623796744
   target nu stat err =       0.000557897529
   target dn stat err =       0.052826045425
      target stat err =       0.018360471852
              std dev =       0.690759374906
             le_variance =       0.477148514021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473963317270
                                         uncertainty =       0.002589201704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473963317270
                                         uncertainty =       0.002589201704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486768524
  error estimate for blocks of size 2^( 2) =       0.000508384056
  error estimate for blocks of size 2^( 3) =       0.000528970912
  error estimate for blocks of size 2^( 4) =       0.000545588282
  error estimate for blocks of size 2^( 5) =       0.000554919143
  error estimate for blocks of size 2^( 6) =       0.000560718705
  error estimate for blocks of size 2^( 7) =       0.000562394734

      target function =      -0.652467873697
              le_mean =     -22.819076064125
             les_mean =     521.198499713261
             stat err =       0.000555905216
             autocorr =       1.304237015979
   target nu stat err =       0.000555905216
   target dn stat err =       0.003318553037
      target stat err =       0.001349381442
              std dev =       0.688394649040
             le_variance =       0.473887192827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.524128000222        initial
     1.4211e-04     1.4211e-03             3.8960e-03        -0.652594627895  <--
     5.6843e-04     5.6843e-03             3.8264e-03        -0.612572157205
     2.2737e-03     2.2737e-02             3.5716e-03        -0.652467873697

*****************************************************************************
Applying the update for shift_i =   1.4211e-04     and shift_s =   1.4211e-03
*****************************************************************************

  Execution time = 7.1320e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_01                 1.079461e-01 3 1  ON 0
ci_02                -2.436842e-02 3 1  ON 1
ci_03                -2.395133e-02 3 1  ON 2
ci_04                 2.196320e-02 3 1  ON 3
ci_05                -1.985317e-02 3 1  ON 4
ci_06                -1.995619e-02 3 1  ON 5
ci_07                 2.673159e-02 3 1  ON 6
ci_08                -3.141781e-03 3 1  ON 7
ci_09                -7.185055e-03 3 1  ON 8
ci_10                -8.818832e-03 3 1  ON 9
ci_11                 1.387024e-02 3 1  ON 10
ci_12                 6.714436e-03 3 1  ON 11
ci_13                 1.133855e-02 3 1  ON 12
ci_14                 1.578078e-02 3 1  ON 13
ci_15                 5.497943e-03 3 1  ON 14
ci_16                 4.362927e-03 3 1  ON 15
ci_17                -7.092533e-03 3 1  ON 16
ci_18                -6.594817e-03 3 1  ON 17
ci_19                 9.949143e-03 3 1  ON 18
ci_20                 5.657858e-03 3 1  ON 19
ci_21                 6.905372e-03 3 1  ON 20
ci_22                 9.431514e-03 3 1  ON 21
ci_23                 3.826756e-03 3 1  ON 22
ci_24                 5.057061e-03 3 1  ON 23
ci_25                 2.710355e-03 3 1  ON 24
ci_26                 3.671523e-03 3 1  ON 25
ci_27                 2.447288e-03 3 1  ON 26
ci_28                 1.442175e-03 3 1  ON 27
ci_29                 9.315835e-05 3 1  ON 28
ci_30                 6.210837e-04 3 1  ON 29
ci_31                 6.527097e-04 3 1  ON 30
ci_32                -9.050757e-04 3 1  ON 31
ci_33                -1.351458e-03 3 1  ON 32
ci_34                 7.589637e-04 3 1  ON 33
ci_35                 1.316790e-03 3 1  ON 34
ci_36                -9.382332e-04 3 1  ON 35
ci_37                -7.166208e-04 3 1  ON 36
ci_38                 6.327554e-04 3 1  ON 37
ci_39                 4.203287e-04 3 1  ON 38
ci_40                -9.109364e-04 3 1  ON 39
ci_41                -6.101029e-04 3 1  ON 40
ci_42                -9.461800e-04 3 1  ON 41
ci_43                -1.654093e-03 3 1  ON 42
ci_44                -2.059933e-03 3 1  ON 43
ci_45                -6.601243e-04 3 1  ON 44
ci_46                -4.152011e-04 3 1  ON 45
ci_47                 1.504346e-04 3 1  ON 46
ci_48                 2.248500e-03 3 1  ON 47
ci_49                -6.008025e-04 3 1  ON 48
ci_50                 8.877765e-05 3 1  ON 49
ci_51                 3.989263e-04 3 1  ON 50
ci_52                 9.145463e-04 3 1  ON 51
ci_53                -9.633410e-04 3 1  ON 52
ci_54                -6.411078e-04 3 1  ON 53
ci_55                -8.066566e-04 3 1  ON 54
ci_56                 1.959537e-03 3 1  ON 55
ci_57                 1.601269e-03 3 1  ON 56
ci_58                -1.193554e-03 3 1  ON 57
ci_59                -9.331879e-04 3 1  ON 58
ci_60                -3.639086e-04 3 1  ON 59
ci_61                 4.136252e-03 3 1  ON 60
ci_62                -3.116978e-04 3 1  ON 61
ci_63                -5.256079e-04 3 1  ON 62
ci_64                -1.075115e-03 3 1  ON 63
ci_65                -1.126632e-03 3 1  ON 64
ci_66                -1.233507e-03 3 1  ON 65
ci_67                -6.170666e-04 3 1  ON 66
ci_68                -2.154224e-03 3 1  ON 67
ci_69                -1.927353e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2183e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6947
    reference variance = 0.515941
====================================================
  Execution time = 4.4803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8161e-01
  Total weights = 1.963982098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467135970969
                                         uncertainty =       0.002558347138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467135970969
                                         uncertainty =       0.002558347138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483262451
  error estimate for blocks of size 2^( 2) =       0.000504836468
  error estimate for blocks of size 2^( 3) =       0.000525883640
  error estimate for blocks of size 2^( 4) =       0.000541397680
  error estimate for blocks of size 2^( 5) =       0.000550237712
  error estimate for blocks of size 2^( 6) =       0.000555827910
  error estimate for blocks of size 2^( 7) =       0.000559787729

      target function =      -0.654809016206
              le_mean =     -22.817911344236
             les_mean =     521.138683406746
             stat err =       0.000551812758
             autocorr =       1.303819194616
   target nu stat err =       0.000551812758
   target dn stat err =       0.002871667390
      target stat err =       0.001185877569
              std dev =       0.683436312081
             le_variance =       0.467085192671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281791134424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-05, overlap shift 3.5527e-04 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654810770587       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654908553998       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654926660053       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654935746880       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654941110396       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654944853169       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654946970807       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654946885252       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654946685084       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654946833094       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654947321486       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654947427877       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654947414950       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e-05 is 5.150204e-03

solving harmonic davidson linear method for identity shift 1.4211e-04, overlap shift 1.4211e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654810770587       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654908323722       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654926369921       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654935416886       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654940751623       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654944466648       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654946563419       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654946475387       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654946276290       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654946422922       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654946905733       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654947010540       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654946997523       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e-04 is 5.121143e-03

solving harmonic davidson linear method for identity shift 5.6843e-04, overlap shift 5.6843e-03 and omega -2.3900e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.654810770587       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.654907413361       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.654925223839       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.654934114448       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.654939336717       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.654942943967       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.654944960264       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.654944863046       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.654944668228       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.654944809585       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.654945271002       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.654945369779       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.654945356453       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e-04 is 5.008155e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.749132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2435e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_01                 1.078698e-01 3 1  ON 0
ci_02                -2.390329e-02 3 1  ON 1
ci_03                -2.417555e-02 3 1  ON 2
ci_04                 2.207554e-02 3 1  ON 3
ci_05                -1.908200e-02 3 1  ON 4
ci_06                -1.948188e-02 3 1  ON 5
ci_07                 2.571630e-02 3 1  ON 6
ci_08                -4.214666e-03 3 1  ON 7
ci_09                -7.552328e-03 3 1  ON 8
ci_10                -7.686084e-03 3 1  ON 9
ci_11                 1.376375e-02 3 1  ON 10
ci_12                 7.033140e-03 3 1  ON 11
ci_13                 1.382696e-02 3 1  ON 12
ci_14                 1.282457e-02 3 1  ON 13
ci_15                 5.118492e-03 3 1  ON 14
ci_16                 5.709259e-03 3 1  ON 15
ci_17                -4.997322e-03 3 1  ON 16
ci_18                -5.559069e-03 3 1  ON 17
ci_19                 1.034333e-02 3 1  ON 18
ci_20                 6.232715e-03 3 1  ON 19
ci_21                 8.449543e-03 3 1  ON 20
ci_22                 8.874580e-03 3 1  ON 21
ci_23                 4.134236e-03 3 1  ON 22
ci_24                 5.212053e-03 3 1  ON 23
ci_25                 3.029214e-03 3 1  ON 24
ci_26                 3.816801e-03 3 1  ON 25
ci_27                 3.289594e-03 3 1  ON 26
ci_28                 7.577167e-04 3 1  ON 27
ci_29                 1.187688e-03 3 1  ON 28
ci_30                -7.172767e-04 3 1  ON 29
ci_31                 1.060364e-03 3 1  ON 30
ci_32                -5.256091e-04 3 1  ON 31
ci_33                -1.012867e-03 3 1  ON 32
ci_34                 1.178413e-03 3 1  ON 33
ci_35                 1.274873e-03 3 1  ON 34
ci_36                -5.505385e-04 3 1  ON 35
ci_37                -5.051513e-04 3 1  ON 36
ci_38                -2.744299e-04 3 1  ON 37
ci_39                -1.550386e-04 3 1  ON 38
ci_40                -1.920390e-03 3 1  ON 39
ci_41                -4.763114e-04 3 1  ON 40
ci_42                -1.674205e-03 3 1  ON 41
ci_43                -1.270034e-03 3 1  ON 42
ci_44                -2.190627e-03 3 1  ON 43
ci_45                -2.548016e-04 3 1  ON 44
ci_46                -1.713238e-03 3 1  ON 45
ci_47                 1.408502e-03 3 1  ON 46
ci_48                 2.898843e-03 3 1  ON 47
ci_49                -8.473151e-04 3 1  ON 48
ci_50                -8.241651e-04 3 1  ON 49
ci_51                -5.989188e-04 3 1  ON 50
ci_52                -6.504973e-04 3 1  ON 51
ci_53                -7.939159e-04 3 1  ON 52
ci_54                -1.102540e-03 3 1  ON 53
ci_55                -1.266615e-03 3 1  ON 54
ci_56                 1.072392e-03 3 1  ON 55
ci_57                 2.087554e-03 3 1  ON 56
ci_58                -1.859642e-04 3 1  ON 57
ci_59                -5.945208e-04 3 1  ON 58
ci_60                 1.441104e-04 3 1  ON 59
ci_61                -9.848913e-04 3 1  ON 60
ci_62                -3.885913e-04 3 1  ON 61
ci_63                -2.356274e-04 3 1  ON 62
ci_64                -6.152833e-04 3 1  ON 63
ci_65                -1.033060e-04 3 1  ON 64
ci_66                -1.160410e-04 3 1  ON 65
ci_67                -1.944523e-04 3 1  ON 66
ci_68                -1.811783e-03 3 1  ON 67
ci_69                -1.806247e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.8185
    reference variance = 0.37171
====================================================
  Execution time = 4.4119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8908e-01
  Total weights = 1.9642e+06
  Execution time = 5.9156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476414718518
                                         uncertainty =       0.003123841112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476414718518
                                         uncertainty =       0.003123841112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488028307
  error estimate for blocks of size 2^( 2) =       0.000509906105
  error estimate for blocks of size 2^( 3) =       0.000530648722
  error estimate for blocks of size 2^( 4) =       0.000546963652
  error estimate for blocks of size 2^( 5) =       0.000556231885
  error estimate for blocks of size 2^( 6) =       0.000560601294
  error estimate for blocks of size 2^( 7) =       0.000563850394

      target function =      -0.619936064071
              le_mean =     -22.818178804652
             les_mean =     521.242931993896
             stat err =       0.000556911806
             autocorr =       1.302215390293
   target nu stat err =       0.000556911806
   target dn stat err =       0.043159567064
      target stat err =       0.015345291543
              std dev =       0.690176250377
             le_variance =       0.476343256585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472249106822
                                         uncertainty =       0.002435781912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472249106822
                                         uncertainty =       0.002435781912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485892836
  error estimate for blocks of size 2^( 2) =       0.000507942186
  error estimate for blocks of size 2^( 3) =       0.000528773286
  error estimate for blocks of size 2^( 4) =       0.000545053639
  error estimate for blocks of size 2^( 5) =       0.000554386868
  error estimate for blocks of size 2^( 6) =       0.000558645306
  error estimate for blocks of size 2^( 7) =       0.000561963267

      target function =      -0.651899320459
              le_mean =     -22.818080353795
             les_mean =     521.153876757339
             stat err =       0.000555012270
             autocorr =       1.304740598342
   target nu stat err =       0.000555012270
   target dn stat err =       0.003417314699
      target stat err =       0.001383340041
              std dev =       0.687156239198
             le_variance =       0.472183697069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474026142359
                                         uncertainty =       0.002350706086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474026142359
                                         uncertainty =       0.002350706086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486803342
  error estimate for blocks of size 2^( 2) =       0.000508818219
  error estimate for blocks of size 2^( 3) =       0.000529635581
  error estimate for blocks of size 2^( 4) =       0.000545894809
  error estimate for blocks of size 2^( 5) =       0.000555234636
  error estimate for blocks of size 2^( 6) =       0.000559536585
  error estimate for blocks of size 2^( 7) =       0.000562989150

      target function =      -0.538884636713
              le_mean =     -22.818155098209
             les_mean =     521.469184648006
             stat err =       0.000555913795
             autocorr =       1.304090704552
   target nu stat err =       0.000555913795
   target dn stat err =       0.267229509798
      target stat err =       0.073049119301
              std dev =       0.688443889152
             le_variance =       0.473954988511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472253826814
                                         uncertainty =       0.002438826252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472253826814
                                         uncertainty =       0.002438826252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485895269
  error estimate for blocks of size 2^( 2) =       0.000507944282
  error estimate for blocks of size 2^( 3) =       0.000528775202
  error estimate for blocks of size 2^( 4) =       0.000545056097
  error estimate for blocks of size 2^( 5) =       0.000554389470
  error estimate for blocks of size 2^( 6) =       0.000558648551
  error estimate for blocks of size 2^( 7) =       0.000561965974

      target function =      -0.649355056064
              le_mean =     -22.818079998537
             les_mean =     521.160337708831
             stat err =       0.000555015023
             autocorr =       1.304740478655
   target nu stat err =       0.000555015023
   target dn stat err =       0.007342122089
      target stat err =       0.002880859438
              std dev =       0.687159679301
             le_variance =       0.472188424857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.619936064071        initial
     3.5527e-05     3.5527e-04             5.1502e-03        -0.651899320459  <--
     1.4211e-04     1.4211e-03             5.1211e-03        -0.538884636713
     5.6843e-04     5.6843e-03             5.0082e-03        -0.649355056064

*****************************************************************************
Applying the update for shift_i =   3.5527e-05     and shift_s =   3.5527e-04
*****************************************************************************

  Execution time = 7.3796e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_01                 1.078698e-01 3 1  ON 0
ci_02                -2.390230e-02 3 1  ON 1
ci_03                -2.417651e-02 3 1  ON 2
ci_04                 2.207579e-02 3 1  ON 3
ci_05                -1.907948e-02 3 1  ON 4
ci_06                -1.948050e-02 3 1  ON 5
ci_07                 2.571337e-02 3 1  ON 6
ci_08                -4.217148e-03 3 1  ON 7
ci_09                -7.553567e-03 3 1  ON 8
ci_10                -7.682345e-03 3 1  ON 9
ci_11                 1.376331e-02 3 1  ON 10
ci_12                 7.034005e-03 3 1  ON 11
ci_13                 1.383680e-02 3 1  ON 12
ci_14                 1.280617e-02 3 1  ON 13
ci_15                 5.117128e-03 3 1  ON 14
ci_16                 5.713397e-03 3 1  ON 15
ci_17                -4.991186e-03 3 1  ON 16
ci_18                -5.556081e-03 3 1  ON 17
ci_19                 1.034436e-02 3 1  ON 18
ci_20                 6.234356e-03 3 1  ON 19
ci_21                 8.455975e-03 3 1  ON 20
ci_22                 8.873301e-03 3 1  ON 21
ci_23                 4.135013e-03 3 1  ON 22
ci_24                 5.212491e-03 3 1  ON 23
ci_25                 3.029936e-03 3 1  ON 24
ci_26                 3.817300e-03 3 1  ON 25
ci_27                 3.292093e-03 3 1  ON 26
ci_28                 7.557775e-04 3 1  ON 27
ci_29                 1.190712e-03 3 1  ON 28
ci_30                -7.214256e-04 3 1  ON 29
ci_31                 1.063383e-03 3 1  ON 30
ci_32                -5.247298e-04 3 1  ON 31
ci_33                -1.012076e-03 3 1  ON 32
ci_34                 1.179406e-03 3 1  ON 33
ci_35                 1.274793e-03 3 1  ON 34
ci_36                -5.494724e-04 3 1  ON 35
ci_37                -5.045573e-04 3 1  ON 36
ci_38                -2.766373e-04 3 1  ON 37
ci_39                -1.563288e-04 3 1  ON 38
ci_40                -1.922647e-03 3 1  ON 39
ci_41                -4.759275e-04 3 1  ON 40
ci_42                -1.675992e-03 3 1  ON 41
ci_43                -1.268966e-03 3 1  ON 42
ci_44                -2.190954e-03 3 1  ON 43
ci_45                -2.535481e-04 3 1  ON 44
ci_46                -1.716356e-03 3 1  ON 45
ci_47                 1.413674e-03 3 1  ON 46
ci_48                 2.900745e-03 3 1  ON 47
ci_49                -8.478427e-04 3 1  ON 48
ci_50                -8.261026e-04 3 1  ON 49
ci_51                -6.014478e-04 3 1  ON 50
ci_52                -6.544108e-04 3 1  ON 51
ci_53                -7.935179e-04 3 1  ON 52
ci_54                -1.103298e-03 3 1  ON 53
ci_55                -1.267294e-03 3 1  ON 54
ci_56                 1.070189e-03 3 1  ON 55
ci_57                 2.088639e-03 3 1  ON 56
ci_58                -1.833070e-04 3 1  ON 57
ci_59                -5.932545e-04 3 1  ON 58
ci_60                 1.464238e-04 3 1  ON 59
ci_61                -1.013952e-03 3 1  ON 60
ci_62                -3.888498e-04 3 1  ON 61
ci_63                -2.348632e-04 3 1  ON 62
ci_64                -6.140905e-04 3 1  ON 63
ci_65                -1.007365e-04 3 1  ON 64
ci_66                -1.134342e-04 3 1  ON 65
ci_67                -1.934610e-04 3 1  ON 66
ci_68                -1.810835e-03 3 1  ON 67
ci_69                -1.806031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2624e+02 secs
  Total Execution time = 1.2292e+04 secs

=========================================================
  A new xml input file : FORM2.s099.cont.xml
