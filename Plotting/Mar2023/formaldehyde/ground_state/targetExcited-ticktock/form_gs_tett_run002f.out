Rank =    0  Free Memory = 81653 MB
Rank =    1  Free Memory = 81653 MB
Rank =    2  Free Memory = 81653 MB
Rank =    3  Free Memory = 81653 MB
Rank =    4  Free Memory = 81653 MB
Rank =    5  Free Memory = 81653 MB
Rank =    6  Free Memory = 81653 MB
Rank =    7  Free Memory = 81653 MB
Rank =    8  Free Memory = 81653 MB
Rank =    9  Free Memory = 81653 MB
Rank =   10  Free Memory = 81653 MB
Rank =   11  Free Memory = 81653 MB
Rank =   12  Free Memory = 81653 MB
Rank =   13  Free Memory = 81653 MB
Rank =   14  Free Memory = 81652 MB
Rank =   15  Free Memory = 81637 MB
Rank =   16  Free Memory = 81637 MB
Rank =   17  Free Memory = 81637 MB
Rank =   18  Free Memory = 81637 MB
Rank =   19  Free Memory = 81637 MB
Rank =   20  Free Memory = 81637 MB
Rank =   21  Free Memory = 81637 MB
Rank =   22  Free Memory = 81637 MB
Rank =   23  Free Memory = 81637 MB
Rank =   24  Free Memory = 81637 MB
Rank =   25  Free Memory = 81637 MB
Rank =   26  Free Memory = 81637 MB
Rank =   27  Free Memory = 81637 MB
Rank =   28  Free Memory = 81637 MB
Rank =   29  Free Memory = 81637 MB
Rank =   30  Free Memory = 81637 MB
Rank =   31  Free Memory = 81637 MB
Rank =   32  Free Memory = 88853 MB
Rank =   33  Free Memory = 88853 MB
Rank =   34  Free Memory = 88853 MB
Rank =   35  Free Memory = 88853 MB
Rank =   36  Free Memory = 88853 MB
Rank =   37  Free Memory = 88853 MB
Rank =   38  Free Memory = 88853 MB
Rank =   39  Free Memory = 88853 MB
Rank =   40  Free Memory = 88853 MB
Rank =   41  Free Memory = 88853 MB
Rank =   42  Free Memory = 88853 MB
Rank =   43  Free Memory = 88853 MB
Rank =   44  Free Memory = 88853 MB
Rank =   45  Free Memory = 88853 MB
Rank =   46  Free Memory = 88853 MB
Rank =   47  Free Memory = 88853 MB
Rank =   48  Free Memory = 88853 MB
Rank =   49  Free Memory = 88853 MB
Rank =   50  Free Memory = 88853 MB
Rank =   51  Free Memory = 88853 MB
Rank =   52  Free Memory = 88853 MB
Rank =   53  Free Memory = 88853 MB
Rank =   54  Free Memory = 88853 MB
Rank =   55  Free Memory = 88853 MB
Rank =   56  Free Memory = 88853 MB
Rank =   57  Free Memory = 88853 MB
Rank =   58  Free Memory = 88853 MB
Rank =   59  Free Memory = 88853 MB
Rank =   60  Free Memory = 88853 MB
Rank =   61  Free Memory = 88853 MB
Rank =   62  Free Memory = 88853 MB
Rank =   63  Free Memory = 88853 MB
Rank =   64  Free Memory = 88506 MB
Rank =   65  Free Memory = 88506 MB
Rank =   66  Free Memory = 88506 MB
Rank =   67  Free Memory = 88506 MB
Rank =   68  Free Memory = 88506 MB
Rank =   69  Free Memory = 88506 MB
Rank =   70  Free Memory = 88506 MB
Rank =   71  Free Memory = 88506 MB
Rank =   72  Free Memory = 88506 MB
Rank =   73  Free Memory = 88506 MB
Rank =   74  Free Memory = 88506 MB
Rank =   75  Free Memory = 88506 MB
Rank =   76  Free Memory = 88506 MB
Rank =   77  Free Memory = 88506 MB
Rank =   78  Free Memory = 88506 MB
Rank =   79  Free Memory = 88506 MB
Rank =   80  Free Memory = 88506 MB
Rank =   81  Free Memory = 88506 MB
Rank =   82  Free Memory = 88506 MB
Rank =   83  Free Memory = 88506 MB
Rank =   84  Free Memory = 88506 MB
Rank =   85  Free Memory = 88506 MB
Rank =   86  Free Memory = 88506 MB
Rank =   87  Free Memory = 88506 MB
Rank =   88  Free Memory = 88506 MB
Rank =   89  Free Memory = 88506 MB
Rank =   90  Free Memory = 88506 MB
Rank =   91  Free Memory = 88506 MB
Rank =   92  Free Memory = 88506 MB
Rank =   93  Free Memory = 88506 MB
Rank =   94  Free Memory = 88506 MB
Rank =   95  Free Memory = 88506 MB
Rank =   96  Free Memory = 90534 MB
Rank =   97  Free Memory = 90534 MB
Rank =   98  Free Memory = 90533 MB
Rank =   99  Free Memory = 90533 MB
Rank =  100  Free Memory = 90533 MB
Rank =  101  Free Memory = 90533 MB
Rank =  102  Free Memory = 90533 MB
Rank =  103  Free Memory = 90533 MB
Rank =  104  Free Memory = 90532 MB
Rank =  105  Free Memory = 90532 MB
Rank =  106  Free Memory = 90532 MB
Rank =  107  Free Memory = 90532 MB
Rank =  108  Free Memory = 90532 MB
Rank =  109  Free Memory = 90532 MB
Rank =  110  Free Memory = 90532 MB
Rank =  111  Free Memory = 90532 MB
Rank =  112  Free Memory = 90532 MB
Rank =  113  Free Memory = 90532 MB
Rank =  114  Free Memory = 90532 MB
Rank =  115  Free Memory = 90532 MB
Rank =  116  Free Memory = 90532 MB
Rank =  117  Free Memory = 90532 MB
Rank =  118  Free Memory = 90532 MB
Rank =  119  Free Memory = 90532 MB
Rank =  120  Free Memory = 90532 MB
Rank =  121  Free Memory = 90532 MB
Rank =  122  Free Memory = 90532 MB
Rank =  123  Free Memory = 90532 MB
Rank =  124  Free Memory = 90532 MB
Rank =  125  Free Memory = 90532 MB
Rank =  126  Free Memory = 90532 MB
Rank =  127  Free Memory = 90532 MB
  Input file(s): opt_form_gs_tett_run002f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run002f.xml

  Project = FORM2
  date    = 2023-03-19 20:39:59 PDT
  host    = n0073.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 399

  Range of prime numbers to use as seeds over processors and threads = 2749-3803


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.659900e-01    1         1  ON     0
     uu_1                 1.059606e-01    1         1  ON     1
     uu_2                 6.585438e-03    1         1  ON     2
     uu_3                -5.283753e-02    1         1  ON     3
     uu_4                -8.663707e-02    1         1  ON     4
     uu_5                -1.051063e-01    1         1  ON     5
     uu_6                -1.113948e-01    1         1  ON     6
     uu_7                -1.038544e-01    1         1  ON     7
     uu_8                -8.046518e-02    1         1  ON     8
     uu_9                -4.288804e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458918e-01    1         1  ON     0
     ud_1                 1.068885e-01    1         1  ON     1
     ud_2                -9.362422e-03    1         1  ON     2
     ud_3                -6.924529e-02    1         1  ON     3
     ud_4                -1.012960e-01    1         1  ON     4
     ud_5                -1.172753e-01    1         1  ON     5
     ud_6                -1.213691e-01    1         1  ON     6
     ud_7                -1.120298e-01    1         1  ON     7
     ud_8                -8.585231e-02    1         1  ON     8
     ud_9                -4.559135e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.506186e-01    1         1  ON     0
     eC_1                -3.146073e-01    1         1  ON     1
     eC_2                -6.877446e-02    1         1  ON     2
     eC_3                 8.858703e-02    1         1  ON     3
     eC_4                 1.363007e-01    1         1  ON     4
     eC_5                 2.006961e-01    1         1  ON     5
     eC_6                 2.136812e-01    1         1  ON     6
     eC_7                 1.597089e-01    1         1  ON     7
     eC_8                 3.434703e-02    1         1  ON     8
     eC_9                 1.047648e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.235916e-01    1         1  ON     0
     eO_1                -5.244949e-01    1         1  ON     1
     eO_2                -1.331913e-01    1         1  ON     2
     eO_3                 1.329657e-01    1         1  ON     3
     eO_4                 2.611683e-01    1         1  ON     4
     eO_5                 3.461237e-01    1         1  ON     5
     eO_6                 3.302408e-01    1         1  ON     6
     eO_7                 2.658993e-01    1         1  ON     7
     eO_8                 1.071358e-01    1         1  ON     8
     eO_9                 2.449963e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.397717e-01    1         1  ON     0
     eH1_1                -4.653272e-02    1         1  ON     1
     eH1_2                -2.257470e-02    1         1  ON     2
     eH1_3                -3.701495e-02    1         1  ON     3
     eH1_4                -8.233741e-03    1         1  ON     4
     eH1_5                 1.739621e-02    1         1  ON     5
     eH1_6                 4.606475e-02    1         1  ON     6
     eH1_7                 3.927161e-02    1         1  ON     7
     eH1_8                 7.524879e-02    1         1  ON     8
     eH1_9                 6.186013e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.394482e-01    1         1  ON     0
     eH2_1                -4.450287e-02    1         1  ON     1
     eH2_2                -2.173021e-02    1         1  ON     2
     eH2_3                -3.498437e-02    1         1  ON     3
     eH2_4                -6.920902e-03    1         1  ON     4
     eH2_5                 2.004559e-02    1         1  ON     5
     eH2_6                 4.945828e-02    1         1  ON     6
     eH2_7                 4.370990e-02    1         1  ON     7
     eH2_8                 6.697447e-02    1         1  ON     8
     eH2_9                 6.199319e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.712862e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 5.9584e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7611
    reference variance = 0.365394
====================================================
  Execution time = 4.4867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4985e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4659e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449880402916
                                         uncertainty =       0.003053488309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449880402916
                                         uncertainty =       0.003053488309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474260514
  error estimate for blocks of size 2^( 2) =       0.000499598734
  error estimate for blocks of size 2^( 3) =       0.000523219988
  error estimate for blocks of size 2^( 4) =       0.000541470816
  error estimate for blocks of size 2^( 5) =       0.000552901522
  error estimate for blocks of size 2^( 6) =       0.000558568841
  error estimate for blocks of size 2^( 7) =       0.000562673281

      target function =      -0.745392849003
              le_mean =     -22.814262718173
             les_mean =     520.940429218441
             stat err =       0.000553903615
             autocorr =       1.364063111470
   target nu stat err =       0.000553903615
   target dn stat err =       0.003142032149
      target stat err =       0.002714642014
              std dev =       0.670705650450
             le_variance =       0.449846069546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281426271817e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745401737386       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745416642156       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745426355572       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745431397924       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745433408914       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745437073831       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745437744871       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745439631636       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745441863231       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745443640615       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745444955784       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745446113361       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745447896659       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745448312875       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745453978651       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745456616634       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745458029810       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745458707441       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745459059961       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745459955729       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745461330045       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745461338703       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745461955582       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745462180022       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745462497211       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745462634515       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745462556757       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745462625541       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745462624977       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745462580498       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745462616860       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745462656435       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745462639354       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 3.792887e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745401737386       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745405999429       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745408876752       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745410318575       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745410901671       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745411910620       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745412094691       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745412634743       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745413316742       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745413756564       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745414112054       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745414466306       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745414592588       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745415051877       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745416415696       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745417001324       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745417399755       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745417584427       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745417673519       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745417901883       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745418226022       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745418191051       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745418323966       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745418377526       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745418442556       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745418465412       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745418438786       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745418458658       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745418455436       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745418446120       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745418453487       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 9.301627e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745401737386       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745402842631       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745403596969       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745403971117       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745404123083       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745404381508       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745404429259       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745404569231       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745404747102       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745404858411       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745404950447       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745405038452       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745405066720       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745405186331       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745405526447       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745405670042       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745405770834       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745405817574       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745405840029       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745405897342       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745405976526       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745405965479       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745405997359       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745406010632       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745406025912       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745406030821       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745406024009       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745406028987       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745406027728       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745406025987       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745406027515       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 2.316126e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9574e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
uu_0  2.661052e-01                 1 1 ON  0
uu_1  1.059770e-01                 1 1 ON  1
uu_2  6.590410e-03                 1 1 ON  2
uu_3  -5.280823e-02                1 1 ON  3
uu_4  -8.657874e-02                1 1 ON  4
uu_5  -1.050268e-01                1 1 ON  5
uu_6  -1.113736e-01                1 1 ON  6
uu_7  -1.039602e-01                1 1 ON  7
uu_8  -8.077745e-02                1 1 ON  8
uu_9  -4.296540e-02                1 1 ON  9
ud_0  3.460904e-01                 1 1 ON  10
ud_1  1.069791e-01                 1 1 ON  11
ud_2  -9.351970e-03                1 1 ON  12
ud_3  -6.928760e-02                1 1 ON  13
ud_4  -1.013777e-01                1 1 ON  14
ud_5  -1.173858e-01                1 1 ON  15
ud_6  -1.215299e-01                1 1 ON  16
ud_7  -1.121201e-01                1 1 ON  17
ud_8  -8.581119e-02                1 1 ON  18
ud_9  -4.551752e-02                1 1 ON  19
eC_0  -4.510474e-01                1 1 ON  20
eC_1  -3.148012e-01                1 1 ON  21
eC_2  -6.901238e-02                1 1 ON  22
eC_3  8.839797e-02                 1 1 ON  23
eC_4  1.362746e-01                 1 1 ON  24
eC_5  2.008403e-01                 1 1 ON  25
eC_6  2.136665e-01                 1 1 ON  26
eC_7  1.603085e-01                 1 1 ON  27
eC_8  3.472880e-02                 1 1 ON  28
eC_9  1.017477e-03                 1 1 ON  29
eO_0  -8.243112e-01                1 1 ON  30
eO_1  -5.250660e-01                1 1 ON  31
eO_2  -1.336561e-01                1 1 ON  32
eO_3  1.325272e-01                 1 1 ON  33
eO_4  2.609939e-01                 1 1 ON  34
eO_5  3.461107e-01                 1 1 ON  35
eO_6  3.305859e-01                 1 1 ON  36
eO_7  2.667806e-01                 1 1 ON  37
eO_8  1.080659e-01                 1 1 ON  38
eO_9  2.469339e-02                 1 1 ON  39
eH1_0 -1.397924e-01                1 1 ON  40
eH1_1 -4.651317e-02                1 1 ON  41
eH1_2 -2.264025e-02                1 1 ON  42
eH1_3 -3.709246e-02                1 1 ON  43
eH1_4 -8.232668e-03                1 1 ON  44
eH1_5 1.743244e-02                 1 1 ON  45
eH1_6 4.605027e-02                 1 1 ON  46
eH1_7 3.928733e-02                 1 1 ON  47
eH1_8 7.489071e-02                 1 1 ON  48
eH1_9 6.210072e-02                 1 1 ON  49
eH2_0 -1.394500e-01                1 1 ON  50
eH2_1 -4.451135e-02                1 1 ON  51
eH2_2 -2.183151e-02                1 1 ON  52
eH2_3 -3.496313e-02                1 1 ON  53
eH2_4 -6.855240e-03                1 1 ON  54
eH2_5 1.999740e-02                 1 1 ON  55
eH2_6 4.938280e-02                 1 1 ON  56
eH2_7 4.368479e-02                 1 1 ON  57
eH2_8 6.688311e-02                 1 1 ON  58
eH2_9 6.220881e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8095
    reference variance = 0.323948
====================================================
  Execution time = 4.6553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6018e-01
  Total weights = 2.0000e+06
  Execution time = 3.5062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460169003609
                                         uncertainty =       0.005501413938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460169003609
                                         uncertainty =       0.005501413938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479661195
  error estimate for blocks of size 2^( 2) =       0.000504883117
  error estimate for blocks of size 2^( 3) =       0.000528858005
  error estimate for blocks of size 2^( 4) =       0.000546573215
  error estimate for blocks of size 2^( 5) =       0.000557146482
  error estimate for blocks of size 2^( 6) =       0.000562401352
  error estimate for blocks of size 2^( 7) =       0.000567154191

      target function =      -0.736800979766
              le_mean =     -22.814763065563
             les_mean =     520.973563232411
             stat err =       0.000558318810
             autocorr =       1.354862892558
   target nu stat err =       0.000558318810
   target dn stat err =       0.004984941640
      target stat err =       0.004145443036
              std dev =       0.678343367840
             le_variance =       0.460149724692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460265809943
                                         uncertainty =       0.005511871709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460265809943
                                         uncertainty =       0.005511871709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479711600
  error estimate for blocks of size 2^( 2) =       0.000504843750
  error estimate for blocks of size 2^( 3) =       0.000528726646
  error estimate for blocks of size 2^( 4) =       0.000546368077
  error estimate for blocks of size 2^( 5) =       0.000556873239
  error estimate for blocks of size 2^( 6) =       0.000562085587
  error estimate for blocks of size 2^( 7) =       0.000566806105

      target function =      -0.736721296465
              le_mean =     -22.814766260887
             les_mean =     520.973805747207
             stat err =       0.000558033252
             autocorr =       1.353192916981
   target nu stat err =       0.000558033252
   target dn stat err =       0.004994286865
      target stat err =       0.004152123749
              std dev =       0.678414650792
             le_variance =       0.460246438409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460224006380
                                         uncertainty =       0.005507480370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460224006380
                                         uncertainty =       0.005507480370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479689839
  error estimate for blocks of size 2^( 2) =       0.000504861918
  error estimate for blocks of size 2^( 3) =       0.000528786389
  error estimate for blocks of size 2^( 4) =       0.000546462125
  error estimate for blocks of size 2^( 5) =       0.000556999266
  error estimate for blocks of size 2^( 6) =       0.000562231915
  error estimate for blocks of size 2^( 7) =       0.000566967124

      target function =      -0.736755718947
              le_mean =     -22.814764148459
             les_mean =     520.973667602175
             stat err =       0.000558165108
             autocorr =       1.353955312897
   target nu stat err =       0.000558165108
   target dn stat err =       0.004990331814
      target stat err =       0.004149301538
              std dev =       0.678383875447
             le_variance =       0.460204682466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460175861630
                                         uncertainty =       0.005502203766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460175861630
                                         uncertainty =       0.005502203766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479664767
  error estimate for blocks of size 2^( 2) =       0.000504880252
  error estimate for blocks of size 2^( 3) =       0.000528848655
  error estimate for blocks of size 2^( 4) =       0.000546558822
  error estimate for blocks of size 2^( 5) =       0.000557127489
  error estimate for blocks of size 2^( 6) =       0.000562379542
  error estimate for blocks of size 2^( 7) =       0.000567130126

      target function =      -0.736795338356
              le_mean =     -22.814763117870
             les_mean =     520.973572471523
             stat err =       0.000558298995
             autocorr =       1.354746549551
   target nu stat err =       0.000558298995
   target dn stat err =       0.004985642138
      target stat err =       0.004145946680
              std dev =       0.678348418660
             le_variance =       0.460156577098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736800979766        initial  <--
     2.5000e-01     2.5000e+00             3.7929e-03        -0.736721296465
     1.0000e+00     1.0000e+01             9.3016e-04        -0.736755718947
     4.0000e+00     4.0000e+01             2.3161e-04        -0.736795338356

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0942
  </log>
  <optVariables href="FORM2.s000.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2415e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2785e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8728
    reference variance = 0.582885
====================================================
  Execution time = 4.4349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5026e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452553948500
                                         uncertainty =       0.006661640335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452553948500
                                         uncertainty =       0.006661640335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475640402
  error estimate for blocks of size 2^( 2) =       0.000501456500
  error estimate for blocks of size 2^( 3) =       0.000524791073
  error estimate for blocks of size 2^( 4) =       0.000543223933
  error estimate for blocks of size 2^( 5) =       0.000553473817
  error estimate for blocks of size 2^( 6) =       0.000559941264
  error estimate for blocks of size 2^( 7) =       0.000562918318

      target function =      -0.743147629018
              le_mean =     -22.815060529866
             les_mean =     520.979454338840
             stat err =       0.000554889333
             autocorr =       1.360991076629
   target nu stat err =       0.000554889333
   target dn stat err =       0.006539217723
      target stat err =       0.005507376256
              std dev =       0.672657107017
             le_variance =       0.452467583621


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281506052987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743187624885       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743190640531       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743194111392       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743195467992       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743196064931       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743196497118       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743196999926       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743197718356       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743198247556       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743198742179       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743198929958       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743199321130       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743199685532       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743200158385       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743201060267       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743201459155       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743201841743       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743202183620       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743202257827       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743202386470       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743202468626       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743202509140       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743202554343       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743202718046       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743202771721       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743202764294       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743202766065       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743202770443       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743202769034       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743202770669       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743202769884       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743202770880       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743202772664       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 4.998029e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743187624885       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743188391765       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743189275386       residual = 9.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743189619634       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743189770485       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743189880064       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743190007918       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743190189779       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743190320796       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743190432212       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743190493389       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743190593247       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743190686149       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743190806117       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743191034237       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743191133195       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743191228346       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743191313308       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743191331571       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743191362488       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743191383731       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743191393671       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743191404828       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743191445249       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743191458051       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743191456091       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743191456474       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743191457527       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743191457149       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743191457569       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743191457359       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743191457598       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743191458034       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.256652e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743187624885       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743187817433       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743188039354       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743188125741       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743188163559       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743188191050       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743188223148       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743188268755       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743188301400       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743188328598       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743188344802       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743188369825       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743188393148       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743188423244       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743188480442       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743188505131       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743188528886       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743188550094       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743188554642       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743188562294       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743188567647       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743188570120       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743188572900       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743188582973       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743188586135       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743188585638       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743188585730       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743188585991       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743188585895       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743188586001       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743188585947       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743188586007       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743188586115       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 3.146167e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9419e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
 uu_0                 2.660259e-01 1 1  ON 0
 uu_1                 1.059798e-01 1 1  ON 1
 uu_2                 6.599667e-03 1 1  ON 2
 uu_3                -5.282948e-02 1 1  ON 3
 uu_4                -8.663535e-02 1 1  ON 4
 uu_5                -1.051106e-01 1 1  ON 5
 uu_6                -1.114057e-01 1 1  ON 6
 uu_7                -1.038713e-01 1 1  ON 7
 uu_8                -8.049755e-02 1 1  ON 8
 uu_9                -4.290657e-02 1 1  ON 9
 ud_0                 3.459294e-01 1 1  ON 10
 ud_1                 1.069097e-01 1 1  ON 11
 ud_2                -9.356619e-03 1 1  ON 12
 ud_3                -6.924480e-02 1 1  ON 13
 ud_4                -1.013013e-01 1 1  ON 14
 ud_5                -1.172900e-01 1 1  ON 15
 ud_6                -1.213918e-01 1 1  ON 16
 ud_7                -1.120487e-01 1 1  ON 17
 ud_8                -8.586905e-02 1 1  ON 18
 ud_9                -4.558862e-02 1 1  ON 19
 eC_0                -4.507009e-01 1 1  ON 20
 eC_1                -3.146693e-01 1 1  ON 21
 eC_2                -6.880900e-02 1 1  ON 22
 eC_3                 8.859303e-02 1 1  ON 23
 eC_4                 1.363228e-01 1 1  ON 24
 eC_5                 2.007405e-01 1 1  ON 25
 eC_6                 2.137078e-01 1 1  ON 26
 eC_7                 1.597591e-01 1 1  ON 27
 eC_8                 3.437497e-02 1 1  ON 28
 eC_9                 1.051342e-03 1 1  ON 29
 eO_0                -8.237173e-01 1 1  ON 30
 eO_1                -5.245853e-01 1 1  ON 31
 eO_2                -1.332590e-01 1 1  ON 32
 eO_3                 1.329258e-01 1 1  ON 33
 eO_4                 2.611755e-01 1 1  ON 34
 eO_5                 3.461754e-01 1 1  ON 35
 eO_6                 3.303219e-01 1 1  ON 36
 eO_7                 2.659832e-01 1 1  ON 37
 eO_8                 1.072200e-01 1 1  ON 38
 eO_9                 2.451536e-02 1 1  ON 39
eH1_0                -1.397895e-01 1 1  ON 40
eH1_1                -4.655974e-02 1 1  ON 41
eH1_2                -2.258761e-02 1 1  ON 42
eH1_3                -3.702357e-02 1 1  ON 43
eH1_4                -8.238849e-03 1 1  ON 44
eH1_5                 1.740333e-02 1 1  ON 45
eH1_6                 4.610216e-02 1 1  ON 46
eH1_7                 3.929809e-02 1 1  ON 47
eH1_8                 7.521290e-02 1 1  ON 48
eH1_9                 6.188520e-02 1 1  ON 49
eH2_0                -1.394628e-01 1 1  ON 50
eH2_1                -4.452514e-02 1 1  ON 51
eH2_2                -2.172956e-02 1 1  ON 52
eH2_3                -3.496533e-02 1 1  ON 53
eH2_4                -6.910418e-03 1 1  ON 54
eH2_5                 2.002963e-02 1 1  ON 55
eH2_6                 4.945897e-02 1 1  ON 56
eH2_7                 4.370309e-02 1 1  ON 57
eH2_8                 6.697067e-02 1 1  ON 58
eH2_9                 6.200358e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7644
    reference variance = 0.259551
====================================================
  Execution time = 4.5172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4684e-01
  Total weights = 2.0000e+06
  Execution time = 3.5117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446610163230
                                         uncertainty =       0.002935398701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446610163230
                                         uncertainty =       0.002935398701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472665717
  error estimate for blocks of size 2^( 2) =       0.000498238787
  error estimate for blocks of size 2^( 3) =       0.000522313000
  error estimate for blocks of size 2^( 4) =       0.000540269387
  error estimate for blocks of size 2^( 5) =       0.000550198422
  error estimate for blocks of size 2^( 6) =       0.000554106737
  error estimate for blocks of size 2^( 7) =       0.000558931365

      target function =      -0.747954518223
              le_mean =     -22.813220856582
             les_mean =     520.889871386993
             stat err =       0.000550876478
             autocorr =       1.358314230877
   target nu stat err =       0.000550876478
   target dn stat err =       0.002979827193
      target stat err =       0.002594454722
              std dev =       0.668450266824
             le_variance =       0.446825759218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446647843154
                                         uncertainty =       0.002936648381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446647843154
                                         uncertainty =       0.002936648381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472685723
  error estimate for blocks of size 2^( 2) =       0.000498243585
  error estimate for blocks of size 2^( 3) =       0.000522304299
  error estimate for blocks of size 2^( 4) =       0.000540250191
  error estimate for blocks of size 2^( 5) =       0.000550173714
  error estimate for blocks of size 2^( 6) =       0.000554079212
  error estimate for blocks of size 2^( 7) =       0.000558899799

      target function =      -0.747922548649
              le_mean =     -22.813220216223
             les_mean =     520.889879996554
             stat err =       0.000550850729
             autocorr =       1.358072286539
   target nu stat err =       0.000550850729
   target dn stat err =       0.002980842545
      target stat err =       0.002595062929
              std dev =       0.668478560694
             le_variance =       0.446863586108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446629204793
                                         uncertainty =       0.002936032659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446629204793
                                         uncertainty =       0.002936032659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472675827
  error estimate for blocks of size 2^( 2) =       0.000498241191
  error estimate for blocks of size 2^( 3) =       0.000522308571
  error estimate for blocks of size 2^( 4) =       0.000540259653
  error estimate for blocks of size 2^( 5) =       0.000550185910
  error estimate for blocks of size 2^( 6) =       0.000554092806
  error estimate for blocks of size 2^( 7) =       0.000558915391

      target function =      -0.747938362183
              le_mean =     -22.813220516660
             les_mean =     520.889874993395
             stat err =       0.000550863440
             autocorr =       1.358191830812
   target nu stat err =       0.000550863440
   target dn stat err =       0.002980342653
      target stat err =       0.002594763952
              std dev =       0.668464565313
             le_variance =       0.446844875079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446612544211
                                         uncertainty =       0.002935478226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446612544211
                                         uncertainty =       0.002935478226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472666981
  error estimate for blocks of size 2^( 2) =       0.000498239084
  error estimate for blocks of size 2^( 3) =       0.000522312440
  error estimate for blocks of size 2^( 4) =       0.000540268162
  error estimate for blocks of size 2^( 5) =       0.000550196849
  error estimate for blocks of size 2^( 6) =       0.000554104986
  error estimate for blocks of size 2^( 7) =       0.000558929358

      target function =      -0.747952498013
              le_mean =     -22.813220812232
             les_mean =     520.889871753744
             stat err =       0.000550874839
             autocorr =       1.358298881796
   target nu stat err =       0.000550874839
   target dn stat err =       0.002979891862
      target stat err =       0.002594493557
              std dev =       0.668452054759
             le_variance =       0.446828149511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747954518223        initial  <--
     2.5000e+00     2.5000e+01             4.9980e-04        -0.747922548649
     1.0000e+01     1.0000e+02             1.2567e-04        -0.747938362183
     4.0000e+01     4.0000e+02             3.1462e-05        -0.747952498013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7460
  </log>
  <optVariables href="FORM2.s001.opt.xml">
 uu_0                 2.659900e-01 1 1  ON 0
 uu_1                 1.059606e-01 1 1  ON 1
 uu_2                 6.585438e-03 1 1  ON 2
 uu_3                -5.283753e-02 1 1  ON 3
 uu_4                -8.663707e-02 1 1  ON 4
 uu_5                -1.051063e-01 1 1  ON 5
 uu_6                -1.113948e-01 1 1  ON 6
 uu_7                -1.038544e-01 1 1  ON 7
 uu_8                -8.046518e-02 1 1  ON 8
 uu_9                -4.288804e-02 1 1  ON 9
 ud_0                 3.458918e-01 1 1  ON 10
 ud_1                 1.068885e-01 1 1  ON 11
 ud_2                -9.362422e-03 1 1  ON 12
 ud_3                -6.924529e-02 1 1  ON 13
 ud_4                -1.012960e-01 1 1  ON 14
 ud_5                -1.172753e-01 1 1  ON 15
 ud_6                -1.213691e-01 1 1  ON 16
 ud_7                -1.120298e-01 1 1  ON 17
 ud_8                -8.585231e-02 1 1  ON 18
 ud_9                -4.559135e-02 1 1  ON 19
 eC_0                -4.506186e-01 1 1  ON 20
 eC_1                -3.146073e-01 1 1  ON 21
 eC_2                -6.877446e-02 1 1  ON 22
 eC_3                 8.858703e-02 1 1  ON 23
 eC_4                 1.363007e-01 1 1  ON 24
 eC_5                 2.006961e-01 1 1  ON 25
 eC_6                 2.136812e-01 1 1  ON 26
 eC_7                 1.597089e-01 1 1  ON 27
 eC_8                 3.434703e-02 1 1  ON 28
 eC_9                 1.047648e-03 1 1  ON 29
 eO_0                -8.235916e-01 1 1  ON 30
 eO_1                -5.244949e-01 1 1  ON 31
 eO_2                -1.331913e-01 1 1  ON 32
 eO_3                 1.329657e-01 1 1  ON 33
 eO_4                 2.611683e-01 1 1  ON 34
 eO_5                 3.461237e-01 1 1  ON 35
 eO_6                 3.302408e-01 1 1  ON 36
 eO_7                 2.658993e-01 1 1  ON 37
 eO_8                 1.071358e-01 1 1  ON 38
 eO_9                 2.449963e-02 1 1  ON 39
eH1_0                -1.397717e-01 1 1  ON 40
eH1_1                -4.653272e-02 1 1  ON 41
eH1_2                -2.257470e-02 1 1  ON 42
eH1_3                -3.701495e-02 1 1  ON 43
eH1_4                -8.233741e-03 1 1  ON 44
eH1_5                 1.739621e-02 1 1  ON 45
eH1_6                 4.606475e-02 1 1  ON 46
eH1_7                 3.927161e-02 1 1  ON 47
eH1_8                 7.524879e-02 1 1  ON 48
eH1_9                 6.186013e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450287e-02 1 1  ON 51
eH2_2                -2.173021e-02 1 1  ON 52
eH2_3                -3.498437e-02 1 1  ON 53
eH2_4                -6.920902e-03 1 1  ON 54
eH2_5                 2.004559e-02 1 1  ON 55
eH2_6                 4.945828e-02 1 1  ON 56
eH2_7                 4.370990e-02 1 1  ON 57
eH2_8                 6.697447e-02 1 1  ON 58
eH2_9                 6.199319e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2223e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2802e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7542
    reference variance = 0.262886
====================================================
  Execution time = 4.4803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4606e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4842e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446148519961
                                         uncertainty =       0.002910341680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446148519961
                                         uncertainty =       0.002910341680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472261307
  error estimate for blocks of size 2^( 2) =       0.000497574600
  error estimate for blocks of size 2^( 3) =       0.000521642959
  error estimate for blocks of size 2^( 4) =       0.000539108202
  error estimate for blocks of size 2^( 5) =       0.000550271960
  error estimate for blocks of size 2^( 6) =       0.000557384885
  error estimate for blocks of size 2^( 7) =       0.000562505463

      target function =      -0.748570076119
              le_mean =     -22.815605986769
             les_mean =     520.997937804692
             stat err =       0.000552317627
             autocorr =       1.367770015380
   target nu stat err =       0.000552317627
   target dn stat err =       0.003264252205
      target stat err =       0.002843583674
              std dev =       0.667878345378
             le_variance =       0.446061484225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281560598677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748579728536       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748580129826       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748580365944       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748580449509       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748580494739       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748580553407       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748580580921       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748580592097       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748580595616       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748580612720       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748580626369       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748580643689       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748580646966       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748580651243       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748580669215       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748580688683       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748580702418       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748580706467       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748580723110       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748580733729       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748580742054       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748580746064       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748580747281       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748580747816       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748580751178       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748580751423       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748580750614       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748580751255       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748580750902       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748580750928       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748580751525       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748580751720       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 2.851673e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748579728536       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748579829013       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748579888149       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748579909073       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748579920411       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748579935090       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748579941965       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748579944771       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748579945653       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748579949932       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748579953357       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748579957704       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748579958492       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748579959570       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748579964065       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748579968934       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748579972366       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748579973377       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748579977537       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748579980191       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748579982270       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748579983269       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748579983569       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748579983704       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748579984544       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748579984604       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748579984401       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748579984561       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748579984473       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748579984480       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748579984629       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748579984677       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 7.128416e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748579728536       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748579753665       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748579768456       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748579773689       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748579776525       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748579780196       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748579781914       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748579782616       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748579782837       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748579783907       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748579784764       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748579785852       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748579786045       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748579786316       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748579787440       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748579788658       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748579789516       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748579789769       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748579790809       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748579791473       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748579791991       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748579792241       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748579792317       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748579792349       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748579792560       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748579792574       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748579792524       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748579792563       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748579792541       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748579792544       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748579792581       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748579792593       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 1.782056e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9686e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
 uu_0                 2.659896e-01 1 1  ON 0
 uu_1                 1.059596e-01 1 1  ON 1
 uu_2                 6.584752e-03 1 1  ON 2
 uu_3                -5.283808e-02 1 1  ON 3
 uu_4                -8.663688e-02 1 1  ON 4
 uu_5                -1.051055e-01 1 1  ON 5
 uu_6                -1.113937e-01 1 1  ON 6
 uu_7                -1.038536e-01 1 1  ON 7
 uu_8                -8.046574e-02 1 1  ON 8
 uu_9                -4.288853e-02 1 1  ON 9
 ud_0                 3.458950e-01 1 1  ON 10
 ud_1                 1.068896e-01 1 1  ON 11
 ud_2                -9.362412e-03 1 1  ON 12
 ud_3                -6.924569e-02 1 1  ON 13
 ud_4                -1.012967e-01 1 1  ON 14
 ud_5                -1.172762e-01 1 1  ON 15
 ud_6                -1.213703e-01 1 1  ON 16
 ud_7                -1.120314e-01 1 1  ON 17
 ud_8                -8.585443e-02 1 1  ON 18
 ud_9                -4.559148e-02 1 1  ON 19
 eC_0                -4.506214e-01 1 1  ON 20
 eC_1                -3.146078e-01 1 1  ON 21
 eC_2                -6.877553e-02 1 1  ON 22
 eC_3                 8.858475e-02 1 1  ON 23
 eC_4                 1.362988e-01 1 1  ON 24
 eC_5                 2.006951e-01 1 1  ON 25
 eC_6                 2.136827e-01 1 1  ON 26
 eC_7                 1.597132e-01 1 1  ON 27
 eC_8                 3.435015e-02 1 1  ON 28
 eC_9                 1.048336e-03 1 1  ON 29
 eO_0                -8.235974e-01 1 1  ON 30
 eO_1                -5.244984e-01 1 1  ON 31
 eO_2                -1.331940e-01 1 1  ON 32
 eO_3                 1.329622e-01 1 1  ON 33
 eO_4                 2.611661e-01 1 1  ON 34
 eO_5                 3.461241e-01 1 1  ON 35
 eO_6                 3.302445e-01 1 1  ON 36
 eO_7                 2.659046e-01 1 1  ON 37
 eO_8                 1.071429e-01 1 1  ON 38
 eO_9                 2.450150e-02 1 1  ON 39
eH1_0                -1.397694e-01 1 1  ON 40
eH1_1                -4.653240e-02 1 1  ON 41
eH1_2                -2.257611e-02 1 1  ON 42
eH1_3                -3.701530e-02 1 1  ON 43
eH1_4                -8.234274e-03 1 1  ON 44
eH1_5                 1.739598e-02 1 1  ON 45
eH1_6                 4.606507e-02 1 1  ON 46
eH1_7                 3.927226e-02 1 1  ON 47
eH1_8                 7.524371e-02 1 1  ON 48
eH1_9                 6.186150e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450333e-02 1 1  ON 51
eH2_2                -2.173146e-02 1 1  ON 52
eH2_3                -3.498641e-02 1 1  ON 53
eH2_4                -6.921734e-03 1 1  ON 54
eH2_5                 2.004427e-02 1 1  ON 55
eH2_6                 4.945848e-02 1 1  ON 56
eH2_7                 4.371187e-02 1 1  ON 57
eH2_8                 6.697418e-02 1 1  ON 58
eH2_9                 6.199526e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.884
    reference variance = 0.330192
====================================================
  Execution time = 4.4739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4178e-01
  Total weights = 2.0000e+06
  Execution time = 3.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441835158329
                                         uncertainty =       0.002153187611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441835158329
                                         uncertainty =       0.002153187611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469988871
  error estimate for blocks of size 2^( 2) =       0.000495578862
  error estimate for blocks of size 2^( 3) =       0.000519476117
  error estimate for blocks of size 2^( 4) =       0.000537375595
  error estimate for blocks of size 2^( 5) =       0.000547314427
  error estimate for blocks of size 2^( 6) =       0.000553012157
  error estimate for blocks of size 2^( 7) =       0.000559500494

      target function =      -0.752235460624
              le_mean =     -22.815056251680
             les_mean =     520.968570624145
             stat err =       0.000549300668
             autocorr =       1.365982407227
   target nu stat err =       0.000549300668
   target dn stat err =       0.002477399909
      target stat err =       0.002214254043
              std dev =       0.664664635505
             le_variance =       0.441779077691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441834726383
                                         uncertainty =       0.002153266910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441834726383
                                         uncertainty =       0.002153266910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469988638
  error estimate for blocks of size 2^( 2) =       0.000495577154
  error estimate for blocks of size 2^( 3) =       0.000519472993
  error estimate for blocks of size 2^( 4) =       0.000537371317
  error estimate for blocks of size 2^( 5) =       0.000547309257
  error estimate for blocks of size 2^( 6) =       0.000553006452
  error estimate for blocks of size 2^( 7) =       0.000559494530

      target function =      -0.752235835453
              le_mean =     -22.815056281143
             les_mean =     520.968571530673
             stat err =       0.000549295389
             autocorr =       1.365957505453
   target nu stat err =       0.000549295389
   target dn stat err =       0.002477462278
      target stat err =       0.002214305849
              std dev =       0.664664306114
             le_variance =       0.441778639822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441834942017
                                         uncertainty =       0.002153227326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441834942017
                                         uncertainty =       0.002153227326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469988754
  error estimate for blocks of size 2^( 2) =       0.000495578007
  error estimate for blocks of size 2^( 3) =       0.000519474553
  error estimate for blocks of size 2^( 4) =       0.000537373454
  error estimate for blocks of size 2^( 5) =       0.000547311839
  error estimate for blocks of size 2^( 6) =       0.000553009301
  error estimate for blocks of size 2^( 7) =       0.000559497509

      target function =      -0.752235648333
              le_mean =     -22.815056266282
             les_mean =     520.968571071158
             stat err =       0.000549298026
             autocorr =       1.365969942740
   target nu stat err =       0.000549298026
   target dn stat err =       0.002477431148
      target stat err =       0.002214279991
              std dev =       0.664664470552
             le_variance =       0.441778858414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441835131236
                                         uncertainty =       0.002153192578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441835131236
                                         uncertainty =       0.002153192578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469988856
  error estimate for blocks of size 2^( 2) =       0.000495578755
  error estimate for blocks of size 2^( 3) =       0.000519475922
  error estimate for blocks of size 2^( 4) =       0.000537375327
  error estimate for blocks of size 2^( 5) =       0.000547314103
  error estimate for blocks of size 2^( 6) =       0.000553011800
  error estimate for blocks of size 2^( 7) =       0.000559500121

      target function =      -0.752235484135
              le_mean =     -22.815056253491
             les_mean =     520.968570679310
             stat err =       0.000549300338
             autocorr =       1.365980848718
   target nu stat err =       0.000549300338
   target dn stat err =       0.002477403816
      target stat err =       0.002214257288
              std dev =       0.664664614845
             le_variance =       0.441779050227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752235460624        initial
     2.5000e+01     2.5000e+02             2.8517e-05        -0.752235835453  <--
     1.0000e+02     1.0000e+03             7.1284e-06        -0.752235648333
     4.0000e+02     4.0000e+03             1.7821e-06        -0.752235484135

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 6.3637e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
 uu_0                 2.659881e-01 1 1  ON 0
 uu_1                 1.059568e-01 1 1  ON 1
 uu_2                 6.582699e-03 1 1  ON 2
 uu_3                -5.283974e-02 1 1  ON 3
 uu_4                -8.663628e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038514e-01 1 1  ON 7
 uu_8                -8.046740e-02 1 1  ON 8
 uu_9                -4.288999e-02 1 1  ON 9
 ud_0                 3.459044e-01 1 1  ON 10
 ud_1                 1.068930e-01 1 1  ON 11
 ud_2                -9.362378e-03 1 1  ON 12
 ud_3                -6.924691e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213738e-01 1 1  ON 16
 ud_7                -1.120361e-01 1 1  ON 17
 ud_8                -8.586078e-02 1 1  ON 18
 ud_9                -4.559188e-02 1 1  ON 19
 eC_0                -4.506299e-01 1 1  ON 20
 eC_1                -3.146091e-01 1 1  ON 21
 eC_2                -6.877875e-02 1 1  ON 22
 eC_3                 8.857793e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006921e-01 1 1  ON 25
 eC_6                 2.136872e-01 1 1  ON 26
 eC_7                 1.597263e-01 1 1  ON 27
 eC_8                 3.435950e-02 1 1  ON 28
 eC_9                 1.050402e-03 1 1  ON 29
 eO_0                -8.236147e-01 1 1  ON 30
 eO_1                -5.245092e-01 1 1  ON 31
 eO_2                -1.332022e-01 1 1  ON 32
 eO_3                 1.329518e-01 1 1  ON 33
 eO_4                 2.611594e-01 1 1  ON 34
 eO_5                 3.461254e-01 1 1  ON 35
 eO_6                 3.302554e-01 1 1  ON 36
 eO_7                 2.659204e-01 1 1  ON 37
 eO_8                 1.071643e-01 1 1  ON 38
 eO_9                 2.450713e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653144e-02 1 1  ON 41
eH1_2                -2.258031e-02 1 1  ON 42
eH1_3                -3.701636e-02 1 1  ON 43
eH1_4                -8.235872e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606602e-02 1 1  ON 46
eH1_7                 3.927421e-02 1 1  ON 47
eH1_8                 7.522845e-02 1 1  ON 48
eH1_9                 6.186560e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450472e-02 1 1  ON 51
eH2_2                -2.173522e-02 1 1  ON 52
eH2_3                -3.499252e-02 1 1  ON 53
eH2_4                -6.924234e-03 1 1  ON 54
eH2_5                 2.004031e-02 1 1  ON 55
eH2_6                 4.945907e-02 1 1  ON 56
eH2_7                 4.371778e-02 1 1  ON 57
eH2_8                 6.697333e-02 1 1  ON 58
eH2_9                 6.200147e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2333e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7275
    reference variance = 0.339656
====================================================
  Execution time = 4.4339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6633e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4747e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466322216787
                                         uncertainty =       0.007926890385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466322216787
                                         uncertainty =       0.007926890385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482872148
  error estimate for blocks of size 2^( 2) =       0.000507516888
  error estimate for blocks of size 2^( 3) =       0.000531120998
  error estimate for blocks of size 2^( 4) =       0.000549486618
  error estimate for blocks of size 2^( 5) =       0.000560980627
  error estimate for blocks of size 2^( 6) =       0.000565927356
  error estimate for blocks of size 2^( 7) =       0.000568254429

      target function =      -0.731699037856
              le_mean =     -22.815118109129
             les_mean =     520.995945123342
             stat err =       0.000561162258
             autocorr =       1.350555994580
   target nu stat err =       0.000561162258
   target dn stat err =       0.008454762495
      target stat err =       0.006887378562
              std dev =       0.682884340854
             le_variance =       0.466331022983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281511810913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731762624125       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731763990192       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731764641973       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731765209908       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731765706870       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731765907197       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731766083769       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731766269299       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731766492887       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731766686219       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.731766850507       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731766958077       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.731767021413       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.731767233216       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.731767403672       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.731767484954       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.731767548193       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.731767557300       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.731767607152       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.731767652535       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.731767701737       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.731767717372       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.731767742000       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.731767739220       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.731767753372       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.731767756996       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.731767754991       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.731767756179       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.731767756811       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.731767756106       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.731767757410       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.731767759088       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.731767760213       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 1.429619e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731762624125       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731762967711       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731763131779       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731763274639       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731763399933       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731763449938       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731763494302       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731763541029       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731763597125       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731763645671       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.731763686714       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731763713518       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.731763729611       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.731763782827       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.731763825218       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.731763845574       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.731763861385       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.731763863628       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.731763876026       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.731763887365       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.731763899655       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.731763903534       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.731763909671       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.731763908967       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.731763912436       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.731763913347       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.731763912840       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.731763913126       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.731763913292       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.731763913111       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.731763913434       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.731763913849       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.731763914127       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 3.573646e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731762624125       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731762710151       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731762751239       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731762787010       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731762818400       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731762830896       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731762842001       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731762853704       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731762867740       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731762879890       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.731762890150       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731762896845       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.731762900885       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.731762914205       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.731762924789       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.731762929880       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.731762933833       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.731762934391       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.731762937487       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.731762940321       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.731762943393       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.731762944361       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.731762945894       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.731762945717       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.731762946580       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.731762946808       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.731762946681       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.731762946752       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.731762946794       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.731762946748       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.731762946828       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.731762946933       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.731762947001       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 8.933856e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152823 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9130e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
 uu_0                 2.660133e-01 1 1  ON 0
 uu_1                 1.059757e-01 1 1  ON 1
 uu_2                 6.597153e-03 1 1  ON 2
 uu_3                -5.283172e-02 1 1  ON 3
 uu_4                -8.663665e-02 1 1  ON 4
 uu_5                -1.051079e-01 1 1  ON 5
 uu_6                -1.113984e-01 1 1  ON 6
 uu_7                -1.038666e-01 1 1  ON 7
 uu_8                -8.048551e-02 1 1  ON 8
 uu_9                -4.290514e-02 1 1  ON 9
 ud_0                 3.458986e-01 1 1  ON 10
 ud_1                 1.068872e-01 1 1  ON 11
 ud_2                -9.366586e-03 1 1  ON 12
 ud_3                -6.924931e-02 1 1  ON 13
 ud_4                -1.012971e-01 1 1  ON 14
 ud_5                -1.172754e-01 1 1  ON 15
 ud_6                -1.213716e-01 1 1  ON 16
 ud_7                -1.120348e-01 1 1  ON 17
 ud_8                -8.586258e-02 1 1  ON 18
 ud_9                -4.559161e-02 1 1  ON 19
 eC_0                -4.506465e-01 1 1  ON 20
 eC_1                -3.146202e-01 1 1  ON 21
 eC_2                -6.878618e-02 1 1  ON 22
 eC_3                 8.857745e-02 1 1  ON 23
 eC_4                 1.363009e-01 1 1  ON 24
 eC_5                 2.006952e-01 1 1  ON 25
 eC_6                 2.136901e-01 1 1  ON 26
 eC_7                 1.597416e-01 1 1  ON 27
 eC_8                 3.436667e-02 1 1  ON 28
 eC_9                 1.049613e-03 1 1  ON 29
 eO_0                -8.236454e-01 1 1  ON 30
 eO_1                -5.245307e-01 1 1  ON 31
 eO_2                -1.332209e-01 1 1  ON 32
 eO_3                 1.329315e-01 1 1  ON 33
 eO_4                 2.611490e-01 1 1  ON 34
 eO_5                 3.461325e-01 1 1  ON 35
 eO_6                 3.302855e-01 1 1  ON 36
 eO_7                 2.659562e-01 1 1  ON 37
 eO_8                 1.071860e-01 1 1  ON 38
 eO_9                 2.451467e-02 1 1  ON 39
eH1_0                -1.397484e-01 1 1  ON 40
eH1_1                -4.651865e-02 1 1  ON 41
eH1_2                -2.257417e-02 1 1  ON 42
eH1_3                -3.701812e-02 1 1  ON 43
eH1_4                -8.239160e-03 1 1  ON 44
eH1_5                 1.738550e-02 1 1  ON 45
eH1_6                 4.606070e-02 1 1  ON 46
eH1_7                 3.927112e-02 1 1  ON 47
eH1_8                 7.521326e-02 1 1  ON 48
eH1_9                 6.186900e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450245e-02 1 1  ON 51
eH2_2                -2.173696e-02 1 1  ON 52
eH2_3                -3.499771e-02 1 1  ON 53
eH2_4                -6.931237e-03 1 1  ON 54
eH2_5                 2.003066e-02 1 1  ON 55
eH2_6                 4.945822e-02 1 1  ON 56
eH2_7                 4.373431e-02 1 1  ON 57
eH2_8                 6.696963e-02 1 1  ON 58
eH2_9                 6.200712e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.801
    reference variance = 0.412603
====================================================
  Execution time = 4.2817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5072e-01
  Total weights = 2.0000e+06
  Execution time = 3.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450644575891
                                         uncertainty =       0.004049362197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450644575891
                                         uncertainty =       0.004049362197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474720683
  error estimate for blocks of size 2^( 2) =       0.000499889037
  error estimate for blocks of size 2^( 3) =       0.000523654152
  error estimate for blocks of size 2^( 4) =       0.000542052015
  error estimate for blocks of size 2^( 5) =       0.000552721590
  error estimate for blocks of size 2^( 6) =       0.000558945248
  error estimate for blocks of size 2^( 7) =       0.000565210236

      target function =      -0.744651011455
              le_mean =     -22.814356353134
             les_mean =     520.945575036678
             stat err =       0.000554732272
             autocorr =       1.365496390544
   target nu stat err =       0.000554732272
   target dn stat err =       0.004141915094
      target stat err =       0.003531819067
              std dev =       0.671356428616
             le_variance =       0.450719454244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450664984661
                                         uncertainty =       0.004049785851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450664984661
                                         uncertainty =       0.004049785851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474731440
  error estimate for blocks of size 2^( 2) =       0.000499899358
  error estimate for blocks of size 2^( 3) =       0.000523664230
  error estimate for blocks of size 2^( 4) =       0.000542062548
  error estimate for blocks of size 2^( 5) =       0.000552732082
  error estimate for blocks of size 2^( 6) =       0.000558955415
  error estimate for blocks of size 2^( 7) =       0.000565220756

      target function =      -0.744633865416
              le_mean =     -22.814356438741
             les_mean =     520.945599369406
             stat err =       0.000554742700
             autocorr =       1.365485845071
   target nu stat err =       0.000554742700
   target dn stat err =       0.004142275413
      target stat err =       0.003531959125
              std dev =       0.671371641384
             le_variance =       0.450739880855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450654822356
                                         uncertainty =       0.004049575396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450654822356
                                         uncertainty =       0.004049575396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474726084
  error estimate for blocks of size 2^( 2) =       0.000499894218
  error estimate for blocks of size 2^( 3) =       0.000523659211
  error estimate for blocks of size 2^( 4) =       0.000542057303
  error estimate for blocks of size 2^( 5) =       0.000552726857
  error estimate for blocks of size 2^( 6) =       0.000558950353
  error estimate for blocks of size 2^( 7) =       0.000565215517

      target function =      -0.744642403030
              le_mean =     -22.814356393089
             les_mean =     520.945587115173
             stat err =       0.000554737507
             autocorr =       1.365491093116
   target nu stat err =       0.000554737507
   target dn stat err =       0.004142096450
      target stat err =       0.003531889745
              std dev =       0.671364066415
             le_variance =       0.450729709673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450645857197
                                         uncertainty =       0.004049388887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450645857197
                                         uncertainty =       0.004049388887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474721359
  error estimate for blocks of size 2^( 2) =       0.000499889685
  error estimate for blocks of size 2^( 3) =       0.000523654784
  error estimate for blocks of size 2^( 4) =       0.000542052676
  error estimate for blocks of size 2^( 5) =       0.000552722248
  error estimate for blocks of size 2^( 6) =       0.000558945886
  error estimate for blocks of size 2^( 7) =       0.000565210896

      target function =      -0.744649934979
              le_mean =     -22.814356357800
             les_mean =     520.945576531984
             stat err =       0.000554732927
             autocorr =       1.365495726532
   target nu stat err =       0.000554732927
   target dn stat err =       0.004141937798
      target stat err =       0.003531827925
              std dev =       0.671357383717
             le_variance =       0.450720736672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744651011455        initial  <--
     6.2500e+00     6.2500e+01             1.4296e-04        -0.744633865416
     2.5000e+01     2.5000e+02             3.5736e-05        -0.744642403030
     1.0000e+02     1.0000e+03             8.9339e-06        -0.744649934979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3659
  </log>
  <optVariables href="FORM2.s003.opt.xml">
 uu_0                 2.659881e-01 1 1  ON 0
 uu_1                 1.059568e-01 1 1  ON 1
 uu_2                 6.582699e-03 1 1  ON 2
 uu_3                -5.283974e-02 1 1  ON 3
 uu_4                -8.663628e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038514e-01 1 1  ON 7
 uu_8                -8.046740e-02 1 1  ON 8
 uu_9                -4.288999e-02 1 1  ON 9
 ud_0                 3.459044e-01 1 1  ON 10
 ud_1                 1.068930e-01 1 1  ON 11
 ud_2                -9.362378e-03 1 1  ON 12
 ud_3                -6.924691e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213738e-01 1 1  ON 16
 ud_7                -1.120361e-01 1 1  ON 17
 ud_8                -8.586078e-02 1 1  ON 18
 ud_9                -4.559188e-02 1 1  ON 19
 eC_0                -4.506299e-01 1 1  ON 20
 eC_1                -3.146091e-01 1 1  ON 21
 eC_2                -6.877875e-02 1 1  ON 22
 eC_3                 8.857793e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006921e-01 1 1  ON 25
 eC_6                 2.136872e-01 1 1  ON 26
 eC_7                 1.597263e-01 1 1  ON 27
 eC_8                 3.435950e-02 1 1  ON 28
 eC_9                 1.050402e-03 1 1  ON 29
 eO_0                -8.236147e-01 1 1  ON 30
 eO_1                -5.245092e-01 1 1  ON 31
 eO_2                -1.332022e-01 1 1  ON 32
 eO_3                 1.329518e-01 1 1  ON 33
 eO_4                 2.611594e-01 1 1  ON 34
 eO_5                 3.461254e-01 1 1  ON 35
 eO_6                 3.302554e-01 1 1  ON 36
 eO_7                 2.659204e-01 1 1  ON 37
 eO_8                 1.071643e-01 1 1  ON 38
 eO_9                 2.450713e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653144e-02 1 1  ON 41
eH1_2                -2.258031e-02 1 1  ON 42
eH1_3                -3.701636e-02 1 1  ON 43
eH1_4                -8.235872e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606602e-02 1 1  ON 46
eH1_7                 3.927421e-02 1 1  ON 47
eH1_8                 7.522845e-02 1 1  ON 48
eH1_9                 6.186560e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450472e-02 1 1  ON 51
eH2_2                -2.173522e-02 1 1  ON 52
eH2_3                -3.499252e-02 1 1  ON 53
eH2_4                -6.924234e-03 1 1  ON 54
eH2_5                 2.004031e-02 1 1  ON 55
eH2_6                 4.945907e-02 1 1  ON 56
eH2_7                 4.371778e-02 1 1  ON 57
eH2_8                 6.697333e-02 1 1  ON 58
eH2_9                 6.200147e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1950e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8655
    reference variance = 0.319641
====================================================
  Execution time = 4.5890e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5094e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4868e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450962552571
                                         uncertainty =       0.005875604157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450962552571
                                         uncertainty =       0.005875604157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474835636
  error estimate for blocks of size 2^( 2) =       0.000500172078
  error estimate for blocks of size 2^( 3) =       0.000523310491
  error estimate for blocks of size 2^( 4) =       0.000541455030
  error estimate for blocks of size 2^( 5) =       0.000552666516
  error estimate for blocks of size 2^( 6) =       0.000559032646
  error estimate for blocks of size 2^( 7) =       0.000561406941

      target function =      -0.744447431398
              le_mean =     -22.814474821348
             les_mean =     520.951198911467
             stat err =       0.000553640283
             autocorr =       1.359467263975
   target nu stat err =       0.000553640283
   target dn stat err =       0.006041204796
      target stat err =       0.005106515365
              std dev =       0.671518996758
             le_variance =       0.450937763007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281447482135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744481107150       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744481303801       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744481420830       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744481450416       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744481476310       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744481486687       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744481502121       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744481510781       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744481519034       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744481528194       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744481530019       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744481534767       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744481536703       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744481542588       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744481551329       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744481564125       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744481571004       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744481573823       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744481579429       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744481583920       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744481583521       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744481585376       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744481584861       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744481586859       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744481588322       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744481590173       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744481589732       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744481589674       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744481589646       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744481589592       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744481589573       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 1.320350e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744481107150       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744481156343       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744481185621       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744481193021       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744481199501       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744481202095       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744481205956       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744481208122       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744481210187       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744481212478       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744481212933       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744481214121       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744481214606       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744481216077       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744481218263       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744481221461       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744481223181       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744481223886       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744481225287       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744481226409       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744481226309       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744481226773       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744481226644       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744481227144       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744481227509       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744481227971       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744481227861       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744481227846       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744481227839       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744481227825       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744481227821       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 3.301693e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744481107150       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744481119450       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744481126771       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744481128621       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744481130242       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744481130890       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744481131856       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744481132397       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744481132914       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744481133486       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744481133600       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744481133897       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744481134018       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744481134386       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744481134935       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744481135734       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744481136167       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744481136339       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744481136690       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744481136969       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744481136945       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744481137057       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744481137027       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744481137149       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744481137245       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744481137358       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744481137329       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744481137326       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744481137326       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744481137325       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744481137315       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 8.254744e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0795e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
 uu_0                 2.659887e-01 1 1  ON 0
 uu_1                 1.059568e-01 1 1  ON 1
 uu_2                 6.582652e-03 1 1  ON 2
 uu_3                -5.283977e-02 1 1  ON 3
 uu_4                -8.663620e-02 1 1  ON 4
 uu_5                -1.051030e-01 1 1  ON 5
 uu_6                -1.113902e-01 1 1  ON 6
 uu_7                -1.038510e-01 1 1  ON 7
 uu_8                -8.046842e-02 1 1  ON 8
 uu_9                -4.289101e-02 1 1  ON 9
 ud_0                 3.459059e-01 1 1  ON 10
 ud_1                 1.068936e-01 1 1  ON 11
 ud_2                -9.362208e-03 1 1  ON 12
 ud_3                -6.924686e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172788e-01 1 1  ON 15
 ud_6                -1.213738e-01 1 1  ON 16
 ud_7                -1.120365e-01 1 1  ON 17
 ud_8                -8.586149e-02 1 1  ON 18
 ud_9                -4.559208e-02 1 1  ON 19
 eC_0                -4.506311e-01 1 1  ON 20
 eC_1                -3.146096e-01 1 1  ON 21
 eC_2                -6.877942e-02 1 1  ON 22
 eC_3                 8.857708e-02 1 1  ON 23
 eC_4                 1.362927e-01 1 1  ON 24
 eC_5                 2.006923e-01 1 1  ON 25
 eC_6                 2.136875e-01 1 1  ON 26
 eC_7                 1.597286e-01 1 1  ON 27
 eC_8                 3.436045e-02 1 1  ON 28
 eC_9                 1.050264e-03 1 1  ON 29
 eO_0                -8.236180e-01 1 1  ON 30
 eO_1                -5.245114e-01 1 1  ON 31
 eO_2                -1.332035e-01 1 1  ON 32
 eO_3                 1.329511e-01 1 1  ON 33
 eO_4                 2.611590e-01 1 1  ON 34
 eO_5                 3.461258e-01 1 1  ON 35
 eO_6                 3.302572e-01 1 1  ON 36
 eO_7                 2.659224e-01 1 1  ON 37
 eO_8                 1.071674e-01 1 1  ON 38
 eO_9                 2.450794e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653163e-02 1 1  ON 41
eH1_2                -2.258027e-02 1 1  ON 42
eH1_3                -3.701593e-02 1 1  ON 43
eH1_4                -8.235061e-03 1 1  ON 44
eH1_5                 1.739557e-02 1 1  ON 45
eH1_6                 4.606572e-02 1 1  ON 46
eH1_7                 3.927367e-02 1 1  ON 47
eH1_8                 7.522669e-02 1 1  ON 48
eH1_9                 6.186667e-02 1 1  ON 49
eH2_0                -1.394483e-01 1 1  ON 50
eH2_1                -4.450532e-02 1 1  ON 51
eH2_2                -2.173599e-02 1 1  ON 52
eH2_3                -3.499232e-02 1 1  ON 53
eH2_4                -6.924034e-03 1 1  ON 54
eH2_5                 2.004016e-02 1 1  ON 55
eH2_6                 4.945924e-02 1 1  ON 56
eH2_7                 4.371810e-02 1 1  ON 57
eH2_8                 6.697301e-02 1 1  ON 58
eH2_9                 6.200233e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7768
    reference variance = 0.346091
====================================================
  Execution time = 4.3709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5263e-01
  Total weights = 2.0000e+06
  Execution time = 3.5676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452343631786
                                         uncertainty =       0.005290279255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452343631786
                                         uncertainty =       0.005290279255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475723912
  error estimate for blocks of size 2^( 2) =       0.000500649225
  error estimate for blocks of size 2^( 3) =       0.000523995488
  error estimate for blocks of size 2^( 4) =       0.000541049939
  error estimate for blocks of size 2^( 5) =       0.000552145437
  error estimate for blocks of size 2^( 6) =       0.000558772848
  error estimate for blocks of size 2^( 7) =       0.000563177901

      target function =      -0.743060335954
              le_mean =     -22.813495992787
             les_mean =     520.908225668199
             stat err =       0.000553786532
             autocorr =       1.355110825320
   target nu stat err =       0.000553786532
   target dn stat err =       0.005243738840
      target stat err =       0.004420295746
              std dev =       0.672775208804
             le_variance =       0.452626481581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452344267759
                                         uncertainty =       0.005290387961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452344267759
                                         uncertainty =       0.005290387961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475724250
  error estimate for blocks of size 2^( 2) =       0.000500648945
  error estimate for blocks of size 2^( 3) =       0.000523994619
  error estimate for blocks of size 2^( 4) =       0.000541048584
  error estimate for blocks of size 2^( 5) =       0.000552143744
  error estimate for blocks of size 2^( 6) =       0.000558770974
  error estimate for blocks of size 2^( 7) =       0.000563175819

      target function =      -0.743059799392
              le_mean =     -22.813495992436
             les_mean =     520.908226293892
             stat err =       0.000553784780
             autocorr =       1.355100332841
   target nu stat err =       0.000553784780
   target dn stat err =       0.005243841204
      target stat err =       0.004420373733
              std dev =       0.672775685737
             le_variance =       0.452627123319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452343949970
                                         uncertainty =       0.005290333644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452343949970
                                         uncertainty =       0.005290333644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475724081
  error estimate for blocks of size 2^( 2) =       0.000500649085
  error estimate for blocks of size 2^( 3) =       0.000523995053
  error estimate for blocks of size 2^( 4) =       0.000541049261
  error estimate for blocks of size 2^( 5) =       0.000552144590
  error estimate for blocks of size 2^( 6) =       0.000558771911
  error estimate for blocks of size 2^( 7) =       0.000563176860

      target function =      -0.743060067507
              le_mean =     -22.813495992591
             les_mean =     520.908225980299
             stat err =       0.000553785655
             autocorr =       1.355105576452
   target nu stat err =       0.000553785655
   target dn stat err =       0.005243790057
      target stat err =       0.004420334766
              std dev =       0.672775447418
             le_variance =       0.452626802649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452343671557
                                         uncertainty =       0.005290286054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452343671557
                                         uncertainty =       0.005290286054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475723933
  error estimate for blocks of size 2^( 2) =       0.000500649208
  error estimate for blocks of size 2^( 3) =       0.000523995434
  error estimate for blocks of size 2^( 4) =       0.000541049855
  error estimate for blocks of size 2^( 5) =       0.000552145331
  error estimate for blocks of size 2^( 6) =       0.000558772731
  error estimate for blocks of size 2^( 7) =       0.000563177771

      target function =      -0.743060302400
              le_mean =     -22.813495992761
             les_mean =     520.908225707103
             stat err =       0.000553786422
             autocorr =       1.355110169135
   target nu stat err =       0.000553786422
   target dn stat err =       0.005243745243
      target stat err =       0.004420300624
              std dev =       0.672775238629
             le_variance =       0.452626521713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743060335954        initial  <--
     6.2500e+01     6.2500e+02             1.3204e-05        -0.743059799392
     2.5000e+02     2.5000e+03             3.3017e-06        -0.743060067507
     1.0000e+03     1.0000e+04             8.2547e-07        -0.743060302400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5394
  </log>
  <optVariables href="FORM2.s004.opt.xml">
 uu_0                 2.659881e-01 1 1  ON 0
 uu_1                 1.059568e-01 1 1  ON 1
 uu_2                 6.582699e-03 1 1  ON 2
 uu_3                -5.283974e-02 1 1  ON 3
 uu_4                -8.663628e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038514e-01 1 1  ON 7
 uu_8                -8.046740e-02 1 1  ON 8
 uu_9                -4.288999e-02 1 1  ON 9
 ud_0                 3.459044e-01 1 1  ON 10
 ud_1                 1.068930e-01 1 1  ON 11
 ud_2                -9.362378e-03 1 1  ON 12
 ud_3                -6.924691e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213738e-01 1 1  ON 16
 ud_7                -1.120361e-01 1 1  ON 17
 ud_8                -8.586078e-02 1 1  ON 18
 ud_9                -4.559188e-02 1 1  ON 19
 eC_0                -4.506299e-01 1 1  ON 20
 eC_1                -3.146091e-01 1 1  ON 21
 eC_2                -6.877875e-02 1 1  ON 22
 eC_3                 8.857793e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006921e-01 1 1  ON 25
 eC_6                 2.136872e-01 1 1  ON 26
 eC_7                 1.597263e-01 1 1  ON 27
 eC_8                 3.435950e-02 1 1  ON 28
 eC_9                 1.050402e-03 1 1  ON 29
 eO_0                -8.236147e-01 1 1  ON 30
 eO_1                -5.245092e-01 1 1  ON 31
 eO_2                -1.332022e-01 1 1  ON 32
 eO_3                 1.329518e-01 1 1  ON 33
 eO_4                 2.611594e-01 1 1  ON 34
 eO_5                 3.461254e-01 1 1  ON 35
 eO_6                 3.302554e-01 1 1  ON 36
 eO_7                 2.659204e-01 1 1  ON 37
 eO_8                 1.071643e-01 1 1  ON 38
 eO_9                 2.450713e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653144e-02 1 1  ON 41
eH1_2                -2.258031e-02 1 1  ON 42
eH1_3                -3.701636e-02 1 1  ON 43
eH1_4                -8.235872e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606602e-02 1 1  ON 46
eH1_7                 3.927421e-02 1 1  ON 47
eH1_8                 7.522845e-02 1 1  ON 48
eH1_9                 6.186560e-02 1 1  ON 49
eH2_0                -1.394482e-01 1 1  ON 50
eH2_1                -4.450472e-02 1 1  ON 51
eH2_2                -2.173522e-02 1 1  ON 52
eH2_3                -3.499252e-02 1 1  ON 53
eH2_4                -6.924234e-03 1 1  ON 54
eH2_5                 2.004031e-02 1 1  ON 55
eH2_6                 4.945907e-02 1 1  ON 56
eH2_7                 4.371778e-02 1 1  ON 57
eH2_8                 6.697333e-02 1 1  ON 58
eH2_9                 6.200147e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2238e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2802e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.923
    reference variance = 0.744033
====================================================
  Execution time = 4.4168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5122e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5000e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451204885090
                                         uncertainty =       0.003950998104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451204885090
                                         uncertainty =       0.003950998104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474982527
  error estimate for blocks of size 2^( 2) =       0.000500193384
  error estimate for blocks of size 2^( 3) =       0.000523834702
  error estimate for blocks of size 2^( 4) =       0.000541771009
  error estimate for blocks of size 2^( 5) =       0.000553204768
  error estimate for blocks of size 2^( 6) =       0.000560157131
  error estimate for blocks of size 2^( 7) =       0.000564329594

      target function =      -0.744221033328
              le_mean =     -22.815188253774
             les_mean =     520.984031632262
             stat err =       0.000554865626
             autocorr =       1.364647153517
   target nu stat err =       0.000554865626
   target dn stat err =       0.003659233807
      target stat err =       0.003134369792
              std dev =       0.671726732167
             le_variance =       0.451216802707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281518825377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744233230906       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744233240805       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744233247839       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744233250450       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744233251237       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744233252086       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744233252494       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744233253302       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744233254279       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744233254848       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744233255255       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744233256825       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744233258383       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744233258925       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744233259971       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744233260369       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744233261048       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744233261587       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744233261697       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744233262325       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744233262493       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744233262694       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744233262815       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744233262832       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744233262944       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744233263010       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744233262976       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744233262994       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744233262991       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744233262988       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744233262986       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 1.215194e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744233230906       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744233233381       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744233235139       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744233235793       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744233235990       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744233236204       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744233236303       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744233236509       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744233236744       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744233236890       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744233236992       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744233237385       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744233237778       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744233237912       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744233238175       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744233238273       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744233238445       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744233238578       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744233238604       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744233238762       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744233238802       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744233238839       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744233238880       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744233238885       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744233238913       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744233238923       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744233238918       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744233238931       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744233238924       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744233238931       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744233238913       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 3.037975e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744233230906       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744233231524       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744233231964       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744233232127       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744233232170       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744233232228       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744233232267       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744233232311       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744233232359       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744233232407       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744233232435       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744233232530       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744233232629       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744233232651       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744233232721       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744233232755       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744233232795       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744233232815       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744233232809       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744233232863       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744233232865       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744233232848       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744233232878       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744233232901       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744233232896       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744233232960       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744233232886       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744233232952       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744233232953       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744233232913       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744233232911       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 7.594929e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9206e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
 uu_0                 2.659882e-01 1 1  ON 0
 uu_1                 1.059568e-01 1 1  ON 1
 uu_2                 6.582689e-03 1 1  ON 2
 uu_3                -5.283975e-02 1 1  ON 3
 uu_4                -8.663627e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038514e-01 1 1  ON 7
 uu_8                -8.046741e-02 1 1  ON 8
 uu_9                -4.289002e-02 1 1  ON 9
 ud_0                 3.459045e-01 1 1  ON 10
 ud_1                 1.068930e-01 1 1  ON 11
 ud_2                -9.362358e-03 1 1  ON 12
 ud_3                -6.924689e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213738e-01 1 1  ON 16
 ud_7                -1.120362e-01 1 1  ON 17
 ud_8                -8.586084e-02 1 1  ON 18
 ud_9                -4.559194e-02 1 1  ON 19
 eC_0                -4.506301e-01 1 1  ON 20
 eC_1                -3.146092e-01 1 1  ON 21
 eC_2                -6.877886e-02 1 1  ON 22
 eC_3                 8.857784e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006922e-01 1 1  ON 25
 eC_6                 2.136872e-01 1 1  ON 26
 eC_7                 1.597264e-01 1 1  ON 27
 eC_8                 3.435959e-02 1 1  ON 28
 eC_9                 1.050409e-03 1 1  ON 29
 eO_0                -8.236150e-01 1 1  ON 30
 eO_1                -5.245094e-01 1 1  ON 31
 eO_2                -1.332025e-01 1 1  ON 32
 eO_3                 1.329516e-01 1 1  ON 33
 eO_4                 2.611593e-01 1 1  ON 34
 eO_5                 3.461255e-01 1 1  ON 35
 eO_6                 3.302557e-01 1 1  ON 36
 eO_7                 2.659207e-01 1 1  ON 37
 eO_8                 1.071646e-01 1 1  ON 38
 eO_9                 2.450716e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653140e-02 1 1  ON 41
eH1_2                -2.258034e-02 1 1  ON 42
eH1_3                -3.701637e-02 1 1  ON 43
eH1_4                -8.235874e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606600e-02 1 1  ON 46
eH1_7                 3.927426e-02 1 1  ON 47
eH1_8                 7.522828e-02 1 1  ON 48
eH1_9                 6.186571e-02 1 1  ON 49
eH2_0                -1.394481e-01 1 1  ON 50
eH2_1                -4.450469e-02 1 1  ON 51
eH2_2                -2.173518e-02 1 1  ON 52
eH2_3                -3.499253e-02 1 1  ON 53
eH2_4                -6.924261e-03 1 1  ON 54
eH2_5                 2.004024e-02 1 1  ON 55
eH2_6                 4.945905e-02 1 1  ON 56
eH2_7                 4.371779e-02 1 1  ON 57
eH2_8                 6.697326e-02 1 1  ON 58
eH2_9                 6.200153e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8437
    reference variance = 0.38171
====================================================
  Execution time = 4.3025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4745e-01
  Total weights = 2.0000e+06
  Execution time = 3.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505628712
                                         uncertainty =       0.003196091435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505628712
                                         uncertainty =       0.003196091435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472995948
  error estimate for blocks of size 2^( 2) =       0.000498489992
  error estimate for blocks of size 2^( 3) =       0.000522147857
  error estimate for blocks of size 2^( 4) =       0.000539167918
  error estimate for blocks of size 2^( 5) =       0.000549934070
  error estimate for blocks of size 2^( 6) =       0.000557212086
  error estimate for blocks of size 2^( 7) =       0.000561082760

      target function =      -0.747415201425
              le_mean =     -22.813909863537
             les_mean =     520.921933370713
             stat err =       0.000551849208
             autocorr =       1.361212749095
   target nu stat err =       0.000551849208
   target dn stat err =       0.003474315870
      target stat err =       0.003001010890
              std dev =       0.668917284019
             le_variance =       0.447450332859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505618758
                                         uncertainty =       0.003196092383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505618758
                                         uncertainty =       0.003196092383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472995942
  error estimate for blocks of size 2^( 2) =       0.000498489947
  error estimate for blocks of size 2^( 3) =       0.000522147772
  error estimate for blocks of size 2^( 4) =       0.000539167796
  error estimate for blocks of size 2^( 5) =       0.000549933916
  error estimate for blocks of size 2^( 6) =       0.000557211912
  error estimate for blocks of size 2^( 7) =       0.000561082569

      target function =      -0.747415209781
              le_mean =     -22.813909865356
             les_mean =     520.921933443799
             stat err =       0.000551849048
             autocorr =       1.361211989654
   target nu stat err =       0.000551849048
   target dn stat err =       0.003474316501
      target stat err =       0.003001011448
              std dev =       0.668917276601
             le_variance =       0.447450322935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505623735
                                         uncertainty =       0.003196091909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505623735
                                         uncertainty =       0.003196091909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472995945
  error estimate for blocks of size 2^( 2) =       0.000498489970
  error estimate for blocks of size 2^( 3) =       0.000522147814
  error estimate for blocks of size 2^( 4) =       0.000539167857
  error estimate for blocks of size 2^( 5) =       0.000549933993
  error estimate for blocks of size 2^( 6) =       0.000557211999
  error estimate for blocks of size 2^( 7) =       0.000561082665

      target function =      -0.747415205603
              le_mean =     -22.813909864446
             les_mean =     520.921933407249
             stat err =       0.000551849128
             autocorr =       1.361212369362
   target nu stat err =       0.000551849128
   target dn stat err =       0.003474316186
      target stat err =       0.003001011169
              std dev =       0.668917280310
             le_variance =       0.447450327897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505628090
                                         uncertainty =       0.003196091494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447505628090
                                         uncertainty =       0.003196091494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472995947
  error estimate for blocks of size 2^( 2) =       0.000498489989
  error estimate for blocks of size 2^( 3) =       0.000522147851
  error estimate for blocks of size 2^( 4) =       0.000539167911
  error estimate for blocks of size 2^( 5) =       0.000549934060
  error estimate for blocks of size 2^( 6) =       0.000557212075
  error estimate for blocks of size 2^( 7) =       0.000561082748

      target function =      -0.747415201947
              le_mean =     -22.813909863650
             les_mean =     520.921933375279
             stat err =       0.000551849198
             autocorr =       1.361212701629
   target nu stat err =       0.000551849198
   target dn stat err =       0.003474315909
      target stat err =       0.003001010924
              std dev =       0.668917283556
             le_variance =       0.447450332239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747415201425        initial
     6.2500e+02     6.2500e+03             1.2152e-06        -0.747415209781  <--
     2.5000e+03     2.5000e+04             3.0380e-07        -0.747415205603
     1.0000e+04     1.0000e+05             7.5949e-08        -0.747415201947

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 6.1020e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2023e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7636
    reference variance = 0.534006
====================================================
  Execution time = 4.3635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5002e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448537657882
                                         uncertainty =       0.002997415987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448537657882
                                         uncertainty =       0.002997415987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473535850
  error estimate for blocks of size 2^( 2) =       0.000499040775
  error estimate for blocks of size 2^( 3) =       0.000522822074
  error estimate for blocks of size 2^( 4) =       0.000541084872
  error estimate for blocks of size 2^( 5) =       0.000552878965
  error estimate for blocks of size 2^( 6) =       0.000562116626
  error estimate for blocks of size 2^( 7) =       0.000564247480

      target function =      -0.746542067782
              le_mean =     -22.814724764180
             les_mean =     520.960138242800
             stat err =       0.000555081986
             autocorr =       1.374068993993
   target nu stat err =       0.000555081986
   target dn stat err =       0.003219585842
      target stat err =       0.002788744663
              std dev =       0.669680820807
             le_variance =       0.448472401757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472476418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746551372421       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746551425849       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746551464050       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746551474693       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746551476623       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746551480813       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746551484348       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746551486169       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746551489326       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746551491359       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746551493206       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746551494665       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746551495716       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746551500305       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746551506223       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746551508284       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746551508774       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746551510050       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746551511505       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746551511642       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746551513248       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746551514459       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746551514833       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746551514739       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746551514601       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746551514709       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746551514658       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746551514689       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746551514741       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746551514688       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746551514740       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 5.539392e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746551372421       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746551385781       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746551395334       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746551397996       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746551398479       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746551399526       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746551400410       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746551400866       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746551401656       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746551402163       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746551402622       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746551402990       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746551403252       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746551404400       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746551405879       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746551406394       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746551406516       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746551406835       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746551407199       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746551407233       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746551407634       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746551407939       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746551408031       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746551408008       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746551407974       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746551407999       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746551407985       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746551407994       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746551408007       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746551407993       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746551408005       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 1.384825e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746551372421       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746551375761       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746551378150       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746551378815       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746551378934       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746551379195       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746551379419       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746551379535       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746551379728       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746551379856       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746551379974       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746551380067       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746551380127       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746551380414       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746551380786       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746551380918       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746551380946       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746551381024       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746551381115       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746551381136       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746551381229       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746551381300       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746551381326       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746551381315       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746551381309       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746551381314       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746551381323       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746551381317       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746551381330       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746551381308       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746551381327       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 3.462049e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8675e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
 uu_0                 2.659885e-01 1 1  ON 0
 uu_1                 1.059568e-01 1 1  ON 1
 uu_2                 6.582672e-03 1 1  ON 2
 uu_3                -5.283970e-02 1 1  ON 3
 uu_4                -8.663613e-02 1 1  ON 4
 uu_5                -1.051031e-01 1 1  ON 5
 uu_6                -1.113908e-01 1 1  ON 6
 uu_7                -1.038516e-01 1 1  ON 7
 uu_8                -8.046783e-02 1 1  ON 8
 uu_9                -4.289047e-02 1 1  ON 9
 ud_0                 3.459051e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362398e-03 1 1  ON 12
 ud_3                -6.924702e-02 1 1  ON 13
 ud_4                -1.012988e-01 1 1  ON 14
 ud_5                -1.172790e-01 1 1  ON 15
 ud_6                -1.213740e-01 1 1  ON 16
 ud_7                -1.120365e-01 1 1  ON 17
 ud_8                -8.586116e-02 1 1  ON 18
 ud_9                -4.559188e-02 1 1  ON 19
 eC_0                -4.506309e-01 1 1  ON 20
 eC_1                -3.146097e-01 1 1  ON 21
 eC_2                -6.877951e-02 1 1  ON 22
 eC_3                 8.857729e-02 1 1  ON 23
 eC_4                 1.362928e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136875e-01 1 1  ON 26
 eC_7                 1.597278e-01 1 1  ON 27
 eC_8                 3.436021e-02 1 1  ON 28
 eC_9                 1.050542e-03 1 1  ON 29
 eO_0                -8.236169e-01 1 1  ON 30
 eO_1                -5.245107e-01 1 1  ON 31
 eO_2                -1.332037e-01 1 1  ON 32
 eO_3                 1.329503e-01 1 1  ON 33
 eO_4                 2.611588e-01 1 1  ON 34
 eO_5                 3.461256e-01 1 1  ON 35
 eO_6                 3.302571e-01 1 1  ON 36
 eO_7                 2.659226e-01 1 1  ON 37
 eO_8                 1.071669e-01 1 1  ON 38
 eO_9                 2.450765e-02 1 1  ON 39
eH1_0                -1.397627e-01 1 1  ON 40
eH1_1                -4.653121e-02 1 1  ON 41
eH1_2                -2.258060e-02 1 1  ON 42
eH1_3                -3.701639e-02 1 1  ON 43
eH1_4                -8.235998e-03 1 1  ON 44
eH1_5                 1.739515e-02 1 1  ON 45
eH1_6                 4.606606e-02 1 1  ON 46
eH1_7                 3.927457e-02 1 1  ON 47
eH1_8                 7.522736e-02 1 1  ON 48
eH1_9                 6.186633e-02 1 1  ON 49
eH2_0                -1.394479e-01 1 1  ON 50
eH2_1                -4.450458e-02 1 1  ON 51
eH2_2                -2.173519e-02 1 1  ON 52
eH2_3                -3.499255e-02 1 1  ON 53
eH2_4                -6.924373e-03 1 1  ON 54
eH2_5                 2.003997e-02 1 1  ON 55
eH2_6                 4.945888e-02 1 1  ON 56
eH2_7                 4.371752e-02 1 1  ON 57
eH2_8                 6.697285e-02 1 1  ON 58
eH2_9                 6.200213e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8226
    reference variance = 0.475629
====================================================
  Execution time = 4.5169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4352e-01
  Total weights = 2.0000e+06
  Execution time = 3.6205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516734231
                                         uncertainty =       0.002238522450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516734231
                                         uncertainty =       0.002238522450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470911895
  error estimate for blocks of size 2^( 2) =       0.000496545801
  error estimate for blocks of size 2^( 3) =       0.000520706340
  error estimate for blocks of size 2^( 4) =       0.000537872831
  error estimate for blocks of size 2^( 5) =       0.000549210180
  error estimate for blocks of size 2^( 6) =       0.000555813241
  error estimate for blocks of size 2^( 7) =       0.000560559031

      target function =      -0.750758423241
              le_mean =     -22.814014530485
             les_mean =     520.922774801202
             stat err =       0.000550863821
             autocorr =       1.368387754343
   target nu stat err =       0.000550863821
   target dn stat err =       0.002575768172
      target stat err =       0.002283483899
              std dev =       0.665969988639
             le_variance =       0.443516025768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516808754
                                         uncertainty =       0.002238530081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516808754
                                         uncertainty =       0.002238530081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470911935
  error estimate for blocks of size 2^( 2) =       0.000496545636
  error estimate for blocks of size 2^( 3) =       0.000520705960
  error estimate for blocks of size 2^( 4) =       0.000537872301
  error estimate for blocks of size 2^( 5) =       0.000549209548
  error estimate for blocks of size 2^( 6) =       0.000555812522
  error estimate for blocks of size 2^( 7) =       0.000560558244

      target function =      -0.750758359629
              le_mean =     -22.814014525107
             les_mean =     520.922774630425
             stat err =       0.000550863154
             autocorr =       1.368384209661
   target nu stat err =       0.000550863154
   target dn stat err =       0.002575776103
      target stat err =       0.002283489804
              std dev =       0.665970044656
             le_variance =       0.443516100379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516771500
                                         uncertainty =       0.002238526267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516771500
                                         uncertainty =       0.002238526267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470911915
  error estimate for blocks of size 2^( 2) =       0.000496545719
  error estimate for blocks of size 2^( 3) =       0.000520706150
  error estimate for blocks of size 2^( 4) =       0.000537872566
  error estimate for blocks of size 2^( 5) =       0.000549209864
  error estimate for blocks of size 2^( 6) =       0.000555812881
  error estimate for blocks of size 2^( 7) =       0.000560558638

      target function =      -0.750758391429
              le_mean =     -22.814014527793
             les_mean =     520.922774715667
             stat err =       0.000550863487
             autocorr =       1.368385981708
   target nu stat err =       0.000550863487
   target dn stat err =       0.002575772138
      target stat err =       0.002283486852
              std dev =       0.665970016653
             le_variance =       0.443516063081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516738889
                                         uncertainty =       0.002238522927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443516738889
                                         uncertainty =       0.002238522927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470911898
  error estimate for blocks of size 2^( 2) =       0.000496545791
  error estimate for blocks of size 2^( 3) =       0.000520706317
  error estimate for blocks of size 2^( 4) =       0.000537872798
  error estimate for blocks of size 2^( 5) =       0.000549210141
  error estimate for blocks of size 2^( 6) =       0.000555813196
  error estimate for blocks of size 2^( 7) =       0.000560558982

      target function =      -0.750758419265
              le_mean =     -22.814014530148
             les_mean =     520.922774790494
             stat err =       0.000550863779
             autocorr =       1.368387532744
   target nu stat err =       0.000550863779
   target dn stat err =       0.002575768668
      target stat err =       0.002283484268
              std dev =       0.665969992140
             le_variance =       0.443516030431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750758423241        initial  <--
     1.5625e+02     1.5625e+03             5.5394e-06        -0.750758359629
     6.2500e+02     6.2500e+03             1.3848e-06        -0.750758391429
     2.5000e+03     2.5000e+04             3.4620e-07        -0.750758419265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2286
  </log>
  <optVariables href="FORM2.s006.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2191e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8026
    reference variance = 0.43773
====================================================
  Execution time = 4.3644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4856e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450736466680
                                         uncertainty =       0.003180588036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450736466680
                                         uncertainty =       0.003180588036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474708391
  error estimate for blocks of size 2^( 2) =       0.000500625516
  error estimate for blocks of size 2^( 3) =       0.000524376042
  error estimate for blocks of size 2^( 4) =       0.000542868281
  error estimate for blocks of size 2^( 5) =       0.000554825440
  error estimate for blocks of size 2^( 6) =       0.000563169306
  error estimate for blocks of size 2^( 7) =       0.000565703246

      target function =      -0.744678336968
              le_mean =     -22.814202511579
             les_mean =     520.938532127406
             stat err =       0.000556641568
             autocorr =       1.374983392960
   target nu stat err =       0.000556641568
   target dn stat err =       0.003376306631
      target stat err =       0.002901647286
              std dev =       0.671339045048
             le_variance =       0.450696113406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281420251158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744688778500       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744688783175       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744688787442       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744688788766       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744688789540       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744688790211       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744688790527       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744688790763       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744688791075       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744688791114       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744688791753       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744688792163       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744688792483       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744688792766       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744688793264       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744688793783       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744688793894       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744688794079       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744688794360       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744688794549       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744688794795       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744688794926       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744688794972       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744688794999       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744688795058       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744688795092       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744688795097       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744688795117       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744688795124       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744688795116       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744688795112       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 7.301622e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744688778500       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744688779669       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744688780736       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744688781067       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744688781261       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744688781426       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744688781503       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744688781573       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744688781643       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744688781665       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744688781815       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744688781933       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744688781997       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744688782066       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744688782191       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744688782322       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744688782361       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744688782397       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744688782466       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744688782508       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744688782588       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744688782592       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744688782590       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744688782621       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744688782659       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744688782633       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744688782668       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744688782656       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744688782655       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744688782677       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744688782653       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 1.825397e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744688778500       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744688778793       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744688779059       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744688779142       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744688779196       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744688779218       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744688779239       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744688779264       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744688779271       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744688779243       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744688779268       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744688779355       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744688779374       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744688779368       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744688779440       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744688779447       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744688779469       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744688779442       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744688779445       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744688779439       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744688779541       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744688779467       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744688779528       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744688779555       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744688779482       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744688779610       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744688779544       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744688779544       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744688779542       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744688779625       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744688779548       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 4.563488e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8538e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582631e-03 1 1  ON 2
 uu_3                -5.283979e-02 1 1  ON 3
 uu_4                -8.663626e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046743e-02 1 1  ON 8
 uu_9                -4.289010e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362311e-03 1 1  ON 12
 ud_3                -6.924687e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213740e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586108e-02 1 1  ON 18
 ud_9                -4.559220e-02 1 1  ON 19
 eC_0                -4.506305e-01 1 1  ON 20
 eC_1                -3.146095e-01 1 1  ON 21
 eC_2                -6.877922e-02 1 1  ON 22
 eC_3                 8.857756e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006925e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597270e-01 1 1  ON 27
 eC_8                 3.435991e-02 1 1  ON 28
 eC_9                 1.050425e-03 1 1  ON 29
 eO_0                -8.236160e-01 1 1  ON 30
 eO_1                -5.245100e-01 1 1  ON 31
 eO_2                -1.332032e-01 1 1  ON 32
 eO_3                 1.329509e-01 1 1  ON 33
 eO_4                 2.611590e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302565e-01 1 1  ON 36
 eO_7                 2.659217e-01 1 1  ON 37
 eO_8                 1.071657e-01 1 1  ON 38
 eO_9                 2.450737e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653127e-02 1 1  ON 41
eH1_2                -2.258045e-02 1 1  ON 42
eH1_3                -3.701639e-02 1 1  ON 43
eH1_4                -8.235883e-03 1 1  ON 44
eH1_5                 1.739527e-02 1 1  ON 45
eH1_6                 4.606597e-02 1 1  ON 46
eH1_7                 3.927442e-02 1 1  ON 47
eH1_8                 7.522771e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450462e-02 1 1  ON 51
eH2_2                -2.173510e-02 1 1  ON 52
eH2_3                -3.499259e-02 1 1  ON 53
eH2_4                -6.924346e-03 1 1  ON 54
eH2_5                 2.004003e-02 1 1  ON 55
eH2_6                 4.945900e-02 1 1  ON 56
eH2_7                 4.371784e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200174e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8711
    reference variance = 0.396123
====================================================
  Execution time = 4.3331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5006e-01
  Total weights = 2.0000e+06
  Execution time = 3.5663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086530738
                                         uncertainty =       0.004888800863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086530738
                                         uncertainty =       0.004888800863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474375721
  error estimate for blocks of size 2^( 2) =       0.000499790017
  error estimate for blocks of size 2^( 3) =       0.000524003631
  error estimate for blocks of size 2^( 4) =       0.000541427446
  error estimate for blocks of size 2^( 5) =       0.000552624498
  error estimate for blocks of size 2^( 6) =       0.000559155439
  error estimate for blocks of size 2^( 7) =       0.000564508282

      target function =      -0.745208578791
              le_mean =     -22.813552274991
             les_mean =     520.908231828535
             stat err =       0.000554428916
             autocorr =       1.365987856263
   target nu stat err =       0.000554428916
   target dn stat err =       0.004800415523
      target stat err =       0.004077954061
              std dev =       0.670868578635
             le_variance =       0.450064649800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086557621
                                         uncertainty =       0.004888802640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086557621
                                         uncertainty =       0.004888802640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474375735
  error estimate for blocks of size 2^( 2) =       0.000499790007
  error estimate for blocks of size 2^( 3) =       0.000524003600
  error estimate for blocks of size 2^( 4) =       0.000541427396
  error estimate for blocks of size 2^( 5) =       0.000552624436
  error estimate for blocks of size 2^( 6) =       0.000559155371
  error estimate for blocks of size 2^( 7) =       0.000564508211

      target function =      -0.745208556195
              le_mean =     -22.813552274368
             les_mean =     520.908231826993
             stat err =       0.000554428854
             autocorr =       1.365987466435
   target nu stat err =       0.000554428854
   target dn stat err =       0.004800417241
      target stat err =       0.004077955227
              std dev =       0.670868598692
             le_variance =       0.450064676711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086544180
                                         uncertainty =       0.004888801752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086544180
                                         uncertainty =       0.004888801752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474375728
  error estimate for blocks of size 2^( 2) =       0.000499790012
  error estimate for blocks of size 2^( 3) =       0.000524003616
  error estimate for blocks of size 2^( 4) =       0.000541427421
  error estimate for blocks of size 2^( 5) =       0.000552624467
  error estimate for blocks of size 2^( 6) =       0.000559155405
  error estimate for blocks of size 2^( 7) =       0.000564508246

      target function =      -0.745208567492
              le_mean =     -22.813552274680
             les_mean =     520.908231827763
             stat err =       0.000554428885
             autocorr =       1.365987661346
   target nu stat err =       0.000554428885
   target dn stat err =       0.004800416382
      target stat err =       0.004077954644
              std dev =       0.670868588664
             le_variance =       0.450064663256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086532418
                                         uncertainty =       0.004888800974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450086532418
                                         uncertainty =       0.004888800974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474375722
  error estimate for blocks of size 2^( 2) =       0.000499790016
  error estimate for blocks of size 2^( 3) =       0.000524003629
  error estimate for blocks of size 2^( 4) =       0.000541427443
  error estimate for blocks of size 2^( 5) =       0.000552624494
  error estimate for blocks of size 2^( 6) =       0.000559155435
  error estimate for blocks of size 2^( 7) =       0.000564508277

      target function =      -0.745208577378
              le_mean =     -22.813552274952
             les_mean =     520.908231828438
             stat err =       0.000554428912
             autocorr =       1.365987831895
   target nu stat err =       0.000554428912
   target dn stat err =       0.004800415631
      target stat err =       0.004077954134
              std dev =       0.670868579889
             le_variance =       0.450064651482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745208578791        initial  <--
     1.5625e+03     1.5625e+04             7.3016e-07        -0.745208556195
     6.2500e+03     6.2500e+04             1.8254e-07        -0.745208567492
     2.5000e+04     2.5000e+05             4.5635e-08        -0.745208577378

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.9874
  </log>
  <optVariables href="FORM2.s007.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8817
    reference variance = 0.482016
====================================================
  Execution time = 4.3463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4335e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4760e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443342042749
                                         uncertainty =       0.001899040554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443342042749
                                         uncertainty =       0.001899040554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470822728
  error estimate for blocks of size 2^( 2) =       0.000495947071
  error estimate for blocks of size 2^( 3) =       0.000519490183
  error estimate for blocks of size 2^( 4) =       0.000537920784
  error estimate for blocks of size 2^( 5) =       0.000550168929
  error estimate for blocks of size 2^( 6) =       0.000555977742
  error estimate for blocks of size 2^( 7) =       0.000558707488

      target function =      -0.750900262120
              le_mean =     -22.814284512369
             les_mean =     520.934925672320
             stat err =       0.000550693736
             autocorr =       1.368060909171
   target nu stat err =       0.000550693736
   target dn stat err =       0.002405331610
      target stat err =       0.002145691187
              std dev =       0.665843887624
             le_variance =       0.443348082686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281428451237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750905348126       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750905348705       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750905349083       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750905349299       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750905349358       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750905349444       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750905349486       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750905349527       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750905349569       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750905349624       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750905349613       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750905349647       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750905349605       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750905349704       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750905349738       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750905349792       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750905349745       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750905349811       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750905349845       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750905349871       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750905349872       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750905349893       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750905349917       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750905349903       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750905349911       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750905349909       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750905349881       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750905349914       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750905349931       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750905349917       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750905349846       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750905349924       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 5.238016e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750905348126       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750905348271       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750905348365       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750905348419       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750905348301       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750905348514       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750905348483       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750905348446       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750905348595       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750905348590       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750905348436       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750905348634       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750905348577       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750905348561       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750905348570       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750905348580       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750905348563       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750905348432       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750905348441       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750905348435       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750905348588       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750905348664       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750905348670       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750905348777       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750905348502       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750905348417       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750905348609       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750905348676       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750905348722       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750905348311       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750905348484       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750905348347       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+04 is 1.309504e-08

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750905348126       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750905348162       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750905348186       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750905348199       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750905348203       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750905348267       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750905347985       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750905348356       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750905348184       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750905348506       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750905348350       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750905348233       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750905348368       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750905348479       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750905347750       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750905348264       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750905348303       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750905348143       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750905348138       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750905347500       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750905347972       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750905347706       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750905348268       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750905348103       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750905347868       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750905348373       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750905348577       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750905348946       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750905348211       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750905346865       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750905347766       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750905348429       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 3.273758e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8263e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582656e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046747e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924685e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877920e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597269e-01 1 1  ON 27
 eC_8                 3.435989e-02 1 1  ON 28
 eC_9                 1.050431e-03 1 1  ON 29
 eO_0                -8.236159e-01 1 1  ON 30
 eO_1                -5.245100e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659217e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450728e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235879e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522777e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924343e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8781
    reference variance = 0.493064
====================================================
  Execution time = 4.3123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4822e-01
  Total weights = 2.0000e+06
  Execution time = 3.4910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431069
                                         uncertainty =       0.004472395205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431069
                                         uncertainty =       0.004472395205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473400539
  error estimate for blocks of size 2^( 2) =       0.000498969939
  error estimate for blocks of size 2^( 3) =       0.000522889496
  error estimate for blocks of size 2^( 4) =       0.000541161797
  error estimate for blocks of size 2^( 5) =       0.000552956051
  error estimate for blocks of size 2^( 6) =       0.000560144960
  error estimate for blocks of size 2^( 7) =       0.000562633877

      target function =      -0.746757509887
              le_mean =     -22.814103257911
             les_mean =     520.931523378836
             stat err =       0.000554224171
             autocorr =       1.370608527238
   target nu stat err =       0.000554224171
   target dn stat err =       0.004572040225
      target stat err =       0.003907793261
              std dev =       0.669489462426
             le_variance =       0.448216140300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431249
                                         uncertainty =       0.004472395264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431249
                                         uncertainty =       0.004472395264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473400539
  error estimate for blocks of size 2^( 2) =       0.000498969937
  error estimate for blocks of size 2^( 3) =       0.000522889492
  error estimate for blocks of size 2^( 4) =       0.000541161791
  error estimate for blocks of size 2^( 5) =       0.000552956042
  error estimate for blocks of size 2^( 6) =       0.000560144950
  error estimate for blocks of size 2^( 7) =       0.000562633867

      target function =      -0.746757509737
              le_mean =     -22.814103257982
             les_mean =     520.931523382249
             stat err =       0.000554224163
             autocorr =       1.370608484700
   target nu stat err =       0.000554224163
   target dn stat err =       0.004572040285
      target stat err =       0.003907793308
              std dev =       0.669489462558
             le_variance =       0.448216140476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431159
                                         uncertainty =       0.004472395234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431159
                                         uncertainty =       0.004472395234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473400539
  error estimate for blocks of size 2^( 2) =       0.000498969938
  error estimate for blocks of size 2^( 3) =       0.000522889494
  error estimate for blocks of size 2^( 4) =       0.000541161794
  error estimate for blocks of size 2^( 5) =       0.000552956047
  error estimate for blocks of size 2^( 6) =       0.000560144955
  error estimate for blocks of size 2^( 7) =       0.000562633872

      target function =      -0.746757509812
              le_mean =     -22.814103257947
             les_mean =     520.931523380542
             stat err =       0.000554224167
             autocorr =       1.370608505963
   target nu stat err =       0.000554224167
   target dn stat err =       0.004572040255
      target stat err =       0.003907793284
              std dev =       0.669489462492
             le_variance =       0.448216140388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431080
                                         uncertainty =       0.004472395209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448250431080
                                         uncertainty =       0.004472395209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473400539
  error estimate for blocks of size 2^( 2) =       0.000498969939
  error estimate for blocks of size 2^( 3) =       0.000522889496
  error estimate for blocks of size 2^( 4) =       0.000541161797
  error estimate for blocks of size 2^( 5) =       0.000552956050
  error estimate for blocks of size 2^( 6) =       0.000560144959
  error estimate for blocks of size 2^( 7) =       0.000562633876

      target function =      -0.746757509878
              le_mean =     -22.814103257916
             les_mean =     520.931523379049
             stat err =       0.000554224171
             autocorr =       1.370608524583
   target nu stat err =       0.000554224171
   target dn stat err =       0.004572040229
      target stat err =       0.003907793264
              std dev =       0.669489462434
             le_variance =       0.448216140311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746757509887        initial  <--
     1.5625e+04     1.5625e+05             5.2380e-08        -0.746757509737
     6.2500e+04     6.2500e+05             1.3095e-08        -0.746757509812
     2.5000e+05     2.5000e+06             3.2738e-09        -0.746757509878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6030
  </log>
  <optVariables href="FORM2.s008.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1887e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.816
    reference variance = 0.8305
====================================================
  Execution time = 4.5978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4444e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4882e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444415559058
                                         uncertainty =       0.004462771854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444415559058
                                         uncertainty =       0.004462771854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471399918
  error estimate for blocks of size 2^( 2) =       0.000496686351
  error estimate for blocks of size 2^( 3) =       0.000520997405
  error estimate for blocks of size 2^( 4) =       0.000538590942
  error estimate for blocks of size 2^( 5) =       0.000549862793
  error estimate for blocks of size 2^( 6) =       0.000557605904
  error estimate for blocks of size 2^( 7) =       0.000560556086

      target function =      -0.749953905063
              le_mean =     -22.814885006405
             les_mean =     520.963413398631
             stat err =       0.000551653931
             autocorr =       1.369476012096
   target nu stat err =       0.000551653931
   target dn stat err =       0.004411553845
      target stat err =       0.003810159025
              std dev =       0.666660157341
             le_variance =       0.444435765385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488500640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749972075661       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749972075735       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749972075766       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749972075787       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749972075779       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749972075877       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749972075696       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749972075982       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749972076023       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749972075750       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749972075441       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749972075472       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749972076009       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749972075717       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749972075438       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749972075697       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749972075846       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749972075676       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749972075788       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749972075823       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749972075467       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749972076321       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749972076120       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749972075776       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749972075411       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749972075642       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749972076047       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749972075410       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749972076331       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749972075795       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749972075610       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749972074431       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 4.018617e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749972075661       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749972075680       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749972075687       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749972075811       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749972075718       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749972075513       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749972075856       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749972076411       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749972075596       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749972073985       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749972075665       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749972076665       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749972076599       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749972076401       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749972075483       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749972076589       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749972077181       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749972075612       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749972075238       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749972075362       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749972074172       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749972073667       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749972073049       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749972073969       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749972074779       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749972075120       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749972075909       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749972075586       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749972074107       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749972078110       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749972073923       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749972074394       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+05 is 1.004654e-09

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749972075661       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749972075666       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749972075668       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749972075668       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749972075993       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749972076010       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749972076581       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749972079170       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749972070914       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749972070682       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749972070592       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749972070252       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749972074585       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749972079064       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749972082395       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749972078376       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749972074772       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749972077933       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749972076259       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749972076541       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749972087049       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749972069074       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749972073538       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749972075903       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749972070438       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749972072593       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749972074524       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749972073747       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749972071069       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749972071925       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749972070398       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749972079996       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 2.511628e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0900e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582656e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.9206
    reference variance = 0.35966
====================================================
  Execution time = 4.3425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7239e-01
  Total weights = 2.0000e+06
  Execution time = 3.4831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472084706
                                         uncertainty =       0.021220368880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472084706
                                         uncertainty =       0.021220368880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486000636
  error estimate for blocks of size 2^( 2) =       0.000510385694
  error estimate for blocks of size 2^( 3) =       0.000533541801
  error estimate for blocks of size 2^( 4) =       0.000551444053
  error estimate for blocks of size 2^( 5) =       0.000563708732
  error estimate for blocks of size 2^( 6) =       0.000570525102
  error estimate for blocks of size 2^( 7) =       0.000574048551

      target function =      -0.726476685461
              le_mean =     -22.814917493185
             les_mean =     520.992853221501
             stat err =       0.000564931609
             autocorr =       1.351195140593
   target nu stat err =       0.000564931609
   target dn stat err =       0.021650684019
      target stat err =       0.017329172419
              std dev =       0.687308691084
             le_variance =       0.472393236840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472085146
                                         uncertainty =       0.021220369109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472085146
                                         uncertainty =       0.021220369109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486000636
  error estimate for blocks of size 2^( 2) =       0.000510385694
  error estimate for blocks of size 2^( 3) =       0.000533541801
  error estimate for blocks of size 2^( 4) =       0.000551444053
  error estimate for blocks of size 2^( 5) =       0.000563708731
  error estimate for blocks of size 2^( 6) =       0.000570525101
  error estimate for blocks of size 2^( 7) =       0.000574048550

      target function =      -0.726476685101
              le_mean =     -22.814917493201
             les_mean =     520.992853222671
             stat err =       0.000564931609
             autocorr =       1.351195136977
   target nu stat err =       0.000564931609
   target dn stat err =       0.021650684250
      target stat err =       0.017329172588
              std dev =       0.687308691404
             le_variance =       0.472393237279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472084926
                                         uncertainty =       0.021220368994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472084926
                                         uncertainty =       0.021220368994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486000636
  error estimate for blocks of size 2^( 2) =       0.000510385694
  error estimate for blocks of size 2^( 3) =       0.000533541801
  error estimate for blocks of size 2^( 4) =       0.000551444053
  error estimate for blocks of size 2^( 5) =       0.000563708731
  error estimate for blocks of size 2^( 6) =       0.000570525101
  error estimate for blocks of size 2^( 7) =       0.000574048550

      target function =      -0.726476685281
              le_mean =     -22.814917493193
             les_mean =     520.992853222086
             stat err =       0.000564931609
             autocorr =       1.351195138781
   target nu stat err =       0.000564931609
   target dn stat err =       0.021650684135
      target stat err =       0.017329172503
              std dev =       0.687308691244
             le_variance =       0.472393237060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472084733
                                         uncertainty =       0.021220368894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472472084733
                                         uncertainty =       0.021220368894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486000636
  error estimate for blocks of size 2^( 2) =       0.000510385694
  error estimate for blocks of size 2^( 3) =       0.000533541801
  error estimate for blocks of size 2^( 4) =       0.000551444053
  error estimate for blocks of size 2^( 5) =       0.000563708732
  error estimate for blocks of size 2^( 6) =       0.000570525102
  error estimate for blocks of size 2^( 7) =       0.000574048551

      target function =      -0.726476685439
              le_mean =     -22.814917493186
             les_mean =     520.992853221574
             stat err =       0.000564931609
             autocorr =       1.351195140368
   target nu stat err =       0.000564931609
   target dn stat err =       0.021650684033
      target stat err =       0.017329172430
              std dev =       0.687308691104
             le_variance =       0.472393236868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.726476685461        initial  <--
     1.5625e+05     1.5625e+06             4.0186e-09        -0.726476685101
     6.2500e+05     6.2500e+06             1.0047e-09        -0.726476685281
     2.5000e+06     2.5000e+07             2.5116e-10        -0.726476685439

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8903
  </log>
  <optVariables href="FORM2.s009.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2198e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7933
    reference variance = 1.15145
====================================================
  Execution time = 4.3863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4875e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475062061950
                                         uncertainty =       0.023871859458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475062061950
                                         uncertainty =       0.023871859458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487370407
  error estimate for blocks of size 2^( 2) =       0.000512020375
  error estimate for blocks of size 2^( 3) =       0.000536202728
  error estimate for blocks of size 2^( 4) =       0.000553578198
  error estimate for blocks of size 2^( 5) =       0.000564186395
  error estimate for blocks of size 2^( 6) =       0.000570831119
  error estimate for blocks of size 2^( 7) =       0.000574306992

      target function =      -0.724279266724
              le_mean =     -22.814744788229
             les_mean =     520.987639342081
             stat err =       0.000565725676
             autocorr =       1.347390463195
   target nu stat err =       0.000565725676
   target dn stat err =       0.023708103397
      target stat err =       0.018856498520
              std dev =       0.689245839740
             le_variance =       0.475059827598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281474478823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724766007399       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724766007628       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724766007833       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724766007890       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724766007481       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724766005628       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724766008100       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724766008270       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724766011544       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724766012293       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724766007423       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.724766006934       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.724766006692       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.724766007194       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.724766008230       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724766009433       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724766009838       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.724766009710       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.724766007875       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724766009560       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724766006666       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724766004711       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.724766005611       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724766004762       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.724766007769       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724766013623       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.724766006242       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.724766006581       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724766014233       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724766006088       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724766005612       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724766012128       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.724766002492       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.724766007077       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+06 is 2.195092e-09

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724766007399       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724766007456       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724766007507       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724766007522       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724766003951       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724766012015       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724766017634       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724766017587       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724765985177       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724766007701       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724766018212       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.724766000746       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.724766013511       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.724765991088       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.724766013498       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724765997978       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724766008839       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.724765998092       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.724765997188       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724766016224       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724766003994       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724766027421       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.724766014275       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724765987935       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.724766008155       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724766010773       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.724765985265       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.724766009763       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724765991962       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724766005818       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724765987499       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724766004306       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.724766006869       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.724765970500       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+06 is 5.487702e-10

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724766007399       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724766007413       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724766007426       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724766012420       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724766014534       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724765987968       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724765981223       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724766017307       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724766009409       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724765992750       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724766056582       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.724766002879       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.724766007020       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.724765976456       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.724766015146       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724765928772       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724766005754       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.724766043726       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.724765978005       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724765979813       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724766026255       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724766004978       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.724765959339       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724765959315       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.724765999463       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724766008210       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.724766019524       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.724765885710       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724765974191       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724765965266       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724765905924       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724765956345       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.724766090725       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.724765959622       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 1.371900e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8784e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582656e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663625e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.9355
    reference variance = 0.680523
====================================================
  Execution time = 4.3021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9852e-01
  Total weights = 2.0000e+06
  Execution time = 3.4926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029546
                                         uncertainty =       0.044209903895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029546
                                         uncertainty =       0.044209903895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499258271
  error estimate for blocks of size 2^( 2) =       0.000523755793
  error estimate for blocks of size 2^( 3) =       0.000546714094
  error estimate for blocks of size 2^( 4) =       0.000564001839
  error estimate for blocks of size 2^( 5) =       0.000575970787
  error estimate for blocks of size 2^( 6) =       0.000582356158
  error estimate for blocks of size 2^( 7) =       0.000587743837

      target function =      -0.704972769592
              le_mean =     -22.814676006778
             les_mean =     521.007958687854
             stat err =       0.000577518155
             autocorr =       1.338075891653
   target nu stat err =       0.000577518155
   target dn stat err =       0.044539972792
      target stat err =       0.033599767578
              std dev =       0.706057818354
             le_variance =       0.498517642859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029547
                                         uncertainty =       0.044209903948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029547
                                         uncertainty =       0.044209903948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499258271
  error estimate for blocks of size 2^( 2) =       0.000523755793
  error estimate for blocks of size 2^( 3) =       0.000546714094
  error estimate for blocks of size 2^( 4) =       0.000564001839
  error estimate for blocks of size 2^( 5) =       0.000575970787
  error estimate for blocks of size 2^( 6) =       0.000582356158
  error estimate for blocks of size 2^( 7) =       0.000587743836

      target function =      -0.704972769587
              le_mean =     -22.814676006782
             les_mean =     521.007958688015
             stat err =       0.000577518155
             autocorr =       1.338075891083
   target nu stat err =       0.000577518155
   target dn stat err =       0.044539972846
      target stat err =       0.033599767618
              std dev =       0.706057818354
             le_variance =       0.498517642859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029546
                                         uncertainty =       0.044209903921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029546
                                         uncertainty =       0.044209903921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499258271
  error estimate for blocks of size 2^( 2) =       0.000523755793
  error estimate for blocks of size 2^( 3) =       0.000546714094
  error estimate for blocks of size 2^( 4) =       0.000564001839
  error estimate for blocks of size 2^( 5) =       0.000575970787
  error estimate for blocks of size 2^( 6) =       0.000582356158
  error estimate for blocks of size 2^( 7) =       0.000587743836

      target function =      -0.704972769590
              le_mean =     -22.814676006780
             les_mean =     521.007958687935
             stat err =       0.000577518155
             autocorr =       1.338075891372
   target nu stat err =       0.000577518155
   target dn stat err =       0.044539972819
      target stat err =       0.033599767598
              std dev =       0.706057818354
             le_variance =       0.498517642859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029546
                                         uncertainty =       0.044209903898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498579029546
                                         uncertainty =       0.044209903898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499258271
  error estimate for blocks of size 2^( 2) =       0.000523755793
  error estimate for blocks of size 2^( 3) =       0.000546714094
  error estimate for blocks of size 2^( 4) =       0.000564001839
  error estimate for blocks of size 2^( 5) =       0.000575970787
  error estimate for blocks of size 2^( 6) =       0.000582356158
  error estimate for blocks of size 2^( 7) =       0.000587743837

      target function =      -0.704972769592
              le_mean =     -22.814676006778
             les_mean =     521.007958687865
             stat err =       0.000577518155
             autocorr =       1.338075891614
   target nu stat err =       0.000577518155
   target dn stat err =       0.044539972796
      target stat err =       0.033599767580
              std dev =       0.706057818354
             le_variance =       0.498517642859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704972769592        initial  <--
     1.5625e+06     1.5625e+07             2.1951e-09        -0.704972769587
     6.2500e+06     6.2500e+07             5.4877e-10        -0.704972769590
     2.5000e+07     2.5000e+08             1.3719e-10        -0.704972769592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5195
  </log>
  <optVariables href="FORM2.s010.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1952e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7929
    reference variance = 0.303255
====================================================
  Execution time = 4.3694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4718e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445916752417
                                         uncertainty =       0.003386565157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445916752417
                                         uncertainty =       0.003386565157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472161670
  error estimate for blocks of size 2^( 2) =       0.000497282104
  error estimate for blocks of size 2^( 3) =       0.000521149694
  error estimate for blocks of size 2^( 4) =       0.000539115378
  error estimate for blocks of size 2^( 5) =       0.000550915031
  error estimate for blocks of size 2^( 6) =       0.000557676166
  error estimate for blocks of size 2^( 7) =       0.000564648751

      target function =      -0.748744925977
              le_mean =     -22.814577530219
             les_mean =     520.950820944920
             stat err =       0.000553088831
             autocorr =       1.372171265986
   target nu stat err =       0.000553088831
   target dn stat err =       0.003024674397
      target stat err =       0.002642688902
              std dev =       0.667737437533
             le_variance =       0.445873285484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281457753022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748753266760       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748753266760       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748753266761       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748753266767       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748753259204       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748753304939       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748753267955       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748753274319       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748753254601       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748753260313       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748753268990       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748753271575       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748753269122       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748753255069       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748753235870       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748753261489       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748753280565       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748753257308       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748753321084       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748753232731       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748753270883       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748753320341       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748753226491       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748753326644       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748753260273       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748753268129       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748753244766       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748753235484       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748753263429       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748753273983       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748753222548       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748753284724       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+07 is 5.351847e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748753266760       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748753266760       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748753266760       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748753266760       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748753268401       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748753241312       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748753280934       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748753182122       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748753491483       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748753281506       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748753189529       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748753273217       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748753218858       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748753472865       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748753335977       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748753345521       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748753334757       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748753471935       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748753340255       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748753194737       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748753216899       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748753147399       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748753423284       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748753410739       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748753097447       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748753413769       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748753315040       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748753047833       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748753367773       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748753389110       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748753295001       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748753327181       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+07 is 1.338018e-11

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748753266760       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748753266760       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748753266760       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748753266759       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748753266760       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748753181657       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748752931934       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748753149216       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748753208605       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748753891393       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748753105051       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748753131733       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748753527295       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748753110287       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748752867542       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748753463907       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748753228407       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748752621619       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748752839518       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748753706332       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748753314728       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748753588254       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748752416220       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748753377940       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748752407257       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748752460410       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748753447595       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748752362096       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748753183195       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748752929563       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748752520138       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748753287809       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 3.343886e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8453e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8244
    reference variance = 0.430336
====================================================
  Execution time = 4.4576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 5.1443e-01
  Total weights = 2.0000e+06
  Execution time = 3.4789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207289
                                         uncertainty =       0.064884456357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207289
                                         uncertainty =       0.064884456357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507165641
  error estimate for blocks of size 2^( 2) =       0.000530388556
  error estimate for blocks of size 2^( 3) =       0.000553333991
  error estimate for blocks of size 2^( 4) =       0.000570118381
  error estimate for blocks of size 2^( 5) =       0.000580819869
  error estimate for blocks of size 2^( 6) =       0.000586609993
  error estimate for blocks of size 2^( 7) =       0.000592078319

      target function =      -0.691464375220
              le_mean =     -22.814806810952
             les_mean =     521.029843538730
             stat err =       0.000582406641
             autocorr =       1.318721202728
   target nu stat err =       0.000582406641
   target dn stat err =       0.065551722157
      target stat err =       0.047695344118
              std dev =       0.717240527916
             le_variance =       0.514433974885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207291
                                         uncertainty =       0.064884456360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207291
                                         uncertainty =       0.064884456360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507165641
  error estimate for blocks of size 2^( 2) =       0.000530388556
  error estimate for blocks of size 2^( 3) =       0.000553333991
  error estimate for blocks of size 2^( 4) =       0.000570118381
  error estimate for blocks of size 2^( 5) =       0.000580819869
  error estimate for blocks of size 2^( 6) =       0.000586609993
  error estimate for blocks of size 2^( 7) =       0.000592078319

      target function =      -0.691464375219
              le_mean =     -22.814806810952
             les_mean =     521.029843538730
             stat err =       0.000582406641
             autocorr =       1.318721202701
   target nu stat err =       0.000582406641
   target dn stat err =       0.065551722160
      target stat err =       0.047695344120
              std dev =       0.717240527917
             le_variance =       0.514433974887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207290
                                         uncertainty =       0.064884456358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207290
                                         uncertainty =       0.064884456358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507165641
  error estimate for blocks of size 2^( 2) =       0.000530388556
  error estimate for blocks of size 2^( 3) =       0.000553333991
  error estimate for blocks of size 2^( 4) =       0.000570118381
  error estimate for blocks of size 2^( 5) =       0.000580819869
  error estimate for blocks of size 2^( 6) =       0.000586609993
  error estimate for blocks of size 2^( 7) =       0.000592078319

      target function =      -0.691464375220
              le_mean =     -22.814806810952
             les_mean =     521.029843538730
             stat err =       0.000582406641
             autocorr =       1.318721202708
   target nu stat err =       0.000582406641
   target dn stat err =       0.065551722159
      target stat err =       0.047695344119
              std dev =       0.717240527917
             le_variance =       0.514433974886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207289
                                         uncertainty =       0.064884456357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514440207289
                                         uncertainty =       0.064884456357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507165641
  error estimate for blocks of size 2^( 2) =       0.000530388556
  error estimate for blocks of size 2^( 3) =       0.000553333991
  error estimate for blocks of size 2^( 4) =       0.000570118381
  error estimate for blocks of size 2^( 5) =       0.000580819869
  error estimate for blocks of size 2^( 6) =       0.000586609993
  error estimate for blocks of size 2^( 7) =       0.000592078319

      target function =      -0.691464375220
              le_mean =     -22.814806810952
             les_mean =     521.029843538730
             stat err =       0.000582406641
             autocorr =       1.318721202735
   target nu stat err =       0.000582406641
   target dn stat err =       0.065551722158
      target stat err =       0.047695344118
              std dev =       0.717240527916
             le_variance =       0.514433974885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.691464375220        initial  <--
     1.5625e+07     1.5625e+08             5.3518e-11        -0.691464375219
     6.2500e+07     6.2500e+08             1.3380e-11        -0.691464375220
     2.5000e+08     2.5000e+09             3.3439e-12        -0.691464375220

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0268
  </log>
  <optVariables href="FORM2.s011.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2051e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.9007
    reference variance = 0.574871
====================================================
  Execution time = 4.3861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5569e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4672e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455771714973
                                         uncertainty =       0.004821599257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455771714973
                                         uncertainty =       0.004821599257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477331531
  error estimate for blocks of size 2^( 2) =       0.000502128949
  error estimate for blocks of size 2^( 3) =       0.000525828988
  error estimate for blocks of size 2^( 4) =       0.000544098537
  error estimate for blocks of size 2^( 5) =       0.000556317607
  error estimate for blocks of size 2^( 6) =       0.000562748229
  error estimate for blocks of size 2^( 7) =       0.000566280039

      target function =      -0.740477440253
              le_mean =     -22.814964565831
             les_mean =     520.978298692825
             stat err =       0.000557361103
             autocorr =       1.363430697046
   target nu stat err =       0.000557361103
   target dn stat err =       0.005233020581
      target stat err =       0.004391440429
              std dev =       0.675048724568
             le_variance =       0.455690780541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496456583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740502571427       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740502571427       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740502571427       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740502571426       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740502571595       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740502323386       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740502437977       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740502260456       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740502629889       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740502664678       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740502523663       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740502666689       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740502396221       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740502423928       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740502182364       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740501792331       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740502777379       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740502177917       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740502298480       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740502870887       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740502741982       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740502396862       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740503056520       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740502646322       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740502437386       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740502382172       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740502433824       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740502422449       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740502722192       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740503185773       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740502619515       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+08 is 6.275849e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740502571427       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740502571427       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740502571427       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740502592349       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740502587097       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740502463220       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740501462688       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740502625676       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740502412175       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740501243511       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740501448454       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740501347649       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740500233896       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740504757297       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740502010215       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740501863722       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740503212494       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740504600083       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740502740556       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740502925280       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740503749044       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740501062814       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740502795828       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740502525844       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740504775525       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740501193166       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740501914268       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740503325014       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740505221246       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740504083500       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740504198005       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 1.570450e-12

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740502571427       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740502571427       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740502571427       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740502551749       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740502571427       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740504248502       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740502750549       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740505417194       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740500170718       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740504219670       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740495890664       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740498211672       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740500835206       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740502670410       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740510994126       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740506570266       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740501470678       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740504073333       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740507648447       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740495369260       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740484002844       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740502070616       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740503391825       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740500656876       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740500601294       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740508889475       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740507738806       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740514680026       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740509500615       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740507102349       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740507449345       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740503659910       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.925569e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.460695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8572e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8619
    reference variance = 1.1005
====================================================
  Execution time = 4.2824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6012e-01
  Total weights = 2.0000e+06
  Execution time = 3.7237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479644796
  error estimate for blocks of size 2^( 2) =       0.000504389462
  error estimate for blocks of size 2^( 3) =       0.000528056517
  error estimate for blocks of size 2^( 4) =       0.000545540941
  error estimate for blocks of size 2^( 5) =       0.000555647488
  error estimate for blocks of size 2^( 6) =       0.000562659071
  error estimate for blocks of size 2^( 7) =       0.000570538786

      target function =      -0.736798765585
              le_mean =     -22.815044162601
             les_mean =     520.986358172620
             stat err =       0.000558596572
             autocorr =       1.356304046320
   target nu stat err =       0.000558596572
   target dn stat err =       0.006804212831
      target stat err =       0.005631204971
              std dev =       0.678320176067
             le_variance =       0.460118261260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479644796
  error estimate for blocks of size 2^( 2) =       0.000504389462
  error estimate for blocks of size 2^( 3) =       0.000528056517
  error estimate for blocks of size 2^( 4) =       0.000545540941
  error estimate for blocks of size 2^( 5) =       0.000555647488
  error estimate for blocks of size 2^( 6) =       0.000562659071
  error estimate for blocks of size 2^( 7) =       0.000570538786

      target function =      -0.736798765585
              le_mean =     -22.815044162601
             les_mean =     520.986358172620
             stat err =       0.000558596572
             autocorr =       1.356304046319
   target nu stat err =       0.000558596572
   target dn stat err =       0.006804212831
      target stat err =       0.005631204971
              std dev =       0.678320176067
             le_variance =       0.460118261260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479644796
  error estimate for blocks of size 2^( 2) =       0.000504389462
  error estimate for blocks of size 2^( 3) =       0.000528056517
  error estimate for blocks of size 2^( 4) =       0.000545540941
  error estimate for blocks of size 2^( 5) =       0.000555647488
  error estimate for blocks of size 2^( 6) =       0.000562659071
  error estimate for blocks of size 2^( 7) =       0.000570538786

      target function =      -0.736798765585
              le_mean =     -22.815044162601
             les_mean =     520.986358172620
             stat err =       0.000558596572
             autocorr =       1.356304046323
   target nu stat err =       0.000558596572
   target dn stat err =       0.006804212831
      target stat err =       0.005631204971
              std dev =       0.678320176067
             le_variance =       0.460118261259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460123189826
                                         uncertainty =       0.006641764678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479644796
  error estimate for blocks of size 2^( 2) =       0.000504389462
  error estimate for blocks of size 2^( 3) =       0.000528056517
  error estimate for blocks of size 2^( 4) =       0.000545540941
  error estimate for blocks of size 2^( 5) =       0.000555647488
  error estimate for blocks of size 2^( 6) =       0.000562659071
  error estimate for blocks of size 2^( 7) =       0.000570538786

      target function =      -0.736798765585
              le_mean =     -22.815044162601
             les_mean =     520.986358172620
             stat err =       0.000558596572
             autocorr =       1.356304046319
   target nu stat err =       0.000558596572
   target dn stat err =       0.006804212831
      target stat err =       0.005631204971
              std dev =       0.678320176067
             le_variance =       0.460118261260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736798765585        initial  <--
     1.5625e+08     1.5625e+09             6.2758e-12        -0.736798765585
     6.2500e+08     6.2500e+09             1.5705e-12        -0.736798765585
     2.5000e+09     2.5000e+10             3.9256e-13        -0.736798765585

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1434
  </log>
  <optVariables href="FORM2.s012.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1972e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8665
    reference variance = 0.350952
====================================================
  Execution time = 4.3851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4603e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452769909506
                                         uncertainty =       0.003426869962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452769909506
                                         uncertainty =       0.003426869962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475779458
  error estimate for blocks of size 2^( 2) =       0.000501004334
  error estimate for blocks of size 2^( 3) =       0.000525391220
  error estimate for blocks of size 2^( 4) =       0.000543492467
  error estimate for blocks of size 2^( 5) =       0.000554569729
  error estimate for blocks of size 2^( 6) =       0.000562964793
  error estimate for blocks of size 2^( 7) =       0.000565427574

      target function =      -0.742984717524
              le_mean =     -22.813506204170
             les_mean =     520.908797286230
             stat err =       0.000556613641
             autocorr =       1.368662337353
   target nu stat err =       0.000556613641
   target dn stat err =       0.003809470726
      target stat err =       0.003239535128
              std dev =       0.672853761892
             le_variance =       0.452732184892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281350620417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742997823787       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742997823787       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742997823787       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742997963104       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742997906866       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742997852577       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742997823787       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743000093942       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742997823787       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743000016189       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742999727104       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743000029673       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742995929215       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742995557600       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742998969447       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742996498763       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742995925444       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742995966217       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743001537764       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742994434255       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742994091933       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742999314769       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742999612653       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742996996472       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742997851190       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742999042146       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742991806468       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742998050460       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743001288230       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743001304766       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742989552663       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742984753795       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742995600657       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+09 is 5.164485e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742997823787       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742997823787       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742997823787       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742997823787       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742997823787       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743006158933       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743010131544       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742988382233       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742990913694       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743010837958       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742996930907       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742996124142       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742978936555       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743000106472       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742987690284       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742990529880       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742995835931       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743001826475       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742985243315       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743024115223       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742997233646       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743008673302       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742996251451       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742987251212       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742960874519       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743004539549       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742990967141       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742985879910       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742988236679       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742993958357       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742994718394       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743024841772       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743018860785       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742988349620       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743006669335       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743023809427       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742990204762       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742993557264       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743001868421       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742996215444       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743010307815       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742987393488       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743024173664       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742981574230       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742887071288       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743073005060       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743133970622       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743104736339       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743083142886       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742759048568       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742417943303       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.741426965472       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.743719109670       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750057341904       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.742690317742       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+09 is 1.287632e-13

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742997823787       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742997823787       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742997823787       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743010241260       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742995316136       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742994917660       residual = 9.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742988085772       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743010942293       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742987956142       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743037206213       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743053400621       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742999051770       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743033536009       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742991591648       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742937865096       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742983622477       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742973646281       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742997589181       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742976079209       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742971609239       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742974665363       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742976352844       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743023953429       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743040589753       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743090201716       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742978237322       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742942712175       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742975165670       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743027379036       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743144199155       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742992223396       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742963661450       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743195011326       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743199182941       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743609011476       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742736115950       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742916131106       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742777772398       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742775119052       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743443785046       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743151248637       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743228804276       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742775049128       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743058071912       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742735613770       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743353904510       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743183268955       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743540132068       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743093948730       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743617943920       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742617407060       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.738712507377       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.730746298924       residual = 7.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.726889179896       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.733368386016       residual = 4.92e-02           smallest_sin_value = 9.90e-01
davidson iteration   55 stopping due to small subspace S singular value of 6.95e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 3.303317e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.596802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8596e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8286
    reference variance = 0.286248
====================================================
  Execution time = 4.3021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4997e-01
  Total weights = 2.0000e+06
  Execution time = 3.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474327861
  error estimate for blocks of size 2^( 2) =       0.000499610815
  error estimate for blocks of size 2^( 3) =       0.000523565206
  error estimate for blocks of size 2^( 4) =       0.000541415967
  error estimate for blocks of size 2^( 5) =       0.000551532112
  error estimate for blocks of size 2^( 6) =       0.000556359944
  error estimate for blocks of size 2^( 7) =       0.000559972262

      target function =      -0.745279115188
              le_mean =     -22.814200233896
             les_mean =     520.937705925873
             stat err =       0.000552320071
             autocorr =       1.355889764773
   target nu stat err =       0.000552320071
   target dn stat err =       0.004198843379
      target stat err =       0.003583481866
              std dev =       0.670800893392
             le_variance =       0.449973838575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474327861
  error estimate for blocks of size 2^( 2) =       0.000499610815
  error estimate for blocks of size 2^( 3) =       0.000523565206
  error estimate for blocks of size 2^( 4) =       0.000541415967
  error estimate for blocks of size 2^( 5) =       0.000551532112
  error estimate for blocks of size 2^( 6) =       0.000556359944
  error estimate for blocks of size 2^( 7) =       0.000559972262

      target function =      -0.745279115188
              le_mean =     -22.814200233896
             les_mean =     520.937705925873
             stat err =       0.000552320071
             autocorr =       1.355889764776
   target nu stat err =       0.000552320071
   target dn stat err =       0.004198843379
      target stat err =       0.003583481866
              std dev =       0.670800893392
             le_variance =       0.449973838575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474327861
  error estimate for blocks of size 2^( 2) =       0.000499610815
  error estimate for blocks of size 2^( 3) =       0.000523565206
  error estimate for blocks of size 2^( 4) =       0.000541415967
  error estimate for blocks of size 2^( 5) =       0.000551532112
  error estimate for blocks of size 2^( 6) =       0.000556359944
  error estimate for blocks of size 2^( 7) =       0.000559972262

      target function =      -0.745279115188
              le_mean =     -22.814200233896
             les_mean =     520.937705925873
             stat err =       0.000552320071
             autocorr =       1.355889764773
   target nu stat err =       0.000552320071
   target dn stat err =       0.004198843379
      target stat err =       0.003583481866
              std dev =       0.670800893392
             le_variance =       0.449973838575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450059209606
                                         uncertainty =       0.004092814856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474327861
  error estimate for blocks of size 2^( 2) =       0.000499610815
  error estimate for blocks of size 2^( 3) =       0.000523565206
  error estimate for blocks of size 2^( 4) =       0.000541415967
  error estimate for blocks of size 2^( 5) =       0.000551532112
  error estimate for blocks of size 2^( 6) =       0.000556359944
  error estimate for blocks of size 2^( 7) =       0.000559972262

      target function =      -0.745279115188
              le_mean =     -22.814200233896
             les_mean =     520.937705925873
             stat err =       0.000552320071
             autocorr =       1.355889764776
   target nu stat err =       0.000552320071
   target dn stat err =       0.004198843379
      target stat err =       0.003583481866
              std dev =       0.670800893392
             le_variance =       0.449973838575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745279115188        initial  <--
     1.5625e+09     1.5625e+10             5.1645e-13        -0.745279115188
     6.2500e+09     6.2500e+10             1.2876e-13        -0.745279115188
     2.5000e+10     2.5000e+11             3.3033e-14        -0.745279115188

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4939
  </log>
  <optVariables href="FORM2.s013.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1910e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8903
    reference variance = 0.337745
====================================================
  Execution time = 4.5827e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4571e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445726361598
                                         uncertainty =       0.003600403946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445726361598
                                         uncertainty =       0.003600403946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472073031
  error estimate for blocks of size 2^( 2) =       0.000497838964
  error estimate for blocks of size 2^( 3) =       0.000521864637
  error estimate for blocks of size 2^( 4) =       0.000539732321
  error estimate for blocks of size 2^( 5) =       0.000550753052
  error estimate for blocks of size 2^( 6) =       0.000559277617
  error estimate for blocks of size 2^( 7) =       0.000560458750

      target function =      -0.748895024570
              le_mean =     -22.813471291604
             les_mean =     520.900178043285
             stat err =       0.000552555435
             autocorr =       1.370040260079
   target nu stat err =       0.000552555435
   target dn stat err =       0.003695441586
      target stat err =       0.003194419020
              std dev =       0.667612082957
             le_variance =       0.445705893310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281347129160e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748907710020       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748907710020       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748907710020       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748906068149       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748907710020       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748919056287       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748919536797       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748881845450       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748935218489       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748885714129       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748901007846       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748931301342       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748887006327       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748878358173       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748906742184       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748918268345       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748929499313       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748886232134       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748889665609       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748903563412       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748861685006       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748931837944       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748943241017       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748911943375       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748944502155       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748928225788       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748886681164       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748888209348       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748935609051       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748918857468       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748897749962       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748907765915       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748900391062       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748941706669       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748802723382       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748878149553       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748956202253       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748880425931       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748892594936       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748961404549       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748631774667       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748490236316       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748377060314       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748985513250       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748971830137       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749389155198       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748862951111       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748818784279       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.749533149354       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749013764531       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748830106886       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746307871610       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748547741310       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750379905797       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.749743692904       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+10 is 7.221366e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748907710020       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748907710020       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748907710020       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748896502645       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748907468890       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748906138389       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748917407178       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748815398714       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748918336139       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748776781691       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749154806607       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748840559569       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748816909905       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749027846334       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748863730802       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748938361078       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748820503168       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749008862736       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748995291128       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748834509631       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748865441816       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748795129361       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748960546833       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748918739908       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748928263940       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748773848162       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748959660957       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748829801827       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749047052800       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748934963632       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748761575148       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749297106845       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748561271083       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748683833739       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.749356940039       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748979044390       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748094829509       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749381163237       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748560577099       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.749199176202       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749481845931       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747379691704       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749041161075       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748259025330       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749238474020       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749156615063       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749164191069       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745616923307       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.749682186959       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.752152687174       residual = 8.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.759226114179       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.797998484526       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.717103113637       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.781618851707       residual = 5.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.707538093093       residual = 2.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+10 is 1.812689e-14

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748907710020       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748907710020       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748907710020       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748907710020       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748919989620       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748912551782       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748982757659       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748866970400       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748799824637       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748334859554       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749039036012       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748850125044       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748468588299       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748781903742       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748350150906       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749242320661       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748322725055       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749192166161       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747465034681       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749594537233       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749039515248       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750717633019       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749092803562       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749194503527       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747720674606       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747817896432       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748160772009       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749664200071       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747754972484       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746687971353       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749708110237       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748598840310       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749033379629       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750758277959       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747867960469       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750108611267       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745587966009       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750479454249       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748717167636       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747835406802       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748873525713       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749117270664       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747740025246       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746073515985       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746673145621       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.754045704225       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742634840796       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.753003564851       residual = 8.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745309771453       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.740090631141       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.764941642874       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.705381229830       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.739886811942       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742854109459       residual = 5.41e-02           smallest_sin_value = 9.99e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+11 is 4.135603e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.773832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0927e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8904
    reference variance = 0.936375
====================================================
  Execution time = 4.2748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5144e-01
  Total weights = 2.0000e+06
  Execution time = 3.5297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475099780
  error estimate for blocks of size 2^( 2) =       0.000500356636
  error estimate for blocks of size 2^( 3) =       0.000524118024
  error estimate for blocks of size 2^( 4) =       0.000542864062
  error estimate for blocks of size 2^( 5) =       0.000555338597
  error estimate for blocks of size 2^( 6) =       0.000561805230
  error estimate for blocks of size 2^( 7) =       0.000566113236

      target function =      -0.744028829730
              le_mean =     -22.814961936771
             les_mean =     520.973927552626
             stat err =       0.000556530281
             autocorr =       1.372170063369
   target nu stat err =       0.000556530281
   target dn stat err =       0.004906707382
      target stat err =       0.004162351260
              std dev =       0.671892552457
             le_variance =       0.451439602047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475099780
  error estimate for blocks of size 2^( 2) =       0.000500356636
  error estimate for blocks of size 2^( 3) =       0.000524118024
  error estimate for blocks of size 2^( 4) =       0.000542864062
  error estimate for blocks of size 2^( 5) =       0.000555338597
  error estimate for blocks of size 2^( 6) =       0.000561805230
  error estimate for blocks of size 2^( 7) =       0.000566113236

      target function =      -0.744028829730
              le_mean =     -22.814961936771
             les_mean =     520.973927552626
             stat err =       0.000556530281
             autocorr =       1.372170063371
   target nu stat err =       0.000556530281
   target dn stat err =       0.004906707382
      target stat err =       0.004162351260
              std dev =       0.671892552457
             le_variance =       0.451439602047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475099780
  error estimate for blocks of size 2^( 2) =       0.000500356636
  error estimate for blocks of size 2^( 3) =       0.000524118024
  error estimate for blocks of size 2^( 4) =       0.000542864062
  error estimate for blocks of size 2^( 5) =       0.000555338597
  error estimate for blocks of size 2^( 6) =       0.000561805230
  error estimate for blocks of size 2^( 7) =       0.000566113236

      target function =      -0.744028829730
              le_mean =     -22.814961936771
             les_mean =     520.973927552626
             stat err =       0.000556530281
             autocorr =       1.372170063375
   target nu stat err =       0.000556530281
   target dn stat err =       0.004906707382
      target stat err =       0.004162351260
              std dev =       0.671892552457
             le_variance =       0.451439602047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451385496341
                                         uncertainty =       0.004661326911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475099780
  error estimate for blocks of size 2^( 2) =       0.000500356636
  error estimate for blocks of size 2^( 3) =       0.000524118024
  error estimate for blocks of size 2^( 4) =       0.000542864062
  error estimate for blocks of size 2^( 5) =       0.000555338597
  error estimate for blocks of size 2^( 6) =       0.000561805230
  error estimate for blocks of size 2^( 7) =       0.000566113236

      target function =      -0.744028829730
              le_mean =     -22.814961936771
             les_mean =     520.973927552626
             stat err =       0.000556530281
             autocorr =       1.372170063373
   target nu stat err =       0.000556530281
   target dn stat err =       0.004906707382
      target stat err =       0.004162351260
              std dev =       0.671892552457
             le_variance =       0.451439602047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744028829730        initial  <--
     1.5625e+10     1.5625e+11             7.2214e-14        -0.744028829730
     6.2500e+10     6.2500e+11             1.8127e-14        -0.744028829730
     2.5000e+11     2.5000e+12             4.1356e-15        -0.744028829730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3078
  </log>
  <optVariables href="FORM2.s014.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2124e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8126
    reference variance = 0.36061
====================================================
  Execution time = 4.3372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4941e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5191e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449465084623
                                         uncertainty =       0.003073579246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449465084623
                                         uncertainty =       0.003073579246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474029240
  error estimate for blocks of size 2^( 2) =       0.000498951273
  error estimate for blocks of size 2^( 3) =       0.000522617867
  error estimate for blocks of size 2^( 4) =       0.000540605643
  error estimate for blocks of size 2^( 5) =       0.000553066986
  error estimate for blocks of size 2^( 6) =       0.000560470685
  error estimate for blocks of size 2^( 7) =       0.000565809818

      target function =      -0.745759868242
              le_mean =     -22.814382413362
             les_mean =     520.945452118901
             stat err =       0.000554988283
             autocorr =       1.370747196115
   target nu stat err =       0.000554988283
   target dn stat err =       0.003171654001
      target stat err =       0.002742288671
              std dev =       0.670378579955
             le_variance =       0.449407440462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281438241336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745768766487       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745768766487       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745768766487       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745768766487       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745768766487       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745826522207       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745768337803       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745733709365       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745955705634       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745750629761       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745884089847       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745619257385       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745318994657       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745861146654       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745840829487       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745958272053       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745510129767       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745128908188       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746668736325       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745632017186       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745490640112       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745778252200       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745488812984       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746047921343       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746096514068       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746086593392       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745634559286       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745133368638       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746212265074       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747081626462       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744298616182       residual = 9.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746545633331       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745426856986       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745323741224       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747350854606       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746827191335       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744385453422       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746020536801       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745972687928       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746601176102       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744830218414       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745424022919       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746523856804       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744908459461       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741553120765       residual = 8.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742113569704       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748034914585       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.753061542228       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750107561576       residual = 8.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.727059274861       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744956714634       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.792155253562       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.604320183956       residual = 9.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.803049120154       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.786916933980       residual = 2.66e+00           smallest_sin_value = 9.97e-01
davidson iteration   55 stopping due to small subspace S singular value of 8.77e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+11 is 4.029728e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745768766487       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745768766487       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745768766487       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745768766487       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745902884777       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744937581219       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745584536943       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746840088624       residual = 8.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745434072681       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744739763209       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745849649253       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746026133821       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745102032492       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745621366756       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745966081310       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744624937585       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742706408365       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748183052385       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742944228129       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747551069768       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747199747361       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746635618589       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746482197848       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744933258240       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751936169740       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741781139286       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740706120082       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749665634118       residual = 8.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752463207696       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740396348625       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745748582406       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738245250695       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743760555933       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750944118133       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.739840201351       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744759194023       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746302522874       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741684985765       residual = 9.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748984341895       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743425223322       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749297124949       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742487245687       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748366176557       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746711993337       residual = 6.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.738200197888       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.795523077519       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.761793407292       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.737793971123       residual = 5.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.822112522940       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.631143053223       residual = 7.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.781528134669       residual = 7.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.247119758747       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.114311177228       residual = 1.92e+02           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 2.488414e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745768766487       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745768766487       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745768766487       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745768766487       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745768766487       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744701894309       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748715493322       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745743883010       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747796191879       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743847829472       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747825058680       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743036279081       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742189074125       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745760492476       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752996804761       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747743084383       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.753617752105       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751733173889       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747312900429       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743683794733       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742950655620       residual = 7.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746202442982       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.731023246370       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750506676605       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.764651427883       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.735731247928       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.757715112703       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.701217258359       residual = 9.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.754904478565       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738525628921       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.701110022366       residual = 9.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.753851077648       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.765893317828       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.776749541266       residual = 4.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.759940938970       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.766583534393       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748001064142       residual = 8.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.760245157206       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.768933173648       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.752684145921       residual = 5.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.768388194302       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.702935121029       residual = 8.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.768631270854       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.759217425325       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.722175878813       residual = 3.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.759520666867       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.797644445908       residual = 1.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.772207220916       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.714284631352       residual = 4.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.599713285666       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.470862710735       residual = 4.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -3.425970099112       residual = 3.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       2.324037425688       residual = 4.72e+03           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.047932748580       residual = 4.43e+02           smallest_sin_value = 9.98e-01
davidson iteration   54 stopping due to small subspace S singular value of 8.06e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 6.447634e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.947232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8742e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8999
    reference variance = 0.479009
====================================================
  Execution time = 4.3012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5012e-01
  Total weights = 2.0000e+06
  Execution time = 3.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474402827
  error estimate for blocks of size 2^( 2) =       0.000499422580
  error estimate for blocks of size 2^( 3) =       0.000523736009
  error estimate for blocks of size 2^( 4) =       0.000541960651
  error estimate for blocks of size 2^( 5) =       0.000551308655
  error estimate for blocks of size 2^( 6) =       0.000558701027
  error estimate for blocks of size 2^( 7) =       0.000562183248

      target function =      -0.745154380953
              le_mean =     -22.814636937648
             les_mean =     520.957774455560
             stat err =       0.000553538395
             autocorr =       1.361447705608
   target nu stat err =       0.000553538395
   target dn stat err =       0.003918968809
      target stat err =       0.003353447975
              std dev =       0.670906911521
             le_variance =       0.450116083926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474402827
  error estimate for blocks of size 2^( 2) =       0.000499422580
  error estimate for blocks of size 2^( 3) =       0.000523736009
  error estimate for blocks of size 2^( 4) =       0.000541960651
  error estimate for blocks of size 2^( 5) =       0.000551308655
  error estimate for blocks of size 2^( 6) =       0.000558701027
  error estimate for blocks of size 2^( 7) =       0.000562183248

      target function =      -0.745154380953
              le_mean =     -22.814636937648
             les_mean =     520.957774455560
             stat err =       0.000553538395
             autocorr =       1.361447705608
   target nu stat err =       0.000553538395
   target dn stat err =       0.003918968809
      target stat err =       0.003353447975
              std dev =       0.670906911521
             le_variance =       0.450116083926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474402827
  error estimate for blocks of size 2^( 2) =       0.000499422580
  error estimate for blocks of size 2^( 3) =       0.000523736009
  error estimate for blocks of size 2^( 4) =       0.000541960651
  error estimate for blocks of size 2^( 5) =       0.000551308655
  error estimate for blocks of size 2^( 6) =       0.000558701027
  error estimate for blocks of size 2^( 7) =       0.000562183248

      target function =      -0.745154380953
              le_mean =     -22.814636937648
             les_mean =     520.957774455560
             stat err =       0.000553538395
             autocorr =       1.361447705612
   target nu stat err =       0.000553538395
   target dn stat err =       0.003918968809
      target stat err =       0.003353447975
              std dev =       0.670906911521
             le_variance =       0.450116083926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450021152748
                                         uncertainty =       0.004173207201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474402827
  error estimate for blocks of size 2^( 2) =       0.000499422580
  error estimate for blocks of size 2^( 3) =       0.000523736009
  error estimate for blocks of size 2^( 4) =       0.000541960651
  error estimate for blocks of size 2^( 5) =       0.000551308655
  error estimate for blocks of size 2^( 6) =       0.000558701027
  error estimate for blocks of size 2^( 7) =       0.000562183248

      target function =      -0.745154380953
              le_mean =     -22.814636937648
             les_mean =     520.957774455560
             stat err =       0.000553538395
             autocorr =       1.361447705608
   target nu stat err =       0.000553538395
   target dn stat err =       0.003918968809
      target stat err =       0.003353447975
              std dev =       0.670906911521
             le_variance =       0.450116083926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745154380953        initial
     1.5625e+11     1.5625e+12             4.0297e-15        -0.745154380953
     6.2500e+11     6.2500e+12             2.4884e-16        -0.745154380953
     2.5000e+12     2.5000e+13             6.4476e-17        -0.745154380953  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+12     and shift_s =   2.5000e+13
*****************************************************************************

  Execution time = 6.0480e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1923e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2839e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7587
    reference variance = 0.721515
====================================================
  Execution time = 4.4047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4615e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450600472687
                                         uncertainty =       0.002708925415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450600472687
                                         uncertainty =       0.002708925415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474632323
  error estimate for blocks of size 2^( 2) =       0.000500113339
  error estimate for blocks of size 2^( 3) =       0.000523350837
  error estimate for blocks of size 2^( 4) =       0.000541519146
  error estimate for blocks of size 2^( 5) =       0.000553201269
  error estimate for blocks of size 2^( 6) =       0.000560440175
  error estimate for blocks of size 2^( 7) =       0.000561730846

      target function =      -0.744795542072
              le_mean =     -22.814556054173
             les_mean =     520.954519407106
             stat err =       0.000554222859
             autocorr =       1.363497192082
   target nu stat err =       0.000554222859
   target dn stat err =       0.003024016689
      target stat err =       0.002615349500
              std dev =       0.671231467825
             le_variance =       0.450551683399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281455605417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744803698704       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744803698704       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744803698704       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744803698704       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744803698704       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744803780128       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744803459955       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744321236066       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745221326800       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744095893251       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745589721460       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745488199634       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744911348916       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744819017064       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744240658622       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744134192719       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746143929760       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746413749068       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745698181143       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746539238640       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745848596531       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744523200102       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746033247236       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742567769291       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744429475075       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746532442960       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746353233724       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748463900496       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740932249015       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745314764471       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746374744962       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743585431125       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750992964975       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.751289376988       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737424551166       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741392357650       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748870699773       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.740916761761       residual = 9.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.751917369424       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744447409484       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745980236075       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749868733442       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742295580011       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.737171595604       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743575200615       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.752424151062       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.807480872669       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.700048942455       residual = 9.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.762719089169       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.811311193966       residual = 3.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.699835767788       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.764885856669       residual = 7.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.191019490659       residual = 1.58e+02           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 3.238122e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744803698704       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744803698704       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744803698704       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744803698704       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744803698704       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744803698706       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744768902027       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744039443025       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744912273235       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741904374265       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741356477309       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741505390817       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745900988753       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747834145957       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744525322813       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745567733717       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.756378940155       residual = 8.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.758583923374       residual = 9.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749800397544       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743626355558       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741892436591       residual = 6.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745490241286       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742454430160       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740633871646       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750136225034       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750904546013       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743088272377       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741591474552       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752230465345       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746495283422       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.738825367523       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.758128241255       residual = 8.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.731045617796       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.723062709960       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744093060078       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748662427453       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.756657756375       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.731319045631       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.706190066674       residual = 7.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744849700124       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.756238236004       residual = 2.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.775340342384       residual = 4.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.735132460936       residual = 4.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.785088502164       residual = 9.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.725241804191       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.782265709760       residual = 6.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.765269084426       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.811625457264       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.788551195545       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.813543654479       residual = 3.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.944998494891       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744410529176       residual = 2.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.655634028207       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.447232894646       residual = 5.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   54 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 8.087315e-17

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744803698704       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744803698704       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744803698704       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744803698704       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740614259068       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734698131605       residual = 5.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749904366854       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.771483210852       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752087771764       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.757530871523       residual = 1.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735475112274       residual = 6.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.765122998275       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744904169241       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.774797785442       residual = 5.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.759601387972       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742443711410       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.793525632708       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.720693359679       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.851487276497       residual = 6.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.727509858964       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.708010480041       residual = 7.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.721286022114       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.836924334820       residual = 4.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.764835463774       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909717689602       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.753024735463       residual = 6.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.761439116933       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.669080736535       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.696986706644       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.761606886869       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.604328799014       residual = 9.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.822633342509       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.738790649267       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.868126641690       residual = 7.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.716728518602       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.670181309584       residual = 3.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.687036140395       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.595625833372       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.922824343256       residual = 1.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.680647268776       residual = 4.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.884078682621       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.167198952252       residual = 8.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.347987598669       residual = 8.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.590895075047       residual = 1.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.725427056088       residual = 3.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.618393930184       residual = 7.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.633746342627       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.542344075580       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.032696628339       residual = 4.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =       0.662614332630       residual = 1.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       3.626463018904       residual = 9.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =       1.748035393863       residual = 2.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -6.007786105836       residual = 1.51e+04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =       1.187923399818       residual = 3.90e+03           smallest_sin_value = 9.93e-01
davidson iteration   54 stopping due to small subspace S singular value of 8.19e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 1.862925e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.119905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8840e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.91
    reference variance = 0.335532
====================================================
  Execution time = 4.5012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4129e-01
  Total weights = 2.0000e+06
  Execution time = 3.4924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469727197
  error estimate for blocks of size 2^( 2) =       0.000495061563
  error estimate for blocks of size 2^( 3) =       0.000519108261
  error estimate for blocks of size 2^( 4) =       0.000537820841
  error estimate for blocks of size 2^( 5) =       0.000549316668
  error estimate for blocks of size 2^( 6) =       0.000554308155
  error estimate for blocks of size 2^( 7) =       0.000557412548

      target function =      -0.752658477606
              le_mean =     -22.814792108817
             les_mean =     520.956026027912
             stat err =       0.000549714553
             autocorr =       1.369566283378
   target nu stat err =       0.000549714553
   target dn stat err =       0.002629584728
      target stat err =       0.002341421426
              std dev =       0.664294573224
             le_variance =       0.441287280015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469727197
  error estimate for blocks of size 2^( 2) =       0.000495061563
  error estimate for blocks of size 2^( 3) =       0.000519108261
  error estimate for blocks of size 2^( 4) =       0.000537820841
  error estimate for blocks of size 2^( 5) =       0.000549316668
  error estimate for blocks of size 2^( 6) =       0.000554308155
  error estimate for blocks of size 2^( 7) =       0.000557412548

      target function =      -0.752658477606
              le_mean =     -22.814792108817
             les_mean =     520.956026027912
             stat err =       0.000549714553
             autocorr =       1.369566283382
   target nu stat err =       0.000549714553
   target dn stat err =       0.002629584728
      target stat err =       0.002341421426
              std dev =       0.664294573224
             le_variance =       0.441287280015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469727197
  error estimate for blocks of size 2^( 2) =       0.000495061563
  error estimate for blocks of size 2^( 3) =       0.000519108261
  error estimate for blocks of size 2^( 4) =       0.000537820841
  error estimate for blocks of size 2^( 5) =       0.000549316668
  error estimate for blocks of size 2^( 6) =       0.000554308155
  error estimate for blocks of size 2^( 7) =       0.000557412548

      target function =      -0.752658477606
              le_mean =     -22.814792108817
             les_mean =     520.956026027912
             stat err =       0.000549714553
             autocorr =       1.369566283382
   target nu stat err =       0.000549714553
   target dn stat err =       0.002629584728
      target stat err =       0.002341421426
              std dev =       0.664294573224
             le_variance =       0.441287280015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441351413056
                                         uncertainty =       0.002733508165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469727197
  error estimate for blocks of size 2^( 2) =       0.000495061563
  error estimate for blocks of size 2^( 3) =       0.000519108261
  error estimate for blocks of size 2^( 4) =       0.000537820841
  error estimate for blocks of size 2^( 5) =       0.000549316668
  error estimate for blocks of size 2^( 6) =       0.000554308155
  error estimate for blocks of size 2^( 7) =       0.000557412548

      target function =      -0.752658477606
              le_mean =     -22.814792108817
             les_mean =     520.956026027912
             stat err =       0.000549714553
             autocorr =       1.369566283387
   target nu stat err =       0.000549714553
   target dn stat err =       0.002629584728
      target stat err =       0.002341421426
              std dev =       0.664294573224
             le_variance =       0.441287280015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752658477606        initial  <--
     6.2500e+11     6.2500e+12             3.2381e-16        -0.752658477606
     2.5000e+12     2.5000e+13             8.0873e-17        -0.752658477606
     1.0000e+13     1.0000e+14             1.8629e-17        -0.752658477606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4876
  </log>
  <optVariables href="FORM2.s016.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2136e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7922
    reference variance = 0.432073
====================================================
  Execution time = 4.3644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4665e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4764e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446648764045
                                         uncertainty =       0.003956874183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446648764045
                                         uncertainty =       0.003956874183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472570895
  error estimate for blocks of size 2^( 2) =       0.000497587807
  error estimate for blocks of size 2^( 3) =       0.000521242651
  error estimate for blocks of size 2^( 4) =       0.000538826695
  error estimate for blocks of size 2^( 5) =       0.000550979354
  error estimate for blocks of size 2^( 6) =       0.000557025865
  error estimate for blocks of size 2^( 7) =       0.000560233470

      target function =      -0.748084414549
              le_mean =     -22.814484829533
             les_mean =     520.947364314497
             stat err =       0.000551766346
             autocorr =       1.363253041548
   target nu stat err =       0.000551766346
   target dn stat err =       0.003963315596
      target stat err =       0.003415193402
              std dev =       0.668316168318
             le_variance =       0.446646500835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448482953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748098780655       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748098780655       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748098780655       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748098780655       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.68e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748098780655       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748098780655       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.68e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.120975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8414e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8209
    reference variance = 0.444074
====================================================
  Execution time = 4.3392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5810e-01
  Total weights = 2.0000e+06
  Execution time = 3.9246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478590158
  error estimate for blocks of size 2^( 2) =       0.000504012508
  error estimate for blocks of size 2^( 3) =       0.000528055203
  error estimate for blocks of size 2^( 4) =       0.000546018825
  error estimate for blocks of size 2^( 5) =       0.000557468219
  error estimate for blocks of size 2^( 6) =       0.000563032630
  error estimate for blocks of size 2^( 7) =       0.000566455293

      target function =      -0.738483399489
              le_mean =     -22.814712581348
             les_mean =     520.969207018674
             stat err =       0.000558243742
             autocorr =       1.360567836098
   target nu stat err =       0.000558243742
   target dn stat err =       0.006002192752
      target stat err =       0.004996104992
              std dev =       0.676828691931
             le_variance =       0.458097078221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478590158
  error estimate for blocks of size 2^( 2) =       0.000504012508
  error estimate for blocks of size 2^( 3) =       0.000528055203
  error estimate for blocks of size 2^( 4) =       0.000546018825
  error estimate for blocks of size 2^( 5) =       0.000557468219
  error estimate for blocks of size 2^( 6) =       0.000563032630
  error estimate for blocks of size 2^( 7) =       0.000566455293

      target function =      -0.738483399489
              le_mean =     -22.814712581348
             les_mean =     520.969207018674
             stat err =       0.000558243742
             autocorr =       1.360567836098
   target nu stat err =       0.000558243742
   target dn stat err =       0.006002192752
      target stat err =       0.004996104992
              std dev =       0.676828691931
             le_variance =       0.458097078221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478590158
  error estimate for blocks of size 2^( 2) =       0.000504012508
  error estimate for blocks of size 2^( 3) =       0.000528055203
  error estimate for blocks of size 2^( 4) =       0.000546018825
  error estimate for blocks of size 2^( 5) =       0.000557468219
  error estimate for blocks of size 2^( 6) =       0.000563032630
  error estimate for blocks of size 2^( 7) =       0.000566455293

      target function =      -0.738483399489
              le_mean =     -22.814712581348
             les_mean =     520.969207018674
             stat err =       0.000558243742
             autocorr =       1.360567836098
   target nu stat err =       0.000558243742
   target dn stat err =       0.006002192752
      target stat err =       0.004996104992
              std dev =       0.676828691931
             le_variance =       0.458097078221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458100108259
                                         uncertainty =       0.006091438791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478590158
  error estimate for blocks of size 2^( 2) =       0.000504012508
  error estimate for blocks of size 2^( 3) =       0.000528055203
  error estimate for blocks of size 2^( 4) =       0.000546018825
  error estimate for blocks of size 2^( 5) =       0.000557468219
  error estimate for blocks of size 2^( 6) =       0.000563032630
  error estimate for blocks of size 2^( 7) =       0.000566455293

      target function =      -0.738483399489
              le_mean =     -22.814712581348
             les_mean =     520.969207018674
             stat err =       0.000558243742
             autocorr =       1.360567836098
   target nu stat err =       0.000558243742
   target dn stat err =       0.006002192752
      target stat err =       0.004996104992
              std dev =       0.676828691931
             le_variance =       0.458097078221


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738483399489        initial  <--
     6.2500e+12     6.2500e+13             0.0000e+00        -0.738483399489
     2.5000e+13     2.5000e+14             0.0000e+00        -0.738483399489
     1.0000e+14     1.0000e+15             0.0000e+00        -0.738483399489

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4886
  </log>
  <optVariables href="FORM2.s017.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1991e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8328
    reference variance = 0.304885
====================================================
  Execution time = 4.3918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5613e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4864e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040637499
                                         uncertainty =       0.003689639631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040637499
                                         uncertainty =       0.003689639631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477562643
  error estimate for blocks of size 2^( 2) =       0.000502590609
  error estimate for blocks of size 2^( 3) =       0.000526589996
  error estimate for blocks of size 2^( 4) =       0.000544673610
  error estimate for blocks of size 2^( 5) =       0.000556059857
  error estimate for blocks of size 2^( 6) =       0.000561702558
  error estimate for blocks of size 2^( 7) =       0.000566665068

      target function =      -0.740130601367
              le_mean =     -22.814696981193
             les_mean =     520.966530272261
             stat err =       0.000557275273
             autocorr =       1.361691893725
   target nu stat err =       0.000557275273
   target dn stat err =       0.003704376973
      target stat err =       0.003135618824
              std dev =       0.675375567137
             le_variance =       0.456132156685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281469698119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740142905960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740142905960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.77e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740142905960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740142905960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740142905960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740142905960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.122037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8789e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8587
    reference variance = 1.00962
====================================================
  Execution time = 4.2914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5078e-01
  Total weights = 2.0000e+06
  Execution time = 3.4819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474753464
  error estimate for blocks of size 2^( 2) =       0.000499855265
  error estimate for blocks of size 2^( 3) =       0.000523283291
  error estimate for blocks of size 2^( 4) =       0.000541231122
  error estimate for blocks of size 2^( 5) =       0.000552866920
  error estimate for blocks of size 2^( 6) =       0.000560741746
  error estimate for blocks of size 2^( 7) =       0.000564920152

      target function =      -0.744614576392
              le_mean =     -22.813670563340
             les_mean =     520.914346050885
             stat err =       0.000554939985
             autocorr =       1.366330463970
   target nu stat err =       0.000554939985
   target dn stat err =       0.003586885951
      target stat err =       0.003071030347
              std dev =       0.671402787952
             le_variance =       0.450781703670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474753464
  error estimate for blocks of size 2^( 2) =       0.000499855265
  error estimate for blocks of size 2^( 3) =       0.000523283291
  error estimate for blocks of size 2^( 4) =       0.000541231122
  error estimate for blocks of size 2^( 5) =       0.000552866920
  error estimate for blocks of size 2^( 6) =       0.000560741746
  error estimate for blocks of size 2^( 7) =       0.000564920152

      target function =      -0.744614576392
              le_mean =     -22.813670563340
             les_mean =     520.914346050885
             stat err =       0.000554939985
             autocorr =       1.366330463974
   target nu stat err =       0.000554939985
   target dn stat err =       0.003586885951
      target stat err =       0.003071030347
              std dev =       0.671402787952
             le_variance =       0.450781703670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474753464
  error estimate for blocks of size 2^( 2) =       0.000499855265
  error estimate for blocks of size 2^( 3) =       0.000523283291
  error estimate for blocks of size 2^( 4) =       0.000541231122
  error estimate for blocks of size 2^( 5) =       0.000552866920
  error estimate for blocks of size 2^( 6) =       0.000560741746
  error estimate for blocks of size 2^( 7) =       0.000564920152

      target function =      -0.744614576392
              le_mean =     -22.813670563340
             les_mean =     520.914346050885
             stat err =       0.000554939985
             autocorr =       1.366330463974
   target nu stat err =       0.000554939985
   target dn stat err =       0.003586885951
      target stat err =       0.003071030347
              std dev =       0.671402787952
             le_variance =       0.450781703670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450547757639
                                         uncertainty =       0.003090406122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474753464
  error estimate for blocks of size 2^( 2) =       0.000499855265
  error estimate for blocks of size 2^( 3) =       0.000523283291
  error estimate for blocks of size 2^( 4) =       0.000541231122
  error estimate for blocks of size 2^( 5) =       0.000552866920
  error estimate for blocks of size 2^( 6) =       0.000560741746
  error estimate for blocks of size 2^( 7) =       0.000564920152

      target function =      -0.744614576392
              le_mean =     -22.813670563340
             les_mean =     520.914346050885
             stat err =       0.000554939985
             autocorr =       1.366330463974
   target nu stat err =       0.000554939985
   target dn stat err =       0.003586885951
      target stat err =       0.003071030347
              std dev =       0.671402787952
             le_variance =       0.450781703670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744614576392        initial  <--
     6.2500e+13     6.2500e+14             0.0000e+00        -0.744614576392
     2.5000e+14     2.5000e+15             0.0000e+00        -0.744614576392
     1.0000e+15     1.0000e+16             0.0000e+00        -0.744614576392

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4414
  </log>
  <optVariables href="FORM2.s018.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1947e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.9194
    reference variance = 0.611072
====================================================
  Execution time = 4.5621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4656e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451247092095
                                         uncertainty =       0.003567478772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451247092095
                                         uncertainty =       0.003567478772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474979462
  error estimate for blocks of size 2^( 2) =       0.000500535721
  error estimate for blocks of size 2^( 3) =       0.000523846445
  error estimate for blocks of size 2^( 4) =       0.000541252250
  error estimate for blocks of size 2^( 5) =       0.000553744372
  error estimate for blocks of size 2^( 6) =       0.000559549849
  error estimate for blocks of size 2^( 7) =       0.000561504547

      target function =      -0.744219044338
              le_mean =     -22.815519380745
             les_mean =     520.999135366364
             stat err =       0.000554012755
             autocorr =       1.360472802160
   target nu stat err =       0.000554012755
   target dn stat err =       0.003678383614
      target stat err =       0.003151495238
              std dev =       0.671722397125
             le_variance =       0.451210978800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281551938075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744231397737       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744231397737       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744231397737       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744231397795       residual = 3.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744231397737       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744231423520       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.688417459960       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.496913022289       residual = 2.87e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.050033475907       residual = 2.94e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.505315278690       residual = 4.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.000169662586       residual = 3.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.511408186649       residual = 4.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.169703504704       residual = 2.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.727642443323       residual = 6.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       1.961547667840       residual = 3.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -3.224481304527       residual = 2.95e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.045002485637       residual = 4.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.222794272425       residual = 2.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       1.251251004774       residual = 1.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       2.545765930839       residual = 4.91e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -5.610592815341       residual = 1.11e+04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -2.875181876516       residual = 2.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       1.682732170144       residual = 2.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       2.547855870600       residual = 5.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.423943869781       residual = 3.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.217176028091       residual = 1.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -3.252970699215       residual = 2.65e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.318044074113       residual = 1.40e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -2.692247294588       residual = 1.95e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.465045783822       residual = 2.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+14 is 2.245403e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744231397737       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744231397737       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744231397737       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       1.132118181638       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744231389442       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -3.030126759062       residual = 2.44e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -3.270856480190       residual = 4.90e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946461327167       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.515965635886       residual = 1.05e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -2.071465538301       residual = 2.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -2.568017355010       residual = 3.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.955027370335       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.542373295597       residual = 3.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       6.455292232512       residual = 2.43e+04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.953163597011       residual = 3.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -7.926160583032       residual = 2.22e+04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -2.556084027966       residual = 2.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       2.502137570574       residual = 7.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+15 is 1.754491e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+16, overlap shift 1.0000e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744231397737       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744231397737       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744231397737       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744231397737       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744231397737       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744231302968       residual = 5.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744187115315       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+16 is 1.403377e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.138114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0298e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7151
    reference variance = 0.674184
====================================================
  Execution time = 4.3278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4537e-01
  Total weights = 2.0000e+06
  Execution time = 3.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471893242
  error estimate for blocks of size 2^( 2) =       0.000497854707
  error estimate for blocks of size 2^( 3) =       0.000521798454
  error estimate for blocks of size 2^( 4) =       0.000540208255
  error estimate for blocks of size 2^( 5) =       0.000553516575
  error estimate for blocks of size 2^( 6) =       0.000561904095
  error estimate for blocks of size 2^( 7) =       0.000566633215

      target function =      -0.749168125041
              le_mean =     -22.815107447659
             les_mean =     520.974494088944
             stat err =       0.000555565535
             autocorr =       1.386063339123
   target nu stat err =       0.000555565535
   target dn stat err =       0.003141531345
      target stat err =       0.002745007501
              std dev =       0.667357822611
             le_variance =       0.445366463400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471893242
  error estimate for blocks of size 2^( 2) =       0.000497854707
  error estimate for blocks of size 2^( 3) =       0.000521798454
  error estimate for blocks of size 2^( 4) =       0.000540208255
  error estimate for blocks of size 2^( 5) =       0.000553516575
  error estimate for blocks of size 2^( 6) =       0.000561904095
  error estimate for blocks of size 2^( 7) =       0.000566633215

      target function =      -0.749168125041
              le_mean =     -22.815107447659
             les_mean =     520.974494088944
             stat err =       0.000555565535
             autocorr =       1.386063339123
   target nu stat err =       0.000555565535
   target dn stat err =       0.003141531345
      target stat err =       0.002745007501
              std dev =       0.667357822611
             le_variance =       0.445366463400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471893242
  error estimate for blocks of size 2^( 2) =       0.000497854707
  error estimate for blocks of size 2^( 3) =       0.000521798454
  error estimate for blocks of size 2^( 4) =       0.000540208255
  error estimate for blocks of size 2^( 5) =       0.000553516575
  error estimate for blocks of size 2^( 6) =       0.000561904095
  error estimate for blocks of size 2^( 7) =       0.000566633215

      target function =      -0.749168125041
              le_mean =     -22.815107447659
             les_mean =     520.974494088944
             stat err =       0.000555565535
             autocorr =       1.386063339123
   target nu stat err =       0.000555565535
   target dn stat err =       0.003141531345
      target stat err =       0.002745007501
              std dev =       0.667357822611
             le_variance =       0.445366463400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445378363036
                                         uncertainty =       0.003039499199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471893242
  error estimate for blocks of size 2^( 2) =       0.000497854707
  error estimate for blocks of size 2^( 3) =       0.000521798454
  error estimate for blocks of size 2^( 4) =       0.000540208255
  error estimate for blocks of size 2^( 5) =       0.000553516575
  error estimate for blocks of size 2^( 6) =       0.000561904095
  error estimate for blocks of size 2^( 7) =       0.000566633215

      target function =      -0.749168125041
              le_mean =     -22.815107447659
             les_mean =     520.974494088944
             stat err =       0.000555565535
             autocorr =       1.386063339123
   target nu stat err =       0.000555565535
   target dn stat err =       0.003141531345
      target stat err =       0.002745007501
              std dev =       0.667357822611
             le_variance =       0.445366463400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749168125041        initial  <--
     6.2500e+14     6.2500e+15             2.2454e-19        -0.749168125041
     2.5000e+15     2.5000e+16             1.7545e-20        -0.749168125041
     1.0000e+16     1.0000e+17             1.4034e-20        -0.749168125041

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7574
  </log>
  <optVariables href="FORM2.s019.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2108e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.82
    reference variance = 0.566906
====================================================
  Execution time = 4.5550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5459e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4837e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454616841835
                                         uncertainty =       0.006656716601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454616841835
                                         uncertainty =       0.006656716601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476754819
  error estimate for blocks of size 2^( 2) =       0.000501697582
  error estimate for blocks of size 2^( 3) =       0.000525975823
  error estimate for blocks of size 2^( 4) =       0.000544825477
  error estimate for blocks of size 2^( 5) =       0.000555880025
  error estimate for blocks of size 2^( 6) =       0.000563107141
  error estimate for blocks of size 2^( 7) =       0.000564881165

      target function =      -0.741392529696
              le_mean =     -22.814175259891
             les_mean =     520.941182876704
             stat err =       0.000557173452
             autocorr =       1.365811128909
   target nu stat err =       0.000557173452
   target dn stat err =       0.006872363324
      target stat err =       0.005749892510
              std dev =       0.674233131033
             le_variance =       0.454590314983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281417525989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741436007496       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741436007496       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741436007496       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741436007496       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+17, overlap shift 1.0000e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741436007496       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741436007496       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.139178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0393e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8022
    reference variance = 0.430805
====================================================
  Execution time = 4.3062e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4432e-01
  Total weights = 2.0000e+06
  Execution time = 3.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471339043
  error estimate for blocks of size 2^( 2) =       0.000497479184
  error estimate for blocks of size 2^( 3) =       0.000521497027
  error estimate for blocks of size 2^( 4) =       0.000539397306
  error estimate for blocks of size 2^( 5) =       0.000551206655
  error estimate for blocks of size 2^( 6) =       0.000557498583
  error estimate for blocks of size 2^( 7) =       0.000560716476

      target function =      -0.750068674134
              le_mean =     -22.814381119725
             les_mean =     520.940306639901
             stat err =       0.000552204755
             autocorr =       1.372566685213
   target nu stat err =       0.000552204755
   target dn stat err =       0.002697286660
      target stat err =       0.002380791897
              std dev =       0.666574066394
             le_variance =       0.444320985988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471339043
  error estimate for blocks of size 2^( 2) =       0.000497479184
  error estimate for blocks of size 2^( 3) =       0.000521497027
  error estimate for blocks of size 2^( 4) =       0.000539397306
  error estimate for blocks of size 2^( 5) =       0.000551206655
  error estimate for blocks of size 2^( 6) =       0.000557498583
  error estimate for blocks of size 2^( 7) =       0.000560716476

      target function =      -0.750068674134
              le_mean =     -22.814381119725
             les_mean =     520.940306639901
             stat err =       0.000552204755
             autocorr =       1.372566685218
   target nu stat err =       0.000552204755
   target dn stat err =       0.002697286660
      target stat err =       0.002380791897
              std dev =       0.666574066394
             le_variance =       0.444320985988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471339043
  error estimate for blocks of size 2^( 2) =       0.000497479184
  error estimate for blocks of size 2^( 3) =       0.000521497027
  error estimate for blocks of size 2^( 4) =       0.000539397306
  error estimate for blocks of size 2^( 5) =       0.000551206655
  error estimate for blocks of size 2^( 6) =       0.000557498583
  error estimate for blocks of size 2^( 7) =       0.000560716476

      target function =      -0.750068674134
              le_mean =     -22.814381119725
             les_mean =     520.940306639901
             stat err =       0.000552204755
             autocorr =       1.372566685218
   target nu stat err =       0.000552204755
   target dn stat err =       0.002697286660
      target stat err =       0.002380791897
              std dev =       0.666574066394
             le_variance =       0.444320985988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444283800539
                                         uncertainty =       0.002279617355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471339043
  error estimate for blocks of size 2^( 2) =       0.000497479184
  error estimate for blocks of size 2^( 3) =       0.000521497027
  error estimate for blocks of size 2^( 4) =       0.000539397306
  error estimate for blocks of size 2^( 5) =       0.000551206655
  error estimate for blocks of size 2^( 6) =       0.000557498583
  error estimate for blocks of size 2^( 7) =       0.000560716476

      target function =      -0.750068674134
              le_mean =     -22.814381119725
             les_mean =     520.940306639901
             stat err =       0.000552204755
             autocorr =       1.372566685218
   target nu stat err =       0.000552204755
   target dn stat err =       0.002697286660
      target stat err =       0.002380791897
              std dev =       0.666574066394
             le_variance =       0.444320985988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750068674134        initial  <--
     6.2500e+15     6.2500e+16             0.0000e+00        -0.750068674134
     2.5000e+16     2.5000e+17             0.0000e+00        -0.750068674134
     1.0000e+17     1.0000e+18             0.0000e+00        -0.750068674134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5082
  </log>
  <optVariables href="FORM2.s020.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2091e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8713
    reference variance = 0.58915
====================================================
  Execution time = 4.4114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4699e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453005908330
                                         uncertainty =       0.004447473776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453005908330
                                         uncertainty =       0.004447473776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475874599
  error estimate for blocks of size 2^( 2) =       0.000501550585
  error estimate for blocks of size 2^( 3) =       0.000525311691
  error estimate for blocks of size 2^( 4) =       0.000543857295
  error estimate for blocks of size 2^( 5) =       0.000555451066
  error estimate for blocks of size 2^( 6) =       0.000563442827
  error estimate for blocks of size 2^( 7) =       0.000564494991

      target function =      -0.742805319647
              le_mean =     -22.814485323908
             les_mean =     520.953653635659
             stat err =       0.000556811545
             autocorr =       1.369088161966
   target nu stat err =       0.000556811545
   target dn stat err =       0.004904836059
      target stat err =       0.004144337055
              std dev =       0.672988311422
             le_variance =       0.452913267311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448532391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742827149154       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742827149154       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742827149154       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742827149154       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742827149154       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742827149154       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742845526678       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+16 is 2.813579e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742827149154       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742827149154       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742827149154       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742827149154       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742827149154       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742827149154       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742925749421       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+17 is 7.033948e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+18, overlap shift 1.0000e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742827149154       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742827149154       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742827149154       residual = 7.14e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742827149154       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+18 is 1.634350e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.141481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8821e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8131
    reference variance = 0.34064
====================================================
  Execution time = 4.5089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6328e-01
  Total weights = 2.0000e+06
  Execution time = 3.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481287672
  error estimate for blocks of size 2^( 2) =       0.000505733529
  error estimate for blocks of size 2^( 3) =       0.000529308047
  error estimate for blocks of size 2^( 4) =       0.000546598206
  error estimate for blocks of size 2^( 5) =       0.000558146396
  error estimate for blocks of size 2^( 6) =       0.000564196398
  error estimate for blocks of size 2^( 7) =       0.000568687023

      target function =      -0.734036028649
              le_mean =     -22.813621338132
             les_mean =     520.924593975081
             stat err =       0.000559407006
             autocorr =       1.350971932985
   target nu stat err =       0.000559407006
   target dn stat err =       0.017020888241
      target stat err =       0.013883349083
              std dev =       0.680643553581
             le_variance =       0.463275647032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481287672
  error estimate for blocks of size 2^( 2) =       0.000505733529
  error estimate for blocks of size 2^( 3) =       0.000529308047
  error estimate for blocks of size 2^( 4) =       0.000546598206
  error estimate for blocks of size 2^( 5) =       0.000558146396
  error estimate for blocks of size 2^( 6) =       0.000564196398
  error estimate for blocks of size 2^( 7) =       0.000568687023

      target function =      -0.734036028649
              le_mean =     -22.813621338132
             les_mean =     520.924593975081
             stat err =       0.000559407006
             autocorr =       1.350971932985
   target nu stat err =       0.000559407006
   target dn stat err =       0.017020888241
      target stat err =       0.013883349083
              std dev =       0.680643553581
             le_variance =       0.463275647032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481287672
  error estimate for blocks of size 2^( 2) =       0.000505733529
  error estimate for blocks of size 2^( 3) =       0.000529308047
  error estimate for blocks of size 2^( 4) =       0.000546598206
  error estimate for blocks of size 2^( 5) =       0.000558146396
  error estimate for blocks of size 2^( 6) =       0.000564196398
  error estimate for blocks of size 2^( 7) =       0.000568687023

      target function =      -0.734036028649
              le_mean =     -22.813621338132
             les_mean =     520.924593975081
             stat err =       0.000559407006
             autocorr =       1.350971932985
   target nu stat err =       0.000559407006
   target dn stat err =       0.017020888241
      target stat err =       0.013883349083
              std dev =       0.680643553581
             le_variance =       0.463275647032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463318447476
                                         uncertainty =       0.017204280384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481287672
  error estimate for blocks of size 2^( 2) =       0.000505733529
  error estimate for blocks of size 2^( 3) =       0.000529308047
  error estimate for blocks of size 2^( 4) =       0.000546598206
  error estimate for blocks of size 2^( 5) =       0.000558146396
  error estimate for blocks of size 2^( 6) =       0.000564196398
  error estimate for blocks of size 2^( 7) =       0.000568687023

      target function =      -0.734036028649
              le_mean =     -22.813621338132
             les_mean =     520.924593975081
             stat err =       0.000559407006
             autocorr =       1.350971932985
   target nu stat err =       0.000559407006
   target dn stat err =       0.017020888241
      target stat err =       0.013883349083
              std dev =       0.680643553581
             le_variance =       0.463275647032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.734036028649        initial  <--
     6.2500e+16     6.2500e+17             2.8136e-21        -0.734036028649
     2.5000e+17     2.5000e+18             7.0339e-22        -0.734036028649
     1.0000e+18     1.0000e+19             1.6343e-22        -0.734036028649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6101
  </log>
  <optVariables href="FORM2.s021.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2144e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7738
    reference variance = 0.358371
====================================================
  Execution time = 4.3953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4904e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4750e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449154466145
                                         uncertainty =       0.003168703821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449154466145
                                         uncertainty =       0.003168703821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473837196
  error estimate for blocks of size 2^( 2) =       0.000499796799
  error estimate for blocks of size 2^( 3) =       0.000523427272
  error estimate for blocks of size 2^( 4) =       0.000540337161
  error estimate for blocks of size 2^( 5) =       0.000550823812
  error estimate for blocks of size 2^( 6) =       0.000556415776
  error estimate for blocks of size 2^( 7) =       0.000561265847

      target function =      -0.746052704026
              le_mean =     -22.815186908472
             les_mean =     520.981796820477
             stat err =       0.000552210649
             autocorr =       1.358161000069
   target nu stat err =       0.000552210649
   target dn stat err =       0.003185597316
      target stat err =       0.002758472174
              std dev =       0.670106988819
             le_variance =       0.449043376465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281518690847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746061967012       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746061967012       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746061967012       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746061967012       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+19, overlap shift 1.0000e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746061967012       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746061967012       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.142565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8710e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7819
    reference variance = 0.503719
====================================================
  Execution time = 4.4693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4949e-01
  Total weights = 2.0000e+06
  Execution time = 3.5818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474073249
  error estimate for blocks of size 2^( 2) =       0.000499468017
  error estimate for blocks of size 2^( 3) =       0.000522789677
  error estimate for blocks of size 2^( 4) =       0.000540688179
  error estimate for blocks of size 2^( 5) =       0.000552232302
  error estimate for blocks of size 2^( 6) =       0.000558216961
  error estimate for blocks of size 2^( 7) =       0.000563332556

      target function =      -0.745673780623
              le_mean =     -22.815036422043
             les_mean =     520.975377605316
             stat err =       0.000553617499
             autocorr =       1.363731020520
   target nu stat err =       0.000553617499
   target dn stat err =       0.003869467901
      target stat err =       0.003319128916
              std dev =       0.670440818353
             le_variance =       0.449490890914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474073249
  error estimate for blocks of size 2^( 2) =       0.000499468017
  error estimate for blocks of size 2^( 3) =       0.000522789677
  error estimate for blocks of size 2^( 4) =       0.000540688179
  error estimate for blocks of size 2^( 5) =       0.000552232302
  error estimate for blocks of size 2^( 6) =       0.000558216961
  error estimate for blocks of size 2^( 7) =       0.000563332556

      target function =      -0.745673780623
              le_mean =     -22.815036422043
             les_mean =     520.975377605316
             stat err =       0.000553617499
             autocorr =       1.363731020520
   target nu stat err =       0.000553617499
   target dn stat err =       0.003869467901
      target stat err =       0.003319128916
              std dev =       0.670440818353
             le_variance =       0.449490890914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474073249
  error estimate for blocks of size 2^( 2) =       0.000499468017
  error estimate for blocks of size 2^( 3) =       0.000522789677
  error estimate for blocks of size 2^( 4) =       0.000540688179
  error estimate for blocks of size 2^( 5) =       0.000552232302
  error estimate for blocks of size 2^( 6) =       0.000558216961
  error estimate for blocks of size 2^( 7) =       0.000563332556

      target function =      -0.745673780623
              le_mean =     -22.815036422043
             les_mean =     520.975377605316
             stat err =       0.000553617499
             autocorr =       1.363731020520
   target nu stat err =       0.000553617499
   target dn stat err =       0.003869467901
      target stat err =       0.003319128916
              std dev =       0.670440818353
             le_variance =       0.449490890914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449486004569
                                         uncertainty =       0.003993136478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474073249
  error estimate for blocks of size 2^( 2) =       0.000499468017
  error estimate for blocks of size 2^( 3) =       0.000522789677
  error estimate for blocks of size 2^( 4) =       0.000540688179
  error estimate for blocks of size 2^( 5) =       0.000552232302
  error estimate for blocks of size 2^( 6) =       0.000558216961
  error estimate for blocks of size 2^( 7) =       0.000563332556

      target function =      -0.745673780623
              le_mean =     -22.815036422043
             les_mean =     520.975377605316
             stat err =       0.000553617499
             autocorr =       1.363731020520
   target nu stat err =       0.000553617499
   target dn stat err =       0.003869467901
      target stat err =       0.003319128916
              std dev =       0.670440818353
             le_variance =       0.449490890914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745673780623        initial  <--
     6.2500e+17     6.2500e+18             0.0000e+00        -0.745673780623
     2.5000e+18     2.5000e+19             0.0000e+00        -0.745673780623
     1.0000e+19     1.0000e+20             0.0000e+00        -0.745673780623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.2670
  </log>
  <optVariables href="FORM2.s022.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2098e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7808
    reference variance = 0.461596
====================================================
  Execution time = 4.3812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4750e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4716e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447273041195
                                         uncertainty =       0.003356543610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447273041195
                                         uncertainty =       0.003356543610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473023613
  error estimate for blocks of size 2^( 2) =       0.000498549462
  error estimate for blocks of size 2^( 3) =       0.000522280954
  error estimate for blocks of size 2^( 4) =       0.000540534775
  error estimate for blocks of size 2^( 5) =       0.000552521906
  error estimate for blocks of size 2^( 6) =       0.000558219818
  error estimate for blocks of size 2^( 7) =       0.000564217837

      target function =      -0.747358976623
              le_mean =     -22.814811930883
             les_mean =     520.963145893791
             stat err =       0.000553873584
             autocorr =       1.371057486165
   target nu stat err =       0.000553873584
   target dn stat err =       0.003380677048
      target stat err =       0.002927720952
              std dev =       0.668956408146
             le_variance =       0.447502675999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281481193088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747369417068       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747369417068       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747369417068       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747369417068       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747369417068       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747369417068       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746902092250       residual = 7.77e+01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+18 is 2.622313e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747369417068       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747369417068       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747369417068       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747369417068       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747369417077       residual = 7.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747358093389       residual = 1.84e+01           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+19 is 5.612478e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+20, overlap shift 1.0000e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747369417068       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747369417068       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747369417068       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747369417068       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747369417068       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747369417068       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+20 is 1.638946e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.144976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8537e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.662
    reference variance = 2.44157
====================================================
  Execution time = 4.3300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4550e-01
  Total weights = 2.0000e+06
  Execution time = 3.4874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471963527
  error estimate for blocks of size 2^( 2) =       0.000497461453
  error estimate for blocks of size 2^( 3) =       0.000521451368
  error estimate for blocks of size 2^( 4) =       0.000539129876
  error estimate for blocks of size 2^( 5) =       0.000550576019
  error estimate for blocks of size 2^( 6) =       0.000556831388
  error estimate for blocks of size 2^( 7) =       0.000561011877

      target function =      -0.749066661792
              le_mean =     -22.814455644278
             les_mean =     520.944885263468
             stat err =       0.000551887290
             autocorr =       1.367363267877
   target nu stat err =       0.000551887290
   target dn stat err =       0.002551658501
      target stat err =       0.002255745723
              std dev =       0.667457220719
             le_variance =       0.445499141490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471963527
  error estimate for blocks of size 2^( 2) =       0.000497461453
  error estimate for blocks of size 2^( 3) =       0.000521451368
  error estimate for blocks of size 2^( 4) =       0.000539129876
  error estimate for blocks of size 2^( 5) =       0.000550576019
  error estimate for blocks of size 2^( 6) =       0.000556831388
  error estimate for blocks of size 2^( 7) =       0.000561011877

      target function =      -0.749066661792
              le_mean =     -22.814455644278
             les_mean =     520.944885263468
             stat err =       0.000551887290
             autocorr =       1.367363267880
   target nu stat err =       0.000551887290
   target dn stat err =       0.002551658501
      target stat err =       0.002255745723
              std dev =       0.667457220719
             le_variance =       0.445499141490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471963527
  error estimate for blocks of size 2^( 2) =       0.000497461453
  error estimate for blocks of size 2^( 3) =       0.000521451368
  error estimate for blocks of size 2^( 4) =       0.000539129876
  error estimate for blocks of size 2^( 5) =       0.000550576019
  error estimate for blocks of size 2^( 6) =       0.000556831388
  error estimate for blocks of size 2^( 7) =       0.000561011877

      target function =      -0.749066661792
              le_mean =     -22.814455644278
             les_mean =     520.944885263468
             stat err =       0.000551887290
             autocorr =       1.367363267880
   target nu stat err =       0.000551887290
   target dn stat err =       0.002551658501
      target stat err =       0.002255745723
              std dev =       0.667457220719
             le_variance =       0.445499141490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445403452303
                                         uncertainty =       0.002528743728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471963527
  error estimate for blocks of size 2^( 2) =       0.000497461453
  error estimate for blocks of size 2^( 3) =       0.000521451368
  error estimate for blocks of size 2^( 4) =       0.000539129876
  error estimate for blocks of size 2^( 5) =       0.000550576019
  error estimate for blocks of size 2^( 6) =       0.000556831388
  error estimate for blocks of size 2^( 7) =       0.000561011877

      target function =      -0.749066661792
              le_mean =     -22.814455644278
             les_mean =     520.944885263468
             stat err =       0.000551887290
             autocorr =       1.367363267880
   target nu stat err =       0.000551887290
   target dn stat err =       0.002551658501
      target stat err =       0.002255745723
              std dev =       0.667457220719
             le_variance =       0.445499141490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749066661792        initial  <--
     6.2500e+18     6.2500e+19             2.6223e-23        -0.749066661792
     2.5000e+19     2.5000e+20             5.6125e-24        -0.749066661792
     1.0000e+20     1.0000e+21             1.6389e-24        -0.749066661792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7532
  </log>
  <optVariables href="FORM2.s023.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1931e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8308
    reference variance = 0.346959
====================================================
  Execution time = 4.5191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4803e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452068481749
                                         uncertainty =       0.005514186435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452068481749
                                         uncertainty =       0.005514186435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475402768
  error estimate for blocks of size 2^( 2) =       0.000500515634
  error estimate for blocks of size 2^( 3) =       0.000524378033
  error estimate for blocks of size 2^( 4) =       0.000541616187
  error estimate for blocks of size 2^( 5) =       0.000552713569
  error estimate for blocks of size 2^( 6) =       0.000559071661
  error estimate for blocks of size 2^( 7) =       0.000559897276

      target function =      -0.743569833828
              le_mean =     -22.813375482187
             les_mean =     520.902116249602
             stat err =       0.000553324673
             autocorr =       1.354679814520
   target nu stat err =       0.000553324673
   target dn stat err =       0.005593487550
      target stat err =       0.004714958745
              std dev =       0.672321042639
             le_variance =       0.452015584376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281337548219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743598602314       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743598602314       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743598602314       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743598602314       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+21, overlap shift 1.0000e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743598602314       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743598602314       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.146091 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0000e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8263
    reference variance = 1.37416
====================================================
  Execution time = 4.2859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5364e-01
  Total weights = 2.0000e+06
  Execution time = 3.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476258119
  error estimate for blocks of size 2^( 2) =       0.000501665354
  error estimate for blocks of size 2^( 3) =       0.000525652371
  error estimate for blocks of size 2^( 4) =       0.000543741029
  error estimate for blocks of size 2^( 5) =       0.000556305666
  error estimate for blocks of size 2^( 6) =       0.000564132323
  error estimate for blocks of size 2^( 7) =       0.000572437135

      target function =      -0.742187655481
              le_mean =     -22.814991516144
             les_mean =     520.977481247564
             stat err =       0.000559154038
             autocorr =       1.378409145793
   target nu stat err =       0.000559154038
   target dn stat err =       0.004761594940
      target stat err =       0.004022973254
              std dev =       0.673530691696
             le_variance =       0.453643592657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476258119
  error estimate for blocks of size 2^( 2) =       0.000501665354
  error estimate for blocks of size 2^( 3) =       0.000525652371
  error estimate for blocks of size 2^( 4) =       0.000543741029
  error estimate for blocks of size 2^( 5) =       0.000556305666
  error estimate for blocks of size 2^( 6) =       0.000564132323
  error estimate for blocks of size 2^( 7) =       0.000572437135

      target function =      -0.742187655481
              le_mean =     -22.814991516144
             les_mean =     520.977481247564
             stat err =       0.000559154038
             autocorr =       1.378409145793
   target nu stat err =       0.000559154038
   target dn stat err =       0.004761594940
      target stat err =       0.004022973254
              std dev =       0.673530691696
             le_variance =       0.453643592657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476258119
  error estimate for blocks of size 2^( 2) =       0.000501665354
  error estimate for blocks of size 2^( 3) =       0.000525652371
  error estimate for blocks of size 2^( 4) =       0.000543741029
  error estimate for blocks of size 2^( 5) =       0.000556305666
  error estimate for blocks of size 2^( 6) =       0.000564132323
  error estimate for blocks of size 2^( 7) =       0.000572437135

      target function =      -0.742187655481
              le_mean =     -22.814991516144
             les_mean =     520.977481247564
             stat err =       0.000559154038
             autocorr =       1.378409145793
   target nu stat err =       0.000559154038
   target dn stat err =       0.004761594940
      target stat err =       0.004022973254
              std dev =       0.673530691696
             le_variance =       0.453643592657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453600795904
                                         uncertainty =       0.004688811217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476258119
  error estimate for blocks of size 2^( 2) =       0.000501665354
  error estimate for blocks of size 2^( 3) =       0.000525652371
  error estimate for blocks of size 2^( 4) =       0.000543741029
  error estimate for blocks of size 2^( 5) =       0.000556305666
  error estimate for blocks of size 2^( 6) =       0.000564132323
  error estimate for blocks of size 2^( 7) =       0.000572437135

      target function =      -0.742187655481
              le_mean =     -22.814991516144
             les_mean =     520.977481247564
             stat err =       0.000559154038
             autocorr =       1.378409145793
   target nu stat err =       0.000559154038
   target dn stat err =       0.004761594940
      target stat err =       0.004022973254
              std dev =       0.673530691696
             le_variance =       0.453643592657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742187655481        initial  <--
     6.2500e+19     6.2500e+20             0.0000e+00        -0.742187655481
     2.5000e+20     2.5000e+21             0.0000e+00        -0.742187655481
     1.0000e+21     1.0000e+22             0.0000e+00        -0.742187655481

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3206
  </log>
  <optVariables href="FORM2.s024.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2041e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7593
    reference variance = 0.498665
====================================================
  Execution time = 4.5606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5282e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4928e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452890291756
                                         uncertainty =       0.004646335125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452890291756
                                         uncertainty =       0.004646335125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475823855
  error estimate for blocks of size 2^( 2) =       0.000501237081
  error estimate for blocks of size 2^( 3) =       0.000525492169
  error estimate for blocks of size 2^( 4) =       0.000542680043
  error estimate for blocks of size 2^( 5) =       0.000554819368
  error estimate for blocks of size 2^( 6) =       0.000560459167
  error estimate for blocks of size 2^( 7) =       0.000562706466

      target function =      -0.742876348613
              le_mean =     -22.815061634427
             les_mean =     520.979853837358
             stat err =       0.000555166261
             autocorr =       1.361299574137
   target nu stat err =       0.000555166261
   target dn stat err =       0.004604398710
      target stat err =       0.003900288891
              std dev =       0.672916548380
             le_variance =       0.452816681083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281506163443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742895585594       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742895585594       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742895585594       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742895585594       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+22, overlap shift 1.0000e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742895585594       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742895585594       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.147187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0540e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7556
    reference variance = 0.329156
====================================================
  Execution time = 4.3238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5161e-01
  Total weights = 2.0000e+06
  Execution time = 3.4760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475187839
  error estimate for blocks of size 2^( 2) =       0.000500599036
  error estimate for blocks of size 2^( 3) =       0.000524845972
  error estimate for blocks of size 2^( 4) =       0.000543280530
  error estimate for blocks of size 2^( 5) =       0.000554240218
  error estimate for blocks of size 2^( 6) =       0.000561781139
  error estimate for blocks of size 2^( 7) =       0.000566248514

      target function =      -0.743894647519
              le_mean =     -22.814466351057
             les_mean =     520.951481621931
             stat err =       0.000556387600
             autocorr =       1.370958316737
   target nu stat err =       0.000556387600
   target dn stat err =       0.005254461331
      target stat err =       0.004445939354
              std dev =       0.672017086255
             le_variance =       0.451606964219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475187839
  error estimate for blocks of size 2^( 2) =       0.000500599036
  error estimate for blocks of size 2^( 3) =       0.000524845972
  error estimate for blocks of size 2^( 4) =       0.000543280530
  error estimate for blocks of size 2^( 5) =       0.000554240218
  error estimate for blocks of size 2^( 6) =       0.000561781139
  error estimate for blocks of size 2^( 7) =       0.000566248514

      target function =      -0.743894647519
              le_mean =     -22.814466351057
             les_mean =     520.951481621931
             stat err =       0.000556387600
             autocorr =       1.370958316737
   target nu stat err =       0.000556387600
   target dn stat err =       0.005254461331
      target stat err =       0.004445939354
              std dev =       0.672017086255
             le_variance =       0.451606964219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475187839
  error estimate for blocks of size 2^( 2) =       0.000500599036
  error estimate for blocks of size 2^( 3) =       0.000524845972
  error estimate for blocks of size 2^( 4) =       0.000543280530
  error estimate for blocks of size 2^( 5) =       0.000554240218
  error estimate for blocks of size 2^( 6) =       0.000561781139
  error estimate for blocks of size 2^( 7) =       0.000566248514

      target function =      -0.743894647519
              le_mean =     -22.814466351057
             les_mean =     520.951481621931
             stat err =       0.000556387600
             autocorr =       1.370958316737
   target nu stat err =       0.000556387600
   target dn stat err =       0.005254461331
      target stat err =       0.004445939354
              std dev =       0.672017086255
             le_variance =       0.451606964219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451562175468
                                         uncertainty =       0.005119460980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475187839
  error estimate for blocks of size 2^( 2) =       0.000500599036
  error estimate for blocks of size 2^( 3) =       0.000524845972
  error estimate for blocks of size 2^( 4) =       0.000543280530
  error estimate for blocks of size 2^( 5) =       0.000554240218
  error estimate for blocks of size 2^( 6) =       0.000561781139
  error estimate for blocks of size 2^( 7) =       0.000566248514

      target function =      -0.743894647519
              le_mean =     -22.814466351057
             les_mean =     520.951481621931
             stat err =       0.000556387600
             autocorr =       1.370958316737
   target nu stat err =       0.000556387600
   target dn stat err =       0.005254461331
      target stat err =       0.004445939354
              std dev =       0.672017086255
             le_variance =       0.451606964219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743894647519        initial  <--
     6.2500e+20     6.2500e+21             0.0000e+00        -0.743894647519
     2.5000e+21     2.5000e+22             0.0000e+00        -0.743894647519
     1.0000e+22     1.0000e+23             0.0000e+00        -0.743894647519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6452
  </log>
  <optVariables href="FORM2.s025.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8584
    reference variance = 0.415078
====================================================
  Execution time = 4.3783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4721e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4662e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447237996022
                                         uncertainty =       0.003804800273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447237996022
                                         uncertainty =       0.003804800273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472867499
  error estimate for blocks of size 2^( 2) =       0.000497993546
  error estimate for blocks of size 2^( 3) =       0.000522088051
  error estimate for blocks of size 2^( 4) =       0.000539264723
  error estimate for blocks of size 2^( 5) =       0.000551628036
  error estimate for blocks of size 2^( 6) =       0.000559179550
  error estimate for blocks of size 2^( 7) =       0.000562325804

      target function =      -0.747610191784
              le_mean =     -22.814652041991
             les_mean =     520.955554916213
             stat err =       0.000553099528
             autocorr =       1.368130882358
   target nu stat err =       0.000553099528
   target dn stat err =       0.003527594832
      target stat err =       0.003050328465
              std dev =       0.668735629899
             le_variance =       0.447207342697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465204199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747621615181       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747621615181       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747621615181       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747621615181       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+23, overlap shift 1.0000e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747621615181       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747621615181       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.148285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8452e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8259
    reference variance = 0.476997
====================================================
  Execution time = 4.5256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5120e-01
  Total weights = 2.0000e+06
  Execution time = 3.4849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474972251
  error estimate for blocks of size 2^( 2) =       0.000500423972
  error estimate for blocks of size 2^( 3) =       0.000524472112
  error estimate for blocks of size 2^( 4) =       0.000542626500
  error estimate for blocks of size 2^( 5) =       0.000553398025
  error estimate for blocks of size 2^( 6) =       0.000560756855
  error estimate for blocks of size 2^( 7) =       0.000565456364

      target function =      -0.744235344488
              le_mean =     -22.813995122755
             les_mean =     520.929570513908
             stat err =       0.000555559436
             autocorr =       1.368121227147
   target nu stat err =       0.000555559436
   target dn stat err =       0.006328429194
      target stat err =       0.005339131736
              std dev =       0.671712199112
             le_variance =       0.451197278436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474972251
  error estimate for blocks of size 2^( 2) =       0.000500423972
  error estimate for blocks of size 2^( 3) =       0.000524472112
  error estimate for blocks of size 2^( 4) =       0.000542626500
  error estimate for blocks of size 2^( 5) =       0.000553398025
  error estimate for blocks of size 2^( 6) =       0.000560756855
  error estimate for blocks of size 2^( 7) =       0.000565456364

      target function =      -0.744235344488
              le_mean =     -22.813995122755
             les_mean =     520.929570513908
             stat err =       0.000555559436
             autocorr =       1.368121227143
   target nu stat err =       0.000555559436
   target dn stat err =       0.006328429194
      target stat err =       0.005339131736
              std dev =       0.671712199112
             le_variance =       0.451197278436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474972251
  error estimate for blocks of size 2^( 2) =       0.000500423972
  error estimate for blocks of size 2^( 3) =       0.000524472112
  error estimate for blocks of size 2^( 4) =       0.000542626500
  error estimate for blocks of size 2^( 5) =       0.000553398025
  error estimate for blocks of size 2^( 6) =       0.000560756855
  error estimate for blocks of size 2^( 7) =       0.000565456364

      target function =      -0.744235344488
              le_mean =     -22.813995122755
             les_mean =     520.929570513908
             stat err =       0.000555559436
             autocorr =       1.368121227143
   target nu stat err =       0.000555559436
   target dn stat err =       0.006328429194
      target stat err =       0.005339131736
              std dev =       0.671712199112
             le_variance =       0.451197278436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451147633220
                                         uncertainty =       0.006112481075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474972251
  error estimate for blocks of size 2^( 2) =       0.000500423972
  error estimate for blocks of size 2^( 3) =       0.000524472112
  error estimate for blocks of size 2^( 4) =       0.000542626500
  error estimate for blocks of size 2^( 5) =       0.000553398025
  error estimate for blocks of size 2^( 6) =       0.000560756855
  error estimate for blocks of size 2^( 7) =       0.000565456364

      target function =      -0.744235344488
              le_mean =     -22.813995122755
             les_mean =     520.929570513908
             stat err =       0.000555559436
             autocorr =       1.368121227143
   target nu stat err =       0.000555559436
   target dn stat err =       0.006328429194
      target stat err =       0.005339131736
              std dev =       0.671712199112
             le_variance =       0.451197278436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744235344488        initial  <--
     6.2500e+21     6.2500e+22             0.0000e+00        -0.744235344488
     2.5000e+22     2.5000e+23             0.0000e+00        -0.744235344488
     1.0000e+23     1.0000e+24             0.0000e+00        -0.744235344488

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7090
  </log>
  <optVariables href="FORM2.s026.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2135e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.796
    reference variance = 0.447118
====================================================
  Execution time = 4.3687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4656e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4417e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446519693801
                                         uncertainty =       0.002848114344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446519693801
                                         uncertainty =       0.002848114344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472524989
  error estimate for blocks of size 2^( 2) =       0.000498350590
  error estimate for blocks of size 2^( 3) =       0.000521820536
  error estimate for blocks of size 2^( 4) =       0.000539392689
  error estimate for blocks of size 2^( 5) =       0.000550444217
  error estimate for blocks of size 2^( 6) =       0.000556103611
  error estimate for blocks of size 2^( 7) =       0.000558768331

      target function =      -0.748175107230
              le_mean =     -22.813497699026
             les_mean =     520.902236769757
             stat err =       0.000551177212
             autocorr =       1.360607771184
   target nu stat err =       0.000551177212
   target dn stat err =       0.003183625297
      target stat err =       0.002764815254
              std dev =       0.668251247327
             le_variance =       0.446559729555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281349769903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748184309407       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748184309407       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748184309407       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+22 is 1.025574e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748184309407       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748184309407       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748184309407       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+23 is 2.563936e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+24, overlap shift 1.0000e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748184309407       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748184309407       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748184309407       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+24 is 6.409840e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.149639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8114e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7421
    reference variance = 0.402896
====================================================
  Execution time = 4.4628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5844e-01
  Total weights = 2.0000e+06
  Execution time = 3.4837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478767360
  error estimate for blocks of size 2^( 2) =       0.000504118362
  error estimate for blocks of size 2^( 3) =       0.000527707262
  error estimate for blocks of size 2^( 4) =       0.000546155110
  error estimate for blocks of size 2^( 5) =       0.000557221435
  error estimate for blocks of size 2^( 6) =       0.000561232461
  error estimate for blocks of size 2^( 7) =       0.000561794587

      target function =      -0.738141745682
              le_mean =     -22.814776417189
             les_mean =     520.972459106235
             stat err =       0.000556600898
             autocorr =       1.351570603335
   target nu stat err =       0.000556600898
   target dn stat err =       0.010062110383
      target stat err =       0.008326926466
              std dev =       0.677079293085
             le_variance =       0.458436369125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478767360
  error estimate for blocks of size 2^( 2) =       0.000504118362
  error estimate for blocks of size 2^( 3) =       0.000527707262
  error estimate for blocks of size 2^( 4) =       0.000546155110
  error estimate for blocks of size 2^( 5) =       0.000557221435
  error estimate for blocks of size 2^( 6) =       0.000561232461
  error estimate for blocks of size 2^( 7) =       0.000561794587

      target function =      -0.738141745682
              le_mean =     -22.814776417189
             les_mean =     520.972459106235
             stat err =       0.000556600898
             autocorr =       1.351570603335
   target nu stat err =       0.000556600898
   target dn stat err =       0.010062110383
      target stat err =       0.008326926466
              std dev =       0.677079293085
             le_variance =       0.458436369125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478767360
  error estimate for blocks of size 2^( 2) =       0.000504118362
  error estimate for blocks of size 2^( 3) =       0.000527707262
  error estimate for blocks of size 2^( 4) =       0.000546155110
  error estimate for blocks of size 2^( 5) =       0.000557221435
  error estimate for blocks of size 2^( 6) =       0.000561232461
  error estimate for blocks of size 2^( 7) =       0.000561794587

      target function =      -0.738141745682
              le_mean =     -22.814776417189
             les_mean =     520.972459106235
             stat err =       0.000556600898
             autocorr =       1.351570603335
   target nu stat err =       0.000556600898
   target dn stat err =       0.010062110383
      target stat err =       0.008326926466
              std dev =       0.677079293085
             le_variance =       0.458436369125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458583704892
                                         uncertainty =       0.010170214075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478767360
  error estimate for blocks of size 2^( 2) =       0.000504118362
  error estimate for blocks of size 2^( 3) =       0.000527707262
  error estimate for blocks of size 2^( 4) =       0.000546155110
  error estimate for blocks of size 2^( 5) =       0.000557221435
  error estimate for blocks of size 2^( 6) =       0.000561232461
  error estimate for blocks of size 2^( 7) =       0.000561794587

      target function =      -0.738141745682
              le_mean =     -22.814776417189
             les_mean =     520.972459106235
             stat err =       0.000556600898
             autocorr =       1.351570603335
   target nu stat err =       0.000556600898
   target dn stat err =       0.010062110383
      target stat err =       0.008326926466
              std dev =       0.677079293085
             le_variance =       0.458436369125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738141745682        initial  <--
     6.2500e+22     6.2500e+23             1.0256e-27        -0.738141745682
     2.5000e+23     2.5000e+24             2.5639e-28        -0.738141745682
     1.0000e+24     1.0000e+25             6.4098e-29        -0.738141745682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0762
  </log>
  <optVariables href="FORM2.s027.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8842
    reference variance = 0.966981
====================================================
  Execution time = 4.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4937e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4548e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449406581689
                                         uncertainty =       0.004594493345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449406581689
                                         uncertainty =       0.004594493345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474010338
  error estimate for blocks of size 2^( 2) =       0.000499330979
  error estimate for blocks of size 2^( 3) =       0.000523151113
  error estimate for blocks of size 2^( 4) =       0.000541310000
  error estimate for blocks of size 2^( 5) =       0.000554278179
  error estimate for blocks of size 2^( 6) =       0.000563324469
  error estimate for blocks of size 2^( 7) =       0.000564486966

      target function =      -0.745790341694
              le_mean =     -22.813645552243
             les_mean =     520.911794758871
             stat err =       0.000555849904
             autocorr =       1.375116341749
   target nu stat err =       0.000555849904
   target dn stat err =       0.004672653871
      target stat err =       0.003978935888
              std dev =       0.670351848032
             le_variance =       0.449371600160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281364555224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745810512090       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745810512090       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745810512090       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745810512090       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+25, overlap shift 1.0000e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745810512090       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745810512090       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.150762 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8331e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8648
    reference variance = 0.29233
====================================================
  Execution time = 4.3274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4915e-01
  Total weights = 2.0000e+06
  Execution time = 3.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473896120
  error estimate for blocks of size 2^( 2) =       0.000499450947
  error estimate for blocks of size 2^( 3) =       0.000523613347
  error estimate for blocks of size 2^( 4) =       0.000541761003
  error estimate for blocks of size 2^( 5) =       0.000554129161
  error estimate for blocks of size 2^( 6) =       0.000560789128
  error estimate for blocks of size 2^( 7) =       0.000564334675

      target function =      -0.745960868044
              le_mean =     -22.815134305571
             les_mean =     520.979508222193
             stat err =       0.000555253492
             autocorr =       1.372828512456
   target nu stat err =       0.000555253492
   target dn stat err =       0.002948414238
      target stat err =       0.002564028367
              std dev =       0.670190320383
             le_variance =       0.449155065535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473896120
  error estimate for blocks of size 2^( 2) =       0.000499450947
  error estimate for blocks of size 2^( 3) =       0.000523613347
  error estimate for blocks of size 2^( 4) =       0.000541761003
  error estimate for blocks of size 2^( 5) =       0.000554129161
  error estimate for blocks of size 2^( 6) =       0.000560789128
  error estimate for blocks of size 2^( 7) =       0.000564334675

      target function =      -0.745960868044
              le_mean =     -22.815134305571
             les_mean =     520.979508222193
             stat err =       0.000555253492
             autocorr =       1.372828512456
   target nu stat err =       0.000555253492
   target dn stat err =       0.002948414238
      target stat err =       0.002564028367
              std dev =       0.670190320383
             le_variance =       0.449155065535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473896120
  error estimate for blocks of size 2^( 2) =       0.000499450947
  error estimate for blocks of size 2^( 3) =       0.000523613347
  error estimate for blocks of size 2^( 4) =       0.000541761003
  error estimate for blocks of size 2^( 5) =       0.000554129161
  error estimate for blocks of size 2^( 6) =       0.000560789128
  error estimate for blocks of size 2^( 7) =       0.000564334675

      target function =      -0.745960868044
              le_mean =     -22.815134305571
             les_mean =     520.979508222193
             stat err =       0.000555253492
             autocorr =       1.372828512456
   target nu stat err =       0.000555253492
   target dn stat err =       0.002948414238
      target stat err =       0.002564028367
              std dev =       0.670190320383
             le_variance =       0.449155065535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449216378011
                                         uncertainty =       0.002776037258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473896120
  error estimate for blocks of size 2^( 2) =       0.000499450947
  error estimate for blocks of size 2^( 3) =       0.000523613347
  error estimate for blocks of size 2^( 4) =       0.000541761003
  error estimate for blocks of size 2^( 5) =       0.000554129161
  error estimate for blocks of size 2^( 6) =       0.000560789128
  error estimate for blocks of size 2^( 7) =       0.000564334675

      target function =      -0.745960868044
              le_mean =     -22.815134305571
             les_mean =     520.979508222193
             stat err =       0.000555253492
             autocorr =       1.372828512456
   target nu stat err =       0.000555253492
   target dn stat err =       0.002948414238
      target stat err =       0.002564028367
              std dev =       0.670190320383
             le_variance =       0.449155065535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745960868044        initial  <--
     6.2500e+23     6.2500e+24             0.0000e+00        -0.745960868044
     2.5000e+24     2.5000e+25             0.0000e+00        -0.745960868044
     1.0000e+25     1.0000e+26             0.0000e+00        -0.745960868044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7424
  </log>
  <optVariables href="FORM2.s028.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1908e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7717
    reference variance = 0.399744
====================================================
  Execution time = 4.5119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4754e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441283140952
                                         uncertainty =       0.002513507972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441283140952
                                         uncertainty =       0.002513507972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469719522
  error estimate for blocks of size 2^( 2) =       0.000495537696
  error estimate for blocks of size 2^( 3) =       0.000519815801
  error estimate for blocks of size 2^( 4) =       0.000538040197
  error estimate for blocks of size 2^( 5) =       0.000550204566
  error estimate for blocks of size 2^( 6) =       0.000560136532
  error estimate for blocks of size 2^( 7) =       0.000563264058

      target function =      -0.752674395427
              le_mean =     -22.814364484166
             les_mean =     520.936499453553
             stat err =       0.000552911338
             autocorr =       1.385586911069
   target nu stat err =       0.000552911338
   target dn stat err =       0.002466496190
      target stat err =       0.002206618615
              std dev =       0.664283717856
             le_variance =       0.441272857808


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281436448417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752679803244       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752679803244       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752679803244       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752679803244       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+26, overlap shift 1.0000e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752679803244       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752679803244       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.151902 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9880e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7863
    reference variance = 0.363612
====================================================
  Execution time = 4.2993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4789e-01
  Total weights = 2.0000e+06
  Execution time = 3.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473230093
  error estimate for blocks of size 2^( 2) =       0.000498565495
  error estimate for blocks of size 2^( 3) =       0.000522741583
  error estimate for blocks of size 2^( 4) =       0.000540654414
  error estimate for blocks of size 2^( 5) =       0.000552798031
  error estimate for blocks of size 2^( 6) =       0.000559384636
  error estimate for blocks of size 2^( 7) =       0.000564022013

      target function =      -0.747037524244
              le_mean =     -22.814414383241
             les_mean =     520.945396868364
             stat err =       0.000554214774
             autocorr =       1.371549509286
   target nu stat err =       0.000554214774
   target dn stat err =       0.002860727871
      target stat err =       0.002496359817
              std dev =       0.669248415811
             le_variance =       0.447893442066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473230093
  error estimate for blocks of size 2^( 2) =       0.000498565495
  error estimate for blocks of size 2^( 3) =       0.000522741583
  error estimate for blocks of size 2^( 4) =       0.000540654414
  error estimate for blocks of size 2^( 5) =       0.000552798031
  error estimate for blocks of size 2^( 6) =       0.000559384636
  error estimate for blocks of size 2^( 7) =       0.000564022013

      target function =      -0.747037524244
              le_mean =     -22.814414383241
             les_mean =     520.945396868364
             stat err =       0.000554214774
             autocorr =       1.371549509286
   target nu stat err =       0.000554214774
   target dn stat err =       0.002860727871
      target stat err =       0.002496359817
              std dev =       0.669248415811
             le_variance =       0.447893442066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473230093
  error estimate for blocks of size 2^( 2) =       0.000498565495
  error estimate for blocks of size 2^( 3) =       0.000522741583
  error estimate for blocks of size 2^( 4) =       0.000540654414
  error estimate for blocks of size 2^( 5) =       0.000552798031
  error estimate for blocks of size 2^( 6) =       0.000559384636
  error estimate for blocks of size 2^( 7) =       0.000564022013

      target function =      -0.747037524244
              le_mean =     -22.814414383241
             les_mean =     520.945396868364
             stat err =       0.000554214774
             autocorr =       1.371549509286
   target nu stat err =       0.000554214774
   target dn stat err =       0.002860727871
      target stat err =       0.002496359817
              std dev =       0.669248415811
             le_variance =       0.447893442066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447964190660
                                         uncertainty =       0.002997133368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473230093
  error estimate for blocks of size 2^( 2) =       0.000498565495
  error estimate for blocks of size 2^( 3) =       0.000522741583
  error estimate for blocks of size 2^( 4) =       0.000540654414
  error estimate for blocks of size 2^( 5) =       0.000552798031
  error estimate for blocks of size 2^( 6) =       0.000559384636
  error estimate for blocks of size 2^( 7) =       0.000564022013

      target function =      -0.747037524244
              le_mean =     -22.814414383241
             les_mean =     520.945396868364
             stat err =       0.000554214774
             autocorr =       1.371549509286
   target nu stat err =       0.000554214774
   target dn stat err =       0.002860727871
      target stat err =       0.002496359817
              std dev =       0.669248415811
             le_variance =       0.447893442066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747037524244        initial  <--
     6.2500e+24     6.2500e+25             0.0000e+00        -0.747037524244
     2.5000e+25     2.5000e+26             0.0000e+00        -0.747037524244
     1.0000e+26     1.0000e+27             0.0000e+00        -0.747037524244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5679
  </log>
  <optVariables href="FORM2.s029.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2045e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7999
    reference variance = 0.638949
====================================================
  Execution time = 4.5363e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5222e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4687e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452130656412
                                         uncertainty =       0.003134503305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452130656412
                                         uncertainty =       0.003134503305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475511195
  error estimate for blocks of size 2^( 2) =       0.000500742393
  error estimate for blocks of size 2^( 3) =       0.000524097180
  error estimate for blocks of size 2^( 4) =       0.000542311544
  error estimate for blocks of size 2^( 5) =       0.000553234697
  error estimate for blocks of size 2^( 6) =       0.000559948242
  error estimate for blocks of size 2^( 7) =       0.000564993439

      target function =      -0.743377100219
              le_mean =     -22.815363837614
             les_mean =     520.993048609498
             stat err =       0.000555121980
             autocorr =       1.362872898979
   target nu stat err =       0.000555121980
   target dn stat err =       0.003300170906
      target stat err =       0.002834234179
              std dev =       0.672474380857
             le_variance =       0.452221792909


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281536383761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743386905961       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743386905961       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743386905961       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743386905961       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+27, overlap shift 1.0000e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743386905961       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743386905961       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.153072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0056e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8277
    reference variance = 0.579045
====================================================
  Execution time = 4.3495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4731e-01
  Total weights = 2.0000e+06
  Execution time = 3.4978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472921143
  error estimate for blocks of size 2^( 2) =       0.000498752627
  error estimate for blocks of size 2^( 3) =       0.000523161771
  error estimate for blocks of size 2^( 4) =       0.000540481938
  error estimate for blocks of size 2^( 5) =       0.000552375359
  error estimate for blocks of size 2^( 6) =       0.000561426638
  error estimate for blocks of size 2^( 7) =       0.000563123509

      target function =      -0.747523508780
              le_mean =     -22.814328064448
             les_mean =     520.940873622826
             stat err =       0.000554351861
             autocorr =       1.374021596467
   target nu stat err =       0.000554351861
   target dn stat err =       0.004215124263
      target stat err =       0.003619429093
              std dev =       0.668811493784
             le_variance =       0.447308814217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472921143
  error estimate for blocks of size 2^( 2) =       0.000498752627
  error estimate for blocks of size 2^( 3) =       0.000523161771
  error estimate for blocks of size 2^( 4) =       0.000540481938
  error estimate for blocks of size 2^( 5) =       0.000552375359
  error estimate for blocks of size 2^( 6) =       0.000561426638
  error estimate for blocks of size 2^( 7) =       0.000563123509

      target function =      -0.747523508780
              le_mean =     -22.814328064448
             les_mean =     520.940873622826
             stat err =       0.000554351861
             autocorr =       1.374021596467
   target nu stat err =       0.000554351861
   target dn stat err =       0.004215124263
      target stat err =       0.003619429093
              std dev =       0.668811493784
             le_variance =       0.447308814217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472921143
  error estimate for blocks of size 2^( 2) =       0.000498752627
  error estimate for blocks of size 2^( 3) =       0.000523161771
  error estimate for blocks of size 2^( 4) =       0.000540481938
  error estimate for blocks of size 2^( 5) =       0.000552375359
  error estimate for blocks of size 2^( 6) =       0.000561426638
  error estimate for blocks of size 2^( 7) =       0.000563123509

      target function =      -0.747523508780
              le_mean =     -22.814328064448
             les_mean =     520.940873622826
             stat err =       0.000554351861
             autocorr =       1.374021596467
   target nu stat err =       0.000554351861
   target dn stat err =       0.004215124263
      target stat err =       0.003619429093
              std dev =       0.668811493784
             le_variance =       0.447308814217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447326756631
                                         uncertainty =       0.004104731169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472921143
  error estimate for blocks of size 2^( 2) =       0.000498752627
  error estimate for blocks of size 2^( 3) =       0.000523161771
  error estimate for blocks of size 2^( 4) =       0.000540481938
  error estimate for blocks of size 2^( 5) =       0.000552375359
  error estimate for blocks of size 2^( 6) =       0.000561426638
  error estimate for blocks of size 2^( 7) =       0.000563123509

      target function =      -0.747523508780
              le_mean =     -22.814328064448
             les_mean =     520.940873622826
             stat err =       0.000554351861
             autocorr =       1.374021596467
   target nu stat err =       0.000554351861
   target dn stat err =       0.004215124263
      target stat err =       0.003619429093
              std dev =       0.668811493784
             le_variance =       0.447308814217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747523508780        initial  <--
     6.2500e+25     6.2500e+26             0.0000e+00        -0.747523508780
     2.5000e+26     2.5000e+27             0.0000e+00        -0.747523508780
     1.0000e+27     1.0000e+28             0.0000e+00        -0.747523508780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0349
  </log>
  <optVariables href="FORM2.s030.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2110e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7511
    reference variance = 0.485286
====================================================
  Execution time = 4.2953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6878e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4697e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468785982512
                                         uncertainty =       0.010205945622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468785982512
                                         uncertainty =       0.010205945622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484136471
  error estimate for blocks of size 2^( 2) =       0.000508797665
  error estimate for blocks of size 2^( 3) =       0.000532681271
  error estimate for blocks of size 2^( 4) =       0.000549609540
  error estimate for blocks of size 2^( 5) =       0.000560152811
  error estimate for blocks of size 2^( 6) =       0.000564396392
  error estimate for blocks of size 2^( 7) =       0.000569558075

      target function =      -0.729702725407
              le_mean =     -22.814711285076
             les_mean =     520.979827032478
             stat err =       0.000560929204
             autocorr =       1.342395547432
   target nu stat err =       0.000560929204
   target dn stat err =       0.010514862061
      target stat err =       0.008501859164
              std dev =       0.684672363595
             le_variance =       0.468776245470


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281471128508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729800419094       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729800419094       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729800419094       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729800419094       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729800419094       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+27 is 2.780661e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+28, overlap shift 1.0000e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729800419094       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729800419094       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729800419094       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+28 is 6.951654e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.154302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7656e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7707
    reference variance = 0.428726
====================================================
  Execution time = 4.5538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.0731e-01
  Total weights = 2.0000e+06
  Execution time = 3.4812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503641767
  error estimate for blocks of size 2^( 2) =       0.000527607836
  error estimate for blocks of size 2^( 3) =       0.000550355102
  error estimate for blocks of size 2^( 4) =       0.000566662928
  error estimate for blocks of size 2^( 5) =       0.000577690352
  error estimate for blocks of size 2^( 6) =       0.000581259287
  error estimate for blocks of size 2^( 7) =       0.000584073750

      target function =      -0.697740310291
              le_mean =     -22.813922996444
             les_mean =     520.982392292451
             stat err =       0.000577421579
             autocorr =       1.314445375998
   target nu stat err =       0.000577421579
   target dn stat err =       0.054310574071
      target stat err =       0.040127768703
              std dev =       0.712257017114
             le_variance =       0.507310058428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503641767
  error estimate for blocks of size 2^( 2) =       0.000527607836
  error estimate for blocks of size 2^( 3) =       0.000550355102
  error estimate for blocks of size 2^( 4) =       0.000566662928
  error estimate for blocks of size 2^( 5) =       0.000577690352
  error estimate for blocks of size 2^( 6) =       0.000581259287
  error estimate for blocks of size 2^( 7) =       0.000584073750

      target function =      -0.697740310291
              le_mean =     -22.813922996444
             les_mean =     520.982392292451
             stat err =       0.000577421579
             autocorr =       1.314445375998
   target nu stat err =       0.000577421579
   target dn stat err =       0.054310574071
      target stat err =       0.040127768703
              std dev =       0.712257017114
             le_variance =       0.507310058428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503641767
  error estimate for blocks of size 2^( 2) =       0.000527607836
  error estimate for blocks of size 2^( 3) =       0.000550355102
  error estimate for blocks of size 2^( 4) =       0.000566662928
  error estimate for blocks of size 2^( 5) =       0.000577690352
  error estimate for blocks of size 2^( 6) =       0.000581259287
  error estimate for blocks of size 2^( 7) =       0.000584073750

      target function =      -0.697740310291
              le_mean =     -22.813922996444
             les_mean =     520.982392292451
             stat err =       0.000577421579
             autocorr =       1.314445375998
   target nu stat err =       0.000577421579
   target dn stat err =       0.054310574071
      target stat err =       0.040127768703
              std dev =       0.712257017114
             le_variance =       0.507310058428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507436354680
                                         uncertainty =       0.057749110710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503641767
  error estimate for blocks of size 2^( 2) =       0.000527607836
  error estimate for blocks of size 2^( 3) =       0.000550355102
  error estimate for blocks of size 2^( 4) =       0.000566662928
  error estimate for blocks of size 2^( 5) =       0.000577690352
  error estimate for blocks of size 2^( 6) =       0.000581259287
  error estimate for blocks of size 2^( 7) =       0.000584073750

      target function =      -0.697740310291
              le_mean =     -22.813922996444
             les_mean =     520.982392292451
             stat err =       0.000577421579
             autocorr =       1.314445375998
   target nu stat err =       0.000577421579
   target dn stat err =       0.054310574071
      target stat err =       0.040127768703
              std dev =       0.712257017114
             le_variance =       0.507310058428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.697740310291        initial  <--
     6.2500e+26     6.2500e+27             0.0000e+00        -0.697740310291
     2.5000e+27     2.5000e+28             2.7807e-32        -0.697740310291
     1.0000e+28     1.0000e+29             6.9517e-33        -0.697740310291

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.9947
  </log>
  <optVariables href="FORM2.s031.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2067e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8968
    reference variance = 0.349042
====================================================
  Execution time = 4.4119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4865e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455668757465
                                         uncertainty =       0.005962009588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455668757465
                                         uncertainty =       0.005962009588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477420405
  error estimate for blocks of size 2^( 2) =       0.000502593164
  error estimate for blocks of size 2^( 3) =       0.000526011101
  error estimate for blocks of size 2^( 4) =       0.000544102955
  error estimate for blocks of size 2^( 5) =       0.000556053670
  error estimate for blocks of size 2^( 6) =       0.000564203332
  error estimate for blocks of size 2^( 7) =       0.000570578348

      target function =      -0.740341922680
              le_mean =     -22.814557281580
             les_mean =     520.959884213064
             stat err =       0.000558734576
             autocorr =       1.369648548313
   target nu stat err =       0.000558734576
   target dn stat err =       0.005699238141
      target stat err =       0.004770624690
              std dev =       0.675174411927
             le_variance =       0.455860486520


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281455728158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740371777202       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740371777202       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740371777202       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740371777202       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740371777210       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+28 is 4.016687e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+29, overlap shift 1.0000e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740371777202       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740371777202       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740371777210       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+29 is 1.004172e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.155600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8992e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7605
    reference variance = 0.444307
====================================================
  Execution time = 4.5657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4263e-01
  Total weights = 2.0000e+06
  Execution time = 3.4714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470440436
  error estimate for blocks of size 2^( 2) =       0.000495971295
  error estimate for blocks of size 2^( 3) =       0.000520244969
  error estimate for blocks of size 2^( 4) =       0.000537516426
  error estimate for blocks of size 2^( 5) =       0.000549297593
  error estimate for blocks of size 2^( 6) =       0.000556969970
  error estimate for blocks of size 2^( 7) =       0.000560299546

      target function =      -0.751514547287
              le_mean =     -22.814314553828
             les_mean =     520.935576747974
             stat err =       0.000551020884
             autocorr =       1.371913816238
   target nu stat err =       0.000551020884
   target dn stat err =       0.002421415674
      target stat err =       0.002162413820
              std dev =       0.665303245347
             le_variance =       0.442628408269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470440436
  error estimate for blocks of size 2^( 2) =       0.000495971295
  error estimate for blocks of size 2^( 3) =       0.000520244969
  error estimate for blocks of size 2^( 4) =       0.000537516426
  error estimate for blocks of size 2^( 5) =       0.000549297593
  error estimate for blocks of size 2^( 6) =       0.000556969970
  error estimate for blocks of size 2^( 7) =       0.000560299546

      target function =      -0.751514547287
              le_mean =     -22.814314553828
             les_mean =     520.935576747974
             stat err =       0.000551020884
             autocorr =       1.371913816243
   target nu stat err =       0.000551020884
   target dn stat err =       0.002421415674
      target stat err =       0.002162413820
              std dev =       0.665303245347
             le_variance =       0.442628408269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470440436
  error estimate for blocks of size 2^( 2) =       0.000495971295
  error estimate for blocks of size 2^( 3) =       0.000520244969
  error estimate for blocks of size 2^( 4) =       0.000537516426
  error estimate for blocks of size 2^( 5) =       0.000549297593
  error estimate for blocks of size 2^( 6) =       0.000556969970
  error estimate for blocks of size 2^( 7) =       0.000560299546

      target function =      -0.751514547287
              le_mean =     -22.814314553828
             les_mean =     520.935576747974
             stat err =       0.000551020884
             autocorr =       1.371913816243
   target nu stat err =       0.000551020884
   target dn stat err =       0.002421415674
      target stat err =       0.002162413820
              std dev =       0.665303245347
             le_variance =       0.442628408269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442668338386
                                         uncertainty =       0.002122546447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470440436
  error estimate for blocks of size 2^( 2) =       0.000495971295
  error estimate for blocks of size 2^( 3) =       0.000520244969
  error estimate for blocks of size 2^( 4) =       0.000537516426
  error estimate for blocks of size 2^( 5) =       0.000549297593
  error estimate for blocks of size 2^( 6) =       0.000556969970
  error estimate for blocks of size 2^( 7) =       0.000560299546

      target function =      -0.751514547287
              le_mean =     -22.814314553828
             les_mean =     520.935576747974
             stat err =       0.000551020884
             autocorr =       1.371913816243
   target nu stat err =       0.000551020884
   target dn stat err =       0.002421415674
      target stat err =       0.002162413820
              std dev =       0.665303245347
             le_variance =       0.442628408269


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751514547287        initial  <--
     6.2500e+27     6.2500e+28             0.0000e+00        -0.751514547287
     2.5000e+28     2.5000e+29             4.0167e-33        -0.751514547287
     1.0000e+29     1.0000e+30             1.0042e-33        -0.751514547287

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0391
  </log>
  <optVariables href="FORM2.s032.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2204e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8069
    reference variance = 0.674962
====================================================
  Execution time = 4.3107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5217e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447154850826
                                         uncertainty =       0.003915811820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447154850826
                                         uncertainty =       0.003915811820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472801070
  error estimate for blocks of size 2^( 2) =       0.000498135935
  error estimate for blocks of size 2^( 3) =       0.000521980400
  error estimate for blocks of size 2^( 4) =       0.000540465302
  error estimate for blocks of size 2^( 5) =       0.000552177518
  error estimate for blocks of size 2^( 6) =       0.000558813786
  error estimate for blocks of size 2^( 7) =       0.000562743029

      target function =      -0.747718231973
              le_mean =     -22.814415675603
             les_mean =     520.944644098900
             stat err =       0.000553549909
             autocorr =       1.370744986186
   target nu stat err =       0.000553549909
   target dn stat err =       0.003741840099
      target stat err =       0.003227862629
              std dev =       0.668641685235
             le_variance =       0.447081703234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281441567560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747731212341       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747731212341       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747731212341       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747731212341       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747731212527       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+29 is 3.270082e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+30, overlap shift 1.0000e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747731212341       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747731212341       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747731212527       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+30 is 8.175206e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.156888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8331e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8397
    reference variance = 0.382348
====================================================
  Execution time = 4.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5483e-01
  Total weights = 2.0000e+06
  Execution time = 3.4824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476882518
  error estimate for blocks of size 2^( 2) =       0.000502475863
  error estimate for blocks of size 2^( 3) =       0.000526196554
  error estimate for blocks of size 2^( 4) =       0.000544369183
  error estimate for blocks of size 2^( 5) =       0.000555237636
  error estimate for blocks of size 2^( 6) =       0.000558870536
  error estimate for blocks of size 2^( 7) =       0.000562264922

      target function =      -0.741225225850
              le_mean =     -22.813906411293
             les_mean =     520.929159388317
             stat err =       0.000555185569
             autocorr =       1.355356472047
   target nu stat err =       0.000555185569
   target dn stat err =       0.003994719213
      target stat err =       0.003377316654
              std dev =       0.674413725036
             le_variance =       0.454833872516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476882518
  error estimate for blocks of size 2^( 2) =       0.000502475863
  error estimate for blocks of size 2^( 3) =       0.000526196554
  error estimate for blocks of size 2^( 4) =       0.000544369183
  error estimate for blocks of size 2^( 5) =       0.000555237636
  error estimate for blocks of size 2^( 6) =       0.000558870536
  error estimate for blocks of size 2^( 7) =       0.000562264922

      target function =      -0.741225225850
              le_mean =     -22.813906411293
             les_mean =     520.929159388317
             stat err =       0.000555185569
             autocorr =       1.355356472047
   target nu stat err =       0.000555185569
   target dn stat err =       0.003994719213
      target stat err =       0.003377316654
              std dev =       0.674413725036
             le_variance =       0.454833872516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476882518
  error estimate for blocks of size 2^( 2) =       0.000502475863
  error estimate for blocks of size 2^( 3) =       0.000526196554
  error estimate for blocks of size 2^( 4) =       0.000544369183
  error estimate for blocks of size 2^( 5) =       0.000555237636
  error estimate for blocks of size 2^( 6) =       0.000558870536
  error estimate for blocks of size 2^( 7) =       0.000562264922

      target function =      -0.741225225850
              le_mean =     -22.813906411293
             les_mean =     520.929159388317
             stat err =       0.000555185569
             autocorr =       1.355356472047
   target nu stat err =       0.000555185569
   target dn stat err =       0.003994719213
      target stat err =       0.003377316654
              std dev =       0.674413725036
             le_variance =       0.454833872516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454824616843
                                         uncertainty =       0.004006884523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476882518
  error estimate for blocks of size 2^( 2) =       0.000502475863
  error estimate for blocks of size 2^( 3) =       0.000526196554
  error estimate for blocks of size 2^( 4) =       0.000544369183
  error estimate for blocks of size 2^( 5) =       0.000555237636
  error estimate for blocks of size 2^( 6) =       0.000558870536
  error estimate for blocks of size 2^( 7) =       0.000562264922

      target function =      -0.741225225850
              le_mean =     -22.813906411293
             les_mean =     520.929159388317
             stat err =       0.000555185569
             autocorr =       1.355356472047
   target nu stat err =       0.000555185569
   target dn stat err =       0.003994719213
      target stat err =       0.003377316654
              std dev =       0.674413725036
             le_variance =       0.454833872516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741225225850        initial  <--
     6.2500e+28     6.2500e+29             0.0000e+00        -0.741225225850
     2.5000e+29     2.5000e+30             3.2701e-34        -0.741225225850
     1.0000e+30     1.0000e+31             8.1752e-35        -0.741225225850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1683
  </log>
  <optVariables href="FORM2.s033.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1953e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8332
    reference variance = 0.273062
====================================================
  Execution time = 4.5220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4742e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443787350347
                                         uncertainty =       0.002277728716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443787350347
                                         uncertainty =       0.002277728716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471064640
  error estimate for blocks of size 2^( 2) =       0.000496957606
  error estimate for blocks of size 2^( 3) =       0.000521263111
  error estimate for blocks of size 2^( 4) =       0.000539413296
  error estimate for blocks of size 2^( 5) =       0.000550124321
  error estimate for blocks of size 2^( 6) =       0.000558238957
  error estimate for blocks of size 2^( 7) =       0.000562787838

      target function =      -0.750511443529
              le_mean =     -22.814219086336
             les_mean =     520.932396086956
             stat err =       0.000552641103
             autocorr =       1.376338804342
   target nu stat err =       0.000552641103
   target dn stat err =       0.002574589680
      target stat err =       0.002282332339
              std dev =       0.666186002198
             le_variance =       0.443803789525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421908634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750517301039       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750517301039       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750517301039       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750517301039       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+31, overlap shift 1.0000e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750517301039       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750517301039       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.157982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9968e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7823
    reference variance = 0.300112
====================================================
  Execution time = 4.2994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4961e-01
  Total weights = 2.0000e+06
  Execution time = 3.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474136356
  error estimate for blocks of size 2^( 2) =       0.000499990098
  error estimate for blocks of size 2^( 3) =       0.000524363669
  error estimate for blocks of size 2^( 4) =       0.000542147146
  error estimate for blocks of size 2^( 5) =       0.000554306448
  error estimate for blocks of size 2^( 6) =       0.000560514307
  error estimate for blocks of size 2^( 7) =       0.000563682674

      target function =      -0.745593211568
              le_mean =     -22.814021741514
             les_mean =     520.929198366451
             stat err =       0.000555162644
             autocorr =       1.370988949648
   target nu stat err =       0.000555162644
   target dn stat err =       0.003435526830
      target stat err =       0.002956110720
              std dev =       0.670530065698
             le_variance =       0.449610569006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474136356
  error estimate for blocks of size 2^( 2) =       0.000499990098
  error estimate for blocks of size 2^( 3) =       0.000524363669
  error estimate for blocks of size 2^( 4) =       0.000542147146
  error estimate for blocks of size 2^( 5) =       0.000554306448
  error estimate for blocks of size 2^( 6) =       0.000560514307
  error estimate for blocks of size 2^( 7) =       0.000563682674

      target function =      -0.745593211568
              le_mean =     -22.814021741514
             les_mean =     520.929198366451
             stat err =       0.000555162644
             autocorr =       1.370988949649
   target nu stat err =       0.000555162644
   target dn stat err =       0.003435526830
      target stat err =       0.002956110720
              std dev =       0.670530065698
             le_variance =       0.449610569006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474136356
  error estimate for blocks of size 2^( 2) =       0.000499990098
  error estimate for blocks of size 2^( 3) =       0.000524363669
  error estimate for blocks of size 2^( 4) =       0.000542147146
  error estimate for blocks of size 2^( 5) =       0.000554306448
  error estimate for blocks of size 2^( 6) =       0.000560514307
  error estimate for blocks of size 2^( 7) =       0.000563682674

      target function =      -0.745593211568
              le_mean =     -22.814021741514
             les_mean =     520.929198366451
             stat err =       0.000555162644
             autocorr =       1.370988949649
   target nu stat err =       0.000555162644
   target dn stat err =       0.003435526830
      target stat err =       0.002956110720
              std dev =       0.670530065698
             le_variance =       0.449610569006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449515359640
                                         uncertainty =       0.003877626264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474136356
  error estimate for blocks of size 2^( 2) =       0.000499990098
  error estimate for blocks of size 2^( 3) =       0.000524363669
  error estimate for blocks of size 2^( 4) =       0.000542147146
  error estimate for blocks of size 2^( 5) =       0.000554306448
  error estimate for blocks of size 2^( 6) =       0.000560514307
  error estimate for blocks of size 2^( 7) =       0.000563682674

      target function =      -0.745593211568
              le_mean =     -22.814021741514
             les_mean =     520.929198366451
             stat err =       0.000555162644
             autocorr =       1.370988949649
   target nu stat err =       0.000555162644
   target dn stat err =       0.003435526830
      target stat err =       0.002956110720
              std dev =       0.670530065698
             le_variance =       0.449610569006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745593211568        initial  <--
     6.2500e+29     6.2500e+30             0.0000e+00        -0.745593211568
     2.5000e+30     2.5000e+31             0.0000e+00        -0.745593211568
     1.0000e+31     1.0000e+32             0.0000e+00        -0.745593211568

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4737
  </log>
  <optVariables href="FORM2.s034.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2052e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8653
    reference variance = 0.354743
====================================================
  Execution time = 4.5747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4251e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4747e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442297603706
                                         uncertainty =       0.002302699306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442297603706
                                         uncertainty =       0.002302699306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470380035
  error estimate for blocks of size 2^( 2) =       0.000495568900
  error estimate for blocks of size 2^( 3) =       0.000519450272
  error estimate for blocks of size 2^( 4) =       0.000537844870
  error estimate for blocks of size 2^( 5) =       0.000549511435
  error estimate for blocks of size 2^( 6) =       0.000555465524
  error estimate for blocks of size 2^( 7) =       0.000560891259

      target function =      -0.751607724151
              le_mean =     -22.814893766414
             les_mean =     520.961892106252
             stat err =       0.000550928272
             autocorr =       1.371804929114
   target nu stat err =       0.000550928272
   target dn stat err =       0.002255965774
      target stat err =       0.002029708264
              std dev =       0.665217825032
             le_variance =       0.442514754741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281489376641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751612158787       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751612158787       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751612158787       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751612186432       residual = 1.55e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+30 is 2.351915e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751612158787       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751612158787       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751612158787       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751612158787       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751612186432       residual = 3.83e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       5.185619860688       residual = 2.94e+14           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+31 is 6.815838e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+32, overlap shift 1.0000e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751612158787       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751612158787       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751612158787       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751612158787       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751611541884       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+32 is 1.703959e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.159937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0501e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.9026
    reference variance = 0.502105
====================================================
  Execution time = 4.3059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4660e-01
  Total weights = 2.0000e+06
  Execution time = 3.5113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472544542
  error estimate for blocks of size 2^( 2) =       0.000498338569
  error estimate for blocks of size 2^( 3) =       0.000522153032
  error estimate for blocks of size 2^( 4) =       0.000539284992
  error estimate for blocks of size 2^( 5) =       0.000551213978
  error estimate for blocks of size 2^( 6) =       0.000559062942
  error estimate for blocks of size 2^( 7) =       0.000562982475

      target function =      -0.748119384638
              le_mean =     -22.815400927238
             les_mean =     520.989115935815
             stat err =       0.000553136097
             autocorr =       1.370182760224
   target nu stat err =       0.000553136097
   target dn stat err =       0.003109663699
      target stat err =       0.002711804234
              std dev =       0.668278900221
             le_variance =       0.446596688480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472544542
  error estimate for blocks of size 2^( 2) =       0.000498338569
  error estimate for blocks of size 2^( 3) =       0.000522153032
  error estimate for blocks of size 2^( 4) =       0.000539284992
  error estimate for blocks of size 2^( 5) =       0.000551213978
  error estimate for blocks of size 2^( 6) =       0.000559062942
  error estimate for blocks of size 2^( 7) =       0.000562982475

      target function =      -0.748119384638
              le_mean =     -22.815400927238
             les_mean =     520.989115935815
             stat err =       0.000553136097
             autocorr =       1.370182760224
   target nu stat err =       0.000553136097
   target dn stat err =       0.003109663699
      target stat err =       0.002711804234
              std dev =       0.668278900221
             le_variance =       0.446596688480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472544542
  error estimate for blocks of size 2^( 2) =       0.000498338569
  error estimate for blocks of size 2^( 3) =       0.000522153032
  error estimate for blocks of size 2^( 4) =       0.000539284992
  error estimate for blocks of size 2^( 5) =       0.000551213978
  error estimate for blocks of size 2^( 6) =       0.000559062942
  error estimate for blocks of size 2^( 7) =       0.000562982475

      target function =      -0.748119384638
              le_mean =     -22.815400927238
             les_mean =     520.989115935815
             stat err =       0.000553136097
             autocorr =       1.370182760224
   target nu stat err =       0.000553136097
   target dn stat err =       0.003109663699
      target stat err =       0.002711804234
              std dev =       0.668278900221
             le_variance =       0.446596688480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446644516453
                                         uncertainty =       0.003049718376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472544542
  error estimate for blocks of size 2^( 2) =       0.000498338569
  error estimate for blocks of size 2^( 3) =       0.000522153032
  error estimate for blocks of size 2^( 4) =       0.000539284992
  error estimate for blocks of size 2^( 5) =       0.000551213978
  error estimate for blocks of size 2^( 6) =       0.000559062942
  error estimate for blocks of size 2^( 7) =       0.000562982475

      target function =      -0.748119384638
              le_mean =     -22.815400927238
             les_mean =     520.989115935815
             stat err =       0.000553136097
             autocorr =       1.370182760224
   target nu stat err =       0.000553136097
   target dn stat err =       0.003109663699
      target stat err =       0.002711804234
              std dev =       0.668278900221
             le_variance =       0.446596688480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748119384638        initial  <--
     6.2500e+30     6.2500e+31             2.3519e-35        -0.748119384638
     2.5000e+31     2.5000e+32             6.8158e-36        -0.748119384638
     1.0000e+32     1.0000e+33             1.7040e-36        -0.748119384638

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6218
  </log>
  <optVariables href="FORM2.s035.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2113e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8089
    reference variance = 0.270647
====================================================
  Execution time = 4.3286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5001e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451500258375
                                         uncertainty =       0.003978774824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451500258375
                                         uncertainty =       0.003978774824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475141133
  error estimate for blocks of size 2^( 2) =       0.000500846726
  error estimate for blocks of size 2^( 3) =       0.000525306133
  error estimate for blocks of size 2^( 4) =       0.000544195661
  error estimate for blocks of size 2^( 5) =       0.000554979867
  error estimate for blocks of size 2^( 6) =       0.000560855686
  error estimate for blocks of size 2^( 7) =       0.000563667234

      target function =      -0.743975086079
              le_mean =     -22.814607447159
             les_mean =     520.957830934555
             stat err =       0.000555924612
             autocorr =       1.368946720995
   target nu stat err =       0.000555924612
   target dn stat err =       0.004292935799
      target stat err =       0.003651714496
              std dev =       0.671951034190
             le_variance =       0.451518192349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281460744716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743991898441       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743991898441       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743991898441       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743991898441       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+33, overlap shift 1.0000e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743991898441       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743991898441       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.161032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8294e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8188
    reference variance = 0.457203
====================================================
  Execution time = 4.4482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4695e-01
  Total weights = 2.0000e+06
  Execution time = 3.4831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472729088
  error estimate for blocks of size 2^( 2) =       0.000498157468
  error estimate for blocks of size 2^( 3) =       0.000521908896
  error estimate for blocks of size 2^( 4) =       0.000539613437
  error estimate for blocks of size 2^( 5) =       0.000551073297
  error estimate for blocks of size 2^( 6) =       0.000558087710
  error estimate for blocks of size 2^( 7) =       0.000561002775

      target function =      -0.747842058098
              le_mean =     -22.813943532230
             les_mean =     520.922964849596
             stat err =       0.000552444305
             autocorr =       1.365690690594
   target nu stat err =       0.000552444305
   target dn stat err =       0.003382934605
      target stat err =       0.002929090257
              std dev =       0.668539887578
             le_variance =       0.446945581283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472729088
  error estimate for blocks of size 2^( 2) =       0.000498157468
  error estimate for blocks of size 2^( 3) =       0.000521908896
  error estimate for blocks of size 2^( 4) =       0.000539613437
  error estimate for blocks of size 2^( 5) =       0.000551073297
  error estimate for blocks of size 2^( 6) =       0.000558087710
  error estimate for blocks of size 2^( 7) =       0.000561002775

      target function =      -0.747842058098
              le_mean =     -22.813943532230
             les_mean =     520.922964849596
             stat err =       0.000552444305
             autocorr =       1.365690690594
   target nu stat err =       0.000552444305
   target dn stat err =       0.003382934605
      target stat err =       0.002929090257
              std dev =       0.668539887578
             le_variance =       0.446945581283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472729088
  error estimate for blocks of size 2^( 2) =       0.000498157468
  error estimate for blocks of size 2^( 3) =       0.000521908896
  error estimate for blocks of size 2^( 4) =       0.000539613437
  error estimate for blocks of size 2^( 5) =       0.000551073297
  error estimate for blocks of size 2^( 6) =       0.000558087710
  error estimate for blocks of size 2^( 7) =       0.000561002775

      target function =      -0.747842058098
              le_mean =     -22.813943532230
             les_mean =     520.922964849596
             stat err =       0.000552444305
             autocorr =       1.365690690594
   target nu stat err =       0.000552444305
   target dn stat err =       0.003382934605
      target stat err =       0.002929090257
              std dev =       0.668539887578
             le_variance =       0.446945581283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446962360527
                                         uncertainty =       0.003361430396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472729088
  error estimate for blocks of size 2^( 2) =       0.000498157468
  error estimate for blocks of size 2^( 3) =       0.000521908896
  error estimate for blocks of size 2^( 4) =       0.000539613437
  error estimate for blocks of size 2^( 5) =       0.000551073297
  error estimate for blocks of size 2^( 6) =       0.000558087710
  error estimate for blocks of size 2^( 7) =       0.000561002775

      target function =      -0.747842058098
              le_mean =     -22.813943532230
             les_mean =     520.922964849596
             stat err =       0.000552444305
             autocorr =       1.365690690594
   target nu stat err =       0.000552444305
   target dn stat err =       0.003382934605
      target stat err =       0.002929090257
              std dev =       0.668539887578
             le_variance =       0.446945581283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747842058098        initial  <--
     6.2500e+31     6.2500e+32             0.0000e+00        -0.747842058098
     2.5000e+32     2.5000e+33             0.0000e+00        -0.747842058098
     1.0000e+33     1.0000e+34             0.0000e+00        -0.747842058098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9892
  </log>
  <optVariables href="FORM2.s036.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2029e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7852
    reference variance = 0.463483
====================================================
  Execution time = 4.3381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4741e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4847e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447271379312
                                         uncertainty =       0.002664484788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447271379312
                                         uncertainty =       0.002664484788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472976925
  error estimate for blocks of size 2^( 2) =       0.000498526252
  error estimate for blocks of size 2^( 3) =       0.000522641199
  error estimate for blocks of size 2^( 4) =       0.000540665012
  error estimate for blocks of size 2^( 5) =       0.000552615971
  error estimate for blocks of size 2^( 6) =       0.000559488581
  error estimate for blocks of size 2^( 7) =       0.000565201141

      target function =      -0.747433138118
              le_mean =     -22.815082358382
             les_mean =     520.975397138721
             stat err =       0.000554492676
             autocorr =       1.374395492674
   target nu stat err =       0.000554492676
   target dn stat err =       0.002788727940
      target stat err =       0.002442583570
              std dev =       0.668890381649
             le_variance =       0.447414342662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281508235838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747440121664       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747440121664       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747440121664       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747440121664       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+34, overlap shift 1.0000e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747440121664       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747440121664       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.162135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8234e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.9024
    reference variance = 0.643611
====================================================
  Execution time = 4.5021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5059e-01
  Total weights = 2.0000e+06
  Execution time = 3.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651600
  error estimate for blocks of size 2^( 2) =       0.000499784318
  error estimate for blocks of size 2^( 3) =       0.000523836120
  error estimate for blocks of size 2^( 4) =       0.000542016996
  error estimate for blocks of size 2^( 5) =       0.000553205088
  error estimate for blocks of size 2^( 6) =       0.000559324137
  error estimate for blocks of size 2^( 7) =       0.000562084453

      target function =      -0.744757359629
              le_mean =     -22.814821261347
             les_mean =     520.966657245031
             stat err =       0.000554157669
             autocorr =       1.363065721962
   target nu stat err =       0.000554157669
   target dn stat err =       0.003435544418
      target stat err =       0.002952981995
              std dev =       0.671258730375
             le_variance =       0.450588283104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651600
  error estimate for blocks of size 2^( 2) =       0.000499784318
  error estimate for blocks of size 2^( 3) =       0.000523836120
  error estimate for blocks of size 2^( 4) =       0.000542016996
  error estimate for blocks of size 2^( 5) =       0.000553205088
  error estimate for blocks of size 2^( 6) =       0.000559324137
  error estimate for blocks of size 2^( 7) =       0.000562084453

      target function =      -0.744757359629
              le_mean =     -22.814821261347
             les_mean =     520.966657245031
             stat err =       0.000554157669
             autocorr =       1.363065721962
   target nu stat err =       0.000554157669
   target dn stat err =       0.003435544418
      target stat err =       0.002952981995
              std dev =       0.671258730375
             le_variance =       0.450588283104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651600
  error estimate for blocks of size 2^( 2) =       0.000499784318
  error estimate for blocks of size 2^( 3) =       0.000523836120
  error estimate for blocks of size 2^( 4) =       0.000542016996
  error estimate for blocks of size 2^( 5) =       0.000553205088
  error estimate for blocks of size 2^( 6) =       0.000559324137
  error estimate for blocks of size 2^( 7) =       0.000562084453

      target function =      -0.744757359629
              le_mean =     -22.814821261347
             les_mean =     520.966657245031
             stat err =       0.000554157669
             autocorr =       1.363065721962
   target nu stat err =       0.000554157669
   target dn stat err =       0.003435544418
      target stat err =       0.002952981995
              std dev =       0.671258730375
             le_variance =       0.450588283104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450521025351
                                         uncertainty =       0.003543694181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651600
  error estimate for blocks of size 2^( 2) =       0.000499784318
  error estimate for blocks of size 2^( 3) =       0.000523836120
  error estimate for blocks of size 2^( 4) =       0.000542016996
  error estimate for blocks of size 2^( 5) =       0.000553205088
  error estimate for blocks of size 2^( 6) =       0.000559324137
  error estimate for blocks of size 2^( 7) =       0.000562084453

      target function =      -0.744757359629
              le_mean =     -22.814821261347
             les_mean =     520.966657245031
             stat err =       0.000554157669
             autocorr =       1.363065721962
   target nu stat err =       0.000554157669
   target dn stat err =       0.003435544418
      target stat err =       0.002952981995
              std dev =       0.671258730375
             le_variance =       0.450588283104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744757359629        initial  <--
     6.2500e+32     6.2500e+33             0.0000e+00        -0.744757359629
     2.5000e+33     2.5000e+34             0.0000e+00        -0.744757359629
     1.0000e+34     1.0000e+35             0.0000e+00        -0.744757359629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5177
  </log>
  <optVariables href="FORM2.s037.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2076e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7818
    reference variance = 0.276897
====================================================
  Execution time = 4.3558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5649e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4895e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456526508758
                                         uncertainty =       0.009747523613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456526508758
                                         uncertainty =       0.009747523613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477748198
  error estimate for blocks of size 2^( 2) =       0.000502820601
  error estimate for blocks of size 2^( 3) =       0.000526740549
  error estimate for blocks of size 2^( 4) =       0.000545037637
  error estimate for blocks of size 2^( 5) =       0.000557473419
  error estimate for blocks of size 2^( 6) =       0.000564765200
  error estimate for blocks of size 2^( 7) =       0.000571462931

      target function =      -0.739757222797
              le_mean =     -22.814839368675
             les_mean =     520.973381871981
             stat err =       0.000559684797
             autocorr =       1.372425897228
   target nu stat err =       0.000559684797
   target dn stat err =       0.009815753469
      target stat err =       0.008160693000
              std dev =       0.675637981319
             le_variance =       0.456486681800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281483936867e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739845282570       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739845282570       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+34, overlap shift 2.5000e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739845282570       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739845282570       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+35, overlap shift 1.0000e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739845282570       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739845282570       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.163223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8460e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7936
    reference variance = 0.267106
====================================================
  Execution time = 4.2975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.6269e-01
  Total weights = 2.0000e+06
  Execution time = 3.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480983441
  error estimate for blocks of size 2^( 2) =       0.000506198789
  error estimate for blocks of size 2^( 3) =       0.000530060970
  error estimate for blocks of size 2^( 4) =       0.000547329430
  error estimate for blocks of size 2^( 5) =       0.000557656131
  error estimate for blocks of size 2^( 6) =       0.000563676475
  error estimate for blocks of size 2^( 7) =       0.000566812024

      target function =      -0.734557693194
              le_mean =     -22.815672935073
             les_mean =     521.017621389414
             stat err =       0.000558868515
             autocorr =       1.350078550357
   target nu stat err =       0.000558868515
   target dn stat err =       0.012883695530
      target stat err =       0.010562670643
              std dev =       0.680213305191
             le_variance =       0.462690140559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480983441
  error estimate for blocks of size 2^( 2) =       0.000506198789
  error estimate for blocks of size 2^( 3) =       0.000530060970
  error estimate for blocks of size 2^( 4) =       0.000547329430
  error estimate for blocks of size 2^( 5) =       0.000557656131
  error estimate for blocks of size 2^( 6) =       0.000563676475
  error estimate for blocks of size 2^( 7) =       0.000566812024

      target function =      -0.734557693194
              le_mean =     -22.815672935073
             les_mean =     521.017621389414
             stat err =       0.000558868515
             autocorr =       1.350078550357
   target nu stat err =       0.000558868515
   target dn stat err =       0.012883695530
      target stat err =       0.010562670643
              std dev =       0.680213305191
             le_variance =       0.462690140559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480983441
  error estimate for blocks of size 2^( 2) =       0.000506198789
  error estimate for blocks of size 2^( 3) =       0.000530060970
  error estimate for blocks of size 2^( 4) =       0.000547329430
  error estimate for blocks of size 2^( 5) =       0.000557656131
  error estimate for blocks of size 2^( 6) =       0.000563676475
  error estimate for blocks of size 2^( 7) =       0.000566812024

      target function =      -0.734557693194
              le_mean =     -22.815672935073
             les_mean =     521.017621389414
             stat err =       0.000558868515
             autocorr =       1.350078550357
   target nu stat err =       0.000558868515
   target dn stat err =       0.012883695530
      target stat err =       0.010562670643
              std dev =       0.680213305191
             le_variance =       0.462690140559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462739674688
                                         uncertainty =       0.012517026657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480983441
  error estimate for blocks of size 2^( 2) =       0.000506198789
  error estimate for blocks of size 2^( 3) =       0.000530060970
  error estimate for blocks of size 2^( 4) =       0.000547329430
  error estimate for blocks of size 2^( 5) =       0.000557656131
  error estimate for blocks of size 2^( 6) =       0.000563676475
  error estimate for blocks of size 2^( 7) =       0.000566812024

      target function =      -0.734557693194
              le_mean =     -22.815672935073
             les_mean =     521.017621389414
             stat err =       0.000558868515
             autocorr =       1.350078550357
   target nu stat err =       0.000558868515
   target dn stat err =       0.012883695530
      target stat err =       0.010562670643
              std dev =       0.680213305191
             le_variance =       0.462690140559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.734557693194        initial  <--
     6.2500e+33     6.2500e+34             0.0000e+00        -0.734557693194
     2.5000e+34     2.5000e+35             0.0000e+00        -0.734557693194
     1.0000e+35     1.0000e+36             0.0000e+00        -0.734557693194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3929
  </log>
  <optVariables href="FORM2.s038.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1886e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7412
    reference variance = 0.362846
====================================================
  Execution time = 4.4730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5289e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451098424922
                                         uncertainty =       0.003841137637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451098424922
                                         uncertainty =       0.003841137637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474883583
  error estimate for blocks of size 2^( 2) =       0.000500437377
  error estimate for blocks of size 2^( 3) =       0.000524389900
  error estimate for blocks of size 2^( 4) =       0.000542694242
  error estimate for blocks of size 2^( 5) =       0.000555598820
  error estimate for blocks of size 2^( 6) =       0.000561743562
  error estimate for blocks of size 2^( 7) =       0.000563599665

      target function =      -0.744384462473
              le_mean =     -22.814950192970
             les_mean =     520.972980917508
             stat err =       0.000555909072
             autocorr =       1.370355384128
   target nu stat err =       0.000555909072
   target dn stat err =       0.003506029843
      target stat err =       0.003008929381
              std dev =       0.671586804007
             le_variance =       0.451028835317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281495019297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744395693053       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744395693053       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744395692833       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+34 is 1.246180e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+35, overlap shift 2.5000e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744395693053       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744395693053       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744395692833       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+35 is 3.115449e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+36, overlap shift 1.0000e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744395693053       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744395693053       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744395693764       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+36 is 7.788624e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.164603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0026e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8048
    reference variance = 0.326072
====================================================
  Execution time = 4.3348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4791e-01
  Total weights = 2.0000e+06
  Execution time = 3.4730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473239658
  error estimate for blocks of size 2^( 2) =       0.000498579100
  error estimate for blocks of size 2^( 3) =       0.000522515228
  error estimate for blocks of size 2^( 4) =       0.000541043424
  error estimate for blocks of size 2^( 5) =       0.000552573804
  error estimate for blocks of size 2^( 6) =       0.000559030020
  error estimate for blocks of size 2^( 7) =       0.000560949398

      target function =      -0.747029604976
              le_mean =     -22.813420953146
             les_mean =     520.900086909297
             stat err =       0.000553399162
             autocorr =       1.367460309805
   target nu stat err =       0.000553399162
   target dn stat err =       0.003852732308
      target stat err =       0.003308954603
              std dev =       0.669261942595
             le_variance =       0.447911547807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473239658
  error estimate for blocks of size 2^( 2) =       0.000498579100
  error estimate for blocks of size 2^( 3) =       0.000522515228
  error estimate for blocks of size 2^( 4) =       0.000541043424
  error estimate for blocks of size 2^( 5) =       0.000552573804
  error estimate for blocks of size 2^( 6) =       0.000559030020
  error estimate for blocks of size 2^( 7) =       0.000560949398

      target function =      -0.747029604976
              le_mean =     -22.813420953146
             les_mean =     520.900086909297
             stat err =       0.000553399162
             autocorr =       1.367460309805
   target nu stat err =       0.000553399162
   target dn stat err =       0.003852732308
      target stat err =       0.003308954603
              std dev =       0.669261942595
             le_variance =       0.447911547807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473239658
  error estimate for blocks of size 2^( 2) =       0.000498579100
  error estimate for blocks of size 2^( 3) =       0.000522515228
  error estimate for blocks of size 2^( 4) =       0.000541043424
  error estimate for blocks of size 2^( 5) =       0.000552573804
  error estimate for blocks of size 2^( 6) =       0.000559030020
  error estimate for blocks of size 2^( 7) =       0.000560949398

      target function =      -0.747029604976
              le_mean =     -22.813420953146
             les_mean =     520.900086909297
             stat err =       0.000553399162
             autocorr =       1.367460309805
   target nu stat err =       0.000553399162
   target dn stat err =       0.003852732308
      target stat err =       0.003308954603
              std dev =       0.669261942595
             le_variance =       0.447911547807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448000040849
                                         uncertainty =       0.003920932063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473239658
  error estimate for blocks of size 2^( 2) =       0.000498579100
  error estimate for blocks of size 2^( 3) =       0.000522515228
  error estimate for blocks of size 2^( 4) =       0.000541043424
  error estimate for blocks of size 2^( 5) =       0.000552573804
  error estimate for blocks of size 2^( 6) =       0.000559030020
  error estimate for blocks of size 2^( 7) =       0.000560949398

      target function =      -0.747029604976
              le_mean =     -22.813420953146
             les_mean =     520.900086909297
             stat err =       0.000553399162
             autocorr =       1.367460309805
   target nu stat err =       0.000553399162
   target dn stat err =       0.003852732308
      target stat err =       0.003308954603
              std dev =       0.669261942595
             le_variance =       0.447911547807


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747029604976        initial  <--
     6.2500e+34     6.2500e+35             1.2462e-39        -0.747029604976
     2.5000e+35     2.5000e+36             3.1154e-40        -0.747029604976
     1.0000e+36     1.0000e+37             7.7886e-41        -0.747029604976

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7482
  </log>
  <optVariables href="FORM2.s039.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2078e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8236
    reference variance = 0.349314
====================================================
  Execution time = 4.4823e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4797e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442731618740
                                         uncertainty =       0.002367488814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442731618740
                                         uncertainty =       0.002367488814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470552098
  error estimate for blocks of size 2^( 2) =       0.000495935391
  error estimate for blocks of size 2^( 3) =       0.000520148256
  error estimate for blocks of size 2^( 4) =       0.000538007521
  error estimate for blocks of size 2^( 5) =       0.000549382791
  error estimate for blocks of size 2^( 6) =       0.000555242653
  error estimate for blocks of size 2^( 7) =       0.000560103237

      target function =      -0.751335551253
              le_mean =     -22.814182855345
             les_mean =     520.929777689495
             stat err =       0.000550684051
             autocorr =       1.369586820831
   target nu stat err =       0.000550684051
   target dn stat err =       0.002526032044
      target stat err =       0.002246560348
              std dev =       0.665461158730
             le_variance =       0.442838553778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418285535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751341173417       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751341173417       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+36, overlap shift 2.5000e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751341173417       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751341173417       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+37, overlap shift 1.0000e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751341173417       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751341173417       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.165741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9627e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8249
    reference variance = 0.341259
====================================================
  Execution time = 4.3411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4364e-01
  Total weights = 2.0000e+06
  Execution time = 3.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470977797
  error estimate for blocks of size 2^( 2) =       0.000496759188
  error estimate for blocks of size 2^( 3) =       0.000521119260
  error estimate for blocks of size 2^( 4) =       0.000539081874
  error estimate for blocks of size 2^( 5) =       0.000549767027
  error estimate for blocks of size 2^( 6) =       0.000556797983
  error estimate for blocks of size 2^( 7) =       0.000561187407

      target function =      -0.750647332392
              le_mean =     -22.814583659850
             les_mean =     520.948867521081
             stat err =       0.000551708573
             autocorr =       1.372203733683
   target nu stat err =       0.000551708573
   target dn stat err =       0.002619267879
      target stat err =       0.002320771306
              std dev =       0.666063188163
             le_variance =       0.443640170625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470977797
  error estimate for blocks of size 2^( 2) =       0.000496759188
  error estimate for blocks of size 2^( 3) =       0.000521119260
  error estimate for blocks of size 2^( 4) =       0.000539081874
  error estimate for blocks of size 2^( 5) =       0.000549767027
  error estimate for blocks of size 2^( 6) =       0.000556797983
  error estimate for blocks of size 2^( 7) =       0.000561187407

      target function =      -0.750647332392
              le_mean =     -22.814583659850
             les_mean =     520.948867521081
             stat err =       0.000551708573
             autocorr =       1.372203733681
   target nu stat err =       0.000551708573
   target dn stat err =       0.002619267879
      target stat err =       0.002320771306
              std dev =       0.666063188163
             le_variance =       0.443640170625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470977797
  error estimate for blocks of size 2^( 2) =       0.000496759188
  error estimate for blocks of size 2^( 3) =       0.000521119260
  error estimate for blocks of size 2^( 4) =       0.000539081874
  error estimate for blocks of size 2^( 5) =       0.000549767027
  error estimate for blocks of size 2^( 6) =       0.000556797983
  error estimate for blocks of size 2^( 7) =       0.000561187407

      target function =      -0.750647332392
              le_mean =     -22.814583659850
             les_mean =     520.948867521081
             stat err =       0.000551708573
             autocorr =       1.372203733681
   target nu stat err =       0.000551708573
   target dn stat err =       0.002619267879
      target stat err =       0.002320771306
              std dev =       0.666063188163
             le_variance =       0.443640170625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443716341845
                                         uncertainty =       0.002576981668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470977797
  error estimate for blocks of size 2^( 2) =       0.000496759188
  error estimate for blocks of size 2^( 3) =       0.000521119260
  error estimate for blocks of size 2^( 4) =       0.000539081874
  error estimate for blocks of size 2^( 5) =       0.000549767027
  error estimate for blocks of size 2^( 6) =       0.000556797983
  error estimate for blocks of size 2^( 7) =       0.000561187407

      target function =      -0.750647332392
              le_mean =     -22.814583659850
             les_mean =     520.948867521081
             stat err =       0.000551708573
             autocorr =       1.372203733681
   target nu stat err =       0.000551708573
   target dn stat err =       0.002619267879
      target stat err =       0.002320771306
              std dev =       0.666063188163
             le_variance =       0.443640170625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750647332392        initial  <--
     6.2500e+35     6.2500e+36             0.0000e+00        -0.750647332392
     2.5000e+36     2.5000e+37             0.0000e+00        -0.750647332392
     1.0000e+37     1.0000e+38             0.0000e+00        -0.750647332392

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8838
  </log>
  <optVariables href="FORM2.s040.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8486
    reference variance = 0.436617
====================================================
  Execution time = 4.3534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5104e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448769305448
                                         uncertainty =       0.003398964814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448769305448
                                         uncertainty =       0.003398964814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473676161
  error estimate for blocks of size 2^( 2) =       0.000499192871
  error estimate for blocks of size 2^( 3) =       0.000522854678
  error estimate for blocks of size 2^( 4) =       0.000541593392
  error estimate for blocks of size 2^( 5) =       0.000553657552
  error estimate for blocks of size 2^( 6) =       0.000561395292
  error estimate for blocks of size 2^( 7) =       0.000564667606

      target function =      -0.746309355729
              le_mean =     -22.815121354359
             les_mean =     520.978500401205
             stat err =       0.000555328460
             autocorr =       1.374474876445
   target nu stat err =       0.000555328460
   target dn stat err =       0.003514965813
      target stat err =       0.003032198172
              std dev =       0.669879251383
             le_variance =       0.448738211433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281512135436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+36, overlap shift 6.2500e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746320558885       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746320558885       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746320558885       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+36 is 2.104566e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+37, overlap shift 2.5000e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746320558885       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746320558885       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746320558885       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+37 is 5.261415e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+38, overlap shift 1.0000e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746320558885       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746320558885       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746320558885       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+38 is 1.315354e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.167057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8645e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8324
    reference variance = 0.509325
====================================================
  Execution time = 4.4920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6699e-01
  Total weights = 2.0000e+06
  Execution time = 3.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483214893
  error estimate for blocks of size 2^( 2) =       0.000507947891
  error estimate for blocks of size 2^( 3) =       0.000531799366
  error estimate for blocks of size 2^( 4) =       0.000549012753
  error estimate for blocks of size 2^( 5) =       0.000557791890
  error estimate for blocks of size 2^( 6) =       0.000565883681
  error estimate for blocks of size 2^( 7) =       0.000570759677

      target function =      -0.730916410349
              le_mean =     -22.814873829926
             les_mean =     520.985460907071
             stat err =       0.000560862000
             autocorr =       1.347197942929
   target nu stat err =       0.000560862000
   target dn stat err =       0.018942481813
      target stat err =       0.015347135490
              std dev =       0.683369054845
             le_variance =       0.466993265120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483214893
  error estimate for blocks of size 2^( 2) =       0.000507947891
  error estimate for blocks of size 2^( 3) =       0.000531799366
  error estimate for blocks of size 2^( 4) =       0.000549012753
  error estimate for blocks of size 2^( 5) =       0.000557791890
  error estimate for blocks of size 2^( 6) =       0.000565883681
  error estimate for blocks of size 2^( 7) =       0.000570759677

      target function =      -0.730916410349
              le_mean =     -22.814873829926
             les_mean =     520.985460907071
             stat err =       0.000560862000
             autocorr =       1.347197942929
   target nu stat err =       0.000560862000
   target dn stat err =       0.018942481813
      target stat err =       0.015347135490
              std dev =       0.683369054845
             le_variance =       0.466993265120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483214893
  error estimate for blocks of size 2^( 2) =       0.000507947891
  error estimate for blocks of size 2^( 3) =       0.000531799366
  error estimate for blocks of size 2^( 4) =       0.000549012753
  error estimate for blocks of size 2^( 5) =       0.000557791890
  error estimate for blocks of size 2^( 6) =       0.000565883681
  error estimate for blocks of size 2^( 7) =       0.000570759677

      target function =      -0.730916410349
              le_mean =     -22.814873829926
             les_mean =     520.985460907071
             stat err =       0.000560862000
             autocorr =       1.347197942929
   target nu stat err =       0.000560862000
   target dn stat err =       0.018942481813
      target stat err =       0.015347135490
              std dev =       0.683369054845
             le_variance =       0.466993265120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466962531302
                                         uncertainty =       0.018465131689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483214893
  error estimate for blocks of size 2^( 2) =       0.000507947891
  error estimate for blocks of size 2^( 3) =       0.000531799366
  error estimate for blocks of size 2^( 4) =       0.000549012753
  error estimate for blocks of size 2^( 5) =       0.000557791890
  error estimate for blocks of size 2^( 6) =       0.000565883681
  error estimate for blocks of size 2^( 7) =       0.000570759677

      target function =      -0.730916410349
              le_mean =     -22.814873829926
             les_mean =     520.985460907071
             stat err =       0.000560862000
             autocorr =       1.347197942929
   target nu stat err =       0.000560862000
   target dn stat err =       0.018942481813
      target stat err =       0.015347135490
              std dev =       0.683369054845
             le_variance =       0.466993265120


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.730916410349        initial  <--
     6.2500e+36     6.2500e+37             2.1046e-41        -0.730916410349
     2.5000e+37     2.5000e+38             5.2614e-42        -0.730916410349
     1.0000e+38     1.0000e+39             1.3154e-42        -0.730916410349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4141
  </log>
  <optVariables href="FORM2.s041.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2107e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.9027
    reference variance = 0.3554
====================================================
  Execution time = 4.3456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5167e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4763e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451727232516
                                         uncertainty =       0.003170286233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451727232516
                                         uncertainty =       0.003170286233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475221776
  error estimate for blocks of size 2^( 2) =       0.000500842285
  error estimate for blocks of size 2^( 3) =       0.000524673481
  error estimate for blocks of size 2^( 4) =       0.000542793679
  error estimate for blocks of size 2^( 5) =       0.000556329951
  error estimate for blocks of size 2^( 6) =       0.000561441200
  error estimate for blocks of size 2^( 7) =       0.000565471157

      target function =      -0.743863838718
              le_mean =     -22.814091939516
             les_mean =     520.934462271684
             stat err =       0.000556508997
             autocorr =       1.371360744429
   target nu stat err =       0.000556508997
   target dn stat err =       0.003263799999
      target stat err =       0.002803054024
              std dev =       0.672065080806
             le_variance =       0.451671472839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281409193952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+37, overlap shift 6.2500e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743873320183       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743873320183       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+38, overlap shift 2.5000e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743873320183       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743873320183       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+39, overlap shift 1.0000e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743873320183       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743873320183       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.168173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8225e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.88
    reference variance = 0.40554
====================================================
  Execution time = 4.5518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4653e-01
  Total weights = 2.0000e+06
  Execution time = 3.4881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472509981
  error estimate for blocks of size 2^( 2) =       0.000497934291
  error estimate for blocks of size 2^( 3) =       0.000521891759
  error estimate for blocks of size 2^( 4) =       0.000539290499
  error estimate for blocks of size 2^( 5) =       0.000550428118
  error estimate for blocks of size 2^( 6) =       0.000556223542
  error estimate for blocks of size 2^( 7) =       0.000561300822

      target function =      -0.748182433884
              le_mean =     -22.814885932728
             les_mean =     520.965551264787
             stat err =       0.000551810745
             autocorr =       1.363824011818
   target nu stat err =       0.000551810745
   target dn stat err =       0.003045225937
      target stat err =       0.002656653947
              std dev =       0.668230023779
             le_variance =       0.446531364680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472509981
  error estimate for blocks of size 2^( 2) =       0.000497934291
  error estimate for blocks of size 2^( 3) =       0.000521891759
  error estimate for blocks of size 2^( 4) =       0.000539290499
  error estimate for blocks of size 2^( 5) =       0.000550428118
  error estimate for blocks of size 2^( 6) =       0.000556223542
  error estimate for blocks of size 2^( 7) =       0.000561300822

      target function =      -0.748182433884
              le_mean =     -22.814885932728
             les_mean =     520.965551264787
             stat err =       0.000551810745
             autocorr =       1.363824011818
   target nu stat err =       0.000551810745
   target dn stat err =       0.003045225937
      target stat err =       0.002656653947
              std dev =       0.668230023779
             le_variance =       0.446531364680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472509981
  error estimate for blocks of size 2^( 2) =       0.000497934291
  error estimate for blocks of size 2^( 3) =       0.000521891759
  error estimate for blocks of size 2^( 4) =       0.000539290499
  error estimate for blocks of size 2^( 5) =       0.000550428118
  error estimate for blocks of size 2^( 6) =       0.000556223542
  error estimate for blocks of size 2^( 7) =       0.000561300822

      target function =      -0.748182433884
              le_mean =     -22.814885932728
             les_mean =     520.965551264787
             stat err =       0.000551810745
             autocorr =       1.363824011818
   target nu stat err =       0.000551810745
   target dn stat err =       0.003045225937
      target stat err =       0.002656653947
              std dev =       0.668230023779
             le_variance =       0.446531364680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446229270466
                                         uncertainty =       0.002857894801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472509981
  error estimate for blocks of size 2^( 2) =       0.000497934291
  error estimate for blocks of size 2^( 3) =       0.000521891759
  error estimate for blocks of size 2^( 4) =       0.000539290499
  error estimate for blocks of size 2^( 5) =       0.000550428118
  error estimate for blocks of size 2^( 6) =       0.000556223542
  error estimate for blocks of size 2^( 7) =       0.000561300822

      target function =      -0.748182433884
              le_mean =     -22.814885932728
             les_mean =     520.965551264787
             stat err =       0.000551810745
             autocorr =       1.363824011818
   target nu stat err =       0.000551810745
   target dn stat err =       0.003045225937
      target stat err =       0.002656653947
              std dev =       0.668230023779
             le_variance =       0.446531364680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748182433884        initial  <--
     6.2500e+37     6.2500e+38             0.0000e+00        -0.748182433884
     2.5000e+38     2.5000e+39             0.0000e+00        -0.748182433884
     1.0000e+39     1.0000e+40             0.0000e+00        -0.748182433884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0169
  </log>
  <optVariables href="FORM2.s042.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2125e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8051
    reference variance = 0.310743
====================================================
  Execution time = 4.3334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4563e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464842475209
                                         uncertainty =       0.009467222669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464842475209
                                         uncertainty =       0.009467222669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482026737
  error estimate for blocks of size 2^( 2) =       0.000506900029
  error estimate for blocks of size 2^( 3) =       0.000530912823
  error estimate for blocks of size 2^( 4) =       0.000548369710
  error estimate for blocks of size 2^( 5) =       0.000559482563
  error estimate for blocks of size 2^( 6) =       0.000565653953
  error estimate for blocks of size 2^( 7) =       0.000570249932

      target function =      -0.733008698734
              le_mean =     -22.815017836996
             les_mean =     520.989738219845
             stat err =       0.000560939039
             autocorr =       1.354219542280
   target nu stat err =       0.000560939039
   target dn stat err =       0.009686052574
      target stat err =       0.007909886425
              std dev =       0.681688748425
             le_variance =       0.464699549729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501783700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+38, overlap shift 6.2500e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733092322025       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733092322025       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733092322946       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+38 is 1.266314e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+39, overlap shift 2.5000e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733092322025       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733092322025       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733092322025       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733092322025       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733092322024       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+39 is 8.286014e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+40, overlap shift 1.0000e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733092322025       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733092322025       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733092308044       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+40 is 7.914461e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.169740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7905e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6512
    reference variance = 0.34848
====================================================
  Execution time = 4.3154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4944e-01
  Total weights = 2.0000e+06
  Execution time = 3.4989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474045567
  error estimate for blocks of size 2^( 2) =       0.000498473081
  error estimate for blocks of size 2^( 3) =       0.000522284307
  error estimate for blocks of size 2^( 4) =       0.000540199790
  error estimate for blocks of size 2^( 5) =       0.000551080316
  error estimate for blocks of size 2^( 6) =       0.000557619752
  error estimate for blocks of size 2^( 7) =       0.000562682714

      target function =      -0.745729052670
              le_mean =     -22.814337134929
             les_mean =     520.943417081342
             stat err =       0.000552895643
             autocorr =       1.360335885584
   target nu stat err =       0.000552895643
   target dn stat err =       0.003932133238
      target stat err =       0.003367763303
              std dev =       0.670401670551
             le_variance =       0.449438399877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474045567
  error estimate for blocks of size 2^( 2) =       0.000498473081
  error estimate for blocks of size 2^( 3) =       0.000522284307
  error estimate for blocks of size 2^( 4) =       0.000540199790
  error estimate for blocks of size 2^( 5) =       0.000551080316
  error estimate for blocks of size 2^( 6) =       0.000557619752
  error estimate for blocks of size 2^( 7) =       0.000562682714

      target function =      -0.745729052670
              le_mean =     -22.814337134929
             les_mean =     520.943417081342
             stat err =       0.000552895643
             autocorr =       1.360335885584
   target nu stat err =       0.000552895643
   target dn stat err =       0.003932133238
      target stat err =       0.003367763303
              std dev =       0.670401670551
             le_variance =       0.449438399877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474045567
  error estimate for blocks of size 2^( 2) =       0.000498473081
  error estimate for blocks of size 2^( 3) =       0.000522284307
  error estimate for blocks of size 2^( 4) =       0.000540199790
  error estimate for blocks of size 2^( 5) =       0.000551080316
  error estimate for blocks of size 2^( 6) =       0.000557619752
  error estimate for blocks of size 2^( 7) =       0.000562682714

      target function =      -0.745729052670
              le_mean =     -22.814337134929
             les_mean =     520.943417081342
             stat err =       0.000552895643
             autocorr =       1.360335885584
   target nu stat err =       0.000552895643
   target dn stat err =       0.003932133238
      target stat err =       0.003367763303
              std dev =       0.670401670551
             le_variance =       0.449438399877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449426945929
                                         uncertainty =       0.004391198142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474045567
  error estimate for blocks of size 2^( 2) =       0.000498473081
  error estimate for blocks of size 2^( 3) =       0.000522284307
  error estimate for blocks of size 2^( 4) =       0.000540199790
  error estimate for blocks of size 2^( 5) =       0.000551080316
  error estimate for blocks of size 2^( 6) =       0.000557619752
  error estimate for blocks of size 2^( 7) =       0.000562682714

      target function =      -0.745729052670
              le_mean =     -22.814337134929
             les_mean =     520.943417081342
             stat err =       0.000552895643
             autocorr =       1.360335885584
   target nu stat err =       0.000552895643
   target dn stat err =       0.003932133238
      target stat err =       0.003367763303
              std dev =       0.670401670551
             le_variance =       0.449438399877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745729052670        initial  <--
     6.2500e+38     6.2500e+39             1.2663e-43        -0.745729052670
     2.5000e+39     2.5000e+40             8.2860e-44        -0.745729052670
     1.0000e+40     1.0000e+41             7.9145e-45        -0.745729052670

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9584
  </log>
  <optVariables href="FORM2.s043.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2187e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7872
    reference variance = 0.27001
====================================================
  Execution time = 4.3718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5283e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4688e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452889326304
                                         uncertainty =       0.004340907855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452889326304
                                         uncertainty =       0.004340907855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475830073
  error estimate for blocks of size 2^( 2) =       0.000500734202
  error estimate for blocks of size 2^( 3) =       0.000524300411
  error estimate for blocks of size 2^( 4) =       0.000542488904
  error estimate for blocks of size 2^( 5) =       0.000554065819
  error estimate for blocks of size 2^( 6) =       0.000559990188
  error estimate for blocks of size 2^( 7) =       0.000563421308

      target function =      -0.742885478415
              le_mean =     -22.814340013078
             les_mean =     520.946938523464
             stat err =       0.000554991555
             autocorr =       1.360407368449
   target nu stat err =       0.000554991555
   target dn stat err =       0.004106148793
      target stat err =       0.003485923449
              std dev =       0.672925343212
             le_variance =       0.452828517537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281434001308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+39, overlap shift 6.2500e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742900944844       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742900944844       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742900944844       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+39 is 1.040025e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+40, overlap shift 2.5000e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742900944844       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742900944844       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742919921875       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+40 is 2.600063e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+41, overlap shift 1.0000e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742900944844       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742900944844       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742900944844       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+41 is 6.500158e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.171085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8413e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7446
    reference variance = 0.348948
====================================================
  Execution time = 4.3517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4656e-01
  Total weights = 2.0000e+06
  Execution time = 3.4916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472527535
  error estimate for blocks of size 2^( 2) =       0.000497844878
  error estimate for blocks of size 2^( 3) =       0.000521482179
  error estimate for blocks of size 2^( 4) =       0.000538302248
  error estimate for blocks of size 2^( 5) =       0.000548364211
  error estimate for blocks of size 2^( 6) =       0.000554724365
  error estimate for blocks of size 2^( 7) =       0.000557156042

      target function =      -0.748164159268
              le_mean =     -22.814334289690
             les_mean =     520.940413401432
             stat err =       0.000549636717
             autocorr =       1.352998239059
   target nu stat err =       0.000549636717
   target dn stat err =       0.002612121697
      target stat err =       0.002298668253
              std dev =       0.668254848841
             le_variance =       0.446564542999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472527535
  error estimate for blocks of size 2^( 2) =       0.000497844878
  error estimate for blocks of size 2^( 3) =       0.000521482179
  error estimate for blocks of size 2^( 4) =       0.000538302248
  error estimate for blocks of size 2^( 5) =       0.000548364211
  error estimate for blocks of size 2^( 6) =       0.000554724365
  error estimate for blocks of size 2^( 7) =       0.000557156042

      target function =      -0.748164159268
              le_mean =     -22.814334289690
             les_mean =     520.940413401432
             stat err =       0.000549636717
             autocorr =       1.352998239059
   target nu stat err =       0.000549636717
   target dn stat err =       0.002612121697
      target stat err =       0.002298668253
              std dev =       0.668254848841
             le_variance =       0.446564542999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472527535
  error estimate for blocks of size 2^( 2) =       0.000497844878
  error estimate for blocks of size 2^( 3) =       0.000521482179
  error estimate for blocks of size 2^( 4) =       0.000538302248
  error estimate for blocks of size 2^( 5) =       0.000548364211
  error estimate for blocks of size 2^( 6) =       0.000554724365
  error estimate for blocks of size 2^( 7) =       0.000557156042

      target function =      -0.748164159268
              le_mean =     -22.814334289690
             les_mean =     520.940413401432
             stat err =       0.000549636717
             autocorr =       1.352998239059
   target nu stat err =       0.000549636717
   target dn stat err =       0.002612121697
      target stat err =       0.002298668253
              std dev =       0.668254848841
             le_variance =       0.446564542999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446573697703
                                         uncertainty =       0.002716953852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472527535
  error estimate for blocks of size 2^( 2) =       0.000497844878
  error estimate for blocks of size 2^( 3) =       0.000521482179
  error estimate for blocks of size 2^( 4) =       0.000538302248
  error estimate for blocks of size 2^( 5) =       0.000548364211
  error estimate for blocks of size 2^( 6) =       0.000554724365
  error estimate for blocks of size 2^( 7) =       0.000557156042

      target function =      -0.748164159268
              le_mean =     -22.814334289690
             les_mean =     520.940413401432
             stat err =       0.000549636717
             autocorr =       1.352998239059
   target nu stat err =       0.000549636717
   target dn stat err =       0.002612121697
      target stat err =       0.002298668253
              std dev =       0.668254848841
             le_variance =       0.446564542999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748164159268        initial  <--
     6.2500e+39     6.2500e+40             1.0400e-44        -0.748164159268
     2.5000e+40     2.5000e+41             2.6001e-45        -0.748164159268
     1.0000e+41     1.0000e+42             6.5002e-46        -0.748164159268

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0190
  </log>
  <optVariables href="FORM2.s044.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1944e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8507
    reference variance = 0.529173
====================================================
  Execution time = 4.5557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4774e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449292918521
                                         uncertainty =       0.003388016127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449292918521
                                         uncertainty =       0.003388016127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474024137
  error estimate for blocks of size 2^( 2) =       0.000499705205
  error estimate for blocks of size 2^( 3) =       0.000524565132
  error estimate for blocks of size 2^( 4) =       0.000542805313
  error estimate for blocks of size 2^( 5) =       0.000554069702
  error estimate for blocks of size 2^( 6) =       0.000561351327
  error estimate for blocks of size 2^( 7) =       0.000563323492

      target function =      -0.745774494426
              le_mean =     -22.813751175495
             les_mean =     520.916640237221
             stat err =       0.000555387458
             autocorr =       1.372749280420
   target nu stat err =       0.000555387458
   target dn stat err =       0.003707356394
      target stat err =       0.003180155089
              std dev =       0.670371363150
             le_variance =       0.449397764532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281375117549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+40, overlap shift 6.2500e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786905384       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786905384       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+41, overlap shift 2.5000e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786905384       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786905384       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+42, overlap shift 1.0000e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786905384       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786905384       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.172199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0338e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8894
    reference variance = 0.427945
====================================================
  Execution time = 4.3147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4572e-01
  Total weights = 2.0000e+06
  Execution time = 3.4714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472078487
  error estimate for blocks of size 2^( 2) =       0.000497635458
  error estimate for blocks of size 2^( 3) =       0.000521886918
  error estimate for blocks of size 2^( 4) =       0.000539478110
  error estimate for blocks of size 2^( 5) =       0.000550465836
  error estimate for blocks of size 2^( 6) =       0.000555291371
  error estimate for blocks of size 2^( 7) =       0.000555991618

      target function =      -0.748874009125
              le_mean =     -22.815048934720
             les_mean =     520.972173866624
             stat err =       0.000550306734
             autocorr =       1.358880400230
   target nu stat err =       0.000550306734
   target dn stat err =       0.002736399990
      target stat err =       0.002407392182
              std dev =       0.667619798832
             le_variance =       0.445716195793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472078487
  error estimate for blocks of size 2^( 2) =       0.000497635458
  error estimate for blocks of size 2^( 3) =       0.000521886918
  error estimate for blocks of size 2^( 4) =       0.000539478110
  error estimate for blocks of size 2^( 5) =       0.000550465836
  error estimate for blocks of size 2^( 6) =       0.000555291371
  error estimate for blocks of size 2^( 7) =       0.000555991618

      target function =      -0.748874009125
              le_mean =     -22.815048934720
             les_mean =     520.972173866624
             stat err =       0.000550306734
             autocorr =       1.358880400230
   target nu stat err =       0.000550306734
   target dn stat err =       0.002736399990
      target stat err =       0.002407392182
              std dev =       0.667619798832
             le_variance =       0.445716195793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472078487
  error estimate for blocks of size 2^( 2) =       0.000497635458
  error estimate for blocks of size 2^( 3) =       0.000521886918
  error estimate for blocks of size 2^( 4) =       0.000539478110
  error estimate for blocks of size 2^( 5) =       0.000550465836
  error estimate for blocks of size 2^( 6) =       0.000555291371
  error estimate for blocks of size 2^( 7) =       0.000555991618

      target function =      -0.748874009125
              le_mean =     -22.815048934720
             les_mean =     520.972173866624
             stat err =       0.000550306734
             autocorr =       1.358880400230
   target nu stat err =       0.000550306734
   target dn stat err =       0.002736399990
      target stat err =       0.002407392182
              std dev =       0.667619798832
             le_variance =       0.445716195793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445746956735
                                         uncertainty =       0.002935718202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472078487
  error estimate for blocks of size 2^( 2) =       0.000497635458
  error estimate for blocks of size 2^( 3) =       0.000521886918
  error estimate for blocks of size 2^( 4) =       0.000539478110
  error estimate for blocks of size 2^( 5) =       0.000550465836
  error estimate for blocks of size 2^( 6) =       0.000555291371
  error estimate for blocks of size 2^( 7) =       0.000555991618

      target function =      -0.748874009125
              le_mean =     -22.815048934720
             les_mean =     520.972173866624
             stat err =       0.000550306734
             autocorr =       1.358880400230
   target nu stat err =       0.000550306734
   target dn stat err =       0.002736399990
      target stat err =       0.002407392182
              std dev =       0.667619798832
             le_variance =       0.445716195793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748874009125        initial  <--
     6.2500e+40     6.2500e+41             0.0000e+00        -0.748874009125
     2.5000e+41     2.5000e+42             0.0000e+00        -0.748874009125
     1.0000e+42     1.0000e+43             0.0000e+00        -0.748874009125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5538
  </log>
  <optVariables href="FORM2.s045.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2090e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8783
    reference variance = 0.255564
====================================================
  Execution time = 4.3349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5457e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5081e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454641453535
                                         uncertainty =       0.005097465298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454641453535
                                         uncertainty =       0.005097465298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476746217
  error estimate for blocks of size 2^( 2) =       0.000502530704
  error estimate for blocks of size 2^( 3) =       0.000526791374
  error estimate for blocks of size 2^( 4) =       0.000545237377
  error estimate for blocks of size 2^( 5) =       0.000555373395
  error estimate for blocks of size 2^( 6) =       0.000561390612
  error estimate for blocks of size 2^( 7) =       0.000566716397

      target function =      -0.741408842829
              le_mean =     -22.814938036181
             les_mean =     520.975971278454
             stat err =       0.000557179445
             autocorr =       1.365889799140
   target nu stat err =       0.000557179445
   target dn stat err =       0.005045798094
      target stat err =       0.004247909090
              std dev =       0.674220965982
             le_variance =       0.454573910970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281493803618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+41, overlap shift 6.2500e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741432101170       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741432101170       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+42, overlap shift 2.5000e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741432101170       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741432101170       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+43, overlap shift 1.0000e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741432101170       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741432101170       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.173332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9589e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8256
    reference variance = 0.387766
====================================================
  Execution time = 4.3208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4367e-01
  Total weights = 2.0000e+06
  Execution time = 3.4725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470995970
  error estimate for blocks of size 2^( 2) =       0.000496328757
  error estimate for blocks of size 2^( 3) =       0.000520053408
  error estimate for blocks of size 2^( 4) =       0.000538101142
  error estimate for blocks of size 2^( 5) =       0.000550836187
  error estimate for blocks of size 2^( 6) =       0.000558519576
  error estimate for blocks of size 2^( 7) =       0.000561949191

      target function =      -0.750614555559
              le_mean =     -22.814963829088
             les_mean =     520.966248708191
             stat err =       0.000552351524
             autocorr =       1.375297744829
   target nu stat err =       0.000552351524
   target dn stat err =       0.002574040759
      target stat err =       0.002284970523
              std dev =       0.666088888528
             le_variance =       0.443674407420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470995970
  error estimate for blocks of size 2^( 2) =       0.000496328757
  error estimate for blocks of size 2^( 3) =       0.000520053408
  error estimate for blocks of size 2^( 4) =       0.000538101142
  error estimate for blocks of size 2^( 5) =       0.000550836187
  error estimate for blocks of size 2^( 6) =       0.000558519576
  error estimate for blocks of size 2^( 7) =       0.000561949191

      target function =      -0.750614555559
              le_mean =     -22.814963829088
             les_mean =     520.966248708191
             stat err =       0.000552351524
             autocorr =       1.375297744829
   target nu stat err =       0.000552351524
   target dn stat err =       0.002574040759
      target stat err =       0.002284970523
              std dev =       0.666088888528
             le_variance =       0.443674407420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470995970
  error estimate for blocks of size 2^( 2) =       0.000496328757
  error estimate for blocks of size 2^( 3) =       0.000520053408
  error estimate for blocks of size 2^( 4) =       0.000538101142
  error estimate for blocks of size 2^( 5) =       0.000550836187
  error estimate for blocks of size 2^( 6) =       0.000558519576
  error estimate for blocks of size 2^( 7) =       0.000561949191

      target function =      -0.750614555559
              le_mean =     -22.814963829088
             les_mean =     520.966248708191
             stat err =       0.000552351524
             autocorr =       1.375297744829
   target nu stat err =       0.000552351524
   target dn stat err =       0.002574040759
      target stat err =       0.002284970523
              std dev =       0.666088888528
             le_variance =       0.443674407420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443399458956
                                         uncertainty =       0.002463013548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470995970
  error estimate for blocks of size 2^( 2) =       0.000496328757
  error estimate for blocks of size 2^( 3) =       0.000520053408
  error estimate for blocks of size 2^( 4) =       0.000538101142
  error estimate for blocks of size 2^( 5) =       0.000550836187
  error estimate for blocks of size 2^( 6) =       0.000558519576
  error estimate for blocks of size 2^( 7) =       0.000561949191

      target function =      -0.750614555559
              le_mean =     -22.814963829088
             les_mean =     520.966248708191
             stat err =       0.000552351524
             autocorr =       1.375297744829
   target nu stat err =       0.000552351524
   target dn stat err =       0.002574040759
      target stat err =       0.002284970523
              std dev =       0.666088888528
             le_variance =       0.443674407420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750614555559        initial  <--
     6.2500e+41     6.2500e+42             0.0000e+00        -0.750614555559
     2.5000e+42     2.5000e+43             0.0000e+00        -0.750614555559
     1.0000e+43     1.0000e+44             0.0000e+00        -0.750614555559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6438
  </log>
  <optVariables href="FORM2.s046.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2024e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.752
    reference variance = 0.64494
====================================================
  Execution time = 4.3981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5019e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4732e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450116902956
                                         uncertainty =       0.003716498941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450116902956
                                         uncertainty =       0.003716498941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474440433
  error estimate for blocks of size 2^( 2) =       0.000499637632
  error estimate for blocks of size 2^( 3) =       0.000523367232
  error estimate for blocks of size 2^( 4) =       0.000540758070
  error estimate for blocks of size 2^( 5) =       0.000551529827
  error estimate for blocks of size 2^( 6) =       0.000558785584
  error estimate for blocks of size 2^( 7) =       0.000560409073

      target function =      -0.745096922106
              le_mean =     -22.814467055690
             les_mean =     520.950094259791
             stat err =       0.000552870639
             autocorr =       1.357949641858
   target nu stat err =       0.000552870639
   target dn stat err =       0.003945049633
      target stat err =       0.003373477108
              std dev =       0.670960095463
             le_variance =       0.450187449703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281446705569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+42, overlap shift 6.2500e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745111278237       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745111278237       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+43, overlap shift 2.5000e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745111278237       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745111278237       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746093750000       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.05e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.12e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 6.01e+12           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+43 is 2.215646e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+44, overlap shift 1.0000e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745111278237       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745111278237       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.174862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8721e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8524
    reference variance = 0.48895
====================================================
  Execution time = 4.5106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5336e-01
  Total weights = 2.0000e+06
  Execution time = 3.4764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476110728
  error estimate for blocks of size 2^( 2) =       0.000501474178
  error estimate for blocks of size 2^( 3) =       0.000525354953
  error estimate for blocks of size 2^( 4) =       0.000543431199
  error estimate for blocks of size 2^( 5) =       0.000555670942
  error estimate for blocks of size 2^( 6) =       0.000560494607
  error estimate for blocks of size 2^( 7) =       0.000564167074

      target function =      -0.742415143799
              le_mean =     -22.814489306921
             les_mean =     520.954284959284
             stat err =       0.000555940955
             autocorr =       1.363456866478
   target nu stat err =       0.000555940955
   target dn stat err =       0.006323349364
      target stat err =       0.005313040756
              std dev =       0.673322248531
             le_variance =       0.453362850367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476110728
  error estimate for blocks of size 2^( 2) =       0.000501474178
  error estimate for blocks of size 2^( 3) =       0.000525354953
  error estimate for blocks of size 2^( 4) =       0.000543431199
  error estimate for blocks of size 2^( 5) =       0.000555670942
  error estimate for blocks of size 2^( 6) =       0.000560494607
  error estimate for blocks of size 2^( 7) =       0.000564167074

      target function =      -0.742415143799
              le_mean =     -22.814489306921
             les_mean =     520.954284959284
             stat err =       0.000555940955
             autocorr =       1.363456866478
   target nu stat err =       0.000555940955
   target dn stat err =       0.006323349364
      target stat err =       0.005313040756
              std dev =       0.673322248531
             le_variance =       0.453362850367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476110728
  error estimate for blocks of size 2^( 2) =       0.000501474178
  error estimate for blocks of size 2^( 3) =       0.000525354953
  error estimate for blocks of size 2^( 4) =       0.000543431199
  error estimate for blocks of size 2^( 5) =       0.000555670942
  error estimate for blocks of size 2^( 6) =       0.000560494607
  error estimate for blocks of size 2^( 7) =       0.000564167074

      target function =      -0.742415143799
              le_mean =     -22.814489306921
             les_mean =     520.954284959284
             stat err =       0.000555940955
             autocorr =       1.363456866478
   target nu stat err =       0.000555940955
   target dn stat err =       0.006323349364
      target stat err =       0.005313040756
              std dev =       0.673322248531
             le_variance =       0.453362850367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453401559614
                                         uncertainty =       0.006225421799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476110728
  error estimate for blocks of size 2^( 2) =       0.000501474178
  error estimate for blocks of size 2^( 3) =       0.000525354953
  error estimate for blocks of size 2^( 4) =       0.000543431199
  error estimate for blocks of size 2^( 5) =       0.000555670942
  error estimate for blocks of size 2^( 6) =       0.000560494607
  error estimate for blocks of size 2^( 7) =       0.000564167074

      target function =      -0.742415143799
              le_mean =     -22.814489306921
             les_mean =     520.954284959284
             stat err =       0.000555940955
             autocorr =       1.363456866478
   target nu stat err =       0.000555940955
   target dn stat err =       0.006323349364
      target stat err =       0.005313040756
              std dev =       0.673322248531
             le_variance =       0.453362850367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742415143799        initial  <--
     6.2500e+42     6.2500e+43             0.0000e+00        -0.742415143799
     2.5000e+43     2.5000e+44             2.2156e-48        -0.742415143799
     1.0000e+44     1.0000e+45             0.0000e+00        -0.742415143799

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5246
  </log>
  <optVariables href="FORM2.s047.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2125e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8267
    reference variance = 0.416279
====================================================
  Execution time = 4.3275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5255e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4735e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452596902967
                                         uncertainty =       0.004344181858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452596902967
                                         uncertainty =       0.004344181858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475682900
  error estimate for blocks of size 2^( 2) =       0.000500734178
  error estimate for blocks of size 2^( 3) =       0.000525225582
  error estimate for blocks of size 2^( 4) =       0.000543791631
  error estimate for blocks of size 2^( 5) =       0.000555378552
  error estimate for blocks of size 2^( 6) =       0.000561464594
  error estimate for blocks of size 2^( 7) =       0.000564621136

      target function =      -0.743111453348
              le_mean =     -22.814489316740
             les_mean =     520.953470999506
             stat err =       0.000556313978
             autocorr =       1.367744151679
   target nu stat err =       0.000556313978
   target dn stat err =       0.004729673798
      target stat err =       0.004002959347
              std dev =       0.672717208143
             le_variance =       0.452548442132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448931674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+43, overlap shift 6.2500e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743131922231       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743131922231       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+44, overlap shift 2.5000e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743131922231       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743131922231       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+45, overlap shift 1.0000e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743131922231       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743131922231       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.175986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8016e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7944
    reference variance = 0.439528
====================================================
  Execution time = 4.3748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4691e-01
  Total weights = 2.0000e+06
  Execution time = 3.4833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472710788
  error estimate for blocks of size 2^( 2) =       0.000498142205
  error estimate for blocks of size 2^( 3) =       0.000521906043
  error estimate for blocks of size 2^( 4) =       0.000539811028
  error estimate for blocks of size 2^( 5) =       0.000552247075
  error estimate for blocks of size 2^( 6) =       0.000560854489
  error estimate for blocks of size 2^( 7) =       0.000564072105

      target function =      -0.747853280665
              le_mean =     -22.815078398514
             les_mean =     520.974713084442
             stat err =       0.000554246174
             autocorr =       1.374720412677
   target nu stat err =       0.000554246174
   target dn stat err =       0.003768589860
      target stat err =       0.003254641778
              std dev =       0.668514006997
             le_variance =       0.446910977551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472710788
  error estimate for blocks of size 2^( 2) =       0.000498142205
  error estimate for blocks of size 2^( 3) =       0.000521906043
  error estimate for blocks of size 2^( 4) =       0.000539811028
  error estimate for blocks of size 2^( 5) =       0.000552247075
  error estimate for blocks of size 2^( 6) =       0.000560854489
  error estimate for blocks of size 2^( 7) =       0.000564072105

      target function =      -0.747853280665
              le_mean =     -22.815078398514
             les_mean =     520.974713084442
             stat err =       0.000554246174
             autocorr =       1.374720412677
   target nu stat err =       0.000554246174
   target dn stat err =       0.003768589860
      target stat err =       0.003254641778
              std dev =       0.668514006997
             le_variance =       0.446910977551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472710788
  error estimate for blocks of size 2^( 2) =       0.000498142205
  error estimate for blocks of size 2^( 3) =       0.000521906043
  error estimate for blocks of size 2^( 4) =       0.000539811028
  error estimate for blocks of size 2^( 5) =       0.000552247075
  error estimate for blocks of size 2^( 6) =       0.000560854489
  error estimate for blocks of size 2^( 7) =       0.000564072105

      target function =      -0.747853280665
              le_mean =     -22.815078398514
             les_mean =     520.974713084442
             stat err =       0.000554246174
             autocorr =       1.374720412677
   target nu stat err =       0.000554246174
   target dn stat err =       0.003768589860
      target stat err =       0.003254641778
              std dev =       0.668514006997
             le_variance =       0.446910977551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978510979
                                         uncertainty =       0.003851867091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472710788
  error estimate for blocks of size 2^( 2) =       0.000498142205
  error estimate for blocks of size 2^( 3) =       0.000521906043
  error estimate for blocks of size 2^( 4) =       0.000539811028
  error estimate for blocks of size 2^( 5) =       0.000552247075
  error estimate for blocks of size 2^( 6) =       0.000560854489
  error estimate for blocks of size 2^( 7) =       0.000564072105

      target function =      -0.747853280665
              le_mean =     -22.815078398514
             les_mean =     520.974713084442
             stat err =       0.000554246174
             autocorr =       1.374720412677
   target nu stat err =       0.000554246174
   target dn stat err =       0.003768589860
      target stat err =       0.003254641778
              std dev =       0.668514006997
             le_variance =       0.446910977551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747853280665        initial  <--
     6.2500e+43     6.2500e+44             0.0000e+00        -0.747853280665
     2.5000e+44     2.5000e+45             0.0000e+00        -0.747853280665
     1.0000e+45     1.0000e+46             0.0000e+00        -0.747853280665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5836
  </log>
  <optVariables href="FORM2.s048.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2101e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8648
    reference variance = 0.588281
====================================================
  Execution time = 4.3246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4585e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447048244383
                                         uncertainty =       0.003383192793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447048244383
                                         uncertainty =       0.003383192793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472769115
  error estimate for blocks of size 2^( 2) =       0.000497796837
  error estimate for blocks of size 2^( 3) =       0.000521916557
  error estimate for blocks of size 2^( 4) =       0.000540343201
  error estimate for blocks of size 2^( 5) =       0.000551608033
  error estimate for blocks of size 2^( 6) =       0.000560336875
  error estimate for blocks of size 2^( 7) =       0.000563785899

      target function =      -0.747763298157
              le_mean =     -22.815152048568
             les_mean =     520.978184047572
             stat err =       0.000554018502
             autocorr =       1.373252325958
   target nu stat err =       0.000554018502
   target dn stat err =       0.003062567765
      target stat err =       0.002669700566
              std dev =       0.668596494005
             le_variance =       0.447021271795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281515204857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+44, overlap shift 6.2500e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747771959195       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747771959195       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+45, overlap shift 2.5000e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747771959195       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747771959195       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+46, overlap shift 1.0000e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747771959195       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747771959195       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.177098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7837e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8786
    reference variance = 0.618331
====================================================
  Execution time = 4.3036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4492e-01
  Total weights = 2.0000e+06
  Execution time = 3.5075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471654313
  error estimate for blocks of size 2^( 2) =       0.000497183368
  error estimate for blocks of size 2^( 3) =       0.000521128118
  error estimate for blocks of size 2^( 4) =       0.000539068027
  error estimate for blocks of size 2^( 5) =       0.000550084086
  error estimate for blocks of size 2^( 6) =       0.000556222901
  error estimate for blocks of size 2^( 7) =       0.000558825369

      target function =      -0.749557885510
              le_mean =     -22.814851439610
             les_mean =     520.962361570138
             stat err =       0.000551050096
             autocorr =       1.365005950939
   target nu stat err =       0.000551050096
   target dn stat err =       0.002606972722
      target stat err =       0.002304950019
              std dev =       0.667019925584
             le_variance =       0.444915581126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471654313
  error estimate for blocks of size 2^( 2) =       0.000497183368
  error estimate for blocks of size 2^( 3) =       0.000521128118
  error estimate for blocks of size 2^( 4) =       0.000539068027
  error estimate for blocks of size 2^( 5) =       0.000550084086
  error estimate for blocks of size 2^( 6) =       0.000556222901
  error estimate for blocks of size 2^( 7) =       0.000558825369

      target function =      -0.749557885510
              le_mean =     -22.814851439610
             les_mean =     520.962361570138
             stat err =       0.000551050096
             autocorr =       1.365005950939
   target nu stat err =       0.000551050096
   target dn stat err =       0.002606972722
      target stat err =       0.002304950019
              std dev =       0.667019925584
             le_variance =       0.444915581126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471654313
  error estimate for blocks of size 2^( 2) =       0.000497183368
  error estimate for blocks of size 2^( 3) =       0.000521128118
  error estimate for blocks of size 2^( 4) =       0.000539068027
  error estimate for blocks of size 2^( 5) =       0.000550084086
  error estimate for blocks of size 2^( 6) =       0.000556222901
  error estimate for blocks of size 2^( 7) =       0.000558825369

      target function =      -0.749557885510
              le_mean =     -22.814851439610
             les_mean =     520.962361570138
             stat err =       0.000551050096
             autocorr =       1.365005950939
   target nu stat err =       0.000551050096
   target dn stat err =       0.002606972722
      target stat err =       0.002304950019
              std dev =       0.667019925584
             le_variance =       0.444915581126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444978716905
                                         uncertainty =       0.002602416591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471654313
  error estimate for blocks of size 2^( 2) =       0.000497183368
  error estimate for blocks of size 2^( 3) =       0.000521128118
  error estimate for blocks of size 2^( 4) =       0.000539068027
  error estimate for blocks of size 2^( 5) =       0.000550084086
  error estimate for blocks of size 2^( 6) =       0.000556222901
  error estimate for blocks of size 2^( 7) =       0.000558825369

      target function =      -0.749557885510
              le_mean =     -22.814851439610
             les_mean =     520.962361570138
             stat err =       0.000551050096
             autocorr =       1.365005950939
   target nu stat err =       0.000551050096
   target dn stat err =       0.002606972722
      target stat err =       0.002304950019
              std dev =       0.667019925584
             le_variance =       0.444915581126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749557885510        initial  <--
     6.2500e+44     6.2500e+45             0.0000e+00        -0.749557885510
     2.5000e+45     2.5000e+46             0.0000e+00        -0.749557885510
     1.0000e+46     1.0000e+47             0.0000e+00        -0.749557885510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5742
  </log>
  <optVariables href="FORM2.s049.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1842e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8496
    reference variance = 0.446127
====================================================
  Execution time = 4.5162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4836e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4695e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448406991447
                                         uncertainty =       0.003849486973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448406991447
                                         uncertainty =       0.003849486973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473478329
  error estimate for blocks of size 2^( 2) =       0.000498859763
  error estimate for blocks of size 2^( 3) =       0.000522788556
  error estimate for blocks of size 2^( 4) =       0.000540522476
  error estimate for blocks of size 2^( 5) =       0.000553412261
  error estimate for blocks of size 2^( 6) =       0.000562728879
  error estimate for blocks of size 2^( 7) =       0.000566251705

      target function =      -0.746619697925
              le_mean =     -22.815324025781
             les_mean =     520.987373633533
             stat err =       0.000555728830
             autocorr =       1.377607958576
   target nu stat err =       0.000555728830
   target dn stat err =       0.003895468655
      target stat err =       0.003350883384
              std dev =       0.669599474546
             le_variance =       0.448363456313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281532402578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+45, overlap shift 6.2500e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746633617326       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746633617326       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+46, overlap shift 2.5000e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746633617326       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746633617326       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+47, overlap shift 1.0000e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746633617326       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746633617326       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.178220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9864e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7801
    reference variance = 0.317545
====================================================
  Execution time = 4.3183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.8123e-01
  Total weights = 2.0000e+06
  Execution time = 3.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490524208
  error estimate for blocks of size 2^( 2) =       0.000515402205
  error estimate for blocks of size 2^( 3) =       0.000538783600
  error estimate for blocks of size 2^( 4) =       0.000557059933
  error estimate for blocks of size 2^( 5) =       0.000570188559
  error estimate for blocks of size 2^( 6) =       0.000576532955
  error estimate for blocks of size 2^( 7) =       0.000579573405

      target function =      -0.718779986442
              le_mean =     -22.814712317875
             les_mean =     520.992325904985
             stat err =       0.000570838713
             autocorr =       1.354272144071
   target nu stat err =       0.000570838713
   target dn stat err =       0.036047560699
      target stat err =       0.028252008613
              std dev =       0.693705988291
             le_variance =       0.481227998190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490524208
  error estimate for blocks of size 2^( 2) =       0.000515402205
  error estimate for blocks of size 2^( 3) =       0.000538783600
  error estimate for blocks of size 2^( 4) =       0.000557059933
  error estimate for blocks of size 2^( 5) =       0.000570188559
  error estimate for blocks of size 2^( 6) =       0.000576532955
  error estimate for blocks of size 2^( 7) =       0.000579573405

      target function =      -0.718779986442
              le_mean =     -22.814712317875
             les_mean =     520.992325904985
             stat err =       0.000570838713
             autocorr =       1.354272144071
   target nu stat err =       0.000570838713
   target dn stat err =       0.036047560699
      target stat err =       0.028252008613
              std dev =       0.693705988291
             le_variance =       0.481227998190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490524208
  error estimate for blocks of size 2^( 2) =       0.000515402205
  error estimate for blocks of size 2^( 3) =       0.000538783600
  error estimate for blocks of size 2^( 4) =       0.000557059933
  error estimate for blocks of size 2^( 5) =       0.000570188559
  error estimate for blocks of size 2^( 6) =       0.000576532955
  error estimate for blocks of size 2^( 7) =       0.000579573405

      target function =      -0.718779986442
              le_mean =     -22.814712317875
             les_mean =     520.992325904985
             stat err =       0.000570838713
             autocorr =       1.354272144071
   target nu stat err =       0.000570838713
   target dn stat err =       0.036047560699
      target stat err =       0.028252008613
              std dev =       0.693705988291
             le_variance =       0.481227998190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481315630690
                                         uncertainty =       0.036210613122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490524208
  error estimate for blocks of size 2^( 2) =       0.000515402205
  error estimate for blocks of size 2^( 3) =       0.000538783600
  error estimate for blocks of size 2^( 4) =       0.000557059933
  error estimate for blocks of size 2^( 5) =       0.000570188559
  error estimate for blocks of size 2^( 6) =       0.000576532955
  error estimate for blocks of size 2^( 7) =       0.000579573405

      target function =      -0.718779986442
              le_mean =     -22.814712317875
             les_mean =     520.992325904985
             stat err =       0.000570838713
             autocorr =       1.354272144071
   target nu stat err =       0.000570838713
   target dn stat err =       0.036047560699
      target stat err =       0.028252008613
              std dev =       0.693705988291
             le_variance =       0.481227998190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.718779986442        initial  <--
     6.2500e+45     6.2500e+46             0.0000e+00        -0.718779986442
     2.5000e+46     2.5000e+47             0.0000e+00        -0.718779986442
     1.0000e+47     1.0000e+48             0.0000e+00        -0.718779986442

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6304
  </log>
  <optVariables href="FORM2.s050.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2052e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8263
    reference variance = 0.497866
====================================================
  Execution time = 4.3817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5224e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4817e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452150396573
                                         uncertainty =       0.003680697031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452150396573
                                         uncertainty =       0.003680697031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475519671
  error estimate for blocks of size 2^( 2) =       0.000500889453
  error estimate for blocks of size 2^( 3) =       0.000524750160
  error estimate for blocks of size 2^( 4) =       0.000543179070
  error estimate for blocks of size 2^( 5) =       0.000555498944
  error estimate for blocks of size 2^( 6) =       0.000563254925
  error estimate for blocks of size 2^( 7) =       0.000565992012

      target function =      -0.743350956561
              le_mean =     -22.815785378855
             les_mean =     521.012300142239
             stat err =       0.000556981238
             autocorr =       1.371968555830
   target nu stat err =       0.000556981238
   target dn stat err =       0.003800467505
      target stat err =       0.003246556503
              std dev =       0.672486367450
             le_variance =       0.452237914406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281578537885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+46, overlap shift 6.2500e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743364153586       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743364153586       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.500000000000       residual = 2.77e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+46 is 1.543392e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+47, overlap shift 2.5000e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743364153586       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743364153586       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -1.000000000000       residual = 3.05e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -1.000000000000       residual = 3.05e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+47 is 3.858479e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+48, overlap shift 1.0000e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743364153586       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743364153586       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+48 is 9.646198e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.179787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8641e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7814
    reference variance = 0.314426
====================================================
  Execution time = 4.2857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4917e-01
  Total weights = 2.0000e+06
  Execution time = 3.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473903996
  error estimate for blocks of size 2^( 2) =       0.000499417823
  error estimate for blocks of size 2^( 3) =       0.000522892429
  error estimate for blocks of size 2^( 4) =       0.000541189705
  error estimate for blocks of size 2^( 5) =       0.000552017026
  error estimate for blocks of size 2^( 6) =       0.000559962066
  error estimate for blocks of size 2^( 7) =       0.000564421961

      target function =      -0.745960420706
              le_mean =     -22.814354954892
             les_mean =     520.943961777734
             stat err =       0.000554397689
             autocorr =       1.368554452976
   target nu stat err =       0.000554397689
   target dn stat err =       0.003123602285
      target stat err =       0.002704073220
              std dev =       0.670201458148
             le_variance =       0.449169994504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473903996
  error estimate for blocks of size 2^( 2) =       0.000499417823
  error estimate for blocks of size 2^( 3) =       0.000522892429
  error estimate for blocks of size 2^( 4) =       0.000541189705
  error estimate for blocks of size 2^( 5) =       0.000552017026
  error estimate for blocks of size 2^( 6) =       0.000559962066
  error estimate for blocks of size 2^( 7) =       0.000564421961

      target function =      -0.745960420706
              le_mean =     -22.814354954892
             les_mean =     520.943961777734
             stat err =       0.000554397689
             autocorr =       1.368554452977
   target nu stat err =       0.000554397689
   target dn stat err =       0.003123602285
      target stat err =       0.002704073220
              std dev =       0.670201458148
             le_variance =       0.449169994504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473903996
  error estimate for blocks of size 2^( 2) =       0.000499417823
  error estimate for blocks of size 2^( 3) =       0.000522892429
  error estimate for blocks of size 2^( 4) =       0.000541189705
  error estimate for blocks of size 2^( 5) =       0.000552017026
  error estimate for blocks of size 2^( 6) =       0.000559962066
  error estimate for blocks of size 2^( 7) =       0.000564421961

      target function =      -0.745960420706
              le_mean =     -22.814354954892
             les_mean =     520.943961777734
             stat err =       0.000554397689
             autocorr =       1.368554452977
   target nu stat err =       0.000554397689
   target dn stat err =       0.003123602285
      target stat err =       0.002704073220
              std dev =       0.670201458148
             le_variance =       0.449169994504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449077342754
                                         uncertainty =       0.003079819902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473903996
  error estimate for blocks of size 2^( 2) =       0.000499417823
  error estimate for blocks of size 2^( 3) =       0.000522892429
  error estimate for blocks of size 2^( 4) =       0.000541189705
  error estimate for blocks of size 2^( 5) =       0.000552017026
  error estimate for blocks of size 2^( 6) =       0.000559962066
  error estimate for blocks of size 2^( 7) =       0.000564421961

      target function =      -0.745960420706
              le_mean =     -22.814354954892
             les_mean =     520.943961777734
             stat err =       0.000554397689
             autocorr =       1.368554452977
   target nu stat err =       0.000554397689
   target dn stat err =       0.003123602285
      target stat err =       0.002704073220
              std dev =       0.670201458148
             le_variance =       0.449169994504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745960420706        initial  <--
     6.2500e+46     6.2500e+47             1.5434e-51        -0.745960420706
     2.5000e+47     2.5000e+48             3.8585e-52        -0.745960420706
     1.0000e+48     1.0000e+49             9.6462e-53        -0.745960420706

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.3861
  </log>
  <optVariables href="FORM2.s051.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1903e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8333
    reference variance = 0.290328
====================================================
  Execution time = 4.3437e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4753e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5019e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447581709129
                                         uncertainty =       0.002639594651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447581709129
                                         uncertainty =       0.002639594651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473036197
  error estimate for blocks of size 2^( 2) =       0.000498201101
  error estimate for blocks of size 2^( 3) =       0.000521955099
  error estimate for blocks of size 2^( 4) =       0.000540601566
  error estimate for blocks of size 2^( 5) =       0.000552793352
  error estimate for blocks of size 2^( 6) =       0.000560304995
  error estimate for blocks of size 2^( 7) =       0.000564029184

      target function =      -0.747349255919
              le_mean =     -22.814312447307
             les_mean =     520.940378707803
             stat err =       0.000554432274
             autocorr =       1.373751743158
   target nu stat err =       0.000554432274
   target dn stat err =       0.002828365840
      target stat err =       0.002471584605
              std dev =       0.668974205941
             le_variance =       0.447526488215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431244731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+47, overlap shift 6.2500e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747356449156       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747356449156       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747356449156       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+47 is 9.614222e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+48, overlap shift 2.5000e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747356449156       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747356449156       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747356449156       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+48 is 2.403556e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+49, overlap shift 1.0000e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747356449156       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747356449156       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747356449156       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+49 is 6.008889e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.181126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8463e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.859
    reference variance = 0.524561
====================================================
  Execution time = 4.4650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4766e-01
  Total weights = 2.0000e+06
  Execution time = 3.4751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473107899
  error estimate for blocks of size 2^( 2) =       0.000498627296
  error estimate for blocks of size 2^( 3) =       0.000522702840
  error estimate for blocks of size 2^( 4) =       0.000539933144
  error estimate for blocks of size 2^( 5) =       0.000551515966
  error estimate for blocks of size 2^( 6) =       0.000559285370
  error estimate for blocks of size 2^( 7) =       0.000563894799

      target function =      -0.747226266093
              le_mean =     -22.814878281701
             les_mean =     520.966332953933
             stat err =       0.000553657320
             autocorr =       1.369498917035
   target nu stat err =       0.000553657320
   target dn stat err =       0.002842927191
      target stat err =       0.002484607380
              std dev =       0.669075607786
             le_variance =       0.447662168934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473107899
  error estimate for blocks of size 2^( 2) =       0.000498627296
  error estimate for blocks of size 2^( 3) =       0.000522702840
  error estimate for blocks of size 2^( 4) =       0.000539933144
  error estimate for blocks of size 2^( 5) =       0.000551515966
  error estimate for blocks of size 2^( 6) =       0.000559285370
  error estimate for blocks of size 2^( 7) =       0.000563894799

      target function =      -0.747226266093
              le_mean =     -22.814878281701
             les_mean =     520.966332953933
             stat err =       0.000553657320
             autocorr =       1.369498917035
   target nu stat err =       0.000553657320
   target dn stat err =       0.002842927191
      target stat err =       0.002484607380
              std dev =       0.669075607786
             le_variance =       0.447662168934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473107899
  error estimate for blocks of size 2^( 2) =       0.000498627296
  error estimate for blocks of size 2^( 3) =       0.000522702840
  error estimate for blocks of size 2^( 4) =       0.000539933144
  error estimate for blocks of size 2^( 5) =       0.000551515966
  error estimate for blocks of size 2^( 6) =       0.000559285370
  error estimate for blocks of size 2^( 7) =       0.000563894799

      target function =      -0.747226266093
              le_mean =     -22.814878281701
             les_mean =     520.966332953933
             stat err =       0.000553657320
             autocorr =       1.369498917035
   target nu stat err =       0.000553657320
   target dn stat err =       0.002842927191
      target stat err =       0.002484607380
              std dev =       0.669075607786
             le_variance =       0.447662168934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447677889954
                                         uncertainty =       0.002733420713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473107899
  error estimate for blocks of size 2^( 2) =       0.000498627296
  error estimate for blocks of size 2^( 3) =       0.000522702840
  error estimate for blocks of size 2^( 4) =       0.000539933144
  error estimate for blocks of size 2^( 5) =       0.000551515966
  error estimate for blocks of size 2^( 6) =       0.000559285370
  error estimate for blocks of size 2^( 7) =       0.000563894799

      target function =      -0.747226266093
              le_mean =     -22.814878281701
             les_mean =     520.966332953933
             stat err =       0.000553657320
             autocorr =       1.369498917035
   target nu stat err =       0.000553657320
   target dn stat err =       0.002842927191
      target stat err =       0.002484607380
              std dev =       0.669075607786
             le_variance =       0.447662168934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747226266093        initial  <--
     6.2500e+47     6.2500e+48             9.6142e-53        -0.747226266093
     2.5000e+48     2.5000e+49             2.4036e-53        -0.747226266093
     1.0000e+49     1.0000e+50             6.0089e-54        -0.747226266093

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0818
  </log>
  <optVariables href="FORM2.s052.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2055e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.847
    reference variance = 0.369758
====================================================
  Execution time = 4.3303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4636e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455700600486
                                         uncertainty =       0.005160016991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455700600486
                                         uncertainty =       0.005160016991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477307912
  error estimate for blocks of size 2^( 2) =       0.000502280665
  error estimate for blocks of size 2^( 3) =       0.000525709941
  error estimate for blocks of size 2^( 4) =       0.000543340128
  error estimate for blocks of size 2^( 5) =       0.000554677824
  error estimate for blocks of size 2^( 6) =       0.000560737270
  error estimate for blocks of size 2^( 7) =       0.000568204895

      target function =      -0.740538414725
              le_mean =     -22.814290325655
             les_mean =     520.947488521858
             stat err =       0.000556740029
             autocorr =       1.360528453000
   target nu stat err =       0.000556740029
   target dn stat err =       0.004474721175
      target stat err =       0.003765671976
              std dev =       0.675015323078
             le_variance =       0.455645686390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429032566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+48, overlap shift 6.2500e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740556498536       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740556498536       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+49, overlap shift 2.5000e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740556498536       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740556498536       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+50, overlap shift 1.0000e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740556498536       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740556498536       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.182237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7946e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6511
    reference variance = 0.314096
====================================================
  Execution time = 4.4210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5588e-01
  Total weights = 2.0000e+06
  Execution time = 3.4719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477429148
  error estimate for blocks of size 2^( 2) =       0.000502807644
  error estimate for blocks of size 2^( 3) =       0.000526514192
  error estimate for blocks of size 2^( 4) =       0.000544595668
  error estimate for blocks of size 2^( 5) =       0.000556976893
  error estimate for blocks of size 2^( 6) =       0.000561736337
  error estimate for blocks of size 2^( 7) =       0.000563957075

      target function =      -0.740339128813
              le_mean =     -22.814540804600
             les_mean =     520.959149079643
             stat err =       0.000556816493
             autocorr =       1.360211120875
   target nu stat err =       0.000556816493
   target dn stat err =       0.004582561563
      target stat err =       0.003853394927
              std dev =       0.675186776251
             le_variance =       0.455877182825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477429148
  error estimate for blocks of size 2^( 2) =       0.000502807644
  error estimate for blocks of size 2^( 3) =       0.000526514192
  error estimate for blocks of size 2^( 4) =       0.000544595668
  error estimate for blocks of size 2^( 5) =       0.000556976893
  error estimate for blocks of size 2^( 6) =       0.000561736337
  error estimate for blocks of size 2^( 7) =       0.000563957075

      target function =      -0.740339128813
              le_mean =     -22.814540804600
             les_mean =     520.959149079643
             stat err =       0.000556816493
             autocorr =       1.360211120875
   target nu stat err =       0.000556816493
   target dn stat err =       0.004582561563
      target stat err =       0.003853394927
              std dev =       0.675186776251
             le_variance =       0.455877182825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477429148
  error estimate for blocks of size 2^( 2) =       0.000502807644
  error estimate for blocks of size 2^( 3) =       0.000526514192
  error estimate for blocks of size 2^( 4) =       0.000544595668
  error estimate for blocks of size 2^( 5) =       0.000556976893
  error estimate for blocks of size 2^( 6) =       0.000561736337
  error estimate for blocks of size 2^( 7) =       0.000563957075

      target function =      -0.740339128813
              le_mean =     -22.814540804600
             les_mean =     520.959149079643
             stat err =       0.000556816493
             autocorr =       1.360211120875
   target nu stat err =       0.000556816493
   target dn stat err =       0.004582561563
      target stat err =       0.003853394927
              std dev =       0.675186776251
             le_variance =       0.455877182825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455953059500
                                         uncertainty =       0.004585602810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477429148
  error estimate for blocks of size 2^( 2) =       0.000502807644
  error estimate for blocks of size 2^( 3) =       0.000526514192
  error estimate for blocks of size 2^( 4) =       0.000544595668
  error estimate for blocks of size 2^( 5) =       0.000556976893
  error estimate for blocks of size 2^( 6) =       0.000561736337
  error estimate for blocks of size 2^( 7) =       0.000563957075

      target function =      -0.740339128813
              le_mean =     -22.814540804600
             les_mean =     520.959149079643
             stat err =       0.000556816493
             autocorr =       1.360211120875
   target nu stat err =       0.000556816493
   target dn stat err =       0.004582561563
      target stat err =       0.003853394927
              std dev =       0.675186776251
             le_variance =       0.455877182825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740339128813        initial  <--
     6.2500e+48     6.2500e+49             0.0000e+00        -0.740339128813
     2.5000e+49     2.5000e+50             0.0000e+00        -0.740339128813
     1.0000e+50     1.0000e+51             0.0000e+00        -0.740339128813

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0970
  </log>
  <optVariables href="FORM2.s053.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2205e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.817
    reference variance = 0.491177
====================================================
  Execution time = 4.3213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4574e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450012204939
                                         uncertainty =       0.003258551203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450012204939
                                         uncertainty =       0.003258551203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474295859
  error estimate for blocks of size 2^( 2) =       0.000499914489
  error estimate for blocks of size 2^( 3) =       0.000523961556
  error estimate for blocks of size 2^( 4) =       0.000542272860
  error estimate for blocks of size 2^( 5) =       0.000553646080
  error estimate for blocks of size 2^( 6) =       0.000561928462
  error estimate for blocks of size 2^( 7) =       0.000564649832

      target function =      -0.745332957254
              le_mean =     -22.814360215591
             les_mean =     520.944944944649
             stat err =       0.000555624308
             autocorr =       1.372346599569
   target nu stat err =       0.000555624308
   target dn stat err =       0.003456774593
      target stat err =       0.002973179064
              std dev =       0.670755635730
             le_variance =       0.449913122864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281436021559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+49, overlap shift 6.2500e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745343716767       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745343716767       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+50, overlap shift 2.5000e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745343716767       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745343716767       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+51, overlap shift 1.0000e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745343716767       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745343716767       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.183330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7793e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8729
    reference variance = 0.264083
====================================================
  Execution time = 4.3316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4676e-01
  Total weights = 2.0000e+06
  Execution time = 3.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472631762
  error estimate for blocks of size 2^( 2) =       0.000497967162
  error estimate for blocks of size 2^( 3) =       0.000521738074
  error estimate for blocks of size 2^( 4) =       0.000539938176
  error estimate for blocks of size 2^( 5) =       0.000550500089
  error estimate for blocks of size 2^( 6) =       0.000557537238
  error estimate for blocks of size 2^( 7) =       0.000559783084

      target function =      -0.747990474004
              le_mean =     -22.814903739700
             les_mean =     520.966593992956
             stat err =       0.000551939647
             autocorr =       1.363758199654
   target nu stat err =       0.000551939647
   target dn stat err =       0.002425484107
      target stat err =       0.002148544575
              std dev =       0.668402247562
             le_variance =       0.446761564546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472631762
  error estimate for blocks of size 2^( 2) =       0.000497967162
  error estimate for blocks of size 2^( 3) =       0.000521738074
  error estimate for blocks of size 2^( 4) =       0.000539938176
  error estimate for blocks of size 2^( 5) =       0.000550500089
  error estimate for blocks of size 2^( 6) =       0.000557537238
  error estimate for blocks of size 2^( 7) =       0.000559783084

      target function =      -0.747990474004
              le_mean =     -22.814903739700
             les_mean =     520.966593992956
             stat err =       0.000551939647
             autocorr =       1.363758199658
   target nu stat err =       0.000551939647
   target dn stat err =       0.002425484107
      target stat err =       0.002148544575
              std dev =       0.668402247562
             le_variance =       0.446761564546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472631762
  error estimate for blocks of size 2^( 2) =       0.000497967162
  error estimate for blocks of size 2^( 3) =       0.000521738074
  error estimate for blocks of size 2^( 4) =       0.000539938176
  error estimate for blocks of size 2^( 5) =       0.000550500089
  error estimate for blocks of size 2^( 6) =       0.000557537238
  error estimate for blocks of size 2^( 7) =       0.000559783084

      target function =      -0.747990474004
              le_mean =     -22.814903739700
             les_mean =     520.966593992956
             stat err =       0.000551939647
             autocorr =       1.363758199658
   target nu stat err =       0.000551939647
   target dn stat err =       0.002425484107
      target stat err =       0.002148544575
              std dev =       0.668402247562
             le_variance =       0.446761564546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446584826580
                                         uncertainty =       0.002264146923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472631762
  error estimate for blocks of size 2^( 2) =       0.000497967162
  error estimate for blocks of size 2^( 3) =       0.000521738074
  error estimate for blocks of size 2^( 4) =       0.000539938176
  error estimate for blocks of size 2^( 5) =       0.000550500089
  error estimate for blocks of size 2^( 6) =       0.000557537238
  error estimate for blocks of size 2^( 7) =       0.000559783084

      target function =      -0.747990474004
              le_mean =     -22.814903739700
             les_mean =     520.966593992956
             stat err =       0.000551939647
             autocorr =       1.363758199658
   target nu stat err =       0.000551939647
   target dn stat err =       0.002425484107
      target stat err =       0.002148544575
              std dev =       0.668402247562
             le_variance =       0.446761564546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747990474004        initial  <--
     6.2500e+49     6.2500e+50             0.0000e+00        -0.747990474004
     2.5000e+50     2.5000e+51             0.0000e+00        -0.747990474004
     1.0000e+51     1.0000e+52             0.0000e+00        -0.747990474004

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7524
  </log>
  <optVariables href="FORM2.s054.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1855e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7571
    reference variance = 0.49633
====================================================
  Execution time = 4.4646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4788e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453171339294
                                         uncertainty =       0.004943106252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453171339294
                                         uncertainty =       0.004943106252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476013689
  error estimate for blocks of size 2^( 2) =       0.000501419897
  error estimate for blocks of size 2^( 3) =       0.000525185449
  error estimate for blocks of size 2^( 4) =       0.000543164433
  error estimate for blocks of size 2^( 5) =       0.000554052398
  error estimate for blocks of size 2^( 6) =       0.000560234616
  error estimate for blocks of size 2^( 7) =       0.000566720560

      target function =      -0.742566167686
              le_mean =     -22.815117837005
             les_mean =     520.982779753535
             stat err =       0.000556043002
             autocorr =       1.364513618928
   target nu stat err =       0.000556043002
   target dn stat err =       0.005341197111
      target stat err =       0.004506309517
              std dev =       0.673185014481
             le_variance =       0.453178063722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281511783700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+50, overlap shift 6.2500e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742592285048       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742592285048       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742592285048       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742592285046       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+50 is 2.339235e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+51, overlap shift 2.5000e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742592285048       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742592285048       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742592285048       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742592285044       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+51 is 5.848089e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+52, overlap shift 1.0000e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742592285048       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742592285048       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742592285048       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742592285046       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+52 is 1.462022e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.184981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9441e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7922
    reference variance = 0.413421
====================================================
  Execution time = 4.3163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5845e-01
  Total weights = 2.0000e+06
  Execution time = 3.4715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478772107
  error estimate for blocks of size 2^( 2) =       0.000504094964
  error estimate for blocks of size 2^( 3) =       0.000527719066
  error estimate for blocks of size 2^( 4) =       0.000545977875
  error estimate for blocks of size 2^( 5) =       0.000557284064
  error estimate for blocks of size 2^( 6) =       0.000565137889
  error estimate for blocks of size 2^( 7) =       0.000569193387

      target function =      -0.738167092661
              le_mean =     -22.814544262090
             les_mean =     520.961875118849
             stat err =       0.000559398304
             autocorr =       1.365163312288
   target nu stat err =       0.000559398304
   target dn stat err =       0.008543617336
      target stat err =       0.007075949929
              std dev =       0.677086007233
             le_variance =       0.458445461191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478772107
  error estimate for blocks of size 2^( 2) =       0.000504094964
  error estimate for blocks of size 2^( 3) =       0.000527719066
  error estimate for blocks of size 2^( 4) =       0.000545977875
  error estimate for blocks of size 2^( 5) =       0.000557284064
  error estimate for blocks of size 2^( 6) =       0.000565137889
  error estimate for blocks of size 2^( 7) =       0.000569193387

      target function =      -0.738167092661
              le_mean =     -22.814544262090
             les_mean =     520.961875118849
             stat err =       0.000559398304
             autocorr =       1.365163312288
   target nu stat err =       0.000559398304
   target dn stat err =       0.008543617336
      target stat err =       0.007075949929
              std dev =       0.677086007233
             le_variance =       0.458445461191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478772107
  error estimate for blocks of size 2^( 2) =       0.000504094964
  error estimate for blocks of size 2^( 3) =       0.000527719066
  error estimate for blocks of size 2^( 4) =       0.000545977875
  error estimate for blocks of size 2^( 5) =       0.000557284064
  error estimate for blocks of size 2^( 6) =       0.000565137889
  error estimate for blocks of size 2^( 7) =       0.000569193387

      target function =      -0.738167092661
              le_mean =     -22.814544262090
             les_mean =     520.961875118849
             stat err =       0.000559398304
             autocorr =       1.365163312288
   target nu stat err =       0.000559398304
   target dn stat err =       0.008543617336
      target stat err =       0.007075949929
              std dev =       0.677086007233
             le_variance =       0.458445461191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458414262756
                                         uncertainty =       0.008433375516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478772107
  error estimate for blocks of size 2^( 2) =       0.000504094964
  error estimate for blocks of size 2^( 3) =       0.000527719066
  error estimate for blocks of size 2^( 4) =       0.000545977875
  error estimate for blocks of size 2^( 5) =       0.000557284064
  error estimate for blocks of size 2^( 6) =       0.000565137889
  error estimate for blocks of size 2^( 7) =       0.000569193387

      target function =      -0.738167092661
              le_mean =     -22.814544262090
             les_mean =     520.961875118849
             stat err =       0.000559398304
             autocorr =       1.365163312288
   target nu stat err =       0.000559398304
   target dn stat err =       0.008543617336
      target stat err =       0.007075949929
              std dev =       0.677086007233
             le_variance =       0.458445461191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738167092661        initial  <--
     6.2500e+50     6.2500e+51             2.3392e-55        -0.738167092661
     2.5000e+51     2.5000e+52             5.8481e-56        -0.738167092661
     1.0000e+52     1.0000e+53             1.4620e-56        -0.738167092661

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5621
  </log>
  <optVariables href="FORM2.s055.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7448
    reference variance = 0.488625
====================================================
  Execution time = 4.3393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5241e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454020039843
                                         uncertainty =       0.003779225029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454020039843
                                         uncertainty =       0.003779225029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476453058
  error estimate for blocks of size 2^( 2) =       0.000501448756
  error estimate for blocks of size 2^( 3) =       0.000525043271
  error estimate for blocks of size 2^( 4) =       0.000542589799
  error estimate for blocks of size 2^( 5) =       0.000552612049
  error estimate for blocks of size 2^( 6) =       0.000559563387
  error estimate for blocks of size 2^( 7) =       0.000562141768

      target function =      -0.741878949766
              le_mean =     -22.815142798511
             les_mean =     520.984755721910
             stat err =       0.000554226751
             autocorr =       1.353115070748
   target nu stat err =       0.000554226751
   target dn stat err =       0.003952469500
      target stat err =       0.003354685094
              std dev =       0.673806376091
             le_variance =       0.454015032461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281514279851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+51, overlap shift 6.2500e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741893033520       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741893033520       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+51 is 1.089495e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+52, overlap shift 2.5000e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741893033520       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741893033520       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+52 is 2.723736e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+53, overlap shift 1.0000e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741893033520       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741893033520       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+53 is 6.809341e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.186048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8640e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8108
    reference variance = 0.30199
====================================================
  Execution time = 4.3662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5154e-01
  Total weights = 2.0000e+06
  Execution time = 3.4922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475150945
  error estimate for blocks of size 2^( 2) =       0.000500424146
  error estimate for blocks of size 2^( 3) =       0.000524447080
  error estimate for blocks of size 2^( 4) =       0.000542312651
  error estimate for blocks of size 2^( 5) =       0.000553391233
  error estimate for blocks of size 2^( 6) =       0.000560464557
  error estimate for blocks of size 2^( 7) =       0.000563683581

      target function =      -0.743959600117
              le_mean =     -22.814819824802
             les_mean =     520.967540253450
             stat err =       0.000554963006
             autocorr =       1.364158623258
   target nu stat err =       0.000554963006
   target dn stat err =       0.003735410759
      target stat err =       0.003193082375
              std dev =       0.671964910572
             le_variance =       0.451536841040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475150945
  error estimate for blocks of size 2^( 2) =       0.000500424146
  error estimate for blocks of size 2^( 3) =       0.000524447080
  error estimate for blocks of size 2^( 4) =       0.000542312651
  error estimate for blocks of size 2^( 5) =       0.000553391233
  error estimate for blocks of size 2^( 6) =       0.000560464557
  error estimate for blocks of size 2^( 7) =       0.000563683581

      target function =      -0.743959600117
              le_mean =     -22.814819824802
             les_mean =     520.967540253450
             stat err =       0.000554963006
             autocorr =       1.364158623258
   target nu stat err =       0.000554963006
   target dn stat err =       0.003735410759
      target stat err =       0.003193082375
              std dev =       0.671964910572
             le_variance =       0.451536841040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475150945
  error estimate for blocks of size 2^( 2) =       0.000500424146
  error estimate for blocks of size 2^( 3) =       0.000524447080
  error estimate for blocks of size 2^( 4) =       0.000542312651
  error estimate for blocks of size 2^( 5) =       0.000553391233
  error estimate for blocks of size 2^( 6) =       0.000560464557
  error estimate for blocks of size 2^( 7) =       0.000563683581

      target function =      -0.743959600117
              le_mean =     -22.814819824802
             les_mean =     520.967540253450
             stat err =       0.000554963006
             autocorr =       1.364158623258
   target nu stat err =       0.000554963006
   target dn stat err =       0.003735410759
      target stat err =       0.003193082375
              std dev =       0.671964910572
             le_variance =       0.451536841040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451647461712
                                         uncertainty =       0.003514335502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475150945
  error estimate for blocks of size 2^( 2) =       0.000500424146
  error estimate for blocks of size 2^( 3) =       0.000524447080
  error estimate for blocks of size 2^( 4) =       0.000542312651
  error estimate for blocks of size 2^( 5) =       0.000553391233
  error estimate for blocks of size 2^( 6) =       0.000560464557
  error estimate for blocks of size 2^( 7) =       0.000563683581

      target function =      -0.743959600117
              le_mean =     -22.814819824802
             les_mean =     520.967540253450
             stat err =       0.000554963006
             autocorr =       1.364158623258
   target nu stat err =       0.000554963006
   target dn stat err =       0.003735410759
      target stat err =       0.003193082375
              std dev =       0.671964910572
             le_variance =       0.451536841040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743959600117        initial  <--
     6.2500e+51     6.2500e+52             1.0895e-56        -0.743959600117
     2.5000e+52     2.5000e+53             2.7237e-57        -0.743959600117
     1.0000e+53     1.0000e+54             6.8093e-58        -0.743959600117

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1328
  </log>
  <optVariables href="FORM2.s056.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1978e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8266
    reference variance = 0.348322
====================================================
  Execution time = 4.3241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4731e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447841189963
                                         uncertainty =       0.003686632109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447841189963
                                         uncertainty =       0.003686632109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473192810
  error estimate for blocks of size 2^( 2) =       0.000498886944
  error estimate for blocks of size 2^( 3) =       0.000523428522
  error estimate for blocks of size 2^( 4) =       0.000541021685
  error estimate for blocks of size 2^( 5) =       0.000552782273
  error estimate for blocks of size 2^( 6) =       0.000560580212
  error estimate for blocks of size 2^( 7) =       0.000565518863

      target function =      -0.747103171044
              le_mean =     -22.813670237142
             les_mean =     520.911372335158
             stat err =       0.000554975758
             autocorr =       1.375535342364
   target nu stat err =       0.000554975758
   target dn stat err =       0.003563848117
      target stat err =       0.003072138517
              std dev =       0.669195688884
             le_variance =       0.447822870021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281367023714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+52, overlap shift 6.2500e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747114838023       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747114838023       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+53, overlap shift 2.5000e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747114838023       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747114838023       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+54, overlap shift 1.0000e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747114838023       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747114838023       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.187126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7979e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.9015
    reference variance = 0.46909
====================================================
  Execution time = 4.4373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5204e-01
  Total weights = 2.0000e+06
  Execution time = 3.5001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475416537
  error estimate for blocks of size 2^( 2) =       0.000500893171
  error estimate for blocks of size 2^( 3) =       0.000525243194
  error estimate for blocks of size 2^( 4) =       0.000543440465
  error estimate for blocks of size 2^( 5) =       0.000555068081
  error estimate for blocks of size 2^( 6) =       0.000559770688
  error estimate for blocks of size 2^( 7) =       0.000564898580

      target function =      -0.743532703022
              le_mean =     -22.815115013322
             les_mean =     520.981514613316
             stat err =       0.000555794454
             autocorr =       1.366720938690
   target nu stat err =       0.000555794454
   target dn stat err =       0.003397734442
      target stat err =       0.002914255200
              std dev =       0.672340515069
             le_variance =       0.452041768204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475416537
  error estimate for blocks of size 2^( 2) =       0.000500893171
  error estimate for blocks of size 2^( 3) =       0.000525243194
  error estimate for blocks of size 2^( 4) =       0.000543440465
  error estimate for blocks of size 2^( 5) =       0.000555068081
  error estimate for blocks of size 2^( 6) =       0.000559770688
  error estimate for blocks of size 2^( 7) =       0.000564898580

      target function =      -0.743532703022
              le_mean =     -22.815115013322
             les_mean =     520.981514613316
             stat err =       0.000555794454
             autocorr =       1.366720938690
   target nu stat err =       0.000555794454
   target dn stat err =       0.003397734442
      target stat err =       0.002914255200
              std dev =       0.672340515069
             le_variance =       0.452041768204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475416537
  error estimate for blocks of size 2^( 2) =       0.000500893171
  error estimate for blocks of size 2^( 3) =       0.000525243194
  error estimate for blocks of size 2^( 4) =       0.000543440465
  error estimate for blocks of size 2^( 5) =       0.000555068081
  error estimate for blocks of size 2^( 6) =       0.000559770688
  error estimate for blocks of size 2^( 7) =       0.000564898580

      target function =      -0.743532703022
              le_mean =     -22.815115013322
             les_mean =     520.981514613316
             stat err =       0.000555794454
             autocorr =       1.366720938690
   target nu stat err =       0.000555794454
   target dn stat err =       0.003397734442
      target stat err =       0.002914255200
              std dev =       0.672340515069
             le_variance =       0.452041768204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452006542406
                                         uncertainty =       0.003305329933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475416537
  error estimate for blocks of size 2^( 2) =       0.000500893171
  error estimate for blocks of size 2^( 3) =       0.000525243194
  error estimate for blocks of size 2^( 4) =       0.000543440465
  error estimate for blocks of size 2^( 5) =       0.000555068081
  error estimate for blocks of size 2^( 6) =       0.000559770688
  error estimate for blocks of size 2^( 7) =       0.000564898580

      target function =      -0.743532703022
              le_mean =     -22.815115013322
             les_mean =     520.981514613316
             stat err =       0.000555794454
             autocorr =       1.366720938690
   target nu stat err =       0.000555794454
   target dn stat err =       0.003397734442
      target stat err =       0.002914255200
              std dev =       0.672340515069
             le_variance =       0.452041768204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743532703022        initial  <--
     6.2500e+52     6.2500e+53             0.0000e+00        -0.743532703022
     2.5000e+53     2.5000e+54             0.0000e+00        -0.743532703022
     1.0000e+54     1.0000e+55             0.0000e+00        -0.743532703022

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8786
  </log>
  <optVariables href="FORM2.s057.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1991e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6952
    reference variance = 0.397093
====================================================
  Execution time = 4.4190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4638e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4748e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446406386915
                                         uncertainty =       0.003421911540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446406386915
                                         uncertainty =       0.003421911540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472427948
  error estimate for blocks of size 2^( 2) =       0.000497721264
  error estimate for blocks of size 2^( 3) =       0.000521709519
  error estimate for blocks of size 2^( 4) =       0.000539907883
  error estimate for blocks of size 2^( 5) =       0.000550902391
  error estimate for blocks of size 2^( 6) =       0.000557910133
  error estimate for blocks of size 2^( 7) =       0.000562283658

      target function =      -0.748311734264
              le_mean =     -22.815005884790
             les_mean =     520.970869632664
             stat err =       0.000552751016
             autocorr =       1.368951100247
   target nu stat err =       0.000552751016
   target dn stat err =       0.003187062779
      target stat err =       0.002775361886
              std dev =       0.668114011863
             le_variance =       0.446376332848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500588479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+53, overlap shift 6.2500e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748320828531       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748320828531       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748320828531       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748320828528       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+53 is 3.165136e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+54, overlap shift 2.5000e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748320828531       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748320828531       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+55, overlap shift 1.0000e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748320828531       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748320828531       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748320828531       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748320828529       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.96e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+55 is 1.978210e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.188688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8945e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7756
    reference variance = 0.261668
====================================================
  Execution time = 4.3227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4701e-01
  Total weights = 2.0000e+06
  Execution time = 3.4776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472761203
  error estimate for blocks of size 2^( 2) =       0.000497656036
  error estimate for blocks of size 2^( 3) =       0.000521480752
  error estimate for blocks of size 2^( 4) =       0.000539358952
  error estimate for blocks of size 2^( 5) =       0.000551317713
  error estimate for blocks of size 2^( 6) =       0.000556892948
  error estimate for blocks of size 2^( 7) =       0.000560818983

      target function =      -0.747786480333
              le_mean =     -22.813895279141
             les_mean =     520.920823894615
             stat err =       0.000552097149
             autocorr =       1.363789525776
   target nu stat err =       0.000552097149
   target dn stat err =       0.004068655379
      target stat err =       0.003497169387
              std dev =       0.668585305316
             le_variance =       0.447006310485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472761203
  error estimate for blocks of size 2^( 2) =       0.000497656036
  error estimate for blocks of size 2^( 3) =       0.000521480752
  error estimate for blocks of size 2^( 4) =       0.000539358952
  error estimate for blocks of size 2^( 5) =       0.000551317713
  error estimate for blocks of size 2^( 6) =       0.000556892948
  error estimate for blocks of size 2^( 7) =       0.000560818983

      target function =      -0.747786480333
              le_mean =     -22.813895279141
             les_mean =     520.920823894615
             stat err =       0.000552097149
             autocorr =       1.363789525776
   target nu stat err =       0.000552097149
   target dn stat err =       0.004068655379
      target stat err =       0.003497169387
              std dev =       0.668585305316
             le_variance =       0.447006310485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472761203
  error estimate for blocks of size 2^( 2) =       0.000497656036
  error estimate for blocks of size 2^( 3) =       0.000521480752
  error estimate for blocks of size 2^( 4) =       0.000539358952
  error estimate for blocks of size 2^( 5) =       0.000551317713
  error estimate for blocks of size 2^( 6) =       0.000556892948
  error estimate for blocks of size 2^( 7) =       0.000560818983

      target function =      -0.747786480333
              le_mean =     -22.813895279141
             les_mean =     520.920823894615
             stat err =       0.000552097149
             autocorr =       1.363789525776
   target nu stat err =       0.000552097149
   target dn stat err =       0.004068655379
      target stat err =       0.003497169387
              std dev =       0.668585305316
             le_variance =       0.447006310485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059910412
                                         uncertainty =       0.003848626185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472761203
  error estimate for blocks of size 2^( 2) =       0.000497656036
  error estimate for blocks of size 2^( 3) =       0.000521480752
  error estimate for blocks of size 2^( 4) =       0.000539358952
  error estimate for blocks of size 2^( 5) =       0.000551317713
  error estimate for blocks of size 2^( 6) =       0.000556892948
  error estimate for blocks of size 2^( 7) =       0.000560818983

      target function =      -0.747786480333
              le_mean =     -22.813895279141
             les_mean =     520.920823894615
             stat err =       0.000552097149
             autocorr =       1.363789525776
   target nu stat err =       0.000552097149
   target dn stat err =       0.004068655379
      target stat err =       0.003497169387
              std dev =       0.668585305316
             le_variance =       0.447006310485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747786480333        initial  <--
     6.2500e+53     6.2500e+54             3.1651e-58        -0.747786480333
     2.5000e+54     2.5000e+55             0.0000e+00        -0.747786480333
     1.0000e+55     1.0000e+56             1.9782e-59        -0.747786480333

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3998
  </log>
  <optVariables href="FORM2.s058.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2237e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7432
    reference variance = 0.41066
====================================================
  Execution time = 4.3528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4695e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454761003841
                                         uncertainty =       0.005534096168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454761003841
                                         uncertainty =       0.005534096168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476825087
  error estimate for blocks of size 2^( 2) =       0.000501926450
  error estimate for blocks of size 2^( 3) =       0.000525577847
  error estimate for blocks of size 2^( 4) =       0.000543930451
  error estimate for blocks of size 2^( 5) =       0.000555574611
  error estimate for blocks of size 2^( 6) =       0.000561971359
  error estimate for blocks of size 2^( 7) =       0.000567300646

      target function =      -0.741293597347
              le_mean =     -22.814135534196
             les_mean =     520.939504273375
             stat err =       0.000557194267
             autocorr =       1.365510626740
   target nu stat err =       0.000557194267
   target dn stat err =       0.005931564866
      target stat err =       0.004971094611
              std dev =       0.674332505572
             le_variance =       0.454724328070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281413553420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+54, overlap shift 6.2500e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741325451240       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741325451240       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+55, overlap shift 2.5000e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741325451240       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741325451240       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+56, overlap shift 1.0000e+57 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741325451240       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741325451240       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.189813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8230e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7697
    reference variance = 0.334947
====================================================
  Execution time = 4.2983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5193e-01
  Total weights = 2.0000e+06
  Execution time = 3.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475360342
  error estimate for blocks of size 2^( 2) =       0.000500738615
  error estimate for blocks of size 2^( 3) =       0.000524799717
  error estimate for blocks of size 2^( 4) =       0.000543100727
  error estimate for blocks of size 2^( 5) =       0.000552832754
  error estimate for blocks of size 2^( 6) =       0.000559711279
  error estimate for blocks of size 2^( 7) =       0.000562074815

      target function =      -0.743630857633
              le_mean =     -22.814340933296
             les_mean =     520.946086904872
             stat err =       0.000554429894
             autocorr =       1.360339732148
   target nu stat err =       0.000554429894
   target dn stat err =       0.004352795253
      target stat err =       0.003695996639
              std dev =       0.672261043172
             le_variance =       0.451934910167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475360342
  error estimate for blocks of size 2^( 2) =       0.000500738615
  error estimate for blocks of size 2^( 3) =       0.000524799717
  error estimate for blocks of size 2^( 4) =       0.000543100727
  error estimate for blocks of size 2^( 5) =       0.000552832754
  error estimate for blocks of size 2^( 6) =       0.000559711279
  error estimate for blocks of size 2^( 7) =       0.000562074815

      target function =      -0.743630857633
              le_mean =     -22.814340933296
             les_mean =     520.946086904872
             stat err =       0.000554429894
             autocorr =       1.360339732148
   target nu stat err =       0.000554429894
   target dn stat err =       0.004352795253
      target stat err =       0.003695996639
              std dev =       0.672261043172
             le_variance =       0.451934910167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475360342
  error estimate for blocks of size 2^( 2) =       0.000500738615
  error estimate for blocks of size 2^( 3) =       0.000524799717
  error estimate for blocks of size 2^( 4) =       0.000543100727
  error estimate for blocks of size 2^( 5) =       0.000552832754
  error estimate for blocks of size 2^( 6) =       0.000559711279
  error estimate for blocks of size 2^( 7) =       0.000562074815

      target function =      -0.743630857633
              le_mean =     -22.814340933296
             les_mean =     520.946086904872
             stat err =       0.000554429894
             autocorr =       1.360339732148
   target nu stat err =       0.000554429894
   target dn stat err =       0.004352795253
      target stat err =       0.003695996639
              std dev =       0.672261043172
             le_variance =       0.451934910167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451933579914
                                         uncertainty =       0.005515152363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475360342
  error estimate for blocks of size 2^( 2) =       0.000500738615
  error estimate for blocks of size 2^( 3) =       0.000524799717
  error estimate for blocks of size 2^( 4) =       0.000543100727
  error estimate for blocks of size 2^( 5) =       0.000552832754
  error estimate for blocks of size 2^( 6) =       0.000559711279
  error estimate for blocks of size 2^( 7) =       0.000562074815

      target function =      -0.743630857633
              le_mean =     -22.814340933296
             les_mean =     520.946086904872
             stat err =       0.000554429894
             autocorr =       1.360339732148
   target nu stat err =       0.000554429894
   target dn stat err =       0.004352795253
      target stat err =       0.003695996639
              std dev =       0.672261043172
             le_variance =       0.451934910167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743630857633        initial  <--
     6.2500e+54     6.2500e+55             0.0000e+00        -0.743630857633
     2.5000e+55     2.5000e+56             0.0000e+00        -0.743630857633
     1.0000e+56     1.0000e+57             0.0000e+00        -0.743630857633

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4714
  </log>
  <optVariables href="FORM2.s059.opt.xml">
 uu_0                 2.659883e-01 1 1  ON 0
 uu_1                 1.059567e-01 1 1  ON 1
 uu_2                 6.582657e-03 1 1  ON 2
 uu_3                -5.283976e-02 1 1  ON 3
 uu_4                -8.663624e-02 1 1  ON 4
 uu_5                -1.051033e-01 1 1  ON 5
 uu_6                -1.113907e-01 1 1  ON 6
 uu_7                -1.038513e-01 1 1  ON 7
 uu_8                -8.046746e-02 1 1  ON 8
 uu_9                -4.289014e-02 1 1  ON 9
 ud_0                 3.459048e-01 1 1  ON 10
 ud_1                 1.068932e-01 1 1  ON 11
 ud_2                -9.362299e-03 1 1  ON 12
 ud_3                -6.924684e-02 1 1  ON 13
 ud_4                -1.012986e-01 1 1  ON 14
 ud_5                -1.172789e-01 1 1  ON 15
 ud_6                -1.213739e-01 1 1  ON 16
 ud_7                -1.120364e-01 1 1  ON 17
 ud_8                -8.586102e-02 1 1  ON 18
 ud_9                -4.559212e-02 1 1  ON 19
 eC_0                -4.506304e-01 1 1  ON 20
 eC_1                -3.146094e-01 1 1  ON 21
 eC_2                -6.877919e-02 1 1  ON 22
 eC_3                 8.857759e-02 1 1  ON 23
 eC_4                 1.362930e-01 1 1  ON 24
 eC_5                 2.006926e-01 1 1  ON 25
 eC_6                 2.136874e-01 1 1  ON 26
 eC_7                 1.597268e-01 1 1  ON 27
 eC_8                 3.435988e-02 1 1  ON 28
 eC_9                 1.050432e-03 1 1  ON 29
 eO_0                -8.236158e-01 1 1  ON 30
 eO_1                -5.245099e-01 1 1  ON 31
 eO_2                -1.332031e-01 1 1  ON 32
 eO_3                 1.329510e-01 1 1  ON 33
 eO_4                 2.611591e-01 1 1  ON 34
 eO_5                 3.461257e-01 1 1  ON 35
 eO_6                 3.302564e-01 1 1  ON 36
 eO_7                 2.659216e-01 1 1  ON 37
 eO_8                 1.071655e-01 1 1  ON 38
 eO_9                 2.450727e-02 1 1  ON 39
eH1_0                -1.397626e-01 1 1  ON 40
eH1_1                -4.653129e-02 1 1  ON 41
eH1_2                -2.258046e-02 1 1  ON 42
eH1_3                -3.701640e-02 1 1  ON 43
eH1_4                -8.235878e-03 1 1  ON 44
eH1_5                 1.739528e-02 1 1  ON 45
eH1_6                 4.606595e-02 1 1  ON 46
eH1_7                 3.927440e-02 1 1  ON 47
eH1_8                 7.522778e-02 1 1  ON 48
eH1_9                 6.186604e-02 1 1  ON 49
eH2_0                -1.394480e-01 1 1  ON 50
eH2_1                -4.450460e-02 1 1  ON 51
eH2_2                -2.173508e-02 1 1  ON 52
eH2_3                -3.499258e-02 1 1  ON 53
eH2_4                -6.924344e-03 1 1  ON 54
eH2_5                 2.004004e-02 1 1  ON 55
eH2_6                 4.945898e-02 1 1  ON 56
eH2_7                 4.371781e-02 1 1  ON 57
eH2_8                 6.697304e-02 1 1  ON 58
eH2_9                 6.200172e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1912e+02 secs
  Total Execution time = 7.2405e+03 secs

=========================================================
  A new xml input file : FORM2.s059.cont.xml
