Rank =    0  Free Memory = 90005 MB
Rank =    1  Free Memory = 90005 MB
Rank =    2  Free Memory = 90005 MB
Rank =    3  Free Memory = 90005 MB
Rank =    4  Free Memory = 90005 MB
Rank =    5  Free Memory = 90005 MB
Rank =    6  Free Memory = 90005 MB
Rank =    7  Free Memory = 90005 MB
Rank =    8  Free Memory = 90005 MB
Rank =    9  Free Memory = 90005 MB
Rank =   10  Free Memory = 90005 MB
Rank =   11  Free Memory = 90005 MB
Rank =   12  Free Memory = 90005 MB
Rank =   13  Free Memory = 90005 MB
Rank =   14  Free Memory = 90004 MB
Rank =   15  Free Memory = 89993 MB
Rank =   16  Free Memory = 89992 MB
Rank =   17  Free Memory = 89992 MB
Rank =   18  Free Memory = 89992 MB
Rank =   19  Free Memory = 89991 MB
Rank =   20  Free Memory = 89991 MB
Rank =   21  Free Memory = 89991 MB
Rank =   22  Free Memory = 89991 MB
Rank =   23  Free Memory = 89991 MB
Rank =   24  Free Memory = 89991 MB
Rank =   25  Free Memory = 89990 MB
Rank =   26  Free Memory = 89990 MB
Rank =   27  Free Memory = 89990 MB
Rank =   28  Free Memory = 89990 MB
Rank =   29  Free Memory = 89990 MB
Rank =   30  Free Memory = 89990 MB
Rank =   31  Free Memory = 89990 MB
Rank =   32  Free Memory = 89322 MB
Rank =   33  Free Memory = 89322 MB
Rank =   34  Free Memory = 89322 MB
Rank =   35  Free Memory = 89322 MB
Rank =   36  Free Memory = 89322 MB
Rank =   37  Free Memory = 89322 MB
Rank =   38  Free Memory = 89322 MB
Rank =   39  Free Memory = 89322 MB
Rank =   40  Free Memory = 89322 MB
Rank =   41  Free Memory = 89322 MB
Rank =   42  Free Memory = 89322 MB
Rank =   43  Free Memory = 89322 MB
Rank =   44  Free Memory = 89322 MB
Rank =   45  Free Memory = 89322 MB
Rank =   46  Free Memory = 89322 MB
Rank =   47  Free Memory = 89322 MB
Rank =   48  Free Memory = 89322 MB
Rank =   49  Free Memory = 89322 MB
Rank =   50  Free Memory = 89322 MB
Rank =   51  Free Memory = 89322 MB
Rank =   52  Free Memory = 89322 MB
Rank =   53  Free Memory = 89322 MB
Rank =   54  Free Memory = 89322 MB
Rank =   55  Free Memory = 89322 MB
Rank =   56  Free Memory = 89322 MB
Rank =   57  Free Memory = 89322 MB
Rank =   58  Free Memory = 89322 MB
Rank =   59  Free Memory = 89322 MB
Rank =   60  Free Memory = 89322 MB
Rank =   61  Free Memory = 89322 MB
Rank =   62  Free Memory = 89322 MB
Rank =   63  Free Memory = 89322 MB
Rank =   64  Free Memory = 91170 MB
Rank =   65  Free Memory = 91170 MB
Rank =   66  Free Memory = 91170 MB
Rank =   67  Free Memory = 91170 MB
Rank =   68  Free Memory = 91170 MB
Rank =   69  Free Memory = 91170 MB
Rank =   70  Free Memory = 91170 MB
Rank =   71  Free Memory = 91170 MB
Rank =   72  Free Memory = 91170 MB
Rank =   73  Free Memory = 91170 MB
Rank =   74  Free Memory = 91170 MB
Rank =   75  Free Memory = 91170 MB
Rank =   76  Free Memory = 91170 MB
Rank =   77  Free Memory = 91170 MB
Rank =   78  Free Memory = 91170 MB
Rank =   79  Free Memory = 91170 MB
Rank =   80  Free Memory = 91170 MB
Rank =   81  Free Memory = 91170 MB
Rank =   82  Free Memory = 91170 MB
Rank =   83  Free Memory = 91170 MB
Rank =   84  Free Memory = 91170 MB
Rank =   85  Free Memory = 91170 MB
Rank =   86  Free Memory = 91170 MB
Rank =   87  Free Memory = 91170 MB
Rank =   88  Free Memory = 91170 MB
Rank =   89  Free Memory = 91170 MB
Rank =   90  Free Memory = 91170 MB
Rank =   91  Free Memory = 91170 MB
Rank =   92  Free Memory = 91170 MB
Rank =   93  Free Memory = 91170 MB
Rank =   94  Free Memory = 91170 MB
Rank =   95  Free Memory = 91170 MB
Rank =   96  Free Memory = 89634 MB
Rank =   97  Free Memory = 89634 MB
Rank =   98  Free Memory = 89634 MB
Rank =   99  Free Memory = 89634 MB
Rank =  100  Free Memory = 89634 MB
Rank =  101  Free Memory = 89634 MB
Rank =  102  Free Memory = 89634 MB
Rank =  103  Free Memory = 89634 MB
Rank =  104  Free Memory = 89634 MB
Rank =  105  Free Memory = 89634 MB
Rank =  106  Free Memory = 89634 MB
Rank =  107  Free Memory = 89634 MB
Rank =  108  Free Memory = 89634 MB
Rank =  109  Free Memory = 89634 MB
Rank =  110  Free Memory = 89634 MB
Rank =  111  Free Memory = 89634 MB
Rank =  112  Free Memory = 89634 MB
Rank =  113  Free Memory = 89634 MB
Rank =  114  Free Memory = 89634 MB
Rank =  115  Free Memory = 89634 MB
Rank =  116  Free Memory = 89634 MB
Rank =  117  Free Memory = 89634 MB
Rank =  118  Free Memory = 89634 MB
Rank =  119  Free Memory = 89634 MB
Rank =  120  Free Memory = 89634 MB
Rank =  121  Free Memory = 89634 MB
Rank =  122  Free Memory = 89634 MB
Rank =  123  Free Memory = 89634 MB
Rank =  124  Free Memory = 89634 MB
Rank =  125  Free Memory = 89634 MB
Rank =  126  Free Memory = 89634 MB
Rank =  127  Free Memory = 89634 MB
  Input file(s): opt_form_gs_tett_run002c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run002c.xml

  Project = FORM2
  date    = 2023-03-18 20:46:49 PDT
  host    = n0062.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 425

  Range of prime numbers to use as seeds over processors and threads = 2963-4019


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.659900e-01    1         1 OFF
     uu_1                 1.059606e-01    1         1 OFF
     uu_2                 6.585438e-03    1         1 OFF
     uu_3                -5.283753e-02    1         1 OFF
     uu_4                -8.663707e-02    1         1 OFF
     uu_5                -1.051063e-01    1         1 OFF
     uu_6                -1.113948e-01    1         1 OFF
     uu_7                -1.038544e-01    1         1 OFF
     uu_8                -8.046518e-02    1         1 OFF
     uu_9                -4.288804e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458918e-01    1         1 OFF
     ud_1                 1.068885e-01    1         1 OFF
     ud_2                -9.362422e-03    1         1 OFF
     ud_3                -6.924529e-02    1         1 OFF
     ud_4                -1.012960e-01    1         1 OFF
     ud_5                -1.172753e-01    1         1 OFF
     ud_6                -1.213691e-01    1         1 OFF
     ud_7                -1.120298e-01    1         1 OFF
     ud_8                -8.585231e-02    1         1 OFF
     ud_9                -4.559135e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.506186e-01    1         1 OFF
     eC_1                -3.146073e-01    1         1 OFF
     eC_2                -6.877446e-02    1         1 OFF
     eC_3                 8.858703e-02    1         1 OFF
     eC_4                 1.363007e-01    1         1 OFF
     eC_5                 2.006961e-01    1         1 OFF
     eC_6                 2.136812e-01    1         1 OFF
     eC_7                 1.597089e-01    1         1 OFF
     eC_8                 3.434703e-02    1         1 OFF
     eC_9                 1.047648e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.235916e-01    1         1 OFF
     eO_1                -5.244949e-01    1         1 OFF
     eO_2                -1.331913e-01    1         1 OFF
     eO_3                 1.329657e-01    1         1 OFF
     eO_4                 2.611683e-01    1         1 OFF
     eO_5                 3.461237e-01    1         1 OFF
     eO_6                 3.302408e-01    1         1 OFF
     eO_7                 2.658993e-01    1         1 OFF
     eO_8                 1.071358e-01    1         1 OFF
     eO_9                 2.449963e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.397717e-01    1         1 OFF
     eH1_1                -4.653272e-02    1         1 OFF
     eH1_2                -2.257470e-02    1         1 OFF
     eH1_3                -3.701495e-02    1         1 OFF
     eH1_4                -8.233741e-03    1         1 OFF
     eH1_5                 1.739621e-02    1         1 OFF
     eH1_6                 4.606475e-02    1         1 OFF
     eH1_7                 3.927161e-02    1         1 OFF
     eH1_8                 7.524879e-02    1         1 OFF
     eH1_9                 6.186013e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.394482e-01    1         1 OFF
     eH2_1                -4.450287e-02    1         1 OFF
     eH2_2                -2.173021e-02    1         1 OFF
     eH2_3                -3.498437e-02    1         1 OFF
     eH2_4                -6.920902e-03    1         1 OFF
     eH2_5                 2.004559e-02    1         1 OFF
     eH2_6                 4.945828e-02    1         1 OFF
     eH2_7                 4.370990e-02    1         1 OFF
     eH2_8                 6.697447e-02    1         1 OFF
     eH2_9                 6.199319e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.710481e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.4701e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8327
    reference variance = 0.321032
====================================================
  Execution time = 2.7398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4933e-01
  Total weights = 1.964832743e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437768797910
                                         uncertainty =       0.001979332104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437768797910
                                         uncertainty =       0.001979332104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467808311
  error estimate for blocks of size 2^( 2) =       0.000493099933
  error estimate for blocks of size 2^( 3) =       0.000516804307
  error estimate for blocks of size 2^( 4) =       0.000535144912
  error estimate for blocks of size 2^( 5) =       0.000547592927
  error estimate for blocks of size 2^( 6) =       0.000553728869
  error estimate for blocks of size 2^( 7) =       0.000558566363

      target function =      -0.745896106518
              le_mean =     -22.813731960753
             les_mean =     520.915698032399
             stat err =       0.000548758268
             autocorr =       1.376024878648
   target nu stat err =       0.000548758268
   target dn stat err =       0.002783453721
      target stat err =       0.002379249644
              std dev =       0.661580858278
             le_variance =       0.437689232040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281373196075e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745902754885       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745970174040       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745980868497       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745984033536       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745984661143       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745984611343       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745984798815       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745984788455       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745984735573       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745984732837       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.042902e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745902754885       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745922009259       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745924917352       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745925751912       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745925895888       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745925873990       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745925917093       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745925913022       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745925901014       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.815702e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745902754885       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745907746105       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745908488994       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745908700263       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745908735128       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745908729023       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745908739515       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745908738402       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745908735498       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 7.185827e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2061e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_01 1.081514e-01                 3 1 ON  0
ci_02 -2.404603e-02                3 1 ON  1
ci_03 -2.437706e-02                3 1 ON  2
ci_04 2.222520e-02                 3 1 ON  3
ci_05 -1.919541e-02                3 1 ON  4
ci_06 -1.958599e-02                3 1 ON  5
ci_07 2.581929e-02                 3 1 ON  6
ci_08 -4.220770e-03                3 1 ON  7
ci_09 -7.503726e-03                3 1 ON  8
ci_10 -7.739992e-03                3 1 ON  9
ci_11 1.374528e-02                 3 1 ON  10
ci_12 7.053832e-03                 3 1 ON  11
ci_13 1.384805e-02                 3 1 ON  12
ci_14 1.280133e-02                 3 1 ON  13
ci_15 5.261079e-03                 3 1 ON  14
ci_16 5.762860e-03                 3 1 ON  15
ci_17 -5.039769e-03                3 1 ON  16
ci_18 -5.543872e-03                3 1 ON  17
ci_19 1.028452e-02                 3 1 ON  18
ci_20 6.251121e-03                 3 1 ON  19
ci_21 8.473909e-03                 3 1 ON  20
ci_22 8.904713e-03                 3 1 ON  21
ci_23 4.179171e-03                 3 1 ON  22
ci_24 5.210378e-03                 3 1 ON  23
ci_25 3.035484e-03                 3 1 ON  24
ci_26 3.773567e-03                 3 1 ON  25
ci_27 3.275661e-03                 3 1 ON  26
ci_28 8.075707e-04                 3 1 ON  27
ci_29 1.149334e-03                 3 1 ON  28
ci_30 -7.283993e-04                3 1 ON  29
ci_31 1.021012e-03                 3 1 ON  30
ci_32 -5.444295e-04                3 1 ON  31
ci_33 -1.028840e-03                3 1 ON  32
ci_34 1.105803e-03                 3 1 ON  33
ci_35 1.247015e-03                 3 1 ON  34
ci_36 -5.786718e-04                3 1 ON  35
ci_37 -5.164243e-04                3 1 ON  36
ci_38 -2.759361e-04                3 1 ON  37
ci_39 -1.566205e-04                3 1 ON  38
ci_40 -1.902417e-03                3 1 ON  39
ci_41 -5.138856e-04                3 1 ON  40
ci_42 -1.634904e-03                3 1 ON  41
ci_43 -1.356324e-03                3 1 ON  42
ci_44 -2.154337e-03                3 1 ON  43
ci_45 -2.829039e-04                3 1 ON  44
ci_46 -1.679179e-03                3 1 ON  45
ci_47 1.440738e-03                 3 1 ON  46
ci_48 2.897666e-03                 3 1 ON  47
ci_49 -8.487032e-04                3 1 ON  48
ci_50 -8.029208e-04                3 1 ON  49
ci_51 -5.175798e-04                3 1 ON  50
ci_52 -6.377702e-04                3 1 ON  51
ci_53 -8.035502e-04                3 1 ON  52
ci_54 -1.088472e-03                3 1 ON  53
ci_55 -1.219590e-03                3 1 ON  54
ci_56 1.136449e-03                 3 1 ON  55
ci_57 2.127183e-03                 3 1 ON  56
ci_58 -2.043821e-04                3 1 ON  57
ci_59 -6.490338e-04                3 1 ON  58
ci_60 1.703147e-04                 3 1 ON  59
ci_61 -9.810052e-04                3 1 ON  60
ci_62 -3.970339e-04                3 1 ON  61
ci_63 -2.533232e-04                3 1 ON  62
ci_64 -5.994549e-04                3 1 ON  63
ci_65 -1.283353e-04                3 1 ON  64
ci_66 -1.418895e-04                3 1 ON  65
ci_67 -1.934938e-04                3 1 ON  66
ci_68 -1.790276e-03                3 1 ON  67
ci_69 -1.746944e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7829
    reference variance = 0.425449
====================================================
  Execution time = 2.5116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4566e-01
  Total weights = 1.9646e+06
  Execution time = 3.5658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0807453
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432483001451
                                         uncertainty =       0.001843355959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432483001451
                                         uncertainty =       0.001843355959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465023449
  error estimate for blocks of size 2^( 2) =       0.000490525057
  error estimate for blocks of size 2^( 3) =       0.000515025061
  error estimate for blocks of size 2^( 4) =       0.000534278719
  error estimate for blocks of size 2^( 5) =       0.000545326395
  error estimate for blocks of size 2^( 6) =       0.000551300870
  error estimate for blocks of size 2^( 7) =       0.000556804919

      target function =      -0.746774810016
              le_mean =     -22.814117126611
             les_mean =     520.932210766779
             stat err =       0.000546927725
             autocorr =       1.383280242172
   target nu stat err =       0.000546927725
   target dn stat err =       0.003126803018
      target stat err =       0.002661724092
              std dev =       0.657642468099
             le_variance =       0.432493615847

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00250444
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432355499811
                                         uncertainty =       0.001851605864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432355499811
                                         uncertainty =       0.001851605864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464956024
  error estimate for blocks of size 2^( 2) =       0.000490399152
  error estimate for blocks of size 2^( 3) =       0.000514839698
  error estimate for blocks of size 2^( 4) =       0.000534057747
  error estimate for blocks of size 2^( 5) =       0.000545085545
  error estimate for blocks of size 2^( 6) =       0.000551050955
  error estimate for blocks of size 2^( 7) =       0.000556547298

      target function =      -0.748029981188
              le_mean =     -22.814117614933
             les_mean =     520.930723684870
             stat err =       0.000546685386
             autocorr =       1.382455536478
   target nu stat err =       0.000546685386
   target dn stat err =       0.002734935288
      target stat err =       0.002354217912
              std dev =       0.657547114990
             le_variance =       0.432368208432

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0834703
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432402400602
                                         uncertainty =       0.001847461153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432402400602
                                         uncertainty =       0.001847461153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464980748
  error estimate for blocks of size 2^( 2) =       0.000490449283
  error estimate for blocks of size 2^( 3) =       0.000514916259
  error estimate for blocks of size 2^( 4) =       0.000534151223
  error estimate for blocks of size 2^( 5) =       0.000545188806
  error estimate for blocks of size 2^( 6) =       0.000551158038
  error estimate for blocks of size 2^( 7) =       0.000556658971

      target function =      -0.741936199552
              le_mean =     -22.814115384674
             les_mean =     520.937935887047
             stat err =       0.000546789260
             autocorr =       1.382833864828
   target nu stat err =       0.000546789260
   target dn stat err =       0.008640864528
      target stat err =       0.007095489981
              std dev =       0.657582080276
             le_variance =       0.432414192300

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.25775
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432471014498
                                         uncertainty =       0.001843863252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432471014498
                                         uncertainty =       0.001843863252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465017087
  error estimate for blocks of size 2^( 2) =       0.000490514407
  error estimate for blocks of size 2^( 3) =       0.000515010124
  error estimate for blocks of size 2^( 4) =       0.000534261465
  error estimate for blocks of size 2^( 5) =       0.000545307481
  error estimate for blocks of size 2^( 6) =       0.000551281573
  error estimate for blocks of size 2^( 7) =       0.000556785135

      target function =      -0.748819421031
              le_mean =     -22.814116990877
             les_mean =     520.929747546256
             stat err =       0.000546908914
             autocorr =       1.383222932806
   target nu stat err =       0.000546908914
   target dn stat err =       0.002629246027
      target stat err =       0.002274101668
              std dev =       0.657633471265
             le_variance =       0.432481782528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746774810016        initial
     2.5000e-01     2.5000e+00             1.0429e-03        -0.748029981188
     1.0000e+00     1.0000e+01             2.8157e-04        -0.741936199552
     4.0000e+00     4.0000e+01             7.1858e-05        -0.748819421031  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2952e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_01                 1.079417e-01 3 1  ON 0
ci_02                -2.393946e-02 3 1  ON 1
ci_03                -2.422830e-02 3 1  ON 2
ci_04                 2.211459e-02 3 1  ON 3
ci_05                -1.910949e-02 3 1  ON 4
ci_06                -1.950788e-02 3 1  ON 5
ci_07                 2.574060e-02 3 1  ON 6
ci_08                -4.218018e-03 3 1  ON 7
ci_09                -7.540766e-03 3 1  ON 8
ci_10                -7.697162e-03 3 1  ON 9
ci_11                 1.375874e-02 3 1  ON 10
ci_12                 7.039162e-03 3 1  ON 11
ci_13                 1.383970e-02 3 1  ON 12
ci_14                 1.280504e-02 3 1  ON 13
ci_15                 5.154197e-03 3 1  ON 14
ci_16                 5.726142e-03 3 1  ON 15
ci_17                -5.003695e-03 3 1  ON 16
ci_18                -5.552923e-03 3 1  ON 17
ci_19                 1.032885e-02 3 1  ON 18
ci_20                 6.238702e-03 3 1  ON 19
ci_21                 8.460499e-03 3 1  ON 20
ci_22                 8.881297e-03 3 1  ON 21
ci_23                 4.146478e-03 3 1  ON 22
ci_24                 5.211966e-03 3 1  ON 23
ci_25                 3.031373e-03 3 1  ON 24
ci_26                 3.806024e-03 3 1  ON 25
ci_27                 3.287868e-03 3 1  ON 26
ci_28                 7.690818e-04 3 1  ON 27
ci_29                 1.179981e-03 3 1  ON 28
ci_30                -7.231864e-04 3 1  ON 29
ci_31                 1.052590e-03 3 1  ON 30
ci_32                -5.298507e-04 3 1  ON 31
ci_33                -1.016438e-03 3 1  ON 32
ci_34                 1.160452e-03 3 1  ON 33
ci_35                 1.267660e-03 3 1  ON 34
ci_36                -5.570137e-04 3 1  ON 35
ci_37                -5.076199e-04 3 1  ON 36
ci_38                -2.764548e-04 3 1  ON 37
ci_39                -1.563850e-04 3 1  ON 38
ci_40                -1.917378e-03 3 1  ON 39
ci_41                -4.857924e-04 3 1  ON 40
ci_42                -1.665376e-03 3 1  ON 41
ci_43                -1.291496e-03 3 1  ON 42
ci_44                -2.181480e-03 3 1  ON 43
ci_45                -2.611495e-04 3 1  ON 44
ci_46                -1.706698e-03 3 1  ON 45
ci_47                 1.420718e-03 3 1  ON 46
ci_48                 2.900014e-03 3 1  ON 47
ci_49                -8.480588e-04 3 1  ON 48
ci_50                -8.200629e-04 3 1  ON 49
ci_51                -5.796884e-04 3 1  ON 50
ci_52                -6.500881e-04 3 1  ON 51
ci_53                -7.961106e-04 3 1  ON 52
ci_54                -1.099466e-03 3 1  ON 53
ci_55                -1.254958e-03 3 1  ON 54
ci_56                 1.087395e-03 3 1  ON 55
ci_57                 2.098637e-03 3 1  ON 56
ci_58                -1.887676e-04 3 1  ON 57
ci_59                -6.076896e-04 3 1  ON 58
ci_60                 1.524686e-04 3 1  ON 59
ci_61                -1.005603e-03 3 1  ON 60
ci_62                -3.909708e-04 3 1  ON 61
ci_63                -2.396578e-04 3 1  ON 62
ci_64                -6.102990e-04 3 1  ON 63
ci_65                -1.078845e-04 3 1  ON 64
ci_66                -1.207950e-04 3 1  ON 65
ci_67                -1.934693e-04 3 1  ON 66
ci_68                -1.805478e-03 3 1  ON 67
ci_69                -1.790783e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7436
    reference variance = 0.360317
====================================================
  Execution time = 2.7175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5350e-01
  Total weights = 1.964753181e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440595765636
                                         uncertainty =       0.002492811813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440595765636
                                         uncertainty =       0.002492811813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469345043
  error estimate for blocks of size 2^( 2) =       0.000495070048
  error estimate for blocks of size 2^( 3) =       0.000519975107
  error estimate for blocks of size 2^( 4) =       0.000537779552
  error estimate for blocks of size 2^( 5) =       0.000549882521
  error estimate for blocks of size 2^( 6) =       0.000556657675
  error estimate for blocks of size 2^( 7) =       0.000558774820

      target function =      -0.742463650257
              le_mean =     -22.813819380537
             les_mean =     520.923857164912
             stat err =       0.000550773642
             autocorr =       1.377088415640
   target nu stat err =       0.000550773642
   target dn stat err =       0.003142283930
      target stat err =       0.002644025901
              std dev =       0.663754125825
             le_variance =       0.440569539550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281381938054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742472120577       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742495954208       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742500059803       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742501354244       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742501477153       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742501432593       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742501365365       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742501364612       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742501360313       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742501360834       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.177984e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742472120577       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742478301280       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742479349103       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742479674326       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742479702099       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742479690601       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742479673910       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742479673758       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742479672750       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742479672872       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 8.100093e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742472120577       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742473680300       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742473943616       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742474025009       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742474031760       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742474028863       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742474024699       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742474024663       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742474024416       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742474024446       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.034977e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1872e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7593
    reference variance = 0.434898
====================================================
  Execution time = 2.5024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5031e-01
  Total weights = 1.9646e+06
  Execution time = 3.5418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437916304993
                                         uncertainty =       0.002868657586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437916304993
                                         uncertainty =       0.002868657586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467881991
  error estimate for blocks of size 2^( 2) =       0.000493527555
  error estimate for blocks of size 2^( 3) =       0.000518013920
  error estimate for blocks of size 2^( 4) =       0.000536596620
  error estimate for blocks of size 2^( 5) =       0.000548630618
  error estimate for blocks of size 2^( 6) =       0.000554218357
  error estimate for blocks of size 2^( 7) =       0.000555944155

      target function =      -0.745011193724
              le_mean =     -22.813717299841
             les_mean =     520.916098314319
             stat err =       0.000548847437
             autocorr =       1.376038620670
   target nu stat err =       0.000548847437
   target dn stat err =       0.003213284519
      target stat err =       0.002717854756
              std dev =       0.661685056948
             le_variance =       0.437827114589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437871426274
                                         uncertainty =       0.002864347283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437871426274
                                         uncertainty =       0.002864347283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467857998
  error estimate for blocks of size 2^( 2) =       0.000493486464
  error estimate for blocks of size 2^( 3) =       0.000517954471
  error estimate for blocks of size 2^( 4) =       0.000536521894
  error estimate for blocks of size 2^( 5) =       0.000548546490
  error estimate for blocks of size 2^( 6) =       0.000554135303
  error estimate for blocks of size 2^( 7) =       0.000555856244

      target function =      -0.744878743578
              le_mean =     -22.813715687202
             les_mean =     520.916185404151
             stat err =       0.000548764983
             autocorr =       1.375766296596
   target nu stat err =       0.000548764983
   target dn stat err =       0.003214896280
      target stat err =       0.002718180453
              std dev =       0.661651125819
             le_variance =       0.437782212298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437892393147
                                         uncertainty =       0.002866459393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437892393147
                                         uncertainty =       0.002866459393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467869207
  error estimate for blocks of size 2^( 2) =       0.000493505945
  error estimate for blocks of size 2^( 3) =       0.000517982893
  error estimate for blocks of size 2^( 4) =       0.000536557718
  error estimate for blocks of size 2^( 5) =       0.000548587087
  error estimate for blocks of size 2^( 6) =       0.000554175365
  error estimate for blocks of size 2^( 7) =       0.000555898541

      target function =      -0.745082409030
              le_mean =     -22.813716376180
             les_mean =     520.915969841732
             stat err =       0.000548804678
             autocorr =       1.375899404430
   target nu stat err =       0.000548804678
   target dn stat err =       0.003206162764
      target stat err =       0.002712623238
              std dev =       0.661666978530
             le_variance =       0.437803190476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437913197287
                                         uncertainty =       0.002868379901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437913197287
                                         uncertainty =       0.002868379901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467880329
  error estimate for blocks of size 2^( 2) =       0.000493524773
  error estimate for blocks of size 2^( 3) =       0.000518009951
  error estimate for blocks of size 2^( 4) =       0.000536591645
  error estimate for blocks of size 2^( 5) =       0.000548625071
  error estimate for blocks of size 2^( 6) =       0.000554212854
  error estimate for blocks of size 2^( 7) =       0.000555938312

      target function =      -0.745048185416
              le_mean =     -22.813717174721
             les_mean =     520.916047745255
             stat err =       0.000548841970
             autocorr =       1.376020979029
   target nu stat err =       0.000548841970
   target dn stat err =       0.003212047566
      target stat err =       0.002717121958
              std dev =       0.661682707505
             le_variance =       0.437824005411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745011193724        initial
     1.0000e+00     1.0000e+01             3.1780e-04        -0.744878743578
     4.0000e+00     4.0000e+01             8.1001e-05        -0.745082409030  <--
     1.6000e+01     1.6000e+02             2.0350e-05        -0.745048185416

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.2788e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2780e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8276
    reference variance = 0.620272
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4537e-01
  Total weights = 1.964687657e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435611487520
                                         uncertainty =       0.003574911303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435611487520
                                         uncertainty =       0.003574911303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466697776
  error estimate for blocks of size 2^( 2) =       0.000492108052
  error estimate for blocks of size 2^( 3) =       0.000516338859
  error estimate for blocks of size 2^( 4) =       0.000534555390
  error estimate for blocks of size 2^( 5) =       0.000546824510
  error estimate for blocks of size 2^( 6) =       0.000553966319
  error estimate for blocks of size 2^( 7) =       0.000556555929

      target function =      -0.749180750926
              le_mean =     -22.814469674608
             les_mean =     520.945400145456
             stat err =       0.000547975537
             autocorr =       1.378640013126
   target nu stat err =       0.000547975537
   target dn stat err =       0.004001498952
      target stat err =       0.003395071344
              std dev =       0.660010324463
             le_variance =       0.435613628398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281446967461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749195216725       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749221448420       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749226176678       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749227239827       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749227664067       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749227728858       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749227748784       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749227750819       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749227755877       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.217274e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749195216725       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749202025342       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749203235402       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749203504171       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749203608763       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749203623752       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749203628378       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749203628869       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749203630081       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 8.204853e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749195216725       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749196935303       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749197239607       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749197306980       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749197333025       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749197336694       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749197337828       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749197337949       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749197338249       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.061593e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0108e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_01                 1.081047e-01 3 1  ON 0
ci_02                -2.403846e-02 3 1  ON 1
ci_03                -2.432592e-02 3 1  ON 2
ci_04                 2.219349e-02 3 1  ON 3
ci_05                -1.916468e-02 3 1  ON 4
ci_06                -1.955603e-02 3 1  ON 5
ci_07                 2.575324e-02 3 1  ON 6
ci_08                -4.233820e-03 3 1  ON 7
ci_09                -7.545582e-03 3 1  ON 8
ci_10                -7.699908e-03 3 1  ON 9
ci_11                 1.373242e-02 3 1  ON 10
ci_12                 7.026516e-03 3 1  ON 11
ci_13                 1.382223e-02 3 1  ON 12
ci_14                 1.281539e-02 3 1  ON 13
ci_15                 5.189664e-03 3 1  ON 14
ci_16                 5.763200e-03 3 1  ON 15
ci_17                -5.025691e-03 3 1  ON 16
ci_18                -5.548294e-03 3 1  ON 17
ci_19                 1.034397e-02 3 1  ON 18
ci_20                 6.256577e-03 3 1  ON 19
ci_21                 8.479824e-03 3 1  ON 20
ci_22                 8.873366e-03 3 1  ON 21
ci_23                 4.182879e-03 3 1  ON 22
ci_24                 5.194223e-03 3 1  ON 23
ci_25                 3.018528e-03 3 1  ON 24
ci_26                 3.804080e-03 3 1  ON 25
ci_27                 3.279473e-03 3 1  ON 26
ci_28                 7.905498e-04 3 1  ON 27
ci_29                 1.175578e-03 3 1  ON 28
ci_30                -7.384191e-04 3 1  ON 29
ci_31                 1.027773e-03 3 1  ON 30
ci_32                -5.413685e-04 3 1  ON 31
ci_33                -1.044623e-03 3 1  ON 32
ci_34                 1.129391e-03 3 1  ON 33
ci_35                 1.272742e-03 3 1  ON 34
ci_36                -5.774891e-04 3 1  ON 35
ci_37                -5.244782e-04 3 1  ON 36
ci_38                -2.986041e-04 3 1  ON 37
ci_39                -1.404938e-04 3 1  ON 38
ci_40                -1.907836e-03 3 1  ON 39
ci_41                -5.198875e-04 3 1  ON 40
ci_42                -1.646271e-03 3 1  ON 41
ci_43                -1.293364e-03 3 1  ON 42
ci_44                -2.174251e-03 3 1  ON 43
ci_45                -2.742126e-04 3 1  ON 44
ci_46                -1.664997e-03 3 1  ON 45
ci_47                 1.452438e-03 3 1  ON 46
ci_48                 2.893750e-03 3 1  ON 47
ci_49                -8.598874e-04 3 1  ON 48
ci_50                -8.119489e-04 3 1  ON 49
ci_51                -5.526251e-04 3 1  ON 50
ci_52                -6.204748e-04 3 1  ON 51
ci_53                -8.024819e-04 3 1  ON 52
ci_54                -1.105648e-03 3 1  ON 53
ci_55                -1.237949e-03 3 1  ON 54
ci_56                 1.118885e-03 3 1  ON 55
ci_57                 2.101388e-03 3 1  ON 56
ci_58                -1.973434e-04 3 1  ON 57
ci_59                -6.265028e-04 3 1  ON 58
ci_60                 1.191414e-04 3 1  ON 59
ci_61                -9.758810e-04 3 1  ON 60
ci_62                -3.681125e-04 3 1  ON 61
ci_63                -2.641257e-04 3 1  ON 62
ci_64                -6.083541e-04 3 1  ON 63
ci_65                -1.032993e-04 3 1  ON 64
ci_66                -1.254061e-04 3 1  ON 65
ci_67                -1.889719e-04 3 1  ON 66
ci_68                -1.810283e-03 3 1  ON 67
ci_69                -1.801532e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.812
    reference variance = 0.332392
====================================================
  Execution time = 2.4947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4448e-01
  Total weights = 1.9647e+06
  Execution time = 3.6009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432802711109
                                         uncertainty =       0.002266569722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432802711109
                                         uncertainty =       0.002266569722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465165692
  error estimate for blocks of size 2^( 2) =       0.000491212857
  error estimate for blocks of size 2^( 3) =       0.000515965986
  error estimate for blocks of size 2^( 4) =       0.000534295532
  error estimate for blocks of size 2^( 5) =       0.000544835419
  error estimate for blocks of size 2^( 6) =       0.000550611086
  error estimate for blocks of size 2^( 7) =       0.000554168945

      target function =      -0.749925611695
              le_mean =     -22.814523020552
             les_mean =     520.946952772648
             stat err =       0.000545977746
             autocorr =       1.377636145637
   target nu stat err =       0.000545977746
   target dn stat err =       0.002763671411
      target stat err =       0.002390222666
              std dev =       0.657843630725
             le_variance =       0.432758242485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432783404184
                                         uncertainty =       0.002266788104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432783404184
                                         uncertainty =       0.002266788104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465155100
  error estimate for blocks of size 2^( 2) =       0.000491183526
  error estimate for blocks of size 2^( 3) =       0.000515918814
  error estimate for blocks of size 2^( 4) =       0.000534235265
  error estimate for blocks of size 2^( 5) =       0.000544765338
  error estimate for blocks of size 2^( 6) =       0.000550543495
  error estimate for blocks of size 2^( 7) =       0.000554102513

      target function =      -0.747867890715
              le_mean =     -22.814523491352
             les_mean =     520.949435692080
             stat err =       0.000545911653
             autocorr =       1.377365358490
   target nu stat err =       0.000545911653
   target dn stat err =       0.003582359585
      target stat err =       0.003040898327
              std dev =       0.657828650441
             le_variance =       0.432738533341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432791837111
                                         uncertainty =       0.002266660756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432791837111
                                         uncertainty =       0.002266660756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465159736
  error estimate for blocks of size 2^( 2) =       0.000491197236
  error estimate for blocks of size 2^( 3) =       0.000515941158
  error estimate for blocks of size 2^( 4) =       0.000534263937
  error estimate for blocks of size 2^( 5) =       0.000544798892
  error estimate for blocks of size 2^( 6) =       0.000550575680
  error estimate for blocks of size 2^( 7) =       0.000554134271

      target function =      -0.749903675585
              le_mean =     -22.814523107950
             les_mean =     520.946982918498
             stat err =       0.000545943195
             autocorr =       1.377497071887
   target nu stat err =       0.000545943195
   target dn stat err =       0.002775647548
      target stat err =       0.002399764544
              std dev =       0.657835206793
             le_variance =       0.432747159297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432801243377
                                         uncertainty =       0.002266579366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432801243377
                                         uncertainty =       0.002266579366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465164889
  error estimate for blocks of size 2^( 2) =       0.000491210832
  error estimate for blocks of size 2^( 3) =       0.000515962818
  error estimate for blocks of size 2^( 4) =       0.000534291522
  error estimate for blocks of size 2^( 5) =       0.000544830788
  error estimate for blocks of size 2^( 6) =       0.000550606630
  error estimate for blocks of size 2^( 7) =       0.000554164652

      target function =      -0.749905911304
              le_mean =     -22.814523030094
             les_mean =     520.946976755515
             stat err =       0.000545973398
             autocorr =       1.377618963894
   target nu stat err =       0.000545973398
   target dn stat err =       0.002765103020
      target stat err =       0.002391257750
              std dev =       0.657842495031
             le_variance =       0.432756748269


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749925611695        initial  <--
     1.0000e+00     1.0000e+01             3.2173e-04        -0.747867890715
     4.0000e+00     4.0000e+01             8.2049e-05        -0.749903675585
     1.6000e+01     1.6000e+02             2.0616e-05        -0.749905911304

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8823
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2997e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2793e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7242
    reference variance = 0.360574
====================================================
  Execution time = 2.5607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4907e-01
  Total weights = 1.964831752e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437710047253
                                         uncertainty =       0.002205388486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437710047253
                                         uncertainty =       0.002205388486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467780168
  error estimate for blocks of size 2^( 2) =       0.000493688639
  error estimate for blocks of size 2^( 3) =       0.000517932626
  error estimate for blocks of size 2^( 4) =       0.000536325219
  error estimate for blocks of size 2^( 5) =       0.000547112536
  error estimate for blocks of size 2^( 6) =       0.000553526238
  error estimate for blocks of size 2^( 7) =       0.000559794501

      target function =      -0.746122183702
              le_mean =     -22.815056575734
             les_mean =     520.975872616540
             stat err =       0.000549189623
             autocorr =       1.378354836607
   target nu stat err =       0.000549189623
   target dn stat err =       0.002614979396
      target stat err =       0.002250792918
              std dev =       0.661541057834
             le_variance =       0.437636571200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281505657573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746128003085       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746130287913       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746130641409       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746130690788       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746130732930       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746130736256       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746130737949       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746130740700       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746130740511       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746130740805       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.655920e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746128003085       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746128576434       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746128664996       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746128677343       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746128687874       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746128688696       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746128689116       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746128689803       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746128689755       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746128689829       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 6.653267e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746128003085       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746128146557       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746128168709       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746128171796       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746128174429       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746128174634       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746128174739       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746128174910       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746128174898       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746128174916       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 1.664161e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4262e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_01                 1.080293e-01 3 1  ON 0
ci_02                -2.400317e-02 3 1  ON 1
ci_03                -2.427937e-02 3 1  ON 2
ci_04                 2.215744e-02 3 1  ON 3
ci_05                -1.913260e-02 3 1  ON 4
ci_06                -1.952864e-02 3 1  ON 5
ci_07                 2.575562e-02 3 1  ON 6
ci_08                -4.225038e-03 3 1  ON 7
ci_09                -7.550449e-03 3 1  ON 8
ci_10                -7.704374e-03 3 1  ON 9
ci_11                 1.374707e-02 3 1  ON 10
ci_12                 7.048274e-03 3 1  ON 11
ci_13                 1.381712e-02 3 1  ON 12
ci_14                 1.281197e-02 3 1  ON 13
ci_15                 5.169275e-03 3 1  ON 14
ci_16                 5.733823e-03 3 1  ON 15
ci_17                -5.018107e-03 3 1  ON 16
ci_18                -5.547511e-03 3 1  ON 17
ci_19                 1.032811e-02 3 1  ON 18
ci_20                 6.253080e-03 3 1  ON 19
ci_21                 8.485640e-03 3 1  ON 20
ci_22                 8.880308e-03 3 1  ON 21
ci_23                 4.169280e-03 3 1  ON 22
ci_24                 5.185929e-03 3 1  ON 23
ci_25                 3.012228e-03 3 1  ON 24
ci_26                 3.792659e-03 3 1  ON 25
ci_27                 3.288369e-03 3 1  ON 26
ci_28                 7.717504e-04 3 1  ON 27
ci_29                 1.187285e-03 3 1  ON 28
ci_30                -7.414213e-04 3 1  ON 29
ci_31                 1.033908e-03 3 1  ON 30
ci_32                -5.349263e-04 3 1  ON 31
ci_33                -1.033244e-03 3 1  ON 32
ci_34                 1.152233e-03 3 1  ON 33
ci_35                 1.248267e-03 3 1  ON 34
ci_36                -5.666099e-04 3 1  ON 35
ci_37                -5.187927e-04 3 1  ON 36
ci_38                -2.858368e-04 3 1  ON 37
ci_39                -1.425795e-04 3 1  ON 38
ci_40                -1.906196e-03 3 1  ON 39
ci_41                -5.146233e-04 3 1  ON 40
ci_42                -1.648221e-03 3 1  ON 41
ci_43                -1.293248e-03 3 1  ON 42
ci_44                -2.176852e-03 3 1  ON 43
ci_45                -2.657644e-04 3 1  ON 44
ci_46                -1.693068e-03 3 1  ON 45
ci_47                 1.436707e-03 3 1  ON 46
ci_48                 2.893916e-03 3 1  ON 47
ci_49                -8.552244e-04 3 1  ON 48
ci_50                -8.207287e-04 3 1  ON 49
ci_51                -5.668587e-04 3 1  ON 50
ci_52                -6.304725e-04 3 1  ON 51
ci_53                -8.005956e-04 3 1  ON 52
ci_54                -1.110064e-03 3 1  ON 53
ci_55                -1.236362e-03 3 1  ON 54
ci_56                 1.098741e-03 3 1  ON 55
ci_57                 2.090493e-03 3 1  ON 56
ci_58                -1.875292e-04 3 1  ON 57
ci_59                -6.206628e-04 3 1  ON 58
ci_60                 1.283494e-04 3 1  ON 59
ci_61                -9.867801e-04 3 1  ON 60
ci_62                -3.812965e-04 3 1  ON 61
ci_63                -2.483300e-04 3 1  ON 62
ci_64                -6.088919e-04 3 1  ON 63
ci_65                -1.065436e-04 3 1  ON 64
ci_66                -1.264264e-04 3 1  ON 65
ci_67                -1.929902e-04 3 1  ON 66
ci_68                -1.798442e-03 3 1  ON 67
ci_69                -1.806921e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7621
    reference variance = 0.723492
====================================================
  Execution time = 2.5150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5891e-01
  Total weights = 1.9650e+06
  Execution time = 3.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438702099551
                                         uncertainty =       0.002358829090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438702099551
                                         uncertainty =       0.002358829090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468377701
  error estimate for blocks of size 2^( 2) =       0.000494071296
  error estimate for blocks of size 2^( 3) =       0.000519211933
  error estimate for blocks of size 2^( 4) =       0.000538148341
  error estimate for blocks of size 2^( 5) =       0.000549144151
  error estimate for blocks of size 2^( 6) =       0.000553536857
  error estimate for blocks of size 2^( 7) =       0.000560633157

      target function =      -0.738014846003
              le_mean =     -22.815075238795
             les_mean =     520.986566440367
             stat err =       0.000550365627
             autocorr =       1.380734523190
   target nu stat err =       0.000550365627
   target dn stat err =       0.007286365410
      target stat err =       0.005937864837
              std dev =       0.662386096377
             le_variance =       0.438755340673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438700430697
                                         uncertainty =       0.002358913333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438700430697
                                         uncertainty =       0.002358913333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468376818
  error estimate for blocks of size 2^( 2) =       0.000494068775
  error estimate for blocks of size 2^( 3) =       0.000519207872
  error estimate for blocks of size 2^( 4) =       0.000538142720
  error estimate for blocks of size 2^( 5) =       0.000549137637
  error estimate for blocks of size 2^( 6) =       0.000553530159
  error estimate for blocks of size 2^( 7) =       0.000560626022

      target function =      -0.737996928186
              le_mean =     -22.815075213790
             les_mean =     520.986587577065
             stat err =       0.000550359134
             autocorr =       1.380707151082
   target nu stat err =       0.000550359134
   target dn stat err =       0.007275544960
      target stat err =       0.005928849936
              std dev =       0.662384848268
             le_variance =       0.438753687215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438701256287
                                         uncertainty =       0.002358871424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438701256287
                                         uncertainty =       0.002358871424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468377255
  error estimate for blocks of size 2^( 2) =       0.000494070028
  error estimate for blocks of size 2^( 3) =       0.000519209892
  error estimate for blocks of size 2^( 4) =       0.000538145517
  error estimate for blocks of size 2^( 5) =       0.000549140880
  error estimate for blocks of size 2^( 6) =       0.000553533494
  error estimate for blocks of size 2^( 7) =       0.000560629574

      target function =      -0.738010195866
              le_mean =     -22.815075225080
             les_mean =     520.986571638447
             stat err =       0.000550362366
             autocorr =       1.380720793443
   target nu stat err =       0.000550362366
   target dn stat err =       0.007280901665
      target stat err =       0.005933383010
              std dev =       0.662385465666
             le_variance =       0.438754505125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438701993256
                                         uncertainty =       0.002358834356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438701993256
                                         uncertainty =       0.002358834356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468377644
  error estimate for blocks of size 2^( 2) =       0.000494071137
  error estimate for blocks of size 2^( 3) =       0.000519211677
  error estimate for blocks of size 2^( 4) =       0.000538147987
  error estimate for blocks of size 2^( 5) =       0.000549143742
  error estimate for blocks of size 2^( 6) =       0.000553536436
  error estimate for blocks of size 2^( 7) =       0.000560632709

      target function =      -0.738014404438
              le_mean =     -22.815075236943
             les_mean =     520.986566911587
             stat err =       0.000550365218
             autocorr =       1.380732805617
   target nu stat err =       0.000550365218
   target dn stat err =       0.007285677333
      target stat err =       0.005937302715
              std dev =       0.662386016869
             le_variance =       0.438755235343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738014846003        initial  <--
     1.0000e+01     1.0000e+02             2.6559e-05        -0.737996928186
     4.0000e+01     4.0000e+02             6.6533e-06        -0.738010195866
     1.6000e+02     1.6000e+03             1.6642e-06        -0.738014404438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7771
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2781e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8136
    reference variance = 0.48221
====================================================
  Execution time = 2.5758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4620e-01
  Total weights = 1.964900933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433791934731
                                         uncertainty =       0.002079789443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433791934731
                                         uncertainty =       0.002079789443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465766849
  error estimate for blocks of size 2^( 2) =       0.000491360832
  error estimate for blocks of size 2^( 3) =       0.000515382783
  error estimate for blocks of size 2^( 4) =       0.000533392969
  error estimate for blocks of size 2^( 5) =       0.000544675413
  error estimate for blocks of size 2^( 6) =       0.000553621443
  error estimate for blocks of size 2^( 7) =       0.000555449958

      target function =      -0.748502094947
              le_mean =     -22.814523745647
             les_mean =     520.948688884471
             stat err =       0.000546784946
             autocorr =       1.378148284810
   target nu stat err =       0.000546784946
   target dn stat err =       0.003114406356
      target stat err =       0.002665254631
              std dev =       0.658693794756
             le_variance =       0.433877515250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281452374565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748510564534       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748510755260       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748510782861       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748510792965       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748510795953       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748510796928       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748510796602       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748510796776       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748510796778       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 3.222799e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748510564534       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748510612234       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748510619136       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748510621661       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748510622409       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748510622652       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748510622571       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748510622615       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748510622615       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 8.058555e-07

solving harmonic davidson linear method for identity shift 1.6000e+03, overlap shift 1.6000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748510564534       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748510576461       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748510578186       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748510578818       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748510579002       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748510579062       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748510579045       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748510579056       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748510579055       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+03 is 2.014736e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0339e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_01                 1.080235e-01 3 1  ON 0
ci_02                -2.399898e-02 3 1  ON 1
ci_03                -2.427532e-02 3 1  ON 2
ci_04                 2.215405e-02 3 1  ON 3
ci_05                -1.912997e-02 3 1  ON 4
ci_06                -1.952709e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225004e-03 3 1  ON 7
ci_09                -7.549697e-03 3 1  ON 8
ci_10                -7.705129e-03 3 1  ON 9
ci_11                 1.374811e-02 3 1  ON 10
ci_12                 7.047054e-03 3 1  ON 11
ci_13                 1.381565e-02 3 1  ON 12
ci_14                 1.281131e-02 3 1  ON 13
ci_15                 5.167497e-03 3 1  ON 14
ci_16                 5.730639e-03 3 1  ON 15
ci_17                -5.017656e-03 3 1  ON 16
ci_18                -5.545953e-03 3 1  ON 17
ci_19                 1.033097e-02 3 1  ON 18
ci_20                 6.254237e-03 3 1  ON 19
ci_21                 8.483722e-03 3 1  ON 20
ci_22                 8.882536e-03 3 1  ON 21
ci_23                 4.168221e-03 3 1  ON 22
ci_24                 5.186613e-03 3 1  ON 23
ci_25                 3.011378e-03 3 1  ON 24
ci_26                 3.794551e-03 3 1  ON 25
ci_27                 3.289269e-03 3 1  ON 26
ci_28                 7.709712e-04 3 1  ON 27
ci_29                 1.186505e-03 3 1  ON 28
ci_30                -7.411135e-04 3 1  ON 29
ci_31                 1.034376e-03 3 1  ON 30
ci_32                -5.359889e-04 3 1  ON 31
ci_33                -1.032821e-03 3 1  ON 32
ci_34                 1.151455e-03 3 1  ON 33
ci_35                 1.248258e-03 3 1  ON 34
ci_36                -5.659800e-04 3 1  ON 35
ci_37                -5.174886e-04 3 1  ON 36
ci_38                -2.860911e-04 3 1  ON 37
ci_39                -1.421938e-04 3 1  ON 38
ci_40                -1.905932e-03 3 1  ON 39
ci_41                -5.127159e-04 3 1  ON 40
ci_42                -1.648367e-03 3 1  ON 41
ci_43                -1.292137e-03 3 1  ON 42
ci_44                -2.176756e-03 3 1  ON 43
ci_45                -2.656937e-04 3 1  ON 44
ci_46                -1.694402e-03 3 1  ON 45
ci_47                 1.434995e-03 3 1  ON 46
ci_48                 2.894133e-03 3 1  ON 47
ci_49                -8.545999e-04 3 1  ON 48
ci_50                -8.205363e-04 3 1  ON 49
ci_51                -5.673951e-04 3 1  ON 50
ci_52                -6.317161e-04 3 1  ON 51
ci_53                -8.017664e-04 3 1  ON 52
ci_54                -1.110045e-03 3 1  ON 53
ci_55                -1.236892e-03 3 1  ON 54
ci_56                 1.098521e-03 3 1  ON 55
ci_57                 2.090284e-03 3 1  ON 56
ci_58                -1.860270e-04 3 1  ON 57
ci_59                -6.203576e-04 3 1  ON 58
ci_60                 1.271600e-04 3 1  ON 59
ci_61                -9.876006e-04 3 1  ON 60
ci_62                -3.820951e-04 3 1  ON 61
ci_63                -2.476752e-04 3 1  ON 62
ci_64                -6.089398e-04 3 1  ON 63
ci_65                -1.061763e-04 3 1  ON 64
ci_66                -1.253121e-04 3 1  ON 65
ci_67                -1.927002e-04 3 1  ON 66
ci_68                -1.799033e-03 3 1  ON 67
ci_69                -1.808419e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.707
    reference variance = 0.444672
====================================================
  Execution time = 2.4889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5333e-01
  Total weights = 1.9646e+06
  Execution time = 3.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640804597
                                         uncertainty =       0.002057683153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640804597
                                         uncertainty =       0.002057683153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468311932
  error estimate for blocks of size 2^( 2) =       0.000493795312
  error estimate for blocks of size 2^( 3) =       0.000518269734
  error estimate for blocks of size 2^( 4) =       0.000536802762
  error estimate for blocks of size 2^( 5) =       0.000549056717
  error estimate for blocks of size 2^( 6) =       0.000556652578
  error estimate for blocks of size 2^( 7) =       0.000558178645

      target function =      -0.742608441324
              le_mean =     -22.814736429122
             les_mean =     520.965523447083
             stat err =       0.000550172675
             autocorr =       1.380154126671
   target nu stat err =       0.000550172675
   target dn stat err =       0.003069836723
      target stat err =       0.002590673458
              std dev =       0.662293085186
             le_variance =       0.438632130685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640656188
                                         uncertainty =       0.002057680533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640656188
                                         uncertainty =       0.002057680533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468311853
  error estimate for blocks of size 2^( 2) =       0.000493795077
  error estimate for blocks of size 2^( 3) =       0.000518269361
  error estimate for blocks of size 2^( 4) =       0.000536802261
  error estimate for blocks of size 2^( 5) =       0.000549056140
  error estimate for blocks of size 2^( 6) =       0.000556651898
  error estimate for blocks of size 2^( 7) =       0.000558177975

      target function =      -0.742607992489
              le_mean =     -22.814736422977
             les_mean =     520.965523713609
             stat err =       0.000550172068
             autocorr =       1.380151544364
   target nu stat err =       0.000550172068
   target dn stat err =       0.003069870543
      target stat err =       0.002590697202
              std dev =       0.662292974318
             le_variance =       0.438631983831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640730293
                                         uncertainty =       0.002057681841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640730293
                                         uncertainty =       0.002057681841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468311892
  error estimate for blocks of size 2^( 2) =       0.000493795194
  error estimate for blocks of size 2^( 3) =       0.000518269547
  error estimate for blocks of size 2^( 4) =       0.000536802512
  error estimate for blocks of size 2^( 5) =       0.000549056428
  error estimate for blocks of size 2^( 6) =       0.000556652238
  error estimate for blocks of size 2^( 7) =       0.000558178309

      target function =      -0.742608235816
              le_mean =     -22.814736426041
             les_mean =     520.965523556911
             stat err =       0.000550172372
             autocorr =       1.380152835206
   target nu stat err =       0.000550172372
   target dn stat err =       0.003069853548
      target stat err =       0.002590685391
              std dev =       0.662293029676
             le_variance =       0.438632057158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640795300
                                         uncertainty =       0.002057682989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438640795300
                                         uncertainty =       0.002057682989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468311927
  error estimate for blocks of size 2^( 2) =       0.000493795297
  error estimate for blocks of size 2^( 3) =       0.000518269710
  error estimate for blocks of size 2^( 4) =       0.000536802731
  error estimate for blocks of size 2^( 5) =       0.000549056681
  error estimate for blocks of size 2^( 6) =       0.000556652536
  error estimate for blocks of size 2^( 7) =       0.000558178603

      target function =      -0.742608417484
              le_mean =     -22.814736428736
             les_mean =     520.965523458520
             stat err =       0.000550172637
             autocorr =       1.380153965230
   target nu stat err =       0.000550172637
   target dn stat err =       0.003069838816
      target stat err =       0.002590674954
              std dev =       0.662293078240
             le_variance =       0.438632121485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742608441324        initial  <--
     1.0000e+02     1.0000e+03             3.2228e-06        -0.742607992489
     4.0000e+02     4.0000e+03             8.0586e-07        -0.742608235816
     1.6000e+03     1.6000e+04             2.0147e-07        -0.742608417484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6747
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3022e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2777e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7611
    reference variance = 0.25589
====================================================
  Execution time = 2.5515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4833e-01
  Total weights = 1.964529989e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436551321354
                                         uncertainty =       0.002033021269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436551321354
                                         uncertainty =       0.002033021269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467144394
  error estimate for blocks of size 2^( 2) =       0.000492270298
  error estimate for blocks of size 2^( 3) =       0.000516565648
  error estimate for blocks of size 2^( 4) =       0.000534457741
  error estimate for blocks of size 2^( 5) =       0.000545902469
  error estimate for blocks of size 2^( 6) =       0.000553166610
  error estimate for blocks of size 2^( 7) =       0.000557908188

      target function =      -0.746729579908
              le_mean =     -22.815249326420
             les_mean =     520.983935422835
             stat err =       0.000547858752
             autocorr =       1.375418698799
   target nu stat err =       0.000547858752
   target dn stat err =       0.002750944764
      target stat err =       0.002363441646
              std dev =       0.660641938142
             le_variance =       0.436447770432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281524932642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746736090525       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746736113879       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746736116774       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746736117284       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746736117505       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746736117530       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746736117555       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746736117571       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746736117565       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746736117560       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 2.879836e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746736090525       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746736096364       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746736097088       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746736097215       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746736097270       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746736097277       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746736097284       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746736097292       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746736097283       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746736097284       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 7.199738e-08

solving harmonic davidson linear method for identity shift 1.6000e+04, overlap shift 1.6000e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746736090525       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746736091985       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746736092166       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746736092204       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746736092204       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746736092207       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746736092215       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746736092216       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746736092220       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746736092258       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+04 is 1.799944e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0612e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399862e-02 3 1  ON 1
ci_03                -2.427518e-02 3 1  ON 2
ci_04                 2.215359e-02 3 1  ON 3
ci_05                -1.912991e-02 3 1  ON 4
ci_06                -1.952700e-02 3 1  ON 5
ci_07                 2.575664e-02 3 1  ON 6
ci_08                -4.225026e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705353e-03 3 1  ON 9
ci_11                 1.374811e-02 3 1  ON 10
ci_12                 7.047011e-03 3 1  ON 11
ci_13                 1.381579e-02 3 1  ON 12
ci_14                 1.281143e-02 3 1  ON 13
ci_15                 5.167482e-03 3 1  ON 14
ci_16                 5.730614e-03 3 1  ON 15
ci_17                -5.017482e-03 3 1  ON 16
ci_18                -5.545870e-03 3 1  ON 17
ci_19                 1.033114e-02 3 1  ON 18
ci_20                 6.254304e-03 3 1  ON 19
ci_21                 8.483875e-03 3 1  ON 20
ci_22                 8.882572e-03 3 1  ON 21
ci_23                 4.168281e-03 3 1  ON 22
ci_24                 5.186778e-03 3 1  ON 23
ci_25                 3.011430e-03 3 1  ON 24
ci_26                 3.794748e-03 3 1  ON 25
ci_27                 3.289103e-03 3 1  ON 26
ci_28                 7.707529e-04 3 1  ON 27
ci_29                 1.186548e-03 3 1  ON 28
ci_30                -7.412032e-04 3 1  ON 29
ci_31                 1.034546e-03 3 1  ON 30
ci_32                -5.358716e-04 3 1  ON 31
ci_33                -1.032772e-03 3 1  ON 32
ci_34                 1.151551e-03 3 1  ON 33
ci_35                 1.248313e-03 3 1  ON 34
ci_36                -5.659654e-04 3 1  ON 35
ci_37                -5.174820e-04 3 1  ON 36
ci_38                -2.861730e-04 3 1  ON 37
ci_39                -1.421264e-04 3 1  ON 38
ci_40                -1.905954e-03 3 1  ON 39
ci_41                -5.127721e-04 3 1  ON 40
ci_42                -1.648325e-03 3 1  ON 41
ci_43                -1.292210e-03 3 1  ON 42
ci_44                -2.176895e-03 3 1  ON 43
ci_45                -2.655984e-04 3 1  ON 44
ci_46                -1.694626e-03 3 1  ON 45
ci_47                 1.434997e-03 3 1  ON 46
ci_48                 2.894146e-03 3 1  ON 47
ci_49                -8.545608e-04 3 1  ON 48
ci_50                -8.205351e-04 3 1  ON 49
ci_51                -5.674740e-04 3 1  ON 50
ci_52                -6.318338e-04 3 1  ON 51
ci_53                -8.017823e-04 3 1  ON 52
ci_54                -1.109997e-03 3 1  ON 53
ci_55                -1.237002e-03 3 1  ON 54
ci_56                 1.098323e-03 3 1  ON 55
ci_57                 2.090263e-03 3 1  ON 56
ci_58                -1.859588e-04 3 1  ON 57
ci_59                -6.202981e-04 3 1  ON 58
ci_60                 1.270264e-04 3 1  ON 59
ci_61                -9.876539e-04 3 1  ON 60
ci_62                -3.821442e-04 3 1  ON 61
ci_63                -2.475672e-04 3 1  ON 62
ci_64                -6.090033e-04 3 1  ON 63
ci_65                -1.061317e-04 3 1  ON 64
ci_66                -1.253027e-04 3 1  ON 65
ci_67                -1.925953e-04 3 1  ON 66
ci_68                -1.799124e-03 3 1  ON 67
ci_69                -1.808506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8667
    reference variance = 0.587247
====================================================
  Execution time = 2.5143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4523e-01
  Total weights = 1.9647e+06
  Execution time = 3.5453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236819684
                                         uncertainty =       0.001497572945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236819684
                                         uncertainty =       0.001497572945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405389
  error estimate for blocks of size 2^( 2) =       0.000491126679
  error estimate for blocks of size 2^( 3) =       0.000515804622
  error estimate for blocks of size 2^( 4) =       0.000535266998
  error estimate for blocks of size 2^( 5) =       0.000546875557
  error estimate for blocks of size 2^( 6) =       0.000554326269
  error estimate for blocks of size 2^( 7) =       0.000561095657

      target function =      -0.749305684097
              le_mean =     -22.814215595804
             les_mean =     520.933666805303
             stat err =       0.000549391120
             autocorr =       1.393479088821
   target nu stat err =       0.000549391120
   target dn stat err =       0.002260561176
      target stat err =       0.001983356781
              std dev =       0.658182613159
             le_variance =       0.433204352265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236785239
                                         uncertainty =       0.001497571829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236785239
                                         uncertainty =       0.001497571829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405371
  error estimate for blocks of size 2^( 2) =       0.000491126644
  error estimate for blocks of size 2^( 3) =       0.000515804570
  error estimate for blocks of size 2^( 4) =       0.000535266933
  error estimate for blocks of size 2^( 5) =       0.000546875483
  error estimate for blocks of size 2^( 6) =       0.000554326192
  error estimate for blocks of size 2^( 7) =       0.000561095580

      target function =      -0.749305637132
              le_mean =     -22.814215596100
             les_mean =     520.933666875107
             stat err =       0.000549391047
             autocorr =       1.393478828343
   target nu stat err =       0.000549391047
   target dn stat err =       0.002260559996
      target stat err =       0.001983355583
              std dev =       0.658182587075
             le_variance =       0.433204317929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236802460
                                         uncertainty =       0.001497572387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236802460
                                         uncertainty =       0.001497572387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405380
  error estimate for blocks of size 2^( 2) =       0.000491126661
  error estimate for blocks of size 2^( 3) =       0.000515804596
  error estimate for blocks of size 2^( 4) =       0.000535266966
  error estimate for blocks of size 2^( 5) =       0.000546875520
  error estimate for blocks of size 2^( 6) =       0.000554326231
  error estimate for blocks of size 2^( 7) =       0.000561095619

      target function =      -0.749305660864
              le_mean =     -22.814215595952
             les_mean =     520.933666839899
             stat err =       0.000549391084
             autocorr =       1.393478958583
   target nu stat err =       0.000549391084
   target dn stat err =       0.002260560569
      target stat err =       0.001983356170
              std dev =       0.658182600116
             le_variance =       0.433204335095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236817531
                                         uncertainty =       0.001497572876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433236817531
                                         uncertainty =       0.001497572876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405388
  error estimate for blocks of size 2^( 2) =       0.000491126677
  error estimate for blocks of size 2^( 3) =       0.000515804619
  error estimate for blocks of size 2^( 4) =       0.000535266994
  error estimate for blocks of size 2^( 5) =       0.000546875552
  error estimate for blocks of size 2^( 6) =       0.000554326264
  error estimate for blocks of size 2^( 7) =       0.000561095652

      target function =      -0.749305681221
              le_mean =     -22.814215595822
             les_mean =     520.933666809594
             stat err =       0.000549391116
             autocorr =       1.393479072542
   target nu stat err =       0.000549391116
   target dn stat err =       0.002260561098
      target stat err =       0.001983356703
              std dev =       0.658182611528
             le_variance =       0.433204350118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749305684097        initial  <--
     1.0000e+03     1.0000e+04             2.8798e-07        -0.749305637132
     4.0000e+03     4.0000e+04             7.1997e-08        -0.749305660864
     1.6000e+04     1.6000e+05             1.7999e-08        -0.749305681221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9098
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2783e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7927
    reference variance = 0.564559
====================================================
  Execution time = 2.5721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4960e-01
  Total weights = 1.964938431e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435851328180
                                         uncertainty =       0.002549037434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435851328180
                                         uncertainty =       0.002549037434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467024453
  error estimate for blocks of size 2^( 2) =       0.000492463023
  error estimate for blocks of size 2^( 3) =       0.000516477210
  error estimate for blocks of size 2^( 4) =       0.000534492947
  error estimate for blocks of size 2^( 5) =       0.000547126487
  error estimate for blocks of size 2^( 6) =       0.000553790015
  error estimate for blocks of size 2^( 7) =       0.000556786555

      target function =      -0.745666703938
              le_mean =     -22.814342769865
             les_mean =     520.943840005116
             stat err =       0.000548049001
             autocorr =       1.377081167998
   target nu stat err =       0.000548049001
   target dn stat err =       0.003832958295
      target stat err =       0.003226253538
              std dev =       0.660472315865
             le_variance =       0.436223680024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281434276986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745680521472       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745680524747       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745680525080       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745680525182       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745680525204       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745680525214       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745680525209       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745680525211       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745680525205       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 3.400439e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745680521472       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745680522291       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745680522374       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745680522400       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745680522390       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745680522348       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745680522415       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745680522405       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745680522448       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+04 is 8.501114e-09

solving harmonic davidson linear method for identity shift 1.6000e+05, overlap shift 1.6000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745680521472       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745680521677       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745680521698       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745680521704       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745680521730       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745680521878       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745680521706       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745680521627       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745680521959       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+05 is 2.125280e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0288e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912988e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705366e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046992e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167478e-03 3 1  ON 14
ci_16                 5.730600e-03 3 1  ON 15
ci_17                -5.017494e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033114e-02 3 1  ON 18
ci_20                 6.254307e-03 3 1  ON 19
ci_21                 8.483879e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168286e-03 3 1  ON 22
ci_24                 5.186781e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794758e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707523e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411959e-04 3 1  ON 29
ci_31                 1.034577e-03 3 1  ON 30
ci_32                -5.358642e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659612e-04 3 1  ON 35
ci_37                -5.174613e-04 3 1  ON 36
ci_38                -2.861677e-04 3 1  ON 37
ci_39                -1.421261e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127566e-04 3 1  ON 40
ci_42                -1.648321e-03 3 1  ON 41
ci_43                -1.292189e-03 3 1  ON 42
ci_44                -2.176903e-03 3 1  ON 43
ci_45                -2.655954e-04 3 1  ON 44
ci_46                -1.694643e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545602e-04 3 1  ON 48
ci_50                -8.205368e-04 3 1  ON 49
ci_51                -5.674913e-04 3 1  ON 50
ci_52                -6.318139e-04 3 1  ON 51
ci_53                -8.017825e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237022e-03 3 1  ON 54
ci_56                 1.098315e-03 3 1  ON 55
ci_57                 2.090266e-03 3 1  ON 56
ci_58                -1.859402e-04 3 1  ON 57
ci_59                -6.202988e-04 3 1  ON 58
ci_60                 1.270283e-04 3 1  ON 59
ci_61                -9.876585e-04 3 1  ON 60
ci_62                -3.821451e-04 3 1  ON 61
ci_63                -2.475837e-04 3 1  ON 62
ci_64                -6.090065e-04 3 1  ON 63
ci_65                -1.061357e-04 3 1  ON 64
ci_66                -1.252768e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8165
    reference variance = 0.328648
====================================================
  Execution time = 2.4897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4878e-01
  Total weights = 1.9648e+06
  Execution time = 3.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183866710
                                         uncertainty =       0.001786390801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183866710
                                         uncertainty =       0.001786390801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466986046
  error estimate for blocks of size 2^( 2) =       0.000492551270
  error estimate for blocks of size 2^( 3) =       0.000515964904
  error estimate for blocks of size 2^( 4) =       0.000533351645
  error estimate for blocks of size 2^( 5) =       0.000544970847
  error estimate for blocks of size 2^( 6) =       0.000553167137
  error estimate for blocks of size 2^( 7) =       0.000555582471

      target function =      -0.746351691790
              le_mean =     -22.814018901205
             les_mean =     520.928242475161
             stat err =       0.000546768025
             autocorr =       1.370876748249
   target nu stat err =       0.000546768025
   target dn stat err =       0.002603074915
      target stat err =       0.002238440766
              std dev =       0.660418000063
             le_variance =       0.436151934808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183863723
                                         uncertainty =       0.001786390896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183863723
                                         uncertainty =       0.001786390896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466986045
  error estimate for blocks of size 2^( 2) =       0.000492551267
  error estimate for blocks of size 2^( 3) =       0.000515964900
  error estimate for blocks of size 2^( 4) =       0.000533351640
  error estimate for blocks of size 2^( 5) =       0.000544970841
  error estimate for blocks of size 2^( 6) =       0.000553167131
  error estimate for blocks of size 2^( 7) =       0.000555582465

      target function =      -0.746350966664
              le_mean =     -22.814018901319
             les_mean =     520.928243356356
             stat err =       0.000546768019
             autocorr =       1.370876729107
   target nu stat err =       0.000546768019
   target dn stat err =       0.002603079568
      target stat err =       0.002238440282
              std dev =       0.660417997788
             le_variance =       0.436151931802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183865217
                                         uncertainty =       0.001786390849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183865217
                                         uncertainty =       0.001786390849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466986045
  error estimate for blocks of size 2^( 2) =       0.000492551269
  error estimate for blocks of size 2^( 3) =       0.000515964902
  error estimate for blocks of size 2^( 4) =       0.000533351643
  error estimate for blocks of size 2^( 5) =       0.000544970844
  error estimate for blocks of size 2^( 6) =       0.000553167134
  error estimate for blocks of size 2^( 7) =       0.000555582468

      target function =      -0.746351334619
              le_mean =     -22.814018901262
             les_mean =     520.928242909244
             stat err =       0.000546768022
             autocorr =       1.370876738668
   target nu stat err =       0.000546768022
   target dn stat err =       0.002603077156
      target stat err =       0.002238440487
              std dev =       0.660417998925
             le_variance =       0.436151933305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183866524
                                         uncertainty =       0.001786390807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183866524
                                         uncertainty =       0.001786390807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466986046
  error estimate for blocks of size 2^( 2) =       0.000492551270
  error estimate for blocks of size 2^( 3) =       0.000515964904
  error estimate for blocks of size 2^( 4) =       0.000533351645
  error estimate for blocks of size 2^( 5) =       0.000544970846
  error estimate for blocks of size 2^( 6) =       0.000553167137
  error estimate for blocks of size 2^( 7) =       0.000555582471

      target function =      -0.746351647720
              le_mean =     -22.814018901212
             les_mean =     520.928242528726
             stat err =       0.000546768025
             autocorr =       1.370876747048
   target nu stat err =       0.000546768025
   target dn stat err =       0.002603075186
      target stat err =       0.002238440727
              std dev =       0.660417999921
             le_variance =       0.436151934620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746351691790        initial  <--
     1.0000e+04     1.0000e+05             3.4004e-08        -0.746350966664
     4.0000e+04     4.0000e+05             8.5011e-09        -0.746351334619
     1.6000e+05     1.6000e+06             2.1253e-09        -0.746351647720

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6727
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167475e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017491e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034580e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659626e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861667e-04 3 1  ON 37
ci_39                -1.421255e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674910e-04 3 1  ON 50
ci_52                -6.318162e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202992e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876601e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252762e-04 3 1  ON 65
ci_67                -1.925949e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2786e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7432
    reference variance = 0.419217
====================================================
  Execution time = 2.5617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4611e-01
  Total weights = 1.964902594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433083811593
                                         uncertainty =       0.001785387793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433083811593
                                         uncertainty =       0.001785387793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465418858
  error estimate for blocks of size 2^( 2) =       0.000491104258
  error estimate for blocks of size 2^( 3) =       0.000515198635
  error estimate for blocks of size 2^( 4) =       0.000533746504
  error estimate for blocks of size 2^( 5) =       0.000545789379
  error estimate for blocks of size 2^( 6) =       0.000554405314
  error estimate for blocks of size 2^( 7) =       0.000556447736

      target function =      -0.748582665831
              le_mean =     -22.815535740677
             les_mean =     520.994781251443
             stat err =       0.000547597233
             autocorr =       1.384313769859
   target nu stat err =       0.000547597233
   target dn stat err =       0.002548534330
      target stat err =       0.002212898449
              std dev =       0.658201660490
             le_variance =       0.433229425871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281553574068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748588186003       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748588186221       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748588186248       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748588186252       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748588186246       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748588186082       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748588186128       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748588186265       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748588186110       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748588186250       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 2.336445e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748588186003       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748588186058       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748588186064       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748588186065       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748588186070       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748588186746       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748588186103       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748588186305       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748588186745       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748588186011       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+05 is 5.841115e-10

solving harmonic davidson linear method for identity shift 1.6000e+06, overlap shift 1.6000e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748588186003       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748588186017       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748588186018       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748588186018       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748588185537       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748588183963       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748588185493       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748588187786       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748588187644       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748588186334       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+06 is 1.460279e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0185e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215355e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225008e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167476e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017492e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707542e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411951e-04 3 1  ON 29
ci_31                 1.034579e-03 3 1  ON 30
ci_32                -5.358621e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659627e-04 3 1  ON 35
ci_37                -5.174626e-04 3 1  ON 36
ci_38                -2.861668e-04 3 1  ON 37
ci_39                -1.421256e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127555e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176902e-03 3 1  ON 43
ci_45                -2.655938e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894155e-03 3 1  ON 47
ci_49                -8.545599e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674909e-04 3 1  ON 50
ci_52                -6.318160e-04 3 1  ON 51
ci_53                -8.017829e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202993e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876599e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090055e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252764e-04 3 1  ON 65
ci_67                -1.925950e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7827
    reference variance = 0.520843
====================================================
  Execution time = 2.6763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.9644e+06
  Execution time = 3.5448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338743
                                         uncertainty =       0.002064336606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338743
                                         uncertainty =       0.002064336606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466849581
  error estimate for blocks of size 2^( 2) =       0.000492450300
  error estimate for blocks of size 2^( 3) =       0.000517307180
  error estimate for blocks of size 2^( 4) =       0.000536280016
  error estimate for blocks of size 2^( 5) =       0.000549812413
  error estimate for blocks of size 2^( 6) =       0.000557188512
  error estimate for blocks of size 2^( 7) =       0.000560774647

      target function =      -0.745688178091
              le_mean =     -22.814536622134
             les_mean =     520.952669740614
             stat err =       0.000551013897
             autocorr =       1.393064286095
   target nu stat err =       0.000551013897
   target dn stat err =       0.002631727292
      target stat err =       0.002260412726
              std dev =       0.660225008628
             le_variance =       0.435897062018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338486
                                         uncertainty =       0.002064336641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338486
                                         uncertainty =       0.002064336641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466849581
  error estimate for blocks of size 2^( 2) =       0.000492450300
  error estimate for blocks of size 2^( 3) =       0.000517307180
  error estimate for blocks of size 2^( 4) =       0.000536280015
  error estimate for blocks of size 2^( 5) =       0.000549812412
  error estimate for blocks of size 2^( 6) =       0.000557188512
  error estimate for blocks of size 2^( 7) =       0.000560774647

      target function =      -0.745688179790
              le_mean =     -22.814536622124
             les_mean =     520.952669738068
             stat err =       0.000551013896
             autocorr =       1.393064283416
   target nu stat err =       0.000551013896
   target dn stat err =       0.002631726803
      target stat err =       0.002260412345
              std dev =       0.660225008435
             le_variance =       0.435897061763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338614
                                         uncertainty =       0.002064336624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338614
                                         uncertainty =       0.002064336624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466849581
  error estimate for blocks of size 2^( 2) =       0.000492450300
  error estimate for blocks of size 2^( 3) =       0.000517307180
  error estimate for blocks of size 2^( 4) =       0.000536280016
  error estimate for blocks of size 2^( 5) =       0.000549812412
  error estimate for blocks of size 2^( 6) =       0.000557188512
  error estimate for blocks of size 2^( 7) =       0.000560774647

      target function =      -0.745688178941
              le_mean =     -22.814536622129
             les_mean =     520.952669739341
             stat err =       0.000551013897
             autocorr =       1.393064284755
   target nu stat err =       0.000551013897
   target dn stat err =       0.002631727047
      target stat err =       0.002260412535
              std dev =       0.660225008532
             le_variance =       0.435897061891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338726
                                         uncertainty =       0.002064336608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435825338726
                                         uncertainty =       0.002064336608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466849581
  error estimate for blocks of size 2^( 2) =       0.000492450300
  error estimate for blocks of size 2^( 3) =       0.000517307180
  error estimate for blocks of size 2^( 4) =       0.000536280016
  error estimate for blocks of size 2^( 5) =       0.000549812413
  error estimate for blocks of size 2^( 6) =       0.000557188512
  error estimate for blocks of size 2^( 7) =       0.000560774647

      target function =      -0.745688178198
              le_mean =     -22.814536622134
             les_mean =     520.952669740455
             stat err =       0.000551013897
             autocorr =       1.393064285925
   target nu stat err =       0.000551013897
   target dn stat err =       0.002631727262
      target stat err =       0.002260412702
              std dev =       0.660225008616
             le_variance =       0.435897062003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745688178091        initial
     1.0000e+05     1.0000e+06             2.3364e-09        -0.745688179790  <--
     4.0000e+05     4.0000e+06             5.8411e-10        -0.745688178941
     1.6000e+06     1.6000e+07             1.4603e-10        -0.745688178198

*****************************************************************************
Applying the update for shift_i =   1.0000e+05     and shift_s =   1.0000e+06
*****************************************************************************

  Execution time = 4.4506e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225009e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167476e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017492e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707543e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411948e-04 3 1  ON 29
ci_31                 1.034579e-03 3 1  ON 30
ci_32                -5.358619e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659627e-04 3 1  ON 35
ci_37                -5.174626e-04 3 1  ON 36
ci_38                -2.861670e-04 3 1  ON 37
ci_39                -1.421258e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127558e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655935e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545600e-04 3 1  ON 48
ci_50                -8.205369e-04 3 1  ON 49
ci_51                -5.674905e-04 3 1  ON 50
ci_52                -6.318155e-04 3 1  ON 51
ci_53                -8.017830e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859387e-04 3 1  ON 57
ci_59                -6.202995e-04 3 1  ON 58
ci_60                 1.270266e-04 3 1  ON 59
ci_61                -9.876593e-04 3 1  ON 60
ci_62                -3.821455e-04 3 1  ON 61
ci_63                -2.475837e-04 3 1  ON 62
ci_64                -6.090053e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252768e-04 3 1  ON 65
ci_67                -1.925952e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2783e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.884
    reference variance = 0.626753
====================================================
  Execution time = 2.5814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4993e-01
  Total weights = 1.964722026e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183566925
                                         uncertainty =       0.002366423603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436183566925
                                         uncertainty =       0.002366423603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466989860
  error estimate for blocks of size 2^( 2) =       0.000492739847
  error estimate for blocks of size 2^( 3) =       0.000516582117
  error estimate for blocks of size 2^( 4) =       0.000534920487
  error estimate for blocks of size 2^( 5) =       0.000546037046
  error estimate for blocks of size 2^( 6) =       0.000553929041
  error estimate for blocks of size 2^( 7) =       0.000557624084

      target function =      -0.745399332069
              le_mean =     -22.814543970589
             les_mean =     520.953349672686
             stat err =       0.000548127664
             autocorr =       1.377680594481
   target nu stat err =       0.000548127664
   target dn stat err =       0.003335275639
      target stat err =       0.002822137506
              std dev =       0.660423394140
             le_variance =       0.436159059527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454397059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745409144393       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745409145557       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745409145746       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745409145797       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745409145820       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745409145845       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745409145869       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745409145853       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745409145866       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745409145851       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 1.505884e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745409144393       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745409144684       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745409144731       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745409144693       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745409144750       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745409144782       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745409144778       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745409144951       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745409145012       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745409144702       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 3.764714e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745409144393       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745409144466       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745409144477       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745409144481       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745409144482       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745409144483       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745409144483       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745409144483       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745409144483       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745409144483       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+05 is 9.411785e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0374e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225009e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705366e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167476e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545877e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707541e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411960e-04 3 1  ON 29
ci_31                 1.034579e-03 3 1  ON 30
ci_32                -5.358620e-04 3 1  ON 31
ci_33                -1.032761e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659630e-04 3 1  ON 35
ci_37                -5.174633e-04 3 1  ON 36
ci_38                -2.861671e-04 3 1  ON 37
ci_39                -1.421247e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127560e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292186e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655938e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545604e-04 3 1  ON 48
ci_50                -8.205365e-04 3 1  ON 49
ci_51                -5.674904e-04 3 1  ON 50
ci_52                -6.318148e-04 3 1  ON 51
ci_53                -8.017828e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237025e-03 3 1  ON 54
ci_56                 1.098315e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859402e-04 3 1  ON 57
ci_59                -6.202995e-04 3 1  ON 58
ci_60                 1.270271e-04 3 1  ON 59
ci_61                -9.876591e-04 3 1  ON 60
ci_62                -3.821457e-04 3 1  ON 61
ci_63                -2.475837e-04 3 1  ON 62
ci_64                -6.090048e-04 3 1  ON 63
ci_65                -1.061366e-04 3 1  ON 64
ci_66                -1.252759e-04 3 1  ON 65
ci_67                -1.925954e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7684
    reference variance = 0.441268
====================================================
  Execution time = 2.5107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4667e-01
  Total weights = 1.9647e+06
  Execution time = 3.5683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742909
                                         uncertainty =       0.002071580295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742909
                                         uncertainty =       0.002071580295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466275698
  error estimate for blocks of size 2^( 2) =       0.000492133676
  error estimate for blocks of size 2^( 3) =       0.000516574953
  error estimate for blocks of size 2^( 4) =       0.000535301869
  error estimate for blocks of size 2^( 5) =       0.000546439403
  error estimate for blocks of size 2^( 6) =       0.000555292878
  error estimate for blocks of size 2^( 7) =       0.000561184382

      target function =      -0.748106759629
              le_mean =     -22.813944750036
             les_mean =     520.922740184576
             stat err =       0.000549554633
             autocorr =       1.389108556170
   target nu stat err =       0.000549554633
   target dn stat err =       0.003079728832
      target stat err =       0.002632868539
              std dev =       0.659413415229
             le_variance =       0.434826052185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742407
                                         uncertainty =       0.002071580480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742407
                                         uncertainty =       0.002071580480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466275697
  error estimate for blocks of size 2^( 2) =       0.000492133675
  error estimate for blocks of size 2^( 3) =       0.000516574952
  error estimate for blocks of size 2^( 4) =       0.000535301867
  error estimate for blocks of size 2^( 5) =       0.000546439400
  error estimate for blocks of size 2^( 6) =       0.000555292876
  error estimate for blocks of size 2^( 7) =       0.000561184379

      target function =      -0.748106746032
              le_mean =     -22.813944750061
             les_mean =     520.922740202036
             stat err =       0.000549554631
             autocorr =       1.389108545203
   target nu stat err =       0.000549554631
   target dn stat err =       0.003079729847
      target stat err =       0.002632869267
              std dev =       0.659413414847
             le_variance =       0.434826051680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742658
                                         uncertainty =       0.002071580387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742658
                                         uncertainty =       0.002071580387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466275697
  error estimate for blocks of size 2^( 2) =       0.000492133675
  error estimate for blocks of size 2^( 3) =       0.000516574953
  error estimate for blocks of size 2^( 4) =       0.000535301868
  error estimate for blocks of size 2^( 5) =       0.000546439402
  error estimate for blocks of size 2^( 6) =       0.000555292877
  error estimate for blocks of size 2^( 7) =       0.000561184380

      target function =      -0.748106752833
              le_mean =     -22.813944750048
             les_mean =     520.922740193302
             stat err =       0.000549554632
             autocorr =       1.389108550684
   target nu stat err =       0.000549554632
   target dn stat err =       0.003079729340
      target stat err =       0.002632868903
              std dev =       0.659413415038
             le_variance =       0.434826051932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742878
                                         uncertainty =       0.002071580307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434835742878
                                         uncertainty =       0.002071580307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466275697
  error estimate for blocks of size 2^( 2) =       0.000492133676
  error estimate for blocks of size 2^( 3) =       0.000516574953
  error estimate for blocks of size 2^( 4) =       0.000535301869
  error estimate for blocks of size 2^( 5) =       0.000546439403
  error estimate for blocks of size 2^( 6) =       0.000555292878
  error estimate for blocks of size 2^( 7) =       0.000561184382

      target function =      -0.748106758780
              le_mean =     -22.813944750038
             les_mean =     520.922740185666
             stat err =       0.000549554633
             autocorr =       1.389108555470
   target nu stat err =       0.000549554633
   target dn stat err =       0.003079728896
      target stat err =       0.002632868585
              std dev =       0.659413415206
             le_variance =       0.434826052153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748106759629        initial  <--
     2.5000e+04     2.5000e+05             1.5059e-08        -0.748106746032
     1.0000e+05     1.0000e+06             3.7647e-09        -0.748106752833
     4.0000e+05     4.0000e+06             9.4118e-10        -0.748106758780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8937
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225009e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167476e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017492e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707543e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411948e-04 3 1  ON 29
ci_31                 1.034579e-03 3 1  ON 30
ci_32                -5.358619e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659627e-04 3 1  ON 35
ci_37                -5.174626e-04 3 1  ON 36
ci_38                -2.861670e-04 3 1  ON 37
ci_39                -1.421258e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127558e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655935e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545600e-04 3 1  ON 48
ci_50                -8.205369e-04 3 1  ON 49
ci_51                -5.674905e-04 3 1  ON 50
ci_52                -6.318155e-04 3 1  ON 51
ci_53                -8.017830e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859387e-04 3 1  ON 57
ci_59                -6.202995e-04 3 1  ON 58
ci_60                 1.270266e-04 3 1  ON 59
ci_61                -9.876593e-04 3 1  ON 60
ci_62                -3.821455e-04 3 1  ON 61
ci_63                -2.475837e-04 3 1  ON 62
ci_64                -6.090053e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252768e-04 3 1  ON 65
ci_67                -1.925952e-04 3 1  ON 66
ci_68                -1.799118e-03 3 1  ON 67
ci_69                -1.808530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3275e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2788e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.803
    reference variance = 0.293519
====================================================
  Execution time = 2.5768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4569e-01
  Total weights = 1.965098562e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434681957104
                                         uncertainty =       0.001837464382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434681957104
                                         uncertainty =       0.001837464382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466177895
  error estimate for blocks of size 2^( 2) =       0.000492258453
  error estimate for blocks of size 2^( 3) =       0.000516918818
  error estimate for blocks of size 2^( 4) =       0.000534624936
  error estimate for blocks of size 2^( 5) =       0.000545085299
  error estimate for blocks of size 2^( 6) =       0.000552077608
  error estimate for blocks of size 2^( 7) =       0.000555919939

      target function =      -0.748927625735
              le_mean =     -22.814780197637
             les_mean =     520.959887531761
             stat err =       0.000546926945
             autocorr =       1.376433671707
   target nu stat err =       0.000546926945
   target dn stat err =       0.002272930655
      target stat err =       0.001992094341
              std dev =       0.659275101098
             le_variance =       0.434643658928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281478019764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748931965567       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748931965646       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748931965661       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748931965666       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748931965657       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748931965790       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748931965344       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748931965715       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748931965552       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748931965835       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+05 is 9.694402e-10

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748931965567       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748931965587       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748931965591       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748931965592       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748931965952       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748931965592       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748931963033       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748931966013       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748931966783       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748931965997       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+06 is 2.423601e-10

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748931965567       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748931965572       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748931965573       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748931965577       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748931963462       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748931962682       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748931957534       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748931965574       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748931969083       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748931951400       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+06 is 6.059008e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0305e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225009e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167476e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017492e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707543e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411948e-04 3 1  ON 29
ci_31                 1.034578e-03 3 1  ON 30
ci_32                -5.358619e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659627e-04 3 1  ON 35
ci_37                -5.174626e-04 3 1  ON 36
ci_38                -2.861671e-04 3 1  ON 37
ci_39                -1.421258e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127559e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655935e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545600e-04 3 1  ON 48
ci_50                -8.205369e-04 3 1  ON 49
ci_51                -5.674905e-04 3 1  ON 50
ci_52                -6.318155e-04 3 1  ON 51
ci_53                -8.017830e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859388e-04 3 1  ON 57
ci_59                -6.202996e-04 3 1  ON 58
ci_60                 1.270267e-04 3 1  ON 59
ci_61                -9.876592e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475838e-04 3 1  ON 62
ci_64                -6.090053e-04 3 1  ON 63
ci_65                -1.061369e-04 3 1  ON 64
ci_66                -1.252769e-04 3 1  ON 65
ci_67                -1.925952e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8564
    reference variance = 0.283943
====================================================
  Execution time = 2.7510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4702e-01
  Total weights = 1.9648e+06
  Execution time = 3.5581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883388
                                         uncertainty =       0.002576880286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883388
                                         uncertainty =       0.002576880286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466486912
  error estimate for blocks of size 2^( 2) =       0.000492047225
  error estimate for blocks of size 2^( 3) =       0.000516134595
  error estimate for blocks of size 2^( 4) =       0.000534484763
  error estimate for blocks of size 2^( 5) =       0.000547304376
  error estimate for blocks of size 2^( 6) =       0.000554701813
  error estimate for blocks of size 2^( 7) =       0.000560339737

      target function =      -0.747812860233
              le_mean =     -22.813905041937
             les_mean =     520.921283611217
             stat err =       0.000549207672
             autocorr =       1.386099044786
   target nu stat err =       0.000549207672
   target dn stat err =       0.002751256025
      target stat err =       0.002365978410
              std dev =       0.659712117630
             le_variance =       0.435220078148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883244
                                         uncertainty =       0.002576880265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883244
                                         uncertainty =       0.002576880265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466486912
  error estimate for blocks of size 2^( 2) =       0.000492047224
  error estimate for blocks of size 2^( 3) =       0.000516134595
  error estimate for blocks of size 2^( 4) =       0.000534484763
  error estimate for blocks of size 2^( 5) =       0.000547304375
  error estimate for blocks of size 2^( 6) =       0.000554701813
  error estimate for blocks of size 2^( 7) =       0.000560339737

      target function =      -0.747812860347
              le_mean =     -22.813905041937
             les_mean =     520.921283611092
             stat err =       0.000549207672
             autocorr =       1.386099043813
   target nu stat err =       0.000549207672
   target dn stat err =       0.002751255961
      target stat err =       0.002365978359
              std dev =       0.659712117521
             le_variance =       0.435220078004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883316
                                         uncertainty =       0.002576880275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883316
                                         uncertainty =       0.002576880275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466486912
  error estimate for blocks of size 2^( 2) =       0.000492047224
  error estimate for blocks of size 2^( 3) =       0.000516134595
  error estimate for blocks of size 2^( 4) =       0.000534484763
  error estimate for blocks of size 2^( 5) =       0.000547304376
  error estimate for blocks of size 2^( 6) =       0.000554701813
  error estimate for blocks of size 2^( 7) =       0.000560339737

      target function =      -0.747812860290
              le_mean =     -22.813905041937
             les_mean =     520.921283611155
             stat err =       0.000549207672
             autocorr =       1.386099044307
   target nu stat err =       0.000549207672
   target dn stat err =       0.002751255993
      target stat err =       0.002365978384
              std dev =       0.659712117576
             le_variance =       0.435220078076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883379
                                         uncertainty =       0.002576880284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435174883379
                                         uncertainty =       0.002576880284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466486912
  error estimate for blocks of size 2^( 2) =       0.000492047225
  error estimate for blocks of size 2^( 3) =       0.000516134595
  error estimate for blocks of size 2^( 4) =       0.000534484763
  error estimate for blocks of size 2^( 5) =       0.000547304376
  error estimate for blocks of size 2^( 6) =       0.000554701813
  error estimate for blocks of size 2^( 7) =       0.000560339737

      target function =      -0.747812860240
              le_mean =     -22.813905041937
             les_mean =     520.921283611209
             stat err =       0.000549207672
             autocorr =       1.386099044725
   target nu stat err =       0.000549207672
   target dn stat err =       0.002751256021
      target stat err =       0.002365978406
              std dev =       0.659712117624
             le_variance =       0.435220078139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747812860233        initial
     2.5000e+05     2.5000e+06             9.6944e-10        -0.747812860347  <--
     1.0000e+06     1.0000e+07             2.4236e-10        -0.747812860290
     4.0000e+06     4.0000e+07             6.0590e-11        -0.747812860240

*****************************************************************************
Applying the update for shift_i =   2.5000e+05     and shift_s =   2.5000e+06
*****************************************************************************

  Execution time = 4.5332e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225009e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167476e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017492e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186780e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707544e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411949e-04 3 1  ON 29
ci_31                 1.034578e-03 3 1  ON 30
ci_32                -5.358620e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659627e-04 3 1  ON 35
ci_37                -5.174626e-04 3 1  ON 36
ci_38                -2.861673e-04 3 1  ON 37
ci_39                -1.421259e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127560e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655936e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545600e-04 3 1  ON 48
ci_50                -8.205369e-04 3 1  ON 49
ci_51                -5.674903e-04 3 1  ON 50
ci_52                -6.318154e-04 3 1  ON 51
ci_53                -8.017830e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859389e-04 3 1  ON 57
ci_59                -6.202996e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876590e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475838e-04 3 1  ON 62
ci_64                -6.090052e-04 3 1  ON 63
ci_65                -1.061370e-04 3 1  ON 64
ci_66                -1.252770e-04 3 1  ON 65
ci_67                -1.925952e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2792e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8405
    reference variance = 0.408946
====================================================
  Execution time = 2.5597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4683e-01
  Total weights = 1.964819130e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434086663576
                                         uncertainty =       0.001888193510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434086663576
                                         uncertainty =       0.001888193510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465920783
  error estimate for blocks of size 2^( 2) =       0.000491406800
  error estimate for blocks of size 2^( 3) =       0.000515507994
  error estimate for blocks of size 2^( 4) =       0.000533297908
  error estimate for blocks of size 2^( 5) =       0.000544585810
  error estimate for blocks of size 2^( 6) =       0.000549784370
  error estimate for blocks of size 2^( 7) =       0.000554272752

      target function =      -0.747974437745
              le_mean =     -22.814211584765
             les_mean =     520.935079659992
             stat err =       0.000545485210
             autocorr =       1.370698041981
   target nu stat err =       0.000545485210
   target dn stat err =       0.002620178921
      target stat err =       0.002261786291
              std dev =       0.658911490844
             le_variance =       0.434164352766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421158477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747980318616       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747980318927       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747980319007       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747980319014       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747980318989       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747980318962       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747980318920       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747980319027       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747980319043       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 5.669495e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747980318616       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747980318693       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747980318714       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747980318719       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747980318721       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747980318722       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747980318974       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747980318676       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747980318533       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+05 is 1.417374e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747980318616       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747980318635       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747980318640       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747980318593       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747980318572       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747980319548       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747980318669       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747980319944       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747980319206       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+06 is 3.543436e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0149e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225009e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167477e-03 3 1  ON 14
ci_16                 5.730601e-03 3 1  ON 15
ci_17                -5.017492e-03 3 1  ON 16
ci_18                -5.545877e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882574e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794761e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707549e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411952e-04 3 1  ON 29
ci_31                 1.034578e-03 3 1  ON 30
ci_32                -5.358620e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659628e-04 3 1  ON 35
ci_37                -5.174627e-04 3 1  ON 36
ci_38                -2.861673e-04 3 1  ON 37
ci_39                -1.421260e-04 3 1  ON 38
ci_40                -1.905965e-03 3 1  ON 39
ci_41                -5.127562e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655936e-04 3 1  ON 44
ci_46                -1.694644e-03 3 1  ON 45
ci_47                 1.434986e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545602e-04 3 1  ON 48
ci_50                -8.205371e-04 3 1  ON 49
ci_51                -5.674903e-04 3 1  ON 50
ci_52                -6.318151e-04 3 1  ON 51
ci_53                -8.017831e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859392e-04 3 1  ON 57
ci_59                -6.202996e-04 3 1  ON 58
ci_60                 1.270269e-04 3 1  ON 59
ci_61                -9.876590e-04 3 1  ON 60
ci_62                -3.821453e-04 3 1  ON 61
ci_63                -2.475840e-04 3 1  ON 62
ci_64                -6.090050e-04 3 1  ON 63
ci_65                -1.061372e-04 3 1  ON 64
ci_66                -1.252773e-04 3 1  ON 65
ci_67                -1.925954e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8016
    reference variance = 0.342773
====================================================
  Execution time = 2.5374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4421e-01
  Total weights = 1.9648e+06
  Execution time = 3.5524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144779
                                         uncertainty =       0.001682585376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144779
                                         uncertainty =       0.001682585376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465300447
  error estimate for blocks of size 2^( 2) =       0.000491071391
  error estimate for blocks of size 2^( 3) =       0.000516108598
  error estimate for blocks of size 2^( 4) =       0.000534362494
  error estimate for blocks of size 2^( 5) =       0.000545484247
  error estimate for blocks of size 2^( 6) =       0.000551009513
  error estimate for blocks of size 2^( 7) =       0.000553281026

      target function =      -0.750168687866
              le_mean =     -22.814602507559
             les_mean =     520.950292674283
             stat err =       0.000546034320
             autocorr =       1.377123662413
   target nu stat err =       0.000546034320
   target dn stat err =       0.002286633356
      target stat err =       0.002008486485
              std dev =       0.658034203269
             le_variance =       0.433009012672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144716
                                         uncertainty =       0.001682585437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144716
                                         uncertainty =       0.001682585437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465300447
  error estimate for blocks of size 2^( 2) =       0.000491071390
  error estimate for blocks of size 2^( 3) =       0.000516108598
  error estimate for blocks of size 2^( 4) =       0.000534362494
  error estimate for blocks of size 2^( 5) =       0.000545484246
  error estimate for blocks of size 2^( 6) =       0.000551009512
  error estimate for blocks of size 2^( 7) =       0.000553281025

      target function =      -0.750168688767
              le_mean =     -22.814602507544
             les_mean =     520.950292672487
             stat err =       0.000546034319
             autocorr =       1.377123657737
   target nu stat err =       0.000546034319
   target dn stat err =       0.002286633552
      target stat err =       0.002008486646
              std dev =       0.658034203222
             le_variance =       0.433009012610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144747
                                         uncertainty =       0.001682585407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144747
                                         uncertainty =       0.001682585407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465300447
  error estimate for blocks of size 2^( 2) =       0.000491071390
  error estimate for blocks of size 2^( 3) =       0.000516108598
  error estimate for blocks of size 2^( 4) =       0.000534362494
  error estimate for blocks of size 2^( 5) =       0.000545484246
  error estimate for blocks of size 2^( 6) =       0.000551009513
  error estimate for blocks of size 2^( 7) =       0.000553281025

      target function =      -0.750168688316
              le_mean =     -22.814602507551
             les_mean =     520.950292673385
             stat err =       0.000546034320
             autocorr =       1.377123660077
   target nu stat err =       0.000546034320
   target dn stat err =       0.002286633454
      target stat err =       0.002008486566
              std dev =       0.658034203245
             le_variance =       0.433009012641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144775
                                         uncertainty =       0.001682585380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433036144775
                                         uncertainty =       0.001682585380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465300447
  error estimate for blocks of size 2^( 2) =       0.000491071391
  error estimate for blocks of size 2^( 3) =       0.000516108598
  error estimate for blocks of size 2^( 4) =       0.000534362494
  error estimate for blocks of size 2^( 5) =       0.000545484247
  error estimate for blocks of size 2^( 6) =       0.000551009513
  error estimate for blocks of size 2^( 7) =       0.000553281026

      target function =      -0.750168687922
              le_mean =     -22.814602507558
             les_mean =     520.950292674171
             stat err =       0.000546034320
             autocorr =       1.377123662116
   target nu stat err =       0.000546034320
   target dn stat err =       0.002286633368
      target stat err =       0.002008486495
              std dev =       0.658034203266
             le_variance =       0.433009012668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750168687866        initial
     6.2500e+04     6.2500e+05             5.6695e-09        -0.750168688767  <--
     2.5000e+05     2.5000e+06             1.4174e-09        -0.750168688316
     1.0000e+06     1.0000e+07             3.5434e-10        -0.750168687922

*****************************************************************************
Applying the update for shift_i =   6.2500e+04     and shift_s =   6.2500e+05
*****************************************************************************

  Execution time = 4.3095e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225010e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167477e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545878e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483878e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707561e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411961e-04 3 1  ON 29
ci_31                 1.034577e-03 3 1  ON 30
ci_32                -5.358619e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659630e-04 3 1  ON 35
ci_37                -5.174629e-04 3 1  ON 36
ci_38                -2.861672e-04 3 1  ON 37
ci_39                -1.421263e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127567e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655936e-04 3 1  ON 44
ci_46                -1.694643e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545608e-04 3 1  ON 48
ci_50                -8.205379e-04 3 1  ON 49
ci_51                -5.674904e-04 3 1  ON 50
ci_52                -6.318143e-04 3 1  ON 51
ci_53                -8.017832e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859401e-04 3 1  ON 57
ci_59                -6.202996e-04 3 1  ON 58
ci_60                 1.270274e-04 3 1  ON 59
ci_61                -9.876592e-04 3 1  ON 60
ci_62                -3.821453e-04 3 1  ON 61
ci_63                -2.475844e-04 3 1  ON 62
ci_64                -6.090045e-04 3 1  ON 63
ci_65                -1.061377e-04 3 1  ON 64
ci_66                -1.252781e-04 3 1  ON 65
ci_67                -1.925958e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2795e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8241
    reference variance = 0.346377
====================================================
  Execution time = 2.5654e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4886e-01
  Total weights = 1.964700549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436483892049
                                         uncertainty =       0.002188216290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436483892049
                                         uncertainty =       0.002188216290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467191180
  error estimate for blocks of size 2^( 2) =       0.000492796317
  error estimate for blocks of size 2^( 3) =       0.000517145489
  error estimate for blocks of size 2^( 4) =       0.000534726129
  error estimate for blocks of size 2^( 5) =       0.000547432883
  error estimate for blocks of size 2^( 6) =       0.000554017625
  error estimate for blocks of size 2^( 7) =       0.000556723800

      target function =      -0.746288668719
              le_mean =     -22.814653941690
             les_mean =     520.957297400981
             stat err =       0.000548225109
             autocorr =       1.376982990175
   target nu stat err =       0.000548225109
   target dn stat err =       0.002695907611
      target stat err =       0.002314737764
              std dev =       0.660708102670
             le_variance =       0.436535196933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465394169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746294924351       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746294925571       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746294925802       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746294925826       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746294925844       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746294925845       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746294925843       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746294925843       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746294925843       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.734411e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746294924351       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746294924656       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746294924714       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746294924720       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746294924724       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746294924724       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746294924724       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746294924724       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746294924724       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 4.336032e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746294924351       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746294924427       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746294924441       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746294924443       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746294924444       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746294924444       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746294924444       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746294924444       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746294924444       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+05 is 1.084008e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0185e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399860e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225011e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167479e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017494e-03 3 1  ON 16
ci_18                -5.545878e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483878e-03 3 1  ON 20
ci_22                 8.882572e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707560e-04 3 1  ON 27
ci_29                 1.186540e-03 3 1  ON 28
ci_30                -7.411956e-04 3 1  ON 29
ci_31                 1.034577e-03 3 1  ON 30
ci_32                -5.358627e-04 3 1  ON 31
ci_33                -1.032761e-03 3 1  ON 32
ci_34                 1.151546e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659625e-04 3 1  ON 35
ci_37                -5.174639e-04 3 1  ON 36
ci_38                -2.861670e-04 3 1  ON 37
ci_39                -1.421269e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127575e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655934e-04 3 1  ON 44
ci_46                -1.694642e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545611e-04 3 1  ON 48
ci_50                -8.205381e-04 3 1  ON 49
ci_51                -5.674898e-04 3 1  ON 50
ci_52                -6.318141e-04 3 1  ON 51
ci_53                -8.017838e-04 3 1  ON 52
ci_54                -1.110005e-03 3 1  ON 53
ci_55                -1.237023e-03 3 1  ON 54
ci_56                 1.098315e-03 3 1  ON 55
ci_57                 2.090268e-03 3 1  ON 56
ci_58                -1.859402e-04 3 1  ON 57
ci_59                -6.202989e-04 3 1  ON 58
ci_60                 1.270278e-04 3 1  ON 59
ci_61                -9.876586e-04 3 1  ON 60
ci_62                -3.821449e-04 3 1  ON 61
ci_63                -2.475853e-04 3 1  ON 62
ci_64                -6.090047e-04 3 1  ON 63
ci_65                -1.061379e-04 3 1  ON 64
ci_66                -1.252788e-04 3 1  ON 65
ci_67                -1.925958e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8386
    reference variance = 0.378466
====================================================
  Execution time = 2.6759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4536e-01
  Total weights = 1.9649e+06
  Execution time = 3.5257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408797
                                         uncertainty =       0.001851730114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408797
                                         uncertainty =       0.001851730114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466342903
  error estimate for blocks of size 2^( 2) =       0.000492819127
  error estimate for blocks of size 2^( 3) =       0.000517313270
  error estimate for blocks of size 2^( 4) =       0.000535034387
  error estimate for blocks of size 2^( 5) =       0.000547353756
  error estimate for blocks of size 2^( 6) =       0.000555462583
  error estimate for blocks of size 2^( 7) =       0.000561391087

      target function =      -0.749199684925
              le_mean =     -22.814364010549
             les_mean =     520.940567140341
             stat err =       0.000549810453
             autocorr =       1.390001408828
   target nu stat err =       0.000549810453
   target dn stat err =       0.002282979972
      target stat err =       0.002001207627
              std dev =       0.659508458806
             le_variance =       0.434951407236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408714
                                         uncertainty =       0.001851730240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408714
                                         uncertainty =       0.001851730240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466342903
  error estimate for blocks of size 2^( 2) =       0.000492819126
  error estimate for blocks of size 2^( 3) =       0.000517313268
  error estimate for blocks of size 2^( 4) =       0.000535034384
  error estimate for blocks of size 2^( 5) =       0.000547353753
  error estimate for blocks of size 2^( 6) =       0.000555462579
  error estimate for blocks of size 2^( 7) =       0.000561391083

      target function =      -0.749199684840
              le_mean =     -22.814364010582
             les_mean =     520.940567141928
             stat err =       0.000549810450
             autocorr =       1.390001391816
   target nu stat err =       0.000549810450
   target dn stat err =       0.002282979892
      target stat err =       0.002001207562
              std dev =       0.659508458743
             le_variance =       0.434951407153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408756
                                         uncertainty =       0.001851730177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408756
                                         uncertainty =       0.001851730177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466342903
  error estimate for blocks of size 2^( 2) =       0.000492819126
  error estimate for blocks of size 2^( 3) =       0.000517313269
  error estimate for blocks of size 2^( 4) =       0.000535034386
  error estimate for blocks of size 2^( 5) =       0.000547353755
  error estimate for blocks of size 2^( 6) =       0.000555462581
  error estimate for blocks of size 2^( 7) =       0.000561391085

      target function =      -0.749199684883
              le_mean =     -22.814364010565
             les_mean =     520.940567141134
             stat err =       0.000549810451
             autocorr =       1.390001400327
   target nu stat err =       0.000549810451
   target dn stat err =       0.002282979932
      target stat err =       0.002001207595
              std dev =       0.659508458774
             le_variance =       0.434951407195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408792
                                         uncertainty =       0.001851730121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434863408792
                                         uncertainty =       0.001851730121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466342903
  error estimate for blocks of size 2^( 2) =       0.000492819127
  error estimate for blocks of size 2^( 3) =       0.000517313270
  error estimate for blocks of size 2^( 4) =       0.000535034387
  error estimate for blocks of size 2^( 5) =       0.000547353756
  error estimate for blocks of size 2^( 6) =       0.000555462583
  error estimate for blocks of size 2^( 7) =       0.000561391086

      target function =      -0.749199684920
              le_mean =     -22.814364010551
             les_mean =     520.940567140440
             stat err =       0.000549810453
             autocorr =       1.390001407768
   target nu stat err =       0.000549810453
   target dn stat err =       0.002282979967
      target stat err =       0.002001207623
              std dev =       0.659508458802
             le_variance =       0.434951407231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749199684925        initial  <--
     1.5625e+04     1.5625e+05             1.7344e-08        -0.749199684840
     6.2500e+04     6.2500e+05             4.3360e-09        -0.749199684883
     2.5000e+05     2.5000e+06             1.0840e-09        -0.749199684920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3884
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225010e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167477e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545878e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483878e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707561e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411961e-04 3 1  ON 29
ci_31                 1.034577e-03 3 1  ON 30
ci_32                -5.358619e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659630e-04 3 1  ON 35
ci_37                -5.174629e-04 3 1  ON 36
ci_38                -2.861672e-04 3 1  ON 37
ci_39                -1.421263e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127567e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655936e-04 3 1  ON 44
ci_46                -1.694643e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545608e-04 3 1  ON 48
ci_50                -8.205379e-04 3 1  ON 49
ci_51                -5.674904e-04 3 1  ON 50
ci_52                -6.318143e-04 3 1  ON 51
ci_53                -8.017832e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859401e-04 3 1  ON 57
ci_59                -6.202996e-04 3 1  ON 58
ci_60                 1.270274e-04 3 1  ON 59
ci_61                -9.876592e-04 3 1  ON 60
ci_62                -3.821453e-04 3 1  ON 61
ci_63                -2.475844e-04 3 1  ON 62
ci_64                -6.090045e-04 3 1  ON 63
ci_65                -1.061377e-04 3 1  ON 64
ci_66                -1.252781e-04 3 1  ON 65
ci_67                -1.925958e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2798e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6774
    reference variance = 0.61548
====================================================
  Execution time = 2.5398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5049e-01
  Total weights = 1.964877778e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435496213513
                                         uncertainty =       0.002084038456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435496213513
                                         uncertainty =       0.002084038456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466626615
  error estimate for blocks of size 2^( 2) =       0.000492406143
  error estimate for blocks of size 2^( 3) =       0.000516848298
  error estimate for blocks of size 2^( 4) =       0.000535446167
  error estimate for blocks of size 2^( 5) =       0.000546980925
  error estimate for blocks of size 2^( 6) =       0.000552540634
  error estimate for blocks of size 2^( 7) =       0.000553491477

      target function =      -0.744941324551
              le_mean =     -22.814752028096
             les_mean =     520.963395671525
             stat err =       0.000547114801
             autocorr =       1.374731596013
   target nu stat err =       0.000547114801
   target dn stat err =       0.003679186299
      target stat err =       0.003097262949
              std dev =       0.659909688144
             le_variance =       0.435480796506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281475202810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744953290723       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744953290881       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744953290904       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744953290908       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744953290887       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744953290857       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744953290954       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744953291000       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744953290883       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744953290636       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 2.066834e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744953290723       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744953290763       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744953290768       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744953290770       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744953290806       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744953289919       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744953290142       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744953289277       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744953290436       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744953290722       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+05 is 5.167085e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744953290723       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744953290733       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744953290735       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744953289070       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744953290760       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744953289434       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744953291349       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744953297940       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744953288821       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744953290727       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+06 is 1.291772e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9938e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225010e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167478e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545878e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483878e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707561e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411962e-04 3 1  ON 29
ci_31                 1.034577e-03 3 1  ON 30
ci_32                -5.358620e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659631e-04 3 1  ON 35
ci_37                -5.174629e-04 3 1  ON 36
ci_38                -2.861672e-04 3 1  ON 37
ci_39                -1.421263e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127567e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655936e-04 3 1  ON 44
ci_46                -1.694643e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894154e-03 3 1  ON 47
ci_49                -8.545607e-04 3 1  ON 48
ci_50                -8.205379e-04 3 1  ON 49
ci_51                -5.674903e-04 3 1  ON 50
ci_52                -6.318143e-04 3 1  ON 51
ci_53                -8.017832e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098314e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859402e-04 3 1  ON 57
ci_59                -6.202997e-04 3 1  ON 58
ci_60                 1.270273e-04 3 1  ON 59
ci_61                -9.876591e-04 3 1  ON 60
ci_62                -3.821453e-04 3 1  ON 61
ci_63                -2.475844e-04 3 1  ON 62
ci_64                -6.090044e-04 3 1  ON 63
ci_65                -1.061377e-04 3 1  ON 64
ci_66                -1.252780e-04 3 1  ON 65
ci_67                -1.925959e-04 3 1  ON 66
ci_68                -1.799117e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.9406
    reference variance = 0.408719
====================================================
  Execution time = 2.4907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4686e-01
  Total weights = 1.9646e+06
  Execution time = 3.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713858
                                         uncertainty =       0.001959845618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713858
                                         uncertainty =       0.001959845618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466481316
  error estimate for blocks of size 2^( 2) =       0.000492033936
  error estimate for blocks of size 2^( 3) =       0.000516328514
  error estimate for blocks of size 2^( 4) =       0.000534923685
  error estimate for blocks of size 2^( 5) =       0.000546536747
  error estimate for blocks of size 2^( 6) =       0.000551398897
  error estimate for blocks of size 2^( 7) =       0.000554103757

      target function =      -0.747955728946
              le_mean =     -22.814685147387
             les_mean =     520.956714965224
             stat err =       0.000546740772
             autocorr =       1.373707960714
   target nu stat err =       0.000546740772
   target dn stat err =       0.002470141161
      target stat err =       0.002143644142
              std dev =       0.659704204012
             le_variance =       0.435209636791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713706
                                         uncertainty =       0.001959845622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713706
                                         uncertainty =       0.001959845622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466481316
  error estimate for blocks of size 2^( 2) =       0.000492033936
  error estimate for blocks of size 2^( 3) =       0.000516328514
  error estimate for blocks of size 2^( 4) =       0.000534923684
  error estimate for blocks of size 2^( 5) =       0.000546536747
  error estimate for blocks of size 2^( 6) =       0.000551398896
  error estimate for blocks of size 2^( 7) =       0.000554103757

      target function =      -0.747955730264
              le_mean =     -22.814685147401
             les_mean =     520.956714964297
             stat err =       0.000546740771
             autocorr =       1.373707958735
   target nu stat err =       0.000546740771
   target dn stat err =       0.002470141055
      target stat err =       0.002143644065
              std dev =       0.659704203896
             le_variance =       0.435209636638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713782
                                         uncertainty =       0.001959845620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713782
                                         uncertainty =       0.001959845620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466481316
  error estimate for blocks of size 2^( 2) =       0.000492033936
  error estimate for blocks of size 2^( 3) =       0.000516328514
  error estimate for blocks of size 2^( 4) =       0.000534923684
  error estimate for blocks of size 2^( 5) =       0.000546536747
  error estimate for blocks of size 2^( 6) =       0.000551398897
  error estimate for blocks of size 2^( 7) =       0.000554103757

      target function =      -0.747955729605
              le_mean =     -22.814685147394
             les_mean =     520.956714964760
             stat err =       0.000546740771
             autocorr =       1.373707959727
   target nu stat err =       0.000546740771
   target dn stat err =       0.002470141108
      target stat err =       0.002143644103
              std dev =       0.659704203954
             le_variance =       0.435209636715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713849
                                         uncertainty =       0.001959845618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435201713849
                                         uncertainty =       0.001959845618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466481316
  error estimate for blocks of size 2^( 2) =       0.000492033936
  error estimate for blocks of size 2^( 3) =       0.000516328514
  error estimate for blocks of size 2^( 4) =       0.000534923685
  error estimate for blocks of size 2^( 5) =       0.000546536747
  error estimate for blocks of size 2^( 6) =       0.000551398897
  error estimate for blocks of size 2^( 7) =       0.000554103757

      target function =      -0.747955729029
              le_mean =     -22.814685147388
             les_mean =     520.956714965166
             stat err =       0.000546740772
             autocorr =       1.373707960579
   target nu stat err =       0.000546740772
   target dn stat err =       0.002470141154
      target stat err =       0.002143644137
              std dev =       0.659704204005
             le_variance =       0.435209636782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747955728946        initial
     1.5625e+05     1.5625e+06             2.0668e-09        -0.747955730264  <--
     6.2500e+05     6.2500e+06             5.1671e-10        -0.747955729605
     2.5000e+06     2.5000e+07             1.2918e-10        -0.747955729029

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 4.2528e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225011e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167478e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545878e-03 3 1  ON 17
ci_19                 1.033115e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483878e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168285e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707561e-04 3 1  ON 27
ci_29                 1.186541e-03 3 1  ON 28
ci_30                -7.411966e-04 3 1  ON 29
ci_31                 1.034577e-03 3 1  ON 30
ci_32                -5.358624e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659634e-04 3 1  ON 35
ci_37                -5.174628e-04 3 1  ON 36
ci_38                -2.861671e-04 3 1  ON 37
ci_39                -1.421262e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127570e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655936e-04 3 1  ON 44
ci_46                -1.694643e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894153e-03 3 1  ON 47
ci_49                -8.545607e-04 3 1  ON 48
ci_50                -8.205378e-04 3 1  ON 49
ci_51                -5.674898e-04 3 1  ON 50
ci_52                -6.318142e-04 3 1  ON 51
ci_53                -8.017832e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098315e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859405e-04 3 1  ON 57
ci_59                -6.202997e-04 3 1  ON 58
ci_60                 1.270273e-04 3 1  ON 59
ci_61                -9.876588e-04 3 1  ON 60
ci_62                -3.821454e-04 3 1  ON 61
ci_63                -2.475845e-04 3 1  ON 62
ci_64                -6.090042e-04 3 1  ON 63
ci_65                -1.061377e-04 3 1  ON 64
ci_66                -1.252780e-04 3 1  ON 65
ci_67                -1.925959e-04 3 1  ON 66
ci_68                -1.799116e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2472e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2799e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7801
    reference variance = 0.275771
====================================================
  Execution time = 2.5550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4910e-01
  Total weights = 1.964845910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436448758929
                                         uncertainty =       0.002332094433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436448758929
                                         uncertainty =       0.002332094433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467097234
  error estimate for blocks of size 2^( 2) =       0.000493114630
  error estimate for blocks of size 2^( 3) =       0.000517850994
  error estimate for blocks of size 2^( 4) =       0.000536564929
  error estimate for blocks of size 2^( 5) =       0.000549757803
  error estimate for blocks of size 2^( 6) =       0.000557365663
  error estimate for blocks of size 2^( 7) =       0.000562229116

      target function =      -0.746083417778
              le_mean =     -22.813362892172
             les_mean =     520.898628494414
             stat err =       0.000551479378
             autocorr =       1.393939619628
   target nu stat err =       0.000551479378
   target dn stat err =       0.002955809072
      target stat err =       0.002517798863
              std dev =       0.660575243911
             le_variance =       0.436359652868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281336289217e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746090895641       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746090896288       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746090896385       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746090896413       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746090896412       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746090896381       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746090896442       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746090896382       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746090896430       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 8.315617e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746090895641       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746090895803       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746090895827       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746090895835       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746090895909       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746090895926       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746090895648       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746090896063       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746090895676       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 2.078905e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746090895641       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746090895682       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746090895688       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746090895695       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746090895690       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746090894916       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746090896127       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746090894369       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746090895960       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+05 is 5.197264e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0077e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399859e-02 3 1  ON 1
ci_03                -2.427514e-02 3 1  ON 2
ci_04                 2.215356e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225011e-03 3 1  ON 7
ci_09                -7.549652e-03 3 1  ON 8
ci_10                -7.705367e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046990e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167479e-03 3 1  ON 14
ci_16                 5.730602e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545877e-03 3 1  ON 17
ci_19                 1.033114e-02 3 1  ON 18
ci_20                 6.254308e-03 3 1  ON 19
ci_21                 8.483878e-03 3 1  ON 20
ci_22                 8.882573e-03 3 1  ON 21
ci_23                 4.168286e-03 3 1  ON 22
ci_24                 5.186779e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794760e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707560e-04 3 1  ON 27
ci_29                 1.186540e-03 3 1  ON 28
ci_30                -7.411965e-04 3 1  ON 29
ci_31                 1.034576e-03 3 1  ON 30
ci_32                -5.358626e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151547e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659635e-04 3 1  ON 35
ci_37                -5.174628e-04 3 1  ON 36
ci_38                -2.861672e-04 3 1  ON 37
ci_39                -1.421262e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127570e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292187e-03 3 1  ON 42
ci_44                -2.176901e-03 3 1  ON 43
ci_45                -2.655934e-04 3 1  ON 44
ci_46                -1.694642e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894153e-03 3 1  ON 47
ci_49                -8.545606e-04 3 1  ON 48
ci_50                -8.205378e-04 3 1  ON 49
ci_51                -5.674897e-04 3 1  ON 50
ci_52                -6.318141e-04 3 1  ON 51
ci_53                -8.017834e-04 3 1  ON 52
ci_54                -1.110006e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098315e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859406e-04 3 1  ON 57
ci_59                -6.203000e-04 3 1  ON 58
ci_60                 1.270272e-04 3 1  ON 59
ci_61                -9.876588e-04 3 1  ON 60
ci_62                -3.821453e-04 3 1  ON 61
ci_63                -2.475845e-04 3 1  ON 62
ci_64                -6.090041e-04 3 1  ON 63
ci_65                -1.061378e-04 3 1  ON 64
ci_66                -1.252782e-04 3 1  ON 65
ci_67                -1.925960e-04 3 1  ON 66
ci_68                -1.799116e-03 3 1  ON 67
ci_69                -1.808529e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6991
    reference variance = 0.356049
====================================================
  Execution time = 2.6975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4847e-01
  Total weights = 1.9647e+06
  Execution time = 3.5222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207629
                                         uncertainty =       0.002311646904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207629
                                         uncertainty =       0.002311646904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537137
  error estimate for blocks of size 2^( 2) =       0.000493223046
  error estimate for blocks of size 2^( 3) =       0.000517684707
  error estimate for blocks of size 2^( 4) =       0.000536070236
  error estimate for blocks of size 2^( 5) =       0.000547652499
  error estimate for blocks of size 2^( 6) =       0.000554555009
  error estimate for blocks of size 2^( 7) =       0.000559494158

      target function =      -0.746616510264
              le_mean =     -22.814972517932
             les_mean =     520.971440935711
             stat err =       0.000549442976
             autocorr =       1.381061521655
   target nu stat err =       0.000549442976
   target dn stat err =       0.002518715717
      target stat err =       0.002176699882
              std dev =       0.661197359578
             le_variance =       0.437181948313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207120
                                         uncertainty =       0.002311646951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207120
                                         uncertainty =       0.002311646951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537136
  error estimate for blocks of size 2^( 2) =       0.000493223045
  error estimate for blocks of size 2^( 3) =       0.000517684705
  error estimate for blocks of size 2^( 4) =       0.000536070235
  error estimate for blocks of size 2^( 5) =       0.000547652497
  error estimate for blocks of size 2^( 6) =       0.000554555008
  error estimate for blocks of size 2^( 7) =       0.000559494156

      target function =      -0.746616522681
              le_mean =     -22.814972517966
             les_mean =     520.971440922292
             stat err =       0.000549442974
             autocorr =       1.381061514875
   target nu stat err =       0.000549442974
   target dn stat err =       0.002518715557
      target stat err =       0.002176699824
              std dev =       0.661197359192
             le_variance =       0.437181947803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207375
                                         uncertainty =       0.002311646927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207375
                                         uncertainty =       0.002311646927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537137
  error estimate for blocks of size 2^( 2) =       0.000493223045
  error estimate for blocks of size 2^( 3) =       0.000517684706
  error estimate for blocks of size 2^( 4) =       0.000536070235
  error estimate for blocks of size 2^( 5) =       0.000547652498
  error estimate for blocks of size 2^( 6) =       0.000554555009
  error estimate for blocks of size 2^( 7) =       0.000559494157

      target function =      -0.746616516483
              le_mean =     -22.814972517949
             les_mean =     520.971440928988
             stat err =       0.000549442975
             autocorr =       1.381061518272
   target nu stat err =       0.000549442975
   target dn stat err =       0.002518715637
      target stat err =       0.002176699853
              std dev =       0.661197359385
             le_variance =       0.437181948058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207598
                                         uncertainty =       0.002311646907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437115207598
                                         uncertainty =       0.002311646907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537137
  error estimate for blocks of size 2^( 2) =       0.000493223046
  error estimate for blocks of size 2^( 3) =       0.000517684706
  error estimate for blocks of size 2^( 4) =       0.000536070236
  error estimate for blocks of size 2^( 5) =       0.000547652499
  error estimate for blocks of size 2^( 6) =       0.000554555009
  error estimate for blocks of size 2^( 7) =       0.000559494158

      target function =      -0.746616511042
              le_mean =     -22.814972517934
             les_mean =     520.971440934869
             stat err =       0.000549442975
             autocorr =       1.381061521232
   target nu stat err =       0.000549442975
   target dn stat err =       0.002518715707
      target stat err =       0.002176699878
              std dev =       0.661197359554
             le_variance =       0.437181948281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746616510264        initial
     3.9062e+04     3.9062e+05             8.3156e-09        -0.746616522681  <--
     1.5625e+05     1.5625e+06             2.0789e-09        -0.746616516483
     6.2500e+05     6.2500e+06             5.1973e-10        -0.746616511042

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 4.4603e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399860e-02 3 1  ON 1
ci_03                -2.427515e-02 3 1  ON 2
ci_04                 2.215357e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225011e-03 3 1  ON 7
ci_09                -7.549650e-03 3 1  ON 8
ci_10                -7.705366e-03 3 1  ON 9
ci_11                 1.374813e-02 3 1  ON 10
ci_12                 7.046988e-03 3 1  ON 11
ci_13                 1.381577e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167481e-03 3 1  ON 14
ci_16                 5.730604e-03 3 1  ON 15
ci_17                -5.017493e-03 3 1  ON 16
ci_18                -5.545876e-03 3 1  ON 17
ci_19                 1.033114e-02 3 1  ON 18
ci_20                 6.254307e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882572e-03 3 1  ON 21
ci_23                 4.168287e-03 3 1  ON 22
ci_24                 5.186778e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794759e-03 3 1  ON 25
ci_27                 3.289109e-03 3 1  ON 26
ci_28                 7.707556e-04 3 1  ON 27
ci_29                 1.186539e-03 3 1  ON 28
ci_30                -7.411961e-04 3 1  ON 29
ci_31                 1.034575e-03 3 1  ON 30
ci_32                -5.358634e-04 3 1  ON 31
ci_33                -1.032759e-03 3 1  ON 32
ci_34                 1.151548e-03 3 1  ON 33
ci_35                 1.248315e-03 3 1  ON 34
ci_36                -5.659641e-04 3 1  ON 35
ci_37                -5.174628e-04 3 1  ON 36
ci_38                -2.861675e-04 3 1  ON 37
ci_39                -1.421263e-04 3 1  ON 38
ci_40                -1.905964e-03 3 1  ON 39
ci_41                -5.127570e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292189e-03 3 1  ON 42
ci_44                -2.176900e-03 3 1  ON 43
ci_45                -2.655928e-04 3 1  ON 44
ci_46                -1.694640e-03 3 1  ON 45
ci_47                 1.434987e-03 3 1  ON 46
ci_48                 2.894153e-03 3 1  ON 47
ci_49                -8.545604e-04 3 1  ON 48
ci_50                -8.205378e-04 3 1  ON 49
ci_51                -5.674894e-04 3 1  ON 50
ci_52                -6.318136e-04 3 1  ON 51
ci_53                -8.017841e-04 3 1  ON 52
ci_54                -1.110005e-03 3 1  ON 53
ci_55                -1.237023e-03 3 1  ON 54
ci_56                 1.098317e-03 3 1  ON 55
ci_57                 2.090267e-03 3 1  ON 56
ci_58                -1.859408e-04 3 1  ON 57
ci_59                -6.203009e-04 3 1  ON 58
ci_60                 1.270268e-04 3 1  ON 59
ci_61                -9.876587e-04 3 1  ON 60
ci_62                -3.821450e-04 3 1  ON 61
ci_63                -2.475845e-04 3 1  ON 62
ci_64                -6.090035e-04 3 1  ON 63
ci_65                -1.061378e-04 3 1  ON 64
ci_66                -1.252787e-04 3 1  ON 65
ci_67                -1.925962e-04 3 1  ON 66
ci_68                -1.799115e-03 3 1  ON 67
ci_69                -1.808528e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2794e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8167
    reference variance = 0.576728
====================================================
  Execution time = 2.5766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5063e-01
  Total weights = 1.964673635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434860817638
                                         uncertainty =       0.002494839121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434860817638
                                         uncertainty =       0.002494839121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466357051
  error estimate for blocks of size 2^( 2) =       0.000491824940
  error estimate for blocks of size 2^( 3) =       0.000516189481
  error estimate for blocks of size 2^( 4) =       0.000534297297
  error estimate for blocks of size 2^( 5) =       0.000546471317
  error estimate for blocks of size 2^( 6) =       0.000553879552
  error estimate for blocks of size 2^( 7) =       0.000557129533

      target function =      -0.744802153841
              le_mean =     -22.814589329484
             les_mean =     520.956111581832
             stat err =       0.000547944425
             autocorr =       1.380498469757
   target nu stat err =       0.000547944425
   target dn stat err =       0.006266940863
      target stat err =       0.005206133670
              std dev =       0.659528466591
             le_variance =       0.434977798244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281458932948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744837672350       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744837675392       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744837675915       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744837675996       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744837676010       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744837676021       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744837676007       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744837676013       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744837676021       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 3.436073e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744837672350       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744837673111       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744837673242       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744837673261       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744837673267       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744837673260       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744837673267       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744837673241       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744837673278       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 8.590202e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744837672350       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744837672540       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744837672573       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744837672578       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744837672565       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744837672389       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744837672570       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744837672579       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744837672550       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 2.147552e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0289e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399860e-02 3 1  ON 1
ci_03                -2.427515e-02 3 1  ON 2
ci_04                 2.215357e-02 3 1  ON 3
ci_05                -1.912990e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225013e-03 3 1  ON 7
ci_09                -7.549650e-03 3 1  ON 8
ci_10                -7.705368e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.046989e-03 3 1  ON 11
ci_13                 1.381577e-02 3 1  ON 12
ci_14                 1.281145e-02 3 1  ON 13
ci_15                 5.167483e-03 3 1  ON 14
ci_16                 5.730603e-03 3 1  ON 15
ci_17                -5.017494e-03 3 1  ON 16
ci_18                -5.545877e-03 3 1  ON 17
ci_19                 1.033114e-02 3 1  ON 18
ci_20                 6.254306e-03 3 1  ON 19
ci_21                 8.483877e-03 3 1  ON 20
ci_22                 8.882571e-03 3 1  ON 21
ci_23                 4.168288e-03 3 1  ON 22
ci_24                 5.186777e-03 3 1  ON 23
ci_25                 3.011424e-03 3 1  ON 24
ci_26                 3.794758e-03 3 1  ON 25
ci_27                 3.289108e-03 3 1  ON 26
ci_28                 7.707570e-04 3 1  ON 27
ci_29                 1.186540e-03 3 1  ON 28
ci_30                -7.411960e-04 3 1  ON 29
ci_31                 1.034573e-03 3 1  ON 30
ci_32                -5.358628e-04 3 1  ON 31
ci_33                -1.032760e-03 3 1  ON 32
ci_34                 1.151548e-03 3 1  ON 33
ci_35                 1.248314e-03 3 1  ON 34
ci_36                -5.659651e-04 3 1  ON 35
ci_37                -5.174631e-04 3 1  ON 36
ci_38                -2.861683e-04 3 1  ON 37
ci_39                -1.421266e-04 3 1  ON 38
ci_40                -1.905962e-03 3 1  ON 39
ci_41                -5.127588e-04 3 1  ON 40
ci_42                -1.648324e-03 3 1  ON 41
ci_43                -1.292191e-03 3 1  ON 42
ci_44                -2.176900e-03 3 1  ON 43
ci_45                -2.655937e-04 3 1  ON 44
ci_46                -1.694640e-03 3 1  ON 45
ci_47                 1.434988e-03 3 1  ON 46
ci_48                 2.894152e-03 3 1  ON 47
ci_49                -8.545598e-04 3 1  ON 48
ci_50                -8.205381e-04 3 1  ON 49
ci_51                -5.674882e-04 3 1  ON 50
ci_52                -6.318130e-04 3 1  ON 51
ci_53                -8.017842e-04 3 1  ON 52
ci_54                -1.110005e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098318e-03 3 1  ON 55
ci_57                 2.090268e-03 3 1  ON 56
ci_58                -1.859420e-04 3 1  ON 57
ci_59                -6.203017e-04 3 1  ON 58
ci_60                 1.270257e-04 3 1  ON 59
ci_61                -9.876599e-04 3 1  ON 60
ci_62                -3.821455e-04 3 1  ON 61
ci_63                -2.475847e-04 3 1  ON 62
ci_64                -6.090031e-04 3 1  ON 63
ci_65                -1.061380e-04 3 1  ON 64
ci_66                -1.252805e-04 3 1  ON 65
ci_67                -1.925969e-04 3 1  ON 66
ci_68                -1.799115e-03 3 1  ON 67
ci_69                -1.808525e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8466
    reference variance = 0.472276
====================================================
  Execution time = 2.5006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5430e-01
  Total weights = 1.9648e+06
  Execution time = 3.5198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772017692
                                         uncertainty =       0.002309154684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772017692
                                         uncertainty =       0.002309154684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468356477
  error estimate for blocks of size 2^( 2) =       0.000493881542
  error estimate for blocks of size 2^( 3) =       0.000518430296
  error estimate for blocks of size 2^( 4) =       0.000536005842
  error estimate for blocks of size 2^( 5) =       0.000547440810
  error estimate for blocks of size 2^( 6) =       0.000553291501
  error estimate for blocks of size 2^( 7) =       0.000554935455

      target function =      -0.741808666689
              le_mean =     -22.814564438783
             les_mean =     520.958648805532
             stat err =       0.000547918402
             autocorr =       1.368606856989
   target nu stat err =       0.000547918402
   target dn stat err =       0.003427423268
      target stat err =       0.002869356345
              std dev =       0.662356081999
             le_variance =       0.438715579361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772013572
                                         uncertainty =       0.002309154775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772013572
                                         uncertainty =       0.002309154775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468356475
  error estimate for blocks of size 2^( 2) =       0.000493881537
  error estimate for blocks of size 2^( 3) =       0.000518430290
  error estimate for blocks of size 2^( 4) =       0.000536005833
  error estimate for blocks of size 2^( 5) =       0.000547440800
  error estimate for blocks of size 2^( 6) =       0.000553291491
  error estimate for blocks of size 2^( 7) =       0.000554935445

      target function =      -0.741808677292
              le_mean =     -22.814564438952
             les_mean =     520.958648800311
             stat err =       0.000547918392
             autocorr =       1.368606821603
   target nu stat err =       0.000547918392
   target dn stat err =       0.003427420874
      target stat err =       0.002869354508
              std dev =       0.662356078885
             le_variance =       0.438715575235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772015632
                                         uncertainty =       0.002309154730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772015632
                                         uncertainty =       0.002309154730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468356476
  error estimate for blocks of size 2^( 2) =       0.000493881540
  error estimate for blocks of size 2^( 3) =       0.000518430293
  error estimate for blocks of size 2^( 4) =       0.000536005838
  error estimate for blocks of size 2^( 5) =       0.000547440805
  error estimate for blocks of size 2^( 6) =       0.000553291496
  error estimate for blocks of size 2^( 7) =       0.000554935450

      target function =      -0.741808671990
              le_mean =     -22.814564438867
             les_mean =     520.958648802921
             stat err =       0.000547918397
             autocorr =       1.368606839294
   target nu stat err =       0.000547918397
   target dn stat err =       0.003427422071
      target stat err =       0.002869355427
              std dev =       0.662356080442
             le_variance =       0.438715577298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772017434
                                         uncertainty =       0.002309154690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438772017434
                                         uncertainty =       0.002309154690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468356477
  error estimate for blocks of size 2^( 2) =       0.000493881542
  error estimate for blocks of size 2^( 3) =       0.000518430296
  error estimate for blocks of size 2^( 4) =       0.000536005841
  error estimate for blocks of size 2^( 5) =       0.000547440809
  error estimate for blocks of size 2^( 6) =       0.000553291500
  error estimate for blocks of size 2^( 7) =       0.000554935454

      target function =      -0.741808667352
              le_mean =     -22.814564438793
             les_mean =     520.958648805206
             stat err =       0.000547918401
             autocorr =       1.368606854780
   target nu stat err =       0.000547918401
   target dn stat err =       0.003427423119
      target stat err =       0.002869356231
              std dev =       0.662356081804
             le_variance =       0.438715579103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741808666689        initial
     9.7656e+03     9.7656e+04             3.4361e-08        -0.741808677292  <--
     3.9062e+04     3.9062e+05             8.5902e-09        -0.741808671990
     1.5625e+05     1.5625e+06             2.1476e-09        -0.741808667352

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 4.2627e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399862e-02 3 1  ON 1
ci_03                -2.427517e-02 3 1  ON 2
ci_04                 2.215358e-02 3 1  ON 3
ci_05                -1.912991e-02 3 1  ON 4
ci_06                -1.952699e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225017e-03 3 1  ON 7
ci_09                -7.549651e-03 3 1  ON 8
ci_10                -7.705372e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.046991e-03 3 1  ON 11
ci_13                 1.381577e-02 3 1  ON 12
ci_14                 1.281146e-02 3 1  ON 13
ci_15                 5.167487e-03 3 1  ON 14
ci_16                 5.730603e-03 3 1  ON 15
ci_17                -5.017494e-03 3 1  ON 16
ci_18                -5.545878e-03 3 1  ON 17
ci_19                 1.033114e-02 3 1  ON 18
ci_20                 6.254302e-03 3 1  ON 19
ci_21                 8.483879e-03 3 1  ON 20
ci_22                 8.882569e-03 3 1  ON 21
ci_23                 4.168292e-03 3 1  ON 22
ci_24                 5.186773e-03 3 1  ON 23
ci_25                 3.011422e-03 3 1  ON 24
ci_26                 3.794757e-03 3 1  ON 25
ci_27                 3.289106e-03 3 1  ON 26
ci_28                 7.707611e-04 3 1  ON 27
ci_29                 1.186544e-03 3 1  ON 28
ci_30                -7.411955e-04 3 1  ON 29
ci_31                 1.034567e-03 3 1  ON 30
ci_32                -5.358610e-04 3 1  ON 31
ci_33                -1.032762e-03 3 1  ON 32
ci_34                 1.151550e-03 3 1  ON 33
ci_35                 1.248311e-03 3 1  ON 34
ci_36                -5.659680e-04 3 1  ON 35
ci_37                -5.174639e-04 3 1  ON 36
ci_38                -2.861708e-04 3 1  ON 37
ci_39                -1.421273e-04 3 1  ON 38
ci_40                -1.905956e-03 3 1  ON 39
ci_41                -5.127640e-04 3 1  ON 40
ci_42                -1.648323e-03 3 1  ON 41
ci_43                -1.292197e-03 3 1  ON 42
ci_44                -2.176897e-03 3 1  ON 43
ci_45                -2.655965e-04 3 1  ON 44
ci_46                -1.694639e-03 3 1  ON 45
ci_47                 1.434991e-03 3 1  ON 46
ci_48                 2.894148e-03 3 1  ON 47
ci_49                -8.545580e-04 3 1  ON 48
ci_50                -8.205389e-04 3 1  ON 49
ci_51                -5.674845e-04 3 1  ON 50
ci_52                -6.318109e-04 3 1  ON 51
ci_53                -8.017847e-04 3 1  ON 52
ci_54                -1.110005e-03 3 1  ON 53
ci_55                -1.237025e-03 3 1  ON 54
ci_56                 1.098320e-03 3 1  ON 55
ci_57                 2.090268e-03 3 1  ON 56
ci_58                -1.859458e-04 3 1  ON 57
ci_59                -6.203040e-04 3 1  ON 58
ci_60                 1.270225e-04 3 1  ON 59
ci_61                -9.876634e-04 3 1  ON 60
ci_62                -3.821472e-04 3 1  ON 61
ci_63                -2.475850e-04 3 1  ON 62
ci_64                -6.090020e-04 3 1  ON 63
ci_65                -1.061385e-04 3 1  ON 64
ci_66                -1.252857e-04 3 1  ON 65
ci_67                -1.925992e-04 3 1  ON 66
ci_68                -1.799114e-03 3 1  ON 67
ci_69                -1.808518e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8146
    reference variance = 0.341995
====================================================
  Execution time = 2.5735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5608e-01
  Total weights = 1.964758025e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435221838991
                                         uncertainty =       0.002050292667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435221838991
                                         uncertainty =       0.002050292667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466524087
  error estimate for blocks of size 2^( 2) =       0.000491981191
  error estimate for blocks of size 2^( 3) =       0.000516185526
  error estimate for blocks of size 2^( 4) =       0.000534756198
  error estimate for blocks of size 2^( 5) =       0.000546115089
  error estimate for blocks of size 2^( 6) =       0.000551895692
  error estimate for blocks of size 2^( 7) =       0.000556949589

      target function =      -0.740295319932
              le_mean =     -22.813882267842
             les_mean =     520.929300727258
             stat err =       0.000547429142
             autocorr =       1.376916747545
   target nu stat err =       0.000547429142
   target dn stat err =       0.009134253633
      target stat err =       0.007462320767
              std dev =       0.659764691303
             le_variance =       0.435289447891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281388226784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740369793226       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740369811661       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740369813754       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740369814168       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740369814243       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740369814255       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740369814272       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740369814278       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740369814276       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740369814274       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 1.358577e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740369793226       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740369797835       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740369798358       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740369798462       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740369798488       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740369798455       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740369798494       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740369798492       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740369798488       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740369798488       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 3.396495e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740369793226       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740369794378       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740369794509       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740369794535       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740369794594       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740369794531       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740369794587       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740369794500       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740369794542       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740369794542       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 8.491271e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0250e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399864e-02 3 1  ON 1
ci_03                -2.427520e-02 3 1  ON 2
ci_04                 2.215362e-02 3 1  ON 3
ci_05                -1.912990e-02 3 1  ON 4
ci_06                -1.952699e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225017e-03 3 1  ON 7
ci_09                -7.549650e-03 3 1  ON 8
ci_10                -7.705371e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.046994e-03 3 1  ON 11
ci_13                 1.381578e-02 3 1  ON 12
ci_14                 1.281147e-02 3 1  ON 13
ci_15                 5.167496e-03 3 1  ON 14
ci_16                 5.730608e-03 3 1  ON 15
ci_17                -5.017507e-03 3 1  ON 16
ci_18                -5.545887e-03 3 1  ON 17
ci_19                 1.033113e-02 3 1  ON 18
ci_20                 6.254307e-03 3 1  ON 19
ci_21                 8.483882e-03 3 1  ON 20
ci_22                 8.882570e-03 3 1  ON 21
ci_23                 4.168293e-03 3 1  ON 22
ci_24                 5.186771e-03 3 1  ON 23
ci_25                 3.011425e-03 3 1  ON 24
ci_26                 3.794752e-03 3 1  ON 25
ci_27                 3.289108e-03 3 1  ON 26
ci_28                 7.707714e-04 3 1  ON 27
ci_29                 1.186539e-03 3 1  ON 28
ci_30                -7.411958e-04 3 1  ON 29
ci_31                 1.034556e-03 3 1  ON 30
ci_32                -5.358736e-04 3 1  ON 31
ci_33                -1.032768e-03 3 1  ON 32
ci_34                 1.151553e-03 3 1  ON 33
ci_35                 1.248302e-03 3 1  ON 34
ci_36                -5.659707e-04 3 1  ON 35
ci_37                -5.174649e-04 3 1  ON 36
ci_38                -2.861720e-04 3 1  ON 37
ci_39                -1.421302e-04 3 1  ON 38
ci_40                -1.905956e-03 3 1  ON 39
ci_41                -5.127734e-04 3 1  ON 40
ci_42                -1.648312e-03 3 1  ON 41
ci_43                -1.292202e-03 3 1  ON 42
ci_44                -2.176895e-03 3 1  ON 43
ci_45                -2.655939e-04 3 1  ON 44
ci_46                -1.694634e-03 3 1  ON 45
ci_47                 1.434998e-03 3 1  ON 46
ci_48                 2.894142e-03 3 1  ON 47
ci_49                -8.545538e-04 3 1  ON 48
ci_50                -8.205403e-04 3 1  ON 49
ci_51                -5.674801e-04 3 1  ON 50
ci_52                -6.318031e-04 3 1  ON 51
ci_53                -8.017827e-04 3 1  ON 52
ci_54                -1.110000e-03 3 1  ON 53
ci_55                -1.237025e-03 3 1  ON 54
ci_56                 1.098326e-03 3 1  ON 55
ci_57                 2.090265e-03 3 1  ON 56
ci_58                -1.859598e-04 3 1  ON 57
ci_59                -6.203119e-04 3 1  ON 58
ci_60                 1.270293e-04 3 1  ON 59
ci_61                -9.876708e-04 3 1  ON 60
ci_62                -3.821485e-04 3 1  ON 61
ci_63                -2.475801e-04 3 1  ON 62
ci_64                -6.090056e-04 3 1  ON 63
ci_65                -1.061483e-04 3 1  ON 64
ci_66                -1.252870e-04 3 1  ON 65
ci_67                -1.926009e-04 3 1  ON 66
ci_68                -1.799114e-03 3 1  ON 67
ci_69                -1.808519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8113
    reference variance = 0.401441
====================================================
  Execution time = 2.6936e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5067e-01
  Total weights = 1.9647e+06
  Execution time = 3.5154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986294394
                                         uncertainty =       0.002186537909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986294394
                                         uncertainty =       0.002186537909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466894258
  error estimate for blocks of size 2^( 2) =       0.000492557082
  error estimate for blocks of size 2^( 3) =       0.000517422683
  error estimate for blocks of size 2^( 4) =       0.000534796343
  error estimate for blocks of size 2^( 5) =       0.000546977595
  error estimate for blocks of size 2^( 6) =       0.000553214169
  error estimate for blocks of size 2^( 7) =       0.000556275387

      target function =      -0.744792145373
              le_mean =     -22.813431123590
             les_mean =     520.903307019096
             stat err =       0.000547815874
             autocorr =       1.376677322718
   target nu stat err =       0.000547815874
   target dn stat err =       0.002994472996
      target stat err =       0.002539533562
              std dev =       0.660288192051
             le_variance =       0.435980496562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986275693
                                         uncertainty =       0.002186536709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986275693
                                         uncertainty =       0.002186536709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466894248
  error estimate for blocks of size 2^( 2) =       0.000492557064
  error estimate for blocks of size 2^( 3) =       0.000517422656
  error estimate for blocks of size 2^( 4) =       0.000534796310
  error estimate for blocks of size 2^( 5) =       0.000546977556
  error estimate for blocks of size 2^( 6) =       0.000553214129
  error estimate for blocks of size 2^( 7) =       0.000556275347

      target function =      -0.744793162553
              le_mean =     -22.813431123856
             les_mean =     520.903305796176
             stat err =       0.000547815836
             autocorr =       1.376677191068
   target nu stat err =       0.000547815836
   target dn stat err =       0.002994474002
      target stat err =       0.002539541097
              std dev =       0.660288177838
             le_variance =       0.435980477792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986285043
                                         uncertainty =       0.002186537309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986285043
                                         uncertainty =       0.002186537309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466894253
  error estimate for blocks of size 2^( 2) =       0.000492557073
  error estimate for blocks of size 2^( 3) =       0.000517422670
  error estimate for blocks of size 2^( 4) =       0.000534796327
  error estimate for blocks of size 2^( 5) =       0.000546977576
  error estimate for blocks of size 2^( 6) =       0.000553214149
  error estimate for blocks of size 2^( 7) =       0.000556275367

      target function =      -0.744792719776
              le_mean =     -22.813431123723
             les_mean =     520.903306327718
             stat err =       0.000547815855
             autocorr =       1.376677256885
   target nu stat err =       0.000547815855
   target dn stat err =       0.002994473275
      target stat err =       0.002539537586
              std dev =       0.660288184944
             le_variance =       0.435980487177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986293226
                                         uncertainty =       0.002186537834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435986293226
                                         uncertainty =       0.002186537834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466894258
  error estimate for blocks of size 2^( 2) =       0.000492557081
  error estimate for blocks of size 2^( 3) =       0.000517422681
  error estimate for blocks of size 2^( 4) =       0.000534796341
  error estimate for blocks of size 2^( 5) =       0.000546977592
  error estimate for blocks of size 2^( 6) =       0.000553214167
  error estimate for blocks of size 2^( 7) =       0.000556275384

      target function =      -0.744792226018
              le_mean =     -22.813431123606
             les_mean =     520.903306921934
             stat err =       0.000547815871
             autocorr =       1.376677314478
   target nu stat err =       0.000547815871
   target dn stat err =       0.002994472998
      target stat err =       0.002539534097
              std dev =       0.660288191162
             le_variance =       0.435980495388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744792145373        initial
     2.4414e+03     2.4414e+04             1.3586e-07        -0.744793162553  <--
     9.7656e+03     9.7656e+04             3.3965e-08        -0.744792719776
     3.9062e+04     3.9062e+05             8.4913e-09        -0.744792226018

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 4.4607e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_01                 1.080228e-01 3 1  ON 0
ci_02                -2.399868e-02 3 1  ON 1
ci_03                -2.427527e-02 3 1  ON 2
ci_04                 2.215372e-02 3 1  ON 3
ci_05                -1.912987e-02 3 1  ON 4
ci_06                -1.952699e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225018e-03 3 1  ON 7
ci_09                -7.549647e-03 3 1  ON 8
ci_10                -7.705367e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.047004e-03 3 1  ON 11
ci_13                 1.381581e-02 3 1  ON 12
ci_14                 1.281149e-02 3 1  ON 13
ci_15                 5.167524e-03 3 1  ON 14
ci_16                 5.730623e-03 3 1  ON 15
ci_17                -5.017545e-03 3 1  ON 16
ci_18                -5.545914e-03 3 1  ON 17
ci_19                 1.033112e-02 3 1  ON 18
ci_20                 6.254325e-03 3 1  ON 19
ci_21                 8.483893e-03 3 1  ON 20
ci_22                 8.882571e-03 3 1  ON 21
ci_23                 4.168294e-03 3 1  ON 22
ci_24                 5.186766e-03 3 1  ON 23
ci_25                 3.011435e-03 3 1  ON 24
ci_26                 3.794737e-03 3 1  ON 25
ci_27                 3.289115e-03 3 1  ON 26
ci_28                 7.708020e-04 3 1  ON 27
ci_29                 1.186522e-03 3 1  ON 28
ci_30                -7.411967e-04 3 1  ON 29
ci_31                 1.034522e-03 3 1  ON 30
ci_32                -5.359114e-04 3 1  ON 31
ci_33                -1.032786e-03 3 1  ON 32
ci_34                 1.151565e-03 3 1  ON 33
ci_35                 1.248276e-03 3 1  ON 34
ci_36                -5.659787e-04 3 1  ON 35
ci_37                -5.174678e-04 3 1  ON 36
ci_38                -2.861754e-04 3 1  ON 37
ci_39                -1.421390e-04 3 1  ON 38
ci_40                -1.905955e-03 3 1  ON 39
ci_41                -5.128017e-04 3 1  ON 40
ci_42                -1.648280e-03 3 1  ON 41
ci_43                -1.292215e-03 3 1  ON 42
ci_44                -2.176887e-03 3 1  ON 43
ci_45                -2.655861e-04 3 1  ON 44
ci_46                -1.694621e-03 3 1  ON 45
ci_47                 1.435020e-03 3 1  ON 46
ci_48                 2.894122e-03 3 1  ON 47
ci_49                -8.545412e-04 3 1  ON 48
ci_50                -8.205445e-04 3 1  ON 49
ci_51                -5.674669e-04 3 1  ON 50
ci_52                -6.317799e-04 3 1  ON 51
ci_53                -8.017766e-04 3 1  ON 52
ci_54                -1.109987e-03 3 1  ON 53
ci_55                -1.237027e-03 3 1  ON 54
ci_56                 1.098345e-03 3 1  ON 55
ci_57                 2.090257e-03 3 1  ON 56
ci_58                -1.860017e-04 3 1  ON 57
ci_59                -6.203358e-04 3 1  ON 58
ci_60                 1.270497e-04 3 1  ON 59
ci_61                -9.876929e-04 3 1  ON 60
ci_62                -3.821524e-04 3 1  ON 61
ci_63                -2.475654e-04 3 1  ON 62
ci_64                -6.090164e-04 3 1  ON 63
ci_65                -1.061778e-04 3 1  ON 64
ci_66                -1.252908e-04 3 1  ON 65
ci_67                -1.926062e-04 3 1  ON 66
ci_68                -1.799114e-03 3 1  ON 67
ci_69                -1.808521e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2798e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8111
    reference variance = 0.423139
====================================================
  Execution time = 2.6198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6619e-01
  Total weights = 1.964740183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452740327397
                                         uncertainty =       0.018170825952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452740327397
                                         uncertainty =       0.018170825952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475735253
  error estimate for blocks of size 2^( 2) =       0.000501244366
  error estimate for blocks of size 2^( 3) =       0.000525261011
  error estimate for blocks of size 2^( 4) =       0.000543114722
  error estimate for blocks of size 2^( 5) =       0.000554261407
  error estimate for blocks of size 2^( 6) =       0.000560752284
  error estimate for blocks of size 2^( 7) =       0.000563915080

      target function =      -0.731921720027
              le_mean =     -22.814405247630
             les_mean =     520.963280551186
             stat err =       0.000555510873
             autocorr =       1.363497850766
   target nu stat err =       0.000555510873
   target dn stat err =       0.018410793552
      target stat err =       0.014682819139
              std dev =       0.672791247304
             le_variance =       0.452648062448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281440524763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732212924141       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732213023436       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.732213033967       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.732213034254       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732213034572       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.732213034527       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.732213034982       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732213035069       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.732213034998       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732213034994       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.732213035001       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 5.335396e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732212924141       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732212948966       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.732212951599       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.732212951670       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732212951750       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.732212951739       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.732212951853       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732212951872       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.732212951857       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732212951853       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.732212951852       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 1.333876e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.732212924141       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.732212930347       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.732212931005       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.732212931023       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732212931065       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.732212931027       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.732212931063       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732212931073       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.732212931077       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732212931081       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.732212931070       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 3.334707e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0705e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_01                 1.080227e-01 3 1  ON 0
ci_02                -2.399871e-02 3 1  ON 1
ci_03                -2.427525e-02 3 1  ON 2
ci_04                 2.215375e-02 3 1  ON 3
ci_05                -1.912997e-02 3 1  ON 4
ci_06                -1.952711e-02 3 1  ON 5
ci_07                 2.575664e-02 3 1  ON 6
ci_08                -4.224948e-03 3 1  ON 7
ci_09                -7.549641e-03 3 1  ON 8
ci_10                -7.705377e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.046980e-03 3 1  ON 11
ci_13                 1.381579e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.167546e-03 3 1  ON 14
ci_16                 5.730633e-03 3 1  ON 15
ci_17                -5.017514e-03 3 1  ON 16
ci_18                -5.545857e-03 3 1  ON 17
ci_19                 1.033112e-02 3 1  ON 18
ci_20                 6.254317e-03 3 1  ON 19
ci_21                 8.483905e-03 3 1  ON 20
ci_22                 8.882570e-03 3 1  ON 21
ci_23                 4.168288e-03 3 1  ON 22
ci_24                 5.186818e-03 3 1  ON 23
ci_25                 3.011446e-03 3 1  ON 24
ci_26                 3.794689e-03 3 1  ON 25
ci_27                 3.289114e-03 3 1  ON 26
ci_28                 7.707562e-04 3 1  ON 27
ci_29                 1.186622e-03 3 1  ON 28
ci_30                -7.411969e-04 3 1  ON 29
ci_31                 1.034473e-03 3 1  ON 30
ci_32                -5.359338e-04 3 1  ON 31
ci_33                -1.032740e-03 3 1  ON 32
ci_34                 1.151580e-03 3 1  ON 33
ci_35                 1.248259e-03 3 1  ON 34
ci_36                -5.659879e-04 3 1  ON 35
ci_37                -5.174686e-04 3 1  ON 36
ci_38                -2.861776e-04 3 1  ON 37
ci_39                -1.421494e-04 3 1  ON 38
ci_40                -1.905949e-03 3 1  ON 39
ci_41                -5.128002e-04 3 1  ON 40
ci_42                -1.648240e-03 3 1  ON 41
ci_43                -1.292264e-03 3 1  ON 42
ci_44                -2.176845e-03 3 1  ON 43
ci_45                -2.655769e-04 3 1  ON 44
ci_46                -1.694594e-03 3 1  ON 45
ci_47                 1.435025e-03 3 1  ON 46
ci_48                 2.894097e-03 3 1  ON 47
ci_49                -8.545116e-04 3 1  ON 48
ci_50                -8.205536e-04 3 1  ON 49
ci_51                -5.674480e-04 3 1  ON 50
ci_52                -6.317447e-04 3 1  ON 51
ci_53                -8.017544e-04 3 1  ON 52
ci_54                -1.109972e-03 3 1  ON 53
ci_55                -1.236956e-03 3 1  ON 54
ci_56                 1.098361e-03 3 1  ON 55
ci_57                 2.090256e-03 3 1  ON 56
ci_58                -1.860157e-04 3 1  ON 57
ci_59                -6.203500e-04 3 1  ON 58
ci_60                 1.270446e-04 3 1  ON 59
ci_61                -9.876906e-04 3 1  ON 60
ci_62                -3.821434e-04 3 1  ON 61
ci_63                -2.475857e-04 3 1  ON 62
ci_64                -6.090075e-04 3 1  ON 63
ci_65                -1.061835e-04 3 1  ON 64
ci_66                -1.253024e-04 3 1  ON 65
ci_67                -1.926523e-04 3 1  ON 66
ci_68                -1.799125e-03 3 1  ON 67
ci_69                -1.808514e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7599
    reference variance = 0.344735
====================================================
  Execution time = 2.4872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5163e-01
  Total weights = 1.9649e+06
  Execution time = 3.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436366039262
                                         uncertainty =       0.003994974692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436366039262
                                         uncertainty =       0.003994974692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467096096
  error estimate for blocks of size 2^( 2) =       0.000492884998
  error estimate for blocks of size 2^( 3) =       0.000517277809
  error estimate for blocks of size 2^( 4) =       0.000536061584
  error estimate for blocks of size 2^( 5) =       0.000547579467
  error estimate for blocks of size 2^( 6) =       0.000554526044
  error estimate for blocks of size 2^( 7) =       0.000559549297

      target function =      -0.743984130993
              le_mean =     -22.813752383054
             les_mean =     520.918927215790
             stat err =       0.000549429098
             autocorr =       1.383600906462
   target nu stat err =       0.000549429098
   target dn stat err =       0.005313340160
      target stat err =       0.004410716912
              std dev =       0.660573633550
             le_variance =       0.436357525341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365931507
                                         uncertainty =       0.003994916016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365931507
                                         uncertainty =       0.003994916016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467096038
  error estimate for blocks of size 2^( 2) =       0.000492884939
  error estimate for blocks of size 2^( 3) =       0.000517277747
  error estimate for blocks of size 2^( 4) =       0.000536061530
  error estimate for blocks of size 2^( 5) =       0.000547579412
  error estimate for blocks of size 2^( 6) =       0.000554525993
  error estimate for blocks of size 2^( 7) =       0.000559549236

      target function =      -0.743984115971
              le_mean =     -22.813752384912
             les_mean =     520.918927319193
             stat err =       0.000549429043
             autocorr =       1.383600968168
   target nu stat err =       0.000549429043
   target dn stat err =       0.005313309176
      target stat err =       0.004410691505
              std dev =       0.660573552478
             le_variance =       0.436357418234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365985376
                                         uncertainty =       0.003994945352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436365985376
                                         uncertainty =       0.003994945352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467096067
  error estimate for blocks of size 2^( 2) =       0.000492884968
  error estimate for blocks of size 2^( 3) =       0.000517277778
  error estimate for blocks of size 2^( 4) =       0.000536061557
  error estimate for blocks of size 2^( 5) =       0.000547579440
  error estimate for blocks of size 2^( 6) =       0.000554526018
  error estimate for blocks of size 2^( 7) =       0.000559549267

      target function =      -0.743984124548
              le_mean =     -22.813752383983
             les_mean =     520.918927266158
             stat err =       0.000549429070
             autocorr =       1.383600937320
   target nu stat err =       0.000549429070
   target dn stat err =       0.005313324663
      target stat err =       0.004410704217
              std dev =       0.660573593008
             le_variance =       0.436357471779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436366032525
                                         uncertainty =       0.003994971024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436366032525
                                         uncertainty =       0.003994971024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467096092
  error estimate for blocks of size 2^( 2) =       0.000492884994
  error estimate for blocks of size 2^( 3) =       0.000517277805
  error estimate for blocks of size 2^( 4) =       0.000536061581
  error estimate for blocks of size 2^( 5) =       0.000547579464
  error estimate for blocks of size 2^( 6) =       0.000554526041
  error estimate for blocks of size 2^( 7) =       0.000559549293

      target function =      -0.743984130304
              le_mean =     -22.813752383170
             les_mean =     520.918927221940
             stat err =       0.000549429095
             autocorr =       1.383600910316
   target nu stat err =       0.000549429095
   target dn stat err =       0.005313338223
      target stat err =       0.004410715327
              std dev =       0.660573628481
             le_variance =       0.436357518645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743984130993        initial  <--
     6.1035e+02     6.1035e+03             5.3354e-07        -0.743984115971
     2.4414e+03     2.4414e+04             1.3339e-07        -0.743984124548
     9.7656e+03     9.7656e+04             3.3347e-08        -0.743984130304

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4607
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_01                 1.080228e-01 3 1  ON 0
ci_02                -2.399868e-02 3 1  ON 1
ci_03                -2.427527e-02 3 1  ON 2
ci_04                 2.215372e-02 3 1  ON 3
ci_05                -1.912987e-02 3 1  ON 4
ci_06                -1.952699e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225018e-03 3 1  ON 7
ci_09                -7.549647e-03 3 1  ON 8
ci_10                -7.705367e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.047004e-03 3 1  ON 11
ci_13                 1.381581e-02 3 1  ON 12
ci_14                 1.281149e-02 3 1  ON 13
ci_15                 5.167524e-03 3 1  ON 14
ci_16                 5.730623e-03 3 1  ON 15
ci_17                -5.017545e-03 3 1  ON 16
ci_18                -5.545914e-03 3 1  ON 17
ci_19                 1.033112e-02 3 1  ON 18
ci_20                 6.254325e-03 3 1  ON 19
ci_21                 8.483893e-03 3 1  ON 20
ci_22                 8.882571e-03 3 1  ON 21
ci_23                 4.168294e-03 3 1  ON 22
ci_24                 5.186766e-03 3 1  ON 23
ci_25                 3.011435e-03 3 1  ON 24
ci_26                 3.794737e-03 3 1  ON 25
ci_27                 3.289115e-03 3 1  ON 26
ci_28                 7.708020e-04 3 1  ON 27
ci_29                 1.186522e-03 3 1  ON 28
ci_30                -7.411967e-04 3 1  ON 29
ci_31                 1.034522e-03 3 1  ON 30
ci_32                -5.359114e-04 3 1  ON 31
ci_33                -1.032786e-03 3 1  ON 32
ci_34                 1.151565e-03 3 1  ON 33
ci_35                 1.248276e-03 3 1  ON 34
ci_36                -5.659787e-04 3 1  ON 35
ci_37                -5.174678e-04 3 1  ON 36
ci_38                -2.861754e-04 3 1  ON 37
ci_39                -1.421390e-04 3 1  ON 38
ci_40                -1.905955e-03 3 1  ON 39
ci_41                -5.128017e-04 3 1  ON 40
ci_42                -1.648280e-03 3 1  ON 41
ci_43                -1.292215e-03 3 1  ON 42
ci_44                -2.176887e-03 3 1  ON 43
ci_45                -2.655861e-04 3 1  ON 44
ci_46                -1.694621e-03 3 1  ON 45
ci_47                 1.435020e-03 3 1  ON 46
ci_48                 2.894122e-03 3 1  ON 47
ci_49                -8.545412e-04 3 1  ON 48
ci_50                -8.205445e-04 3 1  ON 49
ci_51                -5.674669e-04 3 1  ON 50
ci_52                -6.317799e-04 3 1  ON 51
ci_53                -8.017766e-04 3 1  ON 52
ci_54                -1.109987e-03 3 1  ON 53
ci_55                -1.237027e-03 3 1  ON 54
ci_56                 1.098345e-03 3 1  ON 55
ci_57                 2.090257e-03 3 1  ON 56
ci_58                -1.860017e-04 3 1  ON 57
ci_59                -6.203358e-04 3 1  ON 58
ci_60                 1.270497e-04 3 1  ON 59
ci_61                -9.876929e-04 3 1  ON 60
ci_62                -3.821524e-04 3 1  ON 61
ci_63                -2.475654e-04 3 1  ON 62
ci_64                -6.090164e-04 3 1  ON 63
ci_65                -1.061778e-04 3 1  ON 64
ci_66                -1.252908e-04 3 1  ON 65
ci_67                -1.926062e-04 3 1  ON 66
ci_68                -1.799114e-03 3 1  ON 67
ci_69                -1.808521e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8082
    reference variance = 0.358461
====================================================
  Execution time = 2.5649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4993e-01
  Total weights = 1.964686179e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850207287
                                         uncertainty =       0.001802384660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434850207287
                                         uncertainty =       0.001802384660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466270563
  error estimate for blocks of size 2^( 2) =       0.000491998307
  error estimate for blocks of size 2^( 3) =       0.000516740971
  error estimate for blocks of size 2^( 4) =       0.000535367315
  error estimate for blocks of size 2^( 5) =       0.000547553145
  error estimate for blocks of size 2^( 6) =       0.000555323610
  error estimate for blocks of size 2^( 7) =       0.000558110217

      target function =      -0.745395036110
              le_mean =     -22.813975582361
             les_mean =     520.927414254880
             stat err =       0.000549088572
             autocorr =       1.386783971600
   target nu stat err =       0.000549088572
   target dn stat err =       0.003830094369
      target stat err =       0.003220077065
              std dev =       0.659406153795
             le_variance =       0.434816475663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281397558236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745407907713       residual = 9.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745407917792       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745407918806       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745407919065       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745407919133       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745407919139       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745407919144       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745407919142       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745407919135       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745407919135       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 5.426055e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745407907713       residual = 9.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745407910233       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745407910486       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745407910554       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745407910554       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745407910553       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745407910571       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745407910568       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745407910570       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745407910549       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.356518e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745407907713       residual = 9.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745407908343       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745407908406       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745407908423       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745407908426       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745407908427       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745407908427       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745407908591       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745407908317       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745407908427       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 3.391297e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0142e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_01                 1.080228e-01 3 1  ON 0
ci_02                -2.399869e-02 3 1  ON 1
ci_03                -2.427528e-02 3 1  ON 2
ci_04                 2.215373e-02 3 1  ON 3
ci_05                -1.912987e-02 3 1  ON 4
ci_06                -1.952698e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225021e-03 3 1  ON 7
ci_09                -7.549646e-03 3 1  ON 8
ci_10                -7.705369e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.047005e-03 3 1  ON 11
ci_13                 1.381581e-02 3 1  ON 12
ci_14                 1.281149e-02 3 1  ON 13
ci_15                 5.167528e-03 3 1  ON 14
ci_16                 5.730626e-03 3 1  ON 15
ci_17                -5.017545e-03 3 1  ON 16
ci_18                -5.545914e-03 3 1  ON 17
ci_19                 1.033112e-02 3 1  ON 18
ci_20                 6.254322e-03 3 1  ON 19
ci_21                 8.483894e-03 3 1  ON 20
ci_22                 8.882568e-03 3 1  ON 21
ci_23                 4.168299e-03 3 1  ON 22
ci_24                 5.186763e-03 3 1  ON 23
ci_25                 3.011436e-03 3 1  ON 24
ci_26                 3.794736e-03 3 1  ON 25
ci_27                 3.289116e-03 3 1  ON 26
ci_28                 7.708029e-04 3 1  ON 27
ci_29                 1.186515e-03 3 1  ON 28
ci_30                -7.411974e-04 3 1  ON 29
ci_31                 1.034521e-03 3 1  ON 30
ci_32                -5.359117e-04 3 1  ON 31
ci_33                -1.032790e-03 3 1  ON 32
ci_34                 1.151566e-03 3 1  ON 33
ci_35                 1.248282e-03 3 1  ON 34
ci_36                -5.659788e-04 3 1  ON 35
ci_37                -5.174683e-04 3 1  ON 36
ci_38                -2.861752e-04 3 1  ON 37
ci_39                -1.421406e-04 3 1  ON 38
ci_40                -1.905955e-03 3 1  ON 39
ci_41                -5.128093e-04 3 1  ON 40
ci_42                -1.648282e-03 3 1  ON 41
ci_43                -1.292220e-03 3 1  ON 42
ci_44                -2.176883e-03 3 1  ON 43
ci_45                -2.655866e-04 3 1  ON 44
ci_46                -1.694616e-03 3 1  ON 45
ci_47                 1.435021e-03 3 1  ON 46
ci_48                 2.894118e-03 3 1  ON 47
ci_49                -8.545374e-04 3 1  ON 48
ci_50                -8.205439e-04 3 1  ON 49
ci_51                -5.674643e-04 3 1  ON 50
ci_52                -6.317797e-04 3 1  ON 51
ci_53                -8.017762e-04 3 1  ON 52
ci_54                -1.109986e-03 3 1  ON 53
ci_55                -1.237024e-03 3 1  ON 54
ci_56                 1.098353e-03 3 1  ON 55
ci_57                 2.090254e-03 3 1  ON 56
ci_58                -1.860046e-04 3 1  ON 57
ci_59                -6.203322e-04 3 1  ON 58
ci_60                 1.270463e-04 3 1  ON 59
ci_61                -9.876909e-04 3 1  ON 60
ci_62                -3.821491e-04 3 1  ON 61
ci_63                -2.475632e-04 3 1  ON 62
ci_64                -6.090201e-04 3 1  ON 63
ci_65                -1.061777e-04 3 1  ON 64
ci_66                -1.252905e-04 3 1  ON 65
ci_67                -1.926049e-04 3 1  ON 66
ci_68                -1.799115e-03 3 1  ON 67
ci_69                -1.808521e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7641
    reference variance = 1.11914
====================================================
  Execution time = 2.6807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4660e-01
  Total weights = 1.9646e+06
  Execution time = 3.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178942714
                                         uncertainty =       0.001816527248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178942714
                                         uncertainty =       0.001816527248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465401966
  error estimate for blocks of size 2^( 2) =       0.000490848690
  error estimate for blocks of size 2^( 3) =       0.000514823167
  error estimate for blocks of size 2^( 4) =       0.000533396680
  error estimate for blocks of size 2^( 5) =       0.000545042334
  error estimate for blocks of size 2^( 6) =       0.000552267443
  error estimate for blocks of size 2^( 7) =       0.000559371875

      target function =      -0.748166258705
              le_mean =     -22.814746409312
             les_mean =     520.959254362649
             stat err =       0.000547519583
             autocorr =       1.384021659923
   target nu stat err =       0.000547519583
   target dn stat err =       0.003043336703
      target stat err =       0.002606418198
              std dev =       0.658177772461
             le_variance =       0.433197980162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178935005
                                         uncertainty =       0.001816526452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178935005
                                         uncertainty =       0.001816526452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465401962
  error estimate for blocks of size 2^( 2) =       0.000490848683
  error estimate for blocks of size 2^( 3) =       0.000514823157
  error estimate for blocks of size 2^( 4) =       0.000533396668
  error estimate for blocks of size 2^( 5) =       0.000545042319
  error estimate for blocks of size 2^( 6) =       0.000552267428
  error estimate for blocks of size 2^( 7) =       0.000559371859

      target function =      -0.748166277628
              le_mean =     -22.814746409188
             les_mean =     520.959254334266
             stat err =       0.000547519569
             autocorr =       1.384021611447
   target nu stat err =       0.000547519569
   target dn stat err =       0.003043335976
      target stat err =       0.002606417733
              std dev =       0.658177766650
             le_variance =       0.433197972512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178938860
                                         uncertainty =       0.001816526850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178938860
                                         uncertainty =       0.001816526850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465401964
  error estimate for blocks of size 2^( 2) =       0.000490848686
  error estimate for blocks of size 2^( 3) =       0.000514823162
  error estimate for blocks of size 2^( 4) =       0.000533396674
  error estimate for blocks of size 2^( 5) =       0.000545042326
  error estimate for blocks of size 2^( 6) =       0.000552267435
  error estimate for blocks of size 2^( 7) =       0.000559371867

      target function =      -0.748166268172
              le_mean =     -22.814746409250
             les_mean =     520.959254348451
             stat err =       0.000547519576
             autocorr =       1.384021635695
   target nu stat err =       0.000547519576
   target dn stat err =       0.003043336339
      target stat err =       0.002606417965
              std dev =       0.658177769555
             le_variance =       0.433197976337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178942233
                                         uncertainty =       0.001816527199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433178942233
                                         uncertainty =       0.001816527199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465401966
  error estimate for blocks of size 2^( 2) =       0.000490848689
  error estimate for blocks of size 2^( 3) =       0.000514823166
  error estimate for blocks of size 2^( 4) =       0.000533396679
  error estimate for blocks of size 2^( 5) =       0.000545042333
  error estimate for blocks of size 2^( 6) =       0.000552267442
  error estimate for blocks of size 2^( 7) =       0.000559371874

      target function =      -0.748166259889
              le_mean =     -22.814746409305
             les_mean =     520.959254360874
             stat err =       0.000547519582
             autocorr =       1.384021656903
   target nu stat err =       0.000547519582
   target dn stat err =       0.003043336657
      target stat err =       0.002606418169
              std dev =       0.658177772098
             le_variance =       0.433197979684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748166258705        initial
     6.1035e+03     6.1035e+04             5.4261e-08        -0.748166277628  <--
     2.4414e+04     2.4414e+05             1.3565e-08        -0.748166268172
     9.7656e+04     9.7656e+05             3.3913e-09        -0.748166259889

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 4.4346e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_01                 1.080229e-01 3 1  ON 0
ci_02                -2.399872e-02 3 1  ON 1
ci_03                -2.427529e-02 3 1  ON 2
ci_04                 2.215375e-02 3 1  ON 3
ci_05                -1.912989e-02 3 1  ON 4
ci_06                -1.952695e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225029e-03 3 1  ON 7
ci_09                -7.549644e-03 3 1  ON 8
ci_10                -7.705374e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.047008e-03 3 1  ON 11
ci_13                 1.381580e-02 3 1  ON 12
ci_14                 1.281148e-02 3 1  ON 13
ci_15                 5.167539e-03 3 1  ON 14
ci_16                 5.730633e-03 3 1  ON 15
ci_17                -5.017543e-03 3 1  ON 16
ci_18                -5.545914e-03 3 1  ON 17
ci_19                 1.033110e-02 3 1  ON 18
ci_20                 6.254315e-03 3 1  ON 19
ci_21                 8.483897e-03 3 1  ON 20
ci_22                 8.882561e-03 3 1  ON 21
ci_23                 4.168315e-03 3 1  ON 22
ci_24                 5.186754e-03 3 1  ON 23
ci_25                 3.011437e-03 3 1  ON 24
ci_26                 3.794734e-03 3 1  ON 25
ci_27                 3.289120e-03 3 1  ON 26
ci_28                 7.708056e-04 3 1  ON 27
ci_29                 1.186493e-03 3 1  ON 28
ci_30                -7.411994e-04 3 1  ON 29
ci_31                 1.034518e-03 3 1  ON 30
ci_32                -5.359127e-04 3 1  ON 31
ci_33                -1.032801e-03 3 1  ON 32
ci_34                 1.151571e-03 3 1  ON 33
ci_35                 1.248301e-03 3 1  ON 34
ci_36                -5.659792e-04 3 1  ON 35
ci_37                -5.174701e-04 3 1  ON 36
ci_38                -2.861746e-04 3 1  ON 37
ci_39                -1.421453e-04 3 1  ON 38
ci_40                -1.905952e-03 3 1  ON 39
ci_41                -5.128320e-04 3 1  ON 40
ci_42                -1.648287e-03 3 1  ON 41
ci_43                -1.292234e-03 3 1  ON 42
ci_44                -2.176872e-03 3 1  ON 43
ci_45                -2.655883e-04 3 1  ON 44
ci_46                -1.694602e-03 3 1  ON 45
ci_47                 1.435023e-03 3 1  ON 46
ci_48                 2.894106e-03 3 1  ON 47
ci_49                -8.545261e-04 3 1  ON 48
ci_50                -8.205422e-04 3 1  ON 49
ci_51                -5.674564e-04 3 1  ON 50
ci_52                -6.317789e-04 3 1  ON 51
ci_53                -8.017749e-04 3 1  ON 52
ci_54                -1.109983e-03 3 1  ON 53
ci_55                -1.237017e-03 3 1  ON 54
ci_56                 1.098378e-03 3 1  ON 55
ci_57                 2.090245e-03 3 1  ON 56
ci_58                -1.860131e-04 3 1  ON 57
ci_59                -6.203213e-04 3 1  ON 58
ci_60                 1.270360e-04 3 1  ON 59
ci_61                -9.876849e-04 3 1  ON 60
ci_62                -3.821394e-04 3 1  ON 61
ci_63                -2.475566e-04 3 1  ON 62
ci_64                -6.090312e-04 3 1  ON 63
ci_65                -1.061774e-04 3 1  ON 64
ci_66                -1.252898e-04 3 1  ON 65
ci_67                -1.926011e-04 3 1  ON 66
ci_68                -1.799119e-03 3 1  ON 67
ci_69                -1.808520e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8454
    reference variance = 0.457448
====================================================
  Execution time = 2.5669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4688e-01
  Total weights = 1.964765060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432883580183
                                         uncertainty =       0.001928020498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432883580183
                                         uncertainty =       0.001928020498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465295217
  error estimate for blocks of size 2^( 2) =       0.000491272193
  error estimate for blocks of size 2^( 3) =       0.000516315955
  error estimate for blocks of size 2^( 4) =       0.000535104594
  error estimate for blocks of size 2^( 5) =       0.000547580455
  error estimate for blocks of size 2^( 6) =       0.000554475640
  error estimate for blocks of size 2^( 7) =       0.000558316383

      target function =      -0.747925965942
              le_mean =     -22.813882743321
             les_mean =     520.920127401331
             stat err =       0.000548869268
             autocorr =       1.391491805044
   target nu stat err =       0.000548869268
   target dn stat err =       0.003131535975
      target stat err =       0.002673115279
              std dev =       0.658026806056
             le_variance =       0.432999277488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281388274332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747934538132       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747934551713       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747934554114       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747934554932       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747934555023       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747934555084       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747934555096       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747934555100       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747934555106       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747934555102       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.611128e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747934538132       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747934541528       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747934542128       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747934542335       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747934542352       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747934542368       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747934542380       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747934542364       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747934542378       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747934542369       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 4.027876e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747934538132       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747934538981       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747934539131       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747934539182       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747934539200       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747934539189       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747934539136       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747934539218       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747934539190       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747934539134       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.006973e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0207e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_01                 1.080229e-01 3 1  ON 0
ci_02                -2.399875e-02 3 1  ON 1
ci_03                -2.427533e-02 3 1  ON 2
ci_04                 2.215377e-02 3 1  ON 3
ci_05                -1.912991e-02 3 1  ON 4
ci_06                -1.952697e-02 3 1  ON 5
ci_07                 2.575663e-02 3 1  ON 6
ci_08                -4.225032e-03 3 1  ON 7
ci_09                -7.549641e-03 3 1  ON 8
ci_10                -7.705383e-03 3 1  ON 9
ci_11                 1.374812e-02 3 1  ON 10
ci_12                 7.047007e-03 3 1  ON 11
ci_13                 1.381581e-02 3 1  ON 12
ci_14                 1.281149e-02 3 1  ON 13
ci_15                 5.167559e-03 3 1  ON 14
ci_16                 5.730630e-03 3 1  ON 15
ci_17                -5.017560e-03 3 1  ON 16
ci_18                -5.545923e-03 3 1  ON 17
ci_19                 1.033111e-02 3 1  ON 18
ci_20                 6.254327e-03 3 1  ON 19
ci_21                 8.483899e-03 3 1  ON 20
ci_22                 8.882564e-03 3 1  ON 21
ci_23                 4.168318e-03 3 1  ON 22
ci_24                 5.186741e-03 3 1  ON 23
ci_25                 3.011441e-03 3 1  ON 24
ci_26                 3.794735e-03 3 1  ON 25
ci_27                 3.289120e-03 3 1  ON 26
ci_28                 7.708132e-04 3 1  ON 27
ci_29                 1.186494e-03 3 1  ON 28
ci_30                -7.411933e-04 3 1  ON 29
ci_31                 1.034515e-03 3 1  ON 30
ci_32                -5.359098e-04 3 1  ON 31
ci_33                -1.032802e-03 3 1  ON 32
ci_34                 1.151576e-03 3 1  ON 33
ci_35                 1.248302e-03 3 1  ON 34
ci_36                -5.659809e-04 3 1  ON 35
ci_37                -5.174755e-04 3 1  ON 36
ci_38                -2.861726e-04 3 1  ON 37
ci_39                -1.421443e-04 3 1  ON 38
ci_40                -1.905956e-03 3 1  ON 39
ci_41                -5.128375e-04 3 1  ON 40
ci_42                -1.648284e-03 3 1  ON 41
ci_43                -1.292237e-03 3 1  ON 42
ci_44                -2.176881e-03 3 1  ON 43
ci_45                -2.655961e-04 3 1  ON 44
ci_46                -1.694594e-03 3 1  ON 45
ci_47                 1.435021e-03 3 1  ON 46
ci_48                 2.894096e-03 3 1  ON 47
ci_49                -8.545247e-04 3 1  ON 48
ci_50                -8.205363e-04 3 1  ON 49
ci_51                -5.674427e-04 3 1  ON 50
ci_52                -6.317774e-04 3 1  ON 51
ci_53                -8.017720e-04 3 1  ON 52
ci_54                -1.109983e-03 3 1  ON 53
ci_55                -1.237013e-03 3 1  ON 54
ci_56                 1.098389e-03 3 1  ON 55
ci_57                 2.090250e-03 3 1  ON 56
ci_58                -1.860144e-04 3 1  ON 57
ci_59                -6.203249e-04 3 1  ON 58
ci_60                 1.270181e-04 3 1  ON 59
ci_61                -9.876844e-04 3 1  ON 60
ci_62                -3.821365e-04 3 1  ON 61
ci_63                -2.475535e-04 3 1  ON 62
ci_64                -6.090230e-04 3 1  ON 63
ci_65                -1.061837e-04 3 1  ON 64
ci_66                -1.252919e-04 3 1  ON 65
ci_67                -1.926040e-04 3 1  ON 66
ci_68                -1.799114e-03 3 1  ON 67
ci_69                -1.808505e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7478
    reference variance = 0.340125
====================================================
  Execution time = 2.4822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4740e-01
  Total weights = 1.9644e+06
  Execution time = 3.5157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902968079
                                         uncertainty =       0.001881519764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902968079
                                         uncertainty =       0.001881519764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466304767
  error estimate for blocks of size 2^( 2) =       0.000491983448
  error estimate for blocks of size 2^( 3) =       0.000516731191
  error estimate for blocks of size 2^( 4) =       0.000535723849
  error estimate for blocks of size 2^( 5) =       0.000546751254
  error estimate for blocks of size 2^( 6) =       0.000553797393
  error estimate for blocks of size 2^( 7) =       0.000559120406

      target function =      -0.747491757266
              le_mean =     -22.813252369805
             les_mean =     520.891885669673
             stat err =       0.000548848225
             autocorr =       1.385366935799
   target nu stat err =       0.000548848225
   target dn stat err =       0.002623712134
      target stat err =       0.002259582238
              std dev =       0.659454525501
             le_variance =       0.434880271204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902944866
                                         uncertainty =       0.001881519068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902944866
                                         uncertainty =       0.001881519068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466304754
  error estimate for blocks of size 2^( 2) =       0.000491983425
  error estimate for blocks of size 2^( 3) =       0.000516731159
  error estimate for blocks of size 2^( 4) =       0.000535723808
  error estimate for blocks of size 2^( 5) =       0.000546751207
  error estimate for blocks of size 2^( 6) =       0.000553797346
  error estimate for blocks of size 2^( 7) =       0.000559120356

      target function =      -0.747491872551
              le_mean =     -22.813252369727
             les_mean =     520.891885527152
             stat err =       0.000548848179
             autocorr =       1.385366776331
   target nu stat err =       0.000548848179
   target dn stat err =       0.002623702897
      target stat err =       0.002259575518
              std dev =       0.659454507975
             le_variance =       0.434880248089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902956472
                                         uncertainty =       0.001881519416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902956472
                                         uncertainty =       0.001881519416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466304761
  error estimate for blocks of size 2^( 2) =       0.000491983437
  error estimate for blocks of size 2^( 3) =       0.000516731175
  error estimate for blocks of size 2^( 4) =       0.000535723828
  error estimate for blocks of size 2^( 5) =       0.000546751231
  error estimate for blocks of size 2^( 6) =       0.000553797369
  error estimate for blocks of size 2^( 7) =       0.000559120381

      target function =      -0.747491814957
              le_mean =     -22.813252369766
             les_mean =     520.891885598351
             stat err =       0.000548848202
             autocorr =       1.385366856059
   target nu stat err =       0.000548848202
   target dn stat err =       0.002623707515
      target stat err =       0.002259578878
              std dev =       0.659454516738
             le_variance =       0.434880259646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902966628
                                         uncertainty =       0.001881519720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434902966628
                                         uncertainty =       0.001881519720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466304766
  error estimate for blocks of size 2^( 2) =       0.000491983447
  error estimate for blocks of size 2^( 3) =       0.000516731189
  error estimate for blocks of size 2^( 4) =       0.000535723846
  error estimate for blocks of size 2^( 5) =       0.000546751251
  error estimate for blocks of size 2^( 6) =       0.000553797390
  error estimate for blocks of size 2^( 7) =       0.000559120402

      target function =      -0.747491764482
              le_mean =     -22.813252369801
             les_mean =     520.891885660751
             stat err =       0.000548848222
             autocorr =       1.385366925829
   target nu stat err =       0.000548848222
   target dn stat err =       0.002623711557
      target stat err =       0.002259581818
              std dev =       0.659454524406
             le_variance =       0.434880269760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747491757266        initial
     1.5259e+03     1.5259e+04             1.6111e-07        -0.747491872551  <--
     6.1035e+03     6.1035e+04             4.0279e-08        -0.747491814957
     2.4414e+04     2.4414e+05             1.0070e-08        -0.747491764482

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 4.2400e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_01                 1.080230e-01 3 1  ON 0
ci_02                -2.399884e-02 3 1  ON 1
ci_03                -2.427542e-02 3 1  ON 2
ci_04                 2.215382e-02 3 1  ON 3
ci_05                -1.912998e-02 3 1  ON 4
ci_06                -1.952703e-02 3 1  ON 5
ci_07                 2.575668e-02 3 1  ON 6
ci_08                -4.225041e-03 3 1  ON 7
ci_09                -7.549630e-03 3 1  ON 8
ci_10                -7.705409e-03 3 1  ON 9
ci_11                 1.374810e-02 3 1  ON 10
ci_12                 7.047005e-03 3 1  ON 11
ci_13                 1.381583e-02 3 1  ON 12
ci_14                 1.281151e-02 3 1  ON 13
ci_15                 5.167619e-03 3 1  ON 14
ci_16                 5.730621e-03 3 1  ON 15
ci_17                -5.017613e-03 3 1  ON 16
ci_18                -5.545949e-03 3 1  ON 17
ci_19                 1.033112e-02 3 1  ON 18
ci_20                 6.254366e-03 3 1  ON 19
ci_21                 8.483903e-03 3 1  ON 20
ci_22                 8.882571e-03 3 1  ON 21
ci_23                 4.168327e-03 3 1  ON 22
ci_24                 5.186705e-03 3 1  ON 23
ci_25                 3.011453e-03 3 1  ON 24
ci_26                 3.794741e-03 3 1  ON 25
ci_27                 3.289121e-03 3 1  ON 26
ci_28                 7.708361e-04 3 1  ON 27
ci_29                 1.186494e-03 3 1  ON 28
ci_30                -7.411749e-04 3 1  ON 29
ci_31                 1.034507e-03 3 1  ON 30
ci_32                -5.359012e-04 3 1  ON 31
ci_33                -1.032808e-03 3 1  ON 32
ci_34                 1.151592e-03 3 1  ON 33
ci_35                 1.248305e-03 3 1  ON 34
ci_36                -5.659859e-04 3 1  ON 35
ci_37                -5.174915e-04 3 1  ON 36
ci_38                -2.861665e-04 3 1  ON 37
ci_39                -1.421412e-04 3 1  ON 38
ci_40                -1.905967e-03 3 1  ON 39
ci_41                -5.128542e-04 3 1  ON 40
ci_42                -1.648274e-03 3 1  ON 41
ci_43                -1.292245e-03 3 1  ON 42
ci_44                -2.176906e-03 3 1  ON 43
ci_45                -2.656195e-04 3 1  ON 44
ci_46                -1.694570e-03 3 1  ON 45
ci_47                 1.435013e-03 3 1  ON 46
ci_48                 2.894066e-03 3 1  ON 47
ci_49                -8.545207e-04 3 1  ON 48
ci_50                -8.205186e-04 3 1  ON 49
ci_51                -5.674017e-04 3 1  ON 50
ci_52                -6.317728e-04 3 1  ON 51
ci_53                -8.017633e-04 3 1  ON 52
ci_54                -1.109983e-03 3 1  ON 53
ci_55                -1.237001e-03 3 1  ON 54
ci_56                 1.098424e-03 3 1  ON 55
ci_57                 2.090264e-03 3 1  ON 56
ci_58                -1.860182e-04 3 1  ON 57
ci_59                -6.203358e-04 3 1  ON 58
ci_60                 1.269642e-04 3 1  ON 59
ci_61                -9.876828e-04 3 1  ON 60
ci_62                -3.821280e-04 3 1  ON 61
ci_63                -2.475443e-04 3 1  ON 62
ci_64                -6.089983e-04 3 1  ON 63
ci_65                -1.062028e-04 3 1  ON 64
ci_66                -1.252982e-04 3 1  ON 65
ci_67                -1.926129e-04 3 1  ON 66
ci_68                -1.799099e-03 3 1  ON 67
ci_69                -1.808457e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8245
    reference variance = 0.38531
====================================================
  Execution time = 2.5746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4639e-01
  Total weights = 1.965083533e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434898842221
                                         uncertainty =       0.001976391226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434898842221
                                         uncertainty =       0.001976391226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466340465
  error estimate for blocks of size 2^( 2) =       0.000492139678
  error estimate for blocks of size 2^( 3) =       0.000516377017
  error estimate for blocks of size 2^( 4) =       0.000535857476
  error estimate for blocks of size 2^( 5) =       0.000547653432
  error estimate for blocks of size 2^( 6) =       0.000553504040
  error estimate for blocks of size 2^( 7) =       0.000556040675

      target function =      -0.748349295441
              le_mean =     -22.815481433403
             les_mean =     520.992582376587
             stat err =       0.000548263906
             autocorr =       1.382207064036
   target nu stat err =       0.000548263906
   target dn stat err =       0.002586077522
      target stat err =       0.002241707543
              std dev =       0.659505010506
             le_variance =       0.434946858883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281548143340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748354917041       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748354974601       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748355012808       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748355019601       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748355020853       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748355021260       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748355021637       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748355021676       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748355021683       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748355021688       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 1.006616e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748354917041       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748354931433       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748354940985       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748354942683       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748354942998       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748354943100       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748354943192       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748354943203       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748354943205       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748354943206       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.516672e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748354917041       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748354920639       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748354923027       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748354923448       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748354923530       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748354923555       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748354923579       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748354923581       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748354923582       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748354923580       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 6.291763e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0281e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_01                 1.080233e-01 3 1  ON 0
ci_02                -2.399899e-02 3 1  ON 1
ci_03                -2.427550e-02 3 1  ON 2
ci_04                 2.215394e-02 3 1  ON 3
ci_05                -1.913004e-02 3 1  ON 4
ci_06                -1.952707e-02 3 1  ON 5
ci_07                 2.575672e-02 3 1  ON 6
ci_08                -4.225046e-03 3 1  ON 7
ci_09                -7.549670e-03 3 1  ON 8
ci_10                -7.705350e-03 3 1  ON 9
ci_11                 1.374806e-02 3 1  ON 10
ci_12                 7.047026e-03 3 1  ON 11
ci_13                 1.381582e-02 3 1  ON 12
ci_14                 1.281151e-02 3 1  ON 13
ci_15                 5.167660e-03 3 1  ON 14
ci_16                 5.730631e-03 3 1  ON 15
ci_17                -5.017663e-03 3 1  ON 16
ci_18                -5.545950e-03 3 1  ON 17
ci_19                 1.033107e-02 3 1  ON 18
ci_20                 6.254407e-03 3 1  ON 19
ci_21                 8.483939e-03 3 1  ON 20
ci_22                 8.882491e-03 3 1  ON 21
ci_23                 4.168391e-03 3 1  ON 22
ci_24                 5.186701e-03 3 1  ON 23
ci_25                 3.011465e-03 3 1  ON 24
ci_26                 3.794724e-03 3 1  ON 25
ci_27                 3.289116e-03 3 1  ON 26
ci_28                 7.708458e-04 3 1  ON 27
ci_29                 1.186505e-03 3 1  ON 28
ci_30                -7.411826e-04 3 1  ON 29
ci_31                 1.034476e-03 3 1  ON 30
ci_32                -5.359303e-04 3 1  ON 31
ci_33                -1.032813e-03 3 1  ON 32
ci_34                 1.151575e-03 3 1  ON 33
ci_35                 1.248295e-03 3 1  ON 34
ci_36                -5.659891e-04 3 1  ON 35
ci_37                -5.175146e-04 3 1  ON 36
ci_38                -2.861885e-04 3 1  ON 37
ci_39                -1.421427e-04 3 1  ON 38
ci_40                -1.905925e-03 3 1  ON 39
ci_41                -5.128532e-04 3 1  ON 40
ci_42                -1.648259e-03 3 1  ON 41
ci_43                -1.292256e-03 3 1  ON 42
ci_44                -2.176893e-03 3 1  ON 43
ci_45                -2.656264e-04 3 1  ON 44
ci_46                -1.694522e-03 3 1  ON 45
ci_47                 1.435060e-03 3 1  ON 46
ci_48                 2.894074e-03 3 1  ON 47
ci_49                -8.544984e-04 3 1  ON 48
ci_50                -8.205077e-04 3 1  ON 49
ci_51                -5.673678e-04 3 1  ON 50
ci_52                -6.317380e-04 3 1  ON 51
ci_53                -8.017712e-04 3 1  ON 52
ci_54                -1.109975e-03 3 1  ON 53
ci_55                -1.236996e-03 3 1  ON 54
ci_56                 1.098463e-03 3 1  ON 55
ci_57                 2.090223e-03 3 1  ON 56
ci_58                -1.860153e-04 3 1  ON 57
ci_59                -6.203304e-04 3 1  ON 58
ci_60                 1.269897e-04 3 1  ON 59
ci_61                -9.876664e-04 3 1  ON 60
ci_62                -3.821136e-04 3 1  ON 61
ci_63                -2.475428e-04 3 1  ON 62
ci_64                -6.089851e-04 3 1  ON 63
ci_65                -1.062007e-04 3 1  ON 64
ci_66                -1.252955e-04 3 1  ON 65
ci_67                -1.926286e-04 3 1  ON 66
ci_68                -1.799079e-03 3 1  ON 67
ci_69                -1.808397e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7492
    reference variance = 0.272067
====================================================
  Execution time = 2.6845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4539e-01
  Total weights = 1.9646e+06
  Execution time = 3.5067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235193702
                                         uncertainty =       0.002336854908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235193702
                                         uncertainty =       0.002336854908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465934649
  error estimate for blocks of size 2^( 2) =       0.000491405624
  error estimate for blocks of size 2^( 3) =       0.000515569767
  error estimate for blocks of size 2^( 4) =       0.000533379854
  error estimate for blocks of size 2^( 5) =       0.000543346725
  error estimate for blocks of size 2^( 6) =       0.000550695048
  error estimate for blocks of size 2^( 7) =       0.000551530124

      target function =      -0.749169636869
              le_mean =     -22.814242022384
             les_mean =     520.935032229305
             stat err =       0.000544737938
             autocorr =       1.366863758795
   target nu stat err =       0.000544737938
   target dn stat err =       0.002885528767
      target stat err =       0.002482671553
              std dev =       0.658931100095
             le_variance =       0.434190194672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235081573
                                         uncertainty =       0.002336854314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235081573
                                         uncertainty =       0.002336854314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465934589
  error estimate for blocks of size 2^( 2) =       0.000491405522
  error estimate for blocks of size 2^( 3) =       0.000515569624
  error estimate for blocks of size 2^( 4) =       0.000533379685
  error estimate for blocks of size 2^( 5) =       0.000543346544
  error estimate for blocks of size 2^( 6) =       0.000550694860
  error estimate for blocks of size 2^( 7) =       0.000551529931

      target function =      -0.749170223863
              le_mean =     -22.814242020590
             les_mean =     520.935031443867
             stat err =       0.000544737755
             autocorr =       1.366863194028
   target nu stat err =       0.000544737755
   target dn stat err =       0.002885520537
      target stat err =       0.002482668613
              std dev =       0.658931015238
             le_variance =       0.434190082842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235137628
                                         uncertainty =       0.002336854612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235137628
                                         uncertainty =       0.002336854612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465934619
  error estimate for blocks of size 2^( 2) =       0.000491405573
  error estimate for blocks of size 2^( 3) =       0.000515569696
  error estimate for blocks of size 2^( 4) =       0.000533379770
  error estimate for blocks of size 2^( 5) =       0.000543346634
  error estimate for blocks of size 2^( 6) =       0.000550694954
  error estimate for blocks of size 2^( 7) =       0.000551530028

      target function =      -0.749169931237
              le_mean =     -22.814242021486
             les_mean =     520.935031835488
             stat err =       0.000544737846
             autocorr =       1.366863476377
   target nu stat err =       0.000544737846
   target dn stat err =       0.002885524622
      target stat err =       0.002482670064
              std dev =       0.658931057659
             le_variance =       0.434190138748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235186692
                                         uncertainty =       0.002336854871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235186692
                                         uncertainty =       0.002336854871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465934645
  error estimate for blocks of size 2^( 2) =       0.000491405618
  error estimate for blocks of size 2^( 3) =       0.000515569758
  error estimate for blocks of size 2^( 4) =       0.000533379844
  error estimate for blocks of size 2^( 5) =       0.000543346714
  error estimate for blocks of size 2^( 6) =       0.000550695036
  error estimate for blocks of size 2^( 7) =       0.000551530112

      target function =      -0.749169673761
              le_mean =     -22.814242022272
             les_mean =     520.935032179956
             stat err =       0.000544737926
             autocorr =       1.366863723481
   target nu stat err =       0.000544737926
   target dn stat err =       0.002885528245
      target stat err =       0.002482671365
              std dev =       0.658931094790
             le_variance =       0.434190187681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749169636869        initial
     3.8147e+02     3.8147e+03             1.0066e-06        -0.749170223863  <--
     1.5259e+03     1.5259e+04             2.5167e-07        -0.749169931237
     6.1035e+03     6.1035e+04             6.2918e-08        -0.749169673761

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.4435e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_01                 1.080240e-01 3 1  ON 0
ci_02                -2.399943e-02 3 1  ON 1
ci_03                -2.427573e-02 3 1  ON 2
ci_04                 2.215432e-02 3 1  ON 3
ci_05                -1.913023e-02 3 1  ON 4
ci_06                -1.952718e-02 3 1  ON 5
ci_07                 2.575684e-02 3 1  ON 6
ci_08                -4.225063e-03 3 1  ON 7
ci_09                -7.549791e-03 3 1  ON 8
ci_10                -7.705176e-03 3 1  ON 9
ci_11                 1.374795e-02 3 1  ON 10
ci_12                 7.047088e-03 3 1  ON 11
ci_13                 1.381580e-02 3 1  ON 12
ci_14                 1.281154e-02 3 1  ON 13
ci_15                 5.167784e-03 3 1  ON 14
ci_16                 5.730659e-03 3 1  ON 15
ci_17                -5.017813e-03 3 1  ON 16
ci_18                -5.545953e-03 3 1  ON 17
ci_19                 1.033091e-02 3 1  ON 18
ci_20                 6.254531e-03 3 1  ON 19
ci_21                 8.484049e-03 3 1  ON 20
ci_22                 8.882252e-03 3 1  ON 21
ci_23                 4.168583e-03 3 1  ON 22
ci_24                 5.186690e-03 3 1  ON 23
ci_25                 3.011502e-03 3 1  ON 24
ci_26                 3.794675e-03 3 1  ON 25
ci_27                 3.289103e-03 3 1  ON 26
ci_28                 7.708748e-04 3 1  ON 27
ci_29                 1.186536e-03 3 1  ON 28
ci_30                -7.412058e-04 3 1  ON 29
ci_31                 1.034384e-03 3 1  ON 30
ci_32                -5.360177e-04 3 1  ON 31
ci_33                -1.032826e-03 3 1  ON 32
ci_34                 1.151523e-03 3 1  ON 33
ci_35                 1.248268e-03 3 1  ON 34
ci_36                -5.659986e-04 3 1  ON 35
ci_37                -5.175836e-04 3 1  ON 36
ci_38                -2.862544e-04 3 1  ON 37
ci_39                -1.421473e-04 3 1  ON 38
ci_40                -1.905798e-03 3 1  ON 39
ci_41                -5.128503e-04 3 1  ON 40
ci_42                -1.648213e-03 3 1  ON 41
ci_43                -1.292288e-03 3 1  ON 42
ci_44                -2.176855e-03 3 1  ON 43
ci_45                -2.656472e-04 3 1  ON 44
ci_46                -1.694379e-03 3 1  ON 45
ci_47                 1.435202e-03 3 1  ON 46
ci_48                 2.894097e-03 3 1  ON 47
ci_49                -8.544316e-04 3 1  ON 48
ci_50                -8.204751e-04 3 1  ON 49
ci_51                -5.672659e-04 3 1  ON 50
ci_52                -6.316333e-04 3 1  ON 51
ci_53                -8.017950e-04 3 1  ON 52
ci_54                -1.109952e-03 3 1  ON 53
ci_55                -1.236983e-03 3 1  ON 54
ci_56                 1.098580e-03 3 1  ON 55
ci_57                 2.090103e-03 3 1  ON 56
ci_58                -1.860065e-04 3 1  ON 57
ci_59                -6.203139e-04 3 1  ON 58
ci_60                 1.270662e-04 3 1  ON 59
ci_61                -9.876172e-04 3 1  ON 60
ci_62                -3.820707e-04 3 1  ON 61
ci_63                -2.475383e-04 3 1  ON 62
ci_64                -6.089453e-04 3 1  ON 63
ci_65                -1.061942e-04 3 1  ON 64
ci_66                -1.252875e-04 3 1  ON 65
ci_67                -1.926755e-04 3 1  ON 66
ci_68                -1.799017e-03 3 1  ON 67
ci_69                -1.808216e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2796e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7997
    reference variance = 0.459019
====================================================
  Execution time = 2.5544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5809e-01
  Total weights = 1.964760677e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440510133101
                                         uncertainty =       0.002962861336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440510133101
                                         uncertainty =       0.002962861336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469294074
  error estimate for blocks of size 2^( 2) =       0.000494958623
  error estimate for blocks of size 2^( 3) =       0.000518494206
  error estimate for blocks of size 2^( 4) =       0.000536733142
  error estimate for blocks of size 2^( 5) =       0.000548327404
  error estimate for blocks of size 2^( 6) =       0.000553789689
  error estimate for blocks of size 2^( 7) =       0.000555524784

      target function =      -0.738686278949
              le_mean =     -22.815229807014
             les_mean =     520.992805276408
             stat err =       0.000548593755
             autocorr =       1.366506112344
   target nu stat err =       0.000548593755
   target dn stat err =       0.006266178797
      target stat err =       0.005125910973
              std dev =       0.663682043752
             le_variance =       0.440473855199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281522980701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738720711132       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738720993747       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738721035614       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738721045442       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738721049559       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738721052694       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738721053122       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738721053234       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738721053294       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738721053340       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 3.228465e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738720711132       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738720781813       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738720792281       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738720794738       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738720795767       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738720796551       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738720796658       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738720796686       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738720796701       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738720796712       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 8.072777e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738720711132       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738720728804       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738720731421       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738720732035       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738720732294       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738720732494       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738720732515       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738720732521       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738720732525       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738720732529       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.018295e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0041e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_01                 1.080248e-01 3 1  ON 0
ci_02                -2.400007e-02 3 1  ON 1
ci_03                -2.427624e-02 3 1  ON 2
ci_04                 2.215461e-02 3 1  ON 3
ci_05                -1.912994e-02 3 1  ON 4
ci_06                -1.952707e-02 3 1  ON 5
ci_07                 2.575718e-02 3 1  ON 6
ci_08                -4.225023e-03 3 1  ON 7
ci_09                -7.549717e-03 3 1  ON 8
ci_10                -7.704872e-03 3 1  ON 9
ci_11                 1.374829e-02 3 1  ON 10
ci_12                 7.046983e-03 3 1  ON 11
ci_13                 1.381579e-02 3 1  ON 12
ci_14                 1.281168e-02 3 1  ON 13
ci_15                 5.167746e-03 3 1  ON 14
ci_16                 5.730922e-03 3 1  ON 15
ci_17                -5.017790e-03 3 1  ON 16
ci_18                -5.545901e-03 3 1  ON 17
ci_19                 1.033075e-02 3 1  ON 18
ci_20                 6.254372e-03 3 1  ON 19
ci_21                 8.484005e-03 3 1  ON 20
ci_22                 8.882101e-03 3 1  ON 21
ci_23                 4.168857e-03 3 1  ON 22
ci_24                 5.186843e-03 3 1  ON 23
ci_25                 3.011611e-03 3 1  ON 24
ci_26                 3.794611e-03 3 1  ON 25
ci_27                 3.289174e-03 3 1  ON 26
ci_28                 7.707134e-04 3 1  ON 27
ci_29                 1.186591e-03 3 1  ON 28
ci_30                -7.411958e-04 3 1  ON 29
ci_31                 1.034519e-03 3 1  ON 30
ci_32                -5.361817e-04 3 1  ON 31
ci_33                -1.032732e-03 3 1  ON 32
ci_34                 1.151466e-03 3 1  ON 33
ci_35                 1.248335e-03 3 1  ON 34
ci_36                -5.660563e-04 3 1  ON 35
ci_37                -5.176749e-04 3 1  ON 36
ci_38                -2.863183e-04 3 1  ON 37
ci_39                -1.421886e-04 3 1  ON 38
ci_40                -1.905643e-03 3 1  ON 39
ci_41                -5.129706e-04 3 1  ON 40
ci_42                -1.648132e-03 3 1  ON 41
ci_43                -1.292484e-03 3 1  ON 42
ci_44                -2.176976e-03 3 1  ON 43
ci_45                -2.657206e-04 3 1  ON 44
ci_46                -1.694315e-03 3 1  ON 45
ci_47                 1.434961e-03 3 1  ON 46
ci_48                 2.893826e-03 3 1  ON 47
ci_49                -8.544656e-04 3 1  ON 48
ci_50                -8.204309e-04 3 1  ON 49
ci_51                -5.671041e-04 3 1  ON 50
ci_52                -6.314263e-04 3 1  ON 51
ci_53                -8.018387e-04 3 1  ON 52
ci_54                -1.109919e-03 3 1  ON 53
ci_55                -1.236918e-03 3 1  ON 54
ci_56                 1.098765e-03 3 1  ON 55
ci_57                 2.090000e-03 3 1  ON 56
ci_58                -1.863181e-04 3 1  ON 57
ci_59                -6.204322e-04 3 1  ON 58
ci_60                 1.274448e-04 3 1  ON 59
ci_61                -9.876705e-04 3 1  ON 60
ci_62                -3.820424e-04 3 1  ON 61
ci_63                -2.474016e-04 3 1  ON 62
ci_64                -6.088907e-04 3 1  ON 63
ci_65                -1.061898e-04 3 1  ON 64
ci_66                -1.253985e-04 3 1  ON 65
ci_67                -1.926400e-04 3 1  ON 66
ci_68                -1.798963e-03 3 1  ON 67
ci_69                -1.807937e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8411
    reference variance = 0.257907
====================================================
  Execution time = 2.4972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4986e-01
  Total weights = 1.9647e+06
  Execution time = 3.5086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788772060
                                         uncertainty =       0.001896920547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788772060
                                         uncertainty =       0.001896920547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467289595
  error estimate for blocks of size 2^( 2) =       0.000493326186
  error estimate for blocks of size 2^( 3) =       0.000517672353
  error estimate for blocks of size 2^( 4) =       0.000535626353
  error estimate for blocks of size 2^( 5) =       0.000546374912
  error estimate for blocks of size 2^( 6) =       0.000554928340
  error estimate for blocks of size 2^( 7) =       0.000559184056

      target function =      -0.745466060083
              le_mean =     -22.814505054207
             les_mean =     520.951497909497
             stat err =       0.000549028415
             autocorr =       1.380439641100
   target nu stat err =       0.000549028415
   target dn stat err =       0.002624779142
      target stat err =       0.002252886301
              std dev =       0.660847283153
             le_variance =       0.436719131651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788568959
                                         uncertainty =       0.001896933585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788568959
                                         uncertainty =       0.001896933585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467289487
  error estimate for blocks of size 2^( 2) =       0.000493325934
  error estimate for blocks of size 2^( 3) =       0.000517671949
  error estimate for blocks of size 2^( 4) =       0.000535625815
  error estimate for blocks of size 2^( 5) =       0.000546374316
  error estimate for blocks of size 2^( 6) =       0.000554927677
  error estimate for blocks of size 2^( 7) =       0.000559183299

      target function =      -0.745462252464
              le_mean =     -22.814505048081
             les_mean =     520.951502238021
             stat err =       0.000549027777
             autocorr =       1.380437072922
   target nu stat err =       0.000549027777
   target dn stat err =       0.002624696712
      target stat err =       0.002252798327
              std dev =       0.660847129518
             le_variance =       0.436718928592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788670349
                                         uncertainty =       0.001896927062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788670349
                                         uncertainty =       0.001896927062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467289541
  error estimate for blocks of size 2^( 2) =       0.000493326060
  error estimate for blocks of size 2^( 3) =       0.000517672151
  error estimate for blocks of size 2^( 4) =       0.000535626084
  error estimate for blocks of size 2^( 5) =       0.000546374614
  error estimate for blocks of size 2^( 6) =       0.000554928008
  error estimate for blocks of size 2^( 7) =       0.000559183677

      target function =      -0.745466329085
              le_mean =     -22.814505051150
             les_mean =     520.951497444752
             stat err =       0.000549028096
             autocorr =       1.380438356506
   target nu stat err =       0.000549028096
   target dn stat err =       0.002624733367
      target stat err =       0.002252851339
              std dev =       0.660847206214
             le_variance =       0.436719029961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788759332
                                         uncertainty =       0.001896921361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436788759332
                                         uncertainty =       0.001896921361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467289588
  error estimate for blocks of size 2^( 2) =       0.000493326170
  error estimate for blocks of size 2^( 3) =       0.000517672327
  error estimate for blocks of size 2^( 4) =       0.000535626320
  error estimate for blocks of size 2^( 5) =       0.000546374874
  error estimate for blocks of size 2^( 6) =       0.000554928299
  error estimate for blocks of size 2^( 7) =       0.000559184008

      target function =      -0.745466134083
              le_mean =     -22.814505053824
             les_mean =     520.951497802500
             stat err =       0.000549028375
             autocorr =       1.380439480530
   target nu stat err =       0.000549028375
   target dn stat err =       0.002624773420
      target stat err =       0.002252882166
              std dev =       0.660847273525
             le_variance =       0.436719118926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745466060083        initial
     9.5367e+01     9.5367e+02             3.2285e-06        -0.745462252464
     3.8147e+02     3.8147e+03             8.0728e-07        -0.745466329085  <--
     1.5259e+03     1.5259e+04             2.0183e-07        -0.745466134083

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.2524e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_01                 1.080248e-01 3 1  ON 0
ci_02                -2.400007e-02 3 1  ON 1
ci_03                -2.427624e-02 3 1  ON 2
ci_04                 2.215461e-02 3 1  ON 3
ci_05                -1.912994e-02 3 1  ON 4
ci_06                -1.952707e-02 3 1  ON 5
ci_07                 2.575718e-02 3 1  ON 6
ci_08                -4.225023e-03 3 1  ON 7
ci_09                -7.549717e-03 3 1  ON 8
ci_10                -7.704872e-03 3 1  ON 9
ci_11                 1.374829e-02 3 1  ON 10
ci_12                 7.046983e-03 3 1  ON 11
ci_13                 1.381579e-02 3 1  ON 12
ci_14                 1.281168e-02 3 1  ON 13
ci_15                 5.167746e-03 3 1  ON 14
ci_16                 5.730922e-03 3 1  ON 15
ci_17                -5.017790e-03 3 1  ON 16
ci_18                -5.545901e-03 3 1  ON 17
ci_19                 1.033075e-02 3 1  ON 18
ci_20                 6.254372e-03 3 1  ON 19
ci_21                 8.484005e-03 3 1  ON 20
ci_22                 8.882101e-03 3 1  ON 21
ci_23                 4.168857e-03 3 1  ON 22
ci_24                 5.186843e-03 3 1  ON 23
ci_25                 3.011611e-03 3 1  ON 24
ci_26                 3.794611e-03 3 1  ON 25
ci_27                 3.289174e-03 3 1  ON 26
ci_28                 7.707134e-04 3 1  ON 27
ci_29                 1.186591e-03 3 1  ON 28
ci_30                -7.411958e-04 3 1  ON 29
ci_31                 1.034519e-03 3 1  ON 30
ci_32                -5.361817e-04 3 1  ON 31
ci_33                -1.032732e-03 3 1  ON 32
ci_34                 1.151466e-03 3 1  ON 33
ci_35                 1.248335e-03 3 1  ON 34
ci_36                -5.660563e-04 3 1  ON 35
ci_37                -5.176749e-04 3 1  ON 36
ci_38                -2.863183e-04 3 1  ON 37
ci_39                -1.421886e-04 3 1  ON 38
ci_40                -1.905643e-03 3 1  ON 39
ci_41                -5.129706e-04 3 1  ON 40
ci_42                -1.648132e-03 3 1  ON 41
ci_43                -1.292484e-03 3 1  ON 42
ci_44                -2.176976e-03 3 1  ON 43
ci_45                -2.657206e-04 3 1  ON 44
ci_46                -1.694315e-03 3 1  ON 45
ci_47                 1.434961e-03 3 1  ON 46
ci_48                 2.893826e-03 3 1  ON 47
ci_49                -8.544656e-04 3 1  ON 48
ci_50                -8.204309e-04 3 1  ON 49
ci_51                -5.671041e-04 3 1  ON 50
ci_52                -6.314263e-04 3 1  ON 51
ci_53                -8.018387e-04 3 1  ON 52
ci_54                -1.109919e-03 3 1  ON 53
ci_55                -1.236918e-03 3 1  ON 54
ci_56                 1.098765e-03 3 1  ON 55
ci_57                 2.090000e-03 3 1  ON 56
ci_58                -1.863181e-04 3 1  ON 57
ci_59                -6.204322e-04 3 1  ON 58
ci_60                 1.274448e-04 3 1  ON 59
ci_61                -9.876705e-04 3 1  ON 60
ci_62                -3.820424e-04 3 1  ON 61
ci_63                -2.474016e-04 3 1  ON 62
ci_64                -6.088907e-04 3 1  ON 63
ci_65                -1.061898e-04 3 1  ON 64
ci_66                -1.253985e-04 3 1  ON 65
ci_67                -1.926400e-04 3 1  ON 66
ci_68                -1.798963e-03 3 1  ON 67
ci_69                -1.807937e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2797e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8708
    reference variance = 0.509722
====================================================
  Execution time = 2.5624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4739e-01
  Total weights = 1.964784101e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434679523111
                                         uncertainty =       0.001877674322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434679523111
                                         uncertainty =       0.001877674322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466181329
  error estimate for blocks of size 2^( 2) =       0.000492203777
  error estimate for blocks of size 2^( 3) =       0.000516594895
  error estimate for blocks of size 2^( 4) =       0.000535480725
  error estimate for blocks of size 2^( 5) =       0.000546782779
  error estimate for blocks of size 2^( 6) =       0.000554185651
  error estimate for blocks of size 2^( 7) =       0.000558384806

      target function =      -0.747504808957
              le_mean =     -22.813886029136
             les_mean =     520.920788538505
             stat err =       0.000548708490
             autocorr =       1.385394977941
   target nu stat err =       0.000548708490
   target dn stat err =       0.002467178974
      target stat err =       0.002136886401
              std dev =       0.659279957826
             le_variance =       0.434650062791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281388602914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747509930724       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747510175527       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747510211544       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747510217544       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747510221514       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747510221825       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747510221821       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747510221810       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747510221831       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 4.280603e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747509930724       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747509991949       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747510000955       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747510002455       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747510003447       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747510003524       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747510003524       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747510003521       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747510003526       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 1.070370e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747509930724       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747509946032       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747509948284       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747509948659       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747509948907       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747509948926       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747509948923       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747509948928       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747509948928       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.676062e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194924 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0123e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_01                 1.080259e-01 3 1  ON 0
ci_02                -2.400058e-02 3 1  ON 1
ci_03                -2.427678e-02 3 1  ON 2
ci_04                 2.215485e-02 3 1  ON 3
ci_05                -1.913027e-02 3 1  ON 4
ci_06                -1.952718e-02 3 1  ON 5
ci_07                 2.575696e-02 3 1  ON 6
ci_08                -4.225052e-03 3 1  ON 7
ci_09                -7.549690e-03 3 1  ON 8
ci_10                -7.704876e-03 3 1  ON 9
ci_11                 1.374820e-02 3 1  ON 10
ci_12                 7.046970e-03 3 1  ON 11
ci_13                 1.381575e-02 3 1  ON 12
ci_14                 1.281160e-02 3 1  ON 13
ci_15                 5.168012e-03 3 1  ON 14
ci_16                 5.731003e-03 3 1  ON 15
ci_17                -5.018067e-03 3 1  ON 16
ci_18                -5.546057e-03 3 1  ON 17
ci_19                 1.033053e-02 3 1  ON 18
ci_20                 6.254503e-03 3 1  ON 19
ci_21                 8.484005e-03 3 1  ON 20
ci_22                 8.881901e-03 3 1  ON 21
ci_23                 4.168969e-03 3 1  ON 22
ci_24                 5.186996e-03 3 1  ON 23
ci_25                 3.011748e-03 3 1  ON 24
ci_26                 3.794504e-03 3 1  ON 25
ci_27                 3.289298e-03 3 1  ON 26
ci_28                 7.707513e-04 3 1  ON 27
ci_29                 1.186570e-03 3 1  ON 28
ci_30                -7.411103e-04 3 1  ON 29
ci_31                 1.034500e-03 3 1  ON 30
ci_32                -5.362821e-04 3 1  ON 31
ci_33                -1.032829e-03 3 1  ON 32
ci_34                 1.151475e-03 3 1  ON 33
ci_35                 1.248384e-03 3 1  ON 34
ci_36                -5.660810e-04 3 1  ON 35
ci_37                -5.177703e-04 3 1  ON 36
ci_38                -2.863363e-04 3 1  ON 37
ci_39                -1.422020e-04 3 1  ON 38
ci_40                -1.905576e-03 3 1  ON 39
ci_41                -5.131498e-04 3 1  ON 40
ci_42                -1.648130e-03 3 1  ON 41
ci_43                -1.292546e-03 3 1  ON 42
ci_44                -2.176892e-03 3 1  ON 43
ci_45                -2.657450e-04 3 1  ON 44
ci_46                -1.694100e-03 3 1  ON 45
ci_47                 1.435035e-03 3 1  ON 46
ci_48                 2.893617e-03 3 1  ON 47
ci_49                -8.544198e-04 3 1  ON 48
ci_50                -8.203964e-04 3 1  ON 49
ci_51                -5.671904e-04 3 1  ON 50
ci_52                -6.313330e-04 3 1  ON 51
ci_53                -8.017230e-04 3 1  ON 52
ci_54                -1.109805e-03 3 1  ON 53
ci_55                -1.236864e-03 3 1  ON 54
ci_56                 1.098765e-03 3 1  ON 55
ci_57                 2.089903e-03 3 1  ON 56
ci_58                -1.861945e-04 3 1  ON 57
ci_59                -6.202500e-04 3 1  ON 58
ci_60                 1.275628e-04 3 1  ON 59
ci_61                -9.877891e-04 3 1  ON 60
ci_62                -3.819489e-04 3 1  ON 61
ci_63                -2.473899e-04 3 1  ON 62
ci_64                -6.087962e-04 3 1  ON 63
ci_65                -1.061871e-04 3 1  ON 64
ci_66                -1.254661e-04 3 1  ON 65
ci_67                -1.926654e-04 3 1  ON 66
ci_68                -1.798800e-03 3 1  ON 67
ci_69                -1.807883e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.9711
    reference variance = 1.9618
====================================================
  Execution time = 2.7017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.9648e+06
  Execution time = 3.5213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853878337
                                         uncertainty =       0.002372993529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853878337
                                         uncertainty =       0.002372993529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466345176
  error estimate for blocks of size 2^( 2) =       0.000491920293
  error estimate for blocks of size 2^( 3) =       0.000516898629
  error estimate for blocks of size 2^( 4) =       0.000534786815
  error estimate for blocks of size 2^( 5) =       0.000545274629
  error estimate for blocks of size 2^( 6) =       0.000552729039
  error estimate for blocks of size 2^( 7) =       0.000557677739

      target function =      -0.746345111760
              le_mean =     -22.814375343443
             les_mean =     520.944510174866
             stat err =       0.000547617055
             autocorr =       1.378919628888
   target nu stat err =       0.000547617055
   target dn stat err =       0.003522088594
      target stat err =       0.002979600016
              std dev =       0.659511672887
             le_variance =       0.434955646674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853697065
                                         uncertainty =       0.002373006200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853697065
                                         uncertainty =       0.002373006200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466345082
  error estimate for blocks of size 2^( 2) =       0.000491920026
  error estimate for blocks of size 2^( 3) =       0.000516898144
  error estimate for blocks of size 2^( 4) =       0.000534786183
  error estimate for blocks of size 2^( 5) =       0.000545273922
  error estimate for blocks of size 2^( 6) =       0.000552728313
  error estimate for blocks of size 2^( 7) =       0.000557676897

      target function =      -0.746346406904
              le_mean =     -22.814375341121
             les_mean =     520.944508510742
             stat err =       0.000547616329
             autocorr =       1.378916528114
   target nu stat err =       0.000547616329
   target dn stat err =       0.003521355539
      target stat err =       0.002979015597
              std dev =       0.659511539317
             le_variance =       0.434955470492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853787578
                                         uncertainty =       0.002372999865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853787578
                                         uncertainty =       0.002372999865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466345129
  error estimate for blocks of size 2^( 2) =       0.000491920159
  error estimate for blocks of size 2^( 3) =       0.000516898386
  error estimate for blocks of size 2^( 4) =       0.000534786499
  error estimate for blocks of size 2^( 5) =       0.000545274275
  error estimate for blocks of size 2^( 6) =       0.000552728676
  error estimate for blocks of size 2^( 7) =       0.000557677318

      target function =      -0.746345781016
              le_mean =     -22.814375342274
             les_mean =     520.944509316235
             stat err =       0.000547616692
             autocorr =       1.378918078010
   target nu stat err =       0.000547616692
   target dn stat err =       0.003521721498
      target stat err =       0.002979307515
              std dev =       0.659511606009
             le_variance =       0.434955558461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853866982
                                         uncertainty =       0.002372994321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434853866982
                                         uncertainty =       0.002372994321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466345170
  error estimate for blocks of size 2^( 2) =       0.000491920276
  error estimate for blocks of size 2^( 3) =       0.000516898598
  error estimate for blocks of size 2^( 4) =       0.000534786775
  error estimate for blocks of size 2^( 5) =       0.000545274585
  error estimate for blocks of size 2^( 6) =       0.000552728994
  error estimate for blocks of size 2^( 7) =       0.000557677686

      target function =      -0.746345197618
              le_mean =     -22.814375343296
             les_mean =     520.944510064837
             stat err =       0.000547617010
             autocorr =       1.378919435006
   target nu stat err =       0.000547617010
   target dn stat err =       0.003522042657
      target stat err =       0.002979563430
              std dev =       0.659511664519
             le_variance =       0.434955635637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746345111760        initial
     9.5367e+01     9.5367e+02             4.2806e-06        -0.746346406904  <--
     3.8147e+02     3.8147e+03             1.0704e-06        -0.746345781016
     1.5259e+03     1.5259e+04             2.6761e-07        -0.746345197618

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 4.4663e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_01                 1.080291e-01 3 1  ON 0
ci_02                -2.400210e-02 3 1  ON 1
ci_03                -2.427840e-02 3 1  ON 2
ci_04                 2.215556e-02 3 1  ON 3
ci_05                -1.913126e-02 3 1  ON 4
ci_06                -1.952749e-02 3 1  ON 5
ci_07                 2.575631e-02 3 1  ON 6
ci_08                -4.225136e-03 3 1  ON 7
ci_09                -7.549608e-03 3 1  ON 8
ci_10                -7.704890e-03 3 1  ON 9
ci_11                 1.374793e-02 3 1  ON 10
ci_12                 7.046932e-03 3 1  ON 11
ci_13                 1.381562e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.168810e-03 3 1  ON 14
ci_16                 5.731244e-03 3 1  ON 15
ci_17                -5.018895e-03 3 1  ON 16
ci_18                -5.546525e-03 3 1  ON 17
ci_19                 1.032987e-02 3 1  ON 18
ci_20                 6.254895e-03 3 1  ON 19
ci_21                 8.484003e-03 3 1  ON 20
ci_22                 8.881300e-03 3 1  ON 21
ci_23                 4.169302e-03 3 1  ON 22
ci_24                 5.187455e-03 3 1  ON 23
ci_25                 3.012161e-03 3 1  ON 24
ci_26                 3.794185e-03 3 1  ON 25
ci_27                 3.289669e-03 3 1  ON 26
ci_28                 7.708649e-04 3 1  ON 27
ci_29                 1.186509e-03 3 1  ON 28
ci_30                -7.408536e-04 3 1  ON 29
ci_31                 1.034444e-03 3 1  ON 30
ci_32                -5.365832e-04 3 1  ON 31
ci_33                -1.033120e-03 3 1  ON 32
ci_34                 1.151501e-03 3 1  ON 33
ci_35                 1.248528e-03 3 1  ON 34
ci_36                -5.661550e-04 3 1  ON 35
ci_37                -5.180564e-04 3 1  ON 36
ci_38                -2.863902e-04 3 1  ON 37
ci_39                -1.422422e-04 3 1  ON 38
ci_40                -1.905376e-03 3 1  ON 39
ci_41                -5.136872e-04 3 1  ON 40
ci_42                -1.648124e-03 3 1  ON 41
ci_43                -1.292733e-03 3 1  ON 42
ci_44                -2.176639e-03 3 1  ON 43
ci_45                -2.658183e-04 3 1  ON 44
ci_46                -1.693456e-03 3 1  ON 45
ci_47                 1.435258e-03 3 1  ON 46
ci_48                 2.892988e-03 3 1  ON 47
ci_49                -8.542823e-04 3 1  ON 48
ci_50                -8.202928e-04 3 1  ON 49
ci_51                -5.674493e-04 3 1  ON 50
ci_52                -6.310532e-04 3 1  ON 51
ci_53                -8.013762e-04 3 1  ON 52
ci_54                -1.109464e-03 3 1  ON 53
ci_55                -1.236699e-03 3 1  ON 54
ci_56                 1.098764e-03 3 1  ON 55
ci_57                 2.089611e-03 3 1  ON 56
ci_58                -1.858240e-04 3 1  ON 57
ci_59                -6.197036e-04 3 1  ON 58
ci_60                 1.279169e-04 3 1  ON 59
ci_61                -9.881449e-04 3 1  ON 60
ci_62                -3.816685e-04 3 1  ON 61
ci_63                -2.473549e-04 3 1  ON 62
ci_64                -6.085127e-04 3 1  ON 63
ci_65                -1.061790e-04 3 1  ON 64
ci_66                -1.256689e-04 3 1  ON 65
ci_67                -1.927415e-04 3 1  ON 66
ci_68                -1.798312e-03 3 1  ON 67
ci_69                -1.807721e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2803e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8825
    reference variance = 0.388048
====================================================
  Execution time = 2.5703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4293e-01
  Total weights = 1.964694208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432392400502
                                         uncertainty =       0.001774801158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432392400502
                                         uncertainty =       0.001774801158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464926126
  error estimate for blocks of size 2^( 2) =       0.000490690885
  error estimate for blocks of size 2^( 3) =       0.000514528147
  error estimate for blocks of size 2^( 4) =       0.000532474922
  error estimate for blocks of size 2^( 5) =       0.000544265637
  error estimate for blocks of size 2^( 6) =       0.000550730513
  error estimate for blocks of size 2^( 7) =       0.000552750807

      target function =      -0.751230487232
              le_mean =     -22.814257759592
             les_mean =     520.933290226275
             stat err =       0.000545055470
             autocorr =       1.374401123110
   target nu stat err =       0.000545055470
   target dn stat err =       0.002359173214
      target stat err =       0.002070639232
              std dev =       0.657504833027
             le_variance =       0.432312605454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281425775959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751235206737       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751236039876       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751236180478       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751236202659       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751236215208       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751236219834       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751236220301       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751236220375       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751236220254       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751236220212       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.279996e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751235206737       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751235415348       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751235450530       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751235456075       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751235459210       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751235460365       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751235460481       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751235460500       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751235460470       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751235460459       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 3.202739e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751235206737       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751235258910       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751235267708       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751235269094       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751235269877       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751235270166       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751235270195       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751235270199       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751235270192       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751235270190       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 8.008567e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0248e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_01                 1.080323e-01 3 1  ON 0
ci_02                -2.400399e-02 3 1  ON 1
ci_03                -2.428046e-02 3 1  ON 2
ci_04                 2.215703e-02 3 1  ON 3
ci_05                -1.913262e-02 3 1  ON 4
ci_06                -1.952786e-02 3 1  ON 5
ci_07                 2.575667e-02 3 1  ON 6
ci_08                -4.225404e-03 3 1  ON 7
ci_09                -7.549352e-03 3 1  ON 8
ci_10                -7.704797e-03 3 1  ON 9
ci_11                 1.374763e-02 3 1  ON 10
ci_12                 7.047203e-03 3 1  ON 11
ci_13                 1.381604e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.169418e-03 3 1  ON 14
ci_16                 5.731151e-03 3 1  ON 15
ci_17                -5.019543e-03 3 1  ON 16
ci_18                -5.546391e-03 3 1  ON 17
ci_19                 1.032879e-02 3 1  ON 18
ci_20                 6.254808e-03 3 1  ON 19
ci_21                 8.483753e-03 3 1  ON 20
ci_22                 8.881555e-03 3 1  ON 21
ci_23                 4.169806e-03 3 1  ON 22
ci_24                 5.187164e-03 3 1  ON 23
ci_25                 3.011968e-03 3 1  ON 24
ci_26                 3.793848e-03 3 1  ON 25
ci_27                 3.290139e-03 3 1  ON 26
ci_28                 7.715661e-04 3 1  ON 27
ci_29                 1.186435e-03 3 1  ON 28
ci_30                -7.405620e-04 3 1  ON 29
ci_31                 1.033991e-03 3 1  ON 30
ci_32                -5.367710e-04 3 1  ON 31
ci_33                -1.033539e-03 3 1  ON 32
ci_34                 1.152173e-03 3 1  ON 33
ci_35                 1.248275e-03 3 1  ON 34
ci_36                -5.663365e-04 3 1  ON 35
ci_37                -5.182132e-04 3 1  ON 36
ci_38                -2.865265e-04 3 1  ON 37
ci_39                -1.421297e-04 3 1  ON 38
ci_40                -1.904980e-03 3 1  ON 39
ci_41                -5.136332e-04 3 1  ON 40
ci_42                -1.647536e-03 3 1  ON 41
ci_43                -1.293435e-03 3 1  ON 42
ci_44                -2.176560e-03 3 1  ON 43
ci_45                -2.656507e-04 3 1  ON 44
ci_46                -1.692954e-03 3 1  ON 45
ci_47                 1.434861e-03 3 1  ON 46
ci_48                 2.892945e-03 3 1  ON 47
ci_49                -8.543718e-04 3 1  ON 48
ci_50                -8.202259e-04 3 1  ON 49
ci_51                -5.670858e-04 3 1  ON 50
ci_52                -6.304210e-04 3 1  ON 51
ci_53                -8.013067e-04 3 1  ON 52
ci_54                -1.109156e-03 3 1  ON 53
ci_55                -1.236727e-03 3 1  ON 54
ci_56                 1.099035e-03 3 1  ON 55
ci_57                 2.089607e-03 3 1  ON 56
ci_58                -1.860854e-04 3 1  ON 57
ci_59                -6.195892e-04 3 1  ON 58
ci_60                 1.280714e-04 3 1  ON 59
ci_61                -9.873344e-04 3 1  ON 60
ci_62                -3.815416e-04 3 1  ON 61
ci_63                -2.473463e-04 3 1  ON 62
ci_64                -6.087969e-04 3 1  ON 63
ci_65                -1.062124e-04 3 1  ON 64
ci_66                -1.258921e-04 3 1  ON 65
ci_67                -1.930614e-04 3 1  ON 66
ci_68                -1.798537e-03 3 1  ON 67
ci_69                -1.807102e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.9317
    reference variance = 0.342076
====================================================
  Execution time = 2.4950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5158e-01
  Total weights = 1.9648e+06
  Execution time = 3.5139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439166571173
                                         uncertainty =       0.002410399592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439166571173
                                         uncertainty =       0.002410399592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468622424
  error estimate for blocks of size 2^( 2) =       0.000494354412
  error estimate for blocks of size 2^( 3) =       0.000518809687
  error estimate for blocks of size 2^( 4) =       0.000537562939
  error estimate for blocks of size 2^( 5) =       0.000549705393
  error estimate for blocks of size 2^( 6) =       0.000556941423
  error estimate for blocks of size 2^( 7) =       0.000564579068

      target function =      -0.744046887140
              le_mean =     -22.815159278900
             les_mean =     520.983069796148
             stat err =       0.000552197206
             autocorr =       1.388488467433
   target nu stat err =       0.000552197206
   target dn stat err =       0.002792124221
      target stat err =       0.002380765114
              std dev =       0.662732187614
             le_variance =       0.439213952499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439165758801
                                         uncertainty =       0.002410422359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439165758801
                                         uncertainty =       0.002410422359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468621997
  error estimate for blocks of size 2^( 2) =       0.000494353325
  error estimate for blocks of size 2^( 3) =       0.000518807869
  error estimate for blocks of size 2^( 4) =       0.000537560552
  error estimate for blocks of size 2^( 5) =       0.000549702652
  error estimate for blocks of size 2^( 6) =       0.000556938503
  error estimate for blocks of size 2^( 7) =       0.000564576373

      target function =      -0.744043824953
              le_mean =     -22.815159235353
             les_mean =     520.983071524128
             stat err =       0.000552194520
             autocorr =       1.388477492695
   target nu stat err =       0.000552194520
   target dn stat err =       0.002792299328
      target stat err =       0.002380884704
              std dev =       0.662731583441
             le_variance =       0.439213151691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439166163334
                                         uncertainty =       0.002410411004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439166163334
                                         uncertainty =       0.002410411004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468622209
  error estimate for blocks of size 2^( 2) =       0.000494353868
  error estimate for blocks of size 2^( 3) =       0.000518808776
  error estimate for blocks of size 2^( 4) =       0.000537561743
  error estimate for blocks of size 2^( 5) =       0.000549704020
  error estimate for blocks of size 2^( 6) =       0.000556939961
  error estimate for blocks of size 2^( 7) =       0.000564577718

      target function =      -0.744045431726
              le_mean =     -22.815159256892
             les_mean =     520.983070557591
             stat err =       0.000552195860
             autocorr =       1.388482973390
   target nu stat err =       0.000552195860
   target dn stat err =       0.002792210076
      target stat err =       0.002380824024
              std dev =       0.662731884285
             le_variance =       0.439213550448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439166520052
                                         uncertainty =       0.002410401018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439166520052
                                         uncertainty =       0.002410401018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468622397
  error estimate for blocks of size 2^( 2) =       0.000494354344
  error estimate for blocks of size 2^( 3) =       0.000518809573
  error estimate for blocks of size 2^( 4) =       0.000537562789
  error estimate for blocks of size 2^( 5) =       0.000549705221
  error estimate for blocks of size 2^( 6) =       0.000556941240
  error estimate for blocks of size 2^( 7) =       0.000564578899

      target function =      -0.744046713021
              le_mean =     -22.815159276126
             les_mean =     520.983069880800
             stat err =       0.000552197037
             autocorr =       1.388487780527
   target nu stat err =       0.000552197037
   target dn stat err =       0.002792134766
      target stat err =       0.002380772377
              std dev =       0.662732149591
             le_variance =       0.439213902102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744046887140        initial  <--
     2.3842e+01     2.3842e+02             1.2800e-05        -0.744043824953
     9.5367e+01     9.5367e+02             3.2027e-06        -0.744045431726
     3.8147e+02     3.8147e+03             8.0086e-07        -0.744046713021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5100
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_01                 1.080291e-01 3 1  ON 0
ci_02                -2.400210e-02 3 1  ON 1
ci_03                -2.427840e-02 3 1  ON 2
ci_04                 2.215556e-02 3 1  ON 3
ci_05                -1.913126e-02 3 1  ON 4
ci_06                -1.952749e-02 3 1  ON 5
ci_07                 2.575631e-02 3 1  ON 6
ci_08                -4.225136e-03 3 1  ON 7
ci_09                -7.549608e-03 3 1  ON 8
ci_10                -7.704890e-03 3 1  ON 9
ci_11                 1.374793e-02 3 1  ON 10
ci_12                 7.046932e-03 3 1  ON 11
ci_13                 1.381562e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.168810e-03 3 1  ON 14
ci_16                 5.731244e-03 3 1  ON 15
ci_17                -5.018895e-03 3 1  ON 16
ci_18                -5.546525e-03 3 1  ON 17
ci_19                 1.032987e-02 3 1  ON 18
ci_20                 6.254895e-03 3 1  ON 19
ci_21                 8.484003e-03 3 1  ON 20
ci_22                 8.881300e-03 3 1  ON 21
ci_23                 4.169302e-03 3 1  ON 22
ci_24                 5.187455e-03 3 1  ON 23
ci_25                 3.012161e-03 3 1  ON 24
ci_26                 3.794185e-03 3 1  ON 25
ci_27                 3.289669e-03 3 1  ON 26
ci_28                 7.708649e-04 3 1  ON 27
ci_29                 1.186509e-03 3 1  ON 28
ci_30                -7.408536e-04 3 1  ON 29
ci_31                 1.034444e-03 3 1  ON 30
ci_32                -5.365832e-04 3 1  ON 31
ci_33                -1.033120e-03 3 1  ON 32
ci_34                 1.151501e-03 3 1  ON 33
ci_35                 1.248528e-03 3 1  ON 34
ci_36                -5.661550e-04 3 1  ON 35
ci_37                -5.180564e-04 3 1  ON 36
ci_38                -2.863902e-04 3 1  ON 37
ci_39                -1.422422e-04 3 1  ON 38
ci_40                -1.905376e-03 3 1  ON 39
ci_41                -5.136872e-04 3 1  ON 40
ci_42                -1.648124e-03 3 1  ON 41
ci_43                -1.292733e-03 3 1  ON 42
ci_44                -2.176639e-03 3 1  ON 43
ci_45                -2.658183e-04 3 1  ON 44
ci_46                -1.693456e-03 3 1  ON 45
ci_47                 1.435258e-03 3 1  ON 46
ci_48                 2.892988e-03 3 1  ON 47
ci_49                -8.542823e-04 3 1  ON 48
ci_50                -8.202928e-04 3 1  ON 49
ci_51                -5.674493e-04 3 1  ON 50
ci_52                -6.310532e-04 3 1  ON 51
ci_53                -8.013762e-04 3 1  ON 52
ci_54                -1.109464e-03 3 1  ON 53
ci_55                -1.236699e-03 3 1  ON 54
ci_56                 1.098764e-03 3 1  ON 55
ci_57                 2.089611e-03 3 1  ON 56
ci_58                -1.858240e-04 3 1  ON 57
ci_59                -6.197036e-04 3 1  ON 58
ci_60                 1.279169e-04 3 1  ON 59
ci_61                -9.881449e-04 3 1  ON 60
ci_62                -3.816685e-04 3 1  ON 61
ci_63                -2.473549e-04 3 1  ON 62
ci_64                -6.085127e-04 3 1  ON 63
ci_65                -1.061790e-04 3 1  ON 64
ci_66                -1.256689e-04 3 1  ON 65
ci_67                -1.927415e-04 3 1  ON 66
ci_68                -1.798312e-03 3 1  ON 67
ci_69                -1.807721e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8241
    reference variance = 0.263636
====================================================
  Execution time = 2.5834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4709e-01
  Total weights = 1.965034420e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435086960707
                                         uncertainty =       0.002236292728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435086960707
                                         uncertainty =       0.002236292728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466421395
  error estimate for blocks of size 2^( 2) =       0.000492617329
  error estimate for blocks of size 2^( 3) =       0.000517149240
  error estimate for blocks of size 2^( 4) =       0.000535779190
  error estimate for blocks of size 2^( 5) =       0.000548391940
  error estimate for blocks of size 2^( 6) =       0.000554667590
  error estimate for blocks of size 2^( 7) =       0.000562885689

      target function =      -0.747758161617
              le_mean =     -22.813914686342
             les_mean =     520.921789831623
             stat err =       0.000550431102
             autocorr =       1.392672516375
   target nu stat err =       0.000550431102
   target dn stat err =       0.002728602767
      target stat err =       0.002347853110
              std dev =       0.659619462176
             le_variance =       0.435097834881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281391468634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747764484432       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747764574460       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747764588271       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747764592872       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747764594226       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747764594716       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747764594615       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747764594638       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747764594658       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747764594663       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 1.155025e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747764484432       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747764506943       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747764510396       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747764511546       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747764511885       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747764512006       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747764511983       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747764511987       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747764511992       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747764511993       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 2.887814e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747764484432       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747764490060       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747764490923       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747764491211       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747764491292       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747764491326       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747764491329       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747764491321       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747764491322       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747764491323       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 7.219692e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201944 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0346e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_01                 1.080294e-01 3 1  ON 0
ci_02                -2.400224e-02 3 1  ON 1
ci_03                -2.427865e-02 3 1  ON 2
ci_04                 2.215576e-02 3 1  ON 3
ci_05                -1.913130e-02 3 1  ON 4
ci_06                -1.952760e-02 3 1  ON 5
ci_07                 2.575637e-02 3 1  ON 6
ci_08                -4.225171e-03 3 1  ON 7
ci_09                -7.549599e-03 3 1  ON 8
ci_10                -7.704913e-03 3 1  ON 9
ci_11                 1.374788e-02 3 1  ON 10
ci_12                 7.046935e-03 3 1  ON 11
ci_13                 1.381560e-02 3 1  ON 12
ci_14                 1.281139e-02 3 1  ON 13
ci_15                 5.168826e-03 3 1  ON 14
ci_16                 5.731296e-03 3 1  ON 15
ci_17                -5.018941e-03 3 1  ON 16
ci_18                -5.546584e-03 3 1  ON 17
ci_19                 1.032978e-02 3 1  ON 18
ci_20                 6.254978e-03 3 1  ON 19
ci_21                 8.483994e-03 3 1  ON 20
ci_22                 8.881259e-03 3 1  ON 21
ci_23                 4.169322e-03 3 1  ON 22
ci_24                 5.187404e-03 3 1  ON 23
ci_25                 3.012186e-03 3 1  ON 24
ci_26                 3.794173e-03 3 1  ON 25
ci_27                 3.289657e-03 3 1  ON 26
ci_28                 7.708408e-04 3 1  ON 27
ci_29                 1.186516e-03 3 1  ON 28
ci_30                -7.409335e-04 3 1  ON 29
ci_31                 1.034424e-03 3 1  ON 30
ci_32                -5.365807e-04 3 1  ON 31
ci_33                -1.033140e-03 3 1  ON 32
ci_34                 1.151521e-03 3 1  ON 33
ci_35                 1.248536e-03 3 1  ON 34
ci_36                -5.661677e-04 3 1  ON 35
ci_37                -5.181101e-04 3 1  ON 36
ci_38                -2.864438e-04 3 1  ON 37
ci_39                -1.422830e-04 3 1  ON 38
ci_40                -1.905376e-03 3 1  ON 39
ci_41                -5.137045e-04 3 1  ON 40
ci_42                -1.648144e-03 3 1  ON 41
ci_43                -1.292653e-03 3 1  ON 42
ci_44                -2.176637e-03 3 1  ON 43
ci_45                -2.658322e-04 3 1  ON 44
ci_46                -1.693347e-03 3 1  ON 45
ci_47                 1.435310e-03 3 1  ON 46
ci_48                 2.892947e-03 3 1  ON 47
ci_49                -8.542870e-04 3 1  ON 48
ci_50                -8.203285e-04 3 1  ON 49
ci_51                -5.674520e-04 3 1  ON 50
ci_52                -6.310196e-04 3 1  ON 51
ci_53                -8.013502e-04 3 1  ON 52
ci_54                -1.109407e-03 3 1  ON 53
ci_55                -1.236681e-03 3 1  ON 54
ci_56                 1.098832e-03 3 1  ON 55
ci_57                 2.089609e-03 3 1  ON 56
ci_58                -1.858614e-04 3 1  ON 57
ci_59                -6.197031e-04 3 1  ON 58
ci_60                 1.279098e-04 3 1  ON 59
ci_61                -9.880435e-04 3 1  ON 60
ci_62                -3.816973e-04 3 1  ON 61
ci_63                -2.473835e-04 3 1  ON 62
ci_64                -6.084883e-04 3 1  ON 63
ci_65                -1.062148e-04 3 1  ON 64
ci_66                -1.256950e-04 3 1  ON 65
ci_67                -1.927427e-04 3 1  ON 66
ci_68                -1.798254e-03 3 1  ON 67
ci_69                -1.807674e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8675
    reference variance = 0.505575
====================================================
  Execution time = 2.6780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5061e-01
  Total weights = 1.9648e+06
  Execution time = 3.5001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649145934
                                         uncertainty =       0.002619775868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649145934
                                         uncertainty =       0.002619775868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466680918
  error estimate for blocks of size 2^( 2) =       0.000492264757
  error estimate for blocks of size 2^( 3) =       0.000517057808
  error estimate for blocks of size 2^( 4) =       0.000535916429
  error estimate for blocks of size 2^( 5) =       0.000548348604
  error estimate for blocks of size 2^( 6) =       0.000555271364
  error estimate for blocks of size 2^( 7) =       0.000558763058

      target function =      -0.744839749654
              le_mean =     -22.814079177923
             les_mean =     520.932815509355
             stat err =       0.000549574864
             autocorr =       1.386799368614
   target nu stat err =       0.000549574864
   target dn stat err =       0.003692130067
      target stat err =       0.003104337472
              std dev =       0.659986483322
             le_variance =       0.435582158167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649157161
                                         uncertainty =       0.002619832744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649157161
                                         uncertainty =       0.002619832744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466680924
  error estimate for blocks of size 2^( 2) =       0.000492264685
  error estimate for blocks of size 2^( 3) =       0.000517057667
  error estimate for blocks of size 2^( 4) =       0.000535916238
  error estimate for blocks of size 2^( 5) =       0.000548348368
  error estimate for blocks of size 2^( 6) =       0.000555271126
  error estimate for blocks of size 2^( 7) =       0.000558762841

      target function =      -0.744838926357
              le_mean =     -22.814079179795
             les_mean =     520.932816592674
             stat err =       0.000549574643
             autocorr =       1.386798217628
   target nu stat err =       0.000549574643
   target dn stat err =       0.003692214027
      target stat err =       0.003104398586
              std dev =       0.659986492113
             le_variance =       0.435582169771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649151533
                                         uncertainty =       0.002619804308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649151533
                                         uncertainty =       0.002619804308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466680921
  error estimate for blocks of size 2^( 2) =       0.000492264721
  error estimate for blocks of size 2^( 3) =       0.000517057738
  error estimate for blocks of size 2^( 4) =       0.000535916334
  error estimate for blocks of size 2^( 5) =       0.000548348486
  error estimate for blocks of size 2^( 6) =       0.000555271245
  error estimate for blocks of size 2^( 7) =       0.000558762949

      target function =      -0.744839339977
              le_mean =     -22.814079178857
             les_mean =     520.932816048530
             stat err =       0.000549574753
             autocorr =       1.386798793054
   target nu stat err =       0.000549574753
   target dn stat err =       0.003692171973
      target stat err =       0.003104367985
              std dev =       0.659986487707
             le_variance =       0.435582163955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649146632
                                         uncertainty =       0.002619779423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435649146632
                                         uncertainty =       0.002619779423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466680918
  error estimate for blocks of size 2^( 2) =       0.000492264752
  error estimate for blocks of size 2^( 3) =       0.000517057800
  error estimate for blocks of size 2^( 4) =       0.000535916417
  error estimate for blocks of size 2^( 5) =       0.000548348589
  error estimate for blocks of size 2^( 6) =       0.000555271349
  error estimate for blocks of size 2^( 7) =       0.000558763044

      target function =      -0.744839698658
              le_mean =     -22.814079178040
             les_mean =     520.932815576483
             stat err =       0.000549574850
             autocorr =       1.386799296673
   target nu stat err =       0.000549574850
   target dn stat err =       0.003692135297
      target stat err =       0.003104341281
              std dev =       0.659986483869
             le_variance =       0.435582158890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744839749654        initial  <--
     2.3842e+02     2.3842e+03             1.1550e-06        -0.744838926357
     9.5367e+02     9.5367e+03             2.8878e-07        -0.744839339977
     3.8147e+03     3.8147e+04             7.2197e-08        -0.744839698658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3275
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_01                 1.080291e-01 3 1  ON 0
ci_02                -2.400210e-02 3 1  ON 1
ci_03                -2.427840e-02 3 1  ON 2
ci_04                 2.215556e-02 3 1  ON 3
ci_05                -1.913126e-02 3 1  ON 4
ci_06                -1.952749e-02 3 1  ON 5
ci_07                 2.575631e-02 3 1  ON 6
ci_08                -4.225136e-03 3 1  ON 7
ci_09                -7.549608e-03 3 1  ON 8
ci_10                -7.704890e-03 3 1  ON 9
ci_11                 1.374793e-02 3 1  ON 10
ci_12                 7.046932e-03 3 1  ON 11
ci_13                 1.381562e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.168810e-03 3 1  ON 14
ci_16                 5.731244e-03 3 1  ON 15
ci_17                -5.018895e-03 3 1  ON 16
ci_18                -5.546525e-03 3 1  ON 17
ci_19                 1.032987e-02 3 1  ON 18
ci_20                 6.254895e-03 3 1  ON 19
ci_21                 8.484003e-03 3 1  ON 20
ci_22                 8.881300e-03 3 1  ON 21
ci_23                 4.169302e-03 3 1  ON 22
ci_24                 5.187455e-03 3 1  ON 23
ci_25                 3.012161e-03 3 1  ON 24
ci_26                 3.794185e-03 3 1  ON 25
ci_27                 3.289669e-03 3 1  ON 26
ci_28                 7.708649e-04 3 1  ON 27
ci_29                 1.186509e-03 3 1  ON 28
ci_30                -7.408536e-04 3 1  ON 29
ci_31                 1.034444e-03 3 1  ON 30
ci_32                -5.365832e-04 3 1  ON 31
ci_33                -1.033120e-03 3 1  ON 32
ci_34                 1.151501e-03 3 1  ON 33
ci_35                 1.248528e-03 3 1  ON 34
ci_36                -5.661550e-04 3 1  ON 35
ci_37                -5.180564e-04 3 1  ON 36
ci_38                -2.863902e-04 3 1  ON 37
ci_39                -1.422422e-04 3 1  ON 38
ci_40                -1.905376e-03 3 1  ON 39
ci_41                -5.136872e-04 3 1  ON 40
ci_42                -1.648124e-03 3 1  ON 41
ci_43                -1.292733e-03 3 1  ON 42
ci_44                -2.176639e-03 3 1  ON 43
ci_45                -2.658183e-04 3 1  ON 44
ci_46                -1.693456e-03 3 1  ON 45
ci_47                 1.435258e-03 3 1  ON 46
ci_48                 2.892988e-03 3 1  ON 47
ci_49                -8.542823e-04 3 1  ON 48
ci_50                -8.202928e-04 3 1  ON 49
ci_51                -5.674493e-04 3 1  ON 50
ci_52                -6.310532e-04 3 1  ON 51
ci_53                -8.013762e-04 3 1  ON 52
ci_54                -1.109464e-03 3 1  ON 53
ci_55                -1.236699e-03 3 1  ON 54
ci_56                 1.098764e-03 3 1  ON 55
ci_57                 2.089611e-03 3 1  ON 56
ci_58                -1.858240e-04 3 1  ON 57
ci_59                -6.197036e-04 3 1  ON 58
ci_60                 1.279169e-04 3 1  ON 59
ci_61                -9.881449e-04 3 1  ON 60
ci_62                -3.816685e-04 3 1  ON 61
ci_63                -2.473549e-04 3 1  ON 62
ci_64                -6.085127e-04 3 1  ON 63
ci_65                -1.061790e-04 3 1  ON 64
ci_66                -1.256689e-04 3 1  ON 65
ci_67                -1.927415e-04 3 1  ON 66
ci_68                -1.798312e-03 3 1  ON 67
ci_69                -1.807721e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4681e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8378
    reference variance = 0.441361
====================================================
  Execution time = 2.5582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5254e-01
  Total weights = 1.964713603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438601485802
                                         uncertainty =       0.003648956257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438601485802
                                         uncertainty =       0.003648956257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468287973
  error estimate for blocks of size 2^( 2) =       0.000493683482
  error estimate for blocks of size 2^( 3) =       0.000517825339
  error estimate for blocks of size 2^( 4) =       0.000535446260
  error estimate for blocks of size 2^( 5) =       0.000547822180
  error estimate for blocks of size 2^( 6) =       0.000553342689
  error estimate for blocks of size 2^( 7) =       0.000557595463

      target function =      -0.743230056341
              le_mean =     -22.814538957276
             les_mean =     520.955730054213
             stat err =       0.000548551648
             autocorr =       1.372173541943
   target nu stat err =       0.000548551648
   target dn stat err =       0.005759284860
      target stat err =       0.004770040071
              std dev =       0.662259201812
             le_variance =       0.438587250384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281453895728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743259398169       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743259408704       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743259410493       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743259411109       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743259411280       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743259411325       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743259411312       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743259411295       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743259411295       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743259411292       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.408437e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743259398169       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743259400803       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743259401250       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743259401404       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743259401448       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743259401458       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743259401458       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743259401451       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743259401459       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743259401450       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 3.521121e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743259398169       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743259398828       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743259398940       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743259398967       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743259398989       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743259398992       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743259398991       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743259398990       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743259398990       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743259398870       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 8.802822e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0109e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_01                 1.080291e-01 3 1  ON 0
ci_02                -2.400212e-02 3 1  ON 1
ci_03                -2.427842e-02 3 1  ON 2
ci_04                 2.215557e-02 3 1  ON 3
ci_05                -1.913127e-02 3 1  ON 4
ci_06                -1.952749e-02 3 1  ON 5
ci_07                 2.575632e-02 3 1  ON 6
ci_08                -4.225133e-03 3 1  ON 7
ci_09                -7.549606e-03 3 1  ON 8
ci_10                -7.704884e-03 3 1  ON 9
ci_11                 1.374793e-02 3 1  ON 10
ci_12                 7.046932e-03 3 1  ON 11
ci_13                 1.381561e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.168802e-03 3 1  ON 14
ci_16                 5.731247e-03 3 1  ON 15
ci_17                -5.018902e-03 3 1  ON 16
ci_18                -5.546527e-03 3 1  ON 17
ci_19                 1.032987e-02 3 1  ON 18
ci_20                 6.254891e-03 3 1  ON 19
ci_21                 8.484007e-03 3 1  ON 20
ci_22                 8.881300e-03 3 1  ON 21
ci_23                 4.169308e-03 3 1  ON 22
ci_24                 5.187449e-03 3 1  ON 23
ci_25                 3.012166e-03 3 1  ON 24
ci_26                 3.794186e-03 3 1  ON 25
ci_27                 3.289678e-03 3 1  ON 26
ci_28                 7.708700e-04 3 1  ON 27
ci_29                 1.186512e-03 3 1  ON 28
ci_30                -7.408575e-04 3 1  ON 29
ci_31                 1.034440e-03 3 1  ON 30
ci_32                -5.365799e-04 3 1  ON 31
ci_33                -1.033126e-03 3 1  ON 32
ci_34                 1.151498e-03 3 1  ON 33
ci_35                 1.248527e-03 3 1  ON 34
ci_36                -5.661541e-04 3 1  ON 35
ci_37                -5.180593e-04 3 1  ON 36
ci_38                -2.863900e-04 3 1  ON 37
ci_39                -1.422364e-04 3 1  ON 38
ci_40                -1.905373e-03 3 1  ON 39
ci_41                -5.136978e-04 3 1  ON 40
ci_42                -1.648121e-03 3 1  ON 41
ci_43                -1.292737e-03 3 1  ON 42
ci_44                -2.176630e-03 3 1  ON 43
ci_45                -2.658223e-04 3 1  ON 44
ci_46                -1.693455e-03 3 1  ON 45
ci_47                 1.435255e-03 3 1  ON 46
ci_48                 2.892978e-03 3 1  ON 47
ci_49                -8.542786e-04 3 1  ON 48
ci_50                -8.202876e-04 3 1  ON 49
ci_51                -5.674445e-04 3 1  ON 50
ci_52                -6.310487e-04 3 1  ON 51
ci_53                -8.013788e-04 3 1  ON 52
ci_54                -1.109461e-03 3 1  ON 53
ci_55                -1.236695e-03 3 1  ON 54
ci_56                 1.098765e-03 3 1  ON 55
ci_57                 2.089607e-03 3 1  ON 56
ci_58                -1.858249e-04 3 1  ON 57
ci_59                -6.197088e-04 3 1  ON 58
ci_60                 1.279257e-04 3 1  ON 59
ci_61                -9.881296e-04 3 1  ON 60
ci_62                -3.816667e-04 3 1  ON 61
ci_63                -2.473590e-04 3 1  ON 62
ci_64                -6.085078e-04 3 1  ON 63
ci_65                -1.061823e-04 3 1  ON 64
ci_66                -1.256857e-04 3 1  ON 65
ci_67                -1.927418e-04 3 1  ON 66
ci_68                -1.798305e-03 3 1  ON 67
ci_69                -1.807719e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8528
    reference variance = 1.20667
====================================================
  Execution time = 2.4883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5055e-01
  Total weights = 1.9649e+06
  Execution time = 3.5189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966875194
                                         uncertainty =       0.002880796554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966875194
                                         uncertainty =       0.002880796554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468540657
  error estimate for blocks of size 2^( 2) =       0.000494719705
  error estimate for blocks of size 2^( 3) =       0.000519555787
  error estimate for blocks of size 2^( 4) =       0.000538439150
  error estimate for blocks of size 2^( 5) =       0.000550687466
  error estimate for blocks of size 2^( 6) =       0.000557666901
  error estimate for blocks of size 2^( 7) =       0.000561516110

      target function =      -0.744884809907
              le_mean =     -22.814203614193
             les_mean =     520.938440637636
             stat err =       0.000552077407
             autocorr =       1.388370519612
   target nu stat err =       0.000552077407
   target dn stat err =       0.003545086588
      target stat err =       0.002987012691
              std dev =       0.662616552292
             le_variance =       0.439060695372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966856042
                                         uncertainty =       0.002880793435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966856042
                                         uncertainty =       0.002880793435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468540647
  error estimate for blocks of size 2^( 2) =       0.000494719688
  error estimate for blocks of size 2^( 3) =       0.000519555764
  error estimate for blocks of size 2^( 4) =       0.000538439122
  error estimate for blocks of size 2^( 5) =       0.000550687435
  error estimate for blocks of size 2^( 6) =       0.000557666869
  error estimate for blocks of size 2^( 7) =       0.000561516078

      target function =      -0.744885032848
              le_mean =     -22.814203614673
             les_mean =     520.938440389236
             stat err =       0.000552077376
             autocorr =       1.388370426531
   target nu stat err =       0.000552077376
   target dn stat err =       0.003545083281
      target stat err =       0.002987011767
              std dev =       0.662616537825
             le_variance =       0.439060676199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966865618
                                         uncertainty =       0.002880794995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966865618
                                         uncertainty =       0.002880794995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468540652
  error estimate for blocks of size 2^( 2) =       0.000494719696
  error estimate for blocks of size 2^( 3) =       0.000519555776
  error estimate for blocks of size 2^( 4) =       0.000538439136
  error estimate for blocks of size 2^( 5) =       0.000550687450
  error estimate for blocks of size 2^( 6) =       0.000557666885
  error estimate for blocks of size 2^( 7) =       0.000561516094

      target function =      -0.744884927507
              le_mean =     -22.814203614433
             les_mean =     520.938440505999
             stat err =       0.000552077391
             autocorr =       1.388370473059
   target nu stat err =       0.000552077391
   target dn stat err =       0.003545084928
      target stat err =       0.002987012272
              std dev =       0.662616545058
             le_variance =       0.439060685785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966873997
                                         uncertainty =       0.002880796359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438966873997
                                         uncertainty =       0.002880796359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468540657
  error estimate for blocks of size 2^( 2) =       0.000494719704
  error estimate for blocks of size 2^( 3) =       0.000519555786
  error estimate for blocks of size 2^( 4) =       0.000538439148
  error estimate for blocks of size 2^( 5) =       0.000550687464
  error estimate for blocks of size 2^( 6) =       0.000557666899
  error estimate for blocks of size 2^( 7) =       0.000561516108

      target function =      -0.744884825353
              le_mean =     -22.814203614223
             les_mean =     520.938440620277
             stat err =       0.000552077405
             autocorr =       1.388370513783
   target nu stat err =       0.000552077405
   target dn stat err =       0.003545086380
      target stat err =       0.002987012644
              std dev =       0.662616551388
             le_variance =       0.439060694173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744884809907        initial
     2.3842e+03     2.3842e+04             1.4084e-07        -0.744885032848  <--
     9.5367e+03     9.5367e+04             3.5211e-08        -0.744884927507
     3.8147e+04     3.8147e+05             8.8028e-09        -0.744884825353

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 4.2484e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_01                 1.080293e-01 3 1  ON 0
ci_02                -2.400215e-02 3 1  ON 1
ci_03                -2.427849e-02 3 1  ON 2
ci_04                 2.215562e-02 3 1  ON 3
ci_05                -1.913129e-02 3 1  ON 4
ci_06                -1.952750e-02 3 1  ON 5
ci_07                 2.575633e-02 3 1  ON 6
ci_08                -4.225121e-03 3 1  ON 7
ci_09                -7.549601e-03 3 1  ON 8
ci_10                -7.704863e-03 3 1  ON 9
ci_11                 1.374794e-02 3 1  ON 10
ci_12                 7.046934e-03 3 1  ON 11
ci_13                 1.381557e-02 3 1  ON 12
ci_14                 1.281136e-02 3 1  ON 13
ci_15                 5.168776e-03 3 1  ON 14
ci_16                 5.731255e-03 3 1  ON 15
ci_17                -5.018924e-03 3 1  ON 16
ci_18                -5.546530e-03 3 1  ON 17
ci_19                 1.032987e-02 3 1  ON 18
ci_20                 6.254878e-03 3 1  ON 19
ci_21                 8.484018e-03 3 1  ON 20
ci_22                 8.881299e-03 3 1  ON 21
ci_23                 4.169326e-03 3 1  ON 22
ci_24                 5.187432e-03 3 1  ON 23
ci_25                 3.012180e-03 3 1  ON 24
ci_26                 3.794188e-03 3 1  ON 25
ci_27                 3.289707e-03 3 1  ON 26
ci_28                 7.708855e-04 3 1  ON 27
ci_29                 1.186520e-03 3 1  ON 28
ci_30                -7.408693e-04 3 1  ON 29
ci_31                 1.034428e-03 3 1  ON 30
ci_32                -5.365703e-04 3 1  ON 31
ci_33                -1.033144e-03 3 1  ON 32
ci_34                 1.151487e-03 3 1  ON 33
ci_35                 1.248525e-03 3 1  ON 34
ci_36                -5.661511e-04 3 1  ON 35
ci_37                -5.180680e-04 3 1  ON 36
ci_38                -2.863895e-04 3 1  ON 37
ci_39                -1.422188e-04 3 1  ON 38
ci_40                -1.905361e-03 3 1  ON 39
ci_41                -5.137293e-04 3 1  ON 40
ci_42                -1.648112e-03 3 1  ON 41
ci_43                -1.292747e-03 3 1  ON 42
ci_44                -2.176603e-03 3 1  ON 43
ci_45                -2.658345e-04 3 1  ON 44
ci_46                -1.693450e-03 3 1  ON 45
ci_47                 1.435246e-03 3 1  ON 46
ci_48                 2.892949e-03 3 1  ON 47
ci_49                -8.542676e-04 3 1  ON 48
ci_50                -8.202720e-04 3 1  ON 49
ci_51                -5.674300e-04 3 1  ON 50
ci_52                -6.310351e-04 3 1  ON 51
ci_53                -8.013866e-04 3 1  ON 52
ci_54                -1.109451e-03 3 1  ON 53
ci_55                -1.236682e-03 3 1  ON 54
ci_56                 1.098768e-03 3 1  ON 55
ci_57                 2.089593e-03 3 1  ON 56
ci_58                -1.858276e-04 3 1  ON 57
ci_59                -6.197242e-04 3 1  ON 58
ci_60                 1.279522e-04 3 1  ON 59
ci_61                -9.880837e-04 3 1  ON 60
ci_62                -3.816611e-04 3 1  ON 61
ci_63                -2.473713e-04 3 1  ON 62
ci_64                -6.084933e-04 3 1  ON 63
ci_65                -1.061922e-04 3 1  ON 64
ci_66                -1.257360e-04 3 1  ON 65
ci_67                -1.927430e-04 3 1  ON 66
ci_68                -1.798285e-03 3 1  ON 67
ci_69                -1.807712e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7764
    reference variance = 0.364083
====================================================
  Execution time = 2.5751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4656e-01
  Total weights = 1.964794376e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433433845330
                                         uncertainty =       0.002003131813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433433845330
                                         uncertainty =       0.002003131813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465490448
  error estimate for blocks of size 2^( 2) =       0.000491012864
  error estimate for blocks of size 2^( 3) =       0.000515805101
  error estimate for blocks of size 2^( 4) =       0.000534109936
  error estimate for blocks of size 2^( 5) =       0.000546857312
  error estimate for blocks of size 2^( 6) =       0.000552826513
  error estimate for blocks of size 2^( 7) =       0.000556851772

      target function =      -0.748201091348
              le_mean =     -22.815018510729
             les_mean =     520.971632716812
             stat err =       0.000547661383
             autocorr =       1.384212256395
   target nu stat err =       0.000547661383
   target dn stat err =       0.002708616369
      target stat err =       0.002337522940
              std dev =       0.658302905183
             le_variance =       0.433362714973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501851073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748207380058       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748207423367       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748207429813       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748207430637       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748207430923       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748207431025       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748207431096       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748207431118       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748207431102       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748207431098       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 2.940569e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748207380058       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748207390886       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748207392497       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748207392704       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748207392776       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748207392803       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748207392822       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748207392821       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748207392821       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748207392814       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 7.351677e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748207380058       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748207382765       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748207383168       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748207383220       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748207383233       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748207383252       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748207383244       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748207383250       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748207383259       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748207383248       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.837935e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0250e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_01                 1.080293e-01 3 1  ON 0
ci_02                -2.400222e-02 3 1  ON 1
ci_03                -2.427854e-02 3 1  ON 2
ci_04                 2.215569e-02 3 1  ON 3
ci_05                -1.913134e-02 3 1  ON 4
ci_06                -1.952755e-02 3 1  ON 5
ci_07                 2.575634e-02 3 1  ON 6
ci_08                -4.225108e-03 3 1  ON 7
ci_09                -7.549612e-03 3 1  ON 8
ci_10                -7.704859e-03 3 1  ON 9
ci_11                 1.374794e-02 3 1  ON 10
ci_12                 7.046970e-03 3 1  ON 11
ci_13                 1.381557e-02 3 1  ON 12
ci_14                 1.281139e-02 3 1  ON 13
ci_15                 5.168844e-03 3 1  ON 14
ci_16                 5.731286e-03 3 1  ON 15
ci_17                -5.018899e-03 3 1  ON 16
ci_18                -5.546564e-03 3 1  ON 17
ci_19                 1.032985e-02 3 1  ON 18
ci_20                 6.254862e-03 3 1  ON 19
ci_21                 8.484058e-03 3 1  ON 20
ci_22                 8.881332e-03 3 1  ON 21
ci_23                 4.169355e-03 3 1  ON 22
ci_24                 5.187434e-03 3 1  ON 23
ci_25                 3.012168e-03 3 1  ON 24
ci_26                 3.794165e-03 3 1  ON 25
ci_27                 3.289687e-03 3 1  ON 26
ci_28                 7.709172e-04 3 1  ON 27
ci_29                 1.186525e-03 3 1  ON 28
ci_30                -7.408477e-04 3 1  ON 29
ci_31                 1.034398e-03 3 1  ON 30
ci_32                -5.365783e-04 3 1  ON 31
ci_33                -1.033152e-03 3 1  ON 32
ci_34                 1.151492e-03 3 1  ON 33
ci_35                 1.248520e-03 3 1  ON 34
ci_36                -5.661508e-04 3 1  ON 35
ci_37                -5.180683e-04 3 1  ON 36
ci_38                -2.863745e-04 3 1  ON 37
ci_39                -1.422165e-04 3 1  ON 38
ci_40                -1.905351e-03 3 1  ON 39
ci_41                -5.137582e-04 3 1  ON 40
ci_42                -1.648113e-03 3 1  ON 41
ci_43                -1.292781e-03 3 1  ON 42
ci_44                -2.176628e-03 3 1  ON 43
ci_45                -2.658454e-04 3 1  ON 44
ci_46                -1.693439e-03 3 1  ON 45
ci_47                 1.435245e-03 3 1  ON 46
ci_48                 2.892948e-03 3 1  ON 47
ci_49                -8.542709e-04 3 1  ON 48
ci_50                -8.202598e-04 3 1  ON 49
ci_51                -5.674003e-04 3 1  ON 50
ci_52                -6.310271e-04 3 1  ON 51
ci_53                -8.014181e-04 3 1  ON 52
ci_54                -1.109459e-03 3 1  ON 53
ci_55                -1.236657e-03 3 1  ON 54
ci_56                 1.098808e-03 3 1  ON 55
ci_57                 2.089576e-03 3 1  ON 56
ci_58                -1.858599e-04 3 1  ON 57
ci_59                -6.196789e-04 3 1  ON 58
ci_60                 1.279725e-04 3 1  ON 59
ci_61                -9.880631e-04 3 1  ON 60
ci_62                -3.816267e-04 3 1  ON 61
ci_63                -2.473835e-04 3 1  ON 62
ci_64                -6.084614e-04 3 1  ON 63
ci_65                -1.061647e-04 3 1  ON 64
ci_66                -1.257321e-04 3 1  ON 65
ci_67                -1.927515e-04 3 1  ON 66
ci_68                -1.798241e-03 3 1  ON 67
ci_69                -1.807705e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8789
    reference variance = 0.349517
====================================================
  Execution time = 2.6895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4585e-01
  Total weights = 1.9651e+06
  Execution time = 3.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443909241
                                         uncertainty =       0.001460140446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443909241
                                         uncertainty =       0.001460140446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465544459
  error estimate for blocks of size 2^( 2) =       0.000491535216
  error estimate for blocks of size 2^( 3) =       0.000515605285
  error estimate for blocks of size 2^( 4) =       0.000534792367
  error estimate for blocks of size 2^( 5) =       0.000545984245
  error estimate for blocks of size 2^( 6) =       0.000554958610
  error estimate for blocks of size 2^( 7) =       0.000559906213

      target function =      -0.748792844086
              le_mean =     -22.814918333533
             les_mean =     520.966351987640
             stat err =       0.000548910359
             autocorr =       1.390210386515
   target nu stat err =       0.000548910359
   target dn stat err =       0.002548141146
      target stat err =       0.002212148595
              std dev =       0.658379288212
             le_variance =       0.433463287147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443860191
                                         uncertainty =       0.001460140892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443860191
                                         uncertainty =       0.001460140892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465544433
  error estimate for blocks of size 2^( 2) =       0.000491535166
  error estimate for blocks of size 2^( 3) =       0.000515605212
  error estimate for blocks of size 2^( 4) =       0.000534792274
  error estimate for blocks of size 2^( 5) =       0.000545984140
  error estimate for blocks of size 2^( 6) =       0.000554958497
  error estimate for blocks of size 2^( 7) =       0.000559906103

      target function =      -0.748792851309
              le_mean =     -22.814918331722
             les_mean =     520.966351896033
             stat err =       0.000548910254
             autocorr =       1.390210010439
   target nu stat err =       0.000548910254
   target dn stat err =       0.002548197040
      target stat err =       0.002212193413
              std dev =       0.658379251002
             le_variance =       0.433463238150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443884711
                                         uncertainty =       0.001460140669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443884711
                                         uncertainty =       0.001460140669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465544446
  error estimate for blocks of size 2^( 2) =       0.000491535191
  error estimate for blocks of size 2^( 3) =       0.000515605248
  error estimate for blocks of size 2^( 4) =       0.000534792321
  error estimate for blocks of size 2^( 5) =       0.000545984193
  error estimate for blocks of size 2^( 6) =       0.000554958553
  error estimate for blocks of size 2^( 7) =       0.000559906158

      target function =      -0.748792847866
              le_mean =     -22.814918332627
             les_mean =     520.966351941610
             stat err =       0.000548910306
             autocorr =       1.390210198470
   target nu stat err =       0.000548910306
   target dn stat err =       0.002548169088
      target stat err =       0.002212171001
              std dev =       0.658379269603
             le_variance =       0.433463262643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443906174
                                         uncertainty =       0.001460140474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443906174
                                         uncertainty =       0.001460140474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465544458
  error estimate for blocks of size 2^( 2) =       0.000491535213
  error estimate for blocks of size 2^( 3) =       0.000515605280
  error estimate for blocks of size 2^( 4) =       0.000534792362
  error estimate for blocks of size 2^( 5) =       0.000545984238
  error estimate for blocks of size 2^( 6) =       0.000554958603
  error estimate for blocks of size 2^( 7) =       0.000559906206

      target function =      -0.748792844577
              le_mean =     -22.814918333420
             les_mean =     520.966351981862
             stat err =       0.000548910352
             autocorr =       1.390210362999
   target nu stat err =       0.000548910352
   target dn stat err =       0.002548144638
      target stat err =       0.002212151396
              std dev =       0.658379285886
             le_variance =       0.433463284084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748792844086        initial
     5.9605e+02     5.9605e+03             2.9406e-07        -0.748792851309  <--
     2.3842e+03     2.3842e+04             7.3517e-08        -0.748792847866
     9.5367e+03     9.5367e+04             1.8379e-08        -0.748792844577

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 4.4566e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_01                 1.080295e-01 3 1  ON 0
ci_02                -2.400242e-02 3 1  ON 1
ci_03                -2.427867e-02 3 1  ON 2
ci_04                 2.215589e-02 3 1  ON 3
ci_05                -1.913147e-02 3 1  ON 4
ci_06                -1.952768e-02 3 1  ON 5
ci_07                 2.575635e-02 3 1  ON 6
ci_08                -4.225069e-03 3 1  ON 7
ci_09                -7.549644e-03 3 1  ON 8
ci_10                -7.704847e-03 3 1  ON 9
ci_11                 1.374793e-02 3 1  ON 10
ci_12                 7.047078e-03 3 1  ON 11
ci_13                 1.381555e-02 3 1  ON 12
ci_14                 1.281146e-02 3 1  ON 13
ci_15                 5.169049e-03 3 1  ON 14
ci_16                 5.731380e-03 3 1  ON 15
ci_17                -5.018822e-03 3 1  ON 16
ci_18                -5.546665e-03 3 1  ON 17
ci_19                 1.032978e-02 3 1  ON 18
ci_20                 6.254813e-03 3 1  ON 19
ci_21                 8.484178e-03 3 1  ON 20
ci_22                 8.881431e-03 3 1  ON 21
ci_23                 4.169440e-03 3 1  ON 22
ci_24                 5.187441e-03 3 1  ON 23
ci_25                 3.012131e-03 3 1  ON 24
ci_26                 3.794096e-03 3 1  ON 25
ci_27                 3.289625e-03 3 1  ON 26
ci_28                 7.710125e-04 3 1  ON 27
ci_29                 1.186540e-03 3 1  ON 28
ci_30                -7.407830e-04 3 1  ON 29
ci_31                 1.034305e-03 3 1  ON 30
ci_32                -5.366021e-04 3 1  ON 31
ci_33                -1.033176e-03 3 1  ON 32
ci_34                 1.151509e-03 3 1  ON 33
ci_35                 1.248504e-03 3 1  ON 34
ci_36                -5.661498e-04 3 1  ON 35
ci_37                -5.180695e-04 3 1  ON 36
ci_38                -2.863295e-04 3 1  ON 37
ci_39                -1.422096e-04 3 1  ON 38
ci_40                -1.905320e-03 3 1  ON 39
ci_41                -5.138450e-04 3 1  ON 40
ci_42                -1.648115e-03 3 1  ON 41
ci_43                -1.292880e-03 3 1  ON 42
ci_44                -2.176704e-03 3 1  ON 43
ci_45                -2.658782e-04 3 1  ON 44
ci_46                -1.693408e-03 3 1  ON 45
ci_47                 1.435241e-03 3 1  ON 46
ci_48                 2.892945e-03 3 1  ON 47
ci_49                -8.542808e-04 3 1  ON 48
ci_50                -8.202235e-04 3 1  ON 49
ci_51                -5.673112e-04 3 1  ON 50
ci_52                -6.310031e-04 3 1  ON 51
ci_53                -8.015126e-04 3 1  ON 52
ci_54                -1.109485e-03 3 1  ON 53
ci_55                -1.236581e-03 3 1  ON 54
ci_56                 1.098929e-03 3 1  ON 55
ci_57                 2.089527e-03 3 1  ON 56
ci_58                -1.859567e-04 3 1  ON 57
ci_59                -6.195430e-04 3 1  ON 58
ci_60                 1.280332e-04 3 1  ON 59
ci_61                -9.880011e-04 3 1  ON 60
ci_62                -3.815233e-04 3 1  ON 61
ci_63                -2.474201e-04 3 1  ON 62
ci_64                -6.083657e-04 3 1  ON 63
ci_65                -1.060820e-04 3 1  ON 64
ci_66                -1.257205e-04 3 1  ON 65
ci_67                -1.927771e-04 3 1  ON 66
ci_68                -1.798107e-03 3 1  ON 67
ci_69                -1.807685e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8982
    reference variance = 0.487117
====================================================
  Execution time = 2.5441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4940e-01
  Total weights = 1.964742134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435669094931
                                         uncertainty =       0.002008908195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435669094931
                                         uncertainty =       0.002008908195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466789063
  error estimate for blocks of size 2^( 2) =       0.000492831027
  error estimate for blocks of size 2^( 3) =       0.000517583166
  error estimate for blocks of size 2^( 4) =       0.000536053989
  error estimate for blocks of size 2^( 5) =       0.000546870784
  error estimate for blocks of size 2^( 6) =       0.000553916537
  error estimate for blocks of size 2^( 7) =       0.000557365357

      target function =      -0.745837943607
              le_mean =     -22.813455322612
             les_mean =     520.903141931810
             stat err =       0.000548551667
             autocorr =       1.381000180300
   target nu stat err =       0.000548551667
   target dn stat err =       0.003178203700
      target stat err =       0.002694369995
              std dev =       0.660139423243
             le_variance =       0.435784058120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281345532261e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745846746116       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745846887640       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745846908758       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745846914465       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745846915795       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745846916091       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745846916297       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745846916294       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745846916269       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 2.049674e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745846746116       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745846781506       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745846786786       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745846788213       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745846788546       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745846788620       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745846788671       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745846788669       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745846788664       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 5.124849e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745846746116       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745846754964       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745846756284       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745846756641       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745846756731       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745846756743       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745846756754       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745846756755       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745846756754       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.281254e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9969e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_01                 1.080301e-01 3 1  ON 0
ci_02                -2.400269e-02 3 1  ON 1
ci_03                -2.427895e-02 3 1  ON 2
ci_04                 2.215624e-02 3 1  ON 3
ci_05                -1.913147e-02 3 1  ON 4
ci_06                -1.952775e-02 3 1  ON 5
ci_07                 2.575642e-02 3 1  ON 6
ci_08                -4.225125e-03 3 1  ON 7
ci_09                -7.549706e-03 3 1  ON 8
ci_10                -7.704992e-03 3 1  ON 9
ci_11                 1.374789e-02 3 1  ON 10
ci_12                 7.047015e-03 3 1  ON 11
ci_13                 1.381546e-02 3 1  ON 12
ci_14                 1.281160e-02 3 1  ON 13
ci_15                 5.169161e-03 3 1  ON 14
ci_16                 5.731353e-03 3 1  ON 15
ci_17                -5.018870e-03 3 1  ON 16
ci_18                -5.546719e-03 3 1  ON 17
ci_19                 1.032973e-02 3 1  ON 18
ci_20                 6.254752e-03 3 1  ON 19
ci_21                 8.484175e-03 3 1  ON 20
ci_22                 8.881500e-03 3 1  ON 21
ci_23                 4.169529e-03 3 1  ON 22
ci_24                 5.187377e-03 3 1  ON 23
ci_25                 3.012104e-03 3 1  ON 24
ci_26                 3.793980e-03 3 1  ON 25
ci_27                 3.289580e-03 3 1  ON 26
ci_28                 7.710170e-04 3 1  ON 27
ci_29                 1.186496e-03 3 1  ON 28
ci_30                -7.408366e-04 3 1  ON 29
ci_31                 1.034093e-03 3 1  ON 30
ci_32                -5.366323e-04 3 1  ON 31
ci_33                -1.033221e-03 3 1  ON 32
ci_34                 1.151542e-03 3 1  ON 33
ci_35                 1.248502e-03 3 1  ON 34
ci_36                -5.662250e-04 3 1  ON 35
ci_37                -5.180995e-04 3 1  ON 36
ci_38                -2.863719e-04 3 1  ON 37
ci_39                -1.422169e-04 3 1  ON 38
ci_40                -1.905210e-03 3 1  ON 39
ci_41                -5.139138e-04 3 1  ON 40
ci_42                -1.648047e-03 3 1  ON 41
ci_43                -1.292953e-03 3 1  ON 42
ci_44                -2.176737e-03 3 1  ON 43
ci_45                -2.658666e-04 3 1  ON 44
ci_46                -1.693377e-03 3 1  ON 45
ci_47                 1.435261e-03 3 1  ON 46
ci_48                 2.892766e-03 3 1  ON 47
ci_49                -8.542424e-04 3 1  ON 48
ci_50                -8.202256e-04 3 1  ON 49
ci_51                -5.672441e-04 3 1  ON 50
ci_52                -6.309106e-04 3 1  ON 51
ci_53                -8.015383e-04 3 1  ON 52
ci_54                -1.109497e-03 3 1  ON 53
ci_55                -1.236536e-03 3 1  ON 54
ci_56                 1.098970e-03 3 1  ON 55
ci_57                 2.089513e-03 3 1  ON 56
ci_58                -1.859595e-04 3 1  ON 57
ci_59                -6.195173e-04 3 1  ON 58
ci_60                 1.280894e-04 3 1  ON 59
ci_61                -9.881017e-04 3 1  ON 60
ci_62                -3.815535e-04 3 1  ON 61
ci_63                -2.473580e-04 3 1  ON 62
ci_64                -6.083654e-04 3 1  ON 63
ci_65                -1.061510e-04 3 1  ON 64
ci_66                -1.257333e-04 3 1  ON 65
ci_67                -1.927780e-04 3 1  ON 66
ci_68                -1.798129e-03 3 1  ON 67
ci_69                -1.807693e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7001
    reference variance = 0.582262
====================================================
  Execution time = 2.4831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5159e-01
  Total weights = 1.9649e+06
  Execution time = 3.5180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866440706
                                         uncertainty =       0.002270732549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866440706
                                         uncertainty =       0.002270732549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467345419
  error estimate for blocks of size 2^( 2) =       0.000493474079
  error estimate for blocks of size 2^( 3) =       0.000517731511
  error estimate for blocks of size 2^( 4) =       0.000535399585
  error estimate for blocks of size 2^( 5) =       0.000547070496
  error estimate for blocks of size 2^( 6) =       0.000553848627
  error estimate for blocks of size 2^( 7) =       0.000556002964

      target function =      -0.744034129835
              le_mean =     -22.814104976598
             les_mean =     520.934973641708
             stat err =       0.000548080418
             autocorr =       1.375347974272
   target nu stat err =       0.000548080418
   target dn stat err =       0.003361310829
      target stat err =       0.002831122811
              std dev =       0.660926229196
             le_variance =       0.436823480439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866336777
                                         uncertainty =       0.002270729338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866336777
                                         uncertainty =       0.002270729338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467345363
  error estimate for blocks of size 2^( 2) =       0.000493473922
  error estimate for blocks of size 2^( 3) =       0.000517731237
  error estimate for blocks of size 2^( 4) =       0.000535399216
  error estimate for blocks of size 2^( 5) =       0.000547070054
  error estimate for blocks of size 2^( 6) =       0.000553848164
  error estimate for blocks of size 2^( 7) =       0.000556002470

      target function =      -0.744035234993
              le_mean =     -22.814104982211
             les_mean =     520.934972555472
             stat err =       0.000548079976
             autocorr =       1.375346081579
   target nu stat err =       0.000548079976
   target dn stat err =       0.003361184132
      target stat err =       0.002831029122
              std dev =       0.660926150765
             le_variance =       0.436823376765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866388696
                                         uncertainty =       0.002270730943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866388696
                                         uncertainty =       0.002270730943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467345391
  error estimate for blocks of size 2^( 2) =       0.000493474001
  error estimate for blocks of size 2^( 3) =       0.000517731374
  error estimate for blocks of size 2^( 4) =       0.000535399401
  error estimate for blocks of size 2^( 5) =       0.000547070275
  error estimate for blocks of size 2^( 6) =       0.000553848395
  error estimate for blocks of size 2^( 7) =       0.000556002717

      target function =      -0.744034683849
              le_mean =     -22.814104979400
             les_mean =     520.934973096645
             stat err =       0.000548080197
             autocorr =       1.375347027743
   target nu stat err =       0.000548080197
   target dn stat err =       0.003361247251
      target stat err =       0.002831075793
              std dev =       0.660926189946
             le_variance =       0.436823428556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866434201
                                         uncertainty =       0.002270732348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436866434201
                                         uncertainty =       0.002270732348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467345415
  error estimate for blocks of size 2^( 2) =       0.000493474069
  error estimate for blocks of size 2^( 3) =       0.000517731493
  error estimate for blocks of size 2^( 4) =       0.000535399562
  error estimate for blocks of size 2^( 5) =       0.000547070468
  error estimate for blocks of size 2^( 6) =       0.000553848598
  error estimate for blocks of size 2^( 7) =       0.000556002933

      target function =      -0.744034199232
              le_mean =     -22.814104976948
             les_mean =     520.934973573374
             stat err =       0.000548080390
             autocorr =       1.375347855952
   target nu stat err =       0.000548080390
   target dn stat err =       0.003361302858
      target stat err =       0.002831116916
              std dev =       0.660926224287
             le_variance =       0.436823473950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744034129835        initial
     1.4901e+02     1.4901e+03             2.0497e-06        -0.744035234993  <--
     5.9605e+02     5.9605e+03             5.1248e-07        -0.744034683849
     2.3842e+03     2.3842e+04             1.2813e-07        -0.744034199232

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 4.2427e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_01                 1.080316e-01 3 1  ON 0
ci_02                -2.400347e-02 3 1  ON 1
ci_03                -2.427980e-02 3 1  ON 2
ci_04                 2.215729e-02 3 1  ON 3
ci_05                -1.913148e-02 3 1  ON 4
ci_06                -1.952795e-02 3 1  ON 5
ci_07                 2.575662e-02 3 1  ON 6
ci_08                -4.225294e-03 3 1  ON 7
ci_09                -7.549889e-03 3 1  ON 8
ci_10                -7.705427e-03 3 1  ON 9
ci_11                 1.374774e-02 3 1  ON 10
ci_12                 7.046827e-03 3 1  ON 11
ci_13                 1.381518e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.169497e-03 3 1  ON 14
ci_16                 5.731272e-03 3 1  ON 15
ci_17                -5.019013e-03 3 1  ON 16
ci_18                -5.546881e-03 3 1  ON 17
ci_19                 1.032957e-02 3 1  ON 18
ci_20                 6.254571e-03 3 1  ON 19
ci_21                 8.484166e-03 3 1  ON 20
ci_22                 8.881705e-03 3 1  ON 21
ci_23                 4.169798e-03 3 1  ON 22
ci_24                 5.187185e-03 3 1  ON 23
ci_25                 3.012024e-03 3 1  ON 24
ci_26                 3.793630e-03 3 1  ON 25
ci_27                 3.289445e-03 3 1  ON 26
ci_28                 7.710303e-04 3 1  ON 27
ci_29                 1.186362e-03 3 1  ON 28
ci_30                -7.409976e-04 3 1  ON 29
ci_31                 1.033455e-03 3 1  ON 30
ci_32                -5.367228e-04 3 1  ON 31
ci_33                -1.033359e-03 3 1  ON 32
ci_34                 1.151641e-03 3 1  ON 33
ci_35                 1.248495e-03 3 1  ON 34
ci_36                -5.664507e-04 3 1  ON 35
ci_37                -5.181896e-04 3 1  ON 36
ci_38                -2.864991e-04 3 1  ON 37
ci_39                -1.422386e-04 3 1  ON 38
ci_40                -1.904882e-03 3 1  ON 39
ci_41                -5.141202e-04 3 1  ON 40
ci_42                -1.647843e-03 3 1  ON 41
ci_43                -1.293171e-03 3 1  ON 42
ci_44                -2.176837e-03 3 1  ON 43
ci_45                -2.658318e-04 3 1  ON 44
ci_46                -1.693286e-03 3 1  ON 45
ci_47                 1.435323e-03 3 1  ON 46
ci_48                 2.892228e-03 3 1  ON 47
ci_49                -8.541273e-04 3 1  ON 48
ci_50                -8.202317e-04 3 1  ON 49
ci_51                -5.670429e-04 3 1  ON 50
ci_52                -6.306334e-04 3 1  ON 51
ci_53                -8.016157e-04 3 1  ON 52
ci_54                -1.109532e-03 3 1  ON 53
ci_55                -1.236402e-03 3 1  ON 54
ci_56                 1.099092e-03 3 1  ON 55
ci_57                 2.089472e-03 3 1  ON 56
ci_58                -1.859680e-04 3 1  ON 57
ci_59                -6.194403e-04 3 1  ON 58
ci_60                 1.282580e-04 3 1  ON 59
ci_61                -9.884037e-04 3 1  ON 60
ci_62                -3.816439e-04 3 1  ON 61
ci_63                -2.471716e-04 3 1  ON 62
ci_64                -6.083646e-04 3 1  ON 63
ci_65                -1.063578e-04 3 1  ON 64
ci_66                -1.257717e-04 3 1  ON 65
ci_67                -1.927809e-04 3 1  ON 66
ci_68                -1.798194e-03 3 1  ON 67
ci_69                -1.807717e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8708
    reference variance = 0.309627
====================================================
  Execution time = 2.5527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5396e-01
  Total weights = 1.964864475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364004726
                                         uncertainty =       0.004850110450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364004726
                                         uncertainty =       0.004850110450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468694093
  error estimate for blocks of size 2^( 2) =       0.000494150152
  error estimate for blocks of size 2^( 3) =       0.000518912101
  error estimate for blocks of size 2^( 4) =       0.000536058201
  error estimate for blocks of size 2^( 5) =       0.000547914693
  error estimate for blocks of size 2^( 6) =       0.000556376448
  error estimate for blocks of size 2^( 7) =       0.000561138893

      target function =      -0.742071313228
              le_mean =     -22.815572957246
             les_mean =     521.004326760061
             stat err =       0.000550372059
             autocorr =       1.378903251750
   target nu stat err =       0.000550372059
   target dn stat err =       0.005176567595
      target stat err =       0.004289242028
              std dev =       0.662833542318
             le_variance =       0.439348304821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281557295725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742095439360       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742096282113       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742096424684       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742096446779       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742096456748       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742096460012       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742096459083       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742096458941       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742096458746       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742096458490       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742096458534       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 9.721634e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742095439360       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742095650258       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742095685921       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742095691446       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742095693936       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742095694751       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742095694519       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742095694484       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742095694435       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742095694371       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742095694382       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 2.431715e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742095439360       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742095492098       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742095501015       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742095502396       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742095503017       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742095503221       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742095503164       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742095503155       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742095503142       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742095503127       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742095503129       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 6.080105e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0064e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_01                 1.080340e-01 3 1  ON 0
ci_02                -2.400525e-02 3 1  ON 1
ci_03                -2.428149e-02 3 1  ON 2
ci_04                 2.215855e-02 3 1  ON 3
ci_05                -1.913239e-02 3 1  ON 4
ci_06                -1.952816e-02 3 1  ON 5
ci_07                 2.575688e-02 3 1  ON 6
ci_08                -4.225408e-03 3 1  ON 7
ci_09                -7.550265e-03 3 1  ON 8
ci_10                -7.705936e-03 3 1  ON 9
ci_11                 1.374788e-02 3 1  ON 10
ci_12                 7.046724e-03 3 1  ON 11
ci_13                 1.381510e-02 3 1  ON 12
ci_14                 1.281182e-02 3 1  ON 13
ci_15                 5.170234e-03 3 1  ON 14
ci_16                 5.731634e-03 3 1  ON 15
ci_17                -5.019070e-03 3 1  ON 16
ci_18                -5.546289e-03 3 1  ON 17
ci_19                 1.032925e-02 3 1  ON 18
ci_20                 6.254787e-03 3 1  ON 19
ci_21                 8.484136e-03 3 1  ON 20
ci_22                 8.881524e-03 3 1  ON 21
ci_23                 4.170208e-03 3 1  ON 22
ci_24                 5.186553e-03 3 1  ON 23
ci_25                 3.011830e-03 3 1  ON 24
ci_26                 3.793304e-03 3 1  ON 25
ci_27                 3.289182e-03 3 1  ON 26
ci_28                 7.716238e-04 3 1  ON 27
ci_29                 1.186664e-03 3 1  ON 28
ci_30                -7.406322e-04 3 1  ON 29
ci_31                 1.033208e-03 3 1  ON 30
ci_32                -5.371332e-04 3 1  ON 31
ci_33                -1.033529e-03 3 1  ON 32
ci_34                 1.152174e-03 3 1  ON 33
ci_35                 1.248893e-03 3 1  ON 34
ci_36                -5.663968e-04 3 1  ON 35
ci_37                -5.185967e-04 3 1  ON 36
ci_38                -2.864272e-04 3 1  ON 37
ci_39                -1.422213e-04 3 1  ON 38
ci_40                -1.904636e-03 3 1  ON 39
ci_41                -5.142278e-04 3 1  ON 40
ci_42                -1.647863e-03 3 1  ON 41
ci_43                -1.294034e-03 3 1  ON 42
ci_44                -2.176395e-03 3 1  ON 43
ci_45                -2.658317e-04 3 1  ON 44
ci_46                -1.692862e-03 3 1  ON 45
ci_47                 1.435637e-03 3 1  ON 46
ci_48                 2.892014e-03 3 1  ON 47
ci_49                -8.541995e-04 3 1  ON 48
ci_50                -8.202611e-04 3 1  ON 49
ci_51                -5.669823e-04 3 1  ON 50
ci_52                -6.305637e-04 3 1  ON 51
ci_53                -8.012972e-04 3 1  ON 52
ci_54                -1.109315e-03 3 1  ON 53
ci_55                -1.236076e-03 3 1  ON 54
ci_56                 1.099513e-03 3 1  ON 55
ci_57                 2.089285e-03 3 1  ON 56
ci_58                -1.859443e-04 3 1  ON 57
ci_59                -6.200000e-04 3 1  ON 58
ci_60                 1.277290e-04 3 1  ON 59
ci_61                -9.883475e-04 3 1  ON 60
ci_62                -3.817065e-04 3 1  ON 61
ci_63                -2.471725e-04 3 1  ON 62
ci_64                -6.085363e-04 3 1  ON 63
ci_65                -1.068090e-04 3 1  ON 64
ci_66                -1.262625e-04 3 1  ON 65
ci_67                -1.930760e-04 3 1  ON 66
ci_68                -1.797844e-03 3 1  ON 67
ci_69                -1.807591e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7455
    reference variance = 0.332377
====================================================
  Execution time = 2.4849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4818e-01
  Total weights = 1.9650e+06
  Execution time = 3.8491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075926881
                                         uncertainty =       0.002180732203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075926881
                                         uncertainty =       0.002180732203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466471522
  error estimate for blocks of size 2^( 2) =       0.000492126401
  error estimate for blocks of size 2^( 3) =       0.000516710712
  error estimate for blocks of size 2^( 4) =       0.000535684182
  error estimate for blocks of size 2^( 5) =       0.000547279772
  error estimate for blocks of size 2^( 6) =       0.000554501750
  error estimate for blocks of size 2^( 7) =       0.000559969747

      target function =      -0.746849552959
              le_mean =     -22.814518156446
             les_mean =     520.950422664748
             stat err =       0.000549358862
             autocorr =       1.386953817822
   target nu stat err =       0.000549358862
   target dn stat err =       0.002975323336
      target stat err =       0.002542295789
              std dev =       0.659690352355
             le_variance =       0.435191360991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075484782
                                         uncertainty =       0.002180802876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075484782
                                         uncertainty =       0.002180802876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466471276
  error estimate for blocks of size 2^( 2) =       0.000492125545
  error estimate for blocks of size 2^( 3) =       0.000516709205
  error estimate for blocks of size 2^( 4) =       0.000535682235
  error estimate for blocks of size 2^( 5) =       0.000547277616
  error estimate for blocks of size 2^( 6) =       0.000554499667
  error estimate for blocks of size 2^( 7) =       0.000559967802

      target function =      -0.746845691279
              le_mean =     -22.814518140888
             les_mean =     520.950426611584
             stat err =       0.000549356830
             autocorr =       1.386945015039
   target nu stat err =       0.000549356830
   target dn stat err =       0.002975132791
      target stat err =       0.002542116219
              std dev =       0.659690005149
             le_variance =       0.435190902893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075704896
                                         uncertainty =       0.002180767555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075704896
                                         uncertainty =       0.002180767555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466471398
  error estimate for blocks of size 2^( 2) =       0.000492125972
  error estimate for blocks of size 2^( 3) =       0.000516709958
  error estimate for blocks of size 2^( 4) =       0.000535683207
  error estimate for blocks of size 2^( 5) =       0.000547278693
  error estimate for blocks of size 2^( 6) =       0.000554500707
  error estimate for blocks of size 2^( 7) =       0.000559968774

      target function =      -0.746850543461
              le_mean =     -22.814518148446
             les_mean =     520.950421106190
             stat err =       0.000549357845
             autocorr =       1.386949413341
   target nu stat err =       0.000549357845
   target dn stat err =       0.002975224008
      target stat err =       0.002542222052
              std dev =       0.659690178037
             le_variance =       0.435191130999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075899049
                                         uncertainty =       0.002180736622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435075899049
                                         uncertainty =       0.002180736622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466471506
  error estimate for blocks of size 2^( 2) =       0.000492126348
  error estimate for blocks of size 2^( 3) =       0.000516710617
  error estimate for blocks of size 2^( 4) =       0.000535684060
  error estimate for blocks of size 2^( 5) =       0.000547279637
  error estimate for blocks of size 2^( 6) =       0.000554501619
  error estimate for blocks of size 2^( 7) =       0.000559969625

      target function =      -0.746849724300
              le_mean =     -22.814518155431
             les_mean =     520.950422411927
             stat err =       0.000549358735
             autocorr =       1.386953267193
   target nu stat err =       0.000549358735
   target dn stat err =       0.002975310861
      target stat err =       0.002542286839
              std dev =       0.659690330501
             le_variance =       0.435191332157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746849552959        initial
     3.7253e+01     3.7253e+02             9.7216e-06        -0.746845691279
     1.4901e+02     1.4901e+03             2.4317e-06        -0.746850543461  <--
     5.9605e+02     5.9605e+03             6.0801e-07        -0.746849724300

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 4.3152e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_01                 1.080340e-01 3 1  ON 0
ci_02                -2.400525e-02 3 1  ON 1
ci_03                -2.428149e-02 3 1  ON 2
ci_04                 2.215855e-02 3 1  ON 3
ci_05                -1.913239e-02 3 1  ON 4
ci_06                -1.952816e-02 3 1  ON 5
ci_07                 2.575688e-02 3 1  ON 6
ci_08                -4.225408e-03 3 1  ON 7
ci_09                -7.550265e-03 3 1  ON 8
ci_10                -7.705936e-03 3 1  ON 9
ci_11                 1.374788e-02 3 1  ON 10
ci_12                 7.046724e-03 3 1  ON 11
ci_13                 1.381510e-02 3 1  ON 12
ci_14                 1.281182e-02 3 1  ON 13
ci_15                 5.170234e-03 3 1  ON 14
ci_16                 5.731634e-03 3 1  ON 15
ci_17                -5.019070e-03 3 1  ON 16
ci_18                -5.546289e-03 3 1  ON 17
ci_19                 1.032925e-02 3 1  ON 18
ci_20                 6.254787e-03 3 1  ON 19
ci_21                 8.484136e-03 3 1  ON 20
ci_22                 8.881524e-03 3 1  ON 21
ci_23                 4.170208e-03 3 1  ON 22
ci_24                 5.186553e-03 3 1  ON 23
ci_25                 3.011830e-03 3 1  ON 24
ci_26                 3.793304e-03 3 1  ON 25
ci_27                 3.289182e-03 3 1  ON 26
ci_28                 7.716238e-04 3 1  ON 27
ci_29                 1.186664e-03 3 1  ON 28
ci_30                -7.406322e-04 3 1  ON 29
ci_31                 1.033208e-03 3 1  ON 30
ci_32                -5.371332e-04 3 1  ON 31
ci_33                -1.033529e-03 3 1  ON 32
ci_34                 1.152174e-03 3 1  ON 33
ci_35                 1.248893e-03 3 1  ON 34
ci_36                -5.663968e-04 3 1  ON 35
ci_37                -5.185967e-04 3 1  ON 36
ci_38                -2.864272e-04 3 1  ON 37
ci_39                -1.422213e-04 3 1  ON 38
ci_40                -1.904636e-03 3 1  ON 39
ci_41                -5.142278e-04 3 1  ON 40
ci_42                -1.647863e-03 3 1  ON 41
ci_43                -1.294034e-03 3 1  ON 42
ci_44                -2.176395e-03 3 1  ON 43
ci_45                -2.658317e-04 3 1  ON 44
ci_46                -1.692862e-03 3 1  ON 45
ci_47                 1.435637e-03 3 1  ON 46
ci_48                 2.892014e-03 3 1  ON 47
ci_49                -8.541995e-04 3 1  ON 48
ci_50                -8.202611e-04 3 1  ON 49
ci_51                -5.669823e-04 3 1  ON 50
ci_52                -6.305637e-04 3 1  ON 51
ci_53                -8.012972e-04 3 1  ON 52
ci_54                -1.109315e-03 3 1  ON 53
ci_55                -1.236076e-03 3 1  ON 54
ci_56                 1.099513e-03 3 1  ON 55
ci_57                 2.089285e-03 3 1  ON 56
ci_58                -1.859443e-04 3 1  ON 57
ci_59                -6.200000e-04 3 1  ON 58
ci_60                 1.277290e-04 3 1  ON 59
ci_61                -9.883475e-04 3 1  ON 60
ci_62                -3.817065e-04 3 1  ON 61
ci_63                -2.471725e-04 3 1  ON 62
ci_64                -6.085363e-04 3 1  ON 63
ci_65                -1.068090e-04 3 1  ON 64
ci_66                -1.262625e-04 3 1  ON 65
ci_67                -1.930760e-04 3 1  ON 66
ci_68                -1.797844e-03 3 1  ON 67
ci_69                -1.807591e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8037
    reference variance = 0.223858
====================================================
  Execution time = 2.5497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.964772100e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436272252490
                                         uncertainty =       0.001794804486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436272252490
                                         uncertainty =       0.001794804486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467068591
  error estimate for blocks of size 2^( 2) =       0.000492645077
  error estimate for blocks of size 2^( 3) =       0.000515741627
  error estimate for blocks of size 2^( 4) =       0.000534001652
  error estimate for blocks of size 2^( 5) =       0.000545342345
  error estimate for blocks of size 2^( 6) =       0.000550644289
  error estimate for blocks of size 2^( 7) =       0.000555569682

      target function =      -0.746351148395
              le_mean =     -22.814294604997
             les_mean =     520.940823639415
             stat err =       0.000546389492
             autocorr =       1.368495427747
   target nu stat err =       0.000546389492
   target dn stat err =       0.002767857398
      target stat err =       0.002370892584
              std dev =       0.660534735849
             le_variance =       0.436306137262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429460500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746357686721       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746358223254       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746358297839       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746358311648       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746358321626       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746358325092       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746358325153       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746358325170       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746358325249       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746358325180       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 7.843296e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746357686721       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746357820989       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746357839645       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746357843097       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746357845591       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746357846457       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746357846472       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746357846476       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746357846496       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746357846479       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.961876e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746357686721       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746357720296       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746357724961       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746357725824       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746357726447       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746357726664       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746357726667       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746357726669       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746357726674       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746357726669       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 4.905349e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9993e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_01                 1.080360e-01 3 1  ON 0
ci_02                -2.400610e-02 3 1  ON 1
ci_03                -2.428288e-02 3 1  ON 2
ci_04                 2.215955e-02 3 1  ON 3
ci_05                -1.913286e-02 3 1  ON 4
ci_06                -1.952842e-02 3 1  ON 5
ci_07                 2.575713e-02 3 1  ON 6
ci_08                -4.225546e-03 3 1  ON 7
ci_09                -7.550169e-03 3 1  ON 8
ci_10                -7.705725e-03 3 1  ON 9
ci_11                 1.374765e-02 3 1  ON 10
ci_12                 7.046644e-03 3 1  ON 11
ci_13                 1.381516e-02 3 1  ON 12
ci_14                 1.281261e-02 3 1  ON 13
ci_15                 5.170697e-03 3 1  ON 14
ci_16                 5.731621e-03 3 1  ON 15
ci_17                -5.019604e-03 3 1  ON 16
ci_18                -5.546333e-03 3 1  ON 17
ci_19                 1.032875e-02 3 1  ON 18
ci_20                 6.254225e-03 3 1  ON 19
ci_21                 8.484122e-03 3 1  ON 20
ci_22                 8.881732e-03 3 1  ON 21
ci_23                 4.170422e-03 3 1  ON 22
ci_24                 5.186516e-03 3 1  ON 23
ci_25                 3.011733e-03 3 1  ON 24
ci_26                 3.793133e-03 3 1  ON 25
ci_27                 3.289220e-03 3 1  ON 26
ci_28                 7.716022e-04 3 1  ON 27
ci_29                 1.186896e-03 3 1  ON 28
ci_30                -7.405529e-04 3 1  ON 29
ci_31                 1.032737e-03 3 1  ON 30
ci_32                -5.376973e-04 3 1  ON 31
ci_33                -1.033750e-03 3 1  ON 32
ci_34                 1.152527e-03 3 1  ON 33
ci_35                 1.249217e-03 3 1  ON 34
ci_36                -5.665934e-04 3 1  ON 35
ci_37                -5.188530e-04 3 1  ON 36
ci_38                -2.866038e-04 3 1  ON 37
ci_39                -1.420318e-04 3 1  ON 38
ci_40                -1.904365e-03 3 1  ON 39
ci_41                -5.145749e-04 3 1  ON 40
ci_42                -1.647656e-03 3 1  ON 41
ci_43                -1.294627e-03 3 1  ON 42
ci_44                -2.176630e-03 3 1  ON 43
ci_45                -2.659257e-04 3 1  ON 44
ci_46                -1.692784e-03 3 1  ON 45
ci_47                 1.436178e-03 3 1  ON 46
ci_48                 2.891894e-03 3 1  ON 47
ci_49                -8.541794e-04 3 1  ON 48
ci_50                -8.202957e-04 3 1  ON 49
ci_51                -5.668141e-04 3 1  ON 50
ci_52                -6.305620e-04 3 1  ON 51
ci_53                -8.011879e-04 3 1  ON 52
ci_54                -1.109464e-03 3 1  ON 53
ci_55                -1.235956e-03 3 1  ON 54
ci_56                 1.099788e-03 3 1  ON 55
ci_57                 2.089132e-03 3 1  ON 56
ci_58                -1.859174e-04 3 1  ON 57
ci_59                -6.195853e-04 3 1  ON 58
ci_60                 1.273083e-04 3 1  ON 59
ci_61                -9.882441e-04 3 1  ON 60
ci_62                -3.815419e-04 3 1  ON 61
ci_63                -2.471951e-04 3 1  ON 62
ci_64                -6.081388e-04 3 1  ON 63
ci_65                -1.069359e-04 3 1  ON 64
ci_66                -1.261607e-04 3 1  ON 65
ci_67                -1.930453e-04 3 1  ON 66
ci_68                -1.797581e-03 3 1  ON 67
ci_69                -1.807125e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7741
    reference variance = 0.396955
====================================================
  Execution time = 2.4822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4595e-01
  Total weights = 1.9650e+06
  Execution time = 3.5186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699734891
                                         uncertainty =       0.002067959880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699734891
                                         uncertainty =       0.002067959880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466203886
  error estimate for blocks of size 2^( 2) =       0.000492126963
  error estimate for blocks of size 2^( 3) =       0.000516478507
  error estimate for blocks of size 2^( 4) =       0.000535232086
  error estimate for blocks of size 2^( 5) =       0.000547321504
  error estimate for blocks of size 2^( 6) =       0.000552385385
  error estimate for blocks of size 2^( 7) =       0.000556662690

      target function =      -0.748707820162
              le_mean =     -22.813866077116
             les_mean =     520.918432487666
             stat err =       0.000547900416
             autocorr =       1.381183817865
   target nu stat err =       0.000547900416
   target dn stat err =       0.002214691620
      target stat err =       0.001942495532
              std dev =       0.659311858882
             le_variance =       0.434692127262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699158905
                                         uncertainty =       0.002067933971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699158905
                                         uncertainty =       0.002067933971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466203575
  error estimate for blocks of size 2^( 2) =       0.000492126244
  error estimate for blocks of size 2^( 3) =       0.000516477335
  error estimate for blocks of size 2^( 4) =       0.000535230608
  error estimate for blocks of size 2^( 5) =       0.000547319731
  error estimate for blocks of size 2^( 6) =       0.000552383384
  error estimate for blocks of size 2^( 7) =       0.000556660517

      target function =      -0.748690088315
              le_mean =     -22.813866079794
             les_mean =     520.918453888312
             stat err =       0.000547898560
             autocorr =       1.381176304287
   target nu stat err =       0.000547898560
   target dn stat err =       0.002217511952
      target stat err =       0.001944637672
              std dev =       0.659311418770
             le_variance =       0.434691546921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699446221
                                         uncertainty =       0.002067946900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699446221
                                         uncertainty =       0.002067946900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466203730
  error estimate for blocks of size 2^( 2) =       0.000492126603
  error estimate for blocks of size 2^( 3) =       0.000516477921
  error estimate for blocks of size 2^( 4) =       0.000535231346
  error estimate for blocks of size 2^( 5) =       0.000547320617
  error estimate for blocks of size 2^( 6) =       0.000552384384
  error estimate for blocks of size 2^( 7) =       0.000556661603

      target function =      -0.748699255177
              le_mean =     -22.813866078398
             les_mean =     520.918442824273
             stat err =       0.000547899487
             autocorr =       1.381180058290
   target nu stat err =       0.000547899487
   target dn stat err =       0.002216030689
      target stat err =       0.001943511856
              std dev =       0.659311638311
             le_variance =       0.434691836413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699698751
                                         uncertainty =       0.002067958256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434699698751
                                         uncertainty =       0.002067958256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466203867
  error estimate for blocks of size 2^( 2) =       0.000492126918
  error estimate for blocks of size 2^( 3) =       0.000516478434
  error estimate for blocks of size 2^( 4) =       0.000535231993
  error estimate for blocks of size 2^( 5) =       0.000547321393
  error estimate for blocks of size 2^( 6) =       0.000552385260
  error estimate for blocks of size 2^( 7) =       0.000556662554

      target function =      -0.748706781456
              le_mean =     -22.813866077269
             les_mean =     520.918433741136
             stat err =       0.000547900300
             autocorr =       1.381183347856
   target nu stat err =       0.000547900300
   target dn stat err =       0.002214851706
      target stat err =       0.001942616958
              std dev =       0.659311831268
             le_variance =       0.434692090850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748707820162        initial  <--
     3.7253e+01     3.7253e+02             7.8433e-06        -0.748690088315
     1.4901e+02     1.4901e+03             1.9619e-06        -0.748699255177
     5.9605e+02     5.9605e+03             4.9053e-07        -0.748706781456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4505
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_01                 1.080340e-01 3 1  ON 0
ci_02                -2.400525e-02 3 1  ON 1
ci_03                -2.428149e-02 3 1  ON 2
ci_04                 2.215855e-02 3 1  ON 3
ci_05                -1.913239e-02 3 1  ON 4
ci_06                -1.952816e-02 3 1  ON 5
ci_07                 2.575688e-02 3 1  ON 6
ci_08                -4.225408e-03 3 1  ON 7
ci_09                -7.550265e-03 3 1  ON 8
ci_10                -7.705936e-03 3 1  ON 9
ci_11                 1.374788e-02 3 1  ON 10
ci_12                 7.046724e-03 3 1  ON 11
ci_13                 1.381510e-02 3 1  ON 12
ci_14                 1.281182e-02 3 1  ON 13
ci_15                 5.170234e-03 3 1  ON 14
ci_16                 5.731634e-03 3 1  ON 15
ci_17                -5.019070e-03 3 1  ON 16
ci_18                -5.546289e-03 3 1  ON 17
ci_19                 1.032925e-02 3 1  ON 18
ci_20                 6.254787e-03 3 1  ON 19
ci_21                 8.484136e-03 3 1  ON 20
ci_22                 8.881524e-03 3 1  ON 21
ci_23                 4.170208e-03 3 1  ON 22
ci_24                 5.186553e-03 3 1  ON 23
ci_25                 3.011830e-03 3 1  ON 24
ci_26                 3.793304e-03 3 1  ON 25
ci_27                 3.289182e-03 3 1  ON 26
ci_28                 7.716238e-04 3 1  ON 27
ci_29                 1.186664e-03 3 1  ON 28
ci_30                -7.406322e-04 3 1  ON 29
ci_31                 1.033208e-03 3 1  ON 30
ci_32                -5.371332e-04 3 1  ON 31
ci_33                -1.033529e-03 3 1  ON 32
ci_34                 1.152174e-03 3 1  ON 33
ci_35                 1.248893e-03 3 1  ON 34
ci_36                -5.663968e-04 3 1  ON 35
ci_37                -5.185967e-04 3 1  ON 36
ci_38                -2.864272e-04 3 1  ON 37
ci_39                -1.422213e-04 3 1  ON 38
ci_40                -1.904636e-03 3 1  ON 39
ci_41                -5.142278e-04 3 1  ON 40
ci_42                -1.647863e-03 3 1  ON 41
ci_43                -1.294034e-03 3 1  ON 42
ci_44                -2.176395e-03 3 1  ON 43
ci_45                -2.658317e-04 3 1  ON 44
ci_46                -1.692862e-03 3 1  ON 45
ci_47                 1.435637e-03 3 1  ON 46
ci_48                 2.892014e-03 3 1  ON 47
ci_49                -8.541995e-04 3 1  ON 48
ci_50                -8.202611e-04 3 1  ON 49
ci_51                -5.669823e-04 3 1  ON 50
ci_52                -6.305637e-04 3 1  ON 51
ci_53                -8.012972e-04 3 1  ON 52
ci_54                -1.109315e-03 3 1  ON 53
ci_55                -1.236076e-03 3 1  ON 54
ci_56                 1.099513e-03 3 1  ON 55
ci_57                 2.089285e-03 3 1  ON 56
ci_58                -1.859443e-04 3 1  ON 57
ci_59                -6.200000e-04 3 1  ON 58
ci_60                 1.277290e-04 3 1  ON 59
ci_61                -9.883475e-04 3 1  ON 60
ci_62                -3.817065e-04 3 1  ON 61
ci_63                -2.471725e-04 3 1  ON 62
ci_64                -6.085363e-04 3 1  ON 63
ci_65                -1.068090e-04 3 1  ON 64
ci_66                -1.262625e-04 3 1  ON 65
ci_67                -1.930760e-04 3 1  ON 66
ci_68                -1.797844e-03 3 1  ON 67
ci_69                -1.807591e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2461e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.852
    reference variance = 0.431154
====================================================
  Execution time = 2.5509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4588e-01
  Total weights = 1.964660235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434962893719
                                         uncertainty =       0.002330364174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434962893719
                                         uncertainty =       0.002330364174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466343882
  error estimate for blocks of size 2^( 2) =       0.000492079798
  error estimate for blocks of size 2^( 3) =       0.000516776290
  error estimate for blocks of size 2^( 4) =       0.000535125894
  error estimate for blocks of size 2^( 5) =       0.000547280107
  error estimate for blocks of size 2^( 6) =       0.000553272426
  error estimate for blocks of size 2^( 7) =       0.000557061345

      target function =      -0.748769471991
              le_mean =     -22.815104380014
             les_mean =     520.974871528482
             stat err =       0.000548184943
             autocorr =       1.381788702073
   target nu stat err =       0.000548184943
   target dn stat err =       0.002419519846
      target stat err =       0.002109452764
              std dev =       0.659509843107
             le_variance =       0.434953233155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281510438001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748774436685       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748774495602       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748774506426       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748774508253       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748774508813       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748774509211       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748774509267       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748774509277       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748774509243       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748774509253       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 7.656977e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748774436685       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748774451416       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748774454122       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748774454579       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748774454724       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748774454821       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748774454832       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748774454834       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748774454831       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748774454827       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.914347e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748774436685       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748774440368       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748774441045       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748774441159       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748774441194       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748774441209       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748774441219       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748774441222       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748774441237       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748774441219       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 4.785932e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0029e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_01                 1.080342e-01 3 1  ON 0
ci_02                -2.400541e-02 3 1  ON 1
ci_03                -2.428160e-02 3 1  ON 2
ci_04                 2.215863e-02 3 1  ON 3
ci_05                -1.913246e-02 3 1  ON 4
ci_06                -1.952820e-02 3 1  ON 5
ci_07                 2.575693e-02 3 1  ON 6
ci_08                -4.225432e-03 3 1  ON 7
ci_09                -7.550248e-03 3 1  ON 8
ci_10                -7.705931e-03 3 1  ON 9
ci_11                 1.374786e-02 3 1  ON 10
ci_12                 7.046712e-03 3 1  ON 11
ci_13                 1.381510e-02 3 1  ON 12
ci_14                 1.281179e-02 3 1  ON 13
ci_15                 5.170288e-03 3 1  ON 14
ci_16                 5.731648e-03 3 1  ON 15
ci_17                -5.019126e-03 3 1  ON 16
ci_18                -5.546329e-03 3 1  ON 17
ci_19                 1.032921e-02 3 1  ON 18
ci_20                 6.254793e-03 3 1  ON 19
ci_21                 8.484128e-03 3 1  ON 20
ci_22                 8.881527e-03 3 1  ON 21
ci_23                 4.170230e-03 3 1  ON 22
ci_24                 5.186539e-03 3 1  ON 23
ci_25                 3.011856e-03 3 1  ON 24
ci_26                 3.793279e-03 3 1  ON 25
ci_27                 3.289192e-03 3 1  ON 26
ci_28                 7.716132e-04 3 1  ON 27
ci_29                 1.186729e-03 3 1  ON 28
ci_30                -7.406017e-04 3 1  ON 29
ci_31                 1.033147e-03 3 1  ON 30
ci_32                -5.371759e-04 3 1  ON 31
ci_33                -1.033545e-03 3 1  ON 32
ci_34                 1.152176e-03 3 1  ON 33
ci_35                 1.248921e-03 3 1  ON 34
ci_36                -5.664201e-04 3 1  ON 35
ci_37                -5.186194e-04 3 1  ON 36
ci_38                -2.864169e-04 3 1  ON 37
ci_39                -1.422657e-04 3 1  ON 38
ci_40                -1.904620e-03 3 1  ON 39
ci_41                -5.142508e-04 3 1  ON 40
ci_42                -1.647865e-03 3 1  ON 41
ci_43                -1.294079e-03 3 1  ON 42
ci_44                -2.176452e-03 3 1  ON 43
ci_45                -2.658503e-04 3 1  ON 44
ci_46                -1.692814e-03 3 1  ON 45
ci_47                 1.435631e-03 3 1  ON 46
ci_48                 2.891987e-03 3 1  ON 47
ci_49                -8.542018e-04 3 1  ON 48
ci_50                -8.202496e-04 3 1  ON 49
ci_51                -5.669599e-04 3 1  ON 50
ci_52                -6.305507e-04 3 1  ON 51
ci_53                -8.012718e-04 3 1  ON 52
ci_54                -1.109310e-03 3 1  ON 53
ci_55                -1.236038e-03 3 1  ON 54
ci_56                 1.099559e-03 3 1  ON 55
ci_57                 2.089257e-03 3 1  ON 56
ci_58                -1.859820e-04 3 1  ON 57
ci_59                -6.200125e-04 3 1  ON 58
ci_60                 1.276934e-04 3 1  ON 59
ci_61                -9.883647e-04 3 1  ON 60
ci_62                -3.817127e-04 3 1  ON 61
ci_63                -2.471795e-04 3 1  ON 62
ci_64                -6.085556e-04 3 1  ON 63
ci_65                -1.068141e-04 3 1  ON 64
ci_66                -1.262593e-04 3 1  ON 65
ci_67                -1.930954e-04 3 1  ON 66
ci_68                -1.797803e-03 3 1  ON 67
ci_69                -1.807564e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7566
    reference variance = 0.231095
====================================================
  Execution time = 2.5052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4756e-01
  Total weights = 1.9649e+06
  Execution time = 3.9193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533884013
                                         uncertainty =       0.001957085789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533884013
                                         uncertainty =       0.001957085789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466609910
  error estimate for blocks of size 2^( 2) =       0.000492378043
  error estimate for blocks of size 2^( 3) =       0.000516649407
  error estimate for blocks of size 2^( 4) =       0.000534718540
  error estimate for blocks of size 2^( 5) =       0.000545505359
  error estimate for blocks of size 2^( 6) =       0.000553263769
  error estimate for blocks of size 2^( 7) =       0.000558295387

      target function =      -0.747376251568
              le_mean =     -22.815142588189
             les_mean =     520.978288347918
             stat err =       0.000547945764
             autocorr =       1.379009413825
   target nu stat err =       0.000547945764
   target dn stat err =       0.002330772472
      target stat err =       0.002031476769
              std dev =       0.659886063061
             le_variance =       0.435449616222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533838500
                                         uncertainty =       0.001957086737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533838500
                                         uncertainty =       0.001957086737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466609886
  error estimate for blocks of size 2^( 2) =       0.000492377973
  error estimate for blocks of size 2^( 3) =       0.000516649290
  error estimate for blocks of size 2^( 4) =       0.000534718381
  error estimate for blocks of size 2^( 5) =       0.000545505179
  error estimate for blocks of size 2^( 6) =       0.000553263567
  error estimate for blocks of size 2^( 7) =       0.000558295167

      target function =      -0.747376378173
              le_mean =     -22.815142587316
             les_mean =     520.978288155809
             stat err =       0.000547945574
             autocorr =       1.379008601425
   target nu stat err =       0.000547945574
   target dn stat err =       0.002330770943
      target stat err =       0.002031476147
              std dev =       0.659886028447
             le_variance =       0.435449570540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533861249
                                         uncertainty =       0.001957086263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533861249
                                         uncertainty =       0.001957086263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466609898
  error estimate for blocks of size 2^( 2) =       0.000492378008
  error estimate for blocks of size 2^( 3) =       0.000516649348
  error estimate for blocks of size 2^( 4) =       0.000534718460
  error estimate for blocks of size 2^( 5) =       0.000545505269
  error estimate for blocks of size 2^( 6) =       0.000553263668
  error estimate for blocks of size 2^( 7) =       0.000558295277

      target function =      -0.747376316105
              le_mean =     -22.815142587751
             les_mean =     520.978288250332
             stat err =       0.000547945669
             autocorr =       1.379009007592
   target nu stat err =       0.000547945669
   target dn stat err =       0.002330771681
      target stat err =       0.002031476443
              std dev =       0.659886045748
             le_variance =       0.435449593373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533881167
                                         uncertainty =       0.001957085848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435533881167
                                         uncertainty =       0.001957085848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466609908
  error estimate for blocks of size 2^( 2) =       0.000492378038
  error estimate for blocks of size 2^( 3) =       0.000516649400
  error estimate for blocks of size 2^( 4) =       0.000534718530
  error estimate for blocks of size 2^( 5) =       0.000545505348
  error estimate for blocks of size 2^( 6) =       0.000553263756
  error estimate for blocks of size 2^( 7) =       0.000558295373

      target function =      -0.747376259770
              le_mean =     -22.815142588134
             les_mean =     520.978288335553
             stat err =       0.000547945752
             autocorr =       1.379009363048
   target nu stat err =       0.000547945752
   target dn stat err =       0.002330772370
      target stat err =       0.002031476727
              std dev =       0.659886060896
             le_variance =       0.435449613365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747376251568        initial
     3.7253e+02     3.7253e+03             7.6570e-07        -0.747376378173  <--
     1.4901e+03     1.4901e+04             1.9143e-07        -0.747376316105
     5.9605e+03     5.9605e+04             4.7859e-08        -0.747376259770

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 4.3406e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_01                 1.080348e-01 3 1  ON 0
ci_02                -2.400589e-02 3 1  ON 1
ci_03                -2.428191e-02 3 1  ON 2
ci_04                 2.215889e-02 3 1  ON 3
ci_05                -1.913269e-02 3 1  ON 4
ci_06                -1.952834e-02 3 1  ON 5
ci_07                 2.575708e-02 3 1  ON 6
ci_08                -4.225501e-03 3 1  ON 7
ci_09                -7.550195e-03 3 1  ON 8
ci_10                -7.705917e-03 3 1  ON 9
ci_11                 1.374780e-02 3 1  ON 10
ci_12                 7.046676e-03 3 1  ON 11
ci_13                 1.381508e-02 3 1  ON 12
ci_14                 1.281170e-02 3 1  ON 13
ci_15                 5.170451e-03 3 1  ON 14
ci_16                 5.731690e-03 3 1  ON 15
ci_17                -5.019295e-03 3 1  ON 16
ci_18                -5.546450e-03 3 1  ON 17
ci_19                 1.032908e-02 3 1  ON 18
ci_20                 6.254812e-03 3 1  ON 19
ci_21                 8.484104e-03 3 1  ON 20
ci_22                 8.881538e-03 3 1  ON 21
ci_23                 4.170296e-03 3 1  ON 22
ci_24                 5.186498e-03 3 1  ON 23
ci_25                 3.011935e-03 3 1  ON 24
ci_26                 3.793203e-03 3 1  ON 25
ci_27                 3.289223e-03 3 1  ON 26
ci_28                 7.715812e-04 3 1  ON 27
ci_29                 1.186923e-03 3 1  ON 28
ci_30                -7.405101e-04 3 1  ON 29
ci_31                 1.032965e-03 3 1  ON 30
ci_32                -5.373039e-04 3 1  ON 31
ci_33                -1.033593e-03 3 1  ON 32
ci_34                 1.152182e-03 3 1  ON 33
ci_35                 1.249005e-03 3 1  ON 34
ci_36                -5.664900e-04 3 1  ON 35
ci_37                -5.186873e-04 3 1  ON 36
ci_38                -2.863859e-04 3 1  ON 37
ci_39                -1.423991e-04 3 1  ON 38
ci_40                -1.904573e-03 3 1  ON 39
ci_41                -5.143197e-04 3 1  ON 40
ci_42                -1.647873e-03 3 1  ON 41
ci_43                -1.294214e-03 3 1  ON 42
ci_44                -2.176624e-03 3 1  ON 43
ci_45                -2.659063e-04 3 1  ON 44
ci_46                -1.692671e-03 3 1  ON 45
ci_47                 1.435612e-03 3 1  ON 46
ci_48                 2.891906e-03 3 1  ON 47
ci_49                -8.542086e-04 3 1  ON 48
ci_50                -8.202149e-04 3 1  ON 49
ci_51                -5.668928e-04 3 1  ON 50
ci_52                -6.305116e-04 3 1  ON 51
ci_53                -8.011956e-04 3 1  ON 52
ci_54                -1.109295e-03 3 1  ON 53
ci_55                -1.235923e-03 3 1  ON 54
ci_56                 1.099697e-03 3 1  ON 55
ci_57                 2.089172e-03 3 1  ON 56
ci_58                -1.860951e-04 3 1  ON 57
ci_59                -6.200503e-04 3 1  ON 58
ci_60                 1.275868e-04 3 1  ON 59
ci_61                -9.884165e-04 3 1  ON 60
ci_62                -3.817314e-04 3 1  ON 61
ci_63                -2.472006e-04 3 1  ON 62
ci_64                -6.086135e-04 3 1  ON 63
ci_65                -1.068294e-04 3 1  ON 64
ci_66                -1.262495e-04 3 1  ON 65
ci_67                -1.931535e-04 3 1  ON 66
ci_68                -1.797680e-03 3 1  ON 67
ci_69                -1.807485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -23.0333
    reference variance = 3.43585
====================================================
  Execution time = 2.5615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4731e-01
  Total weights = 1.964931993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435043441305
                                         uncertainty =       0.001619594415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435043441305
                                         uncertainty =       0.001619594415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466436563
  error estimate for blocks of size 2^( 2) =       0.000492023586
  error estimate for blocks of size 2^( 3) =       0.000515842738
  error estimate for blocks of size 2^( 4) =       0.000533825877
  error estimate for blocks of size 2^( 5) =       0.000545063481
  error estimate for blocks of size 2^( 6) =       0.000551777995
  error estimate for blocks of size 2^( 7) =       0.000559212288

      target function =      -0.747576886185
              le_mean =     -22.814765220305
             les_mean =     520.960825187868
             stat err =       0.000547469910
             autocorr =       1.377638706628
   target nu stat err =       0.000547469910
   target dn stat err =       0.002372620059
      target stat err =       0.002064438164
              std dev =       0.659640913154
             le_variance =       0.435126134306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476522030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747581643674       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747581889431       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747581921769       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747581931874       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747581935312       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747581935431       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747581935527       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747581935590       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747581935582       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747581935579       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 3.748508e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747581643674       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747581705138       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747581713224       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747581715751       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747581716610       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747581716639       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747581716663       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747581716679       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747581716677       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747581716677       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 9.373277e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747581643674       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747581659041       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747581661063       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747581661695       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747581661909       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747581661920       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747581661923       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747581661927       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747581661926       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747581661928       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 2.343445e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0113e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_01                 1.080357e-01 3 1  ON 0
ci_02                -2.400634e-02 3 1  ON 1
ci_03                -2.428212e-02 3 1  ON 2
ci_04                 2.215947e-02 3 1  ON 3
ci_05                -1.913295e-02 3 1  ON 4
ci_06                -1.952866e-02 3 1  ON 5
ci_07                 2.575726e-02 3 1  ON 6
ci_08                -4.225496e-03 3 1  ON 7
ci_09                -7.550341e-03 3 1  ON 8
ci_10                -7.706015e-03 3 1  ON 9
ci_11                 1.374782e-02 3 1  ON 10
ci_12                 7.046759e-03 3 1  ON 11
ci_13                 1.381501e-02 3 1  ON 12
ci_14                 1.281167e-02 3 1  ON 13
ci_15                 5.170559e-03 3 1  ON 14
ci_16                 5.731689e-03 3 1  ON 15
ci_17                -5.019398e-03 3 1  ON 16
ci_18                -5.546578e-03 3 1  ON 17
ci_19                 1.032900e-02 3 1  ON 18
ci_20                 6.254659e-03 3 1  ON 19
ci_21                 8.484022e-03 3 1  ON 20
ci_22                 8.881439e-03 3 1  ON 21
ci_23                 4.170391e-03 3 1  ON 22
ci_24                 5.186416e-03 3 1  ON 23
ci_25                 3.011940e-03 3 1  ON 24
ci_26                 3.793147e-03 3 1  ON 25
ci_27                 3.289199e-03 3 1  ON 26
ci_28                 7.718276e-04 3 1  ON 27
ci_29                 1.186891e-03 3 1  ON 28
ci_30                -7.403408e-04 3 1  ON 29
ci_31                 1.032690e-03 3 1  ON 30
ci_32                -5.373477e-04 3 1  ON 31
ci_33                -1.033372e-03 3 1  ON 32
ci_34                 1.152293e-03 3 1  ON 33
ci_35                 1.249029e-03 3 1  ON 34
ci_36                -5.664625e-04 3 1  ON 35
ci_37                -5.188558e-04 3 1  ON 36
ci_38                -2.863996e-04 3 1  ON 37
ci_39                -1.424413e-04 3 1  ON 38
ci_40                -1.904488e-03 3 1  ON 39
ci_41                -5.143902e-04 3 1  ON 40
ci_42                -1.647761e-03 3 1  ON 41
ci_43                -1.294423e-03 3 1  ON 42
ci_44                -2.176740e-03 3 1  ON 43
ci_45                -2.659016e-04 3 1  ON 44
ci_46                -1.692464e-03 3 1  ON 45
ci_47                 1.435654e-03 3 1  ON 46
ci_48                 2.891777e-03 3 1  ON 47
ci_49                -8.541889e-04 3 1  ON 48
ci_50                -8.202015e-04 3 1  ON 49
ci_51                -5.668152e-04 3 1  ON 50
ci_52                -6.304330e-04 3 1  ON 51
ci_53                -8.011691e-04 3 1  ON 52
ci_54                -1.109297e-03 3 1  ON 53
ci_55                -1.235886e-03 3 1  ON 54
ci_56                 1.099836e-03 3 1  ON 55
ci_57                 2.089151e-03 3 1  ON 56
ci_58                -1.860478e-04 3 1  ON 57
ci_59                -6.199518e-04 3 1  ON 58
ci_60                 1.275183e-04 3 1  ON 59
ci_61                -9.886158e-04 3 1  ON 60
ci_62                -3.818627e-04 3 1  ON 61
ci_63                -2.473266e-04 3 1  ON 62
ci_64                -6.084398e-04 3 1  ON 63
ci_65                -1.068139e-04 3 1  ON 64
ci_66                -1.262848e-04 3 1  ON 65
ci_67                -1.931003e-04 3 1  ON 66
ci_68                -1.797518e-03 3 1  ON 67
ci_69                -1.807345e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8346
    reference variance = 0.37871
====================================================
  Execution time = 2.4815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5219e-01
  Total weights = 1.9647e+06
  Execution time = 3.5173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437655166975
                                         uncertainty =       0.001911245855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437655166975
                                         uncertainty =       0.001911245855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467768528
  error estimate for blocks of size 2^( 2) =       0.000493259988
  error estimate for blocks of size 2^( 3) =       0.000517963134
  error estimate for blocks of size 2^( 4) =       0.000536507147
  error estimate for blocks of size 2^( 5) =       0.000547253260
  error estimate for blocks of size 2^( 6) =       0.000554839761
  error estimate for blocks of size 2^( 7) =       0.000560815383

      target function =      -0.743544286306
              le_mean =     -22.815096365049
             les_mean =     520.980807501579
             stat err =       0.000549853888
             autocorr =       1.381759957231
   target nu stat err =       0.000549853888
   target dn stat err =       0.003079032821
      target stat err =       0.002605693748
              std dev =       0.661524596254
             le_variance =       0.437614791449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437654407900
                                         uncertainty =       0.001911188296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437654407900
                                         uncertainty =       0.001911188296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467768123
  error estimate for blocks of size 2^( 2) =       0.000493259426
  error estimate for blocks of size 2^( 3) =       0.000517962409
  error estimate for blocks of size 2^( 4) =       0.000536506303
  error estimate for blocks of size 2^( 5) =       0.000547252356
  error estimate for blocks of size 2^( 6) =       0.000554838819
  error estimate for blocks of size 2^( 7) =       0.000560814468

      target function =      -0.743531498342
              le_mean =     -22.815096351353
             les_mean =     520.980822414954
             stat err =       0.000549852987
             autocorr =       1.381757820061
   target nu stat err =       0.000549852987
   target dn stat err =       0.003079462412
      target stat err =       0.002605949997
              std dev =       0.661524023872
             le_variance =       0.437614034160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437654787219
                                         uncertainty =       0.001911217066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437654787219
                                         uncertainty =       0.001911217066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467768325
  error estimate for blocks of size 2^( 2) =       0.000493259707
  error estimate for blocks of size 2^( 3) =       0.000517962771
  error estimate for blocks of size 2^( 4) =       0.000536506725
  error estimate for blocks of size 2^( 5) =       0.000547252808
  error estimate for blocks of size 2^( 6) =       0.000554839290
  error estimate for blocks of size 2^( 7) =       0.000560814925

      target function =      -0.743538188111
              le_mean =     -22.815096358191
             les_mean =     520.980814598442
             stat err =       0.000549853437
             autocorr =       1.381758888312
   target nu stat err =       0.000549853437
   target dn stat err =       0.003079222967
      target stat err =       0.002605804169
              std dev =       0.661524309898
             le_variance =       0.437614412586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437655119491
                                         uncertainty =       0.001911242256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437655119491
                                         uncertainty =       0.001911242256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467768503
  error estimate for blocks of size 2^( 2) =       0.000493259953
  error estimate for blocks of size 2^( 3) =       0.000517963089
  error estimate for blocks of size 2^( 4) =       0.000536507094
  error estimate for blocks of size 2^( 5) =       0.000547253204
  error estimate for blocks of size 2^( 6) =       0.000554839702
  error estimate for blocks of size 2^( 7) =       0.000560815325

      target function =      -0.743543554256
              le_mean =     -22.815096364191
             les_mean =     520.980808351921
             stat err =       0.000549853831
             autocorr =       1.381759823612
   target nu stat err =       0.000549853831
   target dn stat err =       0.003079054147
      target stat err =       0.002605705803
              std dev =       0.661524560448
             le_variance =       0.437614744076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743544286306        initial  <--
     9.3132e+01     9.3132e+02             3.7485e-06        -0.743531498342
     3.7253e+02     3.7253e+03             9.3733e-07        -0.743538188111
     1.4901e+03     1.4901e+04             2.3434e-07        -0.743543554256

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4083
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_01                 1.080348e-01 3 1  ON 0
ci_02                -2.400589e-02 3 1  ON 1
ci_03                -2.428191e-02 3 1  ON 2
ci_04                 2.215889e-02 3 1  ON 3
ci_05                -1.913269e-02 3 1  ON 4
ci_06                -1.952834e-02 3 1  ON 5
ci_07                 2.575708e-02 3 1  ON 6
ci_08                -4.225501e-03 3 1  ON 7
ci_09                -7.550195e-03 3 1  ON 8
ci_10                -7.705917e-03 3 1  ON 9
ci_11                 1.374780e-02 3 1  ON 10
ci_12                 7.046676e-03 3 1  ON 11
ci_13                 1.381508e-02 3 1  ON 12
ci_14                 1.281170e-02 3 1  ON 13
ci_15                 5.170451e-03 3 1  ON 14
ci_16                 5.731690e-03 3 1  ON 15
ci_17                -5.019295e-03 3 1  ON 16
ci_18                -5.546450e-03 3 1  ON 17
ci_19                 1.032908e-02 3 1  ON 18
ci_20                 6.254812e-03 3 1  ON 19
ci_21                 8.484104e-03 3 1  ON 20
ci_22                 8.881538e-03 3 1  ON 21
ci_23                 4.170296e-03 3 1  ON 22
ci_24                 5.186498e-03 3 1  ON 23
ci_25                 3.011935e-03 3 1  ON 24
ci_26                 3.793203e-03 3 1  ON 25
ci_27                 3.289223e-03 3 1  ON 26
ci_28                 7.715812e-04 3 1  ON 27
ci_29                 1.186923e-03 3 1  ON 28
ci_30                -7.405101e-04 3 1  ON 29
ci_31                 1.032965e-03 3 1  ON 30
ci_32                -5.373039e-04 3 1  ON 31
ci_33                -1.033593e-03 3 1  ON 32
ci_34                 1.152182e-03 3 1  ON 33
ci_35                 1.249005e-03 3 1  ON 34
ci_36                -5.664900e-04 3 1  ON 35
ci_37                -5.186873e-04 3 1  ON 36
ci_38                -2.863859e-04 3 1  ON 37
ci_39                -1.423991e-04 3 1  ON 38
ci_40                -1.904573e-03 3 1  ON 39
ci_41                -5.143197e-04 3 1  ON 40
ci_42                -1.647873e-03 3 1  ON 41
ci_43                -1.294214e-03 3 1  ON 42
ci_44                -2.176624e-03 3 1  ON 43
ci_45                -2.659063e-04 3 1  ON 44
ci_46                -1.692671e-03 3 1  ON 45
ci_47                 1.435612e-03 3 1  ON 46
ci_48                 2.891906e-03 3 1  ON 47
ci_49                -8.542086e-04 3 1  ON 48
ci_50                -8.202149e-04 3 1  ON 49
ci_51                -5.668928e-04 3 1  ON 50
ci_52                -6.305116e-04 3 1  ON 51
ci_53                -8.011956e-04 3 1  ON 52
ci_54                -1.109295e-03 3 1  ON 53
ci_55                -1.235923e-03 3 1  ON 54
ci_56                 1.099697e-03 3 1  ON 55
ci_57                 2.089172e-03 3 1  ON 56
ci_58                -1.860951e-04 3 1  ON 57
ci_59                -6.200503e-04 3 1  ON 58
ci_60                 1.275868e-04 3 1  ON 59
ci_61                -9.884165e-04 3 1  ON 60
ci_62                -3.817314e-04 3 1  ON 61
ci_63                -2.472006e-04 3 1  ON 62
ci_64                -6.086135e-04 3 1  ON 63
ci_65                -1.068294e-04 3 1  ON 64
ci_66                -1.262495e-04 3 1  ON 65
ci_67                -1.931535e-04 3 1  ON 66
ci_68                -1.797680e-03 3 1  ON 67
ci_69                -1.807485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8259
    reference variance = 0.324381
====================================================
  Execution time = 2.5843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4796e-01
  Total weights = 1.964912713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682593499
                                         uncertainty =       0.001925109387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433682593499
                                         uncertainty =       0.001925109387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465633417
  error estimate for blocks of size 2^( 2) =       0.000491755371
  error estimate for blocks of size 2^( 3) =       0.000516447248
  error estimate for blocks of size 2^( 4) =       0.000534364037
  error estimate for blocks of size 2^( 5) =       0.000548036508
  error estimate for blocks of size 2^( 6) =       0.000556748026
  error estimate for blocks of size 2^( 7) =       0.000561265974

      target function =      -0.747029301077
              le_mean =     -22.813749333081
             les_mean =     520.915116661030
             stat err =       0.000550103636
             autocorr =       1.395727866096
   target nu stat err =       0.000550103636
   target dn stat err =       0.003514149858
      target stat err =       0.002976298301
              std dev =       0.658505093834
             le_variance =       0.433628958605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281374933308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747040109668       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747040136800       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747040141498       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747040142230       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747040142814       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747040142973       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747040143009       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747040143018       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747040143017       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747040143015       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 3.630385e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747040109668       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747040116451       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747040117626       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747040117809       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747040117955       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747040117998       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747040118000       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747040118007       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747040118004       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747040118011       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 9.076153e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747040109668       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747040111364       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747040111658       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747040111703       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747040111735       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747040111720       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747040111735       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747040111746       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747040111746       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747040111752       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 2.269050e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0376e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_01                 1.080349e-01 3 1  ON 0
ci_02                -2.400597e-02 3 1  ON 1
ci_03                -2.428196e-02 3 1  ON 2
ci_04                 2.215894e-02 3 1  ON 3
ci_05                -1.913269e-02 3 1  ON 4
ci_06                -1.952835e-02 3 1  ON 5
ci_07                 2.575710e-02 3 1  ON 6
ci_08                -4.225509e-03 3 1  ON 7
ci_09                -7.550205e-03 3 1  ON 8
ci_10                -7.705905e-03 3 1  ON 9
ci_11                 1.374779e-02 3 1  ON 10
ci_12                 7.046687e-03 3 1  ON 11
ci_13                 1.381507e-02 3 1  ON 12
ci_14                 1.281172e-02 3 1  ON 13
ci_15                 5.170466e-03 3 1  ON 14
ci_16                 5.731695e-03 3 1  ON 15
ci_17                -5.019315e-03 3 1  ON 16
ci_18                -5.546453e-03 3 1  ON 17
ci_19                 1.032906e-02 3 1  ON 18
ci_20                 6.254802e-03 3 1  ON 19
ci_21                 8.484094e-03 3 1  ON 20
ci_22                 8.881532e-03 3 1  ON 21
ci_23                 4.170313e-03 3 1  ON 22
ci_24                 5.186496e-03 3 1  ON 23
ci_25                 3.011949e-03 3 1  ON 24
ci_26                 3.793193e-03 3 1  ON 25
ci_27                 3.289223e-03 3 1  ON 26
ci_28                 7.715874e-04 3 1  ON 27
ci_29                 1.186934e-03 3 1  ON 28
ci_30                -7.405134e-04 3 1  ON 29
ci_31                 1.032958e-03 3 1  ON 30
ci_32                -5.373338e-04 3 1  ON 31
ci_33                -1.033612e-03 3 1  ON 32
ci_34                 1.152168e-03 3 1  ON 33
ci_35                 1.248986e-03 3 1  ON 34
ci_36                -5.664923e-04 3 1  ON 35
ci_37                -5.186939e-04 3 1  ON 36
ci_38                -2.863926e-04 3 1  ON 37
ci_39                -1.424042e-04 3 1  ON 38
ci_40                -1.904573e-03 3 1  ON 39
ci_41                -5.143235e-04 3 1  ON 40
ci_42                -1.647862e-03 3 1  ON 41
ci_43                -1.294205e-03 3 1  ON 42
ci_44                -2.176593e-03 3 1  ON 43
ci_45                -2.659078e-04 3 1  ON 44
ci_46                -1.692658e-03 3 1  ON 45
ci_47                 1.435621e-03 3 1  ON 46
ci_48                 2.891911e-03 3 1  ON 47
ci_49                -8.541993e-04 3 1  ON 48
ci_50                -8.202082e-04 3 1  ON 49
ci_51                -5.668794e-04 3 1  ON 50
ci_52                -6.305045e-04 3 1  ON 51
ci_53                -8.012018e-04 3 1  ON 52
ci_54                -1.109281e-03 3 1  ON 53
ci_55                -1.235911e-03 3 1  ON 54
ci_56                 1.099698e-03 3 1  ON 55
ci_57                 2.089164e-03 3 1  ON 56
ci_58                -1.861057e-04 3 1  ON 57
ci_59                -6.200535e-04 3 1  ON 58
ci_60                 1.275913e-04 3 1  ON 59
ci_61                -9.884118e-04 3 1  ON 60
ci_62                -3.817272e-04 3 1  ON 61
ci_63                -2.472050e-04 3 1  ON 62
ci_64                -6.086044e-04 3 1  ON 63
ci_65                -1.068185e-04 3 1  ON 64
ci_66                -1.262416e-04 3 1  ON 65
ci_67                -1.931503e-04 3 1  ON 66
ci_68                -1.797680e-03 3 1  ON 67
ci_69                -1.807478e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8329
    reference variance = 0.240545
====================================================
  Execution time = 2.4818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4954e-01
  Total weights = 1.9649e+06
  Execution time = 3.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253117031
                                         uncertainty =       0.003929041458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253117031
                                         uncertainty =       0.003929041458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467596757
  error estimate for blocks of size 2^( 2) =       0.000493634803
  error estimate for blocks of size 2^( 3) =       0.000518283132
  error estimate for blocks of size 2^( 4) =       0.000535944108
  error estimate for blocks of size 2^( 5) =       0.000548192240
  error estimate for blocks of size 2^( 6) =       0.000555122758
  error estimate for blocks of size 2^( 7) =       0.000560381762

      target function =      -0.745712677789
              le_mean =     -22.814276060634
             les_mean =     520.940736161366
             stat err =       0.000549910217
             autocorr =       1.383058645932
   target nu stat err =       0.000549910217
   target dn stat err =       0.004395414348
      target stat err =       0.003684371564
              std dev =       0.661281675674
             le_variance =       0.437293454582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253089683
                                         uncertainty =       0.003929043547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253089683
                                         uncertainty =       0.003929043547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467596742
  error estimate for blocks of size 2^( 2) =       0.000493634766
  error estimate for blocks of size 2^( 3) =       0.000518283076
  error estimate for blocks of size 2^( 4) =       0.000535944037
  error estimate for blocks of size 2^( 5) =       0.000548192159
  error estimate for blocks of size 2^( 6) =       0.000555122672
  error estimate for blocks of size 2^( 7) =       0.000560381674

      target function =      -0.745712919755
              le_mean =     -22.814276060256
             les_mean =     520.940735851315
             stat err =       0.000549910136
             autocorr =       1.383058324814
   target nu stat err =       0.000549910136
   target dn stat err =       0.004395423343
      target stat err =       0.003684381239
              std dev =       0.661281654961
             le_variance =       0.437293427188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253103355
                                         uncertainty =       0.003929042503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253103355
                                         uncertainty =       0.003929042503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467596750
  error estimate for blocks of size 2^( 2) =       0.000493634784
  error estimate for blocks of size 2^( 3) =       0.000518283104
  error estimate for blocks of size 2^( 4) =       0.000535944073
  error estimate for blocks of size 2^( 5) =       0.000548192200
  error estimate for blocks of size 2^( 6) =       0.000555122715
  error estimate for blocks of size 2^( 7) =       0.000560381718

      target function =      -0.745712799454
              le_mean =     -22.814276060445
             les_mean =     520.940736005507
             stat err =       0.000549910176
             autocorr =       1.383058485364
   target nu stat err =       0.000549910176
   target dn stat err =       0.004395418842
      target stat err =       0.003684376405
              std dev =       0.661281665317
             le_variance =       0.437293440884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253115321
                                         uncertainty =       0.003929041589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437253115321
                                         uncertainty =       0.003929041589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467596756
  error estimate for blocks of size 2^( 2) =       0.000493634800
  error estimate for blocks of size 2^( 3) =       0.000518283129
  error estimate for blocks of size 2^( 4) =       0.000535944104
  error estimate for blocks of size 2^( 5) =       0.000548192235
  error estimate for blocks of size 2^( 6) =       0.000555122752
  error estimate for blocks of size 2^( 7) =       0.000560381756

      target function =      -0.745712693072
              le_mean =     -22.814276060611
             les_mean =     520.940736141792
             stat err =       0.000549910212
             autocorr =       1.383058625859
   target nu stat err =       0.000549910212
   target dn stat err =       0.004395414910
      target stat err =       0.003684372169
              std dev =       0.661281674379
             le_variance =       0.437293452870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745712677789        initial
     9.3132e+02     9.3132e+03             3.6304e-07        -0.745712919755  <--
     3.7253e+03     3.7253e+04             9.0762e-08        -0.745712799454
     1.4901e+04     1.4901e+05             2.2691e-08        -0.745712693072

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 4.5817e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_01                 1.080352e-01 3 1  ON 0
ci_02                -2.400621e-02 3 1  ON 1
ci_03                -2.428211e-02 3 1  ON 2
ci_04                 2.215908e-02 3 1  ON 3
ci_05                -1.913269e-02 3 1  ON 4
ci_06                -1.952838e-02 3 1  ON 5
ci_07                 2.575714e-02 3 1  ON 6
ci_08                -4.225530e-03 3 1  ON 7
ci_09                -7.550234e-03 3 1  ON 8
ci_10                -7.705871e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046719e-03 3 1  ON 11
ci_13                 1.381504e-02 3 1  ON 12
ci_14                 1.281178e-02 3 1  ON 13
ci_15                 5.170513e-03 3 1  ON 14
ci_16                 5.731707e-03 3 1  ON 15
ci_17                -5.019373e-03 3 1  ON 16
ci_18                -5.546464e-03 3 1  ON 17
ci_19                 1.032899e-02 3 1  ON 18
ci_20                 6.254774e-03 3 1  ON 19
ci_21                 8.484063e-03 3 1  ON 20
ci_22                 8.881515e-03 3 1  ON 21
ci_23                 4.170362e-03 3 1  ON 22
ci_24                 5.186489e-03 3 1  ON 23
ci_25                 3.011989e-03 3 1  ON 24
ci_26                 3.793163e-03 3 1  ON 25
ci_27                 3.289224e-03 3 1  ON 26
ci_28                 7.716060e-04 3 1  ON 27
ci_29                 1.186967e-03 3 1  ON 28
ci_30                -7.405234e-04 3 1  ON 29
ci_31                 1.032936e-03 3 1  ON 30
ci_32                -5.374235e-04 3 1  ON 31
ci_33                -1.033670e-03 3 1  ON 32
ci_34                 1.152129e-03 3 1  ON 33
ci_35                 1.248931e-03 3 1  ON 34
ci_36                -5.664994e-04 3 1  ON 35
ci_37                -5.187138e-04 3 1  ON 36
ci_38                -2.864127e-04 3 1  ON 37
ci_39                -1.424194e-04 3 1  ON 38
ci_40                -1.904572e-03 3 1  ON 39
ci_41                -5.143346e-04 3 1  ON 40
ci_42                -1.647832e-03 3 1  ON 41
ci_43                -1.294178e-03 3 1  ON 42
ci_44                -2.176500e-03 3 1  ON 43
ci_45                -2.659123e-04 3 1  ON 44
ci_46                -1.692620e-03 3 1  ON 45
ci_47                 1.435646e-03 3 1  ON 46
ci_48                 2.891928e-03 3 1  ON 47
ci_49                -8.541714e-04 3 1  ON 48
ci_50                -8.201882e-04 3 1  ON 49
ci_51                -5.668393e-04 3 1  ON 50
ci_52                -6.304833e-04 3 1  ON 51
ci_53                -8.012202e-04 3 1  ON 52
ci_54                -1.109240e-03 3 1  ON 53
ci_55                -1.235874e-03 3 1  ON 54
ci_56                 1.099704e-03 3 1  ON 55
ci_57                 2.089142e-03 3 1  ON 56
ci_58                -1.861374e-04 3 1  ON 57
ci_59                -6.200632e-04 3 1  ON 58
ci_60                 1.276047e-04 3 1  ON 59
ci_61                -9.883978e-04 3 1  ON 60
ci_62                -3.817147e-04 3 1  ON 61
ci_63                -2.472180e-04 3 1  ON 62
ci_64                -6.085770e-04 3 1  ON 63
ci_65                -1.067859e-04 3 1  ON 64
ci_66                -1.262180e-04 3 1  ON 65
ci_67                -1.931407e-04 3 1  ON 66
ci_68                -1.797682e-03 3 1  ON 67
ci_69                -1.807459e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7916
    reference variance = 0.232067
====================================================
  Execution time = 2.5644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4452e-01
  Total weights = 1.964760596e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431731452858
                                         uncertainty =       0.001762999383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431731452858
                                         uncertainty =       0.001762999383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464581308
  error estimate for blocks of size 2^( 2) =       0.000490695762
  error estimate for blocks of size 2^( 3) =       0.000515171080
  error estimate for blocks of size 2^( 4) =       0.000533789447
  error estimate for blocks of size 2^( 5) =       0.000545660292
  error estimate for blocks of size 2^( 6) =       0.000551853909
  error estimate for blocks of size 2^( 7) =       0.000554828747

      target function =      -0.749905538108
              le_mean =     -22.814663076336
             les_mean =     520.953366551922
             stat err =       0.000546533099
             autocorr =       1.383915179435
   target nu stat err =       0.000546533099
   target dn stat err =       0.003128485154
      target stat err =       0.002686956694
              std dev =       0.657017186130
             le_variance =       0.431671582870


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281466307634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749914140455       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749914231117       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749914248297       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749914253600       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749914255208       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749914255098       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749914255371       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749914255392       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749914255381       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749914255380       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.653928e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749914140455       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749914163124       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749914167419       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749914168745       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749914169147       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749914169120       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749914169188       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749914169193       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749914169190       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749914169190       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 4.135168e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749914140455       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749914146122       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749914147196       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749914147528       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749914147628       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749914147621       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749914147638       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749914147640       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749914147639       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749914147639       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 1.033814e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0174e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_01                 1.080356e-01 3 1  ON 0
ci_02                -2.400645e-02 3 1  ON 1
ci_03                -2.428231e-02 3 1  ON 2
ci_04                 2.215928e-02 3 1  ON 3
ci_05                -1.913274e-02 3 1  ON 4
ci_06                -1.952839e-02 3 1  ON 5
ci_07                 2.575717e-02 3 1  ON 6
ci_08                -4.225531e-03 3 1  ON 7
ci_09                -7.550165e-03 3 1  ON 8
ci_10                -7.705821e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046703e-03 3 1  ON 11
ci_13                 1.381498e-02 3 1  ON 12
ci_14                 1.281183e-02 3 1  ON 13
ci_15                 5.170528e-03 3 1  ON 14
ci_16                 5.731756e-03 3 1  ON 15
ci_17                -5.019446e-03 3 1  ON 16
ci_18                -5.546442e-03 3 1  ON 17
ci_19                 1.032895e-02 3 1  ON 18
ci_20                 6.254794e-03 3 1  ON 19
ci_21                 8.484047e-03 3 1  ON 20
ci_22                 8.881465e-03 3 1  ON 21
ci_23                 4.170418e-03 3 1  ON 22
ci_24                 5.186459e-03 3 1  ON 23
ci_25                 3.012050e-03 3 1  ON 24
ci_26                 3.793089e-03 3 1  ON 25
ci_27                 3.289182e-03 3 1  ON 26
ci_28                 7.716257e-04 3 1  ON 27
ci_29                 1.186985e-03 3 1  ON 28
ci_30                -7.404488e-04 3 1  ON 29
ci_31                 1.032875e-03 3 1  ON 30
ci_32                -5.374263e-04 3 1  ON 31
ci_33                -1.033728e-03 3 1  ON 32
ci_34                 1.152080e-03 3 1  ON 33
ci_35                 1.248912e-03 3 1  ON 34
ci_36                -5.665022e-04 3 1  ON 35
ci_37                -5.187751e-04 3 1  ON 36
ci_38                -2.863955e-04 3 1  ON 37
ci_39                -1.423837e-04 3 1  ON 38
ci_40                -1.904557e-03 3 1  ON 39
ci_41                -5.143503e-04 3 1  ON 40
ci_42                -1.647825e-03 3 1  ON 41
ci_43                -1.294246e-03 3 1  ON 42
ci_44                -2.176438e-03 3 1  ON 43
ci_45                -2.659045e-04 3 1  ON 44
ci_46                -1.692535e-03 3 1  ON 45
ci_47                 1.435667e-03 3 1  ON 46
ci_48                 2.891928e-03 3 1  ON 47
ci_49                -8.541860e-04 3 1  ON 48
ci_50                -8.201409e-04 3 1  ON 49
ci_51                -5.668071e-04 3 1  ON 50
ci_52                -6.304525e-04 3 1  ON 51
ci_53                -8.012527e-04 3 1  ON 52
ci_54                -1.109233e-03 3 1  ON 53
ci_55                -1.235875e-03 3 1  ON 54
ci_56                 1.099722e-03 3 1  ON 55
ci_57                 2.089093e-03 3 1  ON 56
ci_58                -1.862139e-04 3 1  ON 57
ci_59                -6.200777e-04 3 1  ON 58
ci_60                 1.276561e-04 3 1  ON 59
ci_61                -9.883341e-04 3 1  ON 60
ci_62                -3.817371e-04 3 1  ON 61
ci_63                -2.472469e-04 3 1  ON 62
ci_64                -6.085812e-04 3 1  ON 63
ci_65                -1.068175e-04 3 1  ON 64
ci_66                -1.262400e-04 3 1  ON 65
ci_67                -1.931541e-04 3 1  ON 66
ci_68                -1.797627e-03 3 1  ON 67
ci_69                -1.807380e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7575
    reference variance = 0.297148
====================================================
  Execution time = 2.5222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5079e-01
  Total weights = 1.9646e+06
  Execution time = 3.5098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376451417
                                         uncertainty =       0.001936233974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376451417
                                         uncertainty =       0.001936233974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070253
  error estimate for blocks of size 2^( 2) =       0.000492307406
  error estimate for blocks of size 2^( 3) =       0.000516828210
  error estimate for blocks of size 2^( 4) =       0.000535171623
  error estimate for blocks of size 2^( 5) =       0.000546330852
  error estimate for blocks of size 2^( 6) =       0.000554399777
  error estimate for blocks of size 2^( 7) =       0.000556200057

      target function =      -0.744691510488
              le_mean =     -22.814197224117
             les_mean =     520.938388250025
             stat err =       0.000548025577
             autocorr =       1.376693425793
   target nu stat err =       0.000548025577
   target dn stat err =       0.002855885279
      target stat err =       0.002431025632
              std dev =       0.660537086833
             le_variance =       0.436309243082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376359188
                                         uncertainty =       0.001936240440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376359188
                                         uncertainty =       0.001936240440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070204
  error estimate for blocks of size 2^( 2) =       0.000492307287
  error estimate for blocks of size 2^( 3) =       0.000516828015
  error estimate for blocks of size 2^( 4) =       0.000535171381
  error estimate for blocks of size 2^( 5) =       0.000546330571
  error estimate for blocks of size 2^( 6) =       0.000554399479
  error estimate for blocks of size 2^( 7) =       0.000556199777

      target function =      -0.744692939515
              le_mean =     -22.814197221341
             les_mean =     520.938386390371
             stat err =       0.000548025302
             autocorr =       1.376692331678
   target nu stat err =       0.000548025302
   target dn stat err =       0.002855777726
      target stat err =       0.002430948732
              std dev =       0.660537017428
             le_variance =       0.436309151392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376405282
                                         uncertainty =       0.001936237207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376405282
                                         uncertainty =       0.001936237207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070229
  error estimate for blocks of size 2^( 2) =       0.000492307347
  error estimate for blocks of size 2^( 3) =       0.000516828113
  error estimate for blocks of size 2^( 4) =       0.000535171502
  error estimate for blocks of size 2^( 5) =       0.000546330711
  error estimate for blocks of size 2^( 6) =       0.000554399628
  error estimate for blocks of size 2^( 7) =       0.000556199917

      target function =      -0.744692298836
              le_mean =     -22.814197222725
             les_mean =     520.938387230441
             stat err =       0.000548025440
             autocorr =       1.376692878650
   target nu stat err =       0.000548025440
   target dn stat err =       0.002855831431
      target stat err =       0.002430987592
              std dev =       0.660537052115
             le_variance =       0.436309197217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376445648
                                         uncertainty =       0.001936234378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436376445648
                                         uncertainty =       0.001936234378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070250
  error estimate for blocks of size 2^( 2) =       0.000492307399
  error estimate for blocks of size 2^( 3) =       0.000516828198
  error estimate for blocks of size 2^( 4) =       0.000535171608
  error estimate for blocks of size 2^( 5) =       0.000546330835
  error estimate for blocks of size 2^( 6) =       0.000554399758
  error estimate for blocks of size 2^( 7) =       0.000556200040

      target function =      -0.744691620443
              le_mean =     -22.814197223943
             les_mean =     520.938388108711
             stat err =       0.000548025560
             autocorr =       1.376693357403
   target nu stat err =       0.000548025560
   target dn stat err =       0.002855878536
      target stat err =       0.002431020941
              std dev =       0.660537082492
             le_variance =       0.436309237347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744691510488        initial
     2.3283e+02     2.3283e+03             1.6539e-06        -0.744692939515  <--
     9.3132e+02     9.3132e+03             4.1352e-07        -0.744692298836
     3.7253e+03     3.7253e+04             1.0338e-07        -0.744691620443

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 4.2801e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_01                 1.080368e-01 3 1  ON 0
ci_02                -2.400715e-02 3 1  ON 1
ci_03                -2.428293e-02 3 1  ON 2
ci_04                 2.215987e-02 3 1  ON 3
ci_05                -1.913291e-02 3 1  ON 4
ci_06                -1.952842e-02 3 1  ON 5
ci_07                 2.575724e-02 3 1  ON 6
ci_08                -4.225533e-03 3 1  ON 7
ci_09                -7.549960e-03 3 1  ON 8
ci_10                -7.705669e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046657e-03 3 1  ON 11
ci_13                 1.381479e-02 3 1  ON 12
ci_14                 1.281195e-02 3 1  ON 13
ci_15                 5.170576e-03 3 1  ON 14
ci_16                 5.731902e-03 3 1  ON 15
ci_17                -5.019666e-03 3 1  ON 16
ci_18                -5.546376e-03 3 1  ON 17
ci_19                 1.032885e-02 3 1  ON 18
ci_20                 6.254854e-03 3 1  ON 19
ci_21                 8.484001e-03 3 1  ON 20
ci_22                 8.881317e-03 3 1  ON 21
ci_23                 4.170584e-03 3 1  ON 22
ci_24                 5.186368e-03 3 1  ON 23
ci_25                 3.012231e-03 3 1  ON 24
ci_26                 3.792868e-03 3 1  ON 25
ci_27                 3.289059e-03 3 1  ON 26
ci_28                 7.716845e-04 3 1  ON 27
ci_29                 1.187040e-03 3 1  ON 28
ci_30                -7.402248e-04 3 1  ON 29
ci_31                 1.032692e-03 3 1  ON 30
ci_32                -5.374347e-04 3 1  ON 31
ci_33                -1.033901e-03 3 1  ON 32
ci_34                 1.151934e-03 3 1  ON 33
ci_35                 1.248856e-03 3 1  ON 34
ci_36                -5.665105e-04 3 1  ON 35
ci_37                -5.189590e-04 3 1  ON 36
ci_38                -2.863442e-04 3 1  ON 37
ci_39                -1.422769e-04 3 1  ON 38
ci_40                -1.904513e-03 3 1  ON 39
ci_41                -5.143974e-04 3 1  ON 40
ci_42                -1.647805e-03 3 1  ON 41
ci_43                -1.294452e-03 3 1  ON 42
ci_44                -2.176251e-03 3 1  ON 43
ci_45                -2.658812e-04 3 1  ON 44
ci_46                -1.692280e-03 3 1  ON 45
ci_47                 1.435731e-03 3 1  ON 46
ci_48                 2.891927e-03 3 1  ON 47
ci_49                -8.542297e-04 3 1  ON 48
ci_50                -8.199991e-04 3 1  ON 49
ci_51                -5.667106e-04 3 1  ON 50
ci_52                -6.303599e-04 3 1  ON 51
ci_53                -8.013504e-04 3 1  ON 52
ci_54                -1.109212e-03 3 1  ON 53
ci_55                -1.235878e-03 3 1  ON 54
ci_56                 1.099776e-03 3 1  ON 55
ci_57                 2.088945e-03 3 1  ON 56
ci_58                -1.864433e-04 3 1  ON 57
ci_59                -6.201209e-04 3 1  ON 58
ci_60                 1.278101e-04 3 1  ON 59
ci_61                -9.881433e-04 3 1  ON 60
ci_62                -3.818042e-04 3 1  ON 61
ci_63                -2.473335e-04 3 1  ON 62
ci_64                -6.085936e-04 3 1  ON 63
ci_65                -1.069123e-04 3 1  ON 64
ci_66                -1.263059e-04 3 1  ON 65
ci_67                -1.931942e-04 3 1  ON 66
ci_68                -1.797461e-03 3 1  ON 67
ci_69                -1.807140e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 0.355984
====================================================
  Execution time = 2.5555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5286e-01
  Total weights = 1.964570803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439477588716
                                         uncertainty =       0.001876739214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439477588716
                                         uncertainty =       0.001876739214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468752291
  error estimate for blocks of size 2^( 2) =       0.000494423164
  error estimate for blocks of size 2^( 3) =       0.000518458388
  error estimate for blocks of size 2^( 4) =       0.000536960862
  error estimate for blocks of size 2^( 5) =       0.000548535982
  error estimate for blocks of size 2^( 6) =       0.000552768970
  error estimate for blocks of size 2^( 7) =       0.000557989673

      target function =      -0.742991130142
              le_mean =     -22.814976213411
             les_mean =     520.975998097489
             stat err =       0.000549063872
             autocorr =       1.372015221292
   target nu stat err =       0.000549063872
   target dn stat err =       0.003040438717
      target stat err =       0.002570435367
              std dev =       0.662915847256
             le_variance =       0.439457420544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497621341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742999138816       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742999631654       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742999694667       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742999716791       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742999724085       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742999726054       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742999726870       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742999726681       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742999726588       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 5.124133e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742999138816       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742999262106       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742999277865       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742999283397       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742999285220       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742999285712       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742999285916       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742999285868       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742999285845       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.281484e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742999138816       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742999169643       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742999173583       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742999174967       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742999175422       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742999175545       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742999175596       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742999175584       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742999175581       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 3.203992e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0044e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_01                 1.080381e-01 3 1  ON 0
ci_02                -2.400802e-02 3 1  ON 1
ci_03                -2.428385e-02 3 1  ON 2
ci_04                 2.216039e-02 3 1  ON 3
ci_05                -1.913293e-02 3 1  ON 4
ci_06                -1.952913e-02 3 1  ON 5
ci_07                 2.575729e-02 3 1  ON 6
ci_08                -4.225716e-03 3 1  ON 7
ci_09                -7.550011e-03 3 1  ON 8
ci_10                -7.705647e-03 3 1  ON 9
ci_11                 1.374768e-02 3 1  ON 10
ci_12                 7.046238e-03 3 1  ON 11
ci_13                 1.381447e-02 3 1  ON 12
ci_14                 1.281207e-02 3 1  ON 13
ci_15                 5.170597e-03 3 1  ON 14
ci_16                 5.732030e-03 3 1  ON 15
ci_17                -5.019759e-03 3 1  ON 16
ci_18                -5.546660e-03 3 1  ON 17
ci_19                 1.032872e-02 3 1  ON 18
ci_20                 6.254754e-03 3 1  ON 19
ci_21                 8.484056e-03 3 1  ON 20
ci_22                 8.881190e-03 3 1  ON 21
ci_23                 4.170688e-03 3 1  ON 22
ci_24                 5.186234e-03 3 1  ON 23
ci_25                 3.011853e-03 3 1  ON 24
ci_26                 3.792382e-03 3 1  ON 25
ci_27                 3.289068e-03 3 1  ON 26
ci_28                 7.720616e-04 3 1  ON 27
ci_29                 1.187171e-03 3 1  ON 28
ci_30                -7.403847e-04 3 1  ON 29
ci_31                 1.032396e-03 3 1  ON 30
ci_32                -5.375273e-04 3 1  ON 31
ci_33                -1.034138e-03 3 1  ON 32
ci_34                 1.151947e-03 3 1  ON 33
ci_35                 1.248726e-03 3 1  ON 34
ci_36                -5.669166e-04 3 1  ON 35
ci_37                -5.191072e-04 3 1  ON 36
ci_38                -2.865242e-04 3 1  ON 37
ci_39                -1.423433e-04 3 1  ON 38
ci_40                -1.904147e-03 3 1  ON 39
ci_41                -5.146665e-04 3 1  ON 40
ci_42                -1.647630e-03 3 1  ON 41
ci_43                -1.294426e-03 3 1  ON 42
ci_44                -2.176425e-03 3 1  ON 43
ci_45                -2.660213e-04 3 1  ON 44
ci_46                -1.691803e-03 3 1  ON 45
ci_47                 1.436032e-03 3 1  ON 46
ci_48                 2.891639e-03 3 1  ON 47
ci_49                -8.542695e-04 3 1  ON 48
ci_50                -8.201936e-04 3 1  ON 49
ci_51                -5.665346e-04 3 1  ON 50
ci_52                -6.299496e-04 3 1  ON 51
ci_53                -8.014494e-04 3 1  ON 52
ci_54                -1.109330e-03 3 1  ON 53
ci_55                -1.236045e-03 3 1  ON 54
ci_56                 1.100177e-03 3 1  ON 55
ci_57                 2.088925e-03 3 1  ON 56
ci_58                -1.867418e-04 3 1  ON 57
ci_59                -6.203229e-04 3 1  ON 58
ci_60                 1.276609e-04 3 1  ON 59
ci_61                -9.879171e-04 3 1  ON 60
ci_62                -3.816431e-04 3 1  ON 61
ci_63                -2.472659e-04 3 1  ON 62
ci_64                -6.084548e-04 3 1  ON 63
ci_65                -1.071860e-04 3 1  ON 64
ci_66                -1.265106e-04 3 1  ON 65
ci_67                -1.934108e-04 3 1  ON 66
ci_68                -1.797301e-03 3 1  ON 67
ci_69                -1.807000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7621
    reference variance = 0.488671
====================================================
  Execution time = 2.4940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5005e-01
  Total weights = 1.9648e+06
  Execution time = 3.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448527645
                                         uncertainty =       0.002173411643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448527645
                                         uncertainty =       0.002173411643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467688258
  error estimate for blocks of size 2^( 2) =       0.000493343133
  error estimate for blocks of size 2^( 3) =       0.000517938566
  error estimate for blocks of size 2^( 4) =       0.000536803629
  error estimate for blocks of size 2^( 5) =       0.000549738445
  error estimate for blocks of size 2^( 6) =       0.000557464982
  error estimate for blocks of size 2^( 7) =       0.000560256594

      target function =      -0.745305906890
              le_mean =     -22.814215391547
             les_mean =     520.938472688054
             stat err =       0.000551065913
             autocorr =       1.388334644939
   target nu stat err =       0.000551065913
   target dn stat err =       0.002826162018
      target stat err =       0.002412070055
              std dev =       0.661411078084
             le_variance =       0.437464614212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448485161
                                         uncertainty =       0.002173398699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448485161
                                         uncertainty =       0.002173398699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467688242
  error estimate for blocks of size 2^( 2) =       0.000493342824
  error estimate for blocks of size 2^( 3) =       0.000517937949
  error estimate for blocks of size 2^( 4) =       0.000536802819
  error estimate for blocks of size 2^( 5) =       0.000549737454
  error estimate for blocks of size 2^( 6) =       0.000557463905
  error estimate for blocks of size 2^( 7) =       0.000560255404

      target function =      -0.745302651729
              le_mean =     -22.814215391807
             les_mean =     520.938476640810
             stat err =       0.000551064895
             autocorr =       1.388329617727
   target nu stat err =       0.000551064895
   target dn stat err =       0.002826407073
      target stat err =       0.002412245129
              std dev =       0.661411054747
             le_variance =       0.437464583342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448506060
                                         uncertainty =       0.002173405164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448506060
                                         uncertainty =       0.002173405164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467688250
  error estimate for blocks of size 2^( 2) =       0.000493342978
  error estimate for blocks of size 2^( 3) =       0.000517938257
  error estimate for blocks of size 2^( 4) =       0.000536803224
  error estimate for blocks of size 2^( 5) =       0.000549737949
  error estimate for blocks of size 2^( 6) =       0.000557464443
  error estimate for blocks of size 2^( 7) =       0.000560255998

      target function =      -0.745304624730
              le_mean =     -22.814215391623
             les_mean =     520.938474243631
             stat err =       0.000551065404
             autocorr =       1.388332130470
   target nu stat err =       0.000551065404
   target dn stat err =       0.002826283972
      target stat err =       0.002412159298
              std dev =       0.661411066159
             le_variance =       0.437464598437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448524911
                                         uncertainty =       0.002173410832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437448524911
                                         uncertainty =       0.002173410832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467688257
  error estimate for blocks of size 2^( 2) =       0.000493343113
  error estimate for blocks of size 2^( 3) =       0.000517938527
  error estimate for blocks of size 2^( 4) =       0.000536803579
  error estimate for blocks of size 2^( 5) =       0.000549738383
  error estimate for blocks of size 2^( 6) =       0.000557464915
  error estimate for blocks of size 2^( 7) =       0.000560256519

      target function =      -0.745305773134
              le_mean =     -22.814215391552
             les_mean =     520.938472850171
             stat err =       0.000551065849
             autocorr =       1.388334330631
   target nu stat err =       0.000551065849
   target dn stat err =       0.002826177209
      target stat err =       0.002412081333
              std dev =       0.661411076566
             le_variance =       0.437464612204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745305906890        initial  <--
     5.8208e+01     5.8208e+02             5.1241e-06        -0.745302651729
     2.3283e+02     2.3283e+03             1.2815e-06        -0.745304624730
     9.3132e+02     9.3132e+03             3.2040e-07        -0.745305773134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9780
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_01                 1.080368e-01 3 1  ON 0
ci_02                -2.400715e-02 3 1  ON 1
ci_03                -2.428293e-02 3 1  ON 2
ci_04                 2.215987e-02 3 1  ON 3
ci_05                -1.913291e-02 3 1  ON 4
ci_06                -1.952842e-02 3 1  ON 5
ci_07                 2.575724e-02 3 1  ON 6
ci_08                -4.225533e-03 3 1  ON 7
ci_09                -7.549960e-03 3 1  ON 8
ci_10                -7.705669e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046657e-03 3 1  ON 11
ci_13                 1.381479e-02 3 1  ON 12
ci_14                 1.281195e-02 3 1  ON 13
ci_15                 5.170576e-03 3 1  ON 14
ci_16                 5.731902e-03 3 1  ON 15
ci_17                -5.019666e-03 3 1  ON 16
ci_18                -5.546376e-03 3 1  ON 17
ci_19                 1.032885e-02 3 1  ON 18
ci_20                 6.254854e-03 3 1  ON 19
ci_21                 8.484001e-03 3 1  ON 20
ci_22                 8.881317e-03 3 1  ON 21
ci_23                 4.170584e-03 3 1  ON 22
ci_24                 5.186368e-03 3 1  ON 23
ci_25                 3.012231e-03 3 1  ON 24
ci_26                 3.792868e-03 3 1  ON 25
ci_27                 3.289059e-03 3 1  ON 26
ci_28                 7.716845e-04 3 1  ON 27
ci_29                 1.187040e-03 3 1  ON 28
ci_30                -7.402248e-04 3 1  ON 29
ci_31                 1.032692e-03 3 1  ON 30
ci_32                -5.374347e-04 3 1  ON 31
ci_33                -1.033901e-03 3 1  ON 32
ci_34                 1.151934e-03 3 1  ON 33
ci_35                 1.248856e-03 3 1  ON 34
ci_36                -5.665105e-04 3 1  ON 35
ci_37                -5.189590e-04 3 1  ON 36
ci_38                -2.863442e-04 3 1  ON 37
ci_39                -1.422769e-04 3 1  ON 38
ci_40                -1.904513e-03 3 1  ON 39
ci_41                -5.143974e-04 3 1  ON 40
ci_42                -1.647805e-03 3 1  ON 41
ci_43                -1.294452e-03 3 1  ON 42
ci_44                -2.176251e-03 3 1  ON 43
ci_45                -2.658812e-04 3 1  ON 44
ci_46                -1.692280e-03 3 1  ON 45
ci_47                 1.435731e-03 3 1  ON 46
ci_48                 2.891927e-03 3 1  ON 47
ci_49                -8.542297e-04 3 1  ON 48
ci_50                -8.199991e-04 3 1  ON 49
ci_51                -5.667106e-04 3 1  ON 50
ci_52                -6.303599e-04 3 1  ON 51
ci_53                -8.013504e-04 3 1  ON 52
ci_54                -1.109212e-03 3 1  ON 53
ci_55                -1.235878e-03 3 1  ON 54
ci_56                 1.099776e-03 3 1  ON 55
ci_57                 2.088945e-03 3 1  ON 56
ci_58                -1.864433e-04 3 1  ON 57
ci_59                -6.201209e-04 3 1  ON 58
ci_60                 1.278101e-04 3 1  ON 59
ci_61                -9.881433e-04 3 1  ON 60
ci_62                -3.818042e-04 3 1  ON 61
ci_63                -2.473335e-04 3 1  ON 62
ci_64                -6.085936e-04 3 1  ON 63
ci_65                -1.069123e-04 3 1  ON 64
ci_66                -1.263059e-04 3 1  ON 65
ci_67                -1.931942e-04 3 1  ON 66
ci_68                -1.797461e-03 3 1  ON 67
ci_69                -1.807140e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8206
    reference variance = 0.2897
====================================================
  Execution time = 2.5604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4518e-01
  Total weights = 1.964900631e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432790122785
                                         uncertainty =       0.002112547063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432790122785
                                         uncertainty =       0.002112547063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465167906
  error estimate for blocks of size 2^( 2) =       0.000491075757
  error estimate for blocks of size 2^( 3) =       0.000515601606
  error estimate for blocks of size 2^( 4) =       0.000534735584
  error estimate for blocks of size 2^( 5) =       0.000547145427
  error estimate for blocks of size 2^( 6) =       0.000553789163
  error estimate for blocks of size 2^( 7) =       0.000558275969

      target function =      -0.749339206634
              le_mean =     -22.813452386466
             les_mean =     520.898792535761
             stat err =       0.000548486536
             autocorr =       1.390312588919
   target nu stat err =       0.000548486536
   target dn stat err =       0.002559655190
      target stat err =       0.002219530629
              std dev =       0.657846761622
             le_variance =       0.432762361776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281345238647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749344770511       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749344814068       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749344819313       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749344820816       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749344821484       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749344821748       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749344821845       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749344821849       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749344821854       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749344821852       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 4.424294e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749344770511       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749344781401       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749344782712       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749344783092       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749344783255       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749344783321       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749344783345       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749344783346       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749344783347       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749344783347       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.106113e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749344770511       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749344773233       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749344773561       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749344773640       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749344773711       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749344773690       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749344773719       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749344773703       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749344773720       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749344773723       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 2.765308e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0129e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_01                 1.080369e-01 3 1  ON 0
ci_02                -2.400724e-02 3 1  ON 1
ci_03                -2.428298e-02 3 1  ON 2
ci_04                 2.215993e-02 3 1  ON 3
ci_05                -1.913296e-02 3 1  ON 4
ci_06                -1.952844e-02 3 1  ON 5
ci_07                 2.575724e-02 3 1  ON 6
ci_08                -4.225534e-03 3 1  ON 7
ci_09                -7.549987e-03 3 1  ON 8
ci_10                -7.705631e-03 3 1  ON 9
ci_11                 1.374775e-02 3 1  ON 10
ci_12                 7.046670e-03 3 1  ON 11
ci_13                 1.381481e-02 3 1  ON 12
ci_14                 1.281193e-02 3 1  ON 13
ci_15                 5.170595e-03 3 1  ON 14
ci_16                 5.731912e-03 3 1  ON 15
ci_17                -5.019641e-03 3 1  ON 16
ci_18                -5.546348e-03 3 1  ON 17
ci_19                 1.032885e-02 3 1  ON 18
ci_20                 6.254855e-03 3 1  ON 19
ci_21                 8.483966e-03 3 1  ON 20
ci_22                 8.881329e-03 3 1  ON 21
ci_23                 4.170592e-03 3 1  ON 22
ci_24                 5.186374e-03 3 1  ON 23
ci_25                 3.012216e-03 3 1  ON 24
ci_26                 3.792843e-03 3 1  ON 25
ci_27                 3.289054e-03 3 1  ON 26
ci_28                 7.716970e-04 3 1  ON 27
ci_29                 1.187044e-03 3 1  ON 28
ci_30                -7.402025e-04 3 1  ON 29
ci_31                 1.032710e-03 3 1  ON 30
ci_32                -5.374356e-04 3 1  ON 31
ci_33                -1.033917e-03 3 1  ON 32
ci_34                 1.151966e-03 3 1  ON 33
ci_35                 1.248867e-03 3 1  ON 34
ci_36                -5.665388e-04 3 1  ON 35
ci_37                -5.189434e-04 3 1  ON 36
ci_38                -2.863391e-04 3 1  ON 37
ci_39                -1.422900e-04 3 1  ON 38
ci_40                -1.904480e-03 3 1  ON 39
ci_41                -5.144199e-04 3 1  ON 40
ci_42                -1.647758e-03 3 1  ON 41
ci_43                -1.294473e-03 3 1  ON 42
ci_44                -2.176243e-03 3 1  ON 43
ci_45                -2.658853e-04 3 1  ON 44
ci_46                -1.692250e-03 3 1  ON 45
ci_47                 1.435735e-03 3 1  ON 46
ci_48                 2.891914e-03 3 1  ON 47
ci_49                -8.542414e-04 3 1  ON 48
ci_50                -8.199968e-04 3 1  ON 49
ci_51                -5.666660e-04 3 1  ON 50
ci_52                -6.303356e-04 3 1  ON 51
ci_53                -8.013634e-04 3 1  ON 52
ci_54                -1.109187e-03 3 1  ON 53
ci_55                -1.235869e-03 3 1  ON 54
ci_56                 1.099815e-03 3 1  ON 55
ci_57                 2.088938e-03 3 1  ON 56
ci_58                -1.864314e-04 3 1  ON 57
ci_59                -6.201319e-04 3 1  ON 58
ci_60                 1.278078e-04 3 1  ON 59
ci_61                -9.881345e-04 3 1  ON 60
ci_62                -3.817917e-04 3 1  ON 61
ci_63                -2.473440e-04 3 1  ON 62
ci_64                -6.085790e-04 3 1  ON 63
ci_65                -1.069051e-04 3 1  ON 64
ci_66                -1.262973e-04 3 1  ON 65
ci_67                -1.932134e-04 3 1  ON 66
ci_68                -1.797455e-03 3 1  ON 67
ci_69                -1.807108e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8617
    reference variance = 0.326735
====================================================
  Execution time = 2.4876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4908e-01
  Total weights = 1.9649e+06
  Execution time = 3.5011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289749093
                                         uncertainty =       0.002066011530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289749093
                                         uncertainty =       0.002066011530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467040971
  error estimate for blocks of size 2^( 2) =       0.000492785059
  error estimate for blocks of size 2^( 3) =       0.000517044613
  error estimate for blocks of size 2^( 4) =       0.000535597814
  error estimate for blocks of size 2^( 5) =       0.000547617415
  error estimate for blocks of size 2^( 6) =       0.000555066495
  error estimate for blocks of size 2^( 7) =       0.000557995391

      target function =      -0.746105634850
              le_mean =     -22.813773130629
             les_mean =     520.917324089603
             stat err =       0.000549069279
             autocorr =       1.382115474934
   target nu stat err =       0.000549069279
   target dn stat err =       0.002669644395
      target stat err =       0.002289916139
              std dev =       0.660495674723
             le_variance =       0.436254536327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289727257
                                         uncertainty =       0.002066014601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289727257
                                         uncertainty =       0.002066014601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467040959
  error estimate for blocks of size 2^( 2) =       0.000492785021
  error estimate for blocks of size 2^( 3) =       0.000517044549
  error estimate for blocks of size 2^( 4) =       0.000535597730
  error estimate for blocks of size 2^( 5) =       0.000547617321
  error estimate for blocks of size 2^( 6) =       0.000555066392
  error estimate for blocks of size 2^( 7) =       0.000557995286

      target function =      -0.746105584093
              le_mean =     -22.813773134345
             les_mean =     520.917324320572
             stat err =       0.000549069182
             autocorr =       1.382115058667
   target nu stat err =       0.000549069182
   target dn stat err =       0.002669641521
      target stat err =       0.002289913532
              std dev =       0.660495658084
             le_variance =       0.436254514347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289738172
                                         uncertainty =       0.002066013065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289738172
                                         uncertainty =       0.002066013065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467040965
  error estimate for blocks of size 2^( 2) =       0.000492785040
  error estimate for blocks of size 2^( 3) =       0.000517044581
  error estimate for blocks of size 2^( 4) =       0.000535597772
  error estimate for blocks of size 2^( 5) =       0.000547617368
  error estimate for blocks of size 2^( 6) =       0.000555066444
  error estimate for blocks of size 2^( 7) =       0.000557995338

      target function =      -0.746105609526
              le_mean =     -22.813773132487
             les_mean =     520.917324205010
             stat err =       0.000549069230
             autocorr =       1.382115266795
   target nu stat err =       0.000549069230
   target dn stat err =       0.002669642957
      target stat err =       0.002289914835
              std dev =       0.660495666401
             le_variance =       0.436254525335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289747727
                                         uncertainty =       0.002066011722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436289747727
                                         uncertainty =       0.002066011722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467040970
  error estimate for blocks of size 2^( 2) =       0.000492785057
  error estimate for blocks of size 2^( 3) =       0.000517044609
  error estimate for blocks of size 2^( 4) =       0.000535597808
  error estimate for blocks of size 2^( 5) =       0.000547617410
  error estimate for blocks of size 2^( 6) =       0.000555066489
  error estimate for blocks of size 2^( 7) =       0.000557995384

      target function =      -0.746105631691
              le_mean =     -22.813773130861
             les_mean =     520.917324104020
             stat err =       0.000549069273
             autocorr =       1.382115448912
   target nu stat err =       0.000549069273
   target dn stat err =       0.002669644216
      target stat err =       0.002289915976
              std dev =       0.660495673682
             le_variance =       0.436254534953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746105634850        initial  <--
     5.8208e+02     5.8208e+03             4.4243e-07        -0.746105584093
     2.3283e+03     2.3283e+04             1.1061e-07        -0.746105609526
     9.3132e+03     9.3132e+04             2.7653e-08        -0.746105631691

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5053
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_01                 1.080368e-01 3 1  ON 0
ci_02                -2.400715e-02 3 1  ON 1
ci_03                -2.428293e-02 3 1  ON 2
ci_04                 2.215987e-02 3 1  ON 3
ci_05                -1.913291e-02 3 1  ON 4
ci_06                -1.952842e-02 3 1  ON 5
ci_07                 2.575724e-02 3 1  ON 6
ci_08                -4.225533e-03 3 1  ON 7
ci_09                -7.549960e-03 3 1  ON 8
ci_10                -7.705669e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046657e-03 3 1  ON 11
ci_13                 1.381479e-02 3 1  ON 12
ci_14                 1.281195e-02 3 1  ON 13
ci_15                 5.170576e-03 3 1  ON 14
ci_16                 5.731902e-03 3 1  ON 15
ci_17                -5.019666e-03 3 1  ON 16
ci_18                -5.546376e-03 3 1  ON 17
ci_19                 1.032885e-02 3 1  ON 18
ci_20                 6.254854e-03 3 1  ON 19
ci_21                 8.484001e-03 3 1  ON 20
ci_22                 8.881317e-03 3 1  ON 21
ci_23                 4.170584e-03 3 1  ON 22
ci_24                 5.186368e-03 3 1  ON 23
ci_25                 3.012231e-03 3 1  ON 24
ci_26                 3.792868e-03 3 1  ON 25
ci_27                 3.289059e-03 3 1  ON 26
ci_28                 7.716845e-04 3 1  ON 27
ci_29                 1.187040e-03 3 1  ON 28
ci_30                -7.402248e-04 3 1  ON 29
ci_31                 1.032692e-03 3 1  ON 30
ci_32                -5.374347e-04 3 1  ON 31
ci_33                -1.033901e-03 3 1  ON 32
ci_34                 1.151934e-03 3 1  ON 33
ci_35                 1.248856e-03 3 1  ON 34
ci_36                -5.665105e-04 3 1  ON 35
ci_37                -5.189590e-04 3 1  ON 36
ci_38                -2.863442e-04 3 1  ON 37
ci_39                -1.422769e-04 3 1  ON 38
ci_40                -1.904513e-03 3 1  ON 39
ci_41                -5.143974e-04 3 1  ON 40
ci_42                -1.647805e-03 3 1  ON 41
ci_43                -1.294452e-03 3 1  ON 42
ci_44                -2.176251e-03 3 1  ON 43
ci_45                -2.658812e-04 3 1  ON 44
ci_46                -1.692280e-03 3 1  ON 45
ci_47                 1.435731e-03 3 1  ON 46
ci_48                 2.891927e-03 3 1  ON 47
ci_49                -8.542297e-04 3 1  ON 48
ci_50                -8.199991e-04 3 1  ON 49
ci_51                -5.667106e-04 3 1  ON 50
ci_52                -6.303599e-04 3 1  ON 51
ci_53                -8.013504e-04 3 1  ON 52
ci_54                -1.109212e-03 3 1  ON 53
ci_55                -1.235878e-03 3 1  ON 54
ci_56                 1.099776e-03 3 1  ON 55
ci_57                 2.088945e-03 3 1  ON 56
ci_58                -1.864433e-04 3 1  ON 57
ci_59                -6.201209e-04 3 1  ON 58
ci_60                 1.278101e-04 3 1  ON 59
ci_61                -9.881433e-04 3 1  ON 60
ci_62                -3.818042e-04 3 1  ON 61
ci_63                -2.473335e-04 3 1  ON 62
ci_64                -6.085936e-04 3 1  ON 63
ci_65                -1.069123e-04 3 1  ON 64
ci_66                -1.263059e-04 3 1  ON 65
ci_67                -1.931942e-04 3 1  ON 66
ci_68                -1.797461e-03 3 1  ON 67
ci_69                -1.807140e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2641e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8818
    reference variance = 0.395318
====================================================
  Execution time = 2.5665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5389e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4411e-01
  Total weights = 1.964821465e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433879360312
                                         uncertainty =       0.001710861071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433879360312
                                         uncertainty =       0.001710861071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465788982
  error estimate for blocks of size 2^( 2) =       0.000491406808
  error estimate for blocks of size 2^( 3) =       0.000515627813
  error estimate for blocks of size 2^( 4) =       0.000534180232
  error estimate for blocks of size 2^( 5) =       0.000545996447
  error estimate for blocks of size 2^( 6) =       0.000551657315
  error estimate for blocks of size 2^( 7) =       0.000555639584

      target function =      -0.750251715117
              le_mean =     -22.814786673765
             les_mean =     520.958599592893
             stat err =       0.000546868394
             autocorr =       1.378437967603
   target nu stat err =       0.000546868394
   target dn stat err =       0.002169928896
      target stat err =       0.001916861072
              std dev =       0.658725095056
             le_variance =       0.433918750857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281478667376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750255645355       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750255648590       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750255649267       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750255649478       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750255649564       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750255649570       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750255649560       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750255649570       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750255649561       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 6.857193e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750255645355       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750255646164       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750255646333       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750255646386       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750255646406       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750255646399       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750255646443       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750255646384       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750255646385       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 1.714304e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750255645355       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750255645557       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750255645600       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750255645610       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750255645655       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750255645579       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750255645613       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750255645650       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750255645647       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 4.285764e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0159e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_01                 1.080368e-01 3 1  ON 0
ci_02                -2.400715e-02 3 1  ON 1
ci_03                -2.428293e-02 3 1  ON 2
ci_04                 2.215988e-02 3 1  ON 3
ci_05                -1.913292e-02 3 1  ON 4
ci_06                -1.952842e-02 3 1  ON 5
ci_07                 2.575725e-02 3 1  ON 6
ci_08                -4.225533e-03 3 1  ON 7
ci_09                -7.549961e-03 3 1  ON 8
ci_10                -7.705665e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046656e-03 3 1  ON 11
ci_13                 1.381479e-02 3 1  ON 12
ci_14                 1.281195e-02 3 1  ON 13
ci_15                 5.170577e-03 3 1  ON 14
ci_16                 5.731903e-03 3 1  ON 15
ci_17                -5.019664e-03 3 1  ON 16
ci_18                -5.546376e-03 3 1  ON 17
ci_19                 1.032885e-02 3 1  ON 18
ci_20                 6.254852e-03 3 1  ON 19
ci_21                 8.484000e-03 3 1  ON 20
ci_22                 8.881318e-03 3 1  ON 21
ci_23                 4.170584e-03 3 1  ON 22
ci_24                 5.186366e-03 3 1  ON 23
ci_25                 3.012231e-03 3 1  ON 24
ci_26                 3.792866e-03 3 1  ON 25
ci_27                 3.289059e-03 3 1  ON 26
ci_28                 7.716858e-04 3 1  ON 27
ci_29                 1.187041e-03 3 1  ON 28
ci_30                -7.402251e-04 3 1  ON 29
ci_31                 1.032690e-03 3 1  ON 30
ci_32                -5.374348e-04 3 1  ON 31
ci_33                -1.033901e-03 3 1  ON 32
ci_34                 1.151935e-03 3 1  ON 33
ci_35                 1.248858e-03 3 1  ON 34
ci_36                -5.665109e-04 3 1  ON 35
ci_37                -5.189609e-04 3 1  ON 36
ci_38                -2.863453e-04 3 1  ON 37
ci_39                -1.422763e-04 3 1  ON 38
ci_40                -1.904510e-03 3 1  ON 39
ci_41                -5.143998e-04 3 1  ON 40
ci_42                -1.647802e-03 3 1  ON 41
ci_43                -1.294454e-03 3 1  ON 42
ci_44                -2.176252e-03 3 1  ON 43
ci_45                -2.658816e-04 3 1  ON 44
ci_46                -1.692279e-03 3 1  ON 45
ci_47                 1.435733e-03 3 1  ON 46
ci_48                 2.891928e-03 3 1  ON 47
ci_49                -8.542296e-04 3 1  ON 48
ci_50                -8.199971e-04 3 1  ON 49
ci_51                -5.667096e-04 3 1  ON 50
ci_52                -6.303580e-04 3 1  ON 51
ci_53                -8.013504e-04 3 1  ON 52
ci_54                -1.109213e-03 3 1  ON 53
ci_55                -1.235879e-03 3 1  ON 54
ci_56                 1.099778e-03 3 1  ON 55
ci_57                 2.088946e-03 3 1  ON 56
ci_58                -1.864452e-04 3 1  ON 57
ci_59                -6.201205e-04 3 1  ON 58
ci_60                 1.278119e-04 3 1  ON 59
ci_61                -9.881409e-04 3 1  ON 60
ci_62                -3.818034e-04 3 1  ON 61
ci_63                -2.473345e-04 3 1  ON 62
ci_64                -6.085937e-04 3 1  ON 63
ci_65                -1.069118e-04 3 1  ON 64
ci_66                -1.263072e-04 3 1  ON 65
ci_67                -1.931938e-04 3 1  ON 66
ci_68                -1.797461e-03 3 1  ON 67
ci_69                -1.807141e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.9045
    reference variance = 0.486708
====================================================
  Execution time = 2.5033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5436e-01
  Total weights = 1.9647e+06
  Execution time = 3.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448452370
                                         uncertainty =       0.002800718387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448452370
                                         uncertainty =       0.002800718387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468279039
  error estimate for blocks of size 2^( 2) =       0.000494329551
  error estimate for blocks of size 2^( 3) =       0.000518524399
  error estimate for blocks of size 2^( 4) =       0.000537467149
  error estimate for blocks of size 2^( 5) =       0.000549691184
  error estimate for blocks of size 2^( 6) =       0.000554748422
  error estimate for blocks of size 2^( 7) =       0.000558779112

      target function =      -0.741750244311
              le_mean =     -22.814816301041
             les_mean =     520.970205673886
             stat err =       0.000550171467
             autocorr =       1.380341959021
   target nu stat err =       0.000550171467
   target dn stat err =       0.004238741805
      target stat err =       0.003522431442
              std dev =       0.662246567471
             le_variance =       0.438570516127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448450653
                                         uncertainty =       0.002800718173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448450653
                                         uncertainty =       0.002800718173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468279038
  error estimate for blocks of size 2^( 2) =       0.000494329547
  error estimate for blocks of size 2^( 3) =       0.000518524393
  error estimate for blocks of size 2^( 4) =       0.000537467140
  error estimate for blocks of size 2^( 5) =       0.000549691174
  error estimate for blocks of size 2^( 6) =       0.000554748412
  error estimate for blocks of size 2^( 7) =       0.000558779103

      target function =      -0.741750258949
              le_mean =     -22.814816300830
             les_mean =     520.970205646404
             stat err =       0.000550171457
             autocorr =       1.380341917357
   target nu stat err =       0.000550171457
   target dn stat err =       0.004238741941
      target stat err =       0.003522431686
              std dev =       0.662246566166
             le_variance =       0.438570514399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448451511
                                         uncertainty =       0.002800718280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448451511
                                         uncertainty =       0.002800718280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468279038
  error estimate for blocks of size 2^( 2) =       0.000494329549
  error estimate for blocks of size 2^( 3) =       0.000518524396
  error estimate for blocks of size 2^( 4) =       0.000537467145
  error estimate for blocks of size 2^( 5) =       0.000549691179
  error estimate for blocks of size 2^( 6) =       0.000554748417
  error estimate for blocks of size 2^( 7) =       0.000558779107

      target function =      -0.741750251633
              le_mean =     -22.814816300935
             les_mean =     520.970205660140
             stat err =       0.000550171462
             autocorr =       1.380341938187
   target nu stat err =       0.000550171462
   target dn stat err =       0.004238741873
      target stat err =       0.003522431564
              std dev =       0.662246566818
             le_variance =       0.438570515263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448452262
                                         uncertainty =       0.002800718374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438448452262
                                         uncertainty =       0.002800718374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468279039
  error estimate for blocks of size 2^( 2) =       0.000494329550
  error estimate for blocks of size 2^( 3) =       0.000518524399
  error estimate for blocks of size 2^( 4) =       0.000537467148
  error estimate for blocks of size 2^( 5) =       0.000549691183
  error estimate for blocks of size 2^( 6) =       0.000554748421
  error estimate for blocks of size 2^( 7) =       0.000558779111

      target function =      -0.741750245227
              le_mean =     -22.814816301027
             les_mean =     520.970205672167
             stat err =       0.000550171466
             autocorr =       1.380341956428
   target nu stat err =       0.000550171466
   target dn stat err =       0.004238741813
      target stat err =       0.003522431457
              std dev =       0.662246567389
             le_variance =       0.438570516019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741750244311        initial
     5.8208e+03     5.8208e+04             6.8572e-08        -0.741750258949  <--
     2.3283e+04     2.3283e+05             1.7143e-08        -0.741750251633
     9.3132e+04     9.3132e+05             4.2858e-09        -0.741750245227

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 4.6808e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_01                 1.080369e-01 3 1  ON 0
ci_02                -2.400717e-02 3 1  ON 1
ci_03                -2.428295e-02 3 1  ON 2
ci_04                 2.215990e-02 3 1  ON 3
ci_05                -1.913293e-02 3 1  ON 4
ci_06                -1.952842e-02 3 1  ON 5
ci_07                 2.575725e-02 3 1  ON 6
ci_08                -4.225534e-03 3 1  ON 7
ci_09                -7.549964e-03 3 1  ON 8
ci_10                -7.705655e-03 3 1  ON 9
ci_11                 1.374775e-02 3 1  ON 10
ci_12                 7.046652e-03 3 1  ON 11
ci_13                 1.381479e-02 3 1  ON 12
ci_14                 1.281195e-02 3 1  ON 13
ci_15                 5.170579e-03 3 1  ON 14
ci_16                 5.731906e-03 3 1  ON 15
ci_17                -5.019661e-03 3 1  ON 16
ci_18                -5.546376e-03 3 1  ON 17
ci_19                 1.032884e-02 3 1  ON 18
ci_20                 6.254847e-03 3 1  ON 19
ci_21                 8.483999e-03 3 1  ON 20
ci_22                 8.881319e-03 3 1  ON 21
ci_23                 4.170581e-03 3 1  ON 22
ci_24                 5.186361e-03 3 1  ON 23
ci_25                 3.012232e-03 3 1  ON 24
ci_26                 3.792859e-03 3 1  ON 25
ci_27                 3.289060e-03 3 1  ON 26
ci_28                 7.716897e-04 3 1  ON 27
ci_29                 1.187046e-03 3 1  ON 28
ci_30                -7.402257e-04 3 1  ON 29
ci_31                 1.032685e-03 3 1  ON 30
ci_32                -5.374351e-04 3 1  ON 31
ci_33                -1.033901e-03 3 1  ON 32
ci_34                 1.151937e-03 3 1  ON 33
ci_35                 1.248864e-03 3 1  ON 34
ci_36                -5.665123e-04 3 1  ON 35
ci_37                -5.189666e-04 3 1  ON 36
ci_38                -2.863487e-04 3 1  ON 37
ci_39                -1.422745e-04 3 1  ON 38
ci_40                -1.904501e-03 3 1  ON 39
ci_41                -5.144070e-04 3 1  ON 40
ci_42                -1.647794e-03 3 1  ON 41
ci_43                -1.294461e-03 3 1  ON 42
ci_44                -2.176256e-03 3 1  ON 43
ci_45                -2.658830e-04 3 1  ON 44
ci_46                -1.692274e-03 3 1  ON 45
ci_47                 1.435739e-03 3 1  ON 46
ci_48                 2.891929e-03 3 1  ON 47
ci_49                -8.542294e-04 3 1  ON 48
ci_50                -8.199913e-04 3 1  ON 49
ci_51                -5.667068e-04 3 1  ON 50
ci_52                -6.303523e-04 3 1  ON 51
ci_53                -8.013504e-04 3 1  ON 52
ci_54                -1.109214e-03 3 1  ON 53
ci_55                -1.235880e-03 3 1  ON 54
ci_56                 1.099786e-03 3 1  ON 55
ci_57                 2.088948e-03 3 1  ON 56
ci_58                -1.864508e-04 3 1  ON 57
ci_59                -6.201195e-04 3 1  ON 58
ci_60                 1.278170e-04 3 1  ON 59
ci_61                -9.881337e-04 3 1  ON 60
ci_62                -3.818013e-04 3 1  ON 61
ci_63                -2.473374e-04 3 1  ON 62
ci_64                -6.085937e-04 3 1  ON 63
ci_65                -1.069104e-04 3 1  ON 64
ci_66                -1.263108e-04 3 1  ON 65
ci_67                -1.931927e-04 3 1  ON 66
ci_68                -1.797459e-03 3 1  ON 67
ci_69                -1.807142e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7856
    reference variance = 0.319714
====================================================
  Execution time = 2.5681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4575e-01
  Total weights = 1.964517720e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237390855
                                         uncertainty =       0.001741008551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433237390855
                                         uncertainty =       0.001741008551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465430322
  error estimate for blocks of size 2^( 2) =       0.000491205570
  error estimate for blocks of size 2^( 3) =       0.000515133836
  error estimate for blocks of size 2^( 4) =       0.000534111778
  error estimate for blocks of size 2^( 5) =       0.000545000161
  error estimate for blocks of size 2^( 6) =       0.000553421991
  error estimate for blocks of size 2^( 7) =       0.000557351226

      target function =      -0.748874476508
              le_mean =     -22.814423215620
             les_mean =     520.943657317100
             stat err =       0.000547471289
             autocorr =       1.383608909765
   target nu stat err =       0.000547471289
   target dn stat err =       0.002599115272
      target stat err =       0.002251430153
              std dev =       0.658217873650
             le_variance =       0.433250769192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281442321562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748880276107       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748880289484       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748880291547       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748880291819       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748880291947       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748880291973       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748880291977       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748880291974       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748880291971       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748880291973       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 1.541583e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748880276107       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748880279451       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748880279967       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748880280035       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748880280067       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748880280073       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748880280075       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748880280082       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748880280071       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748880280078       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 3.854043e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748880276107       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748880276943       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748880277072       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748880277088       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748880277097       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748880277099       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748880277099       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748880277084       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748880277071       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748880277082       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 9.635161e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0214e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_01                 1.080369e-01 3 1  ON 0
ci_02                -2.400721e-02 3 1  ON 1
ci_03                -2.428298e-02 3 1  ON 2
ci_04                 2.215993e-02 3 1  ON 3
ci_05                -1.913295e-02 3 1  ON 4
ci_06                -1.952843e-02 3 1  ON 5
ci_07                 2.575725e-02 3 1  ON 6
ci_08                -4.225534e-03 3 1  ON 7
ci_09                -7.549951e-03 3 1  ON 8
ci_10                -7.705662e-03 3 1  ON 9
ci_11                 1.374775e-02 3 1  ON 10
ci_12                 7.046655e-03 3 1  ON 11
ci_13                 1.381479e-02 3 1  ON 12
ci_14                 1.281196e-02 3 1  ON 13
ci_15                 5.170586e-03 3 1  ON 14
ci_16                 5.731915e-03 3 1  ON 15
ci_17                -5.019668e-03 3 1  ON 16
ci_18                -5.546391e-03 3 1  ON 17
ci_19                 1.032883e-02 3 1  ON 18
ci_20                 6.254842e-03 3 1  ON 19
ci_21                 8.484000e-03 3 1  ON 20
ci_22                 8.881308e-03 3 1  ON 21
ci_23                 4.170584e-03 3 1  ON 22
ci_24                 5.186357e-03 3 1  ON 23
ci_25                 3.012221e-03 3 1  ON 24
ci_26                 3.792852e-03 3 1  ON 25
ci_27                 3.289054e-03 3 1  ON 26
ci_28                 7.717030e-04 3 1  ON 27
ci_29                 1.187034e-03 3 1  ON 28
ci_30                -7.402248e-04 3 1  ON 29
ci_31                 1.032676e-03 3 1  ON 30
ci_32                -5.374442e-04 3 1  ON 31
ci_33                -1.033908e-03 3 1  ON 32
ci_34                 1.151950e-03 3 1  ON 33
ci_35                 1.248854e-03 3 1  ON 34
ci_36                -5.665130e-04 3 1  ON 35
ci_37                -5.189662e-04 3 1  ON 36
ci_38                -2.863484e-04 3 1  ON 37
ci_39                -1.422768e-04 3 1  ON 38
ci_40                -1.904501e-03 3 1  ON 39
ci_41                -5.144139e-04 3 1  ON 40
ci_42                -1.647796e-03 3 1  ON 41
ci_43                -1.294474e-03 3 1  ON 42
ci_44                -2.176243e-03 3 1  ON 43
ci_45                -2.658834e-04 3 1  ON 44
ci_46                -1.692269e-03 3 1  ON 45
ci_47                 1.435740e-03 3 1  ON 46
ci_48                 2.891915e-03 3 1  ON 47
ci_49                -8.542314e-04 3 1  ON 48
ci_50                -8.199933e-04 3 1  ON 49
ci_51                -5.666939e-04 3 1  ON 50
ci_52                -6.303464e-04 3 1  ON 51
ci_53                -8.013489e-04 3 1  ON 52
ci_54                -1.109219e-03 3 1  ON 53
ci_55                -1.235880e-03 3 1  ON 54
ci_56                 1.099793e-03 3 1  ON 55
ci_57                 2.088951e-03 3 1  ON 56
ci_58                -1.864586e-04 3 1  ON 57
ci_59                -6.201194e-04 3 1  ON 58
ci_60                 1.278069e-04 3 1  ON 59
ci_61                -9.881182e-04 3 1  ON 60
ci_62                -3.818011e-04 3 1  ON 61
ci_63                -2.473351e-04 3 1  ON 62
ci_64                -6.085886e-04 3 1  ON 63
ci_65                -1.069098e-04 3 1  ON 64
ci_66                -1.263148e-04 3 1  ON 65
ci_67                -1.931979e-04 3 1  ON 66
ci_68                -1.797458e-03 3 1  ON 67
ci_69                -1.807119e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8706
    reference variance = 0.4562
====================================================
  Execution time = 2.5122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4492e-01
  Total weights = 1.9648e+06
  Execution time = 3.5169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807465795
                                         uncertainty =       0.001558920804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807465795
                                         uncertainty =       0.001558920804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827316
  error estimate for blocks of size 2^( 2) =       0.000491373768
  error estimate for blocks of size 2^( 3) =       0.000515798108
  error estimate for blocks of size 2^( 4) =       0.000534541798
  error estimate for blocks of size 2^( 5) =       0.000545046050
  error estimate for blocks of size 2^( 6) =       0.000550327569
  error estimate for blocks of size 2^( 7) =       0.000559578357

      target function =      -0.749572975281
              le_mean =     -22.815182855966
             les_mean =     520.977492024079
             stat err =       0.000547373444
             autocorr =       1.380757920085
   target nu stat err =       0.000547373444
   target dn stat err =       0.002302136279
      target stat err =       0.002019986506
              std dev =       0.658779307843
             le_variance =       0.433990176442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807449856
                                         uncertainty =       0.001558920516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807449856
                                         uncertainty =       0.001558920516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827307
  error estimate for blocks of size 2^( 2) =       0.000491373748
  error estimate for blocks of size 2^( 3) =       0.000515798076
  error estimate for blocks of size 2^( 4) =       0.000534541758
  error estimate for blocks of size 2^( 5) =       0.000545046007
  error estimate for blocks of size 2^( 6) =       0.000550327527
  error estimate for blocks of size 2^( 7) =       0.000559578317

      target function =      -0.749573018986
              le_mean =     -22.815182856210
             les_mean =     520.977491982955
             stat err =       0.000547373402
             autocorr =       1.380757762368
   target nu stat err =       0.000547373402
   target dn stat err =       0.002302129901
      target stat err =       0.002019981633
              std dev =       0.658779295630
             le_variance =       0.433990160351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807457825
                                         uncertainty =       0.001558920660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807457825
                                         uncertainty =       0.001558920660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827312
  error estimate for blocks of size 2^( 2) =       0.000491373758
  error estimate for blocks of size 2^( 3) =       0.000515798092
  error estimate for blocks of size 2^( 4) =       0.000534541778
  error estimate for blocks of size 2^( 5) =       0.000545046028
  error estimate for blocks of size 2^( 6) =       0.000550327548
  error estimate for blocks of size 2^( 7) =       0.000559578337

      target function =      -0.749572997146
              le_mean =     -22.815182856088
             les_mean =     520.977492003500
             stat err =       0.000547373423
             autocorr =       1.380757841228
   target nu stat err =       0.000547373423
   target dn stat err =       0.002302133089
      target stat err =       0.002019984069
              std dev =       0.658779301736
             le_variance =       0.433990168396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807464798
                                         uncertainty =       0.001558920786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433807464798
                                         uncertainty =       0.001558920786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465827315
  error estimate for blocks of size 2^( 2) =       0.000491373767
  error estimate for blocks of size 2^( 3) =       0.000515798106
  error estimate for blocks of size 2^( 4) =       0.000534541796
  error estimate for blocks of size 2^( 5) =       0.000545046047
  error estimate for blocks of size 2^( 6) =       0.000550327567
  error estimate for blocks of size 2^( 7) =       0.000559578354

      target function =      -0.749572978016
              le_mean =     -22.815182855982
             les_mean =     520.977492021505
             stat err =       0.000547373441
             autocorr =       1.380757910229
   target nu stat err =       0.000547373441
   target dn stat err =       0.002302135880
      target stat err =       0.002019986201
              std dev =       0.658779307080
             le_variance =       0.433990175436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749572975281        initial
     1.4552e+03     1.4552e+04             1.5416e-07        -0.749573018986  <--
     5.8208e+03     5.8208e+04             3.8540e-08        -0.749572997146
     2.3283e+04     2.3283e+05             9.6352e-09        -0.749572978016

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 4.2740e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_01                 1.080370e-01 3 1  ON 0
ci_02                -2.400733e-02 3 1  ON 1
ci_03                -2.428307e-02 3 1  ON 2
ci_04                 2.215999e-02 3 1  ON 3
ci_05                -1.913301e-02 3 1  ON 4
ci_06                -1.952846e-02 3 1  ON 5
ci_07                 2.575727e-02 3 1  ON 6
ci_08                -4.225534e-03 3 1  ON 7
ci_09                -7.549911e-03 3 1  ON 8
ci_10                -7.705685e-03 3 1  ON 9
ci_11                 1.374774e-02 3 1  ON 10
ci_12                 7.046662e-03 3 1  ON 11
ci_13                 1.381481e-02 3 1  ON 12
ci_14                 1.281199e-02 3 1  ON 13
ci_15                 5.170608e-03 3 1  ON 14
ci_16                 5.731940e-03 3 1  ON 15
ci_17                -5.019690e-03 3 1  ON 16
ci_18                -5.546436e-03 3 1  ON 17
ci_19                 1.032880e-02 3 1  ON 18
ci_20                 6.254828e-03 3 1  ON 19
ci_21                 8.484006e-03 3 1  ON 20
ci_22                 8.881278e-03 3 1  ON 21
ci_23                 4.170591e-03 3 1  ON 22
ci_24                 5.186343e-03 3 1  ON 23
ci_25                 3.012186e-03 3 1  ON 24
ci_26                 3.792832e-03 3 1  ON 25
ci_27                 3.289034e-03 3 1  ON 26
ci_28                 7.717430e-04 3 1  ON 27
ci_29                 1.186996e-03 3 1  ON 28
ci_30                -7.402221e-04 3 1  ON 29
ci_31                 1.032651e-03 3 1  ON 30
ci_32                -5.374716e-04 3 1  ON 31
ci_33                -1.033930e-03 3 1  ON 32
ci_34                 1.151989e-03 3 1  ON 33
ci_35                 1.248823e-03 3 1  ON 34
ci_36                -5.665153e-04 3 1  ON 35
ci_37                -5.189651e-04 3 1  ON 36
ci_38                -2.863474e-04 3 1  ON 37
ci_39                -1.422837e-04 3 1  ON 38
ci_40                -1.904502e-03 3 1  ON 39
ci_41                -5.144346e-04 3 1  ON 40
ci_42                -1.647800e-03 3 1  ON 41
ci_43                -1.294512e-03 3 1  ON 42
ci_44                -2.176203e-03 3 1  ON 43
ci_45                -2.658845e-04 3 1  ON 44
ci_46                -1.692253e-03 3 1  ON 45
ci_47                 1.435741e-03 3 1  ON 46
ci_48                 2.891872e-03 3 1  ON 47
ci_49                -8.542374e-04 3 1  ON 48
ci_50                -8.199995e-04 3 1  ON 49
ci_51                -5.666553e-04 3 1  ON 50
ci_52                -6.303287e-04 3 1  ON 51
ci_53                -8.013443e-04 3 1  ON 52
ci_54                -1.109236e-03 3 1  ON 53
ci_55                -1.235881e-03 3 1  ON 54
ci_56                 1.099817e-03 3 1  ON 55
ci_57                 2.088960e-03 3 1  ON 56
ci_58                -1.864818e-04 3 1  ON 57
ci_59                -6.201194e-04 3 1  ON 58
ci_60                 1.277764e-04 3 1  ON 59
ci_61                -9.880717e-04 3 1  ON 60
ci_62                -3.818005e-04 3 1  ON 61
ci_63                -2.473280e-04 3 1  ON 62
ci_64                -6.085735e-04 3 1  ON 63
ci_65                -1.069082e-04 3 1  ON 64
ci_66                -1.263267e-04 3 1  ON 65
ci_67                -1.932133e-04 3 1  ON 66
ci_68                -1.797455e-03 3 1  ON 67
ci_69                -1.807052e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2961e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8571
    reference variance = 0.402469
====================================================
  Execution time = 2.5648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5307e-01
  Total weights = 1.964695979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435858557697
                                         uncertainty =       0.002282530720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435858557697
                                         uncertainty =       0.002282530720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466829577
  error estimate for blocks of size 2^( 2) =       0.000492258877
  error estimate for blocks of size 2^( 3) =       0.000517013514
  error estimate for blocks of size 2^( 4) =       0.000535817547
  error estimate for blocks of size 2^( 5) =       0.000547838108
  error estimate for blocks of size 2^( 6) =       0.000554539648
  error estimate for blocks of size 2^( 7) =       0.000561524904

      target function =      -0.742819788060
              le_mean =     -22.814721752081
             les_mean =     520.964594019312
             stat err =       0.000549930052
             autocorr =       1.387708275983
   target nu stat err =       0.000549930052
   target dn stat err =       0.003368218074
      target stat err =       0.002830665985
              std dev =       0.660196719293
             le_variance =       0.435859708165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472175208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742829603636       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742829782647       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742829801180       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742829802742       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742829803137       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742829803338       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742829803212       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742829803232       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742829803218       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742829803255       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 1.071115e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742829603636       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742829648393       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742829653027       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742829653417       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742829653516       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742829653566       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742829653534       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742829653539       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742829653536       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742829653545       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 2.678064e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742829603636       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742829614825       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742829615984       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742829616081       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742829616119       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742829616119       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742829616105       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742829616122       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742829616108       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742829616111       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 6.695333e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0164e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_01                 1.080371e-01 3 1  ON 0
ci_02                -2.400745e-02 3 1  ON 1
ci_03                -2.428326e-02 3 1  ON 2
ci_04                 2.216010e-02 3 1  ON 3
ci_05                -1.913305e-02 3 1  ON 4
ci_06                -1.952847e-02 3 1  ON 5
ci_07                 2.575726e-02 3 1  ON 6
ci_08                -4.225585e-03 3 1  ON 7
ci_09                -7.549864e-03 3 1  ON 8
ci_10                -7.705649e-03 3 1  ON 9
ci_11                 1.374771e-02 3 1  ON 10
ci_12                 7.046679e-03 3 1  ON 11
ci_13                 1.381481e-02 3 1  ON 12
ci_14                 1.281200e-02 3 1  ON 13
ci_15                 5.170876e-03 3 1  ON 14
ci_16                 5.731972e-03 3 1  ON 15
ci_17                -5.019760e-03 3 1  ON 16
ci_18                -5.546506e-03 3 1  ON 17
ci_19                 1.032872e-02 3 1  ON 18
ci_20                 6.254788e-03 3 1  ON 19
ci_21                 8.483990e-03 3 1  ON 20
ci_22                 8.881255e-03 3 1  ON 21
ci_23                 4.170603e-03 3 1  ON 22
ci_24                 5.186347e-03 3 1  ON 23
ci_25                 3.012179e-03 3 1  ON 24
ci_26                 3.792725e-03 3 1  ON 25
ci_27                 3.288971e-03 3 1  ON 26
ci_28                 7.717349e-04 3 1  ON 27
ci_29                 1.187017e-03 3 1  ON 28
ci_30                -7.401869e-04 3 1  ON 29
ci_31                 1.032629e-03 3 1  ON 30
ci_32                -5.375458e-04 3 1  ON 31
ci_33                -1.033878e-03 3 1  ON 32
ci_34                 1.151969e-03 3 1  ON 33
ci_35                 1.248719e-03 3 1  ON 34
ci_36                -5.665431e-04 3 1  ON 35
ci_37                -5.189555e-04 3 1  ON 36
ci_38                -2.862744e-04 3 1  ON 37
ci_39                -1.423241e-04 3 1  ON 38
ci_40                -1.904499e-03 3 1  ON 39
ci_41                -5.144729e-04 3 1  ON 40
ci_42                -1.647927e-03 3 1  ON 41
ci_43                -1.294497e-03 3 1  ON 42
ci_44                -2.176135e-03 3 1  ON 43
ci_45                -2.659339e-04 3 1  ON 44
ci_46                -1.692190e-03 3 1  ON 45
ci_47                 1.435764e-03 3 1  ON 46
ci_48                 2.891948e-03 3 1  ON 47
ci_49                -8.542228e-04 3 1  ON 48
ci_50                -8.199936e-04 3 1  ON 49
ci_51                -5.666376e-04 3 1  ON 50
ci_52                -6.303029e-04 3 1  ON 51
ci_53                -8.013435e-04 3 1  ON 52
ci_54                -1.109198e-03 3 1  ON 53
ci_55                -1.235821e-03 3 1  ON 54
ci_56                 1.099858e-03 3 1  ON 55
ci_57                 2.088819e-03 3 1  ON 56
ci_58                -1.865447e-04 3 1  ON 57
ci_59                -6.201184e-04 3 1  ON 58
ci_60                 1.278447e-04 3 1  ON 59
ci_61                -9.880170e-04 3 1  ON 60
ci_62                -3.817890e-04 3 1  ON 61
ci_63                -2.473100e-04 3 1  ON 62
ci_64                -6.085599e-04 3 1  ON 63
ci_65                -1.068881e-04 3 1  ON 64
ci_66                -1.263474e-04 3 1  ON 65
ci_67                -1.932476e-04 3 1  ON 66
ci_68                -1.797397e-03 3 1  ON 67
ci_69                -1.807032e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7663
    reference variance = 0.387801
====================================================
  Execution time = 2.5031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4618e-01
  Total weights = 1.9650e+06
  Execution time = 3.5052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867938959
                                         uncertainty =       0.002368996593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867938959
                                         uncertainty =       0.002368996593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466868851
  error estimate for blocks of size 2^( 2) =       0.000492785428
  error estimate for blocks of size 2^( 3) =       0.000517013516
  error estimate for blocks of size 2^( 4) =       0.000535799751
  error estimate for blocks of size 2^( 5) =       0.000546807817
  error estimate for blocks of size 2^( 6) =       0.000555304713
  error estimate for blocks of size 2^( 7) =       0.000556765391

      target function =      -0.748520329837
              le_mean =     -22.814894281667
             les_mean =     520.965577023885
             stat err =       0.000548669418
             autocorr =       1.381120937179
   target nu stat err =       0.000548669418
   target dn stat err =       0.003164475256
      target stat err =       0.002707979771
              std dev =       0.660252261285
             le_variance =       0.435933048533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867949370
                                         uncertainty =       0.002369013746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867949370
                                         uncertainty =       0.002369013746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466868857
  error estimate for blocks of size 2^( 2) =       0.000492785387
  error estimate for blocks of size 2^( 3) =       0.000517013424
  error estimate for blocks of size 2^( 4) =       0.000535799622
  error estimate for blocks of size 2^( 5) =       0.000546807658
  error estimate for blocks of size 2^( 6) =       0.000555304543
  error estimate for blocks of size 2^( 7) =       0.000556765221

      target function =      -0.748520610574
              le_mean =     -22.814894284838
             les_mean =     520.965576832048
             stat err =       0.000548669261
             autocorr =       1.381120109866
   target nu stat err =       0.000548669261
   target dn stat err =       0.003164444550
      target stat err =       0.002707956785
              std dev =       0.660252269930
             le_variance =       0.435933059948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867944153
                                         uncertainty =       0.002369005171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867944153
                                         uncertainty =       0.002369005171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466868854
  error estimate for blocks of size 2^( 2) =       0.000492785407
  error estimate for blocks of size 2^( 3) =       0.000517013470
  error estimate for blocks of size 2^( 4) =       0.000535799686
  error estimate for blocks of size 2^( 5) =       0.000546807738
  error estimate for blocks of size 2^( 6) =       0.000555304628
  error estimate for blocks of size 2^( 7) =       0.000556765306

      target function =      -0.748520470568
              le_mean =     -22.814894283251
             les_mean =     520.965576927456
             stat err =       0.000548669339
             autocorr =       1.381120523488
   target nu stat err =       0.000548669339
   target dn stat err =       0.003164459880
      target stat err =       0.002707968262
              std dev =       0.660252265599
             le_variance =       0.435933054229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867939607
                                         uncertainty =       0.002368997665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435867939607
                                         uncertainty =       0.002368997665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466868852
  error estimate for blocks of size 2^( 2) =       0.000492785425
  error estimate for blocks of size 2^( 3) =       0.000517013510
  error estimate for blocks of size 2^( 4) =       0.000535799743
  error estimate for blocks of size 2^( 5) =       0.000546807807
  error estimate for blocks of size 2^( 6) =       0.000555304702
  error estimate for blocks of size 2^( 7) =       0.000556765381

      target function =      -0.748520347467
              le_mean =     -22.814894281865
             les_mean =     520.965577011776
             stat err =       0.000548669408
             autocorr =       1.381120885471
   target nu stat err =       0.000548669408
   target dn stat err =       0.003164473332
      target stat err =       0.002707978330
              std dev =       0.660252261824
             le_variance =       0.435933049243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748520329837        initial
     3.6380e+02     3.6380e+03             1.0711e-06        -0.748520610574  <--
     1.4552e+03     1.4552e+04             2.6781e-07        -0.748520470568
     5.8208e+03     5.8208e+04             6.6953e-08        -0.748520347467

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 4.3707e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_01                 1.080375e-01 3 1  ON 0
ci_02                -2.400782e-02 3 1  ON 1
ci_03                -2.428384e-02 3 1  ON 2
ci_04                 2.216040e-02 3 1  ON 3
ci_05                -1.913319e-02 3 1  ON 4
ci_06                -1.952847e-02 3 1  ON 5
ci_07                 2.575725e-02 3 1  ON 6
ci_08                -4.225739e-03 3 1  ON 7
ci_09                -7.549721e-03 3 1  ON 8
ci_10                -7.705538e-03 3 1  ON 9
ci_11                 1.374763e-02 3 1  ON 10
ci_12                 7.046730e-03 3 1  ON 11
ci_13                 1.381480e-02 3 1  ON 12
ci_14                 1.281205e-02 3 1  ON 13
ci_15                 5.171679e-03 3 1  ON 14
ci_16                 5.732066e-03 3 1  ON 15
ci_17                -5.019970e-03 3 1  ON 16
ci_18                -5.546714e-03 3 1  ON 17
ci_19                 1.032846e-02 3 1  ON 18
ci_20                 6.254666e-03 3 1  ON 19
ci_21                 8.483944e-03 3 1  ON 20
ci_22                 8.881184e-03 3 1  ON 21
ci_23                 4.170639e-03 3 1  ON 22
ci_24                 5.186356e-03 3 1  ON 23
ci_25                 3.012159e-03 3 1  ON 24
ci_26                 3.792403e-03 3 1  ON 25
ci_27                 3.288783e-03 3 1  ON 26
ci_28                 7.717107e-04 3 1  ON 27
ci_29                 1.187080e-03 3 1  ON 28
ci_30                -7.400814e-04 3 1  ON 29
ci_31                 1.032565e-03 3 1  ON 30
ci_32                -5.377685e-04 3 1  ON 31
ci_33                -1.033721e-03 3 1  ON 32
ci_34                 1.151909e-03 3 1  ON 33
ci_35                 1.248404e-03 3 1  ON 34
ci_36                -5.666266e-04 3 1  ON 35
ci_37                -5.189267e-04 3 1  ON 36
ci_38                -2.860554e-04 3 1  ON 37
ci_39                -1.424452e-04 3 1  ON 38
ci_40                -1.904489e-03 3 1  ON 39
ci_41                -5.145878e-04 3 1  ON 40
ci_42                -1.648308e-03 3 1  ON 41
ci_43                -1.294449e-03 3 1  ON 42
ci_44                -2.175929e-03 3 1  ON 43
ci_45                -2.660822e-04 3 1  ON 44
ci_46                -1.692000e-03 3 1  ON 45
ci_47                 1.435834e-03 3 1  ON 46
ci_48                 2.892175e-03 3 1  ON 47
ci_49                -8.541789e-04 3 1  ON 48
ci_50                -8.199759e-04 3 1  ON 49
ci_51                -5.665843e-04 3 1  ON 50
ci_52                -6.302253e-04 3 1  ON 51
ci_53                -8.013408e-04 3 1  ON 52
ci_54                -1.109083e-03 3 1  ON 53
ci_55                -1.235640e-03 3 1  ON 54
ci_56                 1.099980e-03 3 1  ON 55
ci_57                 2.088396e-03 3 1  ON 56
ci_58                -1.867335e-04 3 1  ON 57
ci_59                -6.201155e-04 3 1  ON 58
ci_60                 1.280498e-04 3 1  ON 59
ci_61                -9.878526e-04 3 1  ON 60
ci_62                -3.817545e-04 3 1  ON 61
ci_63                -2.472559e-04 3 1  ON 62
ci_64                -6.085191e-04 3 1  ON 63
ci_65                -1.068278e-04 3 1  ON 64
ci_66                -1.264096e-04 3 1  ON 65
ci_67                -1.933505e-04 3 1  ON 66
ci_68                -1.797222e-03 3 1  ON 67
ci_69                -1.806974e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8253
    reference variance = 0.52566
====================================================
  Execution time = 2.5660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5394e-01
  Total weights = 1.964847025e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439414034365
                                         uncertainty =       0.002154912875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439414034365
                                         uncertainty =       0.002154912875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468756568
  error estimate for blocks of size 2^( 2) =       0.000494614374
  error estimate for blocks of size 2^( 3) =       0.000518876021
  error estimate for blocks of size 2^( 4) =       0.000536863579
  error estimate for blocks of size 2^( 5) =       0.000548471356
  error estimate for blocks of size 2^( 6) =       0.000556137254
  error estimate for blocks of size 2^( 7) =       0.000557827411

      target function =      -0.742102770611
              le_mean =     -22.815299640184
             les_mean =     520.991837452794
             stat err =       0.000549824900
             autocorr =       1.375796103603
   target nu stat err =       0.000549824900
   target dn stat err =       0.003084736826
      target stat err =       0.002601200816
              std dev =       0.662921896535
             le_variance =       0.439465440905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529964018e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742110880992       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742111092729       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742111130464       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742111139917       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742111144082       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742111145705       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742111144940       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742111144867       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742111144789       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742111144810       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+01 is 3.434704e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742110880992       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742110933948       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742110943384       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742110945748       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742110946788       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742110947195       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742110947003       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742110946985       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742110946966       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742110946971       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 8.588602e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742110880992       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742110894232       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742110896592       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742110897182       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742110897440       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742110897541       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742110897496       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742110897490       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742110897489       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742110897487       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 2.147266e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0141e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_01                 1.080383e-01 3 1  ON 0
ci_02                -2.400810e-02 3 1  ON 1
ci_03                -2.428425e-02 3 1  ON 2
ci_04                 2.216080e-02 3 1  ON 3
ci_05                -1.913344e-02 3 1  ON 4
ci_06                -1.952877e-02 3 1  ON 5
ci_07                 2.575738e-02 3 1  ON 6
ci_08                -4.225750e-03 3 1  ON 7
ci_09                -7.549725e-03 3 1  ON 8
ci_10                -7.705465e-03 3 1  ON 9
ci_11                 1.374751e-02 3 1  ON 10
ci_12                 7.046858e-03 3 1  ON 11
ci_13                 1.381484e-02 3 1  ON 12
ci_14                 1.281223e-02 3 1  ON 13
ci_15                 5.171837e-03 3 1  ON 14
ci_16                 5.732215e-03 3 1  ON 15
ci_17                -5.020161e-03 3 1  ON 16
ci_18                -5.546783e-03 3 1  ON 17
ci_19                 1.032837e-02 3 1  ON 18
ci_20                 6.254609e-03 3 1  ON 19
ci_21                 8.483901e-03 3 1  ON 20
ci_22                 8.881271e-03 3 1  ON 21
ci_23                 4.170773e-03 3 1  ON 22
ci_24                 5.186275e-03 3 1  ON 23
ci_25                 3.012279e-03 3 1  ON 24
ci_26                 3.792301e-03 3 1  ON 25
ci_27                 3.288844e-03 3 1  ON 26
ci_28                 7.718940e-04 3 1  ON 27
ci_29                 1.187079e-03 3 1  ON 28
ci_30                -7.399162e-04 3 1  ON 29
ci_31                 1.032444e-03 3 1  ON 30
ci_32                -5.377745e-04 3 1  ON 31
ci_33                -1.033828e-03 3 1  ON 32
ci_34                 1.151975e-03 3 1  ON 33
ci_35                 1.248478e-03 3 1  ON 34
ci_36                -5.667955e-04 3 1  ON 35
ci_37                -5.190369e-04 3 1  ON 36
ci_38                -2.860645e-04 3 1  ON 37
ci_39                -1.425179e-04 3 1  ON 38
ci_40                -1.904356e-03 3 1  ON 39
ci_41                -5.146708e-04 3 1  ON 40
ci_42                -1.648255e-03 3 1  ON 41
ci_43                -1.294283e-03 3 1  ON 42
ci_44                -2.175942e-03 3 1  ON 43
ci_45                -2.662033e-04 3 1  ON 44
ci_46                -1.691772e-03 3 1  ON 45
ci_47                 1.435932e-03 3 1  ON 46
ci_48                 2.892116e-03 3 1  ON 47
ci_49                -8.540379e-04 3 1  ON 48
ci_50                -8.199391e-04 3 1  ON 49
ci_51                -5.665663e-04 3 1  ON 50
ci_52                -6.300150e-04 3 1  ON 51
ci_53                -8.013281e-04 3 1  ON 52
ci_54                -1.109076e-03 3 1  ON 53
ci_55                -1.235624e-03 3 1  ON 54
ci_56                 1.100176e-03 3 1  ON 55
ci_57                 2.088411e-03 3 1  ON 56
ci_58                -1.868035e-04 3 1  ON 57
ci_59                -6.200269e-04 3 1  ON 58
ci_60                 1.283100e-04 3 1  ON 59
ci_61                -9.877356e-04 3 1  ON 60
ci_62                -3.817440e-04 3 1  ON 61
ci_63                -2.471773e-04 3 1  ON 62
ci_64                -6.085510e-04 3 1  ON 63
ci_65                -1.068795e-04 3 1  ON 64
ci_66                -1.264961e-04 3 1  ON 65
ci_67                -1.931804e-04 3 1  ON 66
ci_68                -1.797391e-03 3 1  ON 67
ci_69                -1.806718e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.9179
    reference variance = 0.434841
====================================================
  Execution time = 2.4914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4662e-01
  Total weights = 1.9648e+06
  Execution time = 3.5080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432787077238
                                         uncertainty =       0.001946774226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432787077238
                                         uncertainty =       0.001946774226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465193707
  error estimate for blocks of size 2^( 2) =       0.000491433376
  error estimate for blocks of size 2^( 3) =       0.000516027121
  error estimate for blocks of size 2^( 4) =       0.000535550775
  error estimate for blocks of size 2^( 5) =       0.000546943800
  error estimate for blocks of size 2^( 6) =       0.000554932198
  error estimate for blocks of size 2^( 7) =       0.000558275609

      target function =      -0.748152489860
              le_mean =     -22.814437179524
             les_mean =     520.945160506900
             stat err =       0.000548925596
             autocorr =       1.392384887925
   target nu stat err =       0.000548925596
   target dn stat err =       0.002735648575
      target stat err =       0.002357300186
              std dev =       0.657883249760
             le_variance =       0.432810370315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432786939178
                                         uncertainty =       0.001946815396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432786939178
                                         uncertainty =       0.001946815396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465193633
  error estimate for blocks of size 2^( 2) =       0.000491433137
  error estimate for blocks of size 2^( 3) =       0.000516026708
  error estimate for blocks of size 2^( 4) =       0.000535550203
  error estimate for blocks of size 2^( 5) =       0.000546943188
  error estimate for blocks of size 2^( 6) =       0.000554931498
  error estimate for blocks of size 2^( 7) =       0.000558274922

      target function =      -0.748149350057
              le_mean =     -22.814437174289
             les_mean =     520.945164030378
             stat err =       0.000548924953
             autocorr =       1.392382070532
   target nu stat err =       0.000548924953
   target dn stat err =       0.002737360418
      target stat err =       0.002358657007
              std dev =       0.657883145239
             le_variance =       0.432810232790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432787008088
                                         uncertainty =       0.001946794819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432787008088
                                         uncertainty =       0.001946794819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465193670
  error estimate for blocks of size 2^( 2) =       0.000491433256
  error estimate for blocks of size 2^( 3) =       0.000516026914
  error estimate for blocks of size 2^( 4) =       0.000535550489
  error estimate for blocks of size 2^( 5) =       0.000546943494
  error estimate for blocks of size 2^( 6) =       0.000554931848
  error estimate for blocks of size 2^( 7) =       0.000558275266

      target function =      -0.748150925580
              le_mean =     -22.814437176889
             les_mean =     520.945162261099
             stat err =       0.000548925274
             autocorr =       1.392383478804
   target nu stat err =       0.000548925274
   target dn stat err =       0.002736503148
      target stat err =       0.002357977543
              std dev =       0.657883197409
             le_variance =       0.432810301433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432787068583
                                         uncertainty =       0.001946776800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432787068583
                                         uncertainty =       0.001946776800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465193703
  error estimate for blocks of size 2^( 2) =       0.000491433361
  error estimate for blocks of size 2^( 3) =       0.000516027095
  error estimate for blocks of size 2^( 4) =       0.000535550739
  error estimate for blocks of size 2^( 5) =       0.000546943762
  error estimate for blocks of size 2^( 6) =       0.000554932155
  error estimate for blocks of size 2^( 7) =       0.000558275566

      target function =      -0.748152294988
              le_mean =     -22.814437179193
             les_mean =     520.945160725297
             stat err =       0.000548925555
             autocorr =       1.392384711778
   target nu stat err =       0.000548925555
   target dn stat err =       0.002735755227
      target stat err =       0.002357384723
              std dev =       0.657883243208
             le_variance =       0.432810361694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748152489860        initial  <--
     9.0949e+01     9.0949e+02             3.4347e-06        -0.748149350057
     3.6380e+02     3.6380e+03             8.5886e-07        -0.748150925580
     1.4552e+03     1.4552e+04             2.1473e-07        -0.748152294988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4870
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_01                 1.080375e-01 3 1  ON 0
ci_02                -2.400782e-02 3 1  ON 1
ci_03                -2.428384e-02 3 1  ON 2
ci_04                 2.216040e-02 3 1  ON 3
ci_05                -1.913319e-02 3 1  ON 4
ci_06                -1.952847e-02 3 1  ON 5
ci_07                 2.575725e-02 3 1  ON 6
ci_08                -4.225739e-03 3 1  ON 7
ci_09                -7.549721e-03 3 1  ON 8
ci_10                -7.705538e-03 3 1  ON 9
ci_11                 1.374763e-02 3 1  ON 10
ci_12                 7.046730e-03 3 1  ON 11
ci_13                 1.381480e-02 3 1  ON 12
ci_14                 1.281205e-02 3 1  ON 13
ci_15                 5.171679e-03 3 1  ON 14
ci_16                 5.732066e-03 3 1  ON 15
ci_17                -5.019970e-03 3 1  ON 16
ci_18                -5.546714e-03 3 1  ON 17
ci_19                 1.032846e-02 3 1  ON 18
ci_20                 6.254666e-03 3 1  ON 19
ci_21                 8.483944e-03 3 1  ON 20
ci_22                 8.881184e-03 3 1  ON 21
ci_23                 4.170639e-03 3 1  ON 22
ci_24                 5.186356e-03 3 1  ON 23
ci_25                 3.012159e-03 3 1  ON 24
ci_26                 3.792403e-03 3 1  ON 25
ci_27                 3.288783e-03 3 1  ON 26
ci_28                 7.717107e-04 3 1  ON 27
ci_29                 1.187080e-03 3 1  ON 28
ci_30                -7.400814e-04 3 1  ON 29
ci_31                 1.032565e-03 3 1  ON 30
ci_32                -5.377685e-04 3 1  ON 31
ci_33                -1.033721e-03 3 1  ON 32
ci_34                 1.151909e-03 3 1  ON 33
ci_35                 1.248404e-03 3 1  ON 34
ci_36                -5.666266e-04 3 1  ON 35
ci_37                -5.189267e-04 3 1  ON 36
ci_38                -2.860554e-04 3 1  ON 37
ci_39                -1.424452e-04 3 1  ON 38
ci_40                -1.904489e-03 3 1  ON 39
ci_41                -5.145878e-04 3 1  ON 40
ci_42                -1.648308e-03 3 1  ON 41
ci_43                -1.294449e-03 3 1  ON 42
ci_44                -2.175929e-03 3 1  ON 43
ci_45                -2.660822e-04 3 1  ON 44
ci_46                -1.692000e-03 3 1  ON 45
ci_47                 1.435834e-03 3 1  ON 46
ci_48                 2.892175e-03 3 1  ON 47
ci_49                -8.541789e-04 3 1  ON 48
ci_50                -8.199759e-04 3 1  ON 49
ci_51                -5.665843e-04 3 1  ON 50
ci_52                -6.302253e-04 3 1  ON 51
ci_53                -8.013408e-04 3 1  ON 52
ci_54                -1.109083e-03 3 1  ON 53
ci_55                -1.235640e-03 3 1  ON 54
ci_56                 1.099980e-03 3 1  ON 55
ci_57                 2.088396e-03 3 1  ON 56
ci_58                -1.867335e-04 3 1  ON 57
ci_59                -6.201155e-04 3 1  ON 58
ci_60                 1.280498e-04 3 1  ON 59
ci_61                -9.878526e-04 3 1  ON 60
ci_62                -3.817545e-04 3 1  ON 61
ci_63                -2.472559e-04 3 1  ON 62
ci_64                -6.085191e-04 3 1  ON 63
ci_65                -1.068278e-04 3 1  ON 64
ci_66                -1.264096e-04 3 1  ON 65
ci_67                -1.933505e-04 3 1  ON 66
ci_68                -1.797222e-03 3 1  ON 67
ci_69                -1.806974e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2635e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7213
    reference variance = 0.290018
====================================================
  Execution time = 2.5628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4292e-01
  Total weights = 1.964794396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432268153838
                                         uncertainty =       0.001841201588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432268153838
                                         uncertainty =       0.001841201588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464869467
  error estimate for blocks of size 2^( 2) =       0.000490856944
  error estimate for blocks of size 2^( 3) =       0.000515336968
  error estimate for blocks of size 2^( 4) =       0.000533561672
  error estimate for blocks of size 2^( 5) =       0.000545253371
  error estimate for blocks of size 2^( 6) =       0.000550701328
  error estimate for blocks of size 2^( 7) =       0.000555326560

      target function =      -0.751243629466
              le_mean =     -22.814810164311
             les_mean =     520.958486318775
             stat err =       0.000546210733
             autocorr =       1.380569943252
   target nu stat err =       0.000546210733
   target dn stat err =       0.002638139763
      target stat err =       0.002297671676
              std dev =       0.657424705348
             le_variance =       0.432207243202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281481016431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751249651721       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751249673787       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751249676928       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751249678262       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751249678645       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751249678754       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751249678772       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751249678796       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751249678784       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 3.544924e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751249651721       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751249657237       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751249658023       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751249658356       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751249658446       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751249658480       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751249658481       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751249658487       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751249658484       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 8.862508e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751249651721       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751249653100       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751249653296       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751249653380       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751249653403       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751249653391       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751249653412       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751249653459       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751249653406       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.215639e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0148e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_01                 1.080376e-01 3 1  ON 0
ci_02                -2.400785e-02 3 1  ON 1
ci_03                -2.428386e-02 3 1  ON 2
ci_04                 2.216046e-02 3 1  ON 3
ci_05                -1.913322e-02 3 1  ON 4
ci_06                -1.952849e-02 3 1  ON 5
ci_07                 2.575726e-02 3 1  ON 6
ci_08                -4.225755e-03 3 1  ON 7
ci_09                -7.549720e-03 3 1  ON 8
ci_10                -7.705543e-03 3 1  ON 9
ci_11                 1.374762e-02 3 1  ON 10
ci_12                 7.046731e-03 3 1  ON 11
ci_13                 1.381481e-02 3 1  ON 12
ci_14                 1.281205e-02 3 1  ON 13
ci_15                 5.171670e-03 3 1  ON 14
ci_16                 5.732057e-03 3 1  ON 15
ci_17                -5.019984e-03 3 1  ON 16
ci_18                -5.546713e-03 3 1  ON 17
ci_19                 1.032844e-02 3 1  ON 18
ci_20                 6.254655e-03 3 1  ON 19
ci_21                 8.483953e-03 3 1  ON 20
ci_22                 8.881194e-03 3 1  ON 21
ci_23                 4.170657e-03 3 1  ON 22
ci_24                 5.186359e-03 3 1  ON 23
ci_25                 3.012170e-03 3 1  ON 24
ci_26                 3.792399e-03 3 1  ON 25
ci_27                 3.288771e-03 3 1  ON 26
ci_28                 7.717206e-04 3 1  ON 27
ci_29                 1.187073e-03 3 1  ON 28
ci_30                -7.400739e-04 3 1  ON 29
ci_31                 1.032521e-03 3 1  ON 30
ci_32                -5.377583e-04 3 1  ON 31
ci_33                -1.033725e-03 3 1  ON 32
ci_34                 1.151910e-03 3 1  ON 33
ci_35                 1.248412e-03 3 1  ON 34
ci_36                -5.666206e-04 3 1  ON 35
ci_37                -5.189306e-04 3 1  ON 36
ci_38                -2.860555e-04 3 1  ON 37
ci_39                -1.424630e-04 3 1  ON 38
ci_40                -1.904479e-03 3 1  ON 39
ci_41                -5.146012e-04 3 1  ON 40
ci_42                -1.648292e-03 3 1  ON 41
ci_43                -1.294465e-03 3 1  ON 42
ci_44                -2.175929e-03 3 1  ON 43
ci_45                -2.660912e-04 3 1  ON 44
ci_46                -1.692014e-03 3 1  ON 45
ci_47                 1.435835e-03 3 1  ON 46
ci_48                 2.892172e-03 3 1  ON 47
ci_49                -8.541842e-04 3 1  ON 48
ci_50                -8.199806e-04 3 1  ON 49
ci_51                -5.665953e-04 3 1  ON 50
ci_52                -6.302087e-04 3 1  ON 51
ci_53                -8.013388e-04 3 1  ON 52
ci_54                -1.109089e-03 3 1  ON 53
ci_55                -1.235638e-03 3 1  ON 54
ci_56                 1.099997e-03 3 1  ON 55
ci_57                 2.088402e-03 3 1  ON 56
ci_58                -1.867346e-04 3 1  ON 57
ci_59                -6.201119e-04 3 1  ON 58
ci_60                 1.280614e-04 3 1  ON 59
ci_61                -9.878349e-04 3 1  ON 60
ci_62                -3.817540e-04 3 1  ON 61
ci_63                -2.472531e-04 3 1  ON 62
ci_64                -6.085096e-04 3 1  ON 63
ci_65                -1.068377e-04 3 1  ON 64
ci_66                -1.264205e-04 3 1  ON 65
ci_67                -1.933666e-04 3 1  ON 66
ci_68                -1.797215e-03 3 1  ON 67
ci_69                -1.806973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7699
    reference variance = 0.302272
====================================================
  Execution time = 2.5139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5072e-01
  Total weights = 1.9648e+06
  Execution time = 3.5175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235367837
                                         uncertainty =       0.002098589753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235367837
                                         uncertainty =       0.002098589753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468073510
  error estimate for blocks of size 2^( 2) =       0.000494039000
  error estimate for blocks of size 2^( 3) =       0.000518426116
  error estimate for blocks of size 2^( 4) =       0.000536717191
  error estimate for blocks of size 2^( 5) =       0.000548800525
  error estimate for blocks of size 2^( 6) =       0.000553860652
  error estimate for blocks of size 2^( 7) =       0.000558303163

      target function =      -0.744748894342
              le_mean =     -22.813825084701
             les_mean =     520.921336697341
             stat err =       0.000549420383
             autocorr =       1.377784855191
   target nu stat err =       0.000549420383
   target dn stat err =       0.002966980361
      target stat err =       0.002519166690
              std dev =       0.661955906345
             le_variance =       0.438185621945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235337909
                                         uncertainty =       0.002098592960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235337909
                                         uncertainty =       0.002098592960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468073494
  error estimate for blocks of size 2^( 2) =       0.000494038966
  error estimate for blocks of size 2^( 3) =       0.000518426063
  error estimate for blocks of size 2^( 4) =       0.000536717126
  error estimate for blocks of size 2^( 5) =       0.000548800452
  error estimate for blocks of size 2^( 6) =       0.000553860572
  error estimate for blocks of size 2^( 7) =       0.000558303079

      target function =      -0.744748994003
              le_mean =     -22.813825086226
             les_mean =     520.921336646149
             stat err =       0.000549420307
             autocorr =       1.377784571388
   target nu stat err =       0.000549420307
   target dn stat err =       0.002966956557
      target stat err =       0.002519148296
              std dev =       0.661955883623
             le_variance =       0.438185591863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235352871
                                         uncertainty =       0.002098591356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235352871
                                         uncertainty =       0.002098591356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468073502
  error estimate for blocks of size 2^( 2) =       0.000494038983
  error estimate for blocks of size 2^( 3) =       0.000518426089
  error estimate for blocks of size 2^( 4) =       0.000536717158
  error estimate for blocks of size 2^( 5) =       0.000548800488
  error estimate for blocks of size 2^( 6) =       0.000553860612
  error estimate for blocks of size 2^( 7) =       0.000558303121

      target function =      -0.744748944412
              le_mean =     -22.813825085464
             les_mean =     520.921336671451
             stat err =       0.000549420345
             autocorr =       1.377784713284
   target nu stat err =       0.000549420345
   target dn stat err =       0.002966968457
      target stat err =       0.002519157493
              std dev =       0.661955894983
             le_variance =       0.438185606902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235365966
                                         uncertainty =       0.002098589954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438235365966
                                         uncertainty =       0.002098589954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468073509
  error estimate for blocks of size 2^( 2) =       0.000494038998
  error estimate for blocks of size 2^( 3) =       0.000518426112
  error estimate for blocks of size 2^( 4) =       0.000536717187
  error estimate for blocks of size 2^( 5) =       0.000548800520
  error estimate for blocks of size 2^( 6) =       0.000553860647
  error estimate for blocks of size 2^( 7) =       0.000558303157

      target function =      -0.744748900626
              le_mean =     -22.813825084796
             les_mean =     520.921336694073
             stat err =       0.000549420378
             autocorr =       1.377784837446
   target nu stat err =       0.000549420378
   target dn stat err =       0.002966978872
      target stat err =       0.002519165540
              std dev =       0.661955904925
             le_variance =       0.438185620065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744748894342        initial
     9.0949e+02     9.0949e+03             3.5449e-07        -0.744748994003  <--
     3.6380e+03     3.6380e+04             8.8625e-08        -0.744748944412
     1.4552e+04     1.4552e+05             2.2156e-08        -0.744748900626

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 4.6330e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_01                 1.080378e-01 3 1  ON 0
ci_02                -2.400796e-02 3 1  ON 1
ci_03                -2.428391e-02 3 1  ON 2
ci_04                 2.216064e-02 3 1  ON 3
ci_05                -1.913331e-02 3 1  ON 4
ci_06                -1.952856e-02 3 1  ON 5
ci_07                 2.575730e-02 3 1  ON 6
ci_08                -4.225805e-03 3 1  ON 7
ci_09                -7.549716e-03 3 1  ON 8
ci_10                -7.705557e-03 3 1  ON 9
ci_11                 1.374759e-02 3 1  ON 10
ci_12                 7.046735e-03 3 1  ON 11
ci_13                 1.381483e-02 3 1  ON 12
ci_14                 1.281204e-02 3 1  ON 13
ci_15                 5.171643e-03 3 1  ON 14
ci_16                 5.732030e-03 3 1  ON 15
ci_17                -5.020029e-03 3 1  ON 16
ci_18                -5.546709e-03 3 1  ON 17
ci_19                 1.032838e-02 3 1  ON 18
ci_20                 6.254623e-03 3 1  ON 19
ci_21                 8.483981e-03 3 1  ON 20
ci_22                 8.881223e-03 3 1  ON 21
ci_23                 4.170712e-03 3 1  ON 22
ci_24                 5.186366e-03 3 1  ON 23
ci_25                 3.012203e-03 3 1  ON 24
ci_26                 3.792385e-03 3 1  ON 25
ci_27                 3.288734e-03 3 1  ON 26
ci_28                 7.717502e-04 3 1  ON 27
ci_29                 1.187052e-03 3 1  ON 28
ci_30                -7.400511e-04 3 1  ON 29
ci_31                 1.032391e-03 3 1  ON 30
ci_32                -5.377280e-04 3 1  ON 31
ci_33                -1.033737e-03 3 1  ON 32
ci_34                 1.151915e-03 3 1  ON 33
ci_35                 1.248435e-03 3 1  ON 34
ci_36                -5.666025e-04 3 1  ON 35
ci_37                -5.189423e-04 3 1  ON 36
ci_38                -2.860557e-04 3 1  ON 37
ci_39                -1.425161e-04 3 1  ON 38
ci_40                -1.904448e-03 3 1  ON 39
ci_41                -5.146416e-04 3 1  ON 40
ci_42                -1.648244e-03 3 1  ON 41
ci_43                -1.294511e-03 3 1  ON 42
ci_44                -2.175927e-03 3 1  ON 43
ci_45                -2.661184e-04 3 1  ON 44
ci_46                -1.692055e-03 3 1  ON 45
ci_47                 1.435837e-03 3 1  ON 46
ci_48                 2.892162e-03 3 1  ON 47
ci_49                -8.542001e-04 3 1  ON 48
ci_50                -8.199945e-04 3 1  ON 49
ci_51                -5.666284e-04 3 1  ON 50
ci_52                -6.301588e-04 3 1  ON 51
ci_53                -8.013328e-04 3 1  ON 52
ci_54                -1.109106e-03 3 1  ON 53
ci_55                -1.235632e-03 3 1  ON 54
ci_56                 1.100048e-03 3 1  ON 55
ci_57                 2.088421e-03 3 1  ON 56
ci_58                -1.867380e-04 3 1  ON 57
ci_59                -6.201013e-04 3 1  ON 58
ci_60                 1.280962e-04 3 1  ON 59
ci_61                -9.877816e-04 3 1  ON 60
ci_62                -3.817523e-04 3 1  ON 61
ci_63                -2.472448e-04 3 1  ON 62
ci_64                -6.084814e-04 3 1  ON 63
ci_65                -1.068671e-04 3 1  ON 64
ci_66                -1.264530e-04 3 1  ON 65
ci_67                -1.934147e-04 3 1  ON 66
ci_68                -1.797194e-03 3 1  ON 67
ci_69                -1.806970e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8046
    reference variance = 0.32376
====================================================
  Execution time = 2.5629e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4621e-01
  Total weights = 1.964247615e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435726256536
                                         uncertainty =       0.001886626921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435726256536
                                         uncertainty =       0.001886626921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466724299
  error estimate for blocks of size 2^( 2) =       0.000492198532
  error estimate for blocks of size 2^( 3) =       0.000516581514
  error estimate for blocks of size 2^( 4) =       0.000535071344
  error estimate for blocks of size 2^( 5) =       0.000547778306
  error estimate for blocks of size 2^( 6) =       0.000551596558
  error estimate for blocks of size 2^( 7) =       0.000558246502

      target function =      -0.748492109237
              le_mean =     -22.814815520569
             les_mean =     520.962021775944
             stat err =       0.000548173178
             autocorr =       1.379477874744
   target nu stat err =       0.000548173178
   target dn stat err =       0.002293934734
      target stat err =       0.002007086900
              std dev =       0.660047833130
             le_variance =       0.435663142019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281481552057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748496493878       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748496582034       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748496597994       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748496600932       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748496601838       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748496601445       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748496601438       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748496601431       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748496601430       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 1.388663e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748496493878       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748496515921       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748496519911       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748496520646       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748496520872       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748496520775       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748496520773       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748496520771       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748496520771       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 3.471960e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748496493878       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748496499389       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748496500387       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748496500571       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748496500630       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748496500607       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748496500603       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748496500606       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748496500602       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 8.680090e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0152e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_01                 1.080382e-01 3 1  ON 0
ci_02                -2.400813e-02 3 1  ON 1
ci_03                -2.428416e-02 3 1  ON 2
ci_04                 2.216077e-02 3 1  ON 3
ci_05                -1.913339e-02 3 1  ON 4
ci_06                -1.952859e-02 3 1  ON 5
ci_07                 2.575729e-02 3 1  ON 6
ci_08                -4.225841e-03 3 1  ON 7
ci_09                -7.549777e-03 3 1  ON 8
ci_10                -7.705474e-03 3 1  ON 9
ci_11                 1.374760e-02 3 1  ON 10
ci_12                 7.046801e-03 3 1  ON 11
ci_13                 1.381482e-02 3 1  ON 12
ci_14                 1.281204e-02 3 1  ON 13
ci_15                 5.171701e-03 3 1  ON 14
ci_16                 5.732096e-03 3 1  ON 15
ci_17                -5.020112e-03 3 1  ON 16
ci_18                -5.546798e-03 3 1  ON 17
ci_19                 1.032830e-02 3 1  ON 18
ci_20                 6.254657e-03 3 1  ON 19
ci_21                 8.483938e-03 3 1  ON 20
ci_22                 8.881239e-03 3 1  ON 21
ci_23                 4.170770e-03 3 1  ON 22
ci_24                 5.186341e-03 3 1  ON 23
ci_25                 3.012201e-03 3 1  ON 24
ci_26                 3.792395e-03 3 1  ON 25
ci_27                 3.288747e-03 3 1  ON 26
ci_28                 7.717670e-04 3 1  ON 27
ci_29                 1.187023e-03 3 1  ON 28
ci_30                -7.400201e-04 3 1  ON 29
ci_31                 1.032319e-03 3 1  ON 30
ci_32                -5.377972e-04 3 1  ON 31
ci_33                -1.033742e-03 3 1  ON 32
ci_34                 1.151906e-03 3 1  ON 33
ci_35                 1.248444e-03 3 1  ON 34
ci_36                -5.666142e-04 3 1  ON 35
ci_37                -5.189618e-04 3 1  ON 36
ci_38                -2.860575e-04 3 1  ON 37
ci_39                -1.425129e-04 3 1  ON 38
ci_40                -1.904373e-03 3 1  ON 39
ci_41                -5.147269e-04 3 1  ON 40
ci_42                -1.648213e-03 3 1  ON 41
ci_43                -1.294593e-03 3 1  ON 42
ci_44                -2.175896e-03 3 1  ON 43
ci_45                -2.661262e-04 3 1  ON 44
ci_46                -1.692001e-03 3 1  ON 45
ci_47                 1.435821e-03 3 1  ON 46
ci_48                 2.892142e-03 3 1  ON 47
ci_49                -8.541998e-04 3 1  ON 48
ci_50                -8.200151e-04 3 1  ON 49
ci_51                -5.665871e-04 3 1  ON 50
ci_52                -6.301073e-04 3 1  ON 51
ci_53                -8.013247e-04 3 1  ON 52
ci_54                -1.109069e-03 3 1  ON 53
ci_55                -1.235635e-03 3 1  ON 54
ci_56                 1.100127e-03 3 1  ON 55
ci_57                 2.088384e-03 3 1  ON 56
ci_58                -1.867974e-04 3 1  ON 57
ci_59                -6.201353e-04 3 1  ON 58
ci_60                 1.281542e-04 3 1  ON 59
ci_61                -9.877775e-04 3 1  ON 60
ci_62                -3.817694e-04 3 1  ON 61
ci_63                -2.472620e-04 3 1  ON 62
ci_64                -6.084761e-04 3 1  ON 63
ci_65                -1.068852e-04 3 1  ON 64
ci_66                -1.264880e-04 3 1  ON 65
ci_67                -1.933929e-04 3 1  ON 66
ci_68                -1.797146e-03 3 1  ON 67
ci_69                -1.806893e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8527
    reference variance = 0.31098
====================================================
  Execution time = 2.4959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5127e-01
  Total weights = 1.9647e+06
  Execution time = 3.5032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173427757
                                         uncertainty =       0.002537817613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173427757
                                         uncertainty =       0.002537817613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468110333
  error estimate for blocks of size 2^( 2) =       0.000493455843
  error estimate for blocks of size 2^( 3) =       0.000517239483
  error estimate for blocks of size 2^( 4) =       0.000534624083
  error estimate for blocks of size 2^( 5) =       0.000546425574
  error estimate for blocks of size 2^( 6) =       0.000554351521
  error estimate for blocks of size 2^( 7) =       0.000557901444

      target function =      -0.744298773163
              le_mean =     -22.813774148696
             les_mean =     520.919558512089
             stat err =       0.000548325655
             autocorr =       1.372083924938
   target nu stat err =       0.000548325655
   target dn stat err =       0.003036196848
      target stat err =       0.002571048018
              std dev =       0.662007982320
             le_variance =       0.438254568655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173377480
                                         uncertainty =       0.002537820476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173377480
                                         uncertainty =       0.002537820476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468110307
  error estimate for blocks of size 2^( 2) =       0.000493455742
  error estimate for blocks of size 2^( 3) =       0.000517239309
  error estimate for blocks of size 2^( 4) =       0.000534623853
  error estimate for blocks of size 2^( 5) =       0.000546425313
  error estimate for blocks of size 2^( 6) =       0.000554351265
  error estimate for blocks of size 2^( 7) =       0.000557901227

      target function =      -0.744299212113
              le_mean =     -22.813774151053
             les_mean =     520.919558086265
             stat err =       0.000548325415
             autocorr =       1.372082874758
   target nu stat err =       0.000548325415
   target dn stat err =       0.003036193352
      target stat err =       0.002571048116
              std dev =       0.662007944863
             le_variance =       0.438254519062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173402601
                                         uncertainty =       0.002537819044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173402601
                                         uncertainty =       0.002537819044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468110320
  error estimate for blocks of size 2^( 2) =       0.000493455792
  error estimate for blocks of size 2^( 3) =       0.000517239396
  error estimate for blocks of size 2^( 4) =       0.000534623968
  error estimate for blocks of size 2^( 5) =       0.000546425444
  error estimate for blocks of size 2^( 6) =       0.000554351393
  error estimate for blocks of size 2^( 7) =       0.000557901335

      target function =      -0.744298993300
              le_mean =     -22.813774149873
             les_mean =     520.919558298287
             stat err =       0.000548325535
             autocorr =       1.372083399777
   target nu stat err =       0.000548325535
   target dn stat err =       0.003036195082
      target stat err =       0.002571048057
              std dev =       0.662007963578
             le_variance =       0.438254543840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173424611
                                         uncertainty =       0.002537817792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438173424611
                                         uncertainty =       0.002537817792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468110332
  error estimate for blocks of size 2^( 2) =       0.000493455837
  error estimate for blocks of size 2^( 3) =       0.000517239473
  error estimate for blocks of size 2^( 4) =       0.000534624068
  error estimate for blocks of size 2^( 5) =       0.000546425558
  error estimate for blocks of size 2^( 6) =       0.000554351505
  error estimate for blocks of size 2^( 7) =       0.000557901430

      target function =      -0.744298800749
              le_mean =     -22.813774148843
             les_mean =     520.919558485270
             stat err =       0.000548325640
             autocorr =       1.372083859295
   target nu stat err =       0.000548325640
   target dn stat err =       0.003036196625
      target stat err =       0.002571048022
              std dev =       0.662007979975
             le_variance =       0.438254565551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744298773163        initial
     2.2737e+02     2.2737e+03             1.3887e-06        -0.744299212113  <--
     9.0949e+02     9.0949e+03             3.4720e-07        -0.744298993300
     3.6380e+03     3.6380e+04             8.6801e-08        -0.744298800749

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 4.2533e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_01                 1.080392e-01 3 1  ON 0
ci_02                -2.400866e-02 3 1  ON 1
ci_03                -2.428488e-02 3 1  ON 2
ci_04                 2.216115e-02 3 1  ON 3
ci_05                -1.913364e-02 3 1  ON 4
ci_06                -1.952868e-02 3 1  ON 5
ci_07                 2.575724e-02 3 1  ON 6
ci_08                -4.225952e-03 3 1  ON 7
ci_09                -7.549958e-03 3 1  ON 8
ci_10                -7.705227e-03 3 1  ON 9
ci_11                 1.374764e-02 3 1  ON 10
ci_12                 7.047001e-03 3 1  ON 11
ci_13                 1.381478e-02 3 1  ON 12
ci_14                 1.281204e-02 3 1  ON 13
ci_15                 5.171874e-03 3 1  ON 14
ci_16                 5.732294e-03 3 1  ON 15
ci_17                -5.020363e-03 3 1  ON 16
ci_18                -5.547066e-03 3 1  ON 17
ci_19                 1.032808e-02 3 1  ON 18
ci_20                 6.254760e-03 3 1  ON 19
ci_21                 8.483809e-03 3 1  ON 20
ci_22                 8.881285e-03 3 1  ON 21
ci_23                 4.170943e-03 3 1  ON 22
ci_24                 5.186266e-03 3 1  ON 23
ci_25                 3.012195e-03 3 1  ON 24
ci_26                 3.792425e-03 3 1  ON 25
ci_27                 3.288785e-03 3 1  ON 26
ci_28                 7.718172e-04 3 1  ON 27
ci_29                 1.186936e-03 3 1  ON 28
ci_30                -7.399271e-04 3 1  ON 29
ci_31                 1.032104e-03 3 1  ON 30
ci_32                -5.380048e-04 3 1  ON 31
ci_33                -1.033757e-03 3 1  ON 32
ci_34                 1.151880e-03 3 1  ON 33
ci_35                 1.248470e-03 3 1  ON 34
ci_36                -5.666493e-04 3 1  ON 35
ci_37                -5.190204e-04 3 1  ON 36
ci_38                -2.860630e-04 3 1  ON 37
ci_39                -1.425034e-04 3 1  ON 38
ci_40                -1.904150e-03 3 1  ON 39
ci_41                -5.149826e-04 3 1  ON 40
ci_42                -1.648122e-03 3 1  ON 41
ci_43                -1.294839e-03 3 1  ON 42
ci_44                -2.175804e-03 3 1  ON 43
ci_45                -2.661497e-04 3 1  ON 44
ci_46                -1.691837e-03 3 1  ON 45
ci_47                 1.435775e-03 3 1  ON 46
ci_48                 2.892084e-03 3 1  ON 47
ci_49                -8.541992e-04 3 1  ON 48
ci_50                -8.200768e-04 3 1  ON 49
ci_51                -5.664631e-04 3 1  ON 50
ci_52                -6.299529e-04 3 1  ON 51
ci_53                -8.013004e-04 3 1  ON 52
ci_54                -1.108957e-03 3 1  ON 53
ci_55                -1.235645e-03 3 1  ON 54
ci_56                 1.100366e-03 3 1  ON 55
ci_57                 2.088276e-03 3 1  ON 56
ci_58                -1.869758e-04 3 1  ON 57
ci_59                -6.202376e-04 3 1  ON 58
ci_60                 1.283282e-04 3 1  ON 59
ci_61                -9.877653e-04 3 1  ON 60
ci_62                -3.818208e-04 3 1  ON 61
ci_63                -2.473133e-04 3 1  ON 62
ci_64                -6.084601e-04 3 1  ON 63
ci_65                -1.069392e-04 3 1  ON 64
ci_66                -1.265927e-04 3 1  ON 65
ci_67                -1.933278e-04 3 1  ON 66
ci_68                -1.797005e-03 3 1  ON 67
ci_69                -1.806660e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7451
    reference variance = 0.327482
====================================================
  Execution time = 2.5592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6042e-01
  Total weights = 1.964704132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445795112050
                                         uncertainty =       0.006429254613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445795112050
                                         uncertainty =       0.006429254613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472118184
  error estimate for blocks of size 2^( 2) =       0.000497802397
  error estimate for blocks of size 2^( 3) =       0.000521545362
  error estimate for blocks of size 2^( 4) =       0.000538813440
  error estimate for blocks of size 2^( 5) =       0.000549263814
  error estimate for blocks of size 2^( 6) =       0.000555016819
  error estimate for blocks of size 2^( 7) =       0.000557130610

      target function =      -0.736786690532
              le_mean =     -22.815366473686
             les_mean =     521.001367727413
             stat err =       0.000550056171
             autocorr =       1.357414946017
   target nu stat err =       0.000550056171
   target dn stat err =       0.007329886586
      target stat err =       0.005955759659
              std dev =       0.667675938794
             le_variance =       0.445791159244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281536647369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736834191356       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736835681684       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736835909952       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736835963795       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736835975871       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736835980127       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736835980409       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736835980923       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736835980364       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736835980244       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 7.044151e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736834191356       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736834564180       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736834621263       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736834634724       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736834637742       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736834638804       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736834638874       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736834639003       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736834638863       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736834638833       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 1.761929e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736834191356       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736834284577       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736834298849       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736834302214       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736834302968       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736834303234       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736834303251       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736834303285       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736834303248       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736834303240       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 4.405379e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0111e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_01                 1.080409e-01 3 1  ON 0
ci_02                -2.400937e-02 3 1  ON 1
ci_03                -2.428489e-02 3 1  ON 2
ci_04                 2.216151e-02 3 1  ON 3
ci_05                -1.913418e-02 3 1  ON 4
ci_06                -1.952946e-02 3 1  ON 5
ci_07                 2.575900e-02 3 1  ON 6
ci_08                -4.226148e-03 3 1  ON 7
ci_09                -7.549857e-03 3 1  ON 8
ci_10                -7.705341e-03 3 1  ON 9
ci_11                 1.374774e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381521e-02 3 1  ON 12
ci_14                 1.281209e-02 3 1  ON 13
ci_15                 5.172196e-03 3 1  ON 14
ci_16                 5.732197e-03 3 1  ON 15
ci_17                -5.020830e-03 3 1  ON 16
ci_18                -5.547628e-03 3 1  ON 17
ci_19                 1.032727e-02 3 1  ON 18
ci_20                 6.254828e-03 3 1  ON 19
ci_21                 8.484239e-03 3 1  ON 20
ci_22                 8.882438e-03 3 1  ON 21
ci_23                 4.171012e-03 3 1  ON 22
ci_24                 5.186256e-03 3 1  ON 23
ci_25                 3.012208e-03 3 1  ON 24
ci_26                 3.792406e-03 3 1  ON 25
ci_27                 3.288995e-03 3 1  ON 26
ci_28                 7.719684e-04 3 1  ON 27
ci_29                 1.187113e-03 3 1  ON 28
ci_30                -7.397862e-04 3 1  ON 29
ci_31                 1.032512e-03 3 1  ON 30
ci_32                -5.383392e-04 3 1  ON 31
ci_33                -1.034604e-03 3 1  ON 32
ci_34                 1.152177e-03 3 1  ON 33
ci_35                 1.248492e-03 3 1  ON 34
ci_36                -5.669422e-04 3 1  ON 35
ci_37                -5.198928e-04 3 1  ON 36
ci_38                -2.860985e-04 3 1  ON 37
ci_39                -1.426962e-04 3 1  ON 38
ci_40                -1.904096e-03 3 1  ON 39
ci_41                -5.151834e-04 3 1  ON 40
ci_42                -1.648456e-03 3 1  ON 41
ci_43                -1.295143e-03 3 1  ON 42
ci_44                -2.176340e-03 3 1  ON 43
ci_45                -2.667151e-04 3 1  ON 44
ci_46                -1.691716e-03 3 1  ON 45
ci_47                 1.436523e-03 3 1  ON 46
ci_48                 2.892258e-03 3 1  ON 47
ci_49                -8.539498e-04 3 1  ON 48
ci_50                -8.199235e-04 3 1  ON 49
ci_51                -5.664742e-04 3 1  ON 50
ci_52                -6.299234e-04 3 1  ON 51
ci_53                -8.013351e-04 3 1  ON 52
ci_54                -1.108945e-03 3 1  ON 53
ci_55                -1.235603e-03 3 1  ON 54
ci_56                 1.100249e-03 3 1  ON 55
ci_57                 2.087998e-03 3 1  ON 56
ci_58                -1.871172e-04 3 1  ON 57
ci_59                -6.204360e-04 3 1  ON 58
ci_60                 1.280408e-04 3 1  ON 59
ci_61                -9.878633e-04 3 1  ON 60
ci_62                -3.814109e-04 3 1  ON 61
ci_63                -2.474666e-04 3 1  ON 62
ci_64                -6.083962e-04 3 1  ON 63
ci_65                -1.070535e-04 3 1  ON 64
ci_66                -1.269799e-04 3 1  ON 65
ci_67                -1.935492e-04 3 1  ON 66
ci_68                -1.796931e-03 3 1  ON 67
ci_69                -1.806395e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 0.503673
====================================================
  Execution time = 2.5195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4809e-01
  Total weights = 1.9647e+06
  Execution time = 3.5195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437082603132
                                         uncertainty =       0.002390344852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437082603132
                                         uncertainty =       0.002390344852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467490220
  error estimate for blocks of size 2^( 2) =       0.000492992826
  error estimate for blocks of size 2^( 3) =       0.000517433667
  error estimate for blocks of size 2^( 4) =       0.000535468673
  error estimate for blocks of size 2^( 5) =       0.000545636423
  error estimate for blocks of size 2^( 6) =       0.000551941836
  error estimate for blocks of size 2^( 7) =       0.000555178481

      target function =      -0.746932518207
              le_mean =     -22.814945714358
             les_mean =     520.969835756988
             stat err =       0.000547056353
             autocorr =       1.369364523692
   target nu stat err =       0.000547056353
   target dn stat err =       0.002730968982
      target stat err =       0.002347363805
              std dev =       0.661131009383
             le_variance =       0.437094211568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437081984885
                                         uncertainty =       0.002390264269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437081984885
                                         uncertainty =       0.002390264269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467489890
  error estimate for blocks of size 2^( 2) =       0.000492992241
  error estimate for blocks of size 2^( 3) =       0.000517432811
  error estimate for blocks of size 2^( 4) =       0.000535467609
  error estimate for blocks of size 2^( 5) =       0.000545635266
  error estimate for blocks of size 2^( 6) =       0.000551940682
  error estimate for blocks of size 2^( 7) =       0.000555177341

      target function =      -0.746932686904
              le_mean =     -22.814945675765
             les_mean =     520.969833791286
             stat err =       0.000547055225
             autocorr =       1.369360808104
   target nu stat err =       0.000547055225
   target dn stat err =       0.002731180512
      target stat err =       0.002347533992
              std dev =       0.661130542705
             le_variance =       0.437093594498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437082293254
                                         uncertainty =       0.002390304526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437082293254
                                         uncertainty =       0.002390304526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467490055
  error estimate for blocks of size 2^( 2) =       0.000492992533
  error estimate for blocks of size 2^( 3) =       0.000517433238
  error estimate for blocks of size 2^( 4) =       0.000535468140
  error estimate for blocks of size 2^( 5) =       0.000545635844
  error estimate for blocks of size 2^( 6) =       0.000551941259
  error estimate for blocks of size 2^( 7) =       0.000555177910

      target function =      -0.746932757996
              le_mean =     -22.814945694939
             les_mean =     520.969834581322
             stat err =       0.000547055788
             autocorr =       1.369362665757
   target nu stat err =       0.000547055788
   target dn stat err =       0.002731072079
      target stat err =       0.002347447703
              std dev =       0.661130775474
             le_variance =       0.437093902279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437082564326
                                         uncertainty =       0.002390339809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437082564326
                                         uncertainty =       0.002390339809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467490199
  error estimate for blocks of size 2^( 2) =       0.000492992789
  error estimate for blocks of size 2^( 3) =       0.000517433614
  error estimate for blocks of size 2^( 4) =       0.000535468606
  error estimate for blocks of size 2^( 5) =       0.000545636351
  error estimate for blocks of size 2^( 6) =       0.000551941764
  error estimate for blocks of size 2^( 7) =       0.000555178409

      target function =      -0.746932568641
              le_mean =     -22.814945711918
             les_mean =     520.969835584800
             stat err =       0.000547056282
             autocorr =       1.369364291505
   target nu stat err =       0.000547056282
   target dn stat err =       0.002730981574
      target stat err =       0.002347374180
              std dev =       0.661130980091
             le_variance =       0.437094172836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746932518207        initial
     5.6843e+01     5.6843e+02             7.0442e-06        -0.746932686904
     2.2737e+02     2.2737e+03             1.7619e-06        -0.746932757996  <--
     9.0949e+02     9.0949e+03             4.4054e-07        -0.746932568641

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 4.4526e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_01                 1.080409e-01 3 1  ON 0
ci_02                -2.400937e-02 3 1  ON 1
ci_03                -2.428489e-02 3 1  ON 2
ci_04                 2.216151e-02 3 1  ON 3
ci_05                -1.913418e-02 3 1  ON 4
ci_06                -1.952946e-02 3 1  ON 5
ci_07                 2.575900e-02 3 1  ON 6
ci_08                -4.226148e-03 3 1  ON 7
ci_09                -7.549857e-03 3 1  ON 8
ci_10                -7.705341e-03 3 1  ON 9
ci_11                 1.374774e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381521e-02 3 1  ON 12
ci_14                 1.281209e-02 3 1  ON 13
ci_15                 5.172196e-03 3 1  ON 14
ci_16                 5.732197e-03 3 1  ON 15
ci_17                -5.020830e-03 3 1  ON 16
ci_18                -5.547628e-03 3 1  ON 17
ci_19                 1.032727e-02 3 1  ON 18
ci_20                 6.254828e-03 3 1  ON 19
ci_21                 8.484239e-03 3 1  ON 20
ci_22                 8.882438e-03 3 1  ON 21
ci_23                 4.171012e-03 3 1  ON 22
ci_24                 5.186256e-03 3 1  ON 23
ci_25                 3.012208e-03 3 1  ON 24
ci_26                 3.792406e-03 3 1  ON 25
ci_27                 3.288995e-03 3 1  ON 26
ci_28                 7.719684e-04 3 1  ON 27
ci_29                 1.187113e-03 3 1  ON 28
ci_30                -7.397862e-04 3 1  ON 29
ci_31                 1.032512e-03 3 1  ON 30
ci_32                -5.383392e-04 3 1  ON 31
ci_33                -1.034604e-03 3 1  ON 32
ci_34                 1.152177e-03 3 1  ON 33
ci_35                 1.248492e-03 3 1  ON 34
ci_36                -5.669422e-04 3 1  ON 35
ci_37                -5.198928e-04 3 1  ON 36
ci_38                -2.860985e-04 3 1  ON 37
ci_39                -1.426962e-04 3 1  ON 38
ci_40                -1.904096e-03 3 1  ON 39
ci_41                -5.151834e-04 3 1  ON 40
ci_42                -1.648456e-03 3 1  ON 41
ci_43                -1.295143e-03 3 1  ON 42
ci_44                -2.176340e-03 3 1  ON 43
ci_45                -2.667151e-04 3 1  ON 44
ci_46                -1.691716e-03 3 1  ON 45
ci_47                 1.436523e-03 3 1  ON 46
ci_48                 2.892258e-03 3 1  ON 47
ci_49                -8.539498e-04 3 1  ON 48
ci_50                -8.199235e-04 3 1  ON 49
ci_51                -5.664742e-04 3 1  ON 50
ci_52                -6.299234e-04 3 1  ON 51
ci_53                -8.013351e-04 3 1  ON 52
ci_54                -1.108945e-03 3 1  ON 53
ci_55                -1.235603e-03 3 1  ON 54
ci_56                 1.100249e-03 3 1  ON 55
ci_57                 2.087998e-03 3 1  ON 56
ci_58                -1.871172e-04 3 1  ON 57
ci_59                -6.204360e-04 3 1  ON 58
ci_60                 1.280408e-04 3 1  ON 59
ci_61                -9.878633e-04 3 1  ON 60
ci_62                -3.814109e-04 3 1  ON 61
ci_63                -2.474666e-04 3 1  ON 62
ci_64                -6.083962e-04 3 1  ON 63
ci_65                -1.070535e-04 3 1  ON 64
ci_66                -1.269799e-04 3 1  ON 65
ci_67                -1.935492e-04 3 1  ON 66
ci_68                -1.796931e-03 3 1  ON 67
ci_69                -1.806395e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.9223
    reference variance = 0.552086
====================================================
  Execution time = 2.5598e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5407e-01
  Total weights = 1.964706861e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437846439334
                                         uncertainty =       0.002006755730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437846439334
                                         uncertainty =       0.002006755730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467877912
  error estimate for blocks of size 2^( 2) =       0.000493564719
  error estimate for blocks of size 2^( 3) =       0.000517921107
  error estimate for blocks of size 2^( 4) =       0.000536109174
  error estimate for blocks of size 2^( 5) =       0.000548300885
  error estimate for blocks of size 2^( 6) =       0.000556207569
  error estimate for blocks of size 2^( 7) =       0.000561077016

      target function =      -0.741997321387
              le_mean =     -22.813742778611
             les_mean =     520.920926656308
             stat err =       0.000550423661
             autocorr =       1.383977733294
   target nu stat err =       0.000550423661
   target dn stat err =       0.003844310164
      target stat err =       0.003201900430
              std dev =       0.661679288682
             le_variance =       0.437819481071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281374277861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742010078148       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742010379404       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742010409369       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742010417779       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742010419812       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742010420442       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742010421217       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742010421244       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742010421252       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 5.237329e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742010078148       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742010153511       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742010161004       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742010163107       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742010163615       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742010163772       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742010163966       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742010163973       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742010163975       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 1.309768e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742010078148       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742010096992       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742010098865       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742010099391       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742010099517       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742010099556       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742010099606       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742010099606       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742010099608       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 3.274692e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0099e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_01                 1.080422e-01 3 1  ON 0
ci_02                -2.401026e-02 3 1  ON 1
ci_03                -2.428535e-02 3 1  ON 2
ci_04                 2.216209e-02 3 1  ON 3
ci_05                -1.913445e-02 3 1  ON 4
ci_06                -1.952946e-02 3 1  ON 5
ci_07                 2.575919e-02 3 1  ON 6
ci_08                -4.226257e-03 3 1  ON 7
ci_09                -7.550012e-03 3 1  ON 8
ci_10                -7.705613e-03 3 1  ON 9
ci_11                 1.374758e-02 3 1  ON 10
ci_12                 7.046972e-03 3 1  ON 11
ci_13                 1.381514e-02 3 1  ON 12
ci_14                 1.281211e-02 3 1  ON 13
ci_15                 5.172343e-03 3 1  ON 14
ci_16                 5.732417e-03 3 1  ON 15
ci_17                -5.021041e-03 3 1  ON 16
ci_18                -5.547564e-03 3 1  ON 17
ci_19                 1.032700e-02 3 1  ON 18
ci_20                 6.254753e-03 3 1  ON 19
ci_21                 8.484051e-03 3 1  ON 20
ci_22                 8.882416e-03 3 1  ON 21
ci_23                 4.171098e-03 3 1  ON 22
ci_24                 5.186476e-03 3 1  ON 23
ci_25                 3.012202e-03 3 1  ON 24
ci_26                 3.792438e-03 3 1  ON 25
ci_27                 3.288959e-03 3 1  ON 26
ci_28                 7.718443e-04 3 1  ON 27
ci_29                 1.186892e-03 3 1  ON 28
ci_30                -7.398622e-04 3 1  ON 29
ci_31                 1.032196e-03 3 1  ON 30
ci_32                -5.385982e-04 3 1  ON 31
ci_33                -1.034613e-03 3 1  ON 32
ci_34                 1.152304e-03 3 1  ON 33
ci_35                 1.248533e-03 3 1  ON 34
ci_36                -5.672371e-04 3 1  ON 35
ci_37                -5.200338e-04 3 1  ON 36
ci_38                -2.860826e-04 3 1  ON 37
ci_39                -1.427501e-04 3 1  ON 38
ci_40                -1.904058e-03 3 1  ON 39
ci_41                -5.153889e-04 3 1  ON 40
ci_42                -1.648372e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176498e-03 3 1  ON 43
ci_45                -2.668178e-04 3 1  ON 44
ci_46                -1.691415e-03 3 1  ON 45
ci_47                 1.436432e-03 3 1  ON 46
ci_48                 2.892177e-03 3 1  ON 47
ci_49                -8.539808e-04 3 1  ON 48
ci_50                -8.198859e-04 3 1  ON 49
ci_51                -5.663649e-04 3 1  ON 50
ci_52                -6.297363e-04 3 1  ON 51
ci_53                -8.013899e-04 3 1  ON 52
ci_54                -1.109003e-03 3 1  ON 53
ci_55                -1.235728e-03 3 1  ON 54
ci_56                 1.100733e-03 3 1  ON 55
ci_57                 2.088102e-03 3 1  ON 56
ci_58                -1.873363e-04 3 1  ON 57
ci_59                -6.205959e-04 3 1  ON 58
ci_60                 1.281601e-04 3 1  ON 59
ci_61                -9.878880e-04 3 1  ON 60
ci_62                -3.814574e-04 3 1  ON 61
ci_63                -2.474749e-04 3 1  ON 62
ci_64                -6.082718e-04 3 1  ON 63
ci_65                -1.070896e-04 3 1  ON 64
ci_66                -1.270077e-04 3 1  ON 65
ci_67                -1.936101e-04 3 1  ON 66
ci_68                -1.796736e-03 3 1  ON 67
ci_69                -1.806254e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8826
    reference variance = 0.270885
====================================================
  Execution time = 2.5017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4579e-01
  Total weights = 1.9645e+06
  Execution time = 3.5207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418135602
                                         uncertainty =       0.001833317527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418135602
                                         uncertainty =       0.001833317527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466065667
  error estimate for blocks of size 2^( 2) =       0.000492218415
  error estimate for blocks of size 2^( 3) =       0.000516844806
  error estimate for blocks of size 2^( 4) =       0.000535480413
  error estimate for blocks of size 2^( 5) =       0.000546969330
  error estimate for blocks of size 2^( 6) =       0.000552661660
  error estimate for blocks of size 2^( 7) =       0.000557378237

      target function =      -0.748838963130
              le_mean =     -22.814032335235
             les_mean =     520.925861454652
             stat err =       0.000548122410
             autocorr =       1.383123287262
   target nu stat err =       0.000548122410
   target dn stat err =       0.002469322696
      target stat err =       0.002146203968
              std dev =       0.659116387634
             le_variance =       0.434434412448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418086027
                                         uncertainty =       0.001833367341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418086027
                                         uncertainty =       0.001833367341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466065640
  error estimate for blocks of size 2^( 2) =       0.000492218131
  error estimate for blocks of size 2^( 3) =       0.000516844245
  error estimate for blocks of size 2^( 4) =       0.000535479638
  error estimate for blocks of size 2^( 5) =       0.000546968424
  error estimate for blocks of size 2^( 6) =       0.000552660696
  error estimate for blocks of size 2^( 7) =       0.000557377240

      target function =      -0.748834178019
              le_mean =     -22.814032336931
             les_mean =     520.925867271744
             stat err =       0.000548121499
             autocorr =       1.383118856237
   target nu stat err =       0.000548121499
   target dn stat err =       0.002469821506
      target stat err =       0.002146575891
              std dev =       0.659116348344
             le_variance =       0.434434360654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418110616
                                         uncertainty =       0.001833342442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418110616
                                         uncertainty =       0.001833342442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466065653
  error estimate for blocks of size 2^( 2) =       0.000492218273
  error estimate for blocks of size 2^( 3) =       0.000516844525
  error estimate for blocks of size 2^( 4) =       0.000535480025
  error estimate for blocks of size 2^( 5) =       0.000546968877
  error estimate for blocks of size 2^( 6) =       0.000552661178
  error estimate for blocks of size 2^( 7) =       0.000557377738

      target function =      -0.748836599454
              le_mean =     -22.814032336056
             les_mean =     520.925864327297
             stat err =       0.000548121954
             autocorr =       1.383121070578
   target nu stat err =       0.000548121954
   target dn stat err =       0.002469570937
      target stat err =       0.002146389159
              std dev =       0.659116367837
             le_variance =       0.434434386351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418132460
                                         uncertainty =       0.001833320641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434418132460
                                         uncertainty =       0.001833320641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466065666
  error estimate for blocks of size 2^( 2) =       0.000492218397
  error estimate for blocks of size 2^( 3) =       0.000516844771
  error estimate for blocks of size 2^( 4) =       0.000535480364
  error estimate for blocks of size 2^( 5) =       0.000546969273
  error estimate for blocks of size 2^( 6) =       0.000552661600
  error estimate for blocks of size 2^( 7) =       0.000557378175

      target function =      -0.748838670804
              le_mean =     -22.814032335334
             les_mean =     520.925861809837
             stat err =       0.000548122353
             autocorr =       1.383123010148
   target nu stat err =       0.000548122353
   target dn stat err =       0.002469353594
      target stat err =       0.002146227028
              std dev =       0.659116385146
             le_variance =       0.434434409168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748838963130        initial  <--
     5.6843e+01     5.6843e+02             5.2373e-06        -0.748834178019
     2.2737e+02     2.2737e+03             1.3098e-06        -0.748836599454
     9.0949e+02     9.0949e+03             3.2747e-07        -0.748838670804

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6211
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_01                 1.080409e-01 3 1  ON 0
ci_02                -2.400937e-02 3 1  ON 1
ci_03                -2.428489e-02 3 1  ON 2
ci_04                 2.216151e-02 3 1  ON 3
ci_05                -1.913418e-02 3 1  ON 4
ci_06                -1.952946e-02 3 1  ON 5
ci_07                 2.575900e-02 3 1  ON 6
ci_08                -4.226148e-03 3 1  ON 7
ci_09                -7.549857e-03 3 1  ON 8
ci_10                -7.705341e-03 3 1  ON 9
ci_11                 1.374774e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381521e-02 3 1  ON 12
ci_14                 1.281209e-02 3 1  ON 13
ci_15                 5.172196e-03 3 1  ON 14
ci_16                 5.732197e-03 3 1  ON 15
ci_17                -5.020830e-03 3 1  ON 16
ci_18                -5.547628e-03 3 1  ON 17
ci_19                 1.032727e-02 3 1  ON 18
ci_20                 6.254828e-03 3 1  ON 19
ci_21                 8.484239e-03 3 1  ON 20
ci_22                 8.882438e-03 3 1  ON 21
ci_23                 4.171012e-03 3 1  ON 22
ci_24                 5.186256e-03 3 1  ON 23
ci_25                 3.012208e-03 3 1  ON 24
ci_26                 3.792406e-03 3 1  ON 25
ci_27                 3.288995e-03 3 1  ON 26
ci_28                 7.719684e-04 3 1  ON 27
ci_29                 1.187113e-03 3 1  ON 28
ci_30                -7.397862e-04 3 1  ON 29
ci_31                 1.032512e-03 3 1  ON 30
ci_32                -5.383392e-04 3 1  ON 31
ci_33                -1.034604e-03 3 1  ON 32
ci_34                 1.152177e-03 3 1  ON 33
ci_35                 1.248492e-03 3 1  ON 34
ci_36                -5.669422e-04 3 1  ON 35
ci_37                -5.198928e-04 3 1  ON 36
ci_38                -2.860985e-04 3 1  ON 37
ci_39                -1.426962e-04 3 1  ON 38
ci_40                -1.904096e-03 3 1  ON 39
ci_41                -5.151834e-04 3 1  ON 40
ci_42                -1.648456e-03 3 1  ON 41
ci_43                -1.295143e-03 3 1  ON 42
ci_44                -2.176340e-03 3 1  ON 43
ci_45                -2.667151e-04 3 1  ON 44
ci_46                -1.691716e-03 3 1  ON 45
ci_47                 1.436523e-03 3 1  ON 46
ci_48                 2.892258e-03 3 1  ON 47
ci_49                -8.539498e-04 3 1  ON 48
ci_50                -8.199235e-04 3 1  ON 49
ci_51                -5.664742e-04 3 1  ON 50
ci_52                -6.299234e-04 3 1  ON 51
ci_53                -8.013351e-04 3 1  ON 52
ci_54                -1.108945e-03 3 1  ON 53
ci_55                -1.235603e-03 3 1  ON 54
ci_56                 1.100249e-03 3 1  ON 55
ci_57                 2.087998e-03 3 1  ON 56
ci_58                -1.871172e-04 3 1  ON 57
ci_59                -6.204360e-04 3 1  ON 58
ci_60                 1.280408e-04 3 1  ON 59
ci_61                -9.878633e-04 3 1  ON 60
ci_62                -3.814109e-04 3 1  ON 61
ci_63                -2.474666e-04 3 1  ON 62
ci_64                -6.083962e-04 3 1  ON 63
ci_65                -1.070535e-04 3 1  ON 64
ci_66                -1.269799e-04 3 1  ON 65
ci_67                -1.935492e-04 3 1  ON 66
ci_68                -1.796931e-03 3 1  ON 67
ci_69                -1.806395e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.733
    reference variance = 0.320749
====================================================
  Execution time = 2.5510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5368e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5009e-01
  Total weights = 1.964775429e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436534192044
                                         uncertainty =       0.001613352780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436534192044
                                         uncertainty =       0.001613352780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467198365
  error estimate for blocks of size 2^( 2) =       0.000492877481
  error estimate for blocks of size 2^( 3) =       0.000517542112
  error estimate for blocks of size 2^( 4) =       0.000535974263
  error estimate for blocks of size 2^( 5) =       0.000547657106
  error estimate for blocks of size 2^( 6) =       0.000555273770
  error estimate for blocks of size 2^( 7) =       0.000557424099

      target function =      -0.745271235896
              le_mean =     -22.814319531124
             les_mean =     520.943268134308
             stat err =       0.000549082310
             autocorr =       1.381249950335
   target nu stat err =       0.000549082310
   target dn stat err =       0.002577149295
      target stat err =       0.002213305485
              std dev =       0.660718263820
             le_variance =       0.436548624145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431953112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745276860059       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745276889529       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745276896544       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745276897762       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745276899038       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745276899142       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745276899108       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745276899116       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745276899132       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 7.892492e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745276860059       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745276867427       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745276869181       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745276869485       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745276869803       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745276869827       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745276869821       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745276869825       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745276869824       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 1.973188e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745276860059       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745276861901       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745276862340       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745276862416       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745276862493       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745276862489       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745276862496       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745276862501       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745276862507       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 4.933012e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0093e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_01                 1.080411e-01 3 1  ON 0
ci_02                -2.400943e-02 3 1  ON 1
ci_03                -2.428495e-02 3 1  ON 2
ci_04                 2.216155e-02 3 1  ON 3
ci_05                -1.913419e-02 3 1  ON 4
ci_06                -1.952951e-02 3 1  ON 5
ci_07                 2.575903e-02 3 1  ON 6
ci_08                -4.226157e-03 3 1  ON 7
ci_09                -7.549893e-03 3 1  ON 8
ci_10                -7.705377e-03 3 1  ON 9
ci_11                 1.374775e-02 3 1  ON 10
ci_12                 7.046922e-03 3 1  ON 11
ci_13                 1.381521e-02 3 1  ON 12
ci_14                 1.281207e-02 3 1  ON 13
ci_15                 5.172215e-03 3 1  ON 14
ci_16                 5.732217e-03 3 1  ON 15
ci_17                -5.020865e-03 3 1  ON 16
ci_18                -5.547637e-03 3 1  ON 17
ci_19                 1.032726e-02 3 1  ON 18
ci_20                 6.254802e-03 3 1  ON 19
ci_21                 8.484239e-03 3 1  ON 20
ci_22                 8.882437e-03 3 1  ON 21
ci_23                 4.171016e-03 3 1  ON 22
ci_24                 5.186260e-03 3 1  ON 23
ci_25                 3.012198e-03 3 1  ON 24
ci_26                 3.792420e-03 3 1  ON 25
ci_27                 3.288989e-03 3 1  ON 26
ci_28                 7.719820e-04 3 1  ON 27
ci_29                 1.187127e-03 3 1  ON 28
ci_30                -7.397937e-04 3 1  ON 29
ci_31                 1.032487e-03 3 1  ON 30
ci_32                -5.383572e-04 3 1  ON 31
ci_33                -1.034618e-03 3 1  ON 32
ci_34                 1.152164e-03 3 1  ON 33
ci_35                 1.248501e-03 3 1  ON 34
ci_36                -5.669585e-04 3 1  ON 35
ci_37                -5.198997e-04 3 1  ON 36
ci_38                -2.860866e-04 3 1  ON 37
ci_39                -1.427015e-04 3 1  ON 38
ci_40                -1.904077e-03 3 1  ON 39
ci_41                -5.151884e-04 3 1  ON 40
ci_42                -1.648462e-03 3 1  ON 41
ci_43                -1.295161e-03 3 1  ON 42
ci_44                -2.176341e-03 3 1  ON 43
ci_45                -2.667204e-04 3 1  ON 44
ci_46                -1.691687e-03 3 1  ON 45
ci_47                 1.436527e-03 3 1  ON 46
ci_48                 2.892231e-03 3 1  ON 47
ci_49                -8.539621e-04 3 1  ON 48
ci_50                -8.199171e-04 3 1  ON 49
ci_51                -5.664577e-04 3 1  ON 50
ci_52                -6.298963e-04 3 1  ON 51
ci_53                -8.013446e-04 3 1  ON 52
ci_54                -1.108931e-03 3 1  ON 53
ci_55                -1.235605e-03 3 1  ON 54
ci_56                 1.100262e-03 3 1  ON 55
ci_57                 2.087979e-03 3 1  ON 56
ci_58                -1.871442e-04 3 1  ON 57
ci_59                -6.204362e-04 3 1  ON 58
ci_60                 1.280400e-04 3 1  ON 59
ci_61                -9.878579e-04 3 1  ON 60
ci_62                -3.814071e-04 3 1  ON 61
ci_63                -2.474511e-04 3 1  ON 62
ci_64                -6.083944e-04 3 1  ON 63
ci_65                -1.070492e-04 3 1  ON 64
ci_66                -1.269797e-04 3 1  ON 65
ci_67                -1.935411e-04 3 1  ON 66
ci_68                -1.796913e-03 3 1  ON 67
ci_69                -1.806363e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7317
    reference variance = 0.403128
====================================================
  Execution time = 2.4911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4361e-01
  Total weights = 1.9650e+06
  Execution time = 3.5110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261867729
                                         uncertainty =       0.001650002291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261867729
                                         uncertainty =       0.001650002291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464288103
  error estimate for blocks of size 2^( 2) =       0.000490286573
  error estimate for blocks of size 2^( 3) =       0.000514414660
  error estimate for blocks of size 2^( 4) =       0.000533070424
  error estimate for blocks of size 2^( 5) =       0.000544013439
  error estimate for blocks of size 2^( 6) =       0.000551062386
  error estimate for blocks of size 2^( 7) =       0.000552316923

      target function =      -0.750662307327
              le_mean =     -22.814354103806
             les_mean =     520.938364847352
             stat err =       0.000545115793
             autocorr =       1.378486185562
   target nu stat err =       0.000545115793
   target dn stat err =       0.002449790802
      target stat err =       0.002140634361
              std dev =       0.656602532276
             le_variance =       0.431126885391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261840445
                                         uncertainty =       0.001650001487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261840445
                                         uncertainty =       0.001650001487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464288088
  error estimate for blocks of size 2^( 2) =       0.000490286531
  error estimate for blocks of size 2^( 3) =       0.000514414588
  error estimate for blocks of size 2^( 4) =       0.000533070328
  error estimate for blocks of size 2^( 5) =       0.000544013330
  error estimate for blocks of size 2^( 6) =       0.000551062261
  error estimate for blocks of size 2^( 7) =       0.000552316803

      target function =      -0.750662810301
              le_mean =     -22.814354101375
             les_mean =     520.938364136061
             stat err =       0.000545115680
             autocorr =       1.378485703710
   target nu stat err =       0.000545115680
   target dn stat err =       0.002449785507
      target stat err =       0.002140632817
              std dev =       0.656602511406
             le_variance =       0.431126857985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261854084
                                         uncertainty =       0.001650001889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261854084
                                         uncertainty =       0.001650001889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464288096
  error estimate for blocks of size 2^( 2) =       0.000490286552
  error estimate for blocks of size 2^( 3) =       0.000514414624
  error estimate for blocks of size 2^( 4) =       0.000533070376
  error estimate for blocks of size 2^( 5) =       0.000544013384
  error estimate for blocks of size 2^( 6) =       0.000551062324
  error estimate for blocks of size 2^( 7) =       0.000552316863

      target function =      -0.750662559527
              le_mean =     -22.814354102590
             les_mean =     520.938364490842
             stat err =       0.000545115737
             autocorr =       1.378485944622
   target nu stat err =       0.000545115737
   target dn stat err =       0.002449788100
      target stat err =       0.002140633549
              std dev =       0.656602521839
             le_variance =       0.431126871685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261866023
                                         uncertainty =       0.001650002241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431261866023
                                         uncertainty =       0.001650002241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464288102
  error estimate for blocks of size 2^( 2) =       0.000490286570
  error estimate for blocks of size 2^( 3) =       0.000514414656
  error estimate for blocks of size 2^( 4) =       0.000533070418
  error estimate for blocks of size 2^( 5) =       0.000544013432
  error estimate for blocks of size 2^( 6) =       0.000551062379
  error estimate for blocks of size 2^( 7) =       0.000552316916

      target function =      -0.750662338930
              le_mean =     -22.814354103654
             les_mean =     520.938364802694
             stat err =       0.000545115786
             autocorr =       1.378486155436
   target nu stat err =       0.000545115786
   target dn stat err =       0.002449790458
      target stat err =       0.002140634255
              std dev =       0.656602530971
             le_variance =       0.431126883678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750662307327        initial
     5.6843e+02     5.6843e+03             7.8925e-07        -0.750662810301  <--
     2.2737e+03     2.2737e+04             1.9732e-07        -0.750662559527
     9.0949e+03     9.0949e+04             4.9330e-08        -0.750662338930

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 4.2474e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_01                 1.080417e-01 3 1  ON 0
ci_02                -2.400961e-02 3 1  ON 1
ci_03                -2.428511e-02 3 1  ON 2
ci_04                 2.216170e-02 3 1  ON 3
ci_05                -1.913424e-02 3 1  ON 4
ci_06                -1.952967e-02 3 1  ON 5
ci_07                 2.575910e-02 3 1  ON 6
ci_08                -4.226184e-03 3 1  ON 7
ci_09                -7.550003e-03 3 1  ON 8
ci_10                -7.705485e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046924e-03 3 1  ON 11
ci_13                 1.381520e-02 3 1  ON 12
ci_14                 1.281203e-02 3 1  ON 13
ci_15                 5.172275e-03 3 1  ON 14
ci_16                 5.732277e-03 3 1  ON 15
ci_17                -5.020971e-03 3 1  ON 16
ci_18                -5.547666e-03 3 1  ON 17
ci_19                 1.032722e-02 3 1  ON 18
ci_20                 6.254723e-03 3 1  ON 19
ci_21                 8.484241e-03 3 1  ON 20
ci_22                 8.882434e-03 3 1  ON 21
ci_23                 4.171028e-03 3 1  ON 22
ci_24                 5.186270e-03 3 1  ON 23
ci_25                 3.012168e-03 3 1  ON 24
ci_26                 3.792461e-03 3 1  ON 25
ci_27                 3.288972e-03 3 1  ON 26
ci_28                 7.720229e-04 3 1  ON 27
ci_29                 1.187168e-03 3 1  ON 28
ci_30                -7.398165e-04 3 1  ON 29
ci_31                 1.032411e-03 3 1  ON 30
ci_32                -5.384114e-04 3 1  ON 31
ci_33                -1.034660e-03 3 1  ON 32
ci_34                 1.152123e-03 3 1  ON 33
ci_35                 1.248525e-03 3 1  ON 34
ci_36                -5.670074e-04 3 1  ON 35
ci_37                -5.199203e-04 3 1  ON 36
ci_38                -2.860509e-04 3 1  ON 37
ci_39                -1.427175e-04 3 1  ON 38
ci_40                -1.904021e-03 3 1  ON 39
ci_41                -5.152031e-04 3 1  ON 40
ci_42                -1.648480e-03 3 1  ON 41
ci_43                -1.295216e-03 3 1  ON 42
ci_44                -2.176347e-03 3 1  ON 43
ci_45                -2.667363e-04 3 1  ON 44
ci_46                -1.691598e-03 3 1  ON 45
ci_47                 1.436541e-03 3 1  ON 46
ci_48                 2.892150e-03 3 1  ON 47
ci_49                -8.539988e-04 3 1  ON 48
ci_50                -8.198980e-04 3 1  ON 49
ci_51                -5.664083e-04 3 1  ON 50
ci_52                -6.298152e-04 3 1  ON 51
ci_53                -8.013732e-04 3 1  ON 52
ci_54                -1.108887e-03 3 1  ON 53
ci_55                -1.235610e-03 3 1  ON 54
ci_56                 1.100298e-03 3 1  ON 55
ci_57                 2.087920e-03 3 1  ON 56
ci_58                -1.872253e-04 3 1  ON 57
ci_59                -6.204368e-04 3 1  ON 58
ci_60                 1.280377e-04 3 1  ON 59
ci_61                -9.878416e-04 3 1  ON 60
ci_62                -3.813958e-04 3 1  ON 61
ci_63                -2.474046e-04 3 1  ON 62
ci_64                -6.083892e-04 3 1  ON 63
ci_65                -1.070365e-04 3 1  ON 64
ci_66                -1.269789e-04 3 1  ON 65
ci_67                -1.935169e-04 3 1  ON 66
ci_68                -1.796860e-03 3 1  ON 67
ci_69                -1.806269e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7877
    reference variance = 0.875211
====================================================
  Execution time = 2.7622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5517e-01
  Total weights = 1.964980392e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437356872748
                                         uncertainty =       0.006881781008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437356872748
                                         uncertainty =       0.006881781008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467613201
  error estimate for blocks of size 2^( 2) =       0.000493131865
  error estimate for blocks of size 2^( 3) =       0.000517206520
  error estimate for blocks of size 2^( 4) =       0.000535766458
  error estimate for blocks of size 2^( 5) =       0.000547405946
  error estimate for blocks of size 2^( 6) =       0.000553022473
  error estimate for blocks of size 2^( 7) =       0.000558189067

      target function =      -0.740941125002
              le_mean =     -22.814580196320
             les_mean =     520.960237736266
             stat err =       0.000548595986
             autocorr =       1.376358991135
   target nu stat err =       0.000548595986
   target dn stat err =       0.013688543200
      target stat err =       0.011195308357
              std dev =       0.661304931114
             le_variance =       0.437324211916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281458019632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741108115660       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741108535334       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741108588444       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741108587875       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741108594994       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741108598512       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741108598746       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741108599922       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741108599580       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741108599508       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741108599313       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 4.026675e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741108115660       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741108220606       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741108233883       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741108233740       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741108235519       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741108236398       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741108236457       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741108236752       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741108236666       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741108236647       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741108236600       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 1.006836e-06

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741108115660       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741108141898       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741108145218       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741108145182       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741108145625       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741108145848       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741108145864       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741108145939       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741108145911       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741108145912       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741108145895       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 2.517195e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2103e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_01                 1.080425e-01 3 1  ON 0
ci_02                -2.400995e-02 3 1  ON 1
ci_03                -2.428548e-02 3 1  ON 2
ci_04                 2.216197e-02 3 1  ON 3
ci_05                -1.913429e-02 3 1  ON 4
ci_06                -1.952951e-02 3 1  ON 5
ci_07                 2.575947e-02 3 1  ON 6
ci_08                -4.226232e-03 3 1  ON 7
ci_09                -7.550006e-03 3 1  ON 8
ci_10                -7.705429e-03 3 1  ON 9
ci_11                 1.374779e-02 3 1  ON 10
ci_12                 7.046884e-03 3 1  ON 11
ci_13                 1.381615e-02 3 1  ON 12
ci_14                 1.281150e-02 3 1  ON 13
ci_15                 5.172336e-03 3 1  ON 14
ci_16                 5.732414e-03 3 1  ON 15
ci_17                -5.021062e-03 3 1  ON 16
ci_18                -5.547531e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254844e-03 3 1  ON 19
ci_21                 8.485248e-03 3 1  ON 20
ci_22                 8.882436e-03 3 1  ON 21
ci_23                 4.171129e-03 3 1  ON 22
ci_24                 5.186223e-03 3 1  ON 23
ci_25                 3.012206e-03 3 1  ON 24
ci_26                 3.792364e-03 3 1  ON 25
ci_27                 3.289072e-03 3 1  ON 26
ci_28                 7.720750e-04 3 1  ON 27
ci_29                 1.187268e-03 3 1  ON 28
ci_30                -7.395403e-04 3 1  ON 29
ci_31                 1.032594e-03 3 1  ON 30
ci_32                -5.383769e-04 3 1  ON 31
ci_33                -1.034636e-03 3 1  ON 32
ci_34                 1.152374e-03 3 1  ON 33
ci_35                 1.248608e-03 3 1  ON 34
ci_36                -5.672801e-04 3 1  ON 35
ci_37                -5.197212e-04 3 1  ON 36
ci_38                -2.860342e-04 3 1  ON 37
ci_39                -1.425872e-04 3 1  ON 38
ci_40                -1.903991e-03 3 1  ON 39
ci_41                -5.152932e-04 3 1  ON 40
ci_42                -1.648422e-03 3 1  ON 41
ci_43                -1.295106e-03 3 1  ON 42
ci_44                -2.176271e-03 3 1  ON 43
ci_45                -2.666755e-04 3 1  ON 44
ci_46                -1.691578e-03 3 1  ON 45
ci_47                 1.436912e-03 3 1  ON 46
ci_48                 2.891944e-03 3 1  ON 47
ci_49                -8.540188e-04 3 1  ON 48
ci_50                -8.200788e-04 3 1  ON 49
ci_51                -5.663045e-04 3 1  ON 50
ci_52                -6.296931e-04 3 1  ON 51
ci_53                -8.013200e-04 3 1  ON 52
ci_54                -1.108781e-03 3 1  ON 53
ci_55                -1.235352e-03 3 1  ON 54
ci_56                 1.100338e-03 3 1  ON 55
ci_57                 2.088002e-03 3 1  ON 56
ci_58                -1.872989e-04 3 1  ON 57
ci_59                -6.204738e-04 3 1  ON 58
ci_60                 1.278309e-04 3 1  ON 59
ci_61                -9.878995e-04 3 1  ON 60
ci_62                -3.813615e-04 3 1  ON 61
ci_63                -2.474555e-04 3 1  ON 62
ci_64                -6.083861e-04 3 1  ON 63
ci_65                -1.070299e-04 3 1  ON 64
ci_66                -1.271345e-04 3 1  ON 65
ci_67                -1.935943e-04 3 1  ON 66
ci_68                -1.796783e-03 3 1  ON 67
ci_69                -1.806118e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6674
    reference variance = 0.350557
====================================================
  Execution time = 2.4924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5071e-01
  Total weights = 1.9645e+06
  Execution time = 3.5079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106939181
                                         uncertainty =       0.002431309065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106939181
                                         uncertainty =       0.002431309065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466453925
  error estimate for blocks of size 2^( 2) =       0.000492108822
  error estimate for blocks of size 2^( 3) =       0.000516446151
  error estimate for blocks of size 2^( 4) =       0.000535050969
  error estimate for blocks of size 2^( 5) =       0.000547599004
  error estimate for blocks of size 2^( 6) =       0.000554910570
  error estimate for blocks of size 2^( 7) =       0.000558796287

      target function =      -0.744757682225
              le_mean =     -22.814556359788
             les_mean =     520.954690212109
             stat err =       0.000549089208
             autocorr =       1.385697110966
   target nu stat err =       0.000549089208
   target dn stat err =       0.003610131146
      target stat err =       0.003039458782
              std dev =       0.659665467172
             le_variance =       0.435158528579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106869500
                                         uncertainty =       0.002431398271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106869500
                                         uncertainty =       0.002431398271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466453889
  error estimate for blocks of size 2^( 2) =       0.000492108656
  error estimate for blocks of size 2^( 3) =       0.000516445824
  error estimate for blocks of size 2^( 4) =       0.000535050557
  error estimate for blocks of size 2^( 5) =       0.000547598481
  error estimate for blocks of size 2^( 6) =       0.000554909966
  error estimate for blocks of size 2^( 7) =       0.000558795729

      target function =      -0.744738433829
              le_mean =     -22.814556351713
             les_mean =     520.954713180238
             stat err =       0.000549088683
             autocorr =       1.385694680308
   target nu stat err =       0.000549088683
   target dn stat err =       0.003610003240
      target stat err =       0.003039201289
              std dev =       0.659665416008
             le_variance =       0.435158461077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106904131
                                         uncertainty =       0.002431353669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106904131
                                         uncertainty =       0.002431353669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466453907
  error estimate for blocks of size 2^( 2) =       0.000492108739
  error estimate for blocks of size 2^( 3) =       0.000516445988
  error estimate for blocks of size 2^( 4) =       0.000535050763
  error estimate for blocks of size 2^( 5) =       0.000547598744
  error estimate for blocks of size 2^( 6) =       0.000554910269
  error estimate for blocks of size 2^( 7) =       0.000558796009

      target function =      -0.744754956845
              le_mean =     -22.814556355490
             les_mean =     520.954693320927
             stat err =       0.000549088946
             autocorr =       1.385695900253
   target nu stat err =       0.000549088946
   target dn stat err =       0.003610015400
      target stat err =       0.003039343354
              std dev =       0.659665441432
             le_variance =       0.435158494620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106934777
                                         uncertainty =       0.002431314639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435106934777
                                         uncertainty =       0.002431314639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466453923
  error estimate for blocks of size 2^( 2) =       0.000492108811
  error estimate for blocks of size 2^( 3) =       0.000516446131
  error estimate for blocks of size 2^( 4) =       0.000535050943
  error estimate for blocks of size 2^( 5) =       0.000547598972
  error estimate for blocks of size 2^( 6) =       0.000554910533
  error estimate for blocks of size 2^( 7) =       0.000558796252

      target function =      -0.744757527759
              le_mean =     -22.814556359239
             les_mean =     520.954690374453
             stat err =       0.000549089175
             autocorr =       1.385696959822
   target nu stat err =       0.000549089175
   target dn stat err =       0.003610116068
      target stat err =       0.003039445350
              std dev =       0.659665463938
             le_variance =       0.435158524312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744757682225        initial  <--
     1.4211e+02     1.4211e+03             4.0267e-06        -0.744738433829
     5.6843e+02     5.6843e+03             1.0068e-06        -0.744754956845
     2.2737e+03     2.2737e+04             2.5172e-07        -0.744757527759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5869
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_01                 1.080417e-01 3 1  ON 0
ci_02                -2.400961e-02 3 1  ON 1
ci_03                -2.428511e-02 3 1  ON 2
ci_04                 2.216170e-02 3 1  ON 3
ci_05                -1.913424e-02 3 1  ON 4
ci_06                -1.952967e-02 3 1  ON 5
ci_07                 2.575910e-02 3 1  ON 6
ci_08                -4.226184e-03 3 1  ON 7
ci_09                -7.550003e-03 3 1  ON 8
ci_10                -7.705485e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046924e-03 3 1  ON 11
ci_13                 1.381520e-02 3 1  ON 12
ci_14                 1.281203e-02 3 1  ON 13
ci_15                 5.172275e-03 3 1  ON 14
ci_16                 5.732277e-03 3 1  ON 15
ci_17                -5.020971e-03 3 1  ON 16
ci_18                -5.547666e-03 3 1  ON 17
ci_19                 1.032722e-02 3 1  ON 18
ci_20                 6.254723e-03 3 1  ON 19
ci_21                 8.484241e-03 3 1  ON 20
ci_22                 8.882434e-03 3 1  ON 21
ci_23                 4.171028e-03 3 1  ON 22
ci_24                 5.186270e-03 3 1  ON 23
ci_25                 3.012168e-03 3 1  ON 24
ci_26                 3.792461e-03 3 1  ON 25
ci_27                 3.288972e-03 3 1  ON 26
ci_28                 7.720229e-04 3 1  ON 27
ci_29                 1.187168e-03 3 1  ON 28
ci_30                -7.398165e-04 3 1  ON 29
ci_31                 1.032411e-03 3 1  ON 30
ci_32                -5.384114e-04 3 1  ON 31
ci_33                -1.034660e-03 3 1  ON 32
ci_34                 1.152123e-03 3 1  ON 33
ci_35                 1.248525e-03 3 1  ON 34
ci_36                -5.670074e-04 3 1  ON 35
ci_37                -5.199203e-04 3 1  ON 36
ci_38                -2.860509e-04 3 1  ON 37
ci_39                -1.427175e-04 3 1  ON 38
ci_40                -1.904021e-03 3 1  ON 39
ci_41                -5.152031e-04 3 1  ON 40
ci_42                -1.648480e-03 3 1  ON 41
ci_43                -1.295216e-03 3 1  ON 42
ci_44                -2.176347e-03 3 1  ON 43
ci_45                -2.667363e-04 3 1  ON 44
ci_46                -1.691598e-03 3 1  ON 45
ci_47                 1.436541e-03 3 1  ON 46
ci_48                 2.892150e-03 3 1  ON 47
ci_49                -8.539988e-04 3 1  ON 48
ci_50                -8.198980e-04 3 1  ON 49
ci_51                -5.664083e-04 3 1  ON 50
ci_52                -6.298152e-04 3 1  ON 51
ci_53                -8.013732e-04 3 1  ON 52
ci_54                -1.108887e-03 3 1  ON 53
ci_55                -1.235610e-03 3 1  ON 54
ci_56                 1.100298e-03 3 1  ON 55
ci_57                 2.087920e-03 3 1  ON 56
ci_58                -1.872253e-04 3 1  ON 57
ci_59                -6.204368e-04 3 1  ON 58
ci_60                 1.280377e-04 3 1  ON 59
ci_61                -9.878416e-04 3 1  ON 60
ci_62                -3.813958e-04 3 1  ON 61
ci_63                -2.474046e-04 3 1  ON 62
ci_64                -6.083892e-04 3 1  ON 63
ci_65                -1.070365e-04 3 1  ON 64
ci_66                -1.269789e-04 3 1  ON 65
ci_67                -1.935169e-04 3 1  ON 66
ci_68                -1.796860e-03 3 1  ON 67
ci_69                -1.806269e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8262
    reference variance = 0.424351
====================================================
  Execution time = 2.5395e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4698e-01
  Total weights = 1.964698940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434532477751
                                         uncertainty =       0.001753784169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434532477751
                                         uncertainty =       0.001753784169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466146029
  error estimate for blocks of size 2^( 2) =       0.000491557860
  error estimate for blocks of size 2^( 3) =       0.000515794912
  error estimate for blocks of size 2^( 4) =       0.000533272245
  error estimate for blocks of size 2^( 5) =       0.000547150575
  error estimate for blocks of size 2^( 6) =       0.000553094663
  error estimate for blocks of size 2^( 7) =       0.000557314202

      target function =      -0.747851248173
              le_mean =     -22.814461274540
             les_mean =     520.946624387055
             stat err =       0.000547707921
             autocorr =       1.380556121261
   target nu stat err =       0.000547707921
   target dn stat err =       0.002357824321
      target stat err =       0.002053277654
              std dev =       0.659230036370
             le_variance =       0.434584240853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281446127454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747855855779       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747855870188       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747855872649       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747855873179       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747855873470       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747855873584       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747855873581       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747855873580       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747855873582       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 2.508945e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747855855779       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747855859382       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747855859997       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747855860130       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747855860204       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747855860231       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747855860230       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747855860223       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747855860228       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+03 is 6.272450e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747855855779       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747855856680       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747855856834       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747855856867       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747855856884       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747855856878       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747855856898       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747855856897       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747855856904       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+04 is 1.568118e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9993e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_01                 1.080417e-01 3 1  ON 0
ci_02                -2.400964e-02 3 1  ON 1
ci_03                -2.428514e-02 3 1  ON 2
ci_04                 2.216173e-02 3 1  ON 3
ci_05                -1.913426e-02 3 1  ON 4
ci_06                -1.952969e-02 3 1  ON 5
ci_07                 2.575910e-02 3 1  ON 6
ci_08                -4.226192e-03 3 1  ON 7
ci_09                -7.550009e-03 3 1  ON 8
ci_10                -7.705490e-03 3 1  ON 9
ci_11                 1.374776e-02 3 1  ON 10
ci_12                 7.046923e-03 3 1  ON 11
ci_13                 1.381521e-02 3 1  ON 12
ci_14                 1.281202e-02 3 1  ON 13
ci_15                 5.172284e-03 3 1  ON 14
ci_16                 5.732289e-03 3 1  ON 15
ci_17                -5.020985e-03 3 1  ON 16
ci_18                -5.547672e-03 3 1  ON 17
ci_19                 1.032720e-02 3 1  ON 18
ci_20                 6.254718e-03 3 1  ON 19
ci_21                 8.484237e-03 3 1  ON 20
ci_22                 8.882428e-03 3 1  ON 21
ci_23                 4.171031e-03 3 1  ON 22
ci_24                 5.186262e-03 3 1  ON 23
ci_25                 3.012167e-03 3 1  ON 24
ci_26                 3.792472e-03 3 1  ON 25
ci_27                 3.288970e-03 3 1  ON 26
ci_28                 7.720259e-04 3 1  ON 27
ci_29                 1.187173e-03 3 1  ON 28
ci_30                -7.398016e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384156e-04 3 1  ON 31
ci_33                -1.034664e-03 3 1  ON 32
ci_34                 1.152125e-03 3 1  ON 33
ci_35                 1.248543e-03 3 1  ON 34
ci_36                -5.670143e-04 3 1  ON 35
ci_37                -5.199211e-04 3 1  ON 36
ci_38                -2.860497e-04 3 1  ON 37
ci_39                -1.427269e-04 3 1  ON 38
ci_40                -1.904018e-03 3 1  ON 39
ci_41                -5.152146e-04 3 1  ON 40
ci_42                -1.648470e-03 3 1  ON 41
ci_43                -1.295213e-03 3 1  ON 42
ci_44                -2.176339e-03 3 1  ON 43
ci_45                -2.667364e-04 3 1  ON 44
ci_46                -1.691579e-03 3 1  ON 45
ci_47                 1.436550e-03 3 1  ON 46
ci_48                 2.892142e-03 3 1  ON 47
ci_49                -8.540025e-04 3 1  ON 48
ci_50                -8.198946e-04 3 1  ON 49
ci_51                -5.664057e-04 3 1  ON 50
ci_52                -6.298025e-04 3 1  ON 51
ci_53                -8.013737e-04 3 1  ON 52
ci_54                -1.108885e-03 3 1  ON 53
ci_55                -1.235604e-03 3 1  ON 54
ci_56                 1.100312e-03 3 1  ON 55
ci_57                 2.087922e-03 3 1  ON 56
ci_58                -1.872361e-04 3 1  ON 57
ci_59                -6.204398e-04 3 1  ON 58
ci_60                 1.280349e-04 3 1  ON 59
ci_61                -9.878419e-04 3 1  ON 60
ci_62                -3.813967e-04 3 1  ON 61
ci_63                -2.474052e-04 3 1  ON 62
ci_64                -6.083857e-04 3 1  ON 63
ci_65                -1.070450e-04 3 1  ON 64
ci_66                -1.269811e-04 3 1  ON 65
ci_67                -1.935174e-04 3 1  ON 66
ci_68                -1.796855e-03 3 1  ON 67
ci_69                -1.806268e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7258
    reference variance = 0.423005
====================================================
  Execution time = 2.4687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6080e-01
  Total weights = 1.9648e+06
  Execution time = 3.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615101646
                                         uncertainty =       0.004878619000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615101646
                                         uncertainty =       0.004878619000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470947007
  error estimate for blocks of size 2^( 2) =       0.000496472041
  error estimate for blocks of size 2^( 3) =       0.000520051579
  error estimate for blocks of size 2^( 4) =       0.000537800834
  error estimate for blocks of size 2^( 5) =       0.000549144593
  error estimate for blocks of size 2^( 6) =       0.000557465772
  error estimate for blocks of size 2^( 7) =       0.000561505561

      target function =      -0.736497177194
              le_mean =     -22.814760064013
             les_mean =     520.974078593255
             stat err =       0.000551479190
             autocorr =       1.371242216011
   target nu stat err =       0.000551479190
   target dn stat err =       0.006356476310
      target stat err =       0.005164966813
              std dev =       0.666019644579
             le_variance =       0.443582166965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615051884
                                         uncertainty =       0.004878621307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615051884
                                         uncertainty =       0.004878621307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470946981
  error estimate for blocks of size 2^( 2) =       0.000496472004
  error estimate for blocks of size 2^( 3) =       0.000520051532
  error estimate for blocks of size 2^( 4) =       0.000537800777
  error estimate for blocks of size 2^( 5) =       0.000549144534
  error estimate for blocks of size 2^( 6) =       0.000557465707
  error estimate for blocks of size 2^( 7) =       0.000561505493

      target function =      -0.736497414089
              le_mean =     -22.814760063923
             les_mean =     520.974078296267
             stat err =       0.000551479128
             autocorr =       1.371242059891
   target nu stat err =       0.000551479128
   target dn stat err =       0.006356427668
      target stat err =       0.005164931117
              std dev =       0.666019607262
             le_variance =       0.443582117258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615076764
                                         uncertainty =       0.004878620154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615076764
                                         uncertainty =       0.004878620154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470946994
  error estimate for blocks of size 2^( 2) =       0.000496472023
  error estimate for blocks of size 2^( 3) =       0.000520051556
  error estimate for blocks of size 2^( 4) =       0.000537800805
  error estimate for blocks of size 2^( 5) =       0.000549144564
  error estimate for blocks of size 2^( 6) =       0.000557465740
  error estimate for blocks of size 2^( 7) =       0.000561505527

      target function =      -0.736497295838
              le_mean =     -22.814760063968
             les_mean =     520.974078444515
             stat err =       0.000551479159
             autocorr =       1.371242137940
   target nu stat err =       0.000551479159
   target dn stat err =       0.006356451986
      target stat err =       0.005164948966
              std dev =       0.666019625920
             le_variance =       0.443582142111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615098536
                                         uncertainty =       0.004878619145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443615098536
                                         uncertainty =       0.004878619145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470947005
  error estimate for blocks of size 2^( 2) =       0.000496472039
  error estimate for blocks of size 2^( 3) =       0.000520051576
  error estimate for blocks of size 2^( 4) =       0.000537800830
  error estimate for blocks of size 2^( 5) =       0.000549144590
  error estimate for blocks of size 2^( 6) =       0.000557465768
  error estimate for blocks of size 2^( 7) =       0.000561505556

      target function =      -0.736497192046
              le_mean =     -22.814760064007
             les_mean =     520.974078574636
             stat err =       0.000551479186
             autocorr =       1.371242206249
   target nu stat err =       0.000551479186
   target dn stat err =       0.006356473269
      target stat err =       0.005164964582
              std dev =       0.666019642247
             le_variance =       0.443582163859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736497177194        initial
     1.4211e+03     1.4211e+04             2.5089e-07        -0.736497414089  <--
     5.6843e+03     5.6843e+04             6.2724e-08        -0.736497295838
     2.2737e+04     2.2737e+05             1.5681e-08        -0.736497192046

*****************************************************************************
Applying the update for shift_i =   1.4211e+03     and shift_s =   1.4211e+04
*****************************************************************************

  Execution time = 4.2232e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428520e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952976e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705507e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046920e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021026e-03 3 1  ON 16
ci_18                -5.547690e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171042e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012164e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288961e-03 3 1  ON 26
ci_28                 7.720346e-04 3 1  ON 27
ci_29                 1.187186e-03 3 1  ON 28
ci_30                -7.397572e-04 3 1  ON 29
ci_31                 1.032415e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670350e-04 3 1  ON 35
ci_37                -5.199233e-04 3 1  ON 36
ci_38                -2.860458e-04 3 1  ON 37
ci_39                -1.427550e-04 3 1  ON 38
ci_40                -1.904009e-03 3 1  ON 39
ci_41                -5.152489e-04 3 1  ON 40
ci_42                -1.648440e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176314e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691523e-03 3 1  ON 45
ci_47                 1.436580e-03 3 1  ON 46
ci_48                 2.892120e-03 3 1  ON 47
ci_49                -8.540137e-04 3 1  ON 48
ci_50                -8.198842e-04 3 1  ON 49
ci_51                -5.663979e-04 3 1  ON 50
ci_52                -6.297643e-04 3 1  ON 51
ci_53                -8.013754e-04 3 1  ON 52
ci_54                -1.108876e-03 3 1  ON 53
ci_55                -1.235584e-03 3 1  ON 54
ci_56                 1.100354e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872686e-04 3 1  ON 57
ci_59                -6.204490e-04 3 1  ON 58
ci_60                 1.280264e-04 3 1  ON 59
ci_61                -9.878428e-04 3 1  ON 60
ci_62                -3.813996e-04 3 1  ON 61
ci_63                -2.474070e-04 3 1  ON 62
ci_64                -6.083751e-04 3 1  ON 63
ci_65                -1.070704e-04 3 1  ON 64
ci_66                -1.269878e-04 3 1  ON 65
ci_67                -1.935188e-04 3 1  ON 66
ci_68                -1.796838e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8582
    reference variance = 0.33075
====================================================
  Execution time = 2.7232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4972e-01
  Total weights = 1.964913112e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435448429602
                                         uncertainty =       0.002077109758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435448429602
                                         uncertainty =       0.002077109758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466592634
  error estimate for blocks of size 2^( 2) =       0.000492611636
  error estimate for blocks of size 2^( 3) =       0.000517003101
  error estimate for blocks of size 2^( 4) =       0.000535313554
  error estimate for blocks of size 2^( 5) =       0.000547053031
  error estimate for blocks of size 2^( 6) =       0.000553756566
  error estimate for blocks of size 2^( 7) =       0.000557648053

      target function =      -0.745571084641
              le_mean =     -22.813183964061
             les_mean =     520.891079407379
             stat err =       0.000548442801
             autocorr =       1.381614630361
   target nu stat err =       0.000548442801
   target dn stat err =       0.003572977527
      target stat err =       0.003009591559
              std dev =       0.659861631455
             le_variance =       0.435417372667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281318396406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745582288388       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745582350673       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745582359532       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745582361149       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745582361755       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745582362291       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745582362440       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745582362476       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745582362473       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745582362478       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 7.816956e-07

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745582288388       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745582303961       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745582306176       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745582306580       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745582306732       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745582306866       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745582306903       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745582306912       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745582306911       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745582306912       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 1.954347e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745582288388       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745582292282       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745582292835       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745582292936       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745582292974       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745582293008       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745582293017       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745582293019       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745582293019       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745582293019       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+03 is 4.885936e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1710e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_01                 1.080421e-01 3 1  ON 0
ci_02                -2.400984e-02 3 1  ON 1
ci_03                -2.428526e-02 3 1  ON 2
ci_04                 2.216193e-02 3 1  ON 3
ci_05                -1.913441e-02 3 1  ON 4
ci_06                -1.952976e-02 3 1  ON 5
ci_07                 2.575915e-02 3 1  ON 6
ci_08                -4.226261e-03 3 1  ON 7
ci_09                -7.550007e-03 3 1  ON 8
ci_10                -7.705497e-03 3 1  ON 9
ci_11                 1.374775e-02 3 1  ON 10
ci_12                 7.046908e-03 3 1  ON 11
ci_13                 1.381519e-02 3 1  ON 12
ci_14                 1.281203e-02 3 1  ON 13
ci_15                 5.172373e-03 3 1  ON 14
ci_16                 5.732299e-03 3 1  ON 15
ci_17                -5.021097e-03 3 1  ON 16
ci_18                -5.547646e-03 3 1  ON 17
ci_19                 1.032712e-02 3 1  ON 18
ci_20                 6.254766e-03 3 1  ON 19
ci_21                 8.484204e-03 3 1  ON 20
ci_22                 8.882421e-03 3 1  ON 21
ci_23                 4.171064e-03 3 1  ON 22
ci_24                 5.186185e-03 3 1  ON 23
ci_25                 3.012166e-03 3 1  ON 24
ci_26                 3.792480e-03 3 1  ON 25
ci_27                 3.288945e-03 3 1  ON 26
ci_28                 7.720710e-04 3 1  ON 27
ci_29                 1.187222e-03 3 1  ON 28
ci_30                -7.397821e-04 3 1  ON 29
ci_31                 1.032366e-03 3 1  ON 30
ci_32                -5.384563e-04 3 1  ON 31
ci_33                -1.034671e-03 3 1  ON 32
ci_34                 1.152134e-03 3 1  ON 33
ci_35                 1.248597e-03 3 1  ON 34
ci_36                -5.670444e-04 3 1  ON 35
ci_37                -5.199407e-04 3 1  ON 36
ci_38                -2.860367e-04 3 1  ON 37
ci_39                -1.428034e-04 3 1  ON 38
ci_40                -1.903997e-03 3 1  ON 39
ci_41                -5.152812e-04 3 1  ON 40
ci_42                -1.648428e-03 3 1  ON 41
ci_43                -1.295152e-03 3 1  ON 42
ci_44                -2.176338e-03 3 1  ON 43
ci_45                -2.667018e-04 3 1  ON 44
ci_46                -1.691461e-03 3 1  ON 45
ci_47                 1.436574e-03 3 1  ON 46
ci_48                 2.892120e-03 3 1  ON 47
ci_49                -8.540565e-04 3 1  ON 48
ci_50                -8.198987e-04 3 1  ON 49
ci_51                -5.663790e-04 3 1  ON 50
ci_52                -6.297431e-04 3 1  ON 51
ci_53                -8.013915e-04 3 1  ON 52
ci_54                -1.108855e-03 3 1  ON 53
ci_55                -1.235576e-03 3 1  ON 54
ci_56                 1.100386e-03 3 1  ON 55
ci_57                 2.087884e-03 3 1  ON 56
ci_58                -1.873360e-04 3 1  ON 57
ci_59                -6.204577e-04 3 1  ON 58
ci_60                 1.280983e-04 3 1  ON 59
ci_61                -9.878206e-04 3 1  ON 60
ci_62                -3.814074e-04 3 1  ON 61
ci_63                -2.474317e-04 3 1  ON 62
ci_64                -6.083339e-04 3 1  ON 63
ci_65                -1.071069e-04 3 1  ON 64
ci_66                -1.269682e-04 3 1  ON 65
ci_67                -1.935294e-04 3 1  ON 66
ci_68                -1.796830e-03 3 1  ON 67
ci_69                -1.806218e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8454
    reference variance = 0.480238
====================================================
  Execution time = 2.4730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4295e-01
  Total weights = 1.9650e+06
  Execution time = 3.5169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599538520
                                         uncertainty =       0.001716222705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599538520
                                         uncertainty =       0.001716222705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465092933
  error estimate for blocks of size 2^( 2) =       0.000491099930
  error estimate for blocks of size 2^( 3) =       0.000515122429
  error estimate for blocks of size 2^( 4) =       0.000534088770
  error estimate for blocks of size 2^( 5) =       0.000546346499
  error estimate for blocks of size 2^( 6) =       0.000553177588
  error estimate for blocks of size 2^( 7) =       0.000556172666

      target function =      -0.751224149914
              le_mean =     -22.814854873548
             les_mean =     520.960552352108
             stat err =       0.000547446381
             autocorr =       1.385490961807
   target nu stat err =       0.000547446381
   target dn stat err =       0.002248999267
      target stat err =       0.001985032027
              std dev =       0.657740733463
             le_variance =       0.432622872456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599457551
                                         uncertainty =       0.001716224628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599457551
                                         uncertainty =       0.001716224628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465092889
  error estimate for blocks of size 2^( 2) =       0.000491099847
  error estimate for blocks of size 2^( 3) =       0.000515122299
  error estimate for blocks of size 2^( 4) =       0.000534088605
  error estimate for blocks of size 2^( 5) =       0.000546346309
  error estimate for blocks of size 2^( 6) =       0.000553177372
  error estimate for blocks of size 2^( 7) =       0.000556172451

      target function =      -0.751224125269
              le_mean =     -22.814854871148
             les_mean =     520.960552271863
             stat err =       0.000547446184
             autocorr =       1.385490225553
   target nu stat err =       0.000547446184
   target dn stat err =       0.002249007204
      target stat err =       0.001985038167
              std dev =       0.657740671998
             le_variance =       0.432622791601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599498027
                                         uncertainty =       0.001716223667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599498027
                                         uncertainty =       0.001716223667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465092911
  error estimate for blocks of size 2^( 2) =       0.000491099889
  error estimate for blocks of size 2^( 3) =       0.000515122364
  error estimate for blocks of size 2^( 4) =       0.000534088687
  error estimate for blocks of size 2^( 5) =       0.000546346404
  error estimate for blocks of size 2^( 6) =       0.000553177480
  error estimate for blocks of size 2^( 7) =       0.000556172559

      target function =      -0.751224137674
              le_mean =     -22.814854872347
             les_mean =     520.960552311842
             stat err =       0.000547446282
             autocorr =       1.385490593649
   target nu stat err =       0.000547446282
   target dn stat err =       0.002249003234
      target stat err =       0.001985035096
              std dev =       0.657740702724
             le_variance =       0.432622832019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599533458
                                         uncertainty =       0.001716222825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432599533458
                                         uncertainty =       0.001716222825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465092930
  error estimate for blocks of size 2^( 2) =       0.000491099925
  error estimate for blocks of size 2^( 3) =       0.000515122421
  error estimate for blocks of size 2^( 4) =       0.000534088760
  error estimate for blocks of size 2^( 5) =       0.000546346487
  error estimate for blocks of size 2^( 6) =       0.000553177574
  error estimate for blocks of size 2^( 7) =       0.000556172653

      target function =      -0.751224148393
              le_mean =     -22.814854873398
             les_mean =     520.960552347060
             stat err =       0.000547446368
             autocorr =       1.385490915793
   target nu stat err =       0.000547446368
   target dn stat err =       0.002248999763
      target stat err =       0.001985032410
              std dev =       0.657740729620
             le_variance =       0.432622867401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751224149914        initial  <--
     3.5527e+02     3.5527e+03             7.8170e-07        -0.751224125269
     1.4211e+03     1.4211e+04             1.9543e-07        -0.751224137674
     5.6843e+03     5.6843e+04             4.8859e-08        -0.751224148393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3883
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428520e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952976e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705507e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046920e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021026e-03 3 1  ON 16
ci_18                -5.547690e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171042e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012164e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288961e-03 3 1  ON 26
ci_28                 7.720346e-04 3 1  ON 27
ci_29                 1.187186e-03 3 1  ON 28
ci_30                -7.397572e-04 3 1  ON 29
ci_31                 1.032415e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670350e-04 3 1  ON 35
ci_37                -5.199233e-04 3 1  ON 36
ci_38                -2.860458e-04 3 1  ON 37
ci_39                -1.427550e-04 3 1  ON 38
ci_40                -1.904009e-03 3 1  ON 39
ci_41                -5.152489e-04 3 1  ON 40
ci_42                -1.648440e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176314e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691523e-03 3 1  ON 45
ci_47                 1.436580e-03 3 1  ON 46
ci_48                 2.892120e-03 3 1  ON 47
ci_49                -8.540137e-04 3 1  ON 48
ci_50                -8.198842e-04 3 1  ON 49
ci_51                -5.663979e-04 3 1  ON 50
ci_52                -6.297643e-04 3 1  ON 51
ci_53                -8.013754e-04 3 1  ON 52
ci_54                -1.108876e-03 3 1  ON 53
ci_55                -1.235584e-03 3 1  ON 54
ci_56                 1.100354e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872686e-04 3 1  ON 57
ci_59                -6.204490e-04 3 1  ON 58
ci_60                 1.280264e-04 3 1  ON 59
ci_61                -9.878428e-04 3 1  ON 60
ci_62                -3.813996e-04 3 1  ON 61
ci_63                -2.474070e-04 3 1  ON 62
ci_64                -6.083751e-04 3 1  ON 63
ci_65                -1.070704e-04 3 1  ON 64
ci_66                -1.269878e-04 3 1  ON 65
ci_67                -1.935188e-04 3 1  ON 66
ci_68                -1.796838e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7086
    reference variance = 0.373618
====================================================
  Execution time = 2.5614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5056e-01
  Total weights = 1.964653335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015293694
                                         uncertainty =       0.002147490968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015293694
                                         uncertainty =       0.002147490968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467446985
  error estimate for blocks of size 2^( 2) =       0.000493686444
  error estimate for blocks of size 2^( 3) =       0.000517737538
  error estimate for blocks of size 2^( 4) =       0.000536008707
  error estimate for blocks of size 2^( 5) =       0.000548197083
  error estimate for blocks of size 2^( 6) =       0.000555267773
  error estimate for blocks of size 2^( 7) =       0.000555705856

      target function =      -0.744876757525
              le_mean =     -22.814176337917
             les_mean =     520.937206390579
             stat err =       0.000548794855
             autocorr =       1.378336751647
   target nu stat err =       0.000548794855
   target dn stat err =       0.003445711696
      target stat err =       0.002905893029
              std dev =       0.661069865531
             le_variance =       0.437013367113


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281417633792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744887006229       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744887012095       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744887013481       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744887014142       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744887014296       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744887014411       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744887014446       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744887014465       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744887014463       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744887014468       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744887014465       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+03 is 9.479143e-08

solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744887006229       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744887007695       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744887008042       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744887008207       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744887008227       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744887008264       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744887008299       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744887008288       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744887008289       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744887008293       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744887008290       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+04 is 2.369799e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744887006229       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744887006596       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744887006682       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744887006724       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744887006708       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744887006740       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744887006751       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744887006786       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744887006676       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744887006755       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744887006690       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+04 is 5.924504e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0099e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400971e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216183e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575913e-02 3 1  ON 6
ci_08                -4.226216e-03 3 1  ON 7
ci_09                -7.550029e-03 3 1  ON 8
ci_10                -7.705507e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046920e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281200e-02 3 1  ON 13
ci_15                 5.172314e-03 3 1  ON 14
ci_16                 5.732326e-03 3 1  ON 15
ci_17                -5.021028e-03 3 1  ON 16
ci_18                -5.547691e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254706e-03 3 1  ON 19
ci_21                 8.484225e-03 3 1  ON 20
ci_22                 8.882413e-03 3 1  ON 21
ci_23                 4.171047e-03 3 1  ON 22
ci_24                 5.186237e-03 3 1  ON 23
ci_25                 3.012164e-03 3 1  ON 24
ci_26                 3.792500e-03 3 1  ON 25
ci_27                 3.288959e-03 3 1  ON 26
ci_28                 7.720325e-04 3 1  ON 27
ci_29                 1.187192e-03 3 1  ON 28
ci_30                -7.397525e-04 3 1  ON 29
ci_31                 1.032413e-03 3 1  ON 30
ci_32                -5.384320e-04 3 1  ON 31
ci_33                -1.034681e-03 3 1  ON 32
ci_34                 1.152133e-03 3 1  ON 33
ci_35                 1.248604e-03 3 1  ON 34
ci_36                -5.670394e-04 3 1  ON 35
ci_37                -5.199233e-04 3 1  ON 36
ci_38                -2.860423e-04 3 1  ON 37
ci_39                -1.427542e-04 3 1  ON 38
ci_40                -1.904006e-03 3 1  ON 39
ci_41                -5.152523e-04 3 1  ON 40
ci_42                -1.648442e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176317e-03 3 1  ON 43
ci_45                -2.667366e-04 3 1  ON 44
ci_46                -1.691522e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892121e-03 3 1  ON 47
ci_49                -8.540136e-04 3 1  ON 48
ci_50                -8.198837e-04 3 1  ON 49
ci_51                -5.663914e-04 3 1  ON 50
ci_52                -6.297619e-04 3 1  ON 51
ci_53                -8.013745e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235584e-03 3 1  ON 54
ci_56                 1.100358e-03 3 1  ON 55
ci_57                 2.087924e-03 3 1  ON 56
ci_58                -1.872680e-04 3 1  ON 57
ci_59                -6.204504e-04 3 1  ON 58
ci_60                 1.280225e-04 3 1  ON 59
ci_61                -9.878439e-04 3 1  ON 60
ci_62                -3.814003e-04 3 1  ON 61
ci_63                -2.474078e-04 3 1  ON 62
ci_64                -6.083703e-04 3 1  ON 63
ci_65                -1.070701e-04 3 1  ON 64
ci_66                -1.269918e-04 3 1  ON 65
ci_67                -1.935177e-04 3 1  ON 66
ci_68                -1.796836e-03 3 1  ON 67
ci_69                -1.806263e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7415
    reference variance = 0.378853
====================================================
  Execution time = 2.4793e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4595e-01
  Total weights = 1.9645e+06
  Execution time = 3.5101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896655311
                                         uncertainty =       0.001718823718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896655311
                                         uncertainty =       0.001718823718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465830440
  error estimate for blocks of size 2^( 2) =       0.000491792146
  error estimate for blocks of size 2^( 3) =       0.000515941748
  error estimate for blocks of size 2^( 4) =       0.000534303295
  error estimate for blocks of size 2^( 5) =       0.000545205097
  error estimate for blocks of size 2^( 6) =       0.000549462047
  error estimate for blocks of size 2^( 7) =       0.000551941265

      target function =      -0.748709106901
              le_mean =     -22.814192022151
             les_mean =     520.933304174090
             stat err =       0.000545227926
             autocorr =       1.369936556403
   target nu stat err =       0.000545227926
   target dn stat err =       0.002659359460
      target stat err =       0.002297399812
              std dev =       0.658783725971
             le_variance =       0.433995997605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896648892
                                         uncertainty =       0.001718823873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896648892
                                         uncertainty =       0.001718823873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465830437
  error estimate for blocks of size 2^( 2) =       0.000491792138
  error estimate for blocks of size 2^( 3) =       0.000515941735
  error estimate for blocks of size 2^( 4) =       0.000534303278
  error estimate for blocks of size 2^( 5) =       0.000545205077
  error estimate for blocks of size 2^( 6) =       0.000549462026
  error estimate for blocks of size 2^( 7) =       0.000551941245

      target function =      -0.748709007557
              le_mean =     -22.814192022149
             les_mean =     520.933304293221
             stat err =       0.000545227907
             autocorr =       1.369936480239
   target nu stat err =       0.000545227907
   target dn stat err =       0.002659359833
      target stat err =       0.002297399518
              std dev =       0.658783721065
             le_variance =       0.433995991140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896652101
                                         uncertainty =       0.001718823796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896652101
                                         uncertainty =       0.001718823796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465830438
  error estimate for blocks of size 2^( 2) =       0.000491792142
  error estimate for blocks of size 2^( 3) =       0.000515941742
  error estimate for blocks of size 2^( 4) =       0.000534303287
  error estimate for blocks of size 2^( 5) =       0.000545205087
  error estimate for blocks of size 2^( 6) =       0.000549462036
  error estimate for blocks of size 2^( 7) =       0.000551941255

      target function =      -0.748709057288
              le_mean =     -22.814192022150
             les_mean =     520.933304233586
             stat err =       0.000545227916
             autocorr =       1.369936518321
   target nu stat err =       0.000545227916
   target dn stat err =       0.002659359645
      target stat err =       0.002297399664
              std dev =       0.658783723518
             le_variance =       0.433995994373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896654910
                                         uncertainty =       0.001718823728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433896654910
                                         uncertainty =       0.001718823728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465830440
  error estimate for blocks of size 2^( 2) =       0.000491792145
  error estimate for blocks of size 2^( 3) =       0.000515941748
  error estimate for blocks of size 2^( 4) =       0.000534303294
  error estimate for blocks of size 2^( 5) =       0.000545205096
  error estimate for blocks of size 2^( 6) =       0.000549462045
  error estimate for blocks of size 2^( 7) =       0.000551941264

      target function =      -0.748709100706
              le_mean =     -22.814192022151
             les_mean =     520.933304181520
             stat err =       0.000545227925
             autocorr =       1.369936551642
   target nu stat err =       0.000545227925
   target dn stat err =       0.002659359483
      target stat err =       0.002297399793
              std dev =       0.658783725665
             le_variance =       0.433995997201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748709106901        initial  <--
     3.5527e+03     3.5527e+04             9.4791e-08        -0.748709007557
     1.4211e+04     1.4211e+05             2.3698e-08        -0.748709057288
     5.6843e+04     5.6843e+05             5.9245e-09        -0.748709100706

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3957
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428520e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952976e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705507e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046920e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021026e-03 3 1  ON 16
ci_18                -5.547690e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171042e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012164e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288961e-03 3 1  ON 26
ci_28                 7.720346e-04 3 1  ON 27
ci_29                 1.187186e-03 3 1  ON 28
ci_30                -7.397572e-04 3 1  ON 29
ci_31                 1.032415e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670350e-04 3 1  ON 35
ci_37                -5.199233e-04 3 1  ON 36
ci_38                -2.860458e-04 3 1  ON 37
ci_39                -1.427550e-04 3 1  ON 38
ci_40                -1.904009e-03 3 1  ON 39
ci_41                -5.152489e-04 3 1  ON 40
ci_42                -1.648440e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176314e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691523e-03 3 1  ON 45
ci_47                 1.436580e-03 3 1  ON 46
ci_48                 2.892120e-03 3 1  ON 47
ci_49                -8.540137e-04 3 1  ON 48
ci_50                -8.198842e-04 3 1  ON 49
ci_51                -5.663979e-04 3 1  ON 50
ci_52                -6.297643e-04 3 1  ON 51
ci_53                -8.013754e-04 3 1  ON 52
ci_54                -1.108876e-03 3 1  ON 53
ci_55                -1.235584e-03 3 1  ON 54
ci_56                 1.100354e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872686e-04 3 1  ON 57
ci_59                -6.204490e-04 3 1  ON 58
ci_60                 1.280264e-04 3 1  ON 59
ci_61                -9.878428e-04 3 1  ON 60
ci_62                -3.813996e-04 3 1  ON 61
ci_63                -2.474070e-04 3 1  ON 62
ci_64                -6.083751e-04 3 1  ON 63
ci_65                -1.070704e-04 3 1  ON 64
ci_66                -1.269878e-04 3 1  ON 65
ci_67                -1.935188e-04 3 1  ON 66
ci_68                -1.796838e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7954
    reference variance = 0.352399
====================================================
  Execution time = 2.7485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4523e-01
  Total weights = 1.964670176e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433342811113
                                         uncertainty =       0.001582039746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433342811113
                                         uncertainty =       0.001582039746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465474521
  error estimate for blocks of size 2^( 2) =       0.000491150424
  error estimate for blocks of size 2^( 3) =       0.000515278694
  error estimate for blocks of size 2^( 4) =       0.000534423034
  error estimate for blocks of size 2^( 5) =       0.000546320442
  error estimate for blocks of size 2^( 6) =       0.000551122921
  error estimate for blocks of size 2^( 7) =       0.000554542644

      target function =      -0.749304198089
              le_mean =     -22.813909219824
             les_mean =     520.919684346730
             stat err =       0.000546602260
             autocorr =       1.378957934650
   target nu stat err =       0.000546602260
   target dn stat err =       0.002513326400
      target stat err =       0.002183119553
              std dev =       0.658280380855
             le_variance =       0.433333059818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281390921982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749309571946       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749309572527       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749309572603       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749309572622       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749309572632       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749309572565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749309572586       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749309572590       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749309572666       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749309572599       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749309572630       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+04 is 6.933355e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749309571946       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749309572091       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749309572110       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749309572115       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749309572133       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749309572305       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749309572062       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749309572335       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749309572196       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749309571988       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749309572501       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+05 is 1.733340e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749309571946       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749309571982       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749309571987       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749309571988       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749309571991       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749309571558       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749309573450       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749309572238       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749309573140       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749309573273       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749309571962       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+05 is 4.333350e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1968e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428520e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952976e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705506e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046920e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021026e-03 3 1  ON 16
ci_18                -5.547691e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171042e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288961e-03 3 1  ON 26
ci_28                 7.720350e-04 3 1  ON 27
ci_29                 1.187187e-03 3 1  ON 28
ci_30                -7.397570e-04 3 1  ON 29
ci_31                 1.032414e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670350e-04 3 1  ON 35
ci_37                -5.199236e-04 3 1  ON 36
ci_38                -2.860461e-04 3 1  ON 37
ci_39                -1.427551e-04 3 1  ON 38
ci_40                -1.904009e-03 3 1  ON 39
ci_41                -5.152493e-04 3 1  ON 40
ci_42                -1.648439e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176313e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691523e-03 3 1  ON 45
ci_47                 1.436580e-03 3 1  ON 46
ci_48                 2.892120e-03 3 1  ON 47
ci_49                -8.540135e-04 3 1  ON 48
ci_50                -8.198842e-04 3 1  ON 49
ci_51                -5.663973e-04 3 1  ON 50
ci_52                -6.297641e-04 3 1  ON 51
ci_53                -8.013752e-04 3 1  ON 52
ci_54                -1.108876e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100354e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872688e-04 3 1  ON 57
ci_59                -6.204495e-04 3 1  ON 58
ci_60                 1.280262e-04 3 1  ON 59
ci_61                -9.878433e-04 3 1  ON 60
ci_62                -3.813997e-04 3 1  ON 61
ci_63                -2.474069e-04 3 1  ON 62
ci_64                -6.083747e-04 3 1  ON 63
ci_65                -1.070704e-04 3 1  ON 64
ci_66                -1.269879e-04 3 1  ON 65
ci_67                -1.935187e-04 3 1  ON 66
ci_68                -1.796838e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8223
    reference variance = 0.322892
====================================================
  Execution time = 2.4636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4742e-01
  Total weights = 1.9643e+06
  Execution time = 3.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616804706
                                         uncertainty =       0.002139990596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616804706
                                         uncertainty =       0.002139990596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466136406
  error estimate for blocks of size 2^( 2) =       0.000491778905
  error estimate for blocks of size 2^( 3) =       0.000515690022
  error estimate for blocks of size 2^( 4) =       0.000533740473
  error estimate for blocks of size 2^( 5) =       0.000544789879
  error estimate for blocks of size 2^( 6) =       0.000552696043
  error estimate for blocks of size 2^( 7) =       0.000551624327

      target function =      -0.747486335037
              le_mean =     -22.814779244366
             les_mean =     520.961570754410
             stat err =       0.000545712680
             autocorr =       1.370572595349
   target nu stat err =       0.000545712680
   target dn stat err =       0.002905009468
      target stat err =       0.002489803659
              std dev =       0.659216427451
             le_variance =       0.434566298222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616803870
                                         uncertainty =       0.002139990570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616803870
                                         uncertainty =       0.002139990570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466136406
  error estimate for blocks of size 2^( 2) =       0.000491778904
  error estimate for blocks of size 2^( 3) =       0.000515690021
  error estimate for blocks of size 2^( 4) =       0.000533740471
  error estimate for blocks of size 2^( 5) =       0.000544789877
  error estimate for blocks of size 2^( 6) =       0.000552696041
  error estimate for blocks of size 2^( 7) =       0.000551624325

      target function =      -0.747486344838
              le_mean =     -22.814779244368
             les_mean =     520.961570742712
             stat err =       0.000545712679
             autocorr =       1.370572588680
   target nu stat err =       0.000545712679
   target dn stat err =       0.002905009652
      target stat err =       0.002489803870
              std dev =       0.659216426817
             le_variance =       0.434566297385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616804288
                                         uncertainty =       0.002139990583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616804288
                                         uncertainty =       0.002139990583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466136406
  error estimate for blocks of size 2^( 2) =       0.000491778905
  error estimate for blocks of size 2^( 3) =       0.000515690022
  error estimate for blocks of size 2^( 4) =       0.000533740472
  error estimate for blocks of size 2^( 5) =       0.000544789878
  error estimate for blocks of size 2^( 6) =       0.000552696042
  error estimate for blocks of size 2^( 7) =       0.000551624326

      target function =      -0.747486339940
              le_mean =     -22.814779244367
             les_mean =     520.961570748558
             stat err =       0.000545712680
             autocorr =       1.370572592012
   target nu stat err =       0.000545712680
   target dn stat err =       0.002905009560
      target stat err =       0.002489803764
              std dev =       0.659216427134
             le_variance =       0.434566297804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616804653
                                         uncertainty =       0.002139990594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434616804653
                                         uncertainty =       0.002139990594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466136406
  error estimate for blocks of size 2^( 2) =       0.000491778905
  error estimate for blocks of size 2^( 3) =       0.000515690022
  error estimate for blocks of size 2^( 4) =       0.000533740473
  error estimate for blocks of size 2^( 5) =       0.000544789878
  error estimate for blocks of size 2^( 6) =       0.000552696043
  error estimate for blocks of size 2^( 7) =       0.000551624327

      target function =      -0.747486335650
              le_mean =     -22.814779244366
             les_mean =     520.961570753678
             stat err =       0.000545712680
             autocorr =       1.370572594918
   target nu stat err =       0.000545712680
   target dn stat err =       0.002905009479
      target stat err =       0.002489803672
              std dev =       0.659216427412
             le_variance =       0.434566298169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747486335037        initial
     3.5527e+04     3.5527e+05             6.9334e-09        -0.747486344838  <--
     1.4211e+05     1.4211e+06             1.7333e-09        -0.747486339940
     5.6843e+05     5.6843e+06             4.3334e-10        -0.747486335650

*****************************************************************************
Applying the update for shift_i =   3.5527e+04     and shift_s =   3.5527e+05
*****************************************************************************

  Execution time = 4.2292e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8086
    reference variance = 0.42722
====================================================
  Execution time = 2.5241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4661e-01
  Total weights = 1.964739337e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435626685526
                                         uncertainty =       0.001823896019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435626685526
                                         uncertainty =       0.001823896019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466712167
  error estimate for blocks of size 2^( 2) =       0.000492153044
  error estimate for blocks of size 2^( 3) =       0.000516109490
  error estimate for blocks of size 2^( 4) =       0.000535216279
  error estimate for blocks of size 2^( 5) =       0.000547474748
  error estimate for blocks of size 2^( 6) =       0.000553390798
  error estimate for blocks of size 2^( 7) =       0.000554019074

      target function =      -0.748155103029
              le_mean =     -22.814086929622
             les_mean =     520.929174516158
             stat err =       0.000547525225
             autocorr =       1.376290203530
   target nu stat err =       0.000547525225
   target dn stat err =       0.002446629434
      target stat err =       0.002124336282
              std dev =       0.660030676109
             le_variance =       0.435640493404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281408692962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748160171147       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748160172783       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748160173057       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748160173146       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748160173170       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748160173217       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748160173203       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748160173210       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748160173198       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748160173208       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+03 is 2.934256e-08

solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748160171147       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748160171556       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748160171624       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748160171647       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748160171656       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748160171660       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748160171654       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748160171643       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748160171625       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748160171693       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+04 is 7.335657e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748160171147       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748160171249       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748160171266       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748160171269       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748160171200       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748160170973       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748160171332       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748160171377       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748160170985       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748160171344       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+05 is 1.833915e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9744e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400971e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550029e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046920e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732325e-03 3 1  ON 15
ci_17                -5.021026e-03 3 1  ON 16
ci_18                -5.547692e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254703e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171045e-03 3 1  ON 22
ci_24                 5.186236e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792504e-03 3 1  ON 25
ci_27                 3.288961e-03 3 1  ON 26
ci_28                 7.720371e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397536e-04 3 1  ON 29
ci_31                 1.032411e-03 3 1  ON 30
ci_32                -5.384288e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248600e-03 3 1  ON 34
ci_36                -5.670349e-04 3 1  ON 35
ci_37                -5.199251e-04 3 1  ON 36
ci_38                -2.860467e-04 3 1  ON 37
ci_39                -1.427575e-04 3 1  ON 38
ci_40                -1.904007e-03 3 1  ON 39
ci_41                -5.152511e-04 3 1  ON 40
ci_42                -1.648436e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176310e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691519e-03 3 1  ON 45
ci_47                 1.436582e-03 3 1  ON 46
ci_48                 2.892120e-03 3 1  ON 47
ci_49                -8.540136e-04 3 1  ON 48
ci_50                -8.198837e-04 3 1  ON 49
ci_51                -5.663943e-04 3 1  ON 50
ci_52                -6.297625e-04 3 1  ON 51
ci_53                -8.013737e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235584e-03 3 1  ON 54
ci_56                 1.100357e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872710e-04 3 1  ON 57
ci_59                -6.204519e-04 3 1  ON 58
ci_60                 1.280260e-04 3 1  ON 59
ci_61                -9.878427e-04 3 1  ON 60
ci_62                -3.814002e-04 3 1  ON 61
ci_63                -2.474056e-04 3 1  ON 62
ci_64                -6.083739e-04 3 1  ON 63
ci_65                -1.070718e-04 3 1  ON 64
ci_66                -1.269877e-04 3 1  ON 65
ci_67                -1.935188e-04 3 1  ON 66
ci_68                -1.796838e-03 3 1  ON 67
ci_69                -1.806262e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8259
    reference variance = 0.384081
====================================================
  Execution time = 2.4768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4932e-01
  Total weights = 1.9648e+06
  Execution time = 3.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594682692
                                         uncertainty =       0.003017046365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594682692
                                         uncertainty =       0.003017046365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467705432
  error estimate for blocks of size 2^( 2) =       0.000493477297
  error estimate for blocks of size 2^( 3) =       0.000517309028
  error estimate for blocks of size 2^( 4) =       0.000536062657
  error estimate for blocks of size 2^( 5) =       0.000546423613
  error estimate for blocks of size 2^( 6) =       0.000553079589
  error estimate for blocks of size 2^( 7) =       0.000557982389

      target function =      -0.745901855132
              le_mean =     -22.813889977211
             les_mean =     520.922897447736
             stat err =       0.000548387062
             autocorr =       1.374768499356
   target nu stat err =       0.000548387062
   target dn stat err =       0.003439090550
      target stat err =       0.002907035538
              std dev =       0.661435364988
             le_variance =       0.437496742057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594680627
                                         uncertainty =       0.003017046160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594680627
                                         uncertainty =       0.003017046160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467705431
  error estimate for blocks of size 2^( 2) =       0.000493477294
  error estimate for blocks of size 2^( 3) =       0.000517309024
  error estimate for blocks of size 2^( 4) =       0.000536062652
  error estimate for blocks of size 2^( 5) =       0.000546423607
  error estimate for blocks of size 2^( 6) =       0.000553079582
  error estimate for blocks of size 2^( 7) =       0.000557982382

      target function =      -0.745901669105
              le_mean =     -22.813889977125
             les_mean =     520.922897668884
             stat err =       0.000548387055
             autocorr =       1.374768472542
   target nu stat err =       0.000548387055
   target dn stat err =       0.003439090379
      target stat err =       0.002907033979
              std dev =       0.661435363420
             le_variance =       0.437496739982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594681659
                                         uncertainty =       0.003017046262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594681659
                                         uncertainty =       0.003017046262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467705431
  error estimate for blocks of size 2^( 2) =       0.000493477296
  error estimate for blocks of size 2^( 3) =       0.000517309026
  error estimate for blocks of size 2^( 4) =       0.000536062654
  error estimate for blocks of size 2^( 5) =       0.000546423610
  error estimate for blocks of size 2^( 6) =       0.000553079585
  error estimate for blocks of size 2^( 7) =       0.000557982385

      target function =      -0.745901764822
              le_mean =     -22.813889977168
             les_mean =     520.922897555040
             stat err =       0.000548387059
             autocorr =       1.374768485941
   target nu stat err =       0.000548387059
   target dn stat err =       0.003439090461
      target stat err =       0.002907034776
              std dev =       0.661435364204
             le_variance =       0.437496741020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594682563
                                         uncertainty =       0.003017046352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437594682563
                                         uncertainty =       0.003017046352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467705432
  error estimate for blocks of size 2^( 2) =       0.000493477297
  error estimate for blocks of size 2^( 3) =       0.000517309028
  error estimate for blocks of size 2^( 4) =       0.000536062657
  error estimate for blocks of size 2^( 5) =       0.000546423613
  error estimate for blocks of size 2^( 6) =       0.000553079588
  error estimate for blocks of size 2^( 7) =       0.000557982389

      target function =      -0.745901844125
              le_mean =     -22.813889977206
             les_mean =     520.922897460808
             stat err =       0.000548387062
             autocorr =       1.374768497693
   target nu stat err =       0.000548387062
   target dn stat err =       0.003439090539
      target stat err =       0.002907035444
              std dev =       0.661435364890
             le_variance =       0.437496741928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745901855132        initial  <--
     8.8818e+03     8.8818e+04             2.9343e-08        -0.745901669105
     3.5527e+04     3.5527e+05             7.3357e-09        -0.745901764822
     1.4211e+05     1.4211e+06             1.8339e-09        -0.745901844125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2866
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2038e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.782
    reference variance = 0.378603
====================================================
  Execution time = 2.7267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4774e-01
  Total weights = 1.964406846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434797478842
                                         uncertainty =       0.002160639077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434797478842
                                         uncertainty =       0.002160639077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466314648
  error estimate for blocks of size 2^( 2) =       0.000492129615
  error estimate for blocks of size 2^( 3) =       0.000516309666
  error estimate for blocks of size 2^( 4) =       0.000534971262
  error estimate for blocks of size 2^( 5) =       0.000546782684
  error estimate for blocks of size 2^( 6) =       0.000553088973
  error estimate for blocks of size 2^( 7) =       0.000559007111

      target function =      -0.747220838642
              le_mean =     -22.814354194779
             les_mean =     520.942494749308
             stat err =       0.000548462508
             autocorr =       1.383361784510
   target nu stat err =       0.000548462508
   target dn stat err =       0.002637015278
      target stat err =       0.002272224667
              std dev =       0.659468499532
             le_variance =       0.434898701875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281435419478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747226814642       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747226814841       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747226814877       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747226814885       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747226814887       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747226815033       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747226814852       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747226815136       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747226814764       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+04 is 2.790715e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747226814642       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747226814692       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747226814701       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747226814703       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747226814703       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747226814767       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747226814740       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747226814090       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747226815403       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+05 is 6.976789e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747226814642       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747226814654       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747226814657       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747226814657       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747226814658       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747226813866       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747226814282       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747226811873       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747226817230       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+06 is 1.744198e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1783e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021028e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670352e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427556e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152506e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297630e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872697e-04 3 1  ON 57
ci_59                -6.204512e-04 3 1  ON 58
ci_60                 1.280254e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813999e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070702e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7833
    reference variance = 0.593059
====================================================
  Execution time = 2.4519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5087e-01
  Total weights = 1.9646e+06
  Execution time = 3.5065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715924
                                         uncertainty =       0.002125448159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715924
                                         uncertainty =       0.002125448159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467564133
  error estimate for blocks of size 2^( 2) =       0.000493405887
  error estimate for blocks of size 2^( 3) =       0.000518123907
  error estimate for blocks of size 2^( 4) =       0.000537026959
  error estimate for blocks of size 2^( 5) =       0.000549391024
  error estimate for blocks of size 2^( 6) =       0.000555695338
  error estimate for blocks of size 2^( 7) =       0.000557918351

      target function =      -0.744626558696
              le_mean =     -22.814327634606
             les_mean =     520.944416435724
             stat err =       0.000550007918
             autocorr =       1.383743218865
   target nu stat err =       0.000550007918
   target dn stat err =       0.003044437454
      target stat err =       0.002582408134
              std dev =       0.661235538246
             le_variance =       0.437232437039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715834
                                         uncertainty =       0.002125448200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715834
                                         uncertainty =       0.002125448200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467564133
  error estimate for blocks of size 2^( 2) =       0.000493405887
  error estimate for blocks of size 2^( 3) =       0.000518123907
  error estimate for blocks of size 2^( 4) =       0.000537026958
  error estimate for blocks of size 2^( 5) =       0.000549391024
  error estimate for blocks of size 2^( 6) =       0.000555695338
  error estimate for blocks of size 2^( 7) =       0.000557918351

      target function =      -0.744626558358
              le_mean =     -22.814327634591
             les_mean =     520.944416435424
             stat err =       0.000550007917
             autocorr =       1.383743216273
   target nu stat err =       0.000550007917
   target dn stat err =       0.003044437517
      target stat err =       0.002582408182
              std dev =       0.661235538177
             le_variance =       0.437232436948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715879
                                         uncertainty =       0.002125448179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715879
                                         uncertainty =       0.002125448179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467564133
  error estimate for blocks of size 2^( 2) =       0.000493405887
  error estimate for blocks of size 2^( 3) =       0.000518123907
  error estimate for blocks of size 2^( 4) =       0.000537026958
  error estimate for blocks of size 2^( 5) =       0.000549391024
  error estimate for blocks of size 2^( 6) =       0.000555695338
  error estimate for blocks of size 2^( 7) =       0.000557918351

      target function =      -0.744626558527
              le_mean =     -22.814327634599
             les_mean =     520.944416435574
             stat err =       0.000550007918
             autocorr =       1.383743217578
   target nu stat err =       0.000550007918
   target dn stat err =       0.003044437485
      target stat err =       0.002582408158
              std dev =       0.661235538211
             le_variance =       0.437232436994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715918
                                         uncertainty =       0.002125448161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437289715918
                                         uncertainty =       0.002125448161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467564133
  error estimate for blocks of size 2^( 2) =       0.000493405887
  error estimate for blocks of size 2^( 3) =       0.000518123907
  error estimate for blocks of size 2^( 4) =       0.000537026959
  error estimate for blocks of size 2^( 5) =       0.000549391024
  error estimate for blocks of size 2^( 6) =       0.000555695338
  error estimate for blocks of size 2^( 7) =       0.000557918351

      target function =      -0.744626558675
              le_mean =     -22.814327634605
             les_mean =     520.944416435706
             stat err =       0.000550007918
             autocorr =       1.383743218709
   target nu stat err =       0.000550007918
   target dn stat err =       0.003044437458
      target stat err =       0.002582408137
              std dev =       0.661235538242
             le_variance =       0.437232437034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744626558696        initial  <--
     8.8818e+04     8.8818e+05             2.7907e-09        -0.744626558358
     3.5527e+05     3.5527e+06             6.9768e-10        -0.744626558527
     1.4211e+06     1.4211e+07             1.7442e-10        -0.744626558675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1427
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8374
    reference variance = 0.418751
====================================================
  Execution time = 2.5274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5471e-01
  Total weights = 1.964859029e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438927649123
                                         uncertainty =       0.002418986189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438927649123
                                         uncertainty =       0.002418986189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468682625
  error estimate for blocks of size 2^( 2) =       0.000494169417
  error estimate for blocks of size 2^( 3) =       0.000518703983
  error estimate for blocks of size 2^( 4) =       0.000536846909
  error estimate for blocks of size 2^( 5) =       0.000548006058
  error estimate for blocks of size 2^( 6) =       0.000554814686
  error estimate for blocks of size 2^( 7) =       0.000557023775

      target function =      -0.741470044737
              le_mean =     -22.813804313619
             les_mean =     520.924377306109
             stat err =       0.000549172857
             autocorr =       1.372968014598
   target nu stat err =       0.000549172857
   target dn stat err =       0.003382952775
      target stat err =       0.002828373263
              std dev =       0.662817325252
             le_variance =       0.439326806655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281380431362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741484512415       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741484512444       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741484512450       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741484512562       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741484512415       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741484512452       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741484514116       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741484511915       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741484512201       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741484512653       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+05 is 4.339331e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741484512415       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741484512422       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741484512424       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741484512424       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741484512693       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741484512424       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741484516236       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741484519104       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741484514593       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741484515181       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+06 is 1.084833e-10

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741484512415       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741484512417       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741484512417       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741484512259       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741484515450       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741484512417       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741484522157       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741484499981       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741484523519       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741484524170       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 2.712095e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9767e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670352e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.9022
    reference variance = 0.928032
====================================================
  Execution time = 2.4655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5435e-01
  Total weights = 1.9648e+06
  Execution time = 3.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895189
                                         uncertainty =       0.002156926639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895189
                                         uncertainty =       0.002156926639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467710472
  error estimate for blocks of size 2^( 2) =       0.000493598462
  error estimate for blocks of size 2^( 3) =       0.000518345555
  error estimate for blocks of size 2^( 4) =       0.000536446295
  error estimate for blocks of size 2^( 5) =       0.000547869708
  error estimate for blocks of size 2^( 6) =       0.000556583331
  error estimate for blocks of size 2^( 7) =       0.000557570173

      target function =      -0.741754114037
              le_mean =     -22.814616177260
             les_mean =     520.961065307815
             stat err =       0.000549617377
             autocorr =       1.380914288094
   target nu stat err =       0.000549617377
   target dn stat err =       0.004727094487
      target stat err =       0.003915606343
              std dev =       0.661442492140
             le_variance =       0.437506170408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895180
                                         uncertainty =       0.002156926645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895180
                                         uncertainty =       0.002156926645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467710472
  error estimate for blocks of size 2^( 2) =       0.000493598462
  error estimate for blocks of size 2^( 3) =       0.000518345555
  error estimate for blocks of size 2^( 4) =       0.000536446295
  error estimate for blocks of size 2^( 5) =       0.000547869708
  error estimate for blocks of size 2^( 6) =       0.000556583331
  error estimate for blocks of size 2^( 7) =       0.000557570173

      target function =      -0.741754113957
              le_mean =     -22.814616177262
             les_mean =     520.961065307996
             stat err =       0.000549617377
             autocorr =       1.380914287799
   target nu stat err =       0.000549617377
   target dn stat err =       0.004727094415
      target stat err =       0.003915606284
              std dev =       0.661442492129
             le_variance =       0.437506170394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895184
                                         uncertainty =       0.002156926642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895184
                                         uncertainty =       0.002156926642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467710472
  error estimate for blocks of size 2^( 2) =       0.000493598462
  error estimate for blocks of size 2^( 3) =       0.000518345555
  error estimate for blocks of size 2^( 4) =       0.000536446295
  error estimate for blocks of size 2^( 5) =       0.000547869708
  error estimate for blocks of size 2^( 6) =       0.000556583331
  error estimate for blocks of size 2^( 7) =       0.000557570173

      target function =      -0.741754113997
              le_mean =     -22.814616177261
             les_mean =     520.961065307906
             stat err =       0.000549617377
             autocorr =       1.380914287941
   target nu stat err =       0.000549617377
   target dn stat err =       0.004727094451
      target stat err =       0.003915606313
              std dev =       0.661442492134
             le_variance =       0.437506170401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895188
                                         uncertainty =       0.002156926639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437333895188
                                         uncertainty =       0.002156926639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467710472
  error estimate for blocks of size 2^( 2) =       0.000493598462
  error estimate for blocks of size 2^( 3) =       0.000518345555
  error estimate for blocks of size 2^( 4) =       0.000536446295
  error estimate for blocks of size 2^( 5) =       0.000547869708
  error estimate for blocks of size 2^( 6) =       0.000556583331
  error estimate for blocks of size 2^( 7) =       0.000557570173

      target function =      -0.741754114032
              le_mean =     -22.814616177261
             les_mean =     520.961065307827
             stat err =       0.000549617377
             autocorr =       1.380914288066
   target nu stat err =       0.000549617377
   target dn stat err =       0.004727094482
      target stat err =       0.003915606339
              std dev =       0.661442492139
             le_variance =       0.437506170407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741754114037        initial  <--
     8.8818e+05     8.8818e+06             4.3393e-10        -0.741754113957
     3.5527e+06     3.5527e+07             1.0848e-10        -0.741754113997
     1.4211e+07     1.4211e+08             2.7121e-11        -0.741754114032

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2389
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8779
    reference variance = 0.352137
====================================================
  Execution time = 2.7267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4926e-01
  Total weights = 1.964870965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436854874987
                                         uncertainty =       0.001881487003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436854874987
                                         uncertainty =       0.001881487003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467313729
  error estimate for blocks of size 2^( 2) =       0.000493103258
  error estimate for blocks of size 2^( 3) =       0.000516651221
  error estimate for blocks of size 2^( 4) =       0.000534768004
  error estimate for blocks of size 2^( 5) =       0.000545777598
  error estimate for blocks of size 2^( 6) =       0.000552926207
  error estimate for blocks of size 2^( 7) =       0.000556913891

      target function =      -0.745962735976
              le_mean =     -22.814256808910
             les_mean =     520.939569873296
             stat err =       0.000547596425
             autocorr =       1.373106200145
   target nu stat err =       0.000547596425
   target dn stat err =       0.002463498785
      target stat err =       0.002126340469
              std dev =       0.660881413204
             le_variance =       0.436764242319


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281425680891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745967851569       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745967851572       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745967851572       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745967851573       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745967851578       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745967851744       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745967857210       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745967862513       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745967848921       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745967844680       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 3.915816e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745967851569       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745967851570       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745967851570       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745967851570       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745967851571       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745967852455       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745967802075       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745967880258       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745967846259       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745967902721       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 9.789499e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745967851569       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745967851569       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745967851569       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745967851569       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745967851516       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745967853333       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745967757973       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745967789954       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745967787473       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745967832058       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 2.447396e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1765e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8128
    reference variance = 0.401654
====================================================
  Execution time = 2.4694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4859e-01
  Total weights = 1.9647e+06
  Execution time = 3.5164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606351
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606351
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467290895
  error estimate for blocks of size 2^( 2) =       0.000493148451
  error estimate for blocks of size 2^( 3) =       0.000517371342
  error estimate for blocks of size 2^( 4) =       0.000535508229
  error estimate for blocks of size 2^( 5) =       0.000547658104
  error estimate for blocks of size 2^( 6) =       0.000554382498
  error estimate for blocks of size 2^( 7) =       0.000559091302

      target function =      -0.746511476127
              le_mean =     -22.814047501320
             les_mean =     520.929353993732
             stat err =       0.000549160033
             autocorr =       1.381093899847
   target nu stat err =       0.000549160033
   target dn stat err =       0.002699686751
      target stat err =       0.002317277367
              std dev =       0.660849121383
             le_variance =       0.436721561233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606349
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606349
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467290895
  error estimate for blocks of size 2^( 2) =       0.000493148451
  error estimate for blocks of size 2^( 3) =       0.000517371342
  error estimate for blocks of size 2^( 4) =       0.000535508229
  error estimate for blocks of size 2^( 5) =       0.000547658104
  error estimate for blocks of size 2^( 6) =       0.000554382498
  error estimate for blocks of size 2^( 7) =       0.000559091302

      target function =      -0.746511476125
              le_mean =     -22.814047501320
             les_mean =     520.929353993737
             stat err =       0.000549160033
             autocorr =       1.381093899819
   target nu stat err =       0.000549160033
   target dn stat err =       0.002699686752
      target stat err =       0.002317277368
              std dev =       0.660849121383
             le_variance =       0.436721561232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606350
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606350
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467290895
  error estimate for blocks of size 2^( 2) =       0.000493148451
  error estimate for blocks of size 2^( 3) =       0.000517371342
  error estimate for blocks of size 2^( 4) =       0.000535508229
  error estimate for blocks of size 2^( 5) =       0.000547658104
  error estimate for blocks of size 2^( 6) =       0.000554382498
  error estimate for blocks of size 2^( 7) =       0.000559091302

      target function =      -0.746511476126
              le_mean =     -22.814047501320
             les_mean =     520.929353993735
             stat err =       0.000549160033
             autocorr =       1.381093899831
   target nu stat err =       0.000549160033
   target dn stat err =       0.002699686751
      target stat err =       0.002317277368
              std dev =       0.660849121383
             le_variance =       0.436721561232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606351
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436695606351
                                         uncertainty =       0.002435638692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467290895
  error estimate for blocks of size 2^( 2) =       0.000493148451
  error estimate for blocks of size 2^( 3) =       0.000517371342
  error estimate for blocks of size 2^( 4) =       0.000535508229
  error estimate for blocks of size 2^( 5) =       0.000547658104
  error estimate for blocks of size 2^( 6) =       0.000554382498
  error estimate for blocks of size 2^( 7) =       0.000559091302

      target function =      -0.746511476127
              le_mean =     -22.814047501320
             les_mean =     520.929353993732
             stat err =       0.000549160033
             autocorr =       1.381093899849
   target nu stat err =       0.000549160033
   target dn stat err =       0.002699686751
      target stat err =       0.002317277367
              std dev =       0.660849121383
             le_variance =       0.436721561233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746511476127        initial  <--
     8.8818e+06     8.8818e+07             3.9158e-11        -0.746511476125
     3.5527e+07     3.5527e+08             9.7895e-12        -0.746511476126
     1.4211e+08     1.4211e+09             2.4474e-12        -0.746511476127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2725
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4046e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8723
    reference variance = 0.308831
====================================================
  Execution time = 2.5483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4701e-01
  Total weights = 1.964741449e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435419593830
                                         uncertainty =       0.002216538963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435419593830
                                         uncertainty =       0.002216538963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466539933
  error estimate for blocks of size 2^( 2) =       0.000492271176
  error estimate for blocks of size 2^( 3) =       0.000516235008
  error estimate for blocks of size 2^( 4) =       0.000535223988
  error estimate for blocks of size 2^( 5) =       0.000547676378
  error estimate for blocks of size 2^( 6) =       0.000555092866
  error estimate for blocks of size 2^( 7) =       0.000558187254

      target function =      -0.747826971083
              le_mean =     -22.814213281010
             les_mean =     520.935334527359
             stat err =       0.000549045122
             autocorr =       1.384963820222
   target nu stat err =       0.000549045122
   target dn stat err =       0.002615784590
      target stat err =       0.002258479311
              std dev =       0.659787100999
             le_variance =       0.435319018645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421328101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747832772990       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747832772991       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747832772991       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747832743417       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747832772991       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747832772991       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747832772991       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747832843879       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747832748719       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747832767919       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+07 is 3.567806e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747832772990       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747832772990       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747832772990       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747832772990       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747832772990       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747832772990       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747833216260       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747833286005       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747832772990       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747831431277       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+08 is 8.919010e-13

solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747832772990       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747832772990       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747832772990       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747832917902       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747832149320       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747832417047       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747830300500       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747830816413       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747828939003       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747835125674       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+09 is 2.231028e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0001e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7393
    reference variance = 0.406009
====================================================
  Execution time = 2.4699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4992e-01
  Total weights = 1.9648e+06
  Execution time = 3.5235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466941677
  error estimate for blocks of size 2^( 2) =       0.000492421186
  error estimate for blocks of size 2^( 3) =       0.000516873455
  error estimate for blocks of size 2^( 4) =       0.000535857659
  error estimate for blocks of size 2^( 5) =       0.000547193272
  error estimate for blocks of size 2^( 6) =       0.000552191992
  error estimate for blocks of size 2^( 7) =       0.000556568719

      target function =      -0.745411505650
              le_mean =     -22.814819445989
             les_mean =     520.965906400395
             stat err =       0.000547952910
             autocorr =       1.377086431697
   target nu stat err =       0.000547952910
   target dn stat err =       0.003236937890
      target stat err =       0.002744008287
              std dev =       0.660355251970
             le_variance =       0.436069058804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466941677
  error estimate for blocks of size 2^( 2) =       0.000492421186
  error estimate for blocks of size 2^( 3) =       0.000516873455
  error estimate for blocks of size 2^( 4) =       0.000535857659
  error estimate for blocks of size 2^( 5) =       0.000547193272
  error estimate for blocks of size 2^( 6) =       0.000552191992
  error estimate for blocks of size 2^( 7) =       0.000556568719

      target function =      -0.745411505600
              le_mean =     -22.814819445989
             les_mean =     520.965906400455
             stat err =       0.000547952910
             autocorr =       1.377086431692
   target nu stat err =       0.000547952910
   target dn stat err =       0.003236937899
      target stat err =       0.002744008294
              std dev =       0.660355251970
             le_variance =       0.436069058804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466941677
  error estimate for blocks of size 2^( 2) =       0.000492421186
  error estimate for blocks of size 2^( 3) =       0.000516873455
  error estimate for blocks of size 2^( 4) =       0.000535857659
  error estimate for blocks of size 2^( 5) =       0.000547193272
  error estimate for blocks of size 2^( 6) =       0.000552191992
  error estimate for blocks of size 2^( 7) =       0.000556568719

      target function =      -0.745411505626
              le_mean =     -22.814819445989
             les_mean =     520.965906400424
             stat err =       0.000547952910
             autocorr =       1.377086431690
   target nu stat err =       0.000547952910
   target dn stat err =       0.003236937894
      target stat err =       0.002744008291
              std dev =       0.660355251970
             le_variance =       0.436069058804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436103405600
                                         uncertainty =       0.002417723779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466941677
  error estimate for blocks of size 2^( 2) =       0.000492421186
  error estimate for blocks of size 2^( 3) =       0.000516873455
  error estimate for blocks of size 2^( 4) =       0.000535857659
  error estimate for blocks of size 2^( 5) =       0.000547193272
  error estimate for blocks of size 2^( 6) =       0.000552191992
  error estimate for blocks of size 2^( 7) =       0.000556568719

      target function =      -0.745411505647
              le_mean =     -22.814819445989
             les_mean =     520.965906400399
             stat err =       0.000547952910
             autocorr =       1.377086431696
   target nu stat err =       0.000547952910
   target dn stat err =       0.003236937890
      target stat err =       0.002744008288
              std dev =       0.660355251970
             le_variance =       0.436069058804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745411505650        initial  <--
     8.8818e+07     8.8818e+08             3.5678e-12        -0.745411505600
     3.5527e+08     3.5527e+09             8.9190e-13        -0.745411505626
     1.4211e+09     1.4211e+10             2.2310e-13        -0.745411505647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3223
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.9278
    reference variance = 0.328802
====================================================
  Execution time = 2.7473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4689e-01
  Total weights = 1.964780730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435133851185
                                         uncertainty =       0.002123240199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435133851185
                                         uncertainty =       0.002123240199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466435158
  error estimate for blocks of size 2^( 2) =       0.000491716936
  error estimate for blocks of size 2^( 3) =       0.000516772353
  error estimate for blocks of size 2^( 4) =       0.000534994218
  error estimate for blocks of size 2^( 5) =       0.000546445668
  error estimate for blocks of size 2^( 6) =       0.000553811349
  error estimate for blocks of size 2^( 7) =       0.000555297768

      target function =      -0.747926890410
              le_mean =     -22.814317908873
             les_mean =     520.939989203161
             stat err =       0.000547637251
             autocorr =       1.378489320071
   target nu stat err =       0.000547637251
   target dn stat err =       0.002621353595
      target stat err =       0.002263450116
              std dev =       0.659638926708
             le_variance =       0.435123513628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431790887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747932721751       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747932721751       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747932721751       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747932721751       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747932721751       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747932721751       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747935245843       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747932721751       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747932721751       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+08 is 2.831035e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747932721751       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747932721751       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747932721751       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747931165047       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747930523254       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747932741976       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747931159477       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747931580914       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747932135284       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747934363026       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+09 is 7.082323e-14

solving harmonic davidson linear method for identity shift 1.4211e+10, overlap shift 1.4211e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747932721751       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747932721751       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747932721751       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747924232124       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747930162148       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747932721751       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747936020551       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747932721751       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747932721751       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+10 is 1.767841e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1993e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8896
    reference variance = 0.408257
====================================================
  Execution time = 2.4753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5145e-01
  Total weights = 1.9648e+06
  Execution time = 3.5147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467323177
  error estimate for blocks of size 2^( 2) =       0.000493230984
  error estimate for blocks of size 2^( 3) =       0.000517977971
  error estimate for blocks of size 2^( 4) =       0.000536459112
  error estimate for blocks of size 2^( 5) =       0.000547543783
  error estimate for blocks of size 2^( 6) =       0.000553151624
  error estimate for blocks of size 2^( 7) =       0.000559766978

      target function =      -0.744147028580
              le_mean =     -22.815310997895
             les_mean =     520.989867547630
             stat err =       0.000549230374
             autocorr =       1.381256875940
   target nu stat err =       0.000549230374
   target dn stat err =       0.003328292815
      target stat err =       0.002810736921
              std dev =       0.660894775003
             le_variance =       0.436781903626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467323177
  error estimate for blocks of size 2^( 2) =       0.000493230984
  error estimate for blocks of size 2^( 3) =       0.000517977971
  error estimate for blocks of size 2^( 4) =       0.000536459112
  error estimate for blocks of size 2^( 5) =       0.000547543783
  error estimate for blocks of size 2^( 6) =       0.000553151624
  error estimate for blocks of size 2^( 7) =       0.000559766978

      target function =      -0.744147028580
              le_mean =     -22.815310997895
             les_mean =     520.989867547630
             stat err =       0.000549230374
             autocorr =       1.381256875938
   target nu stat err =       0.000549230374
   target dn stat err =       0.003328292815
      target stat err =       0.002810736921
              std dev =       0.660894775003
             le_variance =       0.436781903626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467323177
  error estimate for blocks of size 2^( 2) =       0.000493230984
  error estimate for blocks of size 2^( 3) =       0.000517977971
  error estimate for blocks of size 2^( 4) =       0.000536459112
  error estimate for blocks of size 2^( 5) =       0.000547543783
  error estimate for blocks of size 2^( 6) =       0.000553151624
  error estimate for blocks of size 2^( 7) =       0.000559766978

      target function =      -0.744147028580
              le_mean =     -22.815310997895
             les_mean =     520.989867547630
             stat err =       0.000549230374
             autocorr =       1.381256875942
   target nu stat err =       0.000549230374
   target dn stat err =       0.003328292815
      target stat err =       0.002810736921
              std dev =       0.660894775003
             le_variance =       0.436781903626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436638693501
                                         uncertainty =       0.002069952840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467323177
  error estimate for blocks of size 2^( 2) =       0.000493230984
  error estimate for blocks of size 2^( 3) =       0.000517977971
  error estimate for blocks of size 2^( 4) =       0.000536459112
  error estimate for blocks of size 2^( 5) =       0.000547543783
  error estimate for blocks of size 2^( 6) =       0.000553151624
  error estimate for blocks of size 2^( 7) =       0.000559766978

      target function =      -0.744147028580
              le_mean =     -22.815310997895
             les_mean =     520.989867547630
             stat err =       0.000549230374
             autocorr =       1.381256875943
   target nu stat err =       0.000549230374
   target dn stat err =       0.003328292815
      target stat err =       0.002810736921
              std dev =       0.660894775003
             le_variance =       0.436781903626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744147028580        initial
     8.8818e+08     8.8818e+09             2.8310e-13        -0.744147028580  <--
     3.5527e+09     3.5527e+10             7.0823e-14        -0.744147028580
     1.4211e+10     1.4211e+11             1.7678e-14        -0.744147028580

*****************************************************************************
Applying the update for shift_i =   8.8818e+08     and shift_s =   8.8818e+09
*****************************************************************************

  Execution time = 4.2333e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7936
    reference variance = 0.287323
====================================================
  Execution time = 2.5389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4430e-01
  Total weights = 1.964603757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432212508189
                                         uncertainty =       0.002016747427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432212508189
                                         uncertainty =       0.002016747427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464934873
  error estimate for blocks of size 2^( 2) =       0.000490842512
  error estimate for blocks of size 2^( 3) =       0.000515347549
  error estimate for blocks of size 2^( 4) =       0.000532558916
  error estimate for blocks of size 2^( 5) =       0.000545580448
  error estimate for blocks of size 2^( 6) =       0.000552042876
  error estimate for blocks of size 2^( 7) =       0.000555046708

      target function =      -0.750084321303
              le_mean =     -22.813899547806
             les_mean =     520.918308072053
             stat err =       0.000546307237
             autocorr =       1.380669281654
   target nu stat err =       0.000546307237
   target dn stat err =       0.002634823829
      target stat err =       0.002285092962
              std dev =       0.657517203509
             le_variance =       0.432328872910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281389954781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750090222497       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750090222497       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750090222497       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750090222497       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750090222497       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750090224475       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750090194863       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750090834686       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750090358876       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+08 is 1.421033e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750090222497       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750090222497       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750090222497       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750090222497       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750090222497       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750090223387       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750088338650       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750091757935       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750091300252       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+08 is 3.554304e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750090222497       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750090222497       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750090222497       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750090222497       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750090222397       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750090223027       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750088764457       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750092359942       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750084397007       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750084797541       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+09 is 8.892902e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9910e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.832
    reference variance = 0.39078
====================================================
  Execution time = 2.4781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5301e-01
  Total weights = 1.9645e+06
  Execution time = 3.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468854169
  error estimate for blocks of size 2^( 2) =       0.000494652418
  error estimate for blocks of size 2^( 3) =       0.000518213519
  error estimate for blocks of size 2^( 4) =       0.000536224547
  error estimate for blocks of size 2^( 5) =       0.000548347451
  error estimate for blocks of size 2^( 6) =       0.000555481134
  error estimate for blocks of size 2^( 7) =       0.000558037678

      target function =      -0.742867653090
              le_mean =     -22.814331968376
             les_mean =     520.946753566770
             stat err =       0.000549522702
             autocorr =       1.373712067388
   target nu stat err =       0.000549522702
   target dn stat err =       0.002970997283
      target stat err =       0.002511940271
              std dev =       0.663059925119
             le_variance =       0.439648464298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468854169
  error estimate for blocks of size 2^( 2) =       0.000494652418
  error estimate for blocks of size 2^( 3) =       0.000518213519
  error estimate for blocks of size 2^( 4) =       0.000536224547
  error estimate for blocks of size 2^( 5) =       0.000548347451
  error estimate for blocks of size 2^( 6) =       0.000555481134
  error estimate for blocks of size 2^( 7) =       0.000558037678

      target function =      -0.742867653053
              le_mean =     -22.814331968376
             les_mean =     520.946753566814
             stat err =       0.000549522702
             autocorr =       1.373712067386
   target nu stat err =       0.000549522702
   target dn stat err =       0.002970997301
      target stat err =       0.002511940285
              std dev =       0.663059925119
             le_variance =       0.439648464298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468854169
  error estimate for blocks of size 2^( 2) =       0.000494652418
  error estimate for blocks of size 2^( 3) =       0.000518213519
  error estimate for blocks of size 2^( 4) =       0.000536224547
  error estimate for blocks of size 2^( 5) =       0.000548347451
  error estimate for blocks of size 2^( 6) =       0.000555481134
  error estimate for blocks of size 2^( 7) =       0.000558037678

      target function =      -0.742867653071
              le_mean =     -22.814331968376
             les_mean =     520.946753566792
             stat err =       0.000549522702
             autocorr =       1.373712067387
   target nu stat err =       0.000549522702
   target dn stat err =       0.002970997292
      target stat err =       0.002511940278
              std dev =       0.663059925119
             le_variance =       0.439648464298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439521761358
                                         uncertainty =       0.002305405936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468854169
  error estimate for blocks of size 2^( 2) =       0.000494652418
  error estimate for blocks of size 2^( 3) =       0.000518213519
  error estimate for blocks of size 2^( 4) =       0.000536224547
  error estimate for blocks of size 2^( 5) =       0.000548347451
  error estimate for blocks of size 2^( 6) =       0.000555481134
  error estimate for blocks of size 2^( 7) =       0.000558037678

      target function =      -0.742867653087
              le_mean =     -22.814331968376
             les_mean =     520.946753566772
             stat err =       0.000549522702
             autocorr =       1.373712067386
   target nu stat err =       0.000549522702
   target dn stat err =       0.002970997284
      target stat err =       0.002511940272
              std dev =       0.663059925119
             le_variance =       0.439648464298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742867653090        initial  <--
     2.2204e+08     2.2204e+09             1.4210e-12        -0.742867653053
     8.8818e+08     8.8818e+09             3.5543e-13        -0.742867653071
     3.5527e+09     3.5527e+10             8.8929e-14        -0.742867653087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3254
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7997
    reference variance = 0.474218
====================================================
  Execution time = 2.7117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4517e-01
  Total weights = 1.964644423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433949314391
                                         uncertainty =       0.001796265296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433949314391
                                         uncertainty =       0.001796265296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465805331
  error estimate for blocks of size 2^( 2) =       0.000491331350
  error estimate for blocks of size 2^( 3) =       0.000515593059
  error estimate for blocks of size 2^( 4) =       0.000534015919
  error estimate for blocks of size 2^( 5) =       0.000545428881
  error estimate for blocks of size 2^( 6) =       0.000553180662
  error estimate for blocks of size 2^( 7) =       0.000555646077

      target function =      -0.749350760619
              le_mean =     -22.813487498196
             les_mean =     520.900381651004
             stat err =       0.000547067885
             autocorr =       1.379346988830
   target nu stat err =       0.000547067885
   target dn stat err =       0.002460517503
      target stat err =       0.002139909326
              std dev =       0.658748217022
             le_variance =       0.433949213429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281348749820e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749355913805       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749355913805       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749355913805       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749355913805       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749355913817       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749355915071       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749357230629       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749355929763       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749353270766       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749361956117       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+09 is 1.146476e-13

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749355913805       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749355913805       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749355913805       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749355913805       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749355913805       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749355913867       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749355915180       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749350807612       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749358794895       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749338472862       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749347360194       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749363680595       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749369420705       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749335324928       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749373352843       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+09 is 2.851063e-14

solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749355913805       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749355913805       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749355913805       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749355913805       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749355913805       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749355913601       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749356099831       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749303772415       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749381160587       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749366051921       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749391503875       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749366066896       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749357807544       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749359368648       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749333518596       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749297476047       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749315822153       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749369723176       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749355031201       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749396114650       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749323328994       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749378369219       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749349268875       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749340765454       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749396150534       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749331101607       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749357990964       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749369997978       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749373893455       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749331171245       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749368666595       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749360678079       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749355718516       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749380526778       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.749312287747       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749352796885       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749320293277       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749333576069       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749363528426       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.749342923943       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749389718525       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749368910642       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749369705808       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749339711867       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749354281713       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749404199010       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749311165680       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749392272343       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.749331871449       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749350297637       residual = 4.31e-07           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.749340069927       residual = 3.11e-07           smallest_sin_value = 9.97e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.749347929792       residual = 7.22e-07           smallest_sin_value = 9.94e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+10 is 7.186204e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1907e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8822
    reference variance = 0.357466
====================================================
  Execution time = 2.4627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6027e-01
  Total weights = 1.9646e+06
  Execution time = 3.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467944238
  error estimate for blocks of size 2^( 2) =       0.000493704704
  error estimate for blocks of size 2^( 3) =       0.000517723474
  error estimate for blocks of size 2^( 4) =       0.000535224696
  error estimate for blocks of size 2^( 5) =       0.000549195210
  error estimate for blocks of size 2^( 6) =       0.000555468936
  error estimate for blocks of size 2^( 7) =       0.000561258680

      target function =      -0.736830414854
              le_mean =     -22.815080436484
             les_mean =     520.988166387311
             stat err =       0.000550286880
             autocorr =       1.382897875396
   target nu stat err =       0.000550286880
   target dn stat err =       0.012002601838
      target stat err =       0.009719125760
              std dev =       0.661773087982
             le_variance =       0.437943619977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467944238
  error estimate for blocks of size 2^( 2) =       0.000493704704
  error estimate for blocks of size 2^( 3) =       0.000517723474
  error estimate for blocks of size 2^( 4) =       0.000535224696
  error estimate for blocks of size 2^( 5) =       0.000549195210
  error estimate for blocks of size 2^( 6) =       0.000555468936
  error estimate for blocks of size 2^( 7) =       0.000561258680

      target function =      -0.736830414854
              le_mean =     -22.815080436484
             les_mean =     520.988166387311
             stat err =       0.000550286880
             autocorr =       1.382897875398
   target nu stat err =       0.000550286880
   target dn stat err =       0.012002601838
      target stat err =       0.009719125760
              std dev =       0.661773087982
             le_variance =       0.437943619977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467944238
  error estimate for blocks of size 2^( 2) =       0.000493704704
  error estimate for blocks of size 2^( 3) =       0.000517723474
  error estimate for blocks of size 2^( 4) =       0.000535224696
  error estimate for blocks of size 2^( 5) =       0.000549195210
  error estimate for blocks of size 2^( 6) =       0.000555468936
  error estimate for blocks of size 2^( 7) =       0.000561258680

      target function =      -0.736830414854
              le_mean =     -22.815080436484
             les_mean =     520.988166387311
             stat err =       0.000550286880
             autocorr =       1.382897875397
   target nu stat err =       0.000550286880
   target dn stat err =       0.012002601838
      target stat err =       0.009719125760
              std dev =       0.661773087982
             le_variance =       0.437943619977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437991239772
                                         uncertainty =       0.002825351042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467944238
  error estimate for blocks of size 2^( 2) =       0.000493704704
  error estimate for blocks of size 2^( 3) =       0.000517723474
  error estimate for blocks of size 2^( 4) =       0.000535224696
  error estimate for blocks of size 2^( 5) =       0.000549195210
  error estimate for blocks of size 2^( 6) =       0.000555468936
  error estimate for blocks of size 2^( 7) =       0.000561258680

      target function =      -0.736830414854
              le_mean =     -22.815080436484
             les_mean =     520.988166387311
             stat err =       0.000550286880
             autocorr =       1.382897875397
   target nu stat err =       0.000550286880
   target dn stat err =       0.012002601838
      target stat err =       0.009719125760
              std dev =       0.661773087982
             le_variance =       0.437943619977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736830414854        initial  <--
     2.2204e+09     2.2204e+10             1.1465e-13        -0.736830414854
     8.8818e+09     8.8818e+10             2.8511e-14        -0.736830414854
     3.5527e+10     3.5527e+11             7.1862e-15        -0.736830414854

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1927
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8339
    reference variance = 0.448296
====================================================
  Execution time = 2.5372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4838e-01
  Total weights = 1.964884162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436284132229
                                         uncertainty =       0.002317222094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436284132229
                                         uncertainty =       0.002317222094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467058474
  error estimate for blocks of size 2^( 2) =       0.000492569525
  error estimate for blocks of size 2^( 3) =       0.000517129162
  error estimate for blocks of size 2^( 4) =       0.000536334944
  error estimate for blocks of size 2^( 5) =       0.000546137270
  error estimate for blocks of size 2^( 6) =       0.000553638496
  error estimate for blocks of size 2^( 7) =       0.000557973873

      target function =      -0.746689171883
              le_mean =     -22.814169186892
             les_mean =     520.934691390938
             stat err =       0.000548521145
             autocorr =       1.379253948747
   target nu stat err =       0.000548521145
   target dn stat err =       0.002887957286
      target stat err =       0.002469464433
              std dev =       0.660520428728
             le_variance =       0.436287236768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281416918689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746696397710       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746696397710       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746696397710       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746696397710       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746696398018       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746696397710       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746714849676       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746696397710       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746673631605       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746696397710       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746664007527       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746742502612       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746581747045       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746704359061       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746683939438       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746805756831       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746765726888       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746642577749       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746664684531       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746684786592       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746709532596       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746745443712       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746700907199       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746706464920       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746676305649       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746721904587       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746680458346       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746713280749       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746689256325       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746701463232       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746705782646       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746695686344       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746689266658       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746681367733       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746699030560       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746718012840       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746654447751       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746687632177       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746717850854       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746708214484       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746700493687       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746732308763       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746701234818       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746733904550       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746697864814       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746686498870       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746677580544       residual = 2.73e-08           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746672623672       residual = 4.63e-08           smallest_sin_value = 9.96e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+10 is 1.132640e-14

solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746696397710       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746696397710       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746696397710       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746696397710       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746696397710       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746696397710       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746696397710       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746555218417       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746743467413       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746814079764       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746846390125       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746538019324       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746754431117       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746712529175       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746831508504       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746766237598       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746693802557       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746747852373       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746695333591       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746693741510       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746707503172       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746697356648       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746747505342       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746718558346       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746657006966       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746762061738       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746726486130       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746646561111       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746568802755       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746682332853       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746689972542       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746692691307       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746743031708       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746801485071       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746676587898       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746665745017       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746716395469       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746670789797       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746695212287       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746742794155       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746719908687       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746682210061       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746663589488       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746689066654       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746696163280       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746723572076       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746686801227       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746665537333       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746679743590       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746769320251       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746698345102       residual = 2.85e-07           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746723747447       residual = 6.39e-07           smallest_sin_value = 9.97e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746609525215       residual = 1.01e-06           smallest_sin_value = 9.91e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+10 is 2.829790e-15

solving harmonic davidson linear method for identity shift 3.5527e+11, overlap shift 3.5527e+12 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746696397710       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746696397710       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746696397710       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746696397710       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746696397708       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746678855430       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746645633618       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746854845071       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746679100777       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746667172049       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746169360976       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746860401242       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747307226508       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746973967250       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746803577133       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746927533181       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746794876282       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746085858801       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746754224373       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746444787779       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746601233686       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746662067117       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746208510521       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746166893223       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746404476482       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746500562657       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746749066569       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746440277156       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746406438530       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746661968288       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746777586362       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746224726239       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746515433344       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746802791100       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746598263946       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747337829494       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746944179806       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746708921207       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746733777815       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746664356449       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746488018966       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746547683573       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746933976032       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746532567932       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746457966739       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746640089835       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746720600627       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746490437502       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746792141498       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746769846454       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746765260529       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746825890908       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746529946893       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746900339782       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.746632712602       residual = 3.98e-06           smallest_sin_value = 9.98e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+11 is 6.976197e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.566425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0620e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8261
    reference variance = 0.279486
====================================================
  Execution time = 2.4895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4433e-01
  Total weights = 1.9646e+06
  Execution time = 3.5281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465717210
  error estimate for blocks of size 2^( 2) =       0.000491432360
  error estimate for blocks of size 2^( 3) =       0.000515895153
  error estimate for blocks of size 2^( 4) =       0.000534197933
  error estimate for blocks of size 2^( 5) =       0.000545043588
  error estimate for blocks of size 2^( 6) =       0.000548737367
  error estimate for blocks of size 2^( 7) =       0.000554416821

      target function =      -0.750067824827
              le_mean =     -22.815316529329
             les_mean =     520.983001624416
             stat err =       0.000545598927
             autocorr =       1.372468674543
   target nu stat err =       0.000545598927
   target dn stat err =       0.002304668098
      target stat err =       0.002024359594
              std dev =       0.658623594962
             le_variance =       0.433785039841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465717210
  error estimate for blocks of size 2^( 2) =       0.000491432360
  error estimate for blocks of size 2^( 3) =       0.000515895153
  error estimate for blocks of size 2^( 4) =       0.000534197933
  error estimate for blocks of size 2^( 5) =       0.000545043588
  error estimate for blocks of size 2^( 6) =       0.000548737367
  error estimate for blocks of size 2^( 7) =       0.000554416821

      target function =      -0.750067824827
              le_mean =     -22.815316529329
             les_mean =     520.983001624415
             stat err =       0.000545598927
             autocorr =       1.372468674540
   target nu stat err =       0.000545598927
   target dn stat err =       0.002304668098
      target stat err =       0.002024359594
              std dev =       0.658623594962
             le_variance =       0.433785039841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465717210
  error estimate for blocks of size 2^( 2) =       0.000491432360
  error estimate for blocks of size 2^( 3) =       0.000515895153
  error estimate for blocks of size 2^( 4) =       0.000534197933
  error estimate for blocks of size 2^( 5) =       0.000545043588
  error estimate for blocks of size 2^( 6) =       0.000548737367
  error estimate for blocks of size 2^( 7) =       0.000554416821

      target function =      -0.750067824827
              le_mean =     -22.815316529329
             les_mean =     520.983001624416
             stat err =       0.000545598927
             autocorr =       1.372468674542
   target nu stat err =       0.000545598927
   target dn stat err =       0.002304668098
      target stat err =       0.002024359594
              std dev =       0.658623594962
             le_variance =       0.433785039841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433864868465
                                         uncertainty =       0.001890189858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465717210
  error estimate for blocks of size 2^( 2) =       0.000491432360
  error estimate for blocks of size 2^( 3) =       0.000515895153
  error estimate for blocks of size 2^( 4) =       0.000534197933
  error estimate for blocks of size 2^( 5) =       0.000545043588
  error estimate for blocks of size 2^( 6) =       0.000548737367
  error estimate for blocks of size 2^( 7) =       0.000554416821

      target function =      -0.750067824827
              le_mean =     -22.815316529329
             les_mean =     520.983001624416
             stat err =       0.000545598927
             autocorr =       1.372468674544
   target nu stat err =       0.000545598927
   target dn stat err =       0.002304668098
      target stat err =       0.002024359594
              std dev =       0.658623594962
             le_variance =       0.433785039841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750067824827        initial
     2.2204e+10     2.2204e+11             1.1326e-14        -0.750067824827  <--
     8.8818e+10     8.8818e+11             2.8298e-15        -0.750067824827
     3.5527e+11     3.5527e+12             6.9762e-16        -0.750067824827

*****************************************************************************
Applying the update for shift_i =   2.2204e+10     and shift_s =   2.2204e+11
*****************************************************************************

  Execution time = 4.2598e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.761
    reference variance = 0.327096
====================================================
  Execution time = 2.6421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5387e-01
  Total weights = 1.964836615e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438191082876
                                         uncertainty =       0.003617562248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438191082876
                                         uncertainty =       0.003617562248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468158373
  error estimate for blocks of size 2^( 2) =       0.000493584081
  error estimate for blocks of size 2^( 3) =       0.000517708239
  error estimate for blocks of size 2^( 4) =       0.000535984757
  error estimate for blocks of size 2^( 5) =       0.000547729286
  error estimate for blocks of size 2^( 6) =       0.000552518679
  error estimate for blocks of size 2^( 7) =       0.000556197937

      target function =      -0.742153001777
              le_mean =     -22.814864305734
             les_mean =     520.971898469846
             stat err =       0.000548107665
             autocorr =       1.370711825244
   target nu stat err =       0.000548107665
   target dn stat err =       0.004778555704
      target stat err =       0.003962635190
              std dev =       0.662075921006
             le_variance =       0.438344525175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281486430573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742173345952       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742173345952       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742173345952       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742173345952       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742173345952       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742173345952       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742173345952       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742173345952       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742167797238       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742173345952       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+09 is 6.082441e-14

solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742173345952       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742173345952       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742173345952       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742173345952       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742173345952       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742173345952       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742171310511       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742173345952       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742173345952       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742190598457       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742226504953       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742185291956       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742152074548       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742162310827       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742155849352       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742221059757       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742180238760       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742181665207       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742173582546       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742144380462       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742175173850       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742182384357       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742174185909       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742176261536       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742170807929       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742179737148       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742166633946       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742190461452       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742179910773       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742147351591       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742174894963       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742166502860       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742175936134       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742173044855       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742196142765       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742153045695       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742184357315       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742173943542       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742172092928       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742182064978       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742191303004       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742160918718       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742156347706       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742163367928       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742170676606       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742171784072       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742167347321       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742190786744       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742183615358       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742171878860       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742154754879       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742173512561       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742208957145       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742181736627       residual = 2.07e-07           smallest_sin_value = 9.98e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+10 is 1.517194e-14

solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742173345952       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742173345952       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742173345952       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742173345952       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742151052729       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742184678400       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742173345952       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741941660795       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742173345952       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742079208049       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742110265410       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742159189176       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742211492772       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742327967016       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742126987242       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742255105292       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742218843205       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742474967341       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742058575003       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741964244687       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742250703954       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742243876039       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742219777813       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742110465033       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742381632285       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742361440174       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741901727181       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742426572722       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742106488908       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742305237863       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742046626181       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742209265042       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742236518422       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742284750892       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742379361587       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742136917377       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742077503154       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742155323121       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742224311549       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742232154941       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742321542180       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742103046850       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742268009879       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742329311549       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742178472224       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742182485103       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742225516988       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742215483262       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742207763087       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742191696050       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742204691402       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742168421817       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742155259301       residual = 7.41e-06           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742118051048       residual = 2.00e-06           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.742140795071       residual = 6.90e-06           smallest_sin_value = 9.96e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+10 is 3.816996e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.692784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1311e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7054
    reference variance = 0.32389
====================================================
  Execution time = 2.4616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4742e-01
  Total weights = 1.9649e+06
  Execution time = 3.5159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466371406
  error estimate for blocks of size 2^( 2) =       0.000492377013
  error estimate for blocks of size 2^( 3) =       0.000517709761
  error estimate for blocks of size 2^( 4) =       0.000535789287
  error estimate for blocks of size 2^( 5) =       0.000547281658
  error estimate for blocks of size 2^( 6) =       0.000553368048
  error estimate for blocks of size 2^( 7) =       0.000555390628

      target function =      -0.747488067084
              le_mean =     -22.814544826863
             les_mean =     520.950873379634
             stat err =       0.000547957405
             autocorr =       1.380478891663
   target nu stat err =       0.000547957405
   target dn stat err =       0.002518039409
      target stat err =       0.002179195444
              std dev =       0.659548767396
             le_variance =       0.435004576574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466371406
  error estimate for blocks of size 2^( 2) =       0.000492377013
  error estimate for blocks of size 2^( 3) =       0.000517709761
  error estimate for blocks of size 2^( 4) =       0.000535789287
  error estimate for blocks of size 2^( 5) =       0.000547281658
  error estimate for blocks of size 2^( 6) =       0.000553368048
  error estimate for blocks of size 2^( 7) =       0.000555390628

      target function =      -0.747488067084
              le_mean =     -22.814544826863
             les_mean =     520.950873379634
             stat err =       0.000547957405
             autocorr =       1.380478891660
   target nu stat err =       0.000547957405
   target dn stat err =       0.002518039409
      target stat err =       0.002179195444
              std dev =       0.659548767396
             le_variance =       0.435004576574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466371406
  error estimate for blocks of size 2^( 2) =       0.000492377013
  error estimate for blocks of size 2^( 3) =       0.000517709761
  error estimate for blocks of size 2^( 4) =       0.000535789287
  error estimate for blocks of size 2^( 5) =       0.000547281658
  error estimate for blocks of size 2^( 6) =       0.000553368048
  error estimate for blocks of size 2^( 7) =       0.000555390628

      target function =      -0.747488067084
              le_mean =     -22.814544826863
             les_mean =     520.950873379634
             stat err =       0.000547957405
             autocorr =       1.380478891660
   target nu stat err =       0.000547957405
   target dn stat err =       0.002518039409
      target stat err =       0.002179195444
              std dev =       0.659548767396
             le_variance =       0.435004576574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989641866
                                         uncertainty =       0.001700797479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466371406
  error estimate for blocks of size 2^( 2) =       0.000492377013
  error estimate for blocks of size 2^( 3) =       0.000517709761
  error estimate for blocks of size 2^( 4) =       0.000535789287
  error estimate for blocks of size 2^( 5) =       0.000547281658
  error estimate for blocks of size 2^( 6) =       0.000553368048
  error estimate for blocks of size 2^( 7) =       0.000555390628

      target function =      -0.747488067084
              le_mean =     -22.814544826863
             les_mean =     520.950873379634
             stat err =       0.000547957405
             autocorr =       1.380478891659
   target nu stat err =       0.000547957405
   target dn stat err =       0.002518039409
      target stat err =       0.002179195444
              std dev =       0.659548767396
             le_variance =       0.435004576574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747488067084        initial
     5.5511e+09     5.5511e+10             6.0824e-14        -0.747488067084  <--
     2.2204e+10     2.2204e+11             1.5172e-14        -0.747488067084
     8.8818e+10     8.8818e+11             3.8170e-15        -0.747488067084

*****************************************************************************
Applying the update for shift_i =   5.5511e+09     and shift_s =   5.5511e+10
*****************************************************************************

  Execution time = 4.2199e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.298642
====================================================
  Execution time = 2.5296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4866e-01
  Total weights = 1.964500044e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438775121755
                                         uncertainty =       0.003310733111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438775121755
                                         uncertainty =       0.003310733111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468361691
  error estimate for blocks of size 2^( 2) =       0.000493987587
  error estimate for blocks of size 2^( 3) =       0.000517738582
  error estimate for blocks of size 2^( 4) =       0.000535880476
  error estimate for blocks of size 2^( 5) =       0.000547081343
  error estimate for blocks of size 2^( 6) =       0.000554502879
  error estimate for blocks of size 2^( 7) =       0.000557070311

      target function =      -0.746444679600
              le_mean =     -22.813558130167
             les_mean =     520.907093820069
             stat err =       0.000548633752
             autocorr =       1.372152285796
   target nu stat err =       0.000548633752
   target dn stat err =       0.003905356178
      target stat err =       0.003288073973
              std dev =       0.662363455706
             le_variance =       0.438725347455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281355813017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746458169452       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746458169452       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746458169452       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746458169452       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746458667992       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746457976509       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746457730285       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746457389451       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746456833506       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746457101043       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+09 is 1.494488e-13

solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746458169452       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746458169452       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746458169452       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746458017166       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746459323047       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746458169151       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746456641783       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746451701273       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746458067752       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746453665622       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+09 is 3.736626e-14

solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746458169452       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746458169452       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746458169452       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746466919330       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746452788975       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746466552841       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746448965129       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746406724003       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746447085443       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746422388960       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746446869992       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746541989900       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746491323639       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746438005914       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746464189481       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746474685071       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746442351898       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746570335509       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746438904561       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746469218284       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746419353903       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746449018532       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746480711069       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746432604378       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746437022709       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746492363856       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746471650004       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746393715423       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746507701195       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746397629371       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746468505158       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746480200331       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746417288512       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746433214656       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746470511222       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746460609420       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746426708608       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746432516187       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746445844280       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746459561420       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746475224814       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746461630573       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746460325479       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746475406597       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746413993477       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746475781992       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746453074566       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746399332505       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746459561861       residual = 2.96e-08           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746438892088       residual = 5.51e-08           smallest_sin_value = 9.98e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746477174927       residual = 8.88e-08           smallest_sin_value = 9.91e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+10 is 9.351785e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.747062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9887e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.9366
    reference variance = 0.389658
====================================================
  Execution time = 2.4530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5137e-01
  Total weights = 1.9646e+06
  Execution time = 3.5047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467554401
  error estimate for blocks of size 2^( 2) =       0.000493155895
  error estimate for blocks of size 2^( 3) =       0.000517042405
  error estimate for blocks of size 2^( 4) =       0.000535232171
  error estimate for blocks of size 2^( 5) =       0.000545968737
  error estimate for blocks of size 2^( 6) =       0.000552532262
  error estimate for blocks of size 2^( 7) =       0.000556986713

      target function =      -0.744211777471
              le_mean =     -22.815325766667
             les_mean =     520.990464232856
             stat err =       0.000547679971
             autocorr =       1.372111547984
   target nu stat err =       0.000547679971
   target dn stat err =       0.003125545765
      target stat err =       0.002647898674
              std dev =       0.661221774407
             le_variance =       0.437214234950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467554401
  error estimate for blocks of size 2^( 2) =       0.000493155895
  error estimate for blocks of size 2^( 3) =       0.000517042405
  error estimate for blocks of size 2^( 4) =       0.000535232171
  error estimate for blocks of size 2^( 5) =       0.000545968737
  error estimate for blocks of size 2^( 6) =       0.000552532262
  error estimate for blocks of size 2^( 7) =       0.000556986713

      target function =      -0.744211777471
              le_mean =     -22.815325766667
             les_mean =     520.990464232856
             stat err =       0.000547679971
             autocorr =       1.372111547987
   target nu stat err =       0.000547679971
   target dn stat err =       0.003125545765
      target stat err =       0.002647898674
              std dev =       0.661221774407
             le_variance =       0.437214234950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467554401
  error estimate for blocks of size 2^( 2) =       0.000493155895
  error estimate for blocks of size 2^( 3) =       0.000517042405
  error estimate for blocks of size 2^( 4) =       0.000535232171
  error estimate for blocks of size 2^( 5) =       0.000545968737
  error estimate for blocks of size 2^( 6) =       0.000552532262
  error estimate for blocks of size 2^( 7) =       0.000556986713

      target function =      -0.744211777471
              le_mean =     -22.815325766667
             les_mean =     520.990464232856
             stat err =       0.000547679971
             autocorr =       1.372111547985
   target nu stat err =       0.000547679971
   target dn stat err =       0.003125545765
      target stat err =       0.002647898674
              std dev =       0.661221774407
             le_variance =       0.437214234950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437198960350
                                         uncertainty =       0.002316564357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467554401
  error estimate for blocks of size 2^( 2) =       0.000493155895
  error estimate for blocks of size 2^( 3) =       0.000517042405
  error estimate for blocks of size 2^( 4) =       0.000535232171
  error estimate for blocks of size 2^( 5) =       0.000545968737
  error estimate for blocks of size 2^( 6) =       0.000552532262
  error estimate for blocks of size 2^( 7) =       0.000556986713

      target function =      -0.744211777471
              le_mean =     -22.815325766667
             les_mean =     520.990464232856
             stat err =       0.000547679971
             autocorr =       1.372111547982
   target nu stat err =       0.000547679971
   target dn stat err =       0.003125545765
      target stat err =       0.002647898674
              std dev =       0.661221774407
             le_variance =       0.437214234950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744211777471        initial
     1.3878e+09     1.3878e+10             1.4945e-13        -0.744211777471  <--
     5.5511e+09     5.5511e+10             3.7366e-14        -0.744211777471
     2.2204e+10     2.2204e+11             9.3518e-15        -0.744211777471

*****************************************************************************
Applying the update for shift_i =   1.3878e+09     and shift_s =   1.3878e+10
*****************************************************************************

  Execution time = 4.2067e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8787
    reference variance = 0.24338
====================================================
  Execution time = 2.5215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4711e-01
  Total weights = 1.964588055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434539227465
                                         uncertainty =       0.001863437976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434539227465
                                         uncertainty =       0.001863437976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466115116
  error estimate for blocks of size 2^( 2) =       0.000492052467
  error estimate for blocks of size 2^( 3) =       0.000516074083
  error estimate for blocks of size 2^( 4) =       0.000533960435
  error estimate for blocks of size 2^( 5) =       0.000545297286
  error estimate for blocks of size 2^( 6) =       0.000552406707
  error estimate for blocks of size 2^( 7) =       0.000556913307

      target function =      -0.747743741608
              le_mean =     -22.814740477568
             les_mean =     520.959493839515
             stat err =       0.000547144434
             autocorr =       1.377899670324
   target nu stat err =       0.000547144434
   target dn stat err =       0.002656414201
      target stat err =       0.002291758370
              std dev =       0.659186318950
             le_variance =       0.434526603090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281474047757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+08, overlap shift 3.4694e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747749771282       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747749771282       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747749771282       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747749771282       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747749755082       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747749765633       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747750207377       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747750000740       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747749905323       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+08 is 6.646320e-13

solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747749771282       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747749771282       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747749771282       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747749771282       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747749771282       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747749632249       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747749826669       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747749361136       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747750550202       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+09 is 1.661246e-13

solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747749771282       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747749771282       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747749771282       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747749771282       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747749771282       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747749771282       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747750231026       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747754233415       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747760009922       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+09 is 4.154578e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.750099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9746e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8538
    reference variance = 0.346853
====================================================
  Execution time = 2.6564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4723e-01
  Total weights = 1.9645e+06
  Execution time = 3.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466742947
  error estimate for blocks of size 2^( 2) =       0.000492740716
  error estimate for blocks of size 2^( 3) =       0.000517920854
  error estimate for blocks of size 2^( 4) =       0.000536420073
  error estimate for blocks of size 2^( 5) =       0.000548642292
  error estimate for blocks of size 2^( 6) =       0.000556788625
  error estimate for blocks of size 2^( 7) =       0.000561645018

      target function =      -0.747640301435
              le_mean =     -22.814131995257
             les_mean =     520.931848505675
             stat err =       0.000550874002
             autocorr =       1.392993292297
   target nu stat err =       0.000550874002
   target dn stat err =       0.002792074856
      target stat err =       0.002398972034
              std dev =       0.660074206019
             le_variance =       0.435697957452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466742947
  error estimate for blocks of size 2^( 2) =       0.000492740716
  error estimate for blocks of size 2^( 3) =       0.000517920854
  error estimate for blocks of size 2^( 4) =       0.000536420073
  error estimate for blocks of size 2^( 5) =       0.000548642292
  error estimate for blocks of size 2^( 6) =       0.000556788625
  error estimate for blocks of size 2^( 7) =       0.000561645018

      target function =      -0.747640301435
              le_mean =     -22.814131995257
             les_mean =     520.931848505676
             stat err =       0.000550874002
             autocorr =       1.392993292302
   target nu stat err =       0.000550874002
   target dn stat err =       0.002792074856
      target stat err =       0.002398972034
              std dev =       0.660074206019
             le_variance =       0.435697957452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466742947
  error estimate for blocks of size 2^( 2) =       0.000492740716
  error estimate for blocks of size 2^( 3) =       0.000517920854
  error estimate for blocks of size 2^( 4) =       0.000536420073
  error estimate for blocks of size 2^( 5) =       0.000548642292
  error estimate for blocks of size 2^( 6) =       0.000556788625
  error estimate for blocks of size 2^( 7) =       0.000561645018

      target function =      -0.747640301435
              le_mean =     -22.814131995257
             les_mean =     520.931848505675
             stat err =       0.000550874002
             autocorr =       1.392993292304
   target nu stat err =       0.000550874002
   target dn stat err =       0.002792074856
      target stat err =       0.002398972034
              std dev =       0.660074206019
             le_variance =       0.435697957452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435755627484
                                         uncertainty =       0.002381347717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466742947
  error estimate for blocks of size 2^( 2) =       0.000492740716
  error estimate for blocks of size 2^( 3) =       0.000517920854
  error estimate for blocks of size 2^( 4) =       0.000536420073
  error estimate for blocks of size 2^( 5) =       0.000548642292
  error estimate for blocks of size 2^( 6) =       0.000556788625
  error estimate for blocks of size 2^( 7) =       0.000561645018

      target function =      -0.747640301435
              le_mean =     -22.814131995257
             les_mean =     520.931848505675
             stat err =       0.000550874002
             autocorr =       1.392993292298
   target nu stat err =       0.000550874002
   target dn stat err =       0.002792074856
      target stat err =       0.002398972034
              std dev =       0.660074206019
             le_variance =       0.435697957452


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747640301435        initial  <--
     3.4694e+08     3.4694e+09             6.6463e-13        -0.747640301435
     1.3878e+09     1.3878e+10             1.6612e-13        -0.747640301435
     5.5511e+09     5.5511e+10             4.1546e-14        -0.747640301435

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1481
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.8193
    reference variance = 0.334917
====================================================
  Execution time = 2.5395e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4336e-01
  Total weights = 1.965009326e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431395669405
                                         uncertainty =       0.001703462798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431395669405
                                         uncertainty =       0.001703462798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464392424
  error estimate for blocks of size 2^( 2) =       0.000490435012
  error estimate for blocks of size 2^( 3) =       0.000515475337
  error estimate for blocks of size 2^( 4) =       0.000533507436
  error estimate for blocks of size 2^( 5) =       0.000545781272
  error estimate for blocks of size 2^( 6) =       0.000551733072
  error estimate for blocks of size 2^( 7) =       0.000554747662

      target function =      -0.750866556609
              le_mean =     -22.813935627976
             les_mean =     520.919021840306
             stat err =       0.000546442361
             autocorr =       1.384581313356
   target nu stat err =       0.000546442361
   target dn stat err =       0.002300333692
      target stat err =       0.002021136827
              std dev =       0.656750063801
             le_variance =       0.431320646302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281393562798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+09, overlap shift 3.4694e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750870958865       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750870958865       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750870958865       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750870410458       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750870958865       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750870958865       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750870958865       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750870958865       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750870958865       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+09 is 1.112144e-13

solving harmonic davidson linear method for identity shift 1.3878e+10, overlap shift 1.3878e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750870958865       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750870958865       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750870958865       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750861994177       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750870958865       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750868437033       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750870958865       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750867985880       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750870958865       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+10 is 2.780367e-14

solving harmonic davidson linear method for identity shift 5.5511e+10, overlap shift 5.5511e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750870958865       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750870958865       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750870958865       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750852028270       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750870958865       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750870958865       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750870514011       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750870958865       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750870958865       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750870958865       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750870958865       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750896887818       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750922691540       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750844387551       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750869230490       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750866223198       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750880821224       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750767035891       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750843757011       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750935054623       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750845438393       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750936722693       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750754160268       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750925652935       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750752594813       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750843967053       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750923760206       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750827036507       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751020171874       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750846987396       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750823064241       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750804522472       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750743870419       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750780574437       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750890874835       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750908858117       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750932813129       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750855569721       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750871123537       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750956219738       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750840195397       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750850182995       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750747477845       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750865248733       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750835353286       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750877537422       residual = 1.37e-06           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750872217738       residual = 2.33e-07           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.751000032828       residual = 2.13e-07           smallest_sin_value = 9.95e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+10 is 6.936124e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.794883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9986e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.8174
    reference variance = 0.437241
====================================================
  Execution time = 2.4837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4893e-01
  Total weights = 1.9649e+06
  Execution time = 3.5143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466852004
  error estimate for blocks of size 2^( 2) =       0.000492342843
  error estimate for blocks of size 2^( 3) =       0.000516768340
  error estimate for blocks of size 2^( 4) =       0.000534691637
  error estimate for blocks of size 2^( 5) =       0.000545784662
  error estimate for blocks of size 2^( 6) =       0.000552518553
  error estimate for blocks of size 2^( 7) =       0.000555242842

      target function =      -0.746229800750
              le_mean =     -22.813824059229
             les_mean =     520.919497905182
             stat err =       0.000547059424
             autocorr =       1.373126512782
   target nu stat err =       0.000547059424
   target dn stat err =       0.002693560837
      target stat err =       0.002309318764
              std dev =       0.660228435369
             le_variance =       0.435901586870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466852004
  error estimate for blocks of size 2^( 2) =       0.000492342843
  error estimate for blocks of size 2^( 3) =       0.000516768340
  error estimate for blocks of size 2^( 4) =       0.000534691637
  error estimate for blocks of size 2^( 5) =       0.000545784662
  error estimate for blocks of size 2^( 6) =       0.000552518553
  error estimate for blocks of size 2^( 7) =       0.000555242842

      target function =      -0.746229800750
              le_mean =     -22.813824059229
             les_mean =     520.919497905182
             stat err =       0.000547059424
             autocorr =       1.373126512782
   target nu stat err =       0.000547059424
   target dn stat err =       0.002693560837
      target stat err =       0.002309318764
              std dev =       0.660228435369
             le_variance =       0.435901586870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466852004
  error estimate for blocks of size 2^( 2) =       0.000492342843
  error estimate for blocks of size 2^( 3) =       0.000516768340
  error estimate for blocks of size 2^( 4) =       0.000534691637
  error estimate for blocks of size 2^( 5) =       0.000545784662
  error estimate for blocks of size 2^( 6) =       0.000552518553
  error estimate for blocks of size 2^( 7) =       0.000555242842

      target function =      -0.746229800750
              le_mean =     -22.813824059229
             les_mean =     520.919497905182
             stat err =       0.000547059424
             autocorr =       1.373126512785
   target nu stat err =       0.000547059424
   target dn stat err =       0.002693560837
      target stat err =       0.002309318764
              std dev =       0.660228435369
             le_variance =       0.435901586870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435882892204
                                         uncertainty =       0.001817241349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466852004
  error estimate for blocks of size 2^( 2) =       0.000492342843
  error estimate for blocks of size 2^( 3) =       0.000516768340
  error estimate for blocks of size 2^( 4) =       0.000534691637
  error estimate for blocks of size 2^( 5) =       0.000545784662
  error estimate for blocks of size 2^( 6) =       0.000552518553
  error estimate for blocks of size 2^( 7) =       0.000555242842

      target function =      -0.746229800750
              le_mean =     -22.813824059229
             les_mean =     520.919497905182
             stat err =       0.000547059424
             autocorr =       1.373126512780
   target nu stat err =       0.000547059424
   target dn stat err =       0.002693560837
      target stat err =       0.002309318764
              std dev =       0.660228435369
             le_variance =       0.435901586870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746229800750        initial
     3.4694e+09     3.4694e+10             1.1121e-13        -0.746229800750  <--
     1.3878e+10     1.3878e+11             2.7804e-14        -0.746229800750
     5.5511e+10     5.5511e+11             6.9361e-15        -0.746229800750

*****************************************************************************
Applying the update for shift_i =   3.4694e+09     and shift_s =   3.4694e+10
*****************************************************************************

  Execution time = 4.2531e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2523e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7712
    reference variance = 0.35761
====================================================
  Execution time = 2.5569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5092e-01
  Total weights = 1.964631440e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436373193329
                                         uncertainty =       0.002040703509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436373193329
                                         uncertainty =       0.002040703509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467118509
  error estimate for blocks of size 2^( 2) =       0.000492710825
  error estimate for blocks of size 2^( 3) =       0.000516822410
  error estimate for blocks of size 2^( 4) =       0.000534110704
  error estimate for blocks of size 2^( 5) =       0.000544569924
  error estimate for blocks of size 2^( 6) =       0.000552199720
  error estimate for blocks of size 2^( 7) =       0.000555786141

      target function =      -0.744587380359
              le_mean =     -22.814291019639
             les_mean =     520.942792746459
             stat err =       0.000546666622
             autocorr =       1.369591226461
   target nu stat err =       0.000546666622
   target dn stat err =       0.003117381363
      target stat err =       0.002639617123
              std dev =       0.660605330028
             le_variance =       0.436399402061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429101964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744595732329       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744595732329       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744595732329       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744595726974       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744596216252       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744595703145       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744597932522       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744595666506       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744594868918       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744598206437       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744595419658       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+08 is 4.015638e-13

solving harmonic davidson linear method for identity shift 3.4694e+09, overlap shift 3.4694e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744595732329       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744595732329       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744595732329       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744595890781       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744596395453       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744593711002       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744595732329       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744600903893       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744595732329       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744595053664       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744598439346       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+09 is 1.004648e-13

solving harmonic davidson linear method for identity shift 1.3878e+10, overlap shift 1.3878e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744595732329       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744595732329       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744595732329       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744595732329       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744595732329       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744595732329       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744587494456       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744595732329       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744560224752       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744626200358       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744575114296       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744617892515       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744618013695       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744619658071       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744591868335       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744591409220       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744579579301       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744561229289       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744628236549       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744566292961       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744567201280       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744593124917       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744573615157       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744585166463       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744600169009       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744606070752       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744623879045       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744594308082       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744609396271       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744590404708       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744603968266       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744580727675       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744608602502       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+10 is 2.498432e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.811152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0088e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7864
    reference variance = 0.356184
====================================================
  Execution time = 2.6968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4484e-01
  Total weights = 1.9647e+06
  Execution time = 3.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465181023
  error estimate for blocks of size 2^( 2) =       0.000491034559
  error estimate for blocks of size 2^( 3) =       0.000515025144
  error estimate for blocks of size 2^( 4) =       0.000533329277
  error estimate for blocks of size 2^( 5) =       0.000545342756
  error estimate for blocks of size 2^( 6) =       0.000552741746
  error estimate for blocks of size 2^( 7) =       0.000556689225

      target function =      -0.749624045941
              le_mean =     -22.813968913725
             les_mean =     520.922022278409
             stat err =       0.000547025751
             autocorr =       1.382838819165
   target nu stat err =       0.000547025751
   target dn stat err =       0.003038977945
      target stat err =       0.002609617308
              std dev =       0.657865311965
             le_variance =       0.432786768687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465181023
  error estimate for blocks of size 2^( 2) =       0.000491034559
  error estimate for blocks of size 2^( 3) =       0.000515025144
  error estimate for blocks of size 2^( 4) =       0.000533329277
  error estimate for blocks of size 2^( 5) =       0.000545342756
  error estimate for blocks of size 2^( 6) =       0.000552741746
  error estimate for blocks of size 2^( 7) =       0.000556689225

      target function =      -0.749624045941
              le_mean =     -22.813968913725
             les_mean =     520.922022278409
             stat err =       0.000547025751
             autocorr =       1.382838819164
   target nu stat err =       0.000547025751
   target dn stat err =       0.003038977945
      target stat err =       0.002609617309
              std dev =       0.657865311965
             le_variance =       0.432786768687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465181023
  error estimate for blocks of size 2^( 2) =       0.000491034559
  error estimate for blocks of size 2^( 3) =       0.000515025144
  error estimate for blocks of size 2^( 4) =       0.000533329277
  error estimate for blocks of size 2^( 5) =       0.000545342756
  error estimate for blocks of size 2^( 6) =       0.000552741746
  error estimate for blocks of size 2^( 7) =       0.000556689225

      target function =      -0.749624045941
              le_mean =     -22.813968913725
             les_mean =     520.922022278409
             stat err =       0.000547025751
             autocorr =       1.382838819159
   target nu stat err =       0.000547025751
   target dn stat err =       0.003038977945
      target stat err =       0.002609617309
              std dev =       0.657865311965
             le_variance =       0.432786768687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432699245293
                                         uncertainty =       0.001827187492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465181023
  error estimate for blocks of size 2^( 2) =       0.000491034559
  error estimate for blocks of size 2^( 3) =       0.000515025144
  error estimate for blocks of size 2^( 4) =       0.000533329277
  error estimate for blocks of size 2^( 5) =       0.000545342756
  error estimate for blocks of size 2^( 6) =       0.000552741746
  error estimate for blocks of size 2^( 7) =       0.000556689225

      target function =      -0.749624045941
              le_mean =     -22.813968913725
             les_mean =     520.922022278409
             stat err =       0.000547025751
             autocorr =       1.382838819165
   target nu stat err =       0.000547025751
   target dn stat err =       0.003038977945
      target stat err =       0.002609617308
              std dev =       0.657865311965
             le_variance =       0.432786768687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749624045941        initial  <--
     8.6736e+08     8.6736e+09             4.0156e-13        -0.749624045941
     3.4694e+09     3.4694e+10             1.0046e-13        -0.749624045941
     1.3878e+10     1.3878e+11             2.4984e-14        -0.749624045941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5221
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4615e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.8613
    reference variance = 0.536328
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4706e-01
  Total weights = 1.964756424e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434183082427
                                         uncertainty =       0.001693915056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434183082427
                                         uncertainty =       0.001693915056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465933239
  error estimate for blocks of size 2^( 2) =       0.000491736149
  error estimate for blocks of size 2^( 3) =       0.000516106689
  error estimate for blocks of size 2^( 4) =       0.000534915139
  error estimate for blocks of size 2^( 5) =       0.000547637732
  error estimate for blocks of size 2^( 6) =       0.000552868849
  error estimate for blocks of size 2^( 7) =       0.000557039018

      target function =      -0.747790912091
              le_mean =     -22.814987485972
             les_mean =     520.970710899328
             stat err =       0.000548115184
             autocorr =       1.383873141925
   target nu stat err =       0.000548115184
   target dn stat err =       0.002454890324
      target stat err =       0.002131972272
              std dev =       0.658929105310
             le_variance =       0.434187565824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281498748597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+09, overlap shift 8.6736e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747796005066       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747796005066       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747796005066       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747796005066       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747796005017       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747796005134       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747796087501       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747805252949       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747797044365       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747778281381       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747797571588       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+09 is 2.818053e-14

solving harmonic davidson linear method for identity shift 3.4694e+10, overlap shift 3.4694e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747796005066       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747796005066       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747796005066       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747796005066       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747796004996       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747812783645       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747799442956       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747809613709       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747832552128       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747732890132       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747823689359       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747813994880       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747836268390       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747712080045       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747865304791       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747787655100       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747817542993       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747783830449       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747794939609       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747789239104       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747798912482       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747813885087       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747804956596       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747790360320       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747828605119       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747812270962       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747758431940       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747841512206       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747744195767       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747784517562       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747816153298       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747804683026       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747769143170       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747805333039       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747798172928       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747787351004       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747777006798       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747815232935       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747784016042       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747750906764       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747785231234       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747847159826       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747819748385       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747731980920       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747834757488       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747837641463       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747747296154       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747802254113       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747873414752       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747748385018       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747783103290       residual = 2.81e-07           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747794530209       residual = 3.95e-07           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747806450908       residual = 8.40e-07           smallest_sin_value = 9.95e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+10 is 6.969643e-15

solving harmonic davidson linear method for identity shift 1.3878e+11, overlap shift 1.3878e+12 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747796005066       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747796005066       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747796005066       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747796005066       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747796005137       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747838843270       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747800779988       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747428701139       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747775234670       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747652081266       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747744101999       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747840711112       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748131443669       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747609847025       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747842834807       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747754157317       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747796490622       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747791191948       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747718815089       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747739802971       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747812611832       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747724020204       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747797793748       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747710403522       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747785609343       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747852238647       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747776599101       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747725616142       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747773161653       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747741349011       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747795856799       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747802173957       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747802597061       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747761327315       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747829988691       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747831431727       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747789752701       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747681494750       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747755335755       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747828257955       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747866284908       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747884767368       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747697918021       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747848649145       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747815817334       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747734926148       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747818549707       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747742216215       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747932336806       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747635890646       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747890830413       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747714012428       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747982597512       residual = 4.55e-06           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747676508709       residual = 2.64e-06           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+11 is 1.752026e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.931277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9939e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6976
    reference variance = 0.329457
====================================================
  Execution time = 2.4672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4991e-01
  Total weights = 1.9648e+06
  Execution time = 3.5098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467674904
  error estimate for blocks of size 2^( 2) =       0.000493544785
  error estimate for blocks of size 2^( 3) =       0.000518161239
  error estimate for blocks of size 2^( 4) =       0.000536124712
  error estimate for blocks of size 2^( 5) =       0.000548252513
  error estimate for blocks of size 2^( 6) =       0.000555608575
  error estimate for blocks of size 2^( 7) =       0.000559193973

      target function =      -0.745422391379
              le_mean =     -22.814532262195
             les_mean =     520.952790053614
             stat err =       0.000549794943
             autocorr =       1.382016888200
   target nu stat err =       0.000549794943
   target dn stat err =       0.002987803790
      target stat err =       0.002543049441
              std dev =       0.661392192492
             le_variance =       0.437439632290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467674904
  error estimate for blocks of size 2^( 2) =       0.000493544785
  error estimate for blocks of size 2^( 3) =       0.000518161239
  error estimate for blocks of size 2^( 4) =       0.000536124712
  error estimate for blocks of size 2^( 5) =       0.000548252513
  error estimate for blocks of size 2^( 6) =       0.000555608575
  error estimate for blocks of size 2^( 7) =       0.000559193973

      target function =      -0.745422391379
              le_mean =     -22.814532262195
             les_mean =     520.952790053613
             stat err =       0.000549794943
             autocorr =       1.382016888204
   target nu stat err =       0.000549794943
   target dn stat err =       0.002987803790
      target stat err =       0.002543049441
              std dev =       0.661392192492
             le_variance =       0.437439632290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467674904
  error estimate for blocks of size 2^( 2) =       0.000493544785
  error estimate for blocks of size 2^( 3) =       0.000518161239
  error estimate for blocks of size 2^( 4) =       0.000536124712
  error estimate for blocks of size 2^( 5) =       0.000548252513
  error estimate for blocks of size 2^( 6) =       0.000555608575
  error estimate for blocks of size 2^( 7) =       0.000559193973

      target function =      -0.745422391379
              le_mean =     -22.814532262195
             les_mean =     520.952790053614
             stat err =       0.000549794943
             autocorr =       1.382016888197
   target nu stat err =       0.000549794943
   target dn stat err =       0.002987803790
      target stat err =       0.002543049441
              std dev =       0.661392192492
             le_variance =       0.437439632290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437510480601
                                         uncertainty =       0.002228884988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467674904
  error estimate for blocks of size 2^( 2) =       0.000493544785
  error estimate for blocks of size 2^( 3) =       0.000518161239
  error estimate for blocks of size 2^( 4) =       0.000536124712
  error estimate for blocks of size 2^( 5) =       0.000548252513
  error estimate for blocks of size 2^( 6) =       0.000555608575
  error estimate for blocks of size 2^( 7) =       0.000559193973

      target function =      -0.745422391379
              le_mean =     -22.814532262195
             les_mean =     520.952790053614
             stat err =       0.000549794943
             autocorr =       1.382016888199
   target nu stat err =       0.000549794943
   target dn stat err =       0.002987803790
      target stat err =       0.002543049441
              std dev =       0.661392192492
             le_variance =       0.437439632290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745422391379        initial
     8.6736e+09     8.6736e+10             2.8181e-14        -0.745422391379  <--
     3.4694e+10     3.4694e+11             6.9696e-15        -0.745422391379
     1.3878e+11     1.3878e+12             1.7520e-15        -0.745422391379

*****************************************************************************
Applying the update for shift_i =   8.6736e+09     and shift_s =   8.6736e+10
*****************************************************************************

  Execution time = 4.2264e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.98
    reference variance = 0.452145
====================================================
  Execution time = 2.5317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4470e-01
  Total weights = 1.964584603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433508364402
                                         uncertainty =       0.002128099407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433508364402
                                         uncertainty =       0.002128099407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465561906
  error estimate for blocks of size 2^( 2) =       0.000491256933
  error estimate for blocks of size 2^( 3) =       0.000515568300
  error estimate for blocks of size 2^( 4) =       0.000534134927
  error estimate for blocks of size 2^( 5) =       0.000545768218
  error estimate for blocks of size 2^( 6) =       0.000553127383
  error estimate for blocks of size 2^( 7) =       0.000554019430

      target function =      -0.749742977328
              le_mean =     -22.813811372341
             les_mean =     520.914692641135
             stat err =       0.000546762490
             autocorr =       1.379248591204
   target nu stat err =       0.000546762490
   target dn stat err =       0.002553628772
      target stat err =       0.002217651454
              std dev =       0.658403961961
             le_variance =       0.433495777127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281381137234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+09, overlap shift 2.1684e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749748559588       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749748559588       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749748559588       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749748559588       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749748559588       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749748559588       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749745795823       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749748559588       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749748559588       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749748559588       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+09 is 1.714111e-13

solving harmonic davidson linear method for identity shift 8.6736e+09, overlap shift 8.6736e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749748559588       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749748559588       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749748559588       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749748559588       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749748559588       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749748559588       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749750714439       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749742965051       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749748559588       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749747671831       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749755861350       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749757142310       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749743010470       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749771924910       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749746275920       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749772939282       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749743579918       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749742097155       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749760857578       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749743716679       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+09 is 4.274415e-14

solving harmonic davidson linear method for identity shift 3.4694e+10, overlap shift 3.4694e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749748559588       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749748559588       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749748559588       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749748559588       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749748559588       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749748559588       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749748559588       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749748559588       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749811433319       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749776186746       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749745096419       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749712964072       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749697883357       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749788966920       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749703704861       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749686248775       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749788714172       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749734853193       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749831699788       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749657466741       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749799667015       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749761409241       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749726935554       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749719660930       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749736088749       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749781113415       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749706795538       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749737405210       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749788165088       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749763747587       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749732468958       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749741920253       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749744301591       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749739077014       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.749749643534       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749756751354       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749752688008       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749727337208       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749753159624       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.749739106150       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749765528008       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749759701937       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749753767464       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749757232990       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749752280524       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749747510151       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749754224522       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749746094683       residual = 5.63e-07           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.749750467086       residual = 3.81e-07           smallest_sin_value = 9.93e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+10 is 1.068156e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.982649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9904e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8427
    reference variance = 0.544986
====================================================
  Execution time = 2.6562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4998e-01
  Total weights = 1.9650e+06
  Execution time = 3.5168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467572792
  error estimate for blocks of size 2^( 2) =       0.000493499950
  error estimate for blocks of size 2^( 3) =       0.000517574139
  error estimate for blocks of size 2^( 4) =       0.000535372906
  error estimate for blocks of size 2^( 5) =       0.000545722611
  error estimate for blocks of size 2^( 6) =       0.000552342279
  error estimate for blocks of size 2^( 7) =       0.000554117687

      target function =      -0.745361283304
              le_mean =     -22.814492243382
             les_mean =     520.951034767423
             stat err =       0.000546888871
             autocorr =       1.368042872675
   target nu stat err =       0.000546888871
   target dn stat err =       0.003431907565
      target stat err =       0.002899364773
              std dev =       0.661247783550
             le_variance =       0.437248631250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467572792
  error estimate for blocks of size 2^( 2) =       0.000493499950
  error estimate for blocks of size 2^( 3) =       0.000517574139
  error estimate for blocks of size 2^( 4) =       0.000535372906
  error estimate for blocks of size 2^( 5) =       0.000545722611
  error estimate for blocks of size 2^( 6) =       0.000552342279
  error estimate for blocks of size 2^( 7) =       0.000554117687

      target function =      -0.745361283304
              le_mean =     -22.814492243382
             les_mean =     520.951034767423
             stat err =       0.000546888871
             autocorr =       1.368042872672
   target nu stat err =       0.000546888871
   target dn stat err =       0.003431907565
      target stat err =       0.002899364773
              std dev =       0.661247783550
             le_variance =       0.437248631250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467572792
  error estimate for blocks of size 2^( 2) =       0.000493499950
  error estimate for blocks of size 2^( 3) =       0.000517574139
  error estimate for blocks of size 2^( 4) =       0.000535372906
  error estimate for blocks of size 2^( 5) =       0.000545722611
  error estimate for blocks of size 2^( 6) =       0.000552342279
  error estimate for blocks of size 2^( 7) =       0.000554117687

      target function =      -0.745361283304
              le_mean =     -22.814492243382
             les_mean =     520.951034767423
             stat err =       0.000546888871
             autocorr =       1.368042872673
   target nu stat err =       0.000546888871
   target dn stat err =       0.003431907565
      target stat err =       0.002899364773
              std dev =       0.661247783550
             le_variance =       0.437248631250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437292979872
                                         uncertainty =       0.002465760477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467572792
  error estimate for blocks of size 2^( 2) =       0.000493499950
  error estimate for blocks of size 2^( 3) =       0.000517574139
  error estimate for blocks of size 2^( 4) =       0.000535372906
  error estimate for blocks of size 2^( 5) =       0.000545722611
  error estimate for blocks of size 2^( 6) =       0.000552342279
  error estimate for blocks of size 2^( 7) =       0.000554117687

      target function =      -0.745361283304
              le_mean =     -22.814492243382
             les_mean =     520.951034767423
             stat err =       0.000546888871
             autocorr =       1.368042872678
   target nu stat err =       0.000546888871
   target dn stat err =       0.003431907565
      target stat err =       0.002899364773
              std dev =       0.661247783550
             le_variance =       0.437248631250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745361283304        initial
     2.1684e+09     2.1684e+10             1.7141e-13        -0.745361283304  <--
     8.6736e+09     8.6736e+10             4.2744e-14        -0.745361283304
     3.4694e+10     3.4694e+11             1.0682e-14        -0.745361283304

*****************************************************************************
Applying the update for shift_i =   2.1684e+09     and shift_s =   2.1684e+10
*****************************************************************************

  Execution time = 4.4179e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4109e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.843
    reference variance = 0.393315
====================================================
  Execution time = 2.5412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5983e-01
  Total weights = 1.964553179e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443804110050
                                         uncertainty =       0.008859376443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443804110050
                                         uncertainty =       0.008859376443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471043352
  error estimate for blocks of size 2^( 2) =       0.000496578451
  error estimate for blocks of size 2^( 3) =       0.000520225194
  error estimate for blocks of size 2^( 4) =       0.000539159709
  error estimate for blocks of size 2^( 5) =       0.000550112217
  error estimate for blocks of size 2^( 6) =       0.000556900614
  error estimate for blocks of size 2^( 7) =       0.000560646537

      target function =      -0.737163386017
              le_mean =     -22.814636130059
             les_mean =     520.967447674022
             stat err =       0.000551704769
             autocorr =       1.371802907590
   target nu stat err =       0.000551704769
   target dn stat err =       0.013487094380
      target stat err =       0.010919996609
              std dev =       0.666155896476
             le_variance =       0.443763678409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281463613006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737322361736       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737322361736       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737322361736       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737322116255       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737322340306       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737322133026       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737323581503       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737322361736       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737322361736       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737321609209       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+08 is 6.007575e-13

solving harmonic davidson linear method for identity shift 2.1684e+09, overlap shift 2.1684e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737322361736       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737322361736       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737322361736       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737322447877       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737322361736       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737322361736       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737324481183       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737320901715       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737321935087       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737324724115       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+09 is 1.502117e-13

solving harmonic davidson linear method for identity shift 8.6736e+09, overlap shift 8.6736e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737322361736       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737322361736       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737322361736       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737322361736       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737325042378       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737320858222       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737321316096       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737317730056       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737327278759       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737309508759       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737332467741       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737328537322       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+09 is 3.751578e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.986612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9944e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8676
    reference variance = 0.427996
====================================================
  Execution time = 2.4747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4539e-01
  Total weights = 1.9646e+06
  Execution time = 3.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465377610
  error estimate for blocks of size 2^( 2) =       0.000491169355
  error estimate for blocks of size 2^( 3) =       0.000516499143
  error estimate for blocks of size 2^( 4) =       0.000535015807
  error estimate for blocks of size 2^( 5) =       0.000546808268
  error estimate for blocks of size 2^( 6) =       0.000554681079
  error estimate for blocks of size 2^( 7) =       0.000557794167

      target function =      -0.749172060434
              le_mean =     -22.814004076072
             les_mean =     520.924171243319
             stat err =       0.000548574830
             autocorr =       1.389507147068
   target nu stat err =       0.000548574830
   target dn stat err =       0.002629863287
      target stat err =       0.002276778230
              std dev =       0.658143327591
             le_variance =       0.433152639652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465377610
  error estimate for blocks of size 2^( 2) =       0.000491169355
  error estimate for blocks of size 2^( 3) =       0.000516499143
  error estimate for blocks of size 2^( 4) =       0.000535015807
  error estimate for blocks of size 2^( 5) =       0.000546808268
  error estimate for blocks of size 2^( 6) =       0.000554681079
  error estimate for blocks of size 2^( 7) =       0.000557794167

      target function =      -0.749172060436
              le_mean =     -22.814004076072
             les_mean =     520.924171243317
             stat err =       0.000548574830
             autocorr =       1.389507147069
   target nu stat err =       0.000548574830
   target dn stat err =       0.002629863287
      target stat err =       0.002276778230
              std dev =       0.658143327591
             le_variance =       0.433152639652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465377610
  error estimate for blocks of size 2^( 2) =       0.000491169355
  error estimate for blocks of size 2^( 3) =       0.000516499143
  error estimate for blocks of size 2^( 4) =       0.000535015807
  error estimate for blocks of size 2^( 5) =       0.000546808268
  error estimate for blocks of size 2^( 6) =       0.000554681079
  error estimate for blocks of size 2^( 7) =       0.000557794167

      target function =      -0.749172060435
              le_mean =     -22.814004076072
             les_mean =     520.924171243318
             stat err =       0.000548574830
             autocorr =       1.389507147069
   target nu stat err =       0.000548574830
   target dn stat err =       0.002629863287
      target stat err =       0.002276778230
              std dev =       0.658143327591
             le_variance =       0.433152639652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433093587347
                                         uncertainty =       0.002262168840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465377610
  error estimate for blocks of size 2^( 2) =       0.000491169355
  error estimate for blocks of size 2^( 3) =       0.000516499143
  error estimate for blocks of size 2^( 4) =       0.000535015807
  error estimate for blocks of size 2^( 5) =       0.000546808268
  error estimate for blocks of size 2^( 6) =       0.000554681079
  error estimate for blocks of size 2^( 7) =       0.000557794167

      target function =      -0.749172060434
              le_mean =     -22.814004076072
             les_mean =     520.924171243319
             stat err =       0.000548574830
             autocorr =       1.389507147072
   target nu stat err =       0.000548574830
   target dn stat err =       0.002629863287
      target stat err =       0.002276778230
              std dev =       0.658143327591
             le_variance =       0.433152639652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749172060434        initial
     5.4210e+08     5.4210e+09             6.0076e-13        -0.749172060436  <--
     2.1684e+09     2.1684e+10             1.5021e-13        -0.749172060435
     8.6736e+09     8.6736e+10             3.7516e-14        -0.749172060434

*****************************************************************************
Applying the update for shift_i =   5.4210e+08     and shift_s =   5.4210e+09
*****************************************************************************

  Execution time = 4.2286e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.806
    reference variance = 0.325541
====================================================
  Execution time = 2.5332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4955e-01
  Total weights = 1.964572937e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437225293813
                                         uncertainty =       0.001957155251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437225293813
                                         uncertainty =       0.001957155251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467565559
  error estimate for blocks of size 2^( 2) =       0.000493147878
  error estimate for blocks of size 2^( 3) =       0.000517675714
  error estimate for blocks of size 2^( 4) =       0.000535285976
  error estimate for blocks of size 2^( 5) =       0.000548063644
  error estimate for blocks of size 2^( 6) =       0.000555060524
  error estimate for blocks of size 2^( 7) =       0.000559895358

      target function =      -0.745721395758
              le_mean =     -22.814731458594
             les_mean =     520.961519629802
             stat err =       0.000549576375
             autocorr =       1.381564243163
   target nu stat err =       0.000549576375
   target dn stat err =       0.002789478215
      target stat err =       0.002386757477
              std dev =       0.661237554370
             le_variance =       0.437235103309


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281473145859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745727971673       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745727971673       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745727971673       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745727971673       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745727971673       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745727971673       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745727971673       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745727971673       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745727971673       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745727971673       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+08 is 1.673618e-12

solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745727971673       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745727971673       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745727971673       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745727971673       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745727971673       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745727971673       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745727971673       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745727971673       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745727268369       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745727971673       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+08 is 4.183603e-13

solving harmonic davidson linear method for identity shift 2.1684e+09, overlap shift 2.1684e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745727971673       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745727971673       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745727971673       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745727971789       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745727971673       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745727971673       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745727971673       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745727971673       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745727971673       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745727971673       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+09 is 1.045090e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.990116 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9879e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7445
    reference variance = 0.351175
====================================================
  Execution time = 2.6849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4716e-01
  Total weights = 1.9647e+06
  Execution time = 3.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165333
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165333
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466579752
  error estimate for blocks of size 2^( 2) =       0.000492159516
  error estimate for blocks of size 2^( 3) =       0.000516427802
  error estimate for blocks of size 2^( 4) =       0.000535056037
  error estimate for blocks of size 2^( 5) =       0.000546804552
  error estimate for blocks of size 2^( 6) =       0.000554837375
  error estimate for blocks of size 2^( 7) =       0.000560548057

      target function =      -0.747705142418
              le_mean =     -22.815038982271
             les_mean =     520.973162496304
             stat err =       0.000549311505
             autocorr =       1.386071439136
   target nu stat err =       0.000549311505
   target dn stat err =       0.002724182997
      target stat err =       0.002347584771
              std dev =       0.659843413412
             le_variance =       0.435393330224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165332
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165332
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466579752
  error estimate for blocks of size 2^( 2) =       0.000492159516
  error estimate for blocks of size 2^( 3) =       0.000516427802
  error estimate for blocks of size 2^( 4) =       0.000535056037
  error estimate for blocks of size 2^( 5) =       0.000546804552
  error estimate for blocks of size 2^( 6) =       0.000554837375
  error estimate for blocks of size 2^( 7) =       0.000560548057

      target function =      -0.747705142421
              le_mean =     -22.815038982271
             les_mean =     520.973162496302
             stat err =       0.000549311505
             autocorr =       1.386071439137
   target nu stat err =       0.000549311505
   target dn stat err =       0.002724182997
      target stat err =       0.002347584771
              std dev =       0.659843413412
             le_variance =       0.435393330224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165333
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165333
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466579752
  error estimate for blocks of size 2^( 2) =       0.000492159516
  error estimate for blocks of size 2^( 3) =       0.000516427802
  error estimate for blocks of size 2^( 4) =       0.000535056037
  error estimate for blocks of size 2^( 5) =       0.000546804552
  error estimate for blocks of size 2^( 6) =       0.000554837375
  error estimate for blocks of size 2^( 7) =       0.000560548057

      target function =      -0.747705142420
              le_mean =     -22.815038982271
             les_mean =     520.973162496303
             stat err =       0.000549311505
             autocorr =       1.386071439137
   target nu stat err =       0.000549311505
   target dn stat err =       0.002724182997
      target stat err =       0.002347584771
              std dev =       0.659843413412
             le_variance =       0.435393330223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165333
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435434165333
                                         uncertainty =       0.001948785768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466579752
  error estimate for blocks of size 2^( 2) =       0.000492159516
  error estimate for blocks of size 2^( 3) =       0.000516427802
  error estimate for blocks of size 2^( 4) =       0.000535056037
  error estimate for blocks of size 2^( 5) =       0.000546804552
  error estimate for blocks of size 2^( 6) =       0.000554837375
  error estimate for blocks of size 2^( 7) =       0.000560548057

      target function =      -0.747705142419
              le_mean =     -22.815038982271
             les_mean =     520.973162496304
             stat err =       0.000549311505
             autocorr =       1.386071439141
   target nu stat err =       0.000549311505
   target dn stat err =       0.002724182997
      target stat err =       0.002347584771
              std dev =       0.659843413412
             le_variance =       0.435393330224


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747705142418        initial
     1.3553e+08     1.3553e+09             1.6736e-12        -0.747705142421  <--
     5.4210e+08     5.4210e+09             4.1836e-13        -0.747705142420
     2.1684e+09     2.1684e+10             1.0451e-13        -0.747705142419

*****************************************************************************
Applying the update for shift_i =   1.3553e+08     and shift_s =   1.3553e+09
*****************************************************************************

  Execution time = 4.4535e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7736
    reference variance = 0.226647
====================================================
  Execution time = 2.5283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4808e-01
  Total weights = 1.964940319e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435531034591
                                         uncertainty =       0.001822287573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435531034591
                                         uncertainty =       0.001822287573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466625572
  error estimate for blocks of size 2^( 2) =       0.000492498298
  error estimate for blocks of size 2^( 3) =       0.000516188308
  error estimate for blocks of size 2^( 4) =       0.000534168374
  error estimate for blocks of size 2^( 5) =       0.000546428310
  error estimate for blocks of size 2^( 6) =       0.000553917907
  error estimate for blocks of size 2^( 7) =       0.000556723420

      target function =      -0.746933872176
              le_mean =     -22.814085587575
             les_mean =     520.930578242268
             stat err =       0.000547809503
             autocorr =       1.378231123473
   target nu stat err =       0.000547809503
   target dn stat err =       0.003339200680
      target stat err =       0.002834671354
              std dev =       0.659908212170
             le_variance =       0.435478848490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281408558757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746943502046       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746943502047       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746943502047       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746943502047       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746943502050       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746943519280       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746943592720       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746943566401       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746943503442       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746943512410       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+07 is 6.774257e-12

solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746943502046       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746943502046       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746943502046       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746943502046       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746943605878       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746943502832       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746943437994       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746943360839       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746943447491       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746943744396       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+08 is 1.693466e-12

solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746943502046       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746943502046       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746943502046       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746943502046       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746943502649       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746943510588       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746943580489       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746945539339       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746942766834       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746943239254       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+08 is 4.233887e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.993625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9805e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8402
    reference variance = 0.427467
====================================================
  Execution time = 2.5037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4636e-01
  Total weights = 1.9646e+06
  Execution time = 3.5129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167822
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167822
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466834621
  error estimate for blocks of size 2^( 2) =       0.000492443176
  error estimate for blocks of size 2^( 3) =       0.000516685769
  error estimate for blocks of size 2^( 4) =       0.000534768576
  error estimate for blocks of size 2^( 5) =       0.000546141182
  error estimate for blocks of size 2^( 6) =       0.000551514062
  error estimate for blocks of size 2^( 7) =       0.000555656067

      target function =      -0.748369118874
              le_mean =     -22.815137867445
             les_mean =     520.976878462023
             stat err =       0.000547019972
             autocorr =       1.373030717331
   target nu stat err =       0.000547019972
   target dn stat err =       0.002665028333
      target stat err =       0.002303703852
              std dev =       0.660203852017
             le_variance =       0.435869126218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167821
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167821
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466834621
  error estimate for blocks of size 2^( 2) =       0.000492443176
  error estimate for blocks of size 2^( 3) =       0.000516685769
  error estimate for blocks of size 2^( 4) =       0.000534768576
  error estimate for blocks of size 2^( 5) =       0.000546141182
  error estimate for blocks of size 2^( 6) =       0.000551514062
  error estimate for blocks of size 2^( 7) =       0.000555656067

      target function =      -0.748369136923
              le_mean =     -22.815137867445
             les_mean =     520.976878440373
             stat err =       0.000547019972
             autocorr =       1.373030717323
   target nu stat err =       0.000547019972
   target dn stat err =       0.002665027898
      target stat err =       0.002303703608
              std dev =       0.660203852017
             le_variance =       0.435869126218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167821
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167821
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466834621
  error estimate for blocks of size 2^( 2) =       0.000492443176
  error estimate for blocks of size 2^( 3) =       0.000516685769
  error estimate for blocks of size 2^( 4) =       0.000534768576
  error estimate for blocks of size 2^( 5) =       0.000546141182
  error estimate for blocks of size 2^( 6) =       0.000551514062
  error estimate for blocks of size 2^( 7) =       0.000555656067

      target function =      -0.748369127900
              le_mean =     -22.815137867445
             les_mean =     520.976878451196
             stat err =       0.000547019972
             autocorr =       1.373030717327
   target nu stat err =       0.000547019972
   target dn stat err =       0.002665028115
      target stat err =       0.002303703730
              std dev =       0.660203852017
             le_variance =       0.435869126218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167822
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435801167822
                                         uncertainty =       0.002285816480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466834621
  error estimate for blocks of size 2^( 2) =       0.000492443176
  error estimate for blocks of size 2^( 3) =       0.000516685769
  error estimate for blocks of size 2^( 4) =       0.000534768576
  error estimate for blocks of size 2^( 5) =       0.000546141182
  error estimate for blocks of size 2^( 6) =       0.000551514062
  error estimate for blocks of size 2^( 7) =       0.000555656067

      target function =      -0.748369120006
              le_mean =     -22.815137867445
             les_mean =     520.976878460664
             stat err =       0.000547019972
             autocorr =       1.373030717329
   target nu stat err =       0.000547019972
   target dn stat err =       0.002665028306
      target stat err =       0.002303703836
              std dev =       0.660203852017
             le_variance =       0.435869126218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748369118874        initial
     3.3881e+07     3.3881e+08             6.7743e-12        -0.748369136923  <--
     1.3553e+08     1.3553e+09             1.6935e-12        -0.748369127900
     5.4210e+08     5.4210e+09             4.2339e-13        -0.748369120006

*****************************************************************************
Applying the update for shift_i =   3.3881e+07     and shift_s =   3.3881e+08
*****************************************************************************

  Execution time = 4.2618e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7795
    reference variance = 0.565597
====================================================
  Execution time = 2.5343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4600e-01
  Total weights = 1.965104549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435192052254
                                         uncertainty =       0.002444348737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435192052254
                                         uncertainty =       0.002444348737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466450792
  error estimate for blocks of size 2^( 2) =       0.000492234344
  error estimate for blocks of size 2^( 3) =       0.000516212732
  error estimate for blocks of size 2^( 4) =       0.000534436078
  error estimate for blocks of size 2^( 5) =       0.000545536726
  error estimate for blocks of size 2^( 6) =       0.000551564593
  error estimate for blocks of size 2^( 7) =       0.000553294473

      target function =      -0.748667158094
              le_mean =     -22.814197871188
             les_mean =     520.933621416962
             stat err =       0.000546207967
             autocorr =       1.371211322648
   target nu stat err =       0.000546207967
   target dn stat err =       0.002656646380
      target stat err =       0.002295279997
              std dev =       0.659661036917
             le_variance =       0.435152683627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281419787119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748673179012       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748673179015       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748673179015       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748673179015       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748673169093       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748673170547       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748673171921       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748673164841       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748673174596       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+06 is 3.608918e-11

solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748673179012       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748673179013       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748673179013       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748673147840       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748673179013       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748673178830       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748673061796       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748673185250       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748673148931       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+07 is 9.022335e-12

solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748673179012       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748673179012       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748673179012       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748673192986       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748673192022       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748673177517       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748673109642       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748673198897       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748673335924       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+08 is 2.255500e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.996703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9844e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667368e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.771
    reference variance = 0.636605
====================================================
  Execution time = 2.6839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4832e-01
  Total weights = 1.9646e+06
  Execution time = 3.5187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121912
                                         uncertainty =       0.002175282292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121912
                                         uncertainty =       0.002175282292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466565905
  error estimate for blocks of size 2^( 2) =       0.000492510835
  error estimate for blocks of size 2^( 3) =       0.000516638515
  error estimate for blocks of size 2^( 4) =       0.000535695895
  error estimate for blocks of size 2^( 5) =       0.000547161156
  error estimate for blocks of size 2^( 6) =       0.000552847945
  error estimate for blocks of size 2^( 7) =       0.000554896642

      target function =      -0.746738011191
              le_mean =     -22.815297400633
             les_mean =     520.986113530070
             stat err =       0.000547650409
             autocorr =       1.377783043772
   target nu stat err =       0.000547650409
   target dn stat err =       0.003568952568
      target stat err =       0.003024876227
              std dev =       0.659823830586
             le_variance =       0.435367487409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121908
                                         uncertainty =       0.002175282291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121908
                                         uncertainty =       0.002175282291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466565905
  error estimate for blocks of size 2^( 2) =       0.000492510835
  error estimate for blocks of size 2^( 3) =       0.000516638515
  error estimate for blocks of size 2^( 4) =       0.000535695895
  error estimate for blocks of size 2^( 5) =       0.000547161156
  error estimate for blocks of size 2^( 6) =       0.000552847945
  error estimate for blocks of size 2^( 7) =       0.000554896642

      target function =      -0.746738011199
              le_mean =     -22.815297400633
             les_mean =     520.986113530053
             stat err =       0.000547650409
             autocorr =       1.377783043736
   target nu stat err =       0.000547650409
   target dn stat err =       0.003568952565
      target stat err =       0.003024876225
              std dev =       0.659823830583
             le_variance =       0.435367487406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121910
                                         uncertainty =       0.002175282292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121910
                                         uncertainty =       0.002175282292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466565905
  error estimate for blocks of size 2^( 2) =       0.000492510835
  error estimate for blocks of size 2^( 3) =       0.000516638515
  error estimate for blocks of size 2^( 4) =       0.000535695895
  error estimate for blocks of size 2^( 5) =       0.000547161156
  error estimate for blocks of size 2^( 6) =       0.000552847945
  error estimate for blocks of size 2^( 7) =       0.000554896642

      target function =      -0.746738011195
              le_mean =     -22.815297400633
             les_mean =     520.986113530062
             stat err =       0.000547650409
             autocorr =       1.377783043754
   target nu stat err =       0.000547650409
   target dn stat err =       0.003568952566
      target stat err =       0.003024876226
              std dev =       0.659823830585
             le_variance =       0.435367487407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121912
                                         uncertainty =       0.002175282292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435254121912
                                         uncertainty =       0.002175282292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466565905
  error estimate for blocks of size 2^( 2) =       0.000492510835
  error estimate for blocks of size 2^( 3) =       0.000516638515
  error estimate for blocks of size 2^( 4) =       0.000535695895
  error estimate for blocks of size 2^( 5) =       0.000547161156
  error estimate for blocks of size 2^( 6) =       0.000552847945
  error estimate for blocks of size 2^( 7) =       0.000554896642

      target function =      -0.746738011191
              le_mean =     -22.815297400633
             les_mean =     520.986113530069
             stat err =       0.000547650409
             autocorr =       1.377783043774
   target nu stat err =       0.000547650409
   target dn stat err =       0.003568952567
      target stat err =       0.003024876226
              std dev =       0.659823830586
             le_variance =       0.435367487409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746738011191        initial
     8.4703e+06     8.4703e+07             3.6089e-11        -0.746738011199  <--
     3.3881e+07     3.3881e+08             9.0223e-12        -0.746738011195
     1.3553e+08     1.3553e+09             2.2555e-12        -0.746738011191

*****************************************************************************
Applying the update for shift_i =   8.4703e+06     and shift_s =   8.4703e+07
*****************************************************************************

  Execution time = 4.4451e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199243e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.9006
    reference variance = 1.6096
====================================================
  Execution time = 2.5320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4881e-01
  Total weights = 1.965140248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434775933760
                                         uncertainty =       0.001939624346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434775933760
                                         uncertainty =       0.001939624346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466257714
  error estimate for blocks of size 2^( 2) =       0.000492116943
  error estimate for blocks of size 2^( 3) =       0.000516569823
  error estimate for blocks of size 2^( 4) =       0.000535254761
  error estimate for blocks of size 2^( 5) =       0.000547559072
  error estimate for blocks of size 2^( 6) =       0.000551719204
  error estimate for blocks of size 2^( 7) =       0.000551916040

      target function =      -0.746324733042
              le_mean =     -22.813588438735
             les_mean =     520.908628825107
             stat err =       0.000546612270
             autocorr =       1.374379572872
   target nu stat err =       0.000546612270
   target dn stat err =       0.003003694037
      target stat err =       0.002557386385
              std dev =       0.659387982654
             le_variance =       0.434792511668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281358843874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746332500639       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746332500647       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746332500648       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746332500780       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746332500446       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746332497784       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746332507516       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746332500291       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746332501752       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+06 is 1.081715e-10

solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746332500639       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746332500641       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746332500641       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746332507987       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746332500641       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746332495254       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746332490310       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746332479389       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746332500473       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+06 is 2.704294e-11

solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746332500639       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746332500639       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746332500639       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746332500639       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746332544816       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746332500651       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746332514424       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746332428028       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746332500639       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+07 is 6.760721e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.999771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9846e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.9085
    reference variance = 0.36964
====================================================
  Execution time = 2.4720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5458e-01
  Total weights = 1.9648e+06
  Execution time = 3.5086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056775
                                         uncertainty =       0.002817235445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056775
                                         uncertainty =       0.002817235445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469748740
  error estimate for blocks of size 2^( 2) =       0.000495430035
  error estimate for blocks of size 2^( 3) =       0.000519178137
  error estimate for blocks of size 2^( 4) =       0.000537255575
  error estimate for blocks of size 2^( 5) =       0.000549416105
  error estimate for blocks of size 2^( 6) =       0.000557706290
  error estimate for blocks of size 2^( 7) =       0.000559703384

      target function =      -0.741569648137
              le_mean =     -22.814392494852
             les_mean =     520.951087991179
             stat err =       0.000551020338
             autocorr =       1.375954305077
   target nu stat err =       0.000551020338
   target dn stat err =       0.004453198521
      target stat err =       0.003691535455
              std dev =       0.664325038463
             le_variance =       0.441327756729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056764
                                         uncertainty =       0.002817235451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056764
                                         uncertainty =       0.002817235451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469748740
  error estimate for blocks of size 2^( 2) =       0.000495430035
  error estimate for blocks of size 2^( 3) =       0.000519178137
  error estimate for blocks of size 2^( 4) =       0.000537255575
  error estimate for blocks of size 2^( 5) =       0.000549416105
  error estimate for blocks of size 2^( 6) =       0.000557706290
  error estimate for blocks of size 2^( 7) =       0.000559703384

      target function =      -0.741569648188
              le_mean =     -22.814392494853
             les_mean =     520.951087991147
             stat err =       0.000551020338
             autocorr =       1.375954304967
   target nu stat err =       0.000551020338
   target dn stat err =       0.004453198527
      target stat err =       0.003691535460
              std dev =       0.664325038455
             le_variance =       0.441327756718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056769
                                         uncertainty =       0.002817235448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056769
                                         uncertainty =       0.002817235448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469748740
  error estimate for blocks of size 2^( 2) =       0.000495430035
  error estimate for blocks of size 2^( 3) =       0.000519178137
  error estimate for blocks of size 2^( 4) =       0.000537255575
  error estimate for blocks of size 2^( 5) =       0.000549416105
  error estimate for blocks of size 2^( 6) =       0.000557706290
  error estimate for blocks of size 2^( 7) =       0.000559703384

      target function =      -0.741569648163
              le_mean =     -22.814392494852
             les_mean =     520.951087991163
             stat err =       0.000551020338
             autocorr =       1.375954305028
   target nu stat err =       0.000551020338
   target dn stat err =       0.004453198524
      target stat err =       0.003691535457
              std dev =       0.664325038459
             le_variance =       0.441327756723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056774
                                         uncertainty =       0.002817235446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441319056774
                                         uncertainty =       0.002817235446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469748740
  error estimate for blocks of size 2^( 2) =       0.000495430035
  error estimate for blocks of size 2^( 3) =       0.000519178137
  error estimate for blocks of size 2^( 4) =       0.000537255575
  error estimate for blocks of size 2^( 5) =       0.000549416105
  error estimate for blocks of size 2^( 6) =       0.000557706290
  error estimate for blocks of size 2^( 7) =       0.000559703384

      target function =      -0.741569648140
              le_mean =     -22.814392494852
             les_mean =     520.951087991177
             stat err =       0.000551020338
             autocorr =       1.375954305065
   target nu stat err =       0.000551020338
   target dn stat err =       0.004453198521
      target stat err =       0.003691535455
              std dev =       0.664325038462
             le_variance =       0.441327756728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741569648137        initial
     2.1176e+06     2.1176e+07             1.0817e-10        -0.741569648188  <--
     8.4703e+06     8.4703e+07             2.7043e-11        -0.741569648163
     3.3881e+07     3.3881e+08             6.7607e-12        -0.741569648140

*****************************************************************************
Applying the update for shift_i =   2.1176e+06     and shift_s =   2.1176e+07
*****************************************************************************

  Execution time = 4.2253e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226217e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384282e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204511e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.815
    reference variance = 0.371089
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4693e-01
  Total weights = 1.964528404e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435216125482
                                         uncertainty =       0.001741192434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435216125482
                                         uncertainty =       0.001741192434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466506927
  error estimate for blocks of size 2^( 2) =       0.000492700977
  error estimate for blocks of size 2^( 3) =       0.000517418576
  error estimate for blocks of size 2^( 4) =       0.000535700601
  error estimate for blocks of size 2^( 5) =       0.000547045956
  error estimate for blocks of size 2^( 6) =       0.000555664899
  error estimate for blocks of size 2^( 7) =       0.000561192003

      target function =      -0.747890709744
              le_mean =     -22.813827010925
             les_mean =     520.917630394788
             stat err =       0.000549900865
             autocorr =       1.389481001322
   target nu stat err =       0.000549900865
   target dn stat err =       0.002484112500
      target stat err =       0.002152682807
              std dev =       0.659740422503
             le_variance =       0.435257425084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281382701093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+05, overlap shift 5.2940e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747895940568       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747895940615       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747895940623       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747895940654       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747895940655       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747895940091       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747895940545       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747895941505       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747895939943       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747895939289       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+05 is 7.801323e-10

solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747895940568       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747895940580       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747895940582       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747895940437       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747895940622       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747895940583       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747895942612       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747895937077       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747895941046       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747895942492       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+06 is 1.950330e-10

solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747895940568       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747895940571       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747895940572       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747895940572       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747895940572       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747895966980       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747895944108       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747895933031       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747895923047       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747895958993       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+06 is 4.875820e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.003274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9843e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216181e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720360e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152504e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663954e-04 3 1  ON 50
ci_52                -6.297632e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872695e-04 3 1  ON 57
ci_59                -6.204512e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269880e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7435
    reference variance = 0.361279
====================================================
  Execution time = 2.6658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4818e-01
  Total weights = 1.9644e+06
  Execution time = 3.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131180030
                                         uncertainty =       0.001897976882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131180030
                                         uncertainty =       0.001897976882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465959404
  error estimate for blocks of size 2^( 2) =       0.000491798504
  error estimate for blocks of size 2^( 3) =       0.000515673605
  error estimate for blocks of size 2^( 4) =       0.000533669641
  error estimate for blocks of size 2^( 5) =       0.000545614808
  error estimate for blocks of size 2^( 6) =       0.000550941589
  error estimate for blocks of size 2^( 7) =       0.000554099644

      target function =      -0.746844800790
              le_mean =     -22.813550709588
             les_mean =     520.906271298409
             stat err =       0.000546081420
             autocorr =       1.373468292623
   target nu stat err =       0.000546081420
   target dn stat err =       0.003949282768
      target stat err =       0.003326752724
              std dev =       0.658966109341
             le_variance =       0.434236333260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131179959
                                         uncertainty =       0.001897976879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131179959
                                         uncertainty =       0.001897976879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465959404
  error estimate for blocks of size 2^( 2) =       0.000491798504
  error estimate for blocks of size 2^( 3) =       0.000515673605
  error estimate for blocks of size 2^( 4) =       0.000533669641
  error estimate for blocks of size 2^( 5) =       0.000545614807
  error estimate for blocks of size 2^( 6) =       0.000550941588
  error estimate for blocks of size 2^( 7) =       0.000554099644

      target function =      -0.746844801463
              le_mean =     -22.813550709589
             les_mean =     520.906271297676
             stat err =       0.000546081420
             autocorr =       1.373468292030
   target nu stat err =       0.000546081420
   target dn stat err =       0.003949282646
      target stat err =       0.003326752630
              std dev =       0.658966109287
             le_variance =       0.434236333188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131179995
                                         uncertainty =       0.001897976881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131179995
                                         uncertainty =       0.001897976881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465959404
  error estimate for blocks of size 2^( 2) =       0.000491798504
  error estimate for blocks of size 2^( 3) =       0.000515673605
  error estimate for blocks of size 2^( 4) =       0.000533669641
  error estimate for blocks of size 2^( 5) =       0.000545614808
  error estimate for blocks of size 2^( 6) =       0.000550941588
  error estimate for blocks of size 2^( 7) =       0.000554099644

      target function =      -0.746844801127
              le_mean =     -22.813550709589
             les_mean =     520.906271298042
             stat err =       0.000546081420
             autocorr =       1.373468292320
   target nu stat err =       0.000546081420
   target dn stat err =       0.003949282707
      target stat err =       0.003326752677
              std dev =       0.658966109314
             le_variance =       0.434236333224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131180026
                                         uncertainty =       0.001897976882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434131180026
                                         uncertainty =       0.001897976882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465959404
  error estimate for blocks of size 2^( 2) =       0.000491798504
  error estimate for blocks of size 2^( 3) =       0.000515673605
  error estimate for blocks of size 2^( 4) =       0.000533669641
  error estimate for blocks of size 2^( 5) =       0.000545614808
  error estimate for blocks of size 2^( 6) =       0.000550941589
  error estimate for blocks of size 2^( 7) =       0.000554099644

      target function =      -0.746844800832
              le_mean =     -22.813550709588
             les_mean =     520.906271298363
             stat err =       0.000546081420
             autocorr =       1.373468292589
   target nu stat err =       0.000546081420
   target dn stat err =       0.003949282761
      target stat err =       0.003326752718
              std dev =       0.658966109337
             le_variance =       0.434236333255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746844800790        initial
     5.2940e+05     5.2940e+06             7.8013e-10        -0.746844801463  <--
     2.1176e+06     2.1176e+07             1.9503e-10        -0.746844801127
     8.4703e+06     8.4703e+07             4.8758e-11        -0.746844800832

*****************************************************************************
Applying the update for shift_i =   5.2940e+05     and shift_s =   5.2940e+06
*****************************************************************************

  Execution time = 4.4201e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8557
    reference variance = 0.248286
====================================================
  Execution time = 2.5293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4838e-01
  Total weights = 1.964932531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433294772000
                                         uncertainty =       0.001929740522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433294772000
                                         uncertainty =       0.001929740522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465451449
  error estimate for blocks of size 2^( 2) =       0.000491176139
  error estimate for blocks of size 2^( 3) =       0.000515743844
  error estimate for blocks of size 2^( 4) =       0.000533968959
  error estimate for blocks of size 2^( 5) =       0.000545348874
  error estimate for blocks of size 2^( 6) =       0.000552141140
  error estimate for blocks of size 2^( 7) =       0.000557352508

      target function =      -0.746684320611
              le_mean =     -22.814112678719
             les_mean =     520.932115594550
             stat err =       0.000547202870
             autocorr =       1.382127028639
   target nu stat err =       0.000547202870
   target dn stat err =       0.003318467707
      target stat err =       0.002816012780
              std dev =       0.658247752041
             le_variance =       0.433290103068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281411267872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+05, overlap shift 1.3235e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746693962388       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746693962686       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746693962712       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746693962722       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746693962723       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746693962724       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746693962724       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746693962450       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746693962933       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+05 is 2.553841e-09

solving harmonic davidson linear method for identity shift 5.2940e+05, overlap shift 5.2940e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746693962388       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746693962462       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746693962469       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746693962471       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746693962472       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746693963160       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746693962472       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746693963034       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746693962472       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+05 is 6.384604e-10

solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746693962388       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746693962407       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746693962408       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746693962409       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746693962409       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746693962409       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746693962409       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746693961384       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746693962409       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+06 is 1.596151e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.006327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9785e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732323e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720362e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384284e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199245e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427556e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295205e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663952e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872697e-04 3 1  ON 57
ci_59                -6.204515e-04 3 1  ON 58
ci_60                 1.280254e-04 3 1  ON 59
ci_61                -9.878448e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070704e-04 3 1  ON 64
ci_66                -1.269882e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8038
    reference variance = 0.337953
====================================================
  Execution time = 2.4563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5753e-01
  Total weights = 1.9648e+06
  Execution time = 3.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386364651
                                         uncertainty =       0.005260184286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386364651
                                         uncertainty =       0.005260184286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468702745
  error estimate for blocks of size 2^( 2) =       0.000494597761
  error estimate for blocks of size 2^( 3) =       0.000519293570
  error estimate for blocks of size 2^( 4) =       0.000537947525
  error estimate for blocks of size 2^( 5) =       0.000547835864
  error estimate for blocks of size 2^( 6) =       0.000555469933
  error estimate for blocks of size 2^( 7) =       0.000558045646

      target function =      -0.739135076781
              le_mean =     -22.814265390218
             les_mean =     520.948238651131
             stat err =       0.000549824742
             autocorr =       1.376111312372
   target nu stat err =       0.000549824742
   target dn stat err =       0.007351340252
      target stat err =       0.006001093772
              std dev =       0.662845778080
             le_variance =       0.439364525519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386363918
                                         uncertainty =       0.005260183798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386363918
                                         uncertainty =       0.005260183798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468702744
  error estimate for blocks of size 2^( 2) =       0.000494597761
  error estimate for blocks of size 2^( 3) =       0.000519293570
  error estimate for blocks of size 2^( 4) =       0.000537947524
  error estimate for blocks of size 2^( 5) =       0.000547835863
  error estimate for blocks of size 2^( 6) =       0.000555469932
  error estimate for blocks of size 2^( 7) =       0.000558045645

      target function =      -0.739134966965
              le_mean =     -22.814265390184
             les_mean =     520.948238784596
             stat err =       0.000549824741
             autocorr =       1.376111310666
   target nu stat err =       0.000549824741
   target dn stat err =       0.007351353168
      target stat err =       0.006001102435
              std dev =       0.662845777526
             le_variance =       0.439364524784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386364284
                                         uncertainty =       0.005260184042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386364284
                                         uncertainty =       0.005260184042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468702744
  error estimate for blocks of size 2^( 2) =       0.000494597761
  error estimate for blocks of size 2^( 3) =       0.000519293570
  error estimate for blocks of size 2^( 4) =       0.000537947524
  error estimate for blocks of size 2^( 5) =       0.000547835864
  error estimate for blocks of size 2^( 6) =       0.000555469933
  error estimate for blocks of size 2^( 7) =       0.000558045646

      target function =      -0.739135021892
              le_mean =     -22.814265390201
             les_mean =     520.948238717840
             stat err =       0.000549824742
             autocorr =       1.376111311532
   target nu stat err =       0.000549824742
   target dn stat err =       0.007351346710
      target stat err =       0.006001098104
              std dev =       0.662845777803
             le_variance =       0.439364525151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386364605
                                         uncertainty =       0.005260184255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439386364605
                                         uncertainty =       0.005260184255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468702745
  error estimate for blocks of size 2^( 2) =       0.000494597761
  error estimate for blocks of size 2^( 3) =       0.000519293570
  error estimate for blocks of size 2^( 4) =       0.000537947525
  error estimate for blocks of size 2^( 5) =       0.000547835864
  error estimate for blocks of size 2^( 6) =       0.000555469933
  error estimate for blocks of size 2^( 7) =       0.000558045646

      target function =      -0.739135069922
              le_mean =     -22.814265390216
             les_mean =     520.948238659467
             stat err =       0.000549824742
             autocorr =       1.376111312274
   target nu stat err =       0.000549824742
   target dn stat err =       0.007351341060
      target stat err =       0.006001094314
              std dev =       0.662845778046
             le_variance =       0.439364525473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739135076781        initial  <--
     1.3235e+05     1.3235e+06             2.5538e-09        -0.739134966965
     5.2940e+05     5.2940e+06             6.3846e-10        -0.739135021892
     2.1176e+06     2.1176e+07             1.5962e-10        -0.739135069922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2007
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2086e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7705
    reference variance = 0.287829
====================================================
  Execution time = 2.5232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5709e-01
  Total weights = 1.964556640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441698537357
                                         uncertainty =       0.002812955990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441698537357
                                         uncertainty =       0.002812955990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469908878
  error estimate for blocks of size 2^( 2) =       0.000495903550
  error estimate for blocks of size 2^( 3) =       0.000520279752
  error estimate for blocks of size 2^( 4) =       0.000537974703
  error estimate for blocks of size 2^( 5) =       0.000548520948
  error estimate for blocks of size 2^( 6) =       0.000554954578
  error estimate for blocks of size 2^( 7) =       0.000559466026

      target function =      -0.739526310225
              le_mean =     -22.814417391488
             les_mean =     520.954733162368
             stat err =       0.000550229064
             autocorr =       1.371070392353
   target nu stat err =       0.000550229064
   target dn stat err =       0.004095168278
      target stat err =       0.003384649198
              std dev =       0.664551508474
             le_variance =       0.441628707415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281441739149e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+06, overlap shift 1.3235e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739540743437       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739540743454       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739540743456       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739540743457       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739540742054       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739540743457       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739540743457       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739540743457       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739540745122       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739540743199       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+06 is 1.735855e-10

solving harmonic davidson linear method for identity shift 5.2940e+06, overlap shift 5.2940e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739540743437       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739540743441       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739540743442       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739540744583       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739540745947       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739540743442       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739540736926       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739540731150       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739540745990       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739540758574       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+06 is 4.339635e-11

solving harmonic davidson linear method for identity shift 2.1176e+07, overlap shift 2.1176e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739540743437       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739540743438       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739540743438       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739540747367       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739540746841       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739540761925       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739540780088       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739540747777       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739540757446       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739540696691       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+07 is 1.084913e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.009874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9773e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8588
    reference variance = 0.378662
====================================================
  Execution time = 2.6628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6426e-01
  Total weights = 1.9645e+06
  Execution time = 3.5113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370978
                                         uncertainty =       0.008019179518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370978
                                         uncertainty =       0.008019179518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471448147
  error estimate for blocks of size 2^( 2) =       0.000496867644
  error estimate for blocks of size 2^( 3) =       0.000521026993
  error estimate for blocks of size 2^( 4) =       0.000539613766
  error estimate for blocks of size 2^( 5) =       0.000549750033
  error estimate for blocks of size 2^( 6) =       0.000557718548
  error estimate for blocks of size 2^( 7) =       0.000561041712

      target function =      -0.733610578987
              le_mean =     -22.815181962176
             les_mean =     520.996786901058
             stat err =       0.000552031015
             autocorr =       1.371068303486
   target nu stat err =       0.000552031015
   target dn stat err =       0.012527251386
      target stat err =       0.010055828239
              std dev =       0.666728363081
             le_variance =       0.444526710136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370979
                                         uncertainty =       0.008019179486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370979
                                         uncertainty =       0.008019179486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471448147
  error estimate for blocks of size 2^( 2) =       0.000496867644
  error estimate for blocks of size 2^( 3) =       0.000521026993
  error estimate for blocks of size 2^( 4) =       0.000539613766
  error estimate for blocks of size 2^( 5) =       0.000549750033
  error estimate for blocks of size 2^( 6) =       0.000557718548
  error estimate for blocks of size 2^( 7) =       0.000561041712

      target function =      -0.733610578607
              le_mean =     -22.815181962178
             les_mean =     520.996786901610
             stat err =       0.000552031015
             autocorr =       1.371068303276
   target nu stat err =       0.000552031015
   target dn stat err =       0.012527251451
      target stat err =       0.010055828281
              std dev =       0.666728363082
             le_variance =       0.444526710138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370979
                                         uncertainty =       0.008019179502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370979
                                         uncertainty =       0.008019179502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471448147
  error estimate for blocks of size 2^( 2) =       0.000496867644
  error estimate for blocks of size 2^( 3) =       0.000521026993
  error estimate for blocks of size 2^( 4) =       0.000539613766
  error estimate for blocks of size 2^( 5) =       0.000549750033
  error estimate for blocks of size 2^( 6) =       0.000557718548
  error estimate for blocks of size 2^( 7) =       0.000561041712

      target function =      -0.733610578797
              le_mean =     -22.815181962177
             les_mean =     520.996786901335
             stat err =       0.000552031015
             autocorr =       1.371068303383
   target nu stat err =       0.000552031015
   target dn stat err =       0.012527251419
      target stat err =       0.010055828260
              std dev =       0.666728363081
             le_variance =       0.444526710137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370978
                                         uncertainty =       0.008019179516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444572370978
                                         uncertainty =       0.008019179516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471448147
  error estimate for blocks of size 2^( 2) =       0.000496867644
  error estimate for blocks of size 2^( 3) =       0.000521026993
  error estimate for blocks of size 2^( 4) =       0.000539613766
  error estimate for blocks of size 2^( 5) =       0.000549750033
  error estimate for blocks of size 2^( 6) =       0.000557718548
  error estimate for blocks of size 2^( 7) =       0.000561041712

      target function =      -0.733610578963
              le_mean =     -22.815181962176
             les_mean =     520.996786901093
             stat err =       0.000552031015
             autocorr =       1.371068303476
   target nu stat err =       0.000552031015
   target dn stat err =       0.012527251390
      target stat err =       0.010055828242
              std dev =       0.666728363081
             le_variance =       0.444526710136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733610578987        initial  <--
     1.3235e+06     1.3235e+07             1.7359e-10        -0.733610578607
     5.2940e+06     5.2940e+07             4.3396e-11        -0.733610578797
     2.1176e+07     2.1176e+08             1.0849e-11        -0.733610578963

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2147
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.8759
    reference variance = 0.271623
====================================================
  Execution time = 2.5347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5373e-01
  Total weights = 1.964819187e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439964931891
                                         uncertainty =       0.003070834685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439964931891
                                         uncertainty =       0.003070834685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469020735
  error estimate for blocks of size 2^( 2) =       0.000494450276
  error estimate for blocks of size 2^( 3) =       0.000518962232
  error estimate for blocks of size 2^( 4) =       0.000538055186
  error estimate for blocks of size 2^( 5) =       0.000549341469
  error estimate for blocks of size 2^( 6) =       0.000557447904
  error estimate for blocks of size 2^( 7) =       0.000559054545

      target function =      -0.742261213703
              le_mean =     -22.814040312678
             les_mean =     520.934169963017
             stat err =       0.000550974776
             autocorr =       1.380000829159
   target nu stat err =       0.000550974776
   target dn stat err =       0.004827757750
      target stat err =       0.003999221574
              std dev =       0.663295485149
             le_variance =       0.439960900619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281404031268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742281861545       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742281861548       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742281861548       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742281861549       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742281861549       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742281861549       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742281861549       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742281861549       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742281861549       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+07 is 1.876047e-11

solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742281861545       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742281861546       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742281861546       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742281861546       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742281861546       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742281861546       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742281861546       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742281861546       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742281862703       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+07 is 4.690160e-12

solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742281861545       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742281861545       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742281861546       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742281861546       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742281861546       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742281861546       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742281861546       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742282523985       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742282383029       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+08 is 1.172623e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.012909 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9844e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.8155
    reference variance = 0.549556
====================================================
  Execution time = 2.4539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4785e-01
  Total weights = 1.9646e+06
  Execution time = 3.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768647
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768647
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466747369
  error estimate for blocks of size 2^( 2) =       0.000491975114
  error estimate for blocks of size 2^( 3) =       0.000516089614
  error estimate for blocks of size 2^( 4) =       0.000534165207
  error estimate for blocks of size 2^( 5) =       0.000545047733
  error estimate for blocks of size 2^( 6) =       0.000551261570
  error estimate for blocks of size 2^( 7) =       0.000553016652

      target function =      -0.747126371707
              le_mean =     -22.813936187423
             les_mean =     520.923532055016
             stat err =       0.000545872791
             autocorr =       1.367789098111
   target nu stat err =       0.000545872791
   target dn stat err =       0.002750167311
      target stat err =       0.002360064311
              std dev =       0.660080458816
             le_variance =       0.435706212111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768644
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768644
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466747369
  error estimate for blocks of size 2^( 2) =       0.000491975114
  error estimate for blocks of size 2^( 3) =       0.000516089614
  error estimate for blocks of size 2^( 4) =       0.000534165207
  error estimate for blocks of size 2^( 5) =       0.000545047733
  error estimate for blocks of size 2^( 6) =       0.000551261569
  error estimate for blocks of size 2^( 7) =       0.000553016652

      target function =      -0.747126371723
              le_mean =     -22.813936187423
             les_mean =     520.923532055004
             stat err =       0.000545872791
             autocorr =       1.367789098114
   target nu stat err =       0.000545872791
   target dn stat err =       0.002750167307
      target stat err =       0.002360064308
              std dev =       0.660080458815
             le_variance =       0.435706212109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768645
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768645
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466747369
  error estimate for blocks of size 2^( 2) =       0.000491975114
  error estimate for blocks of size 2^( 3) =       0.000516089614
  error estimate for blocks of size 2^( 4) =       0.000534165207
  error estimate for blocks of size 2^( 5) =       0.000545047733
  error estimate for blocks of size 2^( 6) =       0.000551261570
  error estimate for blocks of size 2^( 7) =       0.000553016652

      target function =      -0.747126371715
              le_mean =     -22.813936187423
             les_mean =     520.923532055010
             stat err =       0.000545872791
             autocorr =       1.367789098117
   target nu stat err =       0.000545872791
   target dn stat err =       0.002750167309
      target stat err =       0.002360064310
              std dev =       0.660080458815
             le_variance =       0.435706212110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768646
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435673768646
                                         uncertainty =       0.002099176748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466747369
  error estimate for blocks of size 2^( 2) =       0.000491975114
  error estimate for blocks of size 2^( 3) =       0.000516089614
  error estimate for blocks of size 2^( 4) =       0.000534165207
  error estimate for blocks of size 2^( 5) =       0.000545047733
  error estimate for blocks of size 2^( 6) =       0.000551261570
  error estimate for blocks of size 2^( 7) =       0.000553016652

      target function =      -0.747126371708
              le_mean =     -22.813936187423
             les_mean =     520.923532055015
             stat err =       0.000545872791
             autocorr =       1.367789098111
   target nu stat err =       0.000545872791
   target dn stat err =       0.002750167311
      target stat err =       0.002360064311
              std dev =       0.660080458816
             le_variance =       0.435706212111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747126371707        initial
     1.3235e+07     1.3235e+08             1.8760e-11        -0.747126371723  <--
     5.2940e+07     5.2940e+08             4.6902e-12        -0.747126371715
     2.1176e+08     2.1176e+09             1.1726e-12        -0.747126371708

*****************************************************************************
Applying the update for shift_i =   1.3235e+07     and shift_s =   1.3235e+08
*****************************************************************************

  Execution time = 4.2135e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397564e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935185e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7336
    reference variance = 0.367232
====================================================
  Execution time = 2.5397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5338e-01
  Total weights = 1.964444075e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440130749656
                                         uncertainty =       0.002073531886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440130749656
                                         uncertainty =       0.002073531886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469109753
  error estimate for blocks of size 2^( 2) =       0.000494429329
  error estimate for blocks of size 2^( 3) =       0.000518486990
  error estimate for blocks of size 2^( 4) =       0.000535899243
  error estimate for blocks of size 2^( 5) =       0.000547719299
  error estimate for blocks of size 2^( 6) =       0.000554589265
  error estimate for blocks of size 2^( 7) =       0.000557214218

      target function =      -0.742558612318
              le_mean =     -22.815296867545
             les_mean =     520.991154412984
             stat err =       0.000548855506
             autocorr =       1.368885509664
   target nu stat err =       0.000548855506
   target dn stat err =       0.003203411384
      target stat err =       0.002698889998
              std dev =       0.663421374935
             le_variance =       0.440127920720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529686754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742567484893       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742567484899       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742567484899       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742567484955       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742567484899       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742567481065       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742567483783       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742567484372       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742567485542       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742567483123       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+06 is 6.847034e-11

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742567484893       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742567484895       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742567484895       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742567484895       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742567484895       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742567499515       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742567484895       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742567484895       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742567477249       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742567490204       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+07 is 1.711758e-11

solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742567484893       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742567484894       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742567484894       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742567465161       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742567485683       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742567489661       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742567461956       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742567546502       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742567453244       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742567488623       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+07 is 4.279256e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.016416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9930e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.8422
    reference variance = 0.425548
====================================================
  Execution time = 2.6091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5005e-01
  Total weights = 1.9649e+06
  Execution time = 3.5975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118056
                                         uncertainty =       0.002096940383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118056
                                         uncertainty =       0.002096940383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467785180
  error estimate for blocks of size 2^( 2) =       0.000493152065
  error estimate for blocks of size 2^( 3) =       0.000517344279
  error estimate for blocks of size 2^( 4) =       0.000535048503
  error estimate for blocks of size 2^( 5) =       0.000547478039
  error estimate for blocks of size 2^( 6) =       0.000553206987
  error estimate for blocks of size 2^( 7) =       0.000556545560

      target function =      -0.745307072251
              le_mean =     -22.814249102600
             les_mean =     520.940009994658
             stat err =       0.000548069772
             autocorr =       1.372709954640
   target nu stat err =       0.000548069772
   target dn stat err =       0.002746166660
      target stat err =       0.002347491811
              std dev =       0.661548145337
             le_variance =       0.437645948599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118050
                                         uncertainty =       0.002096940384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118050
                                         uncertainty =       0.002096940384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467785180
  error estimate for blocks of size 2^( 2) =       0.000493152064
  error estimate for blocks of size 2^( 3) =       0.000517344279
  error estimate for blocks of size 2^( 4) =       0.000535048503
  error estimate for blocks of size 2^( 5) =       0.000547478039
  error estimate for blocks of size 2^( 6) =       0.000553206986
  error estimate for blocks of size 2^( 7) =       0.000556545560

      target function =      -0.745307072286
              le_mean =     -22.814249102600
             les_mean =     520.940009994607
             stat err =       0.000548069772
             autocorr =       1.372709954574
   target nu stat err =       0.000548069772
   target dn stat err =       0.002746166660
      target stat err =       0.002347491811
              std dev =       0.661548145332
             le_variance =       0.437645948593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118053
                                         uncertainty =       0.002096940383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118053
                                         uncertainty =       0.002096940383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467785180
  error estimate for blocks of size 2^( 2) =       0.000493152064
  error estimate for blocks of size 2^( 3) =       0.000517344279
  error estimate for blocks of size 2^( 4) =       0.000535048503
  error estimate for blocks of size 2^( 5) =       0.000547478039
  error estimate for blocks of size 2^( 6) =       0.000553206987
  error estimate for blocks of size 2^( 7) =       0.000556545560

      target function =      -0.745307072269
              le_mean =     -22.814249102600
             les_mean =     520.940009994632
             stat err =       0.000548069772
             autocorr =       1.372709954605
   target nu stat err =       0.000548069772
   target dn stat err =       0.002746166660
      target stat err =       0.002347491811
              std dev =       0.661548145335
             le_variance =       0.437645948596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118056
                                         uncertainty =       0.002096940383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437629118056
                                         uncertainty =       0.002096940383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467785180
  error estimate for blocks of size 2^( 2) =       0.000493152065
  error estimate for blocks of size 2^( 3) =       0.000517344279
  error estimate for blocks of size 2^( 4) =       0.000535048503
  error estimate for blocks of size 2^( 5) =       0.000547478039
  error estimate for blocks of size 2^( 6) =       0.000553206987
  error estimate for blocks of size 2^( 7) =       0.000556545560

      target function =      -0.745307072254
              le_mean =     -22.814249102600
             les_mean =     520.940009994655
             stat err =       0.000548069772
             autocorr =       1.372709954627
   target nu stat err =       0.000548069772
   target dn stat err =       0.002746166660
      target stat err =       0.002347491811
              std dev =       0.661548145337
             le_variance =       0.437645948599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745307072251        initial
     3.3087e+06     3.3087e+07             6.8470e-11        -0.745307072286  <--
     1.3235e+07     1.3235e+08             1.7118e-11        -0.745307072269
     5.2940e+07     5.2940e+08             4.2793e-12        -0.745307072254

*****************************************************************************
Applying the update for shift_i =   3.3087e+06     and shift_s =   3.3087e+07
*****************************************************************************

  Execution time = 4.3756e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.9101
    reference variance = 0.448078
====================================================
  Execution time = 2.5337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5311e-01
  Total weights = 1.964659781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438470098887
                                         uncertainty =       0.001996875125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438470098887
                                         uncertainty =       0.001996875125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468196554
  error estimate for blocks of size 2^( 2) =       0.000493786544
  error estimate for blocks of size 2^( 3) =       0.000518655109
  error estimate for blocks of size 2^( 4) =       0.000536360326
  error estimate for blocks of size 2^( 5) =       0.000547383067
  error estimate for blocks of size 2^( 6) =       0.000553225566
  error estimate for blocks of size 2^( 7) =       0.000559565621

      target function =      -0.742785298839
              le_mean =     -22.815992422272
             les_mean =     521.022617177541
             stat err =       0.000549133645
             autocorr =       1.375623802779
   target nu stat err =       0.000549133645
   target dn stat err =       0.002859058542
      target stat err =       0.002428288729
              std dev =       0.662129915851
             le_variance =       0.438416025464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281599242227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+05, overlap shift 8.2718e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742792306637       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742792306667       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742792306671       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742792306673       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742792306664       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742792307028       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742792306758       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742792306936       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742792306859       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+05 is 4.140531e-10

solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742792306637       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742792306644       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742792306645       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742792306646       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742792305163       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742792306646       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742792310233       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742792305281       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742792297001       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+06 is 1.035133e-10

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742792306637       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742792306639       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742792306639       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742792306639       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742792306639       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742792303402       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742792306639       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742792316566       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742792317434       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+07 is 2.587846e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.019479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9845e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.8797
    reference variance = 0.504051
====================================================
  Execution time = 2.4602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5443e-01
  Total weights = 1.9646e+06
  Execution time = 3.5120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474656
                                         uncertainty =       0.002812114092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474656
                                         uncertainty =       0.002812114092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466735409
  error estimate for blocks of size 2^( 2) =       0.000492069934
  error estimate for blocks of size 2^( 3) =       0.000516095107
  error estimate for blocks of size 2^( 4) =       0.000534126640
  error estimate for blocks of size 2^( 5) =       0.000545882625
  error estimate for blocks of size 2^( 6) =       0.000550629293
  error estimate for blocks of size 2^( 7) =       0.000557429888

      target function =      -0.741650474473
              le_mean =     -22.814557013676
             les_mean =     520.958438486314
             stat err =       0.000547017112
             autocorr =       1.373600130968
   target nu stat err =       0.000547017112
   target dn stat err =       0.008421790629
      target stat err =       0.006916139812
              std dev =       0.660063545852
             le_variance =       0.435683884563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474646
                                         uncertainty =       0.002812114133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474646
                                         uncertainty =       0.002812114133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466735409
  error estimate for blocks of size 2^( 2) =       0.000492069934
  error estimate for blocks of size 2^( 3) =       0.000516095107
  error estimate for blocks of size 2^( 4) =       0.000534126640
  error estimate for blocks of size 2^( 5) =       0.000545882625
  error estimate for blocks of size 2^( 6) =       0.000550629293
  error estimate for blocks of size 2^( 7) =       0.000557429888

      target function =      -0.741650473807
              le_mean =     -22.814557013677
             les_mean =     520.958438487183
             stat err =       0.000547017112
             autocorr =       1.373600130564
   target nu stat err =       0.000547017112
   target dn stat err =       0.008421790764
      target stat err =       0.006916139909
              std dev =       0.660063545845
             le_variance =       0.435683884554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474651
                                         uncertainty =       0.002812114112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474651
                                         uncertainty =       0.002812114112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466735409
  error estimate for blocks of size 2^( 2) =       0.000492069934
  error estimate for blocks of size 2^( 3) =       0.000516095107
  error estimate for blocks of size 2^( 4) =       0.000534126640
  error estimate for blocks of size 2^( 5) =       0.000545882625
  error estimate for blocks of size 2^( 6) =       0.000550629293
  error estimate for blocks of size 2^( 7) =       0.000557429888

      target function =      -0.741650474140
              le_mean =     -22.814557013677
             les_mean =     520.958438486748
             stat err =       0.000547017112
             autocorr =       1.373600130759
   target nu stat err =       0.000547017112
   target dn stat err =       0.008421790696
      target stat err =       0.006916139860
              std dev =       0.660063545849
             le_variance =       0.435683884558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474655
                                         uncertainty =       0.002812114094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435674474655
                                         uncertainty =       0.002812114094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466735409
  error estimate for blocks of size 2^( 2) =       0.000492069934
  error estimate for blocks of size 2^( 3) =       0.000516095107
  error estimate for blocks of size 2^( 4) =       0.000534126640
  error estimate for blocks of size 2^( 5) =       0.000545882625
  error estimate for blocks of size 2^( 6) =       0.000550629293
  error estimate for blocks of size 2^( 7) =       0.000557429888

      target function =      -0.741650474431
              le_mean =     -22.814557013676
             les_mean =     520.958438486368
             stat err =       0.000547017112
             autocorr =       1.373600130934
   target nu stat err =       0.000547017112
   target dn stat err =       0.008421790638
      target stat err =       0.006916139818
              std dev =       0.660063545852
             le_variance =       0.435683884563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741650474473        initial  <--
     8.2718e+05     8.2718e+06             4.1405e-10        -0.741650473807
     3.3087e+06     3.3087e+07             1.0351e-10        -0.741650474140
     1.3235e+07     1.3235e+08             2.5878e-11        -0.741650474431

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1687
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.8372
    reference variance = 0.283215
====================================================
  Execution time = 2.5273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5397e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4926e-01
  Total weights = 1.964963955e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435929633374
                                         uncertainty =       0.001945448475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435929633374
                                         uncertainty =       0.001945448475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466902227
  error estimate for blocks of size 2^( 2) =       0.000492679142
  error estimate for blocks of size 2^( 3) =       0.000517444543
  error estimate for blocks of size 2^( 4) =       0.000535880696
  error estimate for blocks of size 2^( 5) =       0.000546826229
  error estimate for blocks of size 2^( 6) =       0.000553093497
  error estimate for blocks of size 2^( 7) =       0.000558105858

      target function =      -0.745962673399
              le_mean =     -22.815198285715
             les_mean =     520.982531336409
             stat err =       0.000548476570
             autocorr =       1.379952916982
   target nu stat err =       0.000548476570
   target dn stat err =       0.002706763344
      target stat err =       0.002323410160
              std dev =       0.660299462202
             le_variance =       0.435995379785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281519828571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+06, overlap shift 8.2718e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745968946746       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745968946748       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745968946749       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745968946749       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745968947156       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745968944557       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745968946749       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745968934856       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745968958520       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+06 is 3.629404e-11

solving harmonic davidson linear method for identity shift 3.3087e+07, overlap shift 3.3087e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745968946746       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745968946746       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745968946746       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745968946574       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745968946685       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745968945957       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745969039076       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745968944045       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745968977818       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+07 is 9.073357e-12

solving harmonic davidson linear method for identity shift 1.3235e+08, overlap shift 1.3235e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745968946746       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745968946746       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745968946746       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745968946746       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745968934141       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745968869321       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745969085501       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745969150900       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745969140054       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+08 is 2.268327e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.022531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9814e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -23.0217
    reference variance = 3.03705
====================================================
  Execution time = 2.4740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4396e-01
  Total weights = 1.9647e+06
  Execution time = 3.5264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269373
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269373
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465391760
  error estimate for blocks of size 2^( 2) =       0.000491336483
  error estimate for blocks of size 2^( 3) =       0.000515394395
  error estimate for blocks of size 2^( 4) =       0.000534075522
  error estimate for blocks of size 2^( 5) =       0.000545183892
  error estimate for blocks of size 2^( 6) =       0.000553014640
  error estimate for blocks of size 2^( 7) =       0.000555175351

      target function =      -0.750375329268
              le_mean =     -22.814749723795
             les_mean =     520.956764368599
             stat err =       0.000546862351
             autocorr =       1.380761509071
   target nu stat err =       0.000546862351
   target dn stat err =       0.002383305350
      target stat err =       0.002087559974
              std dev =       0.658163338635
             le_variance =       0.433178980323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269368
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269368
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465391760
  error estimate for blocks of size 2^( 2) =       0.000491336483
  error estimate for blocks of size 2^( 3) =       0.000515394395
  error estimate for blocks of size 2^( 4) =       0.000534075522
  error estimate for blocks of size 2^( 5) =       0.000545183892
  error estimate for blocks of size 2^( 6) =       0.000553014640
  error estimate for blocks of size 2^( 7) =       0.000555175351

      target function =      -0.750375329275
              le_mean =     -22.814749723795
             les_mean =     520.956764368591
             stat err =       0.000546862351
             autocorr =       1.380761509035
   target nu stat err =       0.000546862351
   target dn stat err =       0.002383305348
      target stat err =       0.002087559973
              std dev =       0.658163338631
             le_variance =       0.433178980318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269370
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269370
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465391760
  error estimate for blocks of size 2^( 2) =       0.000491336483
  error estimate for blocks of size 2^( 3) =       0.000515394395
  error estimate for blocks of size 2^( 4) =       0.000534075522
  error estimate for blocks of size 2^( 5) =       0.000545183892
  error estimate for blocks of size 2^( 6) =       0.000553014640
  error estimate for blocks of size 2^( 7) =       0.000555175351

      target function =      -0.750375329271
              le_mean =     -22.814749723795
             les_mean =     520.956764368595
             stat err =       0.000546862351
             autocorr =       1.380761509052
   target nu stat err =       0.000546862351
   target dn stat err =       0.002383305349
      target stat err =       0.002087559973
              std dev =       0.658163338633
             le_variance =       0.433178980320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269372
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433063269372
                                         uncertainty =       0.002032026011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465391760
  error estimate for blocks of size 2^( 2) =       0.000491336483
  error estimate for blocks of size 2^( 3) =       0.000515394395
  error estimate for blocks of size 2^( 4) =       0.000534075522
  error estimate for blocks of size 2^( 5) =       0.000545183892
  error estimate for blocks of size 2^( 6) =       0.000553014640
  error estimate for blocks of size 2^( 7) =       0.000555175351

      target function =      -0.750375329268
              le_mean =     -22.814749723795
             les_mean =     520.956764368599
             stat err =       0.000546862351
             autocorr =       1.380761509074
   target nu stat err =       0.000546862351
   target dn stat err =       0.002383305350
      target stat err =       0.002087559974
              std dev =       0.658163338634
             le_variance =       0.433178980322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750375329268        initial
     8.2718e+06     8.2718e+07             3.6294e-11        -0.750375329275  <--
     3.3087e+07     3.3087e+08             9.0734e-12        -0.750375329271
     1.3235e+08     1.3235e+09             2.2683e-12        -0.750375329268

*****************************************************************************
Applying the update for shift_i =   8.2718e+06     and shift_s =   8.2718e+07
*****************************************************************************

  Execution time = 4.5542e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172310e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878447e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6983
    reference variance = 0.459562
====================================================
  Execution time = 2.5378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5251e-01
  Total weights = 1.964865219e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437463516573
                                         uncertainty =       0.002132323008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437463516573
                                         uncertainty =       0.002132323008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467697574
  error estimate for blocks of size 2^( 2) =       0.000493376229
  error estimate for blocks of size 2^( 3) =       0.000516650996
  error estimate for blocks of size 2^( 4) =       0.000534859268
  error estimate for blocks of size 2^( 5) =       0.000546392162
  error estimate for blocks of size 2^( 6) =       0.000553583623
  error estimate for blocks of size 2^( 7) =       0.000558197703

      target function =      -0.743275917573
              le_mean =     -22.814591994009
             les_mean =     520.958119425963
             stat err =       0.000548258189
             autocorr =       1.374168595431
   target nu stat err =       0.000548258189
   target dn stat err =       0.003175221832
      target stat err =       0.002678424579
              std dev =       0.661424252824
             le_variance =       0.437482042223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281459199401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+06, overlap shift 2.0680e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743284552736       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743284552753       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743284552755       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743284552756       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743284552756       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743284552756       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743284552756       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743284552756       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743284552756       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743284552756       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+06 is 1.347758e-10

solving harmonic davidson linear method for identity shift 8.2718e+06, overlap shift 8.2718e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743284552736       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743284552740       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743284552741       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743284552741       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743284552741       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743284552741       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743284552741       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743284552741       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743284552741       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743284549069       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+06 is 3.369394e-11

solving harmonic davidson linear method for identity shift 3.3087e+07, overlap shift 3.3087e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743284552736       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743284552737       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743284552737       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743284552737       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743284550289       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743284541689       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743284552737       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743284552737       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743284530886       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743284552737       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+07 is 8.423537e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.026017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9864e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484223e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8571
    reference variance = 0.315337
====================================================
  Execution time = 2.4593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5041e-01
  Total weights = 1.9648e+06
  Execution time = 3.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543398
                                         uncertainty =       0.002110606790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543398
                                         uncertainty =       0.002110606790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466847014
  error estimate for blocks of size 2^( 2) =       0.000492902528
  error estimate for blocks of size 2^( 3) =       0.000517040172
  error estimate for blocks of size 2^( 4) =       0.000535128986
  error estimate for blocks of size 2^( 5) =       0.000545533457
  error estimate for blocks of size 2^( 6) =       0.000551960358
  error estimate for blocks of size 2^( 7) =       0.000557829435

      target function =      -0.745010569047
              le_mean =     -22.814511233971
             les_mean =     520.952328489429
             stat err =       0.000547613059
             autocorr =       1.375936598038
   target nu stat err =       0.000547613059
   target dn stat err =       0.003100705039
      target stat err =       0.002630249580
              std dev =       0.660221378448
             le_variance =       0.435892268560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543376
                                         uncertainty =       0.002110606788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543376
                                         uncertainty =       0.002110606788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466847014
  error estimate for blocks of size 2^( 2) =       0.000492902528
  error estimate for blocks of size 2^( 3) =       0.000517040172
  error estimate for blocks of size 2^( 4) =       0.000535128986
  error estimate for blocks of size 2^( 5) =       0.000545533457
  error estimate for blocks of size 2^( 6) =       0.000551960358
  error estimate for blocks of size 2^( 7) =       0.000557829435

      target function =      -0.745010569121
              le_mean =     -22.814511233970
             les_mean =     520.952328489330
             stat err =       0.000547613059
             autocorr =       1.375936597957
   target nu stat err =       0.000547613059
   target dn stat err =       0.003100705006
      target stat err =       0.002630249554
              std dev =       0.660221378431
             le_variance =       0.435892268538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543387
                                         uncertainty =       0.002110606789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543387
                                         uncertainty =       0.002110606789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466847014
  error estimate for blocks of size 2^( 2) =       0.000492902528
  error estimate for blocks of size 2^( 3) =       0.000517040172
  error estimate for blocks of size 2^( 4) =       0.000535128986
  error estimate for blocks of size 2^( 5) =       0.000545533457
  error estimate for blocks of size 2^( 6) =       0.000551960358
  error estimate for blocks of size 2^( 7) =       0.000557829435

      target function =      -0.745010569084
              le_mean =     -22.814511233971
             les_mean =     520.952328489379
             stat err =       0.000547613059
             autocorr =       1.375936597997
   target nu stat err =       0.000547613059
   target dn stat err =       0.003100705022
      target stat err =       0.002630249567
              std dev =       0.660221378440
             le_variance =       0.435892268549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543396
                                         uncertainty =       0.002110606790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435779543396
                                         uncertainty =       0.002110606790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466847014
  error estimate for blocks of size 2^( 2) =       0.000492902528
  error estimate for blocks of size 2^( 3) =       0.000517040172
  error estimate for blocks of size 2^( 4) =       0.000535128986
  error estimate for blocks of size 2^( 5) =       0.000545533457
  error estimate for blocks of size 2^( 6) =       0.000551960358
  error estimate for blocks of size 2^( 7) =       0.000557829435

      target function =      -0.745010569051
              le_mean =     -22.814511233971
             les_mean =     520.952328489422
             stat err =       0.000547613059
             autocorr =       1.375936598036
   target nu stat err =       0.000547613059
   target dn stat err =       0.003100705037
      target stat err =       0.002630249578
              std dev =       0.660221378447
             le_variance =       0.435892268558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745010569047        initial
     2.0680e+06     2.0680e+07             1.3478e-10        -0.745010569121  <--
     8.2718e+06     8.2718e+07             3.3694e-11        -0.745010569084
     3.3087e+07     3.3087e+08             8.4235e-12        -0.745010569051

*****************************************************************************
Applying the update for shift_i =   2.0680e+06     and shift_s =   2.0680e+07
*****************************************************************************

  Execution time = 4.2195e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.8182
    reference variance = 0.929322
====================================================
  Execution time = 2.5211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4856e-01
  Total weights = 1.964731876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436240872405
                                         uncertainty =       0.002143192278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436240872405
                                         uncertainty =       0.002143192278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467001802
  error estimate for blocks of size 2^( 2) =       0.000492555252
  error estimate for blocks of size 2^( 3) =       0.000517067166
  error estimate for blocks of size 2^( 4) =       0.000534409794
  error estimate for blocks of size 2^( 5) =       0.000546992061
  error estimate for blocks of size 2^( 6) =       0.000552734084
  error estimate for blocks of size 2^( 7) =       0.000556799978

      target function =      -0.746542397156
              le_mean =     -22.814366705856
             les_mean =     520.943884072418
             stat err =       0.000547733979
             autocorr =       1.375631950025
   target nu stat err =       0.000547733979
   target dn stat err =       0.002590814218
      target stat err =       0.002231214685
              std dev =       0.660440282396
             le_variance =       0.436181366611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281436670586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+05, overlap shift 5.1699e+06 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746548076304       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746548076344       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746548076351       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746548076352       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746548076352       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746548076408       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746548077547       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746548078212       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746548075984       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746548075648       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+05 is 5.333826e-10

solving harmonic davidson linear method for identity shift 2.0680e+06, overlap shift 2.0680e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746548076304       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746548076314       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746548076316       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746548076316       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746548076315       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746548077261       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746548077231       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746548076887       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746548078069       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746548076346       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+06 is 1.333456e-10

solving harmonic davidson linear method for identity shift 8.2718e+06, overlap shift 8.2718e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746548076304       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746548076307       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746548076307       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746548076307       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746548077044       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746548065590       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746548079629       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746548091896       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746548058084       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746548065521       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+06 is 3.333641e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.029511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9701e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384284e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152506e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540127e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663952e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280256e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474065e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7911
    reference variance = 0.605815
====================================================
  Execution time = 2.4687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4938e-01
  Total weights = 1.9646e+06
  Execution time = 3.5163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716779
                                         uncertainty =       0.001794220699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716779
                                         uncertainty =       0.001794220699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467400596
  error estimate for blocks of size 2^( 2) =       0.000493107566
  error estimate for blocks of size 2^( 3) =       0.000517128497
  error estimate for blocks of size 2^( 4) =       0.000535441659
  error estimate for blocks of size 2^( 5) =       0.000546480075
  error estimate for blocks of size 2^( 6) =       0.000553613042
  error estimate for blocks of size 2^( 7) =       0.000557663436

      target function =      -0.745864965782
              le_mean =     -22.815414676541
             les_mean =     520.992525361114
             stat err =       0.000548299553
             autocorr =       1.376123019705
   target nu stat err =       0.000548299553
   target dn stat err =       0.002455107650
      target stat err =       0.002123034070
              std dev =       0.661004261939
             le_variance =       0.436926634301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716782
                                         uncertainty =       0.001794220707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716782
                                         uncertainty =       0.001794220707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467400596
  error estimate for blocks of size 2^( 2) =       0.000493107566
  error estimate for blocks of size 2^( 3) =       0.000517128497
  error estimate for blocks of size 2^( 4) =       0.000535441658
  error estimate for blocks of size 2^( 5) =       0.000546480075
  error estimate for blocks of size 2^( 6) =       0.000553613042
  error estimate for blocks of size 2^( 7) =       0.000557663436

      target function =      -0.745864965414
              le_mean =     -22.815414676542
             les_mean =     520.992525361637
             stat err =       0.000548299553
             autocorr =       1.376123019179
   target nu stat err =       0.000548299553
   target dn stat err =       0.002455107704
      target stat err =       0.002123034110
              std dev =       0.661004261941
             le_variance =       0.436926634305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716780
                                         uncertainty =       0.001794220703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716780
                                         uncertainty =       0.001794220703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467400596
  error estimate for blocks of size 2^( 2) =       0.000493107566
  error estimate for blocks of size 2^( 3) =       0.000517128497
  error estimate for blocks of size 2^( 4) =       0.000535441659
  error estimate for blocks of size 2^( 5) =       0.000546480075
  error estimate for blocks of size 2^( 6) =       0.000553613042
  error estimate for blocks of size 2^( 7) =       0.000557663436

      target function =      -0.745864965598
              le_mean =     -22.815414676541
             les_mean =     520.992525361375
             stat err =       0.000548299553
             autocorr =       1.376123019438
   target nu stat err =       0.000548299553
   target dn stat err =       0.002455107677
      target stat err =       0.002123034090
              std dev =       0.661004261940
             le_variance =       0.436926634303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716779
                                         uncertainty =       0.001794220700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436844716779
                                         uncertainty =       0.001794220700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467400596
  error estimate for blocks of size 2^( 2) =       0.000493107566
  error estimate for blocks of size 2^( 3) =       0.000517128497
  error estimate for blocks of size 2^( 4) =       0.000535441659
  error estimate for blocks of size 2^( 5) =       0.000546480075
  error estimate for blocks of size 2^( 6) =       0.000553613042
  error estimate for blocks of size 2^( 7) =       0.000557663436

      target function =      -0.745864965759
              le_mean =     -22.815414676541
             les_mean =     520.992525361147
             stat err =       0.000548299553
             autocorr =       1.376123019671
   target nu stat err =       0.000548299553
   target dn stat err =       0.002455107654
      target stat err =       0.002123034072
              std dev =       0.661004261939
             le_variance =       0.436926634301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745864965782        initial  <--
     5.1699e+05     5.1699e+06             5.3338e-10        -0.745864965414
     2.0680e+06     2.0680e+07             1.3335e-10        -0.745864965598
     8.2718e+06     8.2718e+07             3.3336e-11        -0.745864965759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8436
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7362
    reference variance = 0.515175
====================================================
  Execution time = 2.5285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5139e-01
  Total weights = 1.964824117e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437664785641
                                         uncertainty =       0.001833578309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437664785641
                                         uncertainty =       0.001833578309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467755398
  error estimate for blocks of size 2^( 2) =       0.000493608595
  error estimate for blocks of size 2^( 3) =       0.000517432697
  error estimate for blocks of size 2^( 4) =       0.000535074820
  error estimate for blocks of size 2^( 5) =       0.000547178533
  error estimate for blocks of size 2^( 6) =       0.000553616854
  error estimate for blocks of size 2^( 7) =       0.000556618878

      target function =      -0.744202476014
              le_mean =     -22.814481678857
             les_mean =     520.951962717626
             stat err =       0.000548122271
             autocorr =       1.373147786246
   target nu stat err =       0.000548122271
   target dn stat err =       0.002658806137
      target stat err =       0.002272179270
              std dev =       0.661506027654
             le_variance =       0.437590224623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281448167886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+06, overlap shift 5.1699e+07 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744208437594       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744208437598       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744208437598       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744208437599       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744208437599       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744208433873       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744208421153       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744208437599       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744208437599       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+06 is 6.434002e-11

solving harmonic davidson linear method for identity shift 2.0680e+07, overlap shift 2.0680e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744208437594       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744208437595       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744208437595       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744208437595       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744208428145       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744208437595       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744208437595       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744208412876       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744208472076       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+07 is 1.608493e-11

solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744208437594       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744208437594       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744208437594       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744208437594       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744208437594       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744208437594       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744208437594       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744208437594       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744208292950       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+07 is 4.021356e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.032594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9788e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7989
    reference variance = 0.310977
====================================================
  Execution time = 2.4688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5143e-01
  Total weights = 1.9645e+06
  Execution time = 3.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051231
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051231
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467450720
  error estimate for blocks of size 2^( 2) =       0.000493364482
  error estimate for blocks of size 2^( 3) =       0.000517995337
  error estimate for blocks of size 2^( 4) =       0.000535410440
  error estimate for blocks of size 2^( 5) =       0.000546232803
  error estimate for blocks of size 2^( 6) =       0.000553038057
  error estimate for blocks of size 2^( 7) =       0.000553371390

      target function =      -0.744167363838
              le_mean =     -22.814495284757
             les_mean =     520.952624913341
             stat err =       0.000547013172
             autocorr =       1.369379755112
   target nu stat err =       0.000547013172
   target dn stat err =       0.002866631360
      target stat err =       0.002437079465
              std dev =       0.661075147934
             le_variance =       0.437020351216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051222
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051222
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467450720
  error estimate for blocks of size 2^( 2) =       0.000493364481
  error estimate for blocks of size 2^( 3) =       0.000517995337
  error estimate for blocks of size 2^( 4) =       0.000535410440
  error estimate for blocks of size 2^( 5) =       0.000546232803
  error estimate for blocks of size 2^( 6) =       0.000553038057
  error estimate for blocks of size 2^( 7) =       0.000553371390

      target function =      -0.744167363838
              le_mean =     -22.814495284756
             les_mean =     520.952624913335
             stat err =       0.000547013172
             autocorr =       1.369379755064
   target nu stat err =       0.000547013172
   target dn stat err =       0.002866631362
      target stat err =       0.002437079467
              std dev =       0.661075147927
             le_variance =       0.437020351207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051226
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051226
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467450720
  error estimate for blocks of size 2^( 2) =       0.000493364481
  error estimate for blocks of size 2^( 3) =       0.000517995337
  error estimate for blocks of size 2^( 4) =       0.000535410440
  error estimate for blocks of size 2^( 5) =       0.000546232803
  error estimate for blocks of size 2^( 6) =       0.000553038057
  error estimate for blocks of size 2^( 7) =       0.000553371390

      target function =      -0.744167363838
              le_mean =     -22.814495284756
             les_mean =     520.952624913338
             stat err =       0.000547013172
             autocorr =       1.369379755090
   target nu stat err =       0.000547013172
   target dn stat err =       0.002866631361
      target stat err =       0.002437079466
              std dev =       0.661075147931
             le_variance =       0.437020351212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051230
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436994051230
                                         uncertainty =       0.001904130217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467450720
  error estimate for blocks of size 2^( 2) =       0.000493364482
  error estimate for blocks of size 2^( 3) =       0.000517995337
  error estimate for blocks of size 2^( 4) =       0.000535410440
  error estimate for blocks of size 2^( 5) =       0.000546232803
  error estimate for blocks of size 2^( 6) =       0.000553038057
  error estimate for blocks of size 2^( 7) =       0.000553371390

      target function =      -0.744167363838
              le_mean =     -22.814495284757
             les_mean =     520.952624913341
             stat err =       0.000547013172
             autocorr =       1.369379755106
   target nu stat err =       0.000547013172
   target dn stat err =       0.002866631360
      target stat err =       0.002437079465
              std dev =       0.661075147934
             le_variance =       0.437020351215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744167363838        initial  <--
     5.1699e+06     5.1699e+07             6.4340e-11        -0.744167363838
     2.0680e+07     2.0680e+08             1.6085e-11        -0.744167363838
     8.2718e+07     8.2718e+08             4.0214e-12        -0.744167363838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3126
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8957
    reference variance = 0.713181
====================================================
  Execution time = 2.5261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4975e-01
  Total weights = 1.964787423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436008518357
                                         uncertainty =       0.002175201817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436008518357
                                         uncertainty =       0.002175201817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466954252
  error estimate for blocks of size 2^( 2) =       0.000492688847
  error estimate for blocks of size 2^( 3) =       0.000517096701
  error estimate for blocks of size 2^( 4) =       0.000535182788
  error estimate for blocks of size 2^( 5) =       0.000548044176
  error estimate for blocks of size 2^( 6) =       0.000552688449
  error estimate for blocks of size 2^( 7) =       0.000556916927

      target function =      -0.745552922969
              le_mean =     -22.814628332473
             les_mean =     520.957014410136
             stat err =       0.000548208085
             autocorr =       1.378295075030
   target nu stat err =       0.000548208085
   target dn stat err =       0.003219622304
      target stat err =       0.002730348091
              std dev =       0.660373035753
             le_variance =       0.436092546349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462833247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+07, overlap shift 5.1699e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745561978212       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745561978212       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745561978212       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745561978212       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745561978212       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745561976857       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745561982099       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745561983493       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745562037725       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+07 is 7.568719e-12

solving harmonic davidson linear method for identity shift 2.0680e+08, overlap shift 2.0680e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745561978212       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745561978212       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745561978212       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745561978212       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745561978178       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745562000127       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745562103775       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745561981134       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745561992265       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+08 is 1.892197e-12

solving harmonic davidson linear method for identity shift 8.2718e+08, overlap shift 8.2718e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745561978212       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745561978212       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745561978212       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745561978212       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745561978212       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745562029685       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745563533601       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745564066087       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745562202978       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+08 is 4.730006e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.035682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9819e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083737e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8006
    reference variance = 0.368329
====================================================
  Execution time = 2.4620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4822e-01
  Total weights = 1.9646e+06
  Execution time = 3.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466460827
  error estimate for blocks of size 2^( 2) =       0.000492174728
  error estimate for blocks of size 2^( 3) =       0.000516868643
  error estimate for blocks of size 2^( 4) =       0.000535028747
  error estimate for blocks of size 2^( 5) =       0.000546040149
  error estimate for blocks of size 2^( 6) =       0.000553862375
  error estimate for blocks of size 2^( 7) =       0.000554954977

      target function =      -0.746829079958
              le_mean =     -22.815444182344
             les_mean =     520.992708612155
             stat err =       0.000547471562
             autocorr =       1.377503699613
   target nu stat err =       0.000547471562
   target dn stat err =       0.002613163133
      target stat err =       0.002254235822
              std dev =       0.659675228200
             le_variance =       0.435171406701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466460827
  error estimate for blocks of size 2^( 2) =       0.000492174728
  error estimate for blocks of size 2^( 3) =       0.000516868643
  error estimate for blocks of size 2^( 4) =       0.000535028747
  error estimate for blocks of size 2^( 5) =       0.000546040149
  error estimate for blocks of size 2^( 6) =       0.000553862375
  error estimate for blocks of size 2^( 7) =       0.000554954977

      target function =      -0.746829079964
              le_mean =     -22.815444182344
             les_mean =     520.992708612146
             stat err =       0.000547471562
             autocorr =       1.377503699611
   target nu stat err =       0.000547471562
   target dn stat err =       0.002613163133
      target stat err =       0.002254235822
              std dev =       0.659675228200
             le_variance =       0.435171406701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466460827
  error estimate for blocks of size 2^( 2) =       0.000492174728
  error estimate for blocks of size 2^( 3) =       0.000516868643
  error estimate for blocks of size 2^( 4) =       0.000535028747
  error estimate for blocks of size 2^( 5) =       0.000546040149
  error estimate for blocks of size 2^( 6) =       0.000553862375
  error estimate for blocks of size 2^( 7) =       0.000554954977

      target function =      -0.746829079961
              le_mean =     -22.815444182344
             les_mean =     520.992708612151
             stat err =       0.000547471562
             autocorr =       1.377503699607
   target nu stat err =       0.000547471562
   target dn stat err =       0.002613163133
      target stat err =       0.002254235822
              std dev =       0.659675228200
             le_variance =       0.435171406701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435207275037
                                         uncertainty =       0.001550499722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466460827
  error estimate for blocks of size 2^( 2) =       0.000492174728
  error estimate for blocks of size 2^( 3) =       0.000516868643
  error estimate for blocks of size 2^( 4) =       0.000535028747
  error estimate for blocks of size 2^( 5) =       0.000546040149
  error estimate for blocks of size 2^( 6) =       0.000553862375
  error estimate for blocks of size 2^( 7) =       0.000554954977

      target function =      -0.746829079958
              le_mean =     -22.815444182344
             les_mean =     520.992708612155
             stat err =       0.000547471562
             autocorr =       1.377503699614
   target nu stat err =       0.000547471562
   target dn stat err =       0.002613163133
      target stat err =       0.002254235822
              std dev =       0.659675228201
             le_variance =       0.435171406702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746829079958        initial
     5.1699e+07     5.1699e+08             7.5687e-12        -0.746829079964  <--
     2.0680e+08     2.0680e+09             1.8922e-12        -0.746829079961
     8.2718e+08     8.2718e+09             4.7300e-13        -0.746829079958

*****************************************************************************
Applying the update for shift_i =   5.1699e+07     and shift_s =   5.1699e+08
*****************************************************************************

  Execution time = 4.3909e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8177
    reference variance = 0.49904
====================================================
  Execution time = 2.5215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4636e-01
  Total weights = 1.964662409e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434414458022
                                         uncertainty =       0.002070845530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434414458022
                                         uncertainty =       0.002070845530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466046552
  error estimate for blocks of size 2^( 2) =       0.000491761844
  error estimate for blocks of size 2^( 3) =       0.000516279342
  error estimate for blocks of size 2^( 4) =       0.000534231742
  error estimate for blocks of size 2^( 5) =       0.000545285398
  error estimate for blocks of size 2^( 6) =       0.000550965708
  error estimate for blocks of size 2^( 7) =       0.000553028947

      target function =      -0.748365447805
              le_mean =     -22.814763862177
             les_mean =     520.959814613854
             stat err =       0.000545877949
             autocorr =       1.371931736211
   target nu stat err =       0.000545877949
   target dn stat err =       0.002587129258
      target stat err =       0.002239528664
              std dev =       0.659089355216
             le_variance =       0.434398778159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476386218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+07, overlap shift 1.2925e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748371147479       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748371147481       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748371147481       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748371147481       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748371147481       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748371148464       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748371151777       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748371149218       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748371151901       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+07 is 2.992738e-11

solving harmonic davidson linear method for identity shift 5.1699e+07, overlap shift 5.1699e+08 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748371147479       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748371147480       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748371147480       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748371147501       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748371147480       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748371143483       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748371138969       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748371068839       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748371150261       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+07 is 7.481734e-12

solving harmonic davidson linear method for identity shift 2.0680e+08, overlap shift 2.0680e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748371147479       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748371147480       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748371147480       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748371147480       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748371147474       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748371257339       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748371268295       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748371245692       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748370953138       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+08 is 1.870369e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.038763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9749e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8742
    reference variance = 0.687743
====================================================
  Execution time = 2.4699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4384e-01
  Total weights = 1.9647e+06
  Execution time = 3.5143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464963703
  error estimate for blocks of size 2^( 2) =       0.000490861902
  error estimate for blocks of size 2^( 3) =       0.000515252273
  error estimate for blocks of size 2^( 4) =       0.000534569039
  error estimate for blocks of size 2^( 5) =       0.000546876779
  error estimate for blocks of size 2^( 6) =       0.000553408798
  error estimate for blocks of size 2^( 7) =       0.000556068708

      target function =      -0.750477373411
              le_mean =     -22.815259046557
             les_mean =     520.979889913728
             stat err =       0.000547730831
             autocorr =       1.387702186305
   target nu stat err =       0.000547730831
   target dn stat err =       0.002181687420
      target stat err =       0.001928959239
              std dev =       0.657557974685
             le_variance =       0.432382490072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464963703
  error estimate for blocks of size 2^( 2) =       0.000490861902
  error estimate for blocks of size 2^( 3) =       0.000515252273
  error estimate for blocks of size 2^( 4) =       0.000534569039
  error estimate for blocks of size 2^( 5) =       0.000546876779
  error estimate for blocks of size 2^( 6) =       0.000553408798
  error estimate for blocks of size 2^( 7) =       0.000556068708

      target function =      -0.750477373410
              le_mean =     -22.815259046557
             les_mean =     520.979889913725
             stat err =       0.000547730831
             autocorr =       1.387702186289
   target nu stat err =       0.000547730831
   target dn stat err =       0.002181687421
      target stat err =       0.001928959240
              std dev =       0.657557974684
             le_variance =       0.432382490071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464963703
  error estimate for blocks of size 2^( 2) =       0.000490861902
  error estimate for blocks of size 2^( 3) =       0.000515252273
  error estimate for blocks of size 2^( 4) =       0.000534569039
  error estimate for blocks of size 2^( 5) =       0.000546876779
  error estimate for blocks of size 2^( 6) =       0.000553408798
  error estimate for blocks of size 2^( 7) =       0.000556068708

      target function =      -0.750477373410
              le_mean =     -22.815259046557
             les_mean =     520.979889913727
             stat err =       0.000547730831
             autocorr =       1.387702186302
   target nu stat err =       0.000547730831
   target dn stat err =       0.002181687420
      target stat err =       0.001928959239
              std dev =       0.657557974685
             le_variance =       0.432382490072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432404320797
                                         uncertainty =       0.001478071770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464963703
  error estimate for blocks of size 2^( 2) =       0.000490861902
  error estimate for blocks of size 2^( 3) =       0.000515252273
  error estimate for blocks of size 2^( 4) =       0.000534569039
  error estimate for blocks of size 2^( 5) =       0.000546876779
  error estimate for blocks of size 2^( 6) =       0.000553408798
  error estimate for blocks of size 2^( 7) =       0.000556068708

      target function =      -0.750477373410
              le_mean =     -22.815259046557
             les_mean =     520.979889913728
             stat err =       0.000547730831
             autocorr =       1.387702186296
   target nu stat err =       0.000547730831
   target dn stat err =       0.002181687420
      target stat err =       0.001928959239
              std dev =       0.657557974685
             le_variance =       0.432382490072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750477373411        initial  <--
     1.2925e+07     1.2925e+08             2.9927e-11        -0.750477373410
     5.1699e+07     5.1699e+08             7.4817e-12        -0.750477373410
     2.0680e+08     2.0680e+09             1.8704e-12        -0.750477373410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2802
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.8564
    reference variance = 0.290218
====================================================
  Execution time = 2.5261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.6791e-01
  Total weights = 1.964554066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452717501776
                                         uncertainty =       0.015976798733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452717501776
                                         uncertainty =       0.015976798733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475781479
  error estimate for blocks of size 2^( 2) =       0.000501199654
  error estimate for blocks of size 2^( 3) =       0.000525170442
  error estimate for blocks of size 2^( 4) =       0.000543394470
  error estimate for blocks of size 2^( 5) =       0.000555096663
  error estimate for blocks of size 2^( 6) =       0.000560058812
  error estimate for blocks of size 2^( 7) =       0.000565487891

      target function =      -0.730612621343
              le_mean =     -22.813120429772
             les_mean =     520.906375078215
             stat err =       0.000556009459
             autocorr =       1.365681088141
   target nu stat err =       0.000556009459
   target dn stat err =       0.017326605060
      target stat err =       0.013743450354
              std dev =       0.672856620810
             le_variance =       0.452736032167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281312042977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+08, overlap shift 1.2925e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.730868568663       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.730868568664       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.730868568664       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.730868568664       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.730868568664       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.730868568664       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.730868568664       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.730868568664       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.730868568664       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.730868568664       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.730868568664       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+08 is 3.960424e-12

solving harmonic davidson linear method for identity shift 5.1699e+08, overlap shift 5.1699e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.730868568663       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.730868568664       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.730868568664       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.730868568664       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.730868568664       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.730868505944       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.730868406744       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.730868810469       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.730868568664       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.730870343571       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.730869401363       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+08 is 9.900934e-13

solving harmonic davidson linear method for identity shift 2.0680e+09, overlap shift 2.0680e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.730868568663       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.730868568663       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.730868568663       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.730868568663       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.730868278267       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.730868568663       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.730869905109       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.730868568663       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.730867938323       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.730865384511       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.730874900053       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+09 is 2.474838e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.042894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9747e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.8396
    reference variance = 0.329743
====================================================
  Execution time = 2.4660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5249e-01
  Total weights = 1.9647e+06
  Execution time = 3.5080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468054628
  error estimate for blocks of size 2^( 2) =       0.000493578964
  error estimate for blocks of size 2^( 3) =       0.000517712597
  error estimate for blocks of size 2^( 4) =       0.000536683657
  error estimate for blocks of size 2^( 5) =       0.000547703343
  error estimate for blocks of size 2^( 6) =       0.000555511515
  error estimate for blocks of size 2^( 7) =       0.000557475481

      target function =      -0.743284052387
              le_mean =     -22.815101227711
             les_mean =     520.981333292523
             stat err =       0.000549343499
             autocorr =       1.377510419731
   target nu stat err =       0.000549343499
   target dn stat err =       0.004547773906
      target stat err =       0.003788747691
              std dev =       0.661929202207
             le_variance =       0.438150268735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468054628
  error estimate for blocks of size 2^( 2) =       0.000493578964
  error estimate for blocks of size 2^( 3) =       0.000517712597
  error estimate for blocks of size 2^( 4) =       0.000536683657
  error estimate for blocks of size 2^( 5) =       0.000547703343
  error estimate for blocks of size 2^( 6) =       0.000555511515
  error estimate for blocks of size 2^( 7) =       0.000557475481

      target function =      -0.743284052386
              le_mean =     -22.815101227711
             les_mean =     520.981333292524
             stat err =       0.000549343499
             autocorr =       1.377510419723
   target nu stat err =       0.000549343499
   target dn stat err =       0.004547773905
      target stat err =       0.003788747691
              std dev =       0.661929202208
             le_variance =       0.438150268735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468054628
  error estimate for blocks of size 2^( 2) =       0.000493578964
  error estimate for blocks of size 2^( 3) =       0.000517712597
  error estimate for blocks of size 2^( 4) =       0.000536683657
  error estimate for blocks of size 2^( 5) =       0.000547703343
  error estimate for blocks of size 2^( 6) =       0.000555511515
  error estimate for blocks of size 2^( 7) =       0.000557475481

      target function =      -0.743284052386
              le_mean =     -22.815101227711
             les_mean =     520.981333292523
             stat err =       0.000549343499
             autocorr =       1.377510419723
   target nu stat err =       0.000549343499
   target dn stat err =       0.004547773905
      target stat err =       0.003788747691
              std dev =       0.661929202207
             le_variance =       0.438150268735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438203862976
                                         uncertainty =       0.003317775158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468054628
  error estimate for blocks of size 2^( 2) =       0.000493578964
  error estimate for blocks of size 2^( 3) =       0.000517712597
  error estimate for blocks of size 2^( 4) =       0.000536683657
  error estimate for blocks of size 2^( 5) =       0.000547703343
  error estimate for blocks of size 2^( 6) =       0.000555511515
  error estimate for blocks of size 2^( 7) =       0.000557475481

      target function =      -0.743284052387
              le_mean =     -22.815101227711
             les_mean =     520.981333292523
             stat err =       0.000549343499
             autocorr =       1.377510419728
   target nu stat err =       0.000549343499
   target dn stat err =       0.004547773906
      target stat err =       0.003788747691
              std dev =       0.661929202207
             le_variance =       0.438150268735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743284052387        initial  <--
     1.2925e+08     1.2925e+09             3.9604e-12        -0.743284052386
     5.1699e+08     5.1699e+09             9.9009e-13        -0.743284052386
     2.0680e+09     2.0680e+10             2.4748e-13        -0.743284052387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4687
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7791
    reference variance = 0.380473
====================================================
  Execution time = 2.5267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5092e-01
  Total weights = 1.964696060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436783949079
                                         uncertainty =       0.001894163984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436783949079
                                         uncertainty =       0.001894163984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467321840
  error estimate for blocks of size 2^( 2) =       0.000492951025
  error estimate for blocks of size 2^( 3) =       0.000517028008
  error estimate for blocks of size 2^( 4) =       0.000535681500
  error estimate for blocks of size 2^( 5) =       0.000547040010
  error estimate for blocks of size 2^( 6) =       0.000553829937
  error estimate for blocks of size 2^( 7) =       0.000557274752

      target function =      -0.744585099483
              le_mean =     -22.814314345855
             les_mean =     520.943861002598
             stat err =       0.000548456550
             autocorr =       1.377375328207
   target nu stat err =       0.000548456550
   target dn stat err =       0.002933258756
      target stat err =       0.002492699124
              std dev =       0.660892883658
             le_variance =       0.436779403670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431434585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+09, overlap shift 1.2925e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744592551560       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744592551560       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744592551560       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744592551560       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744592551558       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744592558495       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744591706317       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744590361135       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744593766468       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744590256852       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+09 is 2.494036e-13

solving harmonic davidson linear method for identity shift 5.1699e+09, overlap shift 5.1699e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744592551560       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744592551560       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744592551560       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744592647603       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744593118501       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744599433035       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744593019048       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744591050169       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744586487377       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744591288281       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744593467260       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+09 is 6.224002e-14

solving harmonic davidson linear method for identity shift 2.0680e+10, overlap shift 2.0680e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744592551560       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744592551560       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744592551560       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744592551560       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744593668250       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744590304270       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744592551560       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744587397750       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744589436845       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744555393671       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744677958934       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744528361764       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744593123001       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744622976183       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744562802368       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744630206565       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744620784297       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744572752435       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744594707593       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744572382861       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744601927255       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+10 is 1.555981e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.050159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9795e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7885
    reference variance = 0.3341
====================================================
  Execution time = 2.4565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4657e-01
  Total weights = 1.9649e+06
  Execution time = 3.5100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466882002
  error estimate for blocks of size 2^( 2) =       0.000492596207
  error estimate for blocks of size 2^( 3) =       0.000517140497
  error estimate for blocks of size 2^( 4) =       0.000535695896
  error estimate for blocks of size 2^( 5) =       0.000545741635
  error estimate for blocks of size 2^( 6) =       0.000552784295
  error estimate for blocks of size 2^( 7) =       0.000555699992

      target function =      -0.748187578947
              le_mean =     -22.814079065149
             les_mean =     520.928775133753
             stat err =       0.000547480454
             autocorr =       1.375064195106
   target nu stat err =       0.000547480454
   target dn stat err =       0.002692383850
      target stat err =       0.002321091324
              std dev =       0.660270858874
             le_variance =       0.435957607078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466882002
  error estimate for blocks of size 2^( 2) =       0.000492596207
  error estimate for blocks of size 2^( 3) =       0.000517140497
  error estimate for blocks of size 2^( 4) =       0.000535695896
  error estimate for blocks of size 2^( 5) =       0.000545741635
  error estimate for blocks of size 2^( 6) =       0.000552784295
  error estimate for blocks of size 2^( 7) =       0.000555699992

      target function =      -0.748187578948
              le_mean =     -22.814079065149
             les_mean =     520.928775133752
             stat err =       0.000547480454
             autocorr =       1.375064195106
   target nu stat err =       0.000547480454
   target dn stat err =       0.002692383850
      target stat err =       0.002321091324
              std dev =       0.660270858874
             le_variance =       0.435957607078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466882002
  error estimate for blocks of size 2^( 2) =       0.000492596207
  error estimate for blocks of size 2^( 3) =       0.000517140497
  error estimate for blocks of size 2^( 4) =       0.000535695896
  error estimate for blocks of size 2^( 5) =       0.000545741635
  error estimate for blocks of size 2^( 6) =       0.000552784295
  error estimate for blocks of size 2^( 7) =       0.000555699992

      target function =      -0.748187578948
              le_mean =     -22.814079065149
             les_mean =     520.928775133753
             stat err =       0.000547480454
             autocorr =       1.375064195119
   target nu stat err =       0.000547480454
   target dn stat err =       0.002692383850
      target stat err =       0.002321091324
              std dev =       0.660270858874
             le_variance =       0.435957607078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079216068
                                         uncertainty =       0.001987483436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466882002
  error estimate for blocks of size 2^( 2) =       0.000492596207
  error estimate for blocks of size 2^( 3) =       0.000517140497
  error estimate for blocks of size 2^( 4) =       0.000535695896
  error estimate for blocks of size 2^( 5) =       0.000545741635
  error estimate for blocks of size 2^( 6) =       0.000552784295
  error estimate for blocks of size 2^( 7) =       0.000555699992

      target function =      -0.748187578947
              le_mean =     -22.814079065149
             les_mean =     520.928775133753
             stat err =       0.000547480454
             autocorr =       1.375064195105
   target nu stat err =       0.000547480454
   target dn stat err =       0.002692383850
      target stat err =       0.002321091324
              std dev =       0.660270858874
             le_variance =       0.435957607078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748187578947        initial
     1.2925e+09     1.2925e+10             2.4940e-13        -0.748187578948  <--
     5.1699e+09     5.1699e+10             6.2240e-14        -0.748187578948
     2.0680e+10     2.0680e+11             1.5560e-14        -0.748187578947

*****************************************************************************
Applying the update for shift_i =   1.2925e+09     and shift_s =   1.2925e+10
*****************************************************************************

  Execution time = 4.2151e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8709
    reference variance = 0.494756
====================================================
  Execution time = 2.5213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4519e-01
  Total weights = 1.964608398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432769912440
                                         uncertainty =       0.001779273322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432769912440
                                         uncertainty =       0.001779273322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465193709
  error estimate for blocks of size 2^( 2) =       0.000490587262
  error estimate for blocks of size 2^( 3) =       0.000514726276
  error estimate for blocks of size 2^( 4) =       0.000533007624
  error estimate for blocks of size 2^( 5) =       0.000545119438
  error estimate for blocks of size 2^( 6) =       0.000552233049
  error estimate for blocks of size 2^( 7) =       0.000554834493

      target function =      -0.749346455285
              le_mean =     -22.814760111277
             les_mean =     520.958468430575
             stat err =       0.000546298651
             autocorr =       1.379089939614
   target nu stat err =       0.000546298651
   target dn stat err =       0.002421354414
      target stat err =       0.002112346363
              std dev =       0.657883252291
             le_variance =       0.432810373645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476011128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+08, overlap shift 3.2312e+09 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749351396349       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749351396349       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749351396349       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749351396349       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749351396349       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749351396349       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749351396349       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749351396349       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749351547237       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749351396349       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+08 is 5.446740e-13

solving harmonic davidson linear method for identity shift 1.2925e+09, overlap shift 1.2925e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749351396349       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749351396349       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749351396349       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749351396349       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749351396349       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749351396349       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749351396349       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749351396349       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749351396349       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749351396349       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+09 is 1.361686e-13

solving harmonic davidson linear method for identity shift 5.1699e+09, overlap shift 5.1699e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749351396349       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749351396349       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749351396349       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749351396349       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749351396349       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749351396349       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749351396349       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749351396349       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749351396349       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749351744217       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749351396349       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+09 is 3.396204e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.053809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9742e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8971
    reference variance = 0.380487
====================================================
  Execution time = 2.4663e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4749e-01
  Total weights = 1.9649e+06
  Execution time = 3.5192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267509
  error estimate for blocks of size 2^( 2) =       0.000490938226
  error estimate for blocks of size 2^( 3) =       0.000515050704
  error estimate for blocks of size 2^( 4) =       0.000532902386
  error estimate for blocks of size 2^( 5) =       0.000544852647
  error estimate for blocks of size 2^( 6) =       0.000550975534
  error estimate for blocks of size 2^( 7) =       0.000555032444

      target function =      -0.747419974297
              le_mean =     -22.813744892087
             les_mean =     520.914443970671
             stat err =       0.000545940753
             autocorr =       1.376846667194
   target nu stat err =       0.000545940753
   target dn stat err =       0.003373673180
      target stat err =       0.002864349191
              std dev =       0.657987620922
             le_variance =       0.432947709287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267509
  error estimate for blocks of size 2^( 2) =       0.000490938226
  error estimate for blocks of size 2^( 3) =       0.000515050704
  error estimate for blocks of size 2^( 4) =       0.000532902386
  error estimate for blocks of size 2^( 5) =       0.000544852647
  error estimate for blocks of size 2^( 6) =       0.000550975534
  error estimate for blocks of size 2^( 7) =       0.000555032444

      target function =      -0.747419974296
              le_mean =     -22.813744892087
             les_mean =     520.914443970672
             stat err =       0.000545940753
             autocorr =       1.376846667212
   target nu stat err =       0.000545940753
   target dn stat err =       0.003373673180
      target stat err =       0.002864349191
              std dev =       0.657987620922
             le_variance =       0.432947709286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267509
  error estimate for blocks of size 2^( 2) =       0.000490938226
  error estimate for blocks of size 2^( 3) =       0.000515050704
  error estimate for blocks of size 2^( 4) =       0.000532902386
  error estimate for blocks of size 2^( 5) =       0.000544852647
  error estimate for blocks of size 2^( 6) =       0.000550975534
  error estimate for blocks of size 2^( 7) =       0.000555032444

      target function =      -0.747419974297
              le_mean =     -22.813744892087
             les_mean =     520.914443970672
             stat err =       0.000545940753
             autocorr =       1.376846667205
   target nu stat err =       0.000545940753
   target dn stat err =       0.003373673180
      target stat err =       0.002864349191
              std dev =       0.657987620922
             le_variance =       0.432947709287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432978031184
                                         uncertainty =       0.001924067187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267509
  error estimate for blocks of size 2^( 2) =       0.000490938226
  error estimate for blocks of size 2^( 3) =       0.000515050704
  error estimate for blocks of size 2^( 4) =       0.000532902386
  error estimate for blocks of size 2^( 5) =       0.000544852647
  error estimate for blocks of size 2^( 6) =       0.000550975534
  error estimate for blocks of size 2^( 7) =       0.000555032444

      target function =      -0.747419974297
              le_mean =     -22.813744892087
             les_mean =     520.914443970671
             stat err =       0.000545940753
             autocorr =       1.376846667205
   target nu stat err =       0.000545940753
   target dn stat err =       0.003373673180
      target stat err =       0.002864349191
              std dev =       0.657987620922
             le_variance =       0.432947709287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747419974297        initial  <--
     3.2312e+08     3.2312e+09             5.4467e-13        -0.747419974296
     1.2925e+09     1.2925e+10             1.3617e-13        -0.747419974297
     5.1699e+09     5.1699e+10             3.3962e-14        -0.747419974297

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2948
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.857
    reference variance = 0.50666
====================================================
  Execution time = 2.7257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4456e-01
  Total weights = 1.964648200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432823269102
                                         uncertainty =       0.002089716730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432823269102
                                         uncertainty =       0.002089716730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465178193
  error estimate for blocks of size 2^( 2) =       0.000491127600
  error estimate for blocks of size 2^( 3) =       0.000515245445
  error estimate for blocks of size 2^( 4) =       0.000533938177
  error estimate for blocks of size 2^( 5) =       0.000546120106
  error estimate for blocks of size 2^( 6) =       0.000553205465
  error estimate for blocks of size 2^( 7) =       0.000556784730

      target function =      -0.749871280161
              le_mean =     -22.814758283738
             les_mean =     520.957757566285
             stat err =       0.000547512120
             autocorr =       1.385315775891
   target nu stat err =       0.000547512120
   target dn stat err =       0.002350847845
      target stat err =       0.002059169494
              std dev =       0.657861309131
             le_variance =       0.432781502052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281475828374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+09, overlap shift 3.2312e+10 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749875905652       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749875905652       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749875905652       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749875905798       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749877147122       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749874308528       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749875905652       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749881855313       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749874056299       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749880522591       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+09 is 9.226098e-14

solving harmonic davidson linear method for identity shift 1.2925e+10, overlap shift 1.2925e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749875905652       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749875905652       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749875905652       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749875016012       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749885389877       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749877073552       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749882473081       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749879239082       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749849881132       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749891546180       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749868112941       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749866861840       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749874993200       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749906914054       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749860474148       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749892042938       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749874625128       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749893567342       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749847360856       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749869603844       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749881936431       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+10 is 2.310264e-14

solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749875905652       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749875905652       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749875905652       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749864654735       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749882547149       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749840036569       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749899193681       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749885501564       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749758174227       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749866358250       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749798716217       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749912412488       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749770487085       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749851559713       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749925464611       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749866084305       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749807587760       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749871093232       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749902334920       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749925610708       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749887701407       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749779445690       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749837057753       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749914077244       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749811922875       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749821719600       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749897631084       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749779114694       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749913275610       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749871358957       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749902931055       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749867298536       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749772929191       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749954854478       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.749955399670       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749884785052       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749807992036       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749924747479       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.749906177592       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.749896494687       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749843619438       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749847033343       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.749825270128       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749808114148       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749868437859       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.749839677727       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749890522142       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749935368001       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.749949488081       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749921244331       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.749803350308       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.749920172021       residual = 4.42e-07           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.749891812513       residual = 3.25e-07           smallest_sin_value = 9.96e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+10 is 5.785389e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.117398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1845e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8277
    reference variance = 0.360201
====================================================
  Execution time = 2.4672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5091e-01
  Total weights = 1.9649e+06
  Execution time = 3.5192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325733
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325733
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467553955
  error estimate for blocks of size 2^( 2) =       0.000493378759
  error estimate for blocks of size 2^( 3) =       0.000517744018
  error estimate for blocks of size 2^( 4) =       0.000536372999
  error estimate for blocks of size 2^( 5) =       0.000547118155
  error estimate for blocks of size 2^( 6) =       0.000553393799
  error estimate for blocks of size 2^( 7) =       0.000556777026

      target function =      -0.744594037912
              le_mean =     -22.814897028538
             les_mean =     520.970436955007
             stat err =       0.000548415495
             autocorr =       1.375802089032
   target nu stat err =       0.000548415495
   target dn stat err =       0.003173706769
      target stat err =       0.002687731403
              std dev =       0.661221143763
             le_variance =       0.437213400959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325732
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325732
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467553955
  error estimate for blocks of size 2^( 2) =       0.000493378759
  error estimate for blocks of size 2^( 3) =       0.000517744018
  error estimate for blocks of size 2^( 4) =       0.000536372999
  error estimate for blocks of size 2^( 5) =       0.000547118155
  error estimate for blocks of size 2^( 6) =       0.000553393799
  error estimate for blocks of size 2^( 7) =       0.000556777026

      target function =      -0.744594037912
              le_mean =     -22.814897028538
             les_mean =     520.970436955007
             stat err =       0.000548415495
             autocorr =       1.375802089025
   target nu stat err =       0.000548415495
   target dn stat err =       0.003173706769
      target stat err =       0.002687731403
              std dev =       0.661221143763
             le_variance =       0.437213400959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325732
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325732
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467553955
  error estimate for blocks of size 2^( 2) =       0.000493378759
  error estimate for blocks of size 2^( 3) =       0.000517744018
  error estimate for blocks of size 2^( 4) =       0.000536372999
  error estimate for blocks of size 2^( 5) =       0.000547118155
  error estimate for blocks of size 2^( 6) =       0.000553393799
  error estimate for blocks of size 2^( 7) =       0.000556777026

      target function =      -0.744594037912
              le_mean =     -22.814897028538
             les_mean =     520.970436955007
             stat err =       0.000548415495
             autocorr =       1.375802089031
   target nu stat err =       0.000548415495
   target dn stat err =       0.003173706769
      target stat err =       0.002687731403
              std dev =       0.661221143763
             le_variance =       0.437213400959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325733
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437224325733
                                         uncertainty =       0.002240335978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467553955
  error estimate for blocks of size 2^( 2) =       0.000493378759
  error estimate for blocks of size 2^( 3) =       0.000517744018
  error estimate for blocks of size 2^( 4) =       0.000536372999
  error estimate for blocks of size 2^( 5) =       0.000547118155
  error estimate for blocks of size 2^( 6) =       0.000553393799
  error estimate for blocks of size 2^( 7) =       0.000556777026

      target function =      -0.744594037912
              le_mean =     -22.814897028538
             les_mean =     520.970436955007
             stat err =       0.000548415495
             autocorr =       1.375802089032
   target nu stat err =       0.000548415495
   target dn stat err =       0.003173706769
      target stat err =       0.002687731403
              std dev =       0.661221143763
             le_variance =       0.437213400959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744594037912        initial  <--
     3.2312e+09     3.2312e+10             9.2261e-14        -0.744594037912
     1.2925e+10     1.2925e+11             2.3103e-14        -0.744594037912
     5.1699e+10     5.1699e+11             5.7854e-15        -0.744594037912

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3141
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7871
    reference variance = 0.51139
====================================================
  Execution time = 2.5256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5172e-01
  Total weights = 1.964692357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439277598988
                                         uncertainty =       0.005037689423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439277598988
                                         uncertainty =       0.005037689423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468661169
  error estimate for blocks of size 2^( 2) =       0.000494594072
  error estimate for blocks of size 2^( 3) =       0.000518455637
  error estimate for blocks of size 2^( 4) =       0.000537052356
  error estimate for blocks of size 2^( 5) =       0.000549179419
  error estimate for blocks of size 2^( 6) =       0.000555490696
  error estimate for blocks of size 2^( 7) =       0.000558504468

      target function =      -0.743894819869
              le_mean =     -22.813960862712
             les_mean =     520.928534808805
             stat err =       0.000550056735
             autocorr =       1.377517200624
   target nu stat err =       0.000550056735
   target dn stat err =       0.006331903825
      target stat err =       0.005242026373
              std dev =       0.662786980961
             le_variance =       0.439286582132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281396086271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+10, overlap shift 3.2312e+11 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743931168359       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743931168359       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743931168359       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743931168358       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743920735179       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743929371523       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743930473464       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743916330074       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743951464936       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744021565048       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743948503544       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743843197264       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743953520426       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743938531768       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744014957249       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743942026835       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743899039400       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743804743106       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743951590880       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744037949380       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743899495757       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743889574738       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743895226461       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743903906128       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743926428116       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743912485438       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743925110198       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743946843198       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743956649001       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743925808650       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743938423466       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743933895072       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743933421359       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743928705231       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743914732956       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743937821168       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743922410647       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743917690921       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743925779120       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743903901395       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743931069539       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743928085085       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743930230114       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743929122666       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743922491520       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743915131816       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743935970448       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743928823079       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743932809137       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743940937137       residual = 1.14e-07           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.743955699555       residual = 9.87e-08           smallest_sin_value = 9.96e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+10 is 5.779172e-15

solving harmonic davidson linear method for identity shift 1.2925e+11, overlap shift 1.2925e+12 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743931168359       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743931168359       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743931168359       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743931168359       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743931168359       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743931167768       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743930798667       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743771184705       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743506751368       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743638057606       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743927734068       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744434980240       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743623441478       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744103365463       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744065124340       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744032662417       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743780967779       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743964157575       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743908350006       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744059478755       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743906388902       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743889549821       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743937451621       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743835250203       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744056583585       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743967750064       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743991510748       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744074924552       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743917437978       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743809223229       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743808861444       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744154908435       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744131654361       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744247002203       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743949286661       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743885901504       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743895917391       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743942478290       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744008404324       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743933222944       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743997271873       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743965108148       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743942340105       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743876111215       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743944197044       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743885934339       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.743913606307       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743884153942       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743881640920       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743776389747       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.743867985940       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.743921884727       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.743942808087       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.743960287444       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.743949919000       residual = 1.72e-06           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.743963188676       residual = 7.07e-06           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.744025605660       residual = 9.58e-06           smallest_sin_value = 9.93e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.743939947428       residual = 7.06e-06           smallest_sin_value = 9.90e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+11 is 1.442394e-15

solving harmonic davidson linear method for identity shift 5.1699e+11, overlap shift 5.1699e+12 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743931168359       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743931168359       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743931168359       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743931168359       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743931168359       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744147198209       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744333299878       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744568566577       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745328185112       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744372316882       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744097961762       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743684295578       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741736656397       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744381964288       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744316812485       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743599562550       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743029366596       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743647123548       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744425576462       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744557797618       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743751687190       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743553465323       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743978249008       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744290355565       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743962190256       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743219689024       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742748159340       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744950008629       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743707690971       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743331518549       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744397155756       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744027604744       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743601308843       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744287301106       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744427210763       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743975251272       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744616815259       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743593777744       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743828627681       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743762382807       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743434864396       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743728957382       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744227299963       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744263166175       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743525962000       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744380751764       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744600483002       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744257115974       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743347382011       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743986311728       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744108786280       residual = 3.21e-04           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744000157701       residual = 3.53e-05           smallest_sin_value = 9.94e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+11 is 3.568507e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.297148 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9956e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8234
    reference variance = 0.569007
====================================================
  Execution time = 2.4930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4544e-01
  Total weights = 1.9649e+06
  Execution time = 3.5162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465492049
  error estimate for blocks of size 2^( 2) =       0.000491521660
  error estimate for blocks of size 2^( 3) =       0.000516360028
  error estimate for blocks of size 2^( 4) =       0.000535685430
  error estimate for blocks of size 2^( 5) =       0.000547225580
  error estimate for blocks of size 2^( 6) =       0.000552589906
  error estimate for blocks of size 2^( 7) =       0.000557971653

      target function =      -0.749129772801
              le_mean =     -22.813933410037
             les_mean =     520.920997909409
             stat err =       0.000548368142
             autocorr =       1.387777682084
   target nu stat err =       0.000548368142
   target dn stat err =       0.002434723052
      target stat err =       0.002119920892
              std dev =       0.658305168274
             le_variance =       0.433365694576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465492049
  error estimate for blocks of size 2^( 2) =       0.000491521660
  error estimate for blocks of size 2^( 3) =       0.000516360028
  error estimate for blocks of size 2^( 4) =       0.000535685430
  error estimate for blocks of size 2^( 5) =       0.000547225580
  error estimate for blocks of size 2^( 6) =       0.000552589906
  error estimate for blocks of size 2^( 7) =       0.000557971653

      target function =      -0.749129772801
              le_mean =     -22.813933410037
             les_mean =     520.920997909409
             stat err =       0.000548368142
             autocorr =       1.387777682083
   target nu stat err =       0.000548368142
   target dn stat err =       0.002434723052
      target stat err =       0.002119920892
              std dev =       0.658305168274
             le_variance =       0.433365694576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465492049
  error estimate for blocks of size 2^( 2) =       0.000491521660
  error estimate for blocks of size 2^( 3) =       0.000516360028
  error estimate for blocks of size 2^( 4) =       0.000535685430
  error estimate for blocks of size 2^( 5) =       0.000547225580
  error estimate for blocks of size 2^( 6) =       0.000552589906
  error estimate for blocks of size 2^( 7) =       0.000557971653

      target function =      -0.749129772801
              le_mean =     -22.813933410037
             les_mean =     520.920997909409
             stat err =       0.000548368142
             autocorr =       1.387777682083
   target nu stat err =       0.000548368142
   target dn stat err =       0.002434723052
      target stat err =       0.002119920892
              std dev =       0.658305168274
             le_variance =       0.433365694576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433305058280
                                         uncertainty =       0.001784527212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465492049
  error estimate for blocks of size 2^( 2) =       0.000491521660
  error estimate for blocks of size 2^( 3) =       0.000516360028
  error estimate for blocks of size 2^( 4) =       0.000535685430
  error estimate for blocks of size 2^( 5) =       0.000547225580
  error estimate for blocks of size 2^( 6) =       0.000552589906
  error estimate for blocks of size 2^( 7) =       0.000557971653

      target function =      -0.749129772801
              le_mean =     -22.813933410037
             les_mean =     520.920997909409
             stat err =       0.000548368142
             autocorr =       1.387777682083
   target nu stat err =       0.000548368142
   target dn stat err =       0.002434723052
      target stat err =       0.002119920892
              std dev =       0.658305168274
             le_variance =       0.433365694576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749129772801        initial  <--
     3.2312e+10     3.2312e+11             5.7792e-15        -0.749129772801
     1.2925e+11     1.2925e+12             1.4424e-15        -0.749129772801
     5.1699e+11     5.1699e+12             3.5685e-16        -0.749129772801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5456
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.801
    reference variance = 0.338782
====================================================
  Execution time = 2.7049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5018e-01
  Total weights = 1.964830510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436223341489
                                         uncertainty =       0.002261011685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436223341489
                                         uncertainty =       0.002261011685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466992680
  error estimate for blocks of size 2^( 2) =       0.000492854308
  error estimate for blocks of size 2^( 3) =       0.000516931688
  error estimate for blocks of size 2^( 4) =       0.000535204068
  error estimate for blocks of size 2^( 5) =       0.000547576304
  error estimate for blocks of size 2^( 6) =       0.000554697294
  error estimate for blocks of size 2^( 7) =       0.000558870045

      target function =      -0.745196315718
              le_mean =     -22.814399490091
             les_mean =     520.947003791963
             stat err =       0.000549086928
             autocorr =       1.382490205322
   target nu stat err =       0.000549086928
   target dn stat err =       0.003189811234
      target stat err =       0.002703100991
              std dev =       0.660427380988
             le_variance =       0.436164325558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281439949009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+11, overlap shift 3.2312e+12 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745205053275       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745205053275       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745205053275       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745161694352       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745479606524       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745205053275       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745076787168       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745510479792       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745205053275       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745205053275       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745078599770       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744038906727       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744369464849       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745347649758       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744953812143       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745035936342       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745116068736       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744996623657       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745570754214       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745524373480       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745708345186       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745191397296       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745432591676       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744943611282       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744461721371       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744733036937       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744821547433       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744044163000       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745218450980       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745217973252       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745866732163       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745009397297       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744559033090       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745142991875       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745468773355       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745251573060       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744871798219       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745749196475       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746006843674       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745326929035       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745454808680       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744764889614       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744523616629       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744964577410       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745145068043       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744925924950       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744857563689       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744765733034       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745337958389       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.744840851195       residual = 8.58e-06           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745299732311       residual = 2.73e-05           smallest_sin_value = 9.96e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+11 is 1.395454e-15

solving harmonic davidson linear method for identity shift 1.2925e+12, overlap shift 1.2925e+13 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745205053275       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745205053275       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745205053275       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745205053275       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745397196029       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744157802094       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744132610818       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745334902609       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743507830548       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742530286700       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747749740331       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745370917756       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748513715122       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746809024664       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744806586968       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747382335493       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746658692851       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746474365334       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744488423676       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744708923708       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748334821775       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744897809219       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745443647727       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743169950144       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745606007883       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745679707798       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747469178689       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748577630432       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746260688004       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745893547781       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745040226805       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747182073655       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745082188714       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744374909915       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745891759283       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744606633199       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745153816391       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745517179030       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745104540074       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748990006252       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744832616896       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746566355909       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744999597383       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746647036362       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745946699721       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745576153991       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744188825573       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746101798081       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747533202510       residual = 8.03e-05           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.743667952427       residual = 2.16e-04           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746744869962       residual = 2.09e-04           smallest_sin_value = 9.96e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+12 is 3.167833e-16

solving harmonic davidson linear method for identity shift 5.1699e+12, overlap shift 5.1699e+13 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745205053275       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745205053275       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745205053275       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743500192765       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745302040332       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744940841249       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741690767909       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744667624186       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744917609885       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747035982992       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743806832205       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744859878923       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741663763541       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750916212003       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.732881989956       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748875857863       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750962327305       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742213254110       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736724870068       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738575778933       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738025882161       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744215606167       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741522364412       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743542671687       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.758919401851       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734862494371       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740270454039       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747858223571       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751397919151       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749994861039       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740838190167       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.759387236510       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748448511170       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.751879804012       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748208465826       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747156169088       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747442008685       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741817767347       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743661632486       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745472167098       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743451964698       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742789992977       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741793274815       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746261908931       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743254075081       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745271247421       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744766619082       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747029293907       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743551318962       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746884245033       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742801294127       residual = 1.48e-03           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.743881970561       residual = 1.27e-03           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741707754369       residual = 1.89e-03           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747752968262       residual = 1.71e-03           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.741827554825       residual = 4.89e-03           smallest_sin_value = 9.94e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.753813168203       residual = 1.47e-03           smallest_sin_value = 9.91e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.38e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+12 is 9.108439e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.466829 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1717e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.775
    reference variance = 0.375728
====================================================
  Execution time = 2.4710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4802e-01
  Total weights = 1.9648e+06
  Execution time = 3.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467012252
  error estimate for blocks of size 2^( 2) =       0.000492903673
  error estimate for blocks of size 2^( 3) =       0.000516771456
  error estimate for blocks of size 2^( 4) =       0.000535326069
  error estimate for blocks of size 2^( 5) =       0.000548223603
  error estimate for blocks of size 2^( 6) =       0.000554112884
  error estimate for blocks of size 2^( 7) =       0.000557038012

      target function =      -0.746979051873
              le_mean =     -22.813422638585
             les_mean =     520.900274430812
             stat err =       0.000548675142
             autocorr =       1.380301696483
   target nu stat err =       0.000548675142
   target dn stat err =       0.002638394000
      target stat err =       0.002268829951
              std dev =       0.660455060077
             le_variance =       0.436200886382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467012252
  error estimate for blocks of size 2^( 2) =       0.000492903673
  error estimate for blocks of size 2^( 3) =       0.000516771456
  error estimate for blocks of size 2^( 4) =       0.000535326069
  error estimate for blocks of size 2^( 5) =       0.000548223603
  error estimate for blocks of size 2^( 6) =       0.000554112884
  error estimate for blocks of size 2^( 7) =       0.000557038012

      target function =      -0.746979051873
              le_mean =     -22.813422638585
             les_mean =     520.900274430812
             stat err =       0.000548675142
             autocorr =       1.380301696486
   target nu stat err =       0.000548675142
   target dn stat err =       0.002638394000
      target stat err =       0.002268829951
              std dev =       0.660455060077
             le_variance =       0.436200886382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467012252
  error estimate for blocks of size 2^( 2) =       0.000492903673
  error estimate for blocks of size 2^( 3) =       0.000516771456
  error estimate for blocks of size 2^( 4) =       0.000535326069
  error estimate for blocks of size 2^( 5) =       0.000548223603
  error estimate for blocks of size 2^( 6) =       0.000554112884
  error estimate for blocks of size 2^( 7) =       0.000557038012

      target function =      -0.746979051873
              le_mean =     -22.813422638585
             les_mean =     520.900274430812
             stat err =       0.000548675142
             autocorr =       1.380301696483
   target nu stat err =       0.000548675142
   target dn stat err =       0.002638394000
      target stat err =       0.002268829951
              std dev =       0.660455060077
             le_variance =       0.436200886382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436179571914
                                         uncertainty =       0.002165374991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467012252
  error estimate for blocks of size 2^( 2) =       0.000492903673
  error estimate for blocks of size 2^( 3) =       0.000516771456
  error estimate for blocks of size 2^( 4) =       0.000535326069
  error estimate for blocks of size 2^( 5) =       0.000548223603
  error estimate for blocks of size 2^( 6) =       0.000554112884
  error estimate for blocks of size 2^( 7) =       0.000557038012

      target function =      -0.746979051873
              le_mean =     -22.813422638585
             les_mean =     520.900274430812
             stat err =       0.000548675142
             autocorr =       1.380301696485
   target nu stat err =       0.000548675142
   target dn stat err =       0.002638394000
      target stat err =       0.002268829951
              std dev =       0.660455060077
             le_variance =       0.436200886382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746979051873        initial
     3.2312e+11     3.2312e+12             1.3955e-15        -0.746979051873
     1.2925e+12     1.2925e+13             3.1678e-16        -0.746979051873
     5.1699e+12     5.1699e+13             9.1084e-17        -0.746979051873  <--

*****************************************************************************
Applying the update for shift_i =   5.1699e+12     and shift_s =   5.1699e+13
*****************************************************************************

  Execution time = 4.2291e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8031
    reference variance = 0.491874
====================================================
  Execution time = 2.5436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4936e-01
  Total weights = 1.964828114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435478647135
                                         uncertainty =       0.002673194233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435478647135
                                         uncertainty =       0.002673194233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466620746
  error estimate for blocks of size 2^( 2) =       0.000493067095
  error estimate for blocks of size 2^( 3) =       0.000517508428
  error estimate for blocks of size 2^( 4) =       0.000536121186
  error estimate for blocks of size 2^( 5) =       0.000548433681
  error estimate for blocks of size 2^( 6) =       0.000554261198
  error estimate for blocks of size 2^( 7) =       0.000559094935

      target function =      -0.745870931344
              le_mean =     -22.815137639737
             les_mean =     520.979862009930
             stat err =       0.000549477750
             autocorr =       1.386666856851
   target nu stat err =       0.000549477750
   target dn stat err =       0.004334375759
      target stat err =       0.003640718855
              std dev =       0.659901387492
             le_variance =       0.435469841213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281513763974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+12, overlap shift 1.2925e+13 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745887654220       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745887654220       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745887654220       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745887654220       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745887654220       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746510509113       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745877946612       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744964285129       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746013408331       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744980835000       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745160628656       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744852842621       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745686069899       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746553092055       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744811549650       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746540351649       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744911015301       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746097867664       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745522647600       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745352319383       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745183546056       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746505577634       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744672092601       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746080479714       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744809115691       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746572211082       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746201741951       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746079171689       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745442122774       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745986050376       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745403868126       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745606568247       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745850535537       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745409857166       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745024638477       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746232771308       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745816696781       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745073980465       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746092637359       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744805300340       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745650149546       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746300194971       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746254945420       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746090688048       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746291836586       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746672372453       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745868289424       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745808020423       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745640722961       residual = 1.18e-04           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746440552657       residual = 3.96e-05           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745534858870       residual = 7.49e-04           smallest_sin_value = 9.95e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.745299333101       residual = 5.34e-04           smallest_sin_value = 9.95e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.744980774769       residual = 1.12e-04           smallest_sin_value = 9.94e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+12 is 2.392037e-16

solving harmonic davidson linear method for identity shift 5.1699e+12, overlap shift 5.1699e+13 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745887654220       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745887654220       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745887654220       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745887654220       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745887654309       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745904264241       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743107749519       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749461711066       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742598773334       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741083011081       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742706977983       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746130136471       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751913865174       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747008517283       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741767053252       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746276594416       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.734230289451       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747184282713       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752799836706       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737048349176       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744974093411       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737290511425       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743558885039       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.756553388612       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742923987619       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734221174757       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744958590478       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740598514711       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751175651601       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746178961958       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751772457075       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744002370170       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742778773007       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749745383488       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744779414011       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.738312230926       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747213934905       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.751165227878       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.743015503975       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.739966787595       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747413865290       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748183721221       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741835260044       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747767030641       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745710317728       residual = 8.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748461465781       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746480531463       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.752413493406       residual = 3.62e-04           smallest_sin_value = 9.97e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750633778842       residual = 2.34e-03           smallest_sin_value = 9.90e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+12 is 6.083384e-17

solving harmonic davidson linear method for identity shift 2.0680e+13, overlap shift 2.0680e+14 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745887654220       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745887654220       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745887654220       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745887654220       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742616383202       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.757990118352       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743913626083       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.759180084345       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.717817566908       residual = 2.53e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737460966966       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725503202201       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738214452251       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.755866068398       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.725049094249       residual = 4.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.776396267774       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.704024028560       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.760009977471       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750251480038       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751329516674       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.773885068334       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.757214885455       residual = 4.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.762355797284       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.719147779728       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.758253182658       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.733318303769       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736232127699       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742475228080       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.786835353097       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.782227144456       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.759499502569       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.759440992114       residual = 4.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.734534652684       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741636895266       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740700171518       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.751867381735       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.760811820773       residual = 5.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.730744345448       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747246135125       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.751500842154       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740281217133       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.736796992738       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.757255026686       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.728836696579       residual = 7.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744865485538       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.735278747209       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.737737517402       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746943675560       residual = 7.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.730362743476       residual = 6.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750753415675       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748399067658       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.738970181154       residual = 1.71e-01           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.731221033007       residual = 1.39e-02           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.715701795899       residual = 1.62e-01           smallest_sin_value = 9.93e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750207428432       residual = 2.39e-01           smallest_sin_value = 9.90e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+13 is 1.527148e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.632654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0085e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7433
    reference variance = 0.445087
====================================================
  Execution time = 2.4661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4932e-01
  Total weights = 1.9647e+06
  Execution time = 3.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466952438
  error estimate for blocks of size 2^( 2) =       0.000493156662
  error estimate for blocks of size 2^( 3) =       0.000517819067
  error estimate for blocks of size 2^( 4) =       0.000536616108
  error estimate for blocks of size 2^( 5) =       0.000547720644
  error estimate for blocks of size 2^( 6) =       0.000553973997
  error estimate for blocks of size 2^( 7) =       0.000554667066

      target function =      -0.745910511499
              le_mean =     -22.815913571962
             les_mean =     521.015235316780
             stat err =       0.000548244454
             autocorr =       1.378488665523
   target nu stat err =       0.000548244454
   target dn stat err =       0.002688937679
      target stat err =       0.002311244760
              std dev =       0.660370470403
             le_variance =       0.436089158180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466952438
  error estimate for blocks of size 2^( 2) =       0.000493156662
  error estimate for blocks of size 2^( 3) =       0.000517819067
  error estimate for blocks of size 2^( 4) =       0.000536616108
  error estimate for blocks of size 2^( 5) =       0.000547720644
  error estimate for blocks of size 2^( 6) =       0.000553973997
  error estimate for blocks of size 2^( 7) =       0.000554667066

      target function =      -0.745910511499
              le_mean =     -22.815913571962
             les_mean =     521.015235316780
             stat err =       0.000548244454
             autocorr =       1.378488665526
   target nu stat err =       0.000548244454
   target dn stat err =       0.002688937679
      target stat err =       0.002311244760
              std dev =       0.660370470403
             le_variance =       0.436089158180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466952438
  error estimate for blocks of size 2^( 2) =       0.000493156662
  error estimate for blocks of size 2^( 3) =       0.000517819067
  error estimate for blocks of size 2^( 4) =       0.000536616108
  error estimate for blocks of size 2^( 5) =       0.000547720644
  error estimate for blocks of size 2^( 6) =       0.000553973997
  error estimate for blocks of size 2^( 7) =       0.000554667066

      target function =      -0.745910511499
              le_mean =     -22.815913571962
             les_mean =     521.015235316780
             stat err =       0.000548244454
             autocorr =       1.378488665524
   target nu stat err =       0.000548244454
   target dn stat err =       0.002688937679
      target stat err =       0.002311244760
              std dev =       0.660370470403
             le_variance =       0.436089158180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436137105765
                                         uncertainty =       0.001989370927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466952438
  error estimate for blocks of size 2^( 2) =       0.000493156662
  error estimate for blocks of size 2^( 3) =       0.000517819067
  error estimate for blocks of size 2^( 4) =       0.000536616108
  error estimate for blocks of size 2^( 5) =       0.000547720644
  error estimate for blocks of size 2^( 6) =       0.000553973997
  error estimate for blocks of size 2^( 7) =       0.000554667066

      target function =      -0.745910511499
              le_mean =     -22.815913571962
             les_mean =     521.015235316780
             stat err =       0.000548244454
             autocorr =       1.378488665526
   target nu stat err =       0.000548244454
   target dn stat err =       0.002688937679
      target stat err =       0.002311244760
              std dev =       0.660370470403
             le_variance =       0.436089158180


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745910511499        initial  <--
     1.2925e+12     1.2925e+13             2.3920e-16        -0.745910511499
     5.1699e+12     5.1699e+13             6.0834e-17        -0.745910511499
     2.0680e+13     2.0680e+14             1.5271e-17        -0.745910511499

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2841
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7898
    reference variance = 0.307543
====================================================
  Execution time = 2.7341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4897e-01
  Total weights = 1.964887850e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438162223322
                                         uncertainty =       0.002677005496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438162223322
                                         uncertainty =       0.002677005496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468027730
  error estimate for blocks of size 2^( 2) =       0.000493570846
  error estimate for blocks of size 2^( 3) =       0.000517270579
  error estimate for blocks of size 2^( 4) =       0.000535331931
  error estimate for blocks of size 2^( 5) =       0.000547169773
  error estimate for blocks of size 2^( 6) =       0.000553247730
  error estimate for blocks of size 2^( 7) =       0.000557809528

      target function =      -0.746200314128
              le_mean =     -22.814970880907
             les_mean =     520.971865915262
             stat err =       0.000548389741
             autocorr =       1.372889149305
   target nu stat err =       0.000548389741
   target dn stat err =       0.002903674200
      target stat err =       0.002481859836
              std dev =       0.661891162981
             le_variance =       0.438099911632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497088091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+13, overlap shift 1.2925e+14 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746207649708       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746207649708       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+13, overlap shift 5.1699e+14 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746207649708       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746207649708       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.0680e+14, overlap shift 2.0680e+15 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746207649708       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746207649708       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.633696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1833e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7684
    reference variance = 0.300584
====================================================
  Execution time = 2.4824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6122e-01
  Total weights = 1.9645e+06
  Execution time = 3.5124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467525388
  error estimate for blocks of size 2^( 2) =       0.000493408123
  error estimate for blocks of size 2^( 3) =       0.000517354892
  error estimate for blocks of size 2^( 4) =       0.000535649346
  error estimate for blocks of size 2^( 5) =       0.000547823171
  error estimate for blocks of size 2^( 6) =       0.000556080806
  error estimate for blocks of size 2^( 7) =       0.000560102874

      target function =      -0.736015992405
              le_mean =     -22.814064457541
             les_mean =     520.942753838787
             stat err =       0.000549914049
             autocorr =       1.383500219553
   target nu stat err =       0.000549914049
   target dn stat err =       0.014715805222
      target stat err =       0.011865213721
              std dev =       0.661180744152
             le_variance =       0.437159976438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467525388
  error estimate for blocks of size 2^( 2) =       0.000493408123
  error estimate for blocks of size 2^( 3) =       0.000517354892
  error estimate for blocks of size 2^( 4) =       0.000535649346
  error estimate for blocks of size 2^( 5) =       0.000547823171
  error estimate for blocks of size 2^( 6) =       0.000556080806
  error estimate for blocks of size 2^( 7) =       0.000560102874

      target function =      -0.736015992405
              le_mean =     -22.814064457541
             les_mean =     520.942753838787
             stat err =       0.000549914049
             autocorr =       1.383500219553
   target nu stat err =       0.000549914049
   target dn stat err =       0.014715805222
      target stat err =       0.011865213721
              std dev =       0.661180744152
             le_variance =       0.437159976438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467525388
  error estimate for blocks of size 2^( 2) =       0.000493408123
  error estimate for blocks of size 2^( 3) =       0.000517354892
  error estimate for blocks of size 2^( 4) =       0.000535649346
  error estimate for blocks of size 2^( 5) =       0.000547823171
  error estimate for blocks of size 2^( 6) =       0.000556080806
  error estimate for blocks of size 2^( 7) =       0.000560102874

      target function =      -0.736015992405
              le_mean =     -22.814064457541
             les_mean =     520.942753838787
             stat err =       0.000549914049
             autocorr =       1.383500219553
   target nu stat err =       0.000549914049
   target dn stat err =       0.014715805222
      target stat err =       0.011865213721
              std dev =       0.661180744152
             le_variance =       0.437159976438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437190394870
                                         uncertainty =       0.003790336684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467525388
  error estimate for blocks of size 2^( 2) =       0.000493408123
  error estimate for blocks of size 2^( 3) =       0.000517354892
  error estimate for blocks of size 2^( 4) =       0.000535649346
  error estimate for blocks of size 2^( 5) =       0.000547823171
  error estimate for blocks of size 2^( 6) =       0.000556080806
  error estimate for blocks of size 2^( 7) =       0.000560102874

      target function =      -0.736015992405
              le_mean =     -22.814064457541
             les_mean =     520.942753838787
             stat err =       0.000549914049
             autocorr =       1.383500219553
   target nu stat err =       0.000549914049
   target dn stat err =       0.014715805222
      target stat err =       0.011865213721
              std dev =       0.661180744152
             le_variance =       0.437159976438


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736015992405        initial  <--
     1.2925e+13     1.2925e+14             0.0000e+00        -0.736015992405
     5.1699e+13     5.1699e+14             0.0000e+00        -0.736015992405
     2.0680e+14     2.0680e+15             0.0000e+00        -0.736015992405

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4249
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8318
    reference variance = 0.466659
====================================================
  Execution time = 2.5176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5368e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5023e-01
  Total weights = 1.964843900e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435559300515
                                         uncertainty =       0.002010992416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435559300515
                                         uncertainty =       0.002010992416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466704821
  error estimate for blocks of size 2^( 2) =       0.000492536177
  error estimate for blocks of size 2^( 3) =       0.000516644387
  error estimate for blocks of size 2^( 4) =       0.000535635568
  error estimate for blocks of size 2^( 5) =       0.000547584984
  error estimate for blocks of size 2^( 6) =       0.000554374139
  error estimate for blocks of size 2^( 7) =       0.000560418681

      target function =      -0.745151426414
              le_mean =     -22.813486713285
             les_mean =     520.905408586959
             stat err =       0.000549503343
             autocorr =       1.386296428304
   target nu stat err =       0.000549503343
   target dn stat err =       0.002855853625
      target stat err =       0.002431751246
              std dev =       0.660020286871
             le_variance =       0.435626779081


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281348671328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+14, overlap shift 1.2925e+15 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745158344624       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745158344624       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+14, overlap shift 5.1699e+15 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745158344624       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745158344624       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.0680e+15, overlap shift 2.0680e+16 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745158344624       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745158344624       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.634760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9706e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.7319
    reference variance = 0.356421
====================================================
  Execution time = 2.4727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5250e-01
  Total weights = 1.9650e+06
  Execution time = 3.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537758
  error estimate for blocks of size 2^( 2) =       0.000493611330
  error estimate for blocks of size 2^( 3) =       0.000517658002
  error estimate for blocks of size 2^( 4) =       0.000535493135
  error estimate for blocks of size 2^( 5) =       0.000546486638
  error estimate for blocks of size 2^( 6) =       0.000551970179
  error estimate for blocks of size 2^( 7) =       0.000556497416

      target function =      -0.743285632981
              le_mean =     -22.813749949084
             les_mean =     520.919684352434
             stat err =       0.000547611842
             autocorr =       1.371867860940
   target nu stat err =       0.000547611842
   target dn stat err =       0.003447490533
      target stat err =       0.002893084253
              std dev =       0.661198238247
             le_variance =       0.437183110261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537758
  error estimate for blocks of size 2^( 2) =       0.000493611330
  error estimate for blocks of size 2^( 3) =       0.000517658002
  error estimate for blocks of size 2^( 4) =       0.000535493135
  error estimate for blocks of size 2^( 5) =       0.000546486638
  error estimate for blocks of size 2^( 6) =       0.000551970179
  error estimate for blocks of size 2^( 7) =       0.000556497416

      target function =      -0.743285632981
              le_mean =     -22.813749949084
             les_mean =     520.919684352434
             stat err =       0.000547611842
             autocorr =       1.371867860940
   target nu stat err =       0.000547611842
   target dn stat err =       0.003447490533
      target stat err =       0.002893084253
              std dev =       0.661198238247
             le_variance =       0.437183110261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537758
  error estimate for blocks of size 2^( 2) =       0.000493611330
  error estimate for blocks of size 2^( 3) =       0.000517658002
  error estimate for blocks of size 2^( 4) =       0.000535493135
  error estimate for blocks of size 2^( 5) =       0.000546486638
  error estimate for blocks of size 2^( 6) =       0.000551970179
  error estimate for blocks of size 2^( 7) =       0.000556497416

      target function =      -0.743285632981
              le_mean =     -22.813749949084
             les_mean =     520.919684352434
             stat err =       0.000547611842
             autocorr =       1.371867860940
   target nu stat err =       0.000547611842
   target dn stat err =       0.003447490533
      target stat err =       0.002893084253
              std dev =       0.661198238247
             le_variance =       0.437183110261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437211068656
                                         uncertainty =       0.002000905405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537758
  error estimate for blocks of size 2^( 2) =       0.000493611330
  error estimate for blocks of size 2^( 3) =       0.000517658002
  error estimate for blocks of size 2^( 4) =       0.000535493135
  error estimate for blocks of size 2^( 5) =       0.000546486638
  error estimate for blocks of size 2^( 6) =       0.000551970179
  error estimate for blocks of size 2^( 7) =       0.000556497416

      target function =      -0.743285632981
              le_mean =     -22.813749949084
             les_mean =     520.919684352434
             stat err =       0.000547611842
             autocorr =       1.371867860940
   target nu stat err =       0.000547611842
   target dn stat err =       0.003447490533
      target stat err =       0.002893084253
              std dev =       0.661198238247
             le_variance =       0.437183110261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743285632981        initial  <--
     1.2925e+14     1.2925e+15             0.0000e+00        -0.743285632981
     5.1699e+14     5.1699e+15             0.0000e+00        -0.743285632981
     2.0680e+15     2.0680e+16             0.0000e+00        -0.743285632981

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3236
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8176
    reference variance = 0.353159
====================================================
  Execution time = 2.7184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5802e-01
  Total weights = 1.964949064e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437764872283
                                         uncertainty =       0.002142514979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437764872283
                                         uncertainty =       0.002142514979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467805594
  error estimate for blocks of size 2^( 2) =       0.000493469229
  error estimate for blocks of size 2^( 3) =       0.000517490302
  error estimate for blocks of size 2^( 4) =       0.000535463173
  error estimate for blocks of size 2^( 5) =       0.000547400256
  error estimate for blocks of size 2^( 6) =       0.000553489894
  error estimate for blocks of size 2^( 7) =       0.000557227689

      target function =      -0.738732529346
              le_mean =     -22.814294959688
             les_mean =     520.950069681700
             stat err =       0.000548395253
             autocorr =       1.374220910953
   target nu stat err =       0.000548395253
   target dn stat err =       0.008200812909
      target stat err =       0.006680873698
              std dev =       0.661577015335
             le_variance =       0.437684147219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429495969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+15, overlap shift 1.2925e+16 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738791806222       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738791806222       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738791806222       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879944090418       residual = 3.43e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738791806277       residual = 5.85e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738791824182       residual = 4.49e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.105678181732       residual = 4.78e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.126682234649       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.873991036831       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       2.952709943930       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.128634889171       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.984062917700       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -3.476656749209       residual = 7.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.166496201082       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.706311474893       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.454972519431       residual = 3.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902737338213       residual = 3.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749284951803       residual = 7.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.856545178638       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       0.512762839576       residual = 2.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.099756739740       residual = 6.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.024362457874       residual = 6.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952286195451       residual = 1.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.387543115428       residual = 2.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.930808046144       residual = 2.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -3.474294410860       residual = 1.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.517389206803       residual = 8.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.389213448064       residual = 1.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.590635238548       residual = 7.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.859600462643       residual = 3.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.266240330234       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.027836855339       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -2.804471097593       residual = 6.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.619855307028       residual = 1.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -3.032641015923       residual = 5.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -4.324685572646       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.658117206219       residual = 4.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.742758745762       residual = 2.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.888463353296       residual = 7.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.061994264069       residual = 4.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.679259606299       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       3.022248439816       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.760389987665       residual = 4.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.038655511075       residual = 4.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.108988432611       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -2.243911028390       residual = 6.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       2.777739571400       residual = 5.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -2.814315722453       residual = 1.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =       1.967588769164       residual = 1.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =       3.123979588457       residual = 1.57e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.687389449272       residual = 2.84e+03           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =       0.527978321053       residual = 1.70e+03           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =       0.938780730220       residual = 2.05e+03           smallest_sin_value = 9.95e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -2.863518624061       residual = 9.55e+02           smallest_sin_value = 9.95e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+15 is 1.764997e-19

solving harmonic davidson linear method for identity shift 5.1699e+15, overlap shift 5.1699e+16 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738791806222       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738791806222       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738791806222       residual = 8.89e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738791806223       residual = 6.57e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738791806211       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -2.085277006130       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -2.371528314920       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.022055623017       residual = 8.48e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -4.222489303842       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.551130638854       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       1.510759604548       residual = 5.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -8.757509656561       residual = 6.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =     -10.716403322514       residual = 9.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -2.202612180243       residual = 2.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.974080205854       residual = 8.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       4.154656312200       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.507417554783       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       0.518421726283       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -2.482710728119       residual = 7.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -7.509369175722       residual = 2.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       2.701271267628       residual = 3.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -7.296873207110       residual = 4.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       2.400653158094       residual = 7.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   23 stopping due to too large eigenvalue change
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+15 is 3.052720e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+16, overlap shift 2.0680e+17 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738791806222       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738791806222       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738791806222       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738791806222       residual = 3.12e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.343175097398       residual = 4.42e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738791806291       residual = 2.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -6.401933948881       residual = 3.87e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.950877794561       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+16 is 7.631800e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.704426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1730e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.9313
    reference variance = 0.515574
====================================================
  Execution time = 2.4715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4397e-01
  Total weights = 1.9649e+06
  Execution time = 3.5134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465177859
  error estimate for blocks of size 2^( 2) =       0.000490993879
  error estimate for blocks of size 2^( 3) =       0.000514535196
  error estimate for blocks of size 2^( 4) =       0.000532190457
  error estimate for blocks of size 2^( 5) =       0.000544278062
  error estimate for blocks of size 2^( 6) =       0.000549927363
  error estimate for blocks of size 2^( 7) =       0.000552431045

      target function =      -0.750370103371
              le_mean =     -22.814786677165
             les_mean =     520.958457570070
             stat err =       0.000544706732
             autocorr =       1.371157719336
   target nu stat err =       0.000544706732
   target dn stat err =       0.002351517028
      target stat err =       0.002061485934
              std dev =       0.657860837774
             le_variance =       0.432780881877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465177859
  error estimate for blocks of size 2^( 2) =       0.000490993879
  error estimate for blocks of size 2^( 3) =       0.000514535196
  error estimate for blocks of size 2^( 4) =       0.000532190457
  error estimate for blocks of size 2^( 5) =       0.000544278062
  error estimate for blocks of size 2^( 6) =       0.000549927363
  error estimate for blocks of size 2^( 7) =       0.000552431045

      target function =      -0.750370103371
              le_mean =     -22.814786677165
             les_mean =     520.958457570070
             stat err =       0.000544706732
             autocorr =       1.371157719336
   target nu stat err =       0.000544706732
   target dn stat err =       0.002351517028
      target stat err =       0.002061485934
              std dev =       0.657860837774
             le_variance =       0.432780881877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465177859
  error estimate for blocks of size 2^( 2) =       0.000490993879
  error estimate for blocks of size 2^( 3) =       0.000514535196
  error estimate for blocks of size 2^( 4) =       0.000532190457
  error estimate for blocks of size 2^( 5) =       0.000544278062
  error estimate for blocks of size 2^( 6) =       0.000549927363
  error estimate for blocks of size 2^( 7) =       0.000552431045

      target function =      -0.750370103371
              le_mean =     -22.814786677165
             les_mean =     520.958457570070
             stat err =       0.000544706732
             autocorr =       1.371157719336
   target nu stat err =       0.000544706732
   target dn stat err =       0.002351517028
      target stat err =       0.002061485934
              std dev =       0.657860837774
             le_variance =       0.432780881877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432780737576
                                         uncertainty =       0.001924533710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465177859
  error estimate for blocks of size 2^( 2) =       0.000490993879
  error estimate for blocks of size 2^( 3) =       0.000514535196
  error estimate for blocks of size 2^( 4) =       0.000532190457
  error estimate for blocks of size 2^( 5) =       0.000544278062
  error estimate for blocks of size 2^( 6) =       0.000549927363
  error estimate for blocks of size 2^( 7) =       0.000552431045

      target function =      -0.750370103371
              le_mean =     -22.814786677165
             les_mean =     520.958457570070
             stat err =       0.000544706732
             autocorr =       1.371157719336
   target nu stat err =       0.000544706732
   target dn stat err =       0.002351517028
      target stat err =       0.002061485934
              std dev =       0.657860837774
             le_variance =       0.432780881877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750370103371        initial  <--
     1.2925e+15     1.2925e+16             1.7650e-19        -0.750370103371
     5.1699e+15     5.1699e+16             3.0527e-20        -0.750370103371
     2.0680e+16     2.0680e+17             7.6318e-21        -0.750370103371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2932
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8887
    reference variance = 1.86424
====================================================
  Execution time = 2.5307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5009e-01
  Total weights = 1.964894695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435670647538
                                         uncertainty =       0.002148979014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435670647538
                                         uncertainty =       0.002148979014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466761742
  error estimate for blocks of size 2^( 2) =       0.000492383446
  error estimate for blocks of size 2^( 3) =       0.000516727473
  error estimate for blocks of size 2^( 4) =       0.000534801576
  error estimate for blocks of size 2^( 5) =       0.000545951008
  error estimate for blocks of size 2^( 6) =       0.000552739395
  error estimate for blocks of size 2^( 7) =       0.000556285122

      target function =      -0.745267424821
              le_mean =     -22.813822625042
             les_mean =     520.920592648188
             stat err =       0.000547444275
             autocorr =       1.375591023047
   target nu stat err =       0.000547444275
   target dn stat err =       0.003377886692
      target stat err =       0.002852322984
              std dev =       0.660100785909
             le_variance =       0.435733047558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281382262504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+16, overlap shift 1.2925e+17 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745277347195       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745277347195       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.06e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+16, overlap shift 5.1699e+17 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745277347195       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745277347195       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.06e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.0680e+17, overlap shift 2.0680e+18 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745277347195       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745277347195       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.06e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.705491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9851e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7545
    reference variance = 0.475547
====================================================
  Execution time = 2.4821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4788e-01
  Total weights = 1.9649e+06
  Execution time = 3.5044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467190804
  error estimate for blocks of size 2^( 2) =       0.000492700561
  error estimate for blocks of size 2^( 3) =       0.000517886038
  error estimate for blocks of size 2^( 4) =       0.000535791318
  error estimate for blocks of size 2^( 5) =       0.000545108758
  error estimate for blocks of size 2^( 6) =       0.000552107197
  error estimate for blocks of size 2^( 7) =       0.000559483098

      target function =      -0.747100631770
              le_mean =     -22.814642938906
             les_mean =     520.955815303125
             stat err =       0.000548122593
             autocorr =       1.376470267347
   target nu stat err =       0.000548122593
   target dn stat err =       0.002846775226
      target stat err =       0.002440613985
              std dev =       0.660707571708
             le_variance =       0.436534495312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467190804
  error estimate for blocks of size 2^( 2) =       0.000492700561
  error estimate for blocks of size 2^( 3) =       0.000517886038
  error estimate for blocks of size 2^( 4) =       0.000535791318
  error estimate for blocks of size 2^( 5) =       0.000545108758
  error estimate for blocks of size 2^( 6) =       0.000552107197
  error estimate for blocks of size 2^( 7) =       0.000559483098

      target function =      -0.747100631770
              le_mean =     -22.814642938906
             les_mean =     520.955815303125
             stat err =       0.000548122593
             autocorr =       1.376470267347
   target nu stat err =       0.000548122593
   target dn stat err =       0.002846775226
      target stat err =       0.002440613985
              std dev =       0.660707571708
             le_variance =       0.436534495312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467190804
  error estimate for blocks of size 2^( 2) =       0.000492700561
  error estimate for blocks of size 2^( 3) =       0.000517886038
  error estimate for blocks of size 2^( 4) =       0.000535791318
  error estimate for blocks of size 2^( 5) =       0.000545108758
  error estimate for blocks of size 2^( 6) =       0.000552107197
  error estimate for blocks of size 2^( 7) =       0.000559483098

      target function =      -0.747100631770
              le_mean =     -22.814642938906
             les_mean =     520.955815303125
             stat err =       0.000548122593
             autocorr =       1.376470267347
   target nu stat err =       0.000548122593
   target dn stat err =       0.002846775226
      target stat err =       0.002440613985
              std dev =       0.660707571708
             le_variance =       0.436534495312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436486187291
                                         uncertainty =       0.002167585107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467190804
  error estimate for blocks of size 2^( 2) =       0.000492700561
  error estimate for blocks of size 2^( 3) =       0.000517886038
  error estimate for blocks of size 2^( 4) =       0.000535791318
  error estimate for blocks of size 2^( 5) =       0.000545108758
  error estimate for blocks of size 2^( 6) =       0.000552107197
  error estimate for blocks of size 2^( 7) =       0.000559483098

      target function =      -0.747100631770
              le_mean =     -22.814642938906
             les_mean =     520.955815303125
             stat err =       0.000548122593
             autocorr =       1.376470267347
   target nu stat err =       0.000548122593
   target dn stat err =       0.002846775226
      target stat err =       0.002440613985
              std dev =       0.660707571708
             le_variance =       0.436534495312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747100631770        initial  <--
     1.2925e+16     1.2925e+17             0.0000e+00        -0.747100631770
     5.1699e+16     5.1699e+17             0.0000e+00        -0.747100631770
     2.0680e+17     2.0680e+18             0.0000e+00        -0.747100631770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3613
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8852
    reference variance = 0.311885
====================================================
  Execution time = 2.7420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5104e-01
  Total weights = 1.964517033e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439073038411
                                         uncertainty =       0.003012606196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439073038411
                                         uncertainty =       0.003012606196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468517929
  error estimate for blocks of size 2^( 2) =       0.000494464914
  error estimate for blocks of size 2^( 3) =       0.000518584198
  error estimate for blocks of size 2^( 4) =       0.000537648295
  error estimate for blocks of size 2^( 5) =       0.000549076266
  error estimate for blocks of size 2^( 6) =       0.000555215212
  error estimate for blocks of size 2^( 7) =       0.000559044492

      target function =      -0.744478160501
              le_mean =     -22.814494783618
             les_mean =     520.952213667020
             stat err =       0.000550246066
             autocorr =       1.379308662913
   target nu stat err =       0.000550246066
   target dn stat err =       0.004271983796
      target stat err =       0.003573316595
              std dev =       0.662584408770
             le_variance =       0.439018098745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281449478362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+17, overlap shift 1.2925e+18 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744494355046       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744494355046       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.02e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+17, overlap shift 5.1699e+18 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744494355046       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744494355046       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.02e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.0680e+18, overlap shift 2.0680e+19 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744494355046       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744494355046       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.706562 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1931e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8836
    reference variance = 0.242006
====================================================
  Execution time = 2.4961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4549e-01
  Total weights = 1.9648e+06
  Execution time = 3.5423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465686262
  error estimate for blocks of size 2^( 2) =       0.000491608646
  error estimate for blocks of size 2^( 3) =       0.000516328317
  error estimate for blocks of size 2^( 4) =       0.000534987574
  error estimate for blocks of size 2^( 5) =       0.000547118128
  error estimate for blocks of size 2^( 6) =       0.000554343764
  error estimate for blocks of size 2^( 7) =       0.000556120993

      target function =      -0.749085498311
              le_mean =     -22.813754694746
             les_mean =     520.912893379511
             stat err =       0.000548142615
             autocorr =       1.385480067756
   target nu stat err =       0.000548142615
   target dn stat err =       0.002662223493
      target stat err =       0.002301296140
              std dev =       0.658579827030
             le_variance =       0.433727388571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465686262
  error estimate for blocks of size 2^( 2) =       0.000491608646
  error estimate for blocks of size 2^( 3) =       0.000516328317
  error estimate for blocks of size 2^( 4) =       0.000534987574
  error estimate for blocks of size 2^( 5) =       0.000547118128
  error estimate for blocks of size 2^( 6) =       0.000554343764
  error estimate for blocks of size 2^( 7) =       0.000556120993

      target function =      -0.749085498311
              le_mean =     -22.813754694746
             les_mean =     520.912893379511
             stat err =       0.000548142615
             autocorr =       1.385480067756
   target nu stat err =       0.000548142615
   target dn stat err =       0.002662223493
      target stat err =       0.002301296140
              std dev =       0.658579827030
             le_variance =       0.433727388571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465686262
  error estimate for blocks of size 2^( 2) =       0.000491608646
  error estimate for blocks of size 2^( 3) =       0.000516328317
  error estimate for blocks of size 2^( 4) =       0.000534987574
  error estimate for blocks of size 2^( 5) =       0.000547118128
  error estimate for blocks of size 2^( 6) =       0.000554343764
  error estimate for blocks of size 2^( 7) =       0.000556120993

      target function =      -0.749085498311
              le_mean =     -22.813754694746
             les_mean =     520.912893379511
             stat err =       0.000548142615
             autocorr =       1.385480067756
   target nu stat err =       0.000548142615
   target dn stat err =       0.002662223493
      target stat err =       0.002301296140
              std dev =       0.658579827030
             le_variance =       0.433727388571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433767704643
                                         uncertainty =       0.002024124169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465686262
  error estimate for blocks of size 2^( 2) =       0.000491608646
  error estimate for blocks of size 2^( 3) =       0.000516328317
  error estimate for blocks of size 2^( 4) =       0.000534987574
  error estimate for blocks of size 2^( 5) =       0.000547118128
  error estimate for blocks of size 2^( 6) =       0.000554343764
  error estimate for blocks of size 2^( 7) =       0.000556120993

      target function =      -0.749085498311
              le_mean =     -22.813754694746
             les_mean =     520.912893379511
             stat err =       0.000548142615
             autocorr =       1.385480067756
   target nu stat err =       0.000548142615
   target dn stat err =       0.002662223493
      target stat err =       0.002301296140
              std dev =       0.658579827030
             le_variance =       0.433727388571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749085498311        initial  <--
     1.2925e+17     1.2925e+18             0.0000e+00        -0.749085498311
     5.1699e+17     5.1699e+18             0.0000e+00        -0.749085498311
     2.0680e+18     2.0680e+19             0.0000e+00        -0.749085498311

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6271
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8159
    reference variance = 0.4583
====================================================
  Execution time = 2.5621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4783e-01
  Total weights = 1.964722676e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434134038434
                                         uncertainty =       0.002046211424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434134038434
                                         uncertainty =       0.002046211424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465917344
  error estimate for blocks of size 2^( 2) =       0.000491780669
  error estimate for blocks of size 2^( 3) =       0.000516304914
  error estimate for blocks of size 2^( 4) =       0.000534814921
  error estimate for blocks of size 2^( 5) =       0.000546606482
  error estimate for blocks of size 2^( 6) =       0.000552987189
  error estimate for blocks of size 2^( 7) =       0.000556177321

      target function =      -0.747146309538
              le_mean =     -22.814660639020
             les_mean =     520.956569182194
             stat err =       0.000547646478
             autocorr =       1.381601647601
   target nu stat err =       0.000547646478
   target dn stat err =       0.002661266036
      target stat err =       0.002291987190
              std dev =       0.658906627454
             le_variance =       0.434157943703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281466063902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+18, overlap shift 1.2925e+19 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747152369018       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747152369018       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.1699e+18, overlap shift 5.1699e+19 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747152369018       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747152369018       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.0680e+19, overlap shift 2.0680e+20 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747152369018       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747152369018       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.707627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0146e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.918
    reference variance = 0.423458
====================================================
  Execution time = 2.5041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5224e-01
  Total weights = 1.9647e+06
  Execution time = 3.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468754863
  error estimate for blocks of size 2^( 2) =       0.000494385492
  error estimate for blocks of size 2^( 3) =       0.000518493204
  error estimate for blocks of size 2^( 4) =       0.000535951388
  error estimate for blocks of size 2^( 5) =       0.000547859244
  error estimate for blocks of size 2^( 6) =       0.000554891467
  error estimate for blocks of size 2^( 7) =       0.000558134355

      target function =      -0.743486385631
              le_mean =     -22.814656537036
             les_mean =     520.960796162937
             stat err =       0.000549209114
             autocorr =       1.372726121838
   target nu stat err =       0.000549209114
   target dn stat err =       0.004580602093
      target stat err =       0.003814899616
              std dev =       0.662919484760
             le_variance =       0.439462243275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468754863
  error estimate for blocks of size 2^( 2) =       0.000494385492
  error estimate for blocks of size 2^( 3) =       0.000518493204
  error estimate for blocks of size 2^( 4) =       0.000535951388
  error estimate for blocks of size 2^( 5) =       0.000547859244
  error estimate for blocks of size 2^( 6) =       0.000554891467
  error estimate for blocks of size 2^( 7) =       0.000558134355

      target function =      -0.743486385631
              le_mean =     -22.814656537036
             les_mean =     520.960796162937
             stat err =       0.000549209114
             autocorr =       1.372726121834
   target nu stat err =       0.000549209114
   target dn stat err =       0.004580602093
      target stat err =       0.003814899616
              std dev =       0.662919484760
             le_variance =       0.439462243275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468754863
  error estimate for blocks of size 2^( 2) =       0.000494385492
  error estimate for blocks of size 2^( 3) =       0.000518493204
  error estimate for blocks of size 2^( 4) =       0.000535951388
  error estimate for blocks of size 2^( 5) =       0.000547859244
  error estimate for blocks of size 2^( 6) =       0.000554891467
  error estimate for blocks of size 2^( 7) =       0.000558134355

      target function =      -0.743486385631
              le_mean =     -22.814656537036
             les_mean =     520.960796162937
             stat err =       0.000549209114
             autocorr =       1.372726121834
   target nu stat err =       0.000549209114
   target dn stat err =       0.004580602093
      target stat err =       0.003814899616
              std dev =       0.662919484760
             le_variance =       0.439462243275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439274981887
                                         uncertainty =       0.003844849032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468754863
  error estimate for blocks of size 2^( 2) =       0.000494385492
  error estimate for blocks of size 2^( 3) =       0.000518493204
  error estimate for blocks of size 2^( 4) =       0.000535951388
  error estimate for blocks of size 2^( 5) =       0.000547859244
  error estimate for blocks of size 2^( 6) =       0.000554891467
  error estimate for blocks of size 2^( 7) =       0.000558134355

      target function =      -0.743486385631
              le_mean =     -22.814656537036
             les_mean =     520.960796162937
             stat err =       0.000549209114
             autocorr =       1.372726121834
   target nu stat err =       0.000549209114
   target dn stat err =       0.004580602093
      target stat err =       0.003814899616
              std dev =       0.662919484760
             le_variance =       0.439462243275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743486385631        initial  <--
     1.2925e+18     1.2925e+19             0.0000e+00        -0.743486385631
     5.1699e+18     5.1699e+19             0.0000e+00        -0.743486385631
     2.0680e+19     2.0680e+20             0.0000e+00        -0.743486385631

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5987
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8971
    reference variance = 0.302774
====================================================
  Execution time = 2.7749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6352e-01
  Total weights = 1.965002034e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435591803441
                                         uncertainty =       0.002077070552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435591803441
                                         uncertainty =       0.002077070552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466659017
  error estimate for blocks of size 2^( 2) =       0.000492302468
  error estimate for blocks of size 2^( 3) =       0.000516753017
  error estimate for blocks of size 2^( 4) =       0.000534680317
  error estimate for blocks of size 2^( 5) =       0.000547127656
  error estimate for blocks of size 2^( 6) =       0.000555471526
  error estimate for blocks of size 2^( 7) =       0.000559891336

      target function =      -0.734196400742
              le_mean =     -22.814458040435
             les_mean =     520.963013736987
             stat err =       0.000549292709
             autocorr =       1.385505790402
   target nu stat err =       0.000549292709
   target dn stat err =       0.013327215557
      target stat err =       0.010701363717
              std dev =       0.659955510562
             le_variance =       0.435541275921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281445804044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+19, overlap shift 1.2925e+20 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734351376258       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734351376258       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+19, overlap shift 5.1699e+20 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734351376258       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734351376258       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+20, overlap shift 2.0680e+21 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734351376258       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734351376258       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.708707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2294e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8111
    reference variance = 0.327637
====================================================
  Execution time = 2.5133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4631e-01
  Total weights = 1.9650e+06
  Execution time = 3.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102858
  error estimate for blocks of size 2^( 2) =       0.000491775130
  error estimate for blocks of size 2^( 3) =       0.000516278837
  error estimate for blocks of size 2^( 4) =       0.000534392499
  error estimate for blocks of size 2^( 5) =       0.000544987418
  error estimate for blocks of size 2^( 6) =       0.000552227549
  error estimate for blocks of size 2^( 7) =       0.000555186864

      target function =      -0.748399670973
              le_mean =     -22.813447375237
             les_mean =     520.899686965722
             stat err =       0.000546698583
             autocorr =       1.375727328970
   target nu stat err =       0.000546698583
   target dn stat err =       0.003373017427
      target stat err =       0.002870071198
              std dev =       0.659168982723
             le_variance =       0.434503747784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102858
  error estimate for blocks of size 2^( 2) =       0.000491775130
  error estimate for blocks of size 2^( 3) =       0.000516278837
  error estimate for blocks of size 2^( 4) =       0.000534392499
  error estimate for blocks of size 2^( 5) =       0.000544987418
  error estimate for blocks of size 2^( 6) =       0.000552227549
  error estimate for blocks of size 2^( 7) =       0.000555186864

      target function =      -0.748399670973
              le_mean =     -22.813447375237
             les_mean =     520.899686965722
             stat err =       0.000546698583
             autocorr =       1.375727328970
   target nu stat err =       0.000546698583
   target dn stat err =       0.003373017427
      target stat err =       0.002870071198
              std dev =       0.659168982723
             le_variance =       0.434503747784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102858
  error estimate for blocks of size 2^( 2) =       0.000491775130
  error estimate for blocks of size 2^( 3) =       0.000516278837
  error estimate for blocks of size 2^( 4) =       0.000534392499
  error estimate for blocks of size 2^( 5) =       0.000544987418
  error estimate for blocks of size 2^( 6) =       0.000552227549
  error estimate for blocks of size 2^( 7) =       0.000555186864

      target function =      -0.748399670973
              le_mean =     -22.813447375237
             les_mean =     520.899686965722
             stat err =       0.000546698583
             autocorr =       1.375727328970
   target nu stat err =       0.000546698583
   target dn stat err =       0.003373017427
      target stat err =       0.002870071198
              std dev =       0.659168982723
             le_variance =       0.434503747784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434536612547
                                         uncertainty =       0.002711019750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102858
  error estimate for blocks of size 2^( 2) =       0.000491775130
  error estimate for blocks of size 2^( 3) =       0.000516278837
  error estimate for blocks of size 2^( 4) =       0.000534392499
  error estimate for blocks of size 2^( 5) =       0.000544987418
  error estimate for blocks of size 2^( 6) =       0.000552227549
  error estimate for blocks of size 2^( 7) =       0.000555186864

      target function =      -0.748399670973
              le_mean =     -22.813447375237
             les_mean =     520.899686965722
             stat err =       0.000546698583
             autocorr =       1.375727328970
   target nu stat err =       0.000546698583
   target dn stat err =       0.003373017427
      target stat err =       0.002870071198
              std dev =       0.659168982723
             le_variance =       0.434503747784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748399670973        initial  <--
     1.2925e+19     1.2925e+20             0.0000e+00        -0.748399670973
     5.1699e+19     5.1699e+20             0.0000e+00        -0.748399670973
     2.0680e+20     2.0680e+21             0.0000e+00        -0.748399670973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6909
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5048e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.8017
    reference variance = 0.30899
====================================================
  Execution time = 2.5571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5477e-01
  Total weights = 1.964549557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439428817510
                                         uncertainty =       0.002489482726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439428817510
                                         uncertainty =       0.002489482726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468714181
  error estimate for blocks of size 2^( 2) =       0.000494512978
  error estimate for blocks of size 2^( 3) =       0.000519017767
  error estimate for blocks of size 2^( 4) =       0.000537721222
  error estimate for blocks of size 2^( 5) =       0.000549628551
  error estimate for blocks of size 2^( 6) =       0.000557380796
  error estimate for blocks of size 2^( 7) =       0.000561158070

      target function =      -0.741423384425
              le_mean =     -22.814540054529
             les_mean =     520.958004218533
             stat err =       0.000551472160
             autocorr =       1.384302487129
   target nu stat err =       0.000551472160
   target dn stat err =       0.003898776347
      target stat err =       0.003244777163
              std dev =       0.662861951640
             le_variance =       0.439385966931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454005453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+20, overlap shift 1.2925e+21 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741436669056       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741436669056       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+20, overlap shift 5.1699e+21 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741436669056       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741436669056       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+21, overlap shift 2.0680e+22 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741436669056       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741436669056       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.709825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0090e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.8115
    reference variance = 0.359807
====================================================
  Execution time = 2.5210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5034e-01
  Total weights = 1.9647e+06
  Execution time = 3.5091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468137044
  error estimate for blocks of size 2^( 2) =       0.000493997855
  error estimate for blocks of size 2^( 3) =       0.000518235504
  error estimate for blocks of size 2^( 4) =       0.000536491291
  error estimate for blocks of size 2^( 5) =       0.000548103763
  error estimate for blocks of size 2^( 6) =       0.000555206106
  error estimate for blocks of size 2^( 7) =       0.000558578774

      target function =      -0.745058542020
              le_mean =     -22.813927840857
             les_mean =     520.925648246529
             stat err =       0.000549594983
             autocorr =       1.378286501604
   target nu stat err =       0.000549594983
   target dn stat err =       0.003224449154
      target stat err =       0.002728202772
              std dev =       0.662045756724
             le_variance =       0.438304583996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468137044
  error estimate for blocks of size 2^( 2) =       0.000493997855
  error estimate for blocks of size 2^( 3) =       0.000518235504
  error estimate for blocks of size 2^( 4) =       0.000536491291
  error estimate for blocks of size 2^( 5) =       0.000548103763
  error estimate for blocks of size 2^( 6) =       0.000555206106
  error estimate for blocks of size 2^( 7) =       0.000558578774

      target function =      -0.745058542020
              le_mean =     -22.813927840857
             les_mean =     520.925648246529
             stat err =       0.000549594983
             autocorr =       1.378286501604
   target nu stat err =       0.000549594983
   target dn stat err =       0.003224449154
      target stat err =       0.002728202772
              std dev =       0.662045756724
             le_variance =       0.438304583996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468137044
  error estimate for blocks of size 2^( 2) =       0.000493997855
  error estimate for blocks of size 2^( 3) =       0.000518235504
  error estimate for blocks of size 2^( 4) =       0.000536491291
  error estimate for blocks of size 2^( 5) =       0.000548103763
  error estimate for blocks of size 2^( 6) =       0.000555206106
  error estimate for blocks of size 2^( 7) =       0.000558578774

      target function =      -0.745058542020
              le_mean =     -22.813927840857
             les_mean =     520.925648246529
             stat err =       0.000549594983
             autocorr =       1.378286501604
   target nu stat err =       0.000549594983
   target dn stat err =       0.003224449154
      target stat err =       0.002728202772
              std dev =       0.662045756724
             le_variance =       0.438304583996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438437936648
                                         uncertainty =       0.002460786983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468137044
  error estimate for blocks of size 2^( 2) =       0.000493997855
  error estimate for blocks of size 2^( 3) =       0.000518235504
  error estimate for blocks of size 2^( 4) =       0.000536491291
  error estimate for blocks of size 2^( 5) =       0.000548103763
  error estimate for blocks of size 2^( 6) =       0.000555206106
  error estimate for blocks of size 2^( 7) =       0.000558578774

      target function =      -0.745058542020
              le_mean =     -22.813927840857
             les_mean =     520.925648246529
             stat err =       0.000549594983
             autocorr =       1.378286501604
   target nu stat err =       0.000549594983
   target dn stat err =       0.003224449154
      target stat err =       0.002728202772
              std dev =       0.662045756724
             le_variance =       0.438304583996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745058542020        initial  <--
     1.2925e+20     1.2925e+21             0.0000e+00        -0.745058542020
     5.1699e+20     5.1699e+21             0.0000e+00        -0.745058542020
     2.0680e+21     2.0680e+22             0.0000e+00        -0.745058542020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7947
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.9143
    reference variance = 0.394679
====================================================
  Execution time = 2.7569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4740e-01
  Total weights = 1.964910949e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435396194116
                                         uncertainty =       0.002022261016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435396194116
                                         uncertainty =       0.002022261016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466561478
  error estimate for blocks of size 2^( 2) =       0.000492631327
  error estimate for blocks of size 2^( 3) =       0.000517008155
  error estimate for blocks of size 2^( 4) =       0.000535650737
  error estimate for blocks of size 2^( 5) =       0.000548136638
  error estimate for blocks of size 2^( 6) =       0.000555165295
  error estimate for blocks of size 2^( 7) =       0.000562641520

      target function =      -0.747501249291
              le_mean =     -22.814166809184
             les_mean =     520.933605648199
             stat err =       0.000550398548
             autocorr =       1.391671723249
   target nu stat err =       0.000550398548
   target dn stat err =       0.002614124787
      target stat err =       0.002255508596
              std dev =       0.659817569275
             le_variance =       0.435359224723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281416680918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+21, overlap shift 1.2925e+22 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747507119264       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747507119264       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747507119264       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747507119264       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747507119264       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747507119054       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747544376401       residual = 4.61e+05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747507119261       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+21 is 2.206637e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+21, overlap shift 5.1699e+22 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747507119264       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747507119264       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747507119264       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747507119264       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747507119264       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747507119259       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747520862551       residual = 6.89e+04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724670665329       residual = 1.11e+05           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+21 is 5.262090e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+22, overlap shift 2.0680e+23 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747507119264       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747507119264       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747507119264       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747507119264       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+22 is 1.088588e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.712468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2094e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.8013
    reference variance = 0.322297
====================================================
  Execution time = 2.5281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4678e-01
  Total weights = 1.9647e+06
  Execution time = 3.5029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466159037
  error estimate for blocks of size 2^( 2) =       0.000492008367
  error estimate for blocks of size 2^( 3) =       0.000516079895
  error estimate for blocks of size 2^( 4) =       0.000534221564
  error estimate for blocks of size 2^( 5) =       0.000546399547
  error estimate for blocks of size 2^( 6) =       0.000552749700
  error estimate for blocks of size 2^( 7) =       0.000558490626

      target function =      -0.748017730220
              le_mean =     -22.813921111502
             les_mean =     520.921772409822
             stat err =       0.000547965359
             autocorr =       1.381777110168
   target nu stat err =       0.000547965359
   target dn stat err =       0.002435847818
      target stat err =       0.002114619906
              std dev =       0.659248432006
             le_variance =       0.434608495102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466159037
  error estimate for blocks of size 2^( 2) =       0.000492008367
  error estimate for blocks of size 2^( 3) =       0.000516079895
  error estimate for blocks of size 2^( 4) =       0.000534221564
  error estimate for blocks of size 2^( 5) =       0.000546399547
  error estimate for blocks of size 2^( 6) =       0.000552749700
  error estimate for blocks of size 2^( 7) =       0.000558490626

      target function =      -0.748017730220
              le_mean =     -22.813921111502
             les_mean =     520.921772409822
             stat err =       0.000547965359
             autocorr =       1.381777110168
   target nu stat err =       0.000547965359
   target dn stat err =       0.002435847818
      target stat err =       0.002114619906
              std dev =       0.659248432006
             le_variance =       0.434608495102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466159037
  error estimate for blocks of size 2^( 2) =       0.000492008367
  error estimate for blocks of size 2^( 3) =       0.000516079895
  error estimate for blocks of size 2^( 4) =       0.000534221564
  error estimate for blocks of size 2^( 5) =       0.000546399547
  error estimate for blocks of size 2^( 6) =       0.000552749700
  error estimate for blocks of size 2^( 7) =       0.000558490626

      target function =      -0.748017730220
              le_mean =     -22.813921111502
             les_mean =     520.921772409822
             stat err =       0.000547965359
             autocorr =       1.381777110168
   target nu stat err =       0.000547965359
   target dn stat err =       0.002435847818
      target stat err =       0.002114619906
              std dev =       0.659248432006
             le_variance =       0.434608495102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434621891914
                                         uncertainty =       0.001876504232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466159037
  error estimate for blocks of size 2^( 2) =       0.000492008367
  error estimate for blocks of size 2^( 3) =       0.000516079895
  error estimate for blocks of size 2^( 4) =       0.000534221564
  error estimate for blocks of size 2^( 5) =       0.000546399547
  error estimate for blocks of size 2^( 6) =       0.000552749700
  error estimate for blocks of size 2^( 7) =       0.000558490626

      target function =      -0.748017730220
              le_mean =     -22.813921111502
             les_mean =     520.921772409822
             stat err =       0.000547965359
             autocorr =       1.381777110168
   target nu stat err =       0.000547965359
   target dn stat err =       0.002435847818
      target stat err =       0.002114619906
              std dev =       0.659248432006
             le_variance =       0.434608495102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748017730220        initial  <--
     1.2925e+21     1.2925e+22             2.2066e-25        -0.748017730220
     5.1699e+21     5.1699e+22             5.2621e-26        -0.748017730220
     2.0680e+22     2.0680e+23             1.0886e-26        -0.748017730220

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8451
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8105
    reference variance = 0.332699
====================================================
  Execution time = 2.5557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5301e-01
  Total weights = 1.964623758e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440250706105
                                         uncertainty =       0.001620848289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440250706105
                                         uncertainty =       0.001620848289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469208690
  error estimate for blocks of size 2^( 2) =       0.000494649826
  error estimate for blocks of size 2^( 3) =       0.000519040580
  error estimate for blocks of size 2^( 4) =       0.000536440429
  error estimate for blocks of size 2^( 5) =       0.000548296069
  error estimate for blocks of size 2^( 6) =       0.000553873566
  error estimate for blocks of size 2^( 7) =       0.000558496584

      target function =      -0.742866136704
              le_mean =     -22.813361047652
             les_mean =     520.902451763955
             stat err =       0.000549276662
             autocorr =       1.370408990367
   target nu stat err =       0.000549276662
   target dn stat err =       0.003361118260
      target stat err =       0.002819456247
              std dev =       0.663561293295
             le_variance =       0.440313589959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281336104765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+22, overlap shift 1.2925e+23 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742875805175       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742875805175       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+22, overlap shift 5.1699e+23 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742875805175       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742875805175       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+23, overlap shift 2.0680e+24 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742875805175       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742875805175       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.713555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0047e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7997
    reference variance = 0.450577
====================================================
  Execution time = 2.5364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5025e-01
  Total weights = 1.9649e+06
  Execution time = 3.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467383115
  error estimate for blocks of size 2^( 2) =       0.000492782385
  error estimate for blocks of size 2^( 3) =       0.000516915074
  error estimate for blocks of size 2^( 4) =       0.000535269761
  error estimate for blocks of size 2^( 5) =       0.000547683928
  error estimate for blocks of size 2^( 6) =       0.000553101117
  error estimate for blocks of size 2^( 7) =       0.000555628252

      target function =      -0.745142296369
              le_mean =     -22.814374452877
             les_mean =     520.945929112115
             stat err =       0.000547920765
             autocorr =       1.374325106730
   target nu stat err =       0.000547920765
   target dn stat err =       0.002821375214
      target stat err =       0.002406911571
              std dev =       0.660979540585
             le_variance =       0.436893953071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467383115
  error estimate for blocks of size 2^( 2) =       0.000492782385
  error estimate for blocks of size 2^( 3) =       0.000516915074
  error estimate for blocks of size 2^( 4) =       0.000535269761
  error estimate for blocks of size 2^( 5) =       0.000547683928
  error estimate for blocks of size 2^( 6) =       0.000553101117
  error estimate for blocks of size 2^( 7) =       0.000555628252

      target function =      -0.745142296369
              le_mean =     -22.814374452877
             les_mean =     520.945929112115
             stat err =       0.000547920765
             autocorr =       1.374325106730
   target nu stat err =       0.000547920765
   target dn stat err =       0.002821375214
      target stat err =       0.002406911571
              std dev =       0.660979540585
             le_variance =       0.436893953071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467383115
  error estimate for blocks of size 2^( 2) =       0.000492782385
  error estimate for blocks of size 2^( 3) =       0.000516915074
  error estimate for blocks of size 2^( 4) =       0.000535269761
  error estimate for blocks of size 2^( 5) =       0.000547683928
  error estimate for blocks of size 2^( 6) =       0.000553101117
  error estimate for blocks of size 2^( 7) =       0.000555628252

      target function =      -0.745142296369
              le_mean =     -22.814374452877
             les_mean =     520.945929112115
             stat err =       0.000547920765
             autocorr =       1.374325106730
   target nu stat err =       0.000547920765
   target dn stat err =       0.002821375214
      target stat err =       0.002406911571
              std dev =       0.660979540585
             le_variance =       0.436893953071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436933952631
                                         uncertainty =       0.002101941323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467383115
  error estimate for blocks of size 2^( 2) =       0.000492782385
  error estimate for blocks of size 2^( 3) =       0.000516915074
  error estimate for blocks of size 2^( 4) =       0.000535269761
  error estimate for blocks of size 2^( 5) =       0.000547683928
  error estimate for blocks of size 2^( 6) =       0.000553101117
  error estimate for blocks of size 2^( 7) =       0.000555628252

      target function =      -0.745142296369
              le_mean =     -22.814374452877
             les_mean =     520.945929112115
             stat err =       0.000547920765
             autocorr =       1.374325106730
   target nu stat err =       0.000547920765
   target dn stat err =       0.002821375214
      target stat err =       0.002406911571
              std dev =       0.660979540585
             le_variance =       0.436893953071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745142296369        initial  <--
     1.2925e+22     1.2925e+23             0.0000e+00        -0.745142296369
     5.1699e+22     5.1699e+23             0.0000e+00        -0.745142296369
     2.0680e+23     2.0680e+24             0.0000e+00        -0.745142296369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9395
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.8556
    reference variance = 0.407496
====================================================
  Execution time = 2.7471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4989e-01
  Total weights = 1.964706538e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435264855297
                                         uncertainty =       0.002130081716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435264855297
                                         uncertainty =       0.002130081716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466496204
  error estimate for blocks of size 2^( 2) =       0.000492399168
  error estimate for blocks of size 2^( 3) =       0.000516761176
  error estimate for blocks of size 2^( 4) =       0.000535100309
  error estimate for blocks of size 2^( 5) =       0.000546612017
  error estimate for blocks of size 2^( 6) =       0.000552518964
  error estimate for blocks of size 2^( 7) =       0.000555466500

      target function =      -0.745439311830
              le_mean =     -22.814304434414
             les_mean =     520.942374118826
             stat err =       0.000547424447
             autocorr =       1.377057735748
   target nu stat err =       0.000547424447
   target dn stat err =       0.002855788018
      target stat err =       0.002435903085
              std dev =       0.659725258387
             le_variance =       0.435237416554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281430443441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+23, overlap shift 1.2925e+24 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745446271335       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745446271335       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+23, overlap shift 5.1699e+24 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745446271335       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745446271335       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+24, overlap shift 2.0680e+25 and omega -2.3487e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745446271335       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745446271335       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.714654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1959e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7972
    reference variance = 0.489733
====================================================
  Execution time = 2.5127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4951e-01
  Total weights = 1.9646e+06
  Execution time = 3.4913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466780861
  error estimate for blocks of size 2^( 2) =       0.000492711445
  error estimate for blocks of size 2^( 3) =       0.000517165510
  error estimate for blocks of size 2^( 4) =       0.000535551377
  error estimate for blocks of size 2^( 5) =       0.000547135390
  error estimate for blocks of size 2^( 6) =       0.000554188494
  error estimate for blocks of size 2^( 7) =       0.000557151076

      target function =      -0.745749733603
              le_mean =     -22.814738786926
             les_mean =     520.961818970653
             stat err =       0.000548506584
             autocorr =       1.380821718675
   target nu stat err =       0.000548506584
   target dn stat err =       0.002902890133
      target stat err =       0.002477500565
              std dev =       0.660127823907
             le_variance =       0.435768743896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466780861
  error estimate for blocks of size 2^( 2) =       0.000492711445
  error estimate for blocks of size 2^( 3) =       0.000517165510
  error estimate for blocks of size 2^( 4) =       0.000535551377
  error estimate for blocks of size 2^( 5) =       0.000547135390
  error estimate for blocks of size 2^( 6) =       0.000554188494
  error estimate for blocks of size 2^( 7) =       0.000557151076

      target function =      -0.745749733603
              le_mean =     -22.814738786926
             les_mean =     520.961818970653
             stat err =       0.000548506584
             autocorr =       1.380821718676
   target nu stat err =       0.000548506584
   target dn stat err =       0.002902890133
      target stat err =       0.002477500565
              std dev =       0.660127823907
             le_variance =       0.435768743896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466780861
  error estimate for blocks of size 2^( 2) =       0.000492711445
  error estimate for blocks of size 2^( 3) =       0.000517165510
  error estimate for blocks of size 2^( 4) =       0.000535551377
  error estimate for blocks of size 2^( 5) =       0.000547135390
  error estimate for blocks of size 2^( 6) =       0.000554188494
  error estimate for blocks of size 2^( 7) =       0.000557151076

      target function =      -0.745749733603
              le_mean =     -22.814738786926
             les_mean =     520.961818970653
             stat err =       0.000548506584
             autocorr =       1.380821718676
   target nu stat err =       0.000548506584
   target dn stat err =       0.002902890133
      target stat err =       0.002477500565
              std dev =       0.660127823907
             le_variance =       0.435768743896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435740015559
                                         uncertainty =       0.002095027579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466780861
  error estimate for blocks of size 2^( 2) =       0.000492711445
  error estimate for blocks of size 2^( 3) =       0.000517165510
  error estimate for blocks of size 2^( 4) =       0.000535551377
  error estimate for blocks of size 2^( 5) =       0.000547135390
  error estimate for blocks of size 2^( 6) =       0.000554188494
  error estimate for blocks of size 2^( 7) =       0.000557151076

      target function =      -0.745749733603
              le_mean =     -22.814738786926
             les_mean =     520.961818970653
             stat err =       0.000548506584
             autocorr =       1.380821718676
   target nu stat err =       0.000548506584
   target dn stat err =       0.002902890133
      target stat err =       0.002477500565
              std dev =       0.660127823907
             le_variance =       0.435768743896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745749733603        initial  <--
     1.2925e+23     1.2925e+24             0.0000e+00        -0.745749733603
     5.1699e+23     5.1699e+24             0.0000e+00        -0.745749733603
     2.0680e+24     2.0680e+25             0.0000e+00        -0.745749733603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5994
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_01                 1.080419e-01 3 1  ON 0
ci_02                -2.400970e-02 3 1  ON 1
ci_03                -2.428521e-02 3 1  ON 2
ci_04                 2.216182e-02 3 1  ON 3
ci_05                -1.913431e-02 3 1  ON 4
ci_06                -1.952977e-02 3 1  ON 5
ci_07                 2.575912e-02 3 1  ON 6
ci_08                -4.226218e-03 3 1  ON 7
ci_09                -7.550027e-03 3 1  ON 8
ci_10                -7.705505e-03 3 1  ON 9
ci_11                 1.374777e-02 3 1  ON 10
ci_12                 7.046921e-03 3 1  ON 11
ci_13                 1.381522e-02 3 1  ON 12
ci_14                 1.281201e-02 3 1  ON 13
ci_15                 5.172311e-03 3 1  ON 14
ci_16                 5.732322e-03 3 1  ON 15
ci_17                -5.021027e-03 3 1  ON 16
ci_18                -5.547693e-03 3 1  ON 17
ci_19                 1.032715e-02 3 1  ON 18
ci_20                 6.254702e-03 3 1  ON 19
ci_21                 8.484224e-03 3 1  ON 20
ci_22                 8.882412e-03 3 1  ON 21
ci_23                 4.171044e-03 3 1  ON 22
ci_24                 5.186235e-03 3 1  ON 23
ci_25                 3.012163e-03 3 1  ON 24
ci_26                 3.792505e-03 3 1  ON 25
ci_27                 3.288962e-03 3 1  ON 26
ci_28                 7.720361e-04 3 1  ON 27
ci_29                 1.187188e-03 3 1  ON 28
ci_30                -7.397565e-04 3 1  ON 29
ci_31                 1.032412e-03 3 1  ON 30
ci_32                -5.384283e-04 3 1  ON 31
ci_33                -1.034677e-03 3 1  ON 32
ci_34                 1.152130e-03 3 1  ON 33
ci_35                 1.248599e-03 3 1  ON 34
ci_36                -5.670353e-04 3 1  ON 35
ci_37                -5.199244e-04 3 1  ON 36
ci_38                -2.860470e-04 3 1  ON 37
ci_39                -1.427555e-04 3 1  ON 38
ci_40                -1.904008e-03 3 1  ON 39
ci_41                -5.152505e-04 3 1  ON 40
ci_42                -1.648438e-03 3 1  ON 41
ci_43                -1.295206e-03 3 1  ON 42
ci_44                -2.176312e-03 3 1  ON 43
ci_45                -2.667369e-04 3 1  ON 44
ci_46                -1.691521e-03 3 1  ON 45
ci_47                 1.436581e-03 3 1  ON 46
ci_48                 2.892119e-03 3 1  ON 47
ci_49                -8.540128e-04 3 1  ON 48
ci_50                -8.198841e-04 3 1  ON 49
ci_51                -5.663953e-04 3 1  ON 50
ci_52                -6.297631e-04 3 1  ON 51
ci_53                -8.013748e-04 3 1  ON 52
ci_54                -1.108874e-03 3 1  ON 53
ci_55                -1.235583e-03 3 1  ON 54
ci_56                 1.100356e-03 3 1  ON 55
ci_57                 2.087927e-03 3 1  ON 56
ci_58                -1.872696e-04 3 1  ON 57
ci_59                -6.204514e-04 3 1  ON 58
ci_60                 1.280255e-04 3 1  ON 59
ci_61                -9.878446e-04 3 1  ON 60
ci_62                -3.813998e-04 3 1  ON 61
ci_63                -2.474066e-04 3 1  ON 62
ci_64                -6.083738e-04 3 1  ON 63
ci_65                -1.070703e-04 3 1  ON 64
ci_66                -1.269881e-04 3 1  ON 65
ci_67                -1.935186e-04 3 1  ON 66
ci_68                -1.796837e-03 3 1  ON 67
ci_69                -1.806264e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4564e+01 secs
  Total Execution time = 7.3575e+03 secs

=========================================================
  A new xml input file : FORM2.s099.cont.xml
